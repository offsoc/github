import type React from 'react'
import {ControlGroup} from '@github-ui/control-group'
import {Box} from '@primer/react'

import Setting from '../SecurityConfiguration/Setting'
import {useAppContext} from '../../contexts/AppContext'
import {useSecuritySettingsContext} from '../../contexts/SecuritySettingsContext'

const PrivateVulnerabilityReporting: React.FC = () => {
  const {
    securityProducts: {
      private_vulnerability_reporting: {availability},
    },
  } = useAppContext()
  const {
    privateVulnerabilityReporting: settingValue,
    renderInlineValidation,
    handleSettingChange: onChange,
    isAvailable,
  } = useSecuritySettingsContext()

  return (
    isAvailable(availability) && (
      <Box sx={{marginY: 4}}>
        <ControlGroup>
          <ControlGroup.Item>
            <ControlGroup.Title>Private vulnerability reporting</ControlGroup.Title>
            <ControlGroup.Description>
              Allow your community to privately report potential security vulnerabilities in public repositories.
              {renderInlineValidation('private_vulnerability_reporting')}
            </ControlGroup.Description>
            <ControlGroup.Custom>
              <Setting name="privateVulnerabilityReporting" value={settingValue} onChange={onChange} />
            </ControlGroup.Custom>
          </ControlGroup.Item>
        </ControlGroup>
      </Box>
    )
  )
}

export default PrivateVulnerabilityReporting
