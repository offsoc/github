# frozen_string_literal: true

module AdvisoryDBToolkit
  module OSV
    module Interfaces
      # A plain old ruby object representing a vulnerability. Vulnerabilities
      # describe vulnerable versions including ecosystem, package, version
      # ranges, etc. A Vulnerability is typically assigned to an Advisory.
      class Vulnerability
        # Package info
        attr_accessor :package_ecosystem, :package_name

        # Version range info
        attr_accessor :first_patched_version, :vulnerable_version_range

        # Metadata
        attr_accessor :affected_functions

        def initialize
          # affected_functions is a simple array of method call path info
          self.affected_functions = []
        end

        def to_h
          {
            package_ecosystem:,
            package_name:,
            first_patched_version:,
            vulnerable_version_range:,
            affected_functions:,
          }
        end
      end
    end
  end
end
