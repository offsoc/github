{"version":3,"file":"ui_packages_use-client-value_use-client-value_ts-ui_packages_copilot-chat_components_Header_t-12eff5-xxxxxxxxxxxx.js","mappings":"uOAEO,IAAMA,EAAa,IACxB,GAAKC,GACL,GAAIA,EAAIC,UAAU,CAAC,cAAe,MAAO,MACzC,GAAID,EAAIC,UAAU,CAAC,eAAgB,MAAO,SAE5C,EACaC,EAAa,CAACF,EAAaG,IACtC,WAAIA,EAA6B,CAAC,WAAW,EAAEH,EAAI,CAAC,CAChDG,QAAAA,EAA0B,CAAC,UAAU,EAAEH,EAAI,CAAC,CACzCA,EAEII,EAAe,IAC1B,GAAI,CAACJ,EAAK,OAEV,GAAI,CADYD,EAAWC,GACb,OAAOA,EACrB,GAAM,GAAK,GAAGK,EAAe,CAAGL,EAAIM,KAAK,CAAC,KAC1C,OAAOD,EAAeE,IAAI,CAAC,IAC7B,C,wEC0BO,SAASC,EACdC,CAA2C,CAC3CC,CAAe,CACfC,EAAuB,EAAE,EAGzB,IAAMC,EAAmBC,CAAAA,EAAAA,EAAAA,WAAAA,EAAYJ,EAAqBE,GACpDG,EAAcC,CAAAA,EAAAA,EAAAA,CAAAA,IACdC,EAAmBC,CAAAA,EAAAA,EAAAA,MAAAA,EAAOH,IAAgBI,EAAAA,CAAWA,CAACC,YAAY,EAElE,CAACC,EAAaC,EAAe,CAAGC,CAAAA,EAAAA,EAAAA,QAAAA,EAAwB,IAC5D,IAAoBJ,EAAAA,CAAWA,CAACC,YAAY,CAASP,IAC9CF,GAGHa,EAAoBV,CAAAA,EAAAA,EAAAA,WAAAA,EAAY,KACpCQ,EAAeT,EACjB,EAAG,CAACA,EAAiB,EAWrB,MATAY,CAAAA,EAAAA,EAAAA,CAAAA,EAAkB,KAEXR,EAAiBS,OAAO,EAC3BJ,EAAeT,GAEjBI,EAAiBS,OAAO,CAAG,EAE7B,EAAG,CAACb,KAAqBD,EAAK,EAEvB,CAACS,EAAaG,EAAkB,C,uECvDlC,SAASG,EACdC,CAA6B,CAC7BC,CAA4B,CAC5BC,CAA6B,CAC7BC,CAAwB,EAExB,GAAM,CAACC,EAAOC,EAAS,CAAGV,CAAAA,EAAAA,EAAAA,QAAAA,EAA4B,CAACW,QAAS,EAAI,GAE9DC,EACJN,GAAYD,GAAaE,GAAaC,EAClCK,CAAAA,EAAAA,EAAAA,EAAAA,EAAmB,CACjBC,KAAM,CAACC,KAAMT,EAAUU,WAAYX,CAAS,EAC5CE,UAAAA,EACAU,OAAQ,oBACRT,KAAAA,CACF,GACA,KAiCN,MA/BAU,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,KACR,GAAI,CAACN,EAAsB,OAE3B,IAAIO,EAAY,GAuBhB,MAHAC,CAnBe,UACbV,EAAS,CAACC,QAAS,EAAI,GACvB,IAAMU,EAAW,MAAMC,CAAAA,EAAAA,EAAAA,EAAAA,EAAkBV,GAEzC,IAAIO,EAIJ,GAAI,CACEE,EAASE,EAAE,CACbb,EAAS,CAACc,aAAc,MAAMH,EAASI,IAAI,EAAE,GAE7Cf,EAAS,CAACgB,MAAO,EAAI,EAEzB,CAAE,MAAOC,EAAG,CACVjB,EAAS,CAACgB,MAAO,EAAI,EACvB,CACF,KAKO,WACLP,EAAY,EACd,CACF,EAAG,CAACP,EAAqB,EAElBH,CACT,C,qGC7DA,eAAemB,EAAUC,CAAW,EAClC,IAAMR,EAAW,MAAMC,CAAAA,EAAAA,EAAAA,EAAAA,EAAkBO,UACzC,EAAaN,EAAE,CACN,MAAMF,EAASI,IAAI,GAE1B,MAEJ,CAEA,IAAMK,EAAe,IAAIC,IACnBC,EAAmBC,CAAAA,EAAAA,EAAAA,CAAAA,EAAQL,EAAW,CAACM,MAAOJ,CAAY,GAEzD,SAASK,IACdL,EAAaM,KAAK,EACpB,CAYO,SAASC,EACdhC,CAA6B,CAC7BC,CAA4B,CAC5BC,CAA6B,CAC7BC,CAAwB,EAExB,GAAM,CAAC8B,EAAcC,EAAgB,CAAGvC,CAAAA,EAAAA,EAAAA,QAAAA,IAClC,CAAC0B,EAAOc,EAAS,CAAGxC,CAAAA,EAAAA,EAAAA,QAAAA,EAAS,IAC7B,CAACW,EAAS8B,EAAW,CAAGzC,CAAAA,EAAAA,EAAAA,QAAAA,EAAS,IAEjC0C,EACJpC,GAAYD,GAAaE,GAAaC,EAClCK,CAAAA,EAAAA,EAAAA,EAAAA,EAAmB,CACjBC,KAAM,CAACC,KAAMT,EAAUU,WAAYX,CAAS,EAC5CE,UAAAA,EACAU,OAAQ,gBACRT,KAAAA,CACF,GACA,KA+CN,MA1CAU,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,KACRyB,SAASC,gBAAgB,CAACC,EAAAA,CAAcA,CAACC,KAAK,CAAEX,GAEzC,KACLQ,SAASI,mBAAmB,CAACF,EAAAA,CAAcA,CAACC,KAAK,CAAEX,EACrD,IAGFjB,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,KACR,IAAIC,EAAY,GA4BhB,MAFAC,CAxBe,UACb,GAAI,CAACsB,EAAgB,OAErBF,EAAS,IACTC,EAAW,IACXF,EAAgBS,KAAAA,GAChB,IAAMC,EAAS,MAAMjB,EAAiBU,GAEtC,IAAIvB,GAIJ,GAAI,CACE8B,EACFV,EAAgBU,GAEhBT,EAAS,GAEb,CAAE,MAAOb,EAAG,CACVa,EAAS,GACX,CACAC,EAAW,IACb,KAIO,WACLtB,EAAY,EACd,CACF,EAAG,CAACuB,EAAgBnC,EAAU,EAEvB,CAAC+B,EAAc3B,EAASe,EAAM,C,wECpFhC,SAASjC,IAEd,MADoByD,CAAAA,EAAAA,EAAAA,UAAAA,EAAWC,EAAAA,EAAkBA,CAEnD,C,yICHO,IAAMC,EAAoB,CAAC,CAACC,UAAAA,CAAS,CAAEC,qBAAAA,CAAoB,CAAyB,IACzF,GAAM,CAACC,EAAaC,EAAe,CAAGxD,CAAAA,EAAAA,EAAAA,QAAAA,EAAS,IAAMyD,CAAAA,EAAAA,EAAAA,CAAAA,IAAwBxE,IAAI,CAAC,MAC5E,CAACyE,EAAeC,EAAiB,CAAG3D,CAAAA,EAAAA,EAAAA,QAAAA,EAA6BgD,KAAAA,GACjEY,EAAwBjE,CAAAA,EAAAA,EAAAA,MAAAA,EAAO,UAC/BkE,EAAkB,KACtB,IAAMC,EAAmB,EAAE,CAC3B,IAAK,IAAMC,KAAQR,EAAYvE,KAAK,CAAC,KACnC,GAAI+E,KAAAA,EAAKC,IAAI,IAEb,GAAID,IAAAA,EAAK/E,KAAK,CAAC,KAAKiF,MAAM,CAAQ,CAEhCN,EADuB,CAAC,iCAAiC,EAAEC,EAAsBzD,OAAO,CAAC,CAAC,EAE1FyD,EAAsBzD,OAAO,EAAI,SACjC,MACF,CACEwD,EAAiB,IAEnBG,EAAiBI,IAAI,CAACH,GAGxBI,CAAAA,EAAAA,EAAAA,CAAAA,EAAsBL,GACtBT,GACF,EAEA,MACE,UAACe,EAAAA,CAAMA,CAAAA,C,SACL,WAACC,EAAAA,CAAMA,CAAAA,CAAC3F,IAAK4E,EAAsBgB,QAASjB,EAAWkB,MAAO,cAAeC,MAAM,S,UACjF,UAACH,EAAAA,CAAMA,CAACI,IAAI,E,SACV,UAACC,EAAAA,CAAGA,CAAAA,CAACC,GAAI,CAACC,EAAG,CAAC,E,SACZ,WAACC,EAAAA,CAAWA,CAAAA,C,UACV,UAACA,EAAAA,CAAWA,CAACC,KAAK,E,SAAC,a,GACnB,UAACD,EAAAA,CAAWA,CAACE,OAAO,E,SAClB,WAACC,OAAAA,C,UAAK,uCACgC,UAACC,OAAAA,C,SAAK,W,GAAgB,wCAAsC,IAChG,UAACC,EAAAA,CAAIA,CAAAA,CAACC,OAAM,GAACC,OAAO,SAASC,KAAM,CAAC,UAAU,EAAEC,mBAzCzC,+CAyC8E,CAAC,C,SAAE,gB,GAEjF,I,KAIX,UAACC,EAAAA,CAASA,CAAAA,CACRZ,GAAI,CAACH,MAAO,OAAQgB,GAAI,CAAC,EACzBC,aAAW,cACX1E,KAAK,cACL2E,MAAOnC,EACPoC,SAAUhE,GAAK6B,EAAe7B,EAAEyD,MAAM,CAACM,KAAK,EAC5CE,UAAWjE,IAEK,UAAVA,EAAEkE,GAAG,EACPhC,GAEJ,C,GAEDH,GAAiB,UAACmB,EAAAA,CAAWA,CAACiB,UAAU,EAACC,QAAQ,Q,SAASrC,C,UAIjE,UAACW,EAAAA,CAAMA,CAAC2B,MAAM,E,SACZ,UAAC3B,EAAAA,CAAMA,CAAC4B,OAAO,EACbC,QAAS,CACP,CAACC,KAAM,SAAUC,QAAS/C,EAAWgD,QAAS,QAAQ,EACtD,CAACF,KAAM,SAAUC,QAASvC,EAAiBwC,QAAS,OAAQC,WAAY,SAAS,EAClF,E,OAMb,EAEA,GAAG,CAAElD,EAAkBmD,WAAW,EAA7BnD,CAAAA,EAAkBmD,WAAW,CAAK,mBAAkB,CAAE,CAAE,KAAM,CAAC,C,sSCtD7D,IAAMC,EAAmB,6BAcnBC,EAAS,IACpB,IAAMhG,EAAQiG,CAAAA,EAAAA,EAAAA,EAAAA,IACRC,EAAUC,CAAAA,EAAAA,EAAAA,CAAAA,IACVC,EAASF,EAAQG,iBAAiB,CAACrG,GACnC,CAACsG,gBAAAA,CAAe,CAAEC,SAAAA,CAAQ,CAAC,CAAGvG,EAE9BwG,EAAqB1H,CAAAA,EAAAA,EAAAA,WAAAA,EAAY,SAC9BsH,GAAUF,EAAQO,YAAY,CAACL,GACrC,CAACA,EAAQF,EAAQ,EAEpB,MACE,WAACjC,EAAAA,CAAGA,CAAAA,CACFC,GAAI,CACFwC,QAAS,OACTC,IAAK,EACLxC,EAAG,EACHyC,GAAI5G,cAAAA,EAAM6G,IAAI,CAAmB,EAAI,EACrCC,aAAc9G,EAAMuG,QAAQ,CAAC/C,MAAM,CAAG,EAAI,YAAc,OACxDuD,YAAa,iBACbC,eAAgB,gBAChBC,WAAY,QACd,E,UAEA,UAAChD,EAAAA,CAAGA,CAAAA,CAACC,GAAI,CAACwC,QAAS,OAAQQ,KAAM,EAAGC,SAAU,CAAC,E,SAC5CC,WAAAA,EAAMC,IAAI,CACT,GAAqBD,EAAME,WAAW,EAAIf,IAAAA,EAAS/C,MAAM,EAAWxD,EAAMuH,eAAe,CAGvF,UAACC,EAAAA,CAAOA,CAAAA,CACNC,GAAG,KACHvD,GAAI,CACFwD,SAAU,EACVhB,QAAS,OACTO,WAAY,SACZU,SAAU,EACVhB,IAAK,EACLQ,SAAU,EACVS,OAAQC,EAAAA,CAAmBA,CAACC,qBAAqB,CAAG,UAAY,SAClE,EAEAnC,QACEyB,EAAMW,WAAW,CACb,IAAM7B,EAAQ8B,UAAU,GACxBH,EAAAA,CAAmBA,CAACC,qBAAqB,CACvCvF,KAAAA,EACA,IAAM2D,EAAQ+B,YAAY,G,SAGjCb,WAAAA,EAAMC,IAAI,CACT,uB,UACId,CAAAA,EAAS/C,MAAM,CAAG,GAAKxD,EAAMuH,eAAe,GAC5C,UAACW,EAAAA,CAAYA,CAAAA,CAACC,UAAWf,EAAMgB,YAAY,CAAEC,kBAAmBjB,EAAMiB,iBAAiB,GAGxFjC,GAAQ9F,KACP,UAACiE,OAAAA,CAAK+D,UAAU,W,SAGd,UAAC/D,OAAAA,CAAK+D,UAAU,gBAAgBxE,MAAOsC,EAAO9F,IAAI,C,SAC/C8F,EAAO9F,IAAI,E,GAGd8G,EAAMgB,YAAY,EAAIpI,EAAMuH,eAAe,CAC7C,UAAChD,OAAAA,C,SAAK,kB,GACJvE,EAAMuH,eAAe,CACvB,UAAChD,OAAAA,C,SAAK,a,GAEN,CAAC+B,GAAmB,UAAC/B,OAAAA,C,SAAK,kB,MAI9B,S,GA7CJ,UAACgE,EAAAA,CAAeA,CAAAA,CAAAA,GAkDlB,UAACC,EAAAA,CAAAA,E,GAIL,WAACvE,EAAAA,CAAGA,CAAAA,CACFC,GAAI,CACFwC,QAAS,OACTO,WAAY,QACd,E,UAEC,CAACG,EAAMW,WAAW,EACjB,sB,SACGX,WAAAA,EAAMC,IAAI,CACT,uB,UACE,UAACoB,EAAAA,CAAqBA,CAAAA,CACpBC,OAAQnC,IAAAA,EAAS/C,MAAM,CACvB8B,QAAQ,YACRqD,KAAMC,EAAAA,QAAQA,CACdC,MAAM,mBACNC,iBAAiB,IACjBnD,QAAS,UACP,MAAMO,EAAQ6C,YAAY,EAC5B,EACA7E,GAAI,CAAC8E,MAAO,UAAU,C,GAExB,UAACC,EAAAA,CACCC,aAAc1C,EACdJ,OAAQA,EACR+C,yBAA0B/B,EAAM+B,wBAAwB,G,GAI5D,UAACV,EAAAA,CAAqBA,CAAAA,CACpBnD,QAAQ,YACRqD,KAAMC,EAAAA,QAAQA,CACdC,MAAM,mBACNC,iBAAiB,IACjBnD,QAAS,UACP,MAAMO,EAAQ6C,YAAY,EAC5B,EACA7E,GAAI,CAAC8E,MAAO,UAAU,C,KAM7B,CAAC5B,EAAME,WAAW,EACjB,uB,UACG,CAACF,EAAMW,WAAW,EACjB,UAAC9D,EAAAA,CAAGA,CAAAA,CACFC,GAAI,CACFkF,GAAI,EACJC,OAAQ,OACRtF,MAAO,MACPuF,GAAI,cACN,C,GAGH,CAACzB,EAAAA,CAAmBA,CAACC,qBAAqB,EACzC,UAACW,EAAAA,CAAqBA,CAAAA,CACpBnD,QAAQ,YACRqD,KAAMvB,EAAMW,WAAW,CAAGwB,EAAAA,aAAaA,CAAGC,EAAAA,eAAeA,CACzDX,MAAOzB,EAAMW,WAAW,CAAG,SAAW,WACtCe,iBAAiB,IACjBnD,QAAS,KACP8D,EAA6BrC,EAAMW,WAAW,EAC9CX,EAAMW,WAAW,CAAG7B,EAAQ8B,UAAU,GAAK9B,EAAQ+B,YAAY,EACjE,EACA/D,GAAI,CAAC8E,MAAO,UAAU,EACtBU,cAAY,S,GAGhB,UAACjB,EAAAA,CAAqBA,CAAAA,CACpBnD,QAAQ,YACRqD,KAAMgB,EAAAA,KAAKA,CACX3E,aAAW,QACX6D,MAAM,qBACNC,iBAAiB,IACjBnD,QAAS,KACP8D,EAA6B,IAC7BvD,EAAQ0D,SAAS,CAAC5J,EAAM6J,sBAAsB,CAChD,EACA3F,GAAI,CAAC8E,MAAO,UAAU,EACtBU,cAAY,S,SAKnBtC,EAAM0C,qBAAqB,EAC1B,UAACnH,EAAAA,CAAiBA,CAAAA,CAChBE,qBAAsBuE,EAAMvE,oBAAoB,CAChDD,UAAW,IAAMwE,EAAM+B,wBAAwB,CAAC,G,KAK1D,EAEMX,EAA8B,KAClC,GAAM,CAAC3B,KAAAA,CAAI,CAAC,CAAGZ,CAAAA,EAAAA,EAAAA,EAAAA,IACTC,EAAUC,CAAAA,EAAAA,EAAAA,CAAAA,IAEhB,MACE,UAAC4D,EAAAA,CAAMA,CAAAA,CACLC,cAAeC,EAAAA,aAAaA,CAC5B3E,QAAQ,YACRK,QAAS,IAAMO,EAAQgE,iBAAiB,GACxChG,GAAI,CAAC8E,MAAO,WAAYmB,WAAYtD,cAAAA,EAAuB,OAAStE,KAAAA,CAAS,E,SAC9E,M,EAIL,EAQa0G,EAAqB,IAChC,GAAM,CAACmB,EAAMC,EAAQ,CAAG9K,CAAAA,EAAAA,EAAAA,QAAAA,EAAS,IAC3B,CAAC+K,aAAAA,CAAY,CAAEzD,KAAAA,CAAI,CAAE0D,iBAAAA,CAAgB,CAAC,CAAGtE,CAAAA,EAAAA,EAAAA,EAAAA,IACzC,CAACG,OAAAA,CAAM,CAAC,CAAGgB,EACXoD,EAAWC,CAAAA,EAAAA,EAAAA,CAAAA,IACXvE,EAAUC,CAAAA,EAAAA,EAAAA,CAAAA,IAEVuE,EAAqB5L,CAAAA,EAAAA,EAAAA,WAAAA,EAAY,KACrCoH,EAAQyE,cAAc,GACtBC,CAAAA,EAAAA,EAAAA,EAAAA,EAAU,qCACZ,EAAG,CAAC1E,EAAQ,EAON2E,EAAcC,CAAAA,EAAAA,EAAAA,OAAAA,EAAQ,IACnBC,CAAAA,EAAAA,EAAAA,CAAAA,IACN,EAAE,EAECC,EAAiB,CAAC5D,EAAMhB,MAAM,CAE9B6E,EAAuBH,CAAAA,EAAAA,EAAAA,OAAAA,EAAQ,IACnC,EACS,CAAC,EAAEI,EAAAA,EAAYA,CAAC,GAAG,EAAE9E,EAAO+E,EAAE,CAAC,CAAC,CAC9Bb,GAAgBc,CAAAA,EAAAA,EAAAA,EAAAA,EAAad,GAC/B,CAAC,EAAEY,EAAAA,EAAYA,CAAC,GAAG,EAAEZ,EAAa/J,UAAU,CAAC,CAAC,EAAE+J,EAAahK,IAAI,CAAC,CAAC,CACjEgK,GAAgBe,CAAAA,EAAAA,EAAAA,CAAAA,EAASf,GAC3B,CAAC,EAAEY,EAAAA,EAAYA,CAAC,GAAG,EAAEZ,EAAaa,EAAE,CAAC,CAAC,CAEtCD,EAAAA,EAAYA,CAEpB,CAAC9E,EAAQkE,EAAa,EAEzB,MACE,sB,SACE,WAACgB,EAAAA,CAAUA,CAAAA,CAAClB,KAAMA,EAAMmB,aAAc,IAAMlB,EAAQmB,GAAQ,CAACA,G,UAC3D,UAACF,EAAAA,CAAUA,CAACG,MAAM,E,SAChB,UAAChD,EAAAA,CAAqBA,CAAAA,CACpBE,KAAM+C,EAAAA,mBAAmBA,CACzBpG,QAAQ,YACRuD,MAAM,4BACNC,iBAAiB,KACjB6C,YAAavB,EACblG,GAAI,CAAC8E,MAAO,UAAU,C,KAG1B,UAAC4C,EAAAA,EAAiBA,CAAAA,C,SAChB,WAACC,EAAAA,CAAUA,CAAAA,C,UACRhF,cAAAA,GACC,WAACgF,EAAAA,CAAUA,CAACC,IAAI,EAACC,SAAU,IAAMvB,EAASS,GAAee,SAAU,CAAC,CAACzB,E,UACnE,UAACsB,EAAAA,CAAUA,CAACI,aAAa,E,SACvB,UAACC,EAAAA,cAAcA,CAAAA,CAAAA,E,GACU,iC,GAI/B,WAACL,EAAAA,CAAUA,CAACC,IAAI,EACdxG,QAAS0F,EAAiB,UAAY,SACtCe,SAhDe,KACzB3E,EAAM8B,YAAY,GAClBmB,EAAQ,GACV,EA8CY2B,SAAUhB,EACVmB,mBAAiB,kC,UAEjB,UAACN,EAAAA,CAAUA,CAACI,aAAa,E,SACvB,UAACG,EAAAA,SAASA,CAAAA,CAAAA,E,GACe,sBAE3B,UAACjI,IAAAA,CAAEgH,GAAG,kCAAkC7C,UAAU,U,SAAU,oD,MAI9D,UAACuD,EAAAA,CAAUA,CAACQ,OAAO,KAClBxF,cAAAA,GACC,WAACgF,EAAAA,CAAUA,CAACC,IAAI,EAACC,SAAUrB,E,UACzB,UAACmB,EAAAA,CAAUA,CAACI,aAAa,E,SACvB,UAACK,EAAAA,WAAWA,CAAAA,CAAAA,E,GACa,yB,GAI/B,WAACT,EAAAA,CAAUA,CAACU,QAAQ,EAClB3H,KAAK,4CACL4H,IAAI,sBACJ7H,OAAO,S,UAEP,UAACkH,EAAAA,CAAUA,CAACI,aAAa,E,SACvB,UAACQ,EAAAA,qBAAqBA,CAAAA,CAAAA,E,GACG,gB,GAG5B5B,GACC,WAACgB,EAAAA,CAAUA,CAACC,IAAI,EAACC,SAAU,IAAM3E,EAAM+B,wBAAwB,CAAC,I,UAC9D,UAAC0C,EAAAA,CAAUA,CAACI,aAAa,E,SACvB,UAACS,EAAAA,UAAUA,CAAAA,CAAAA,E,GACc,wBAE3B,UAACb,EAAAA,CAAUA,CAACc,cAAc,E,SACxB,UAACtI,EAAAA,CAAKA,CAAAA,CAACiB,QAAQ,Y,SAAY,O,iBAS7C,EAEO,SAASmE,EAA6BmD,CAAsB,EACjE,IAAMC,EAAgB3K,SAAS4K,cAAc,CAAC/G,GAE9C8G,GAAeE,aAAa,gBAAiBH,EAAe,OAAS,QACvE,CAEA,GAAG,CAAE5G,EAAOF,WAAW,EAAlBE,CAAAA,EAAOF,WAAW,CAAK,QAAO,CAAE,CAAE,KAAM,CAAC,CAC9C,GAAG,CAAE0C,EAA4B1C,WAAW,EAAvC0C,CAAAA,EAA4B1C,WAAW,CAAK,6BAA4B,CAAE,CAAE,KAAM,CAAC,CACxF,GAAG,CAAEmD,EAAmBnD,WAAW,EAA9BmD,CAAAA,EAAmBnD,WAAW,CAAK,oBAAmB,CAAE,CAAE,KAAM,CAAC,C,gSC3V/D,SAASkH,EAAkB,CAACC,YAAAA,CAAW,CAAEC,MAAAA,CAAK,CAAEC,mBAAAA,CAAkB,CAAyB,EAChG,MACE,UAAClJ,EAAAA,CAAGA,CAAAA,CAACC,GAAI,CAACwC,QAAS,OAAQ0G,cAAe,MAAOC,UAAW,OAAQC,GAAI,CAAC,E,SACvE,UAACC,QAAAA,CACCC,MAAO,CACL9F,SAAU,OACV+F,WAAY,+EACZJ,UAAW,MACb,E,SAECJ,EAAYS,GAAG,CAAC,CAACC,EAAKC,IACrB,WAACC,KAAAA,C,UACC,UAACC,KAAAA,C,SAAcH,C,EAANA,GACT,UAACG,KAAAA,CAAGN,MAAO,CAACO,WAAY,MAAOC,YAAa,MAAM,E,SAChD,UAACC,EAAAA,EAAWA,CAAAA,CAEVC,KACEf,EAcTgB,CAb+BjB,CAAK,CAACU,EAAE,EAAK,EAAC,EAazCQ,SAAS,GAZAlB,CAAK,CAACU,EAAE,EAAK,I,EAJd,CAAC,KAAK,EAAEA,EAAE,CAAC,C,KAJb,CAAC,SAAS,EAAED,EAAI,CAAC,E,IAiBpC,CAMA,GAAG,CAAEX,EAAkBlH,WAAW,EAA7BkH,CAAAA,EAAkBlH,WAAW,CAAK,mBAAkB,CAAE,CAAE,KAAM,CAAC,CCxB7D,SAASuI,EAAiE,CAC/EC,UAAAA,CAAS,CACTC,QAAAA,CAAO,CACPC,eAAAA,CAAc,CACdC,aAAAA,CAAY,CACZ7L,UAAAA,CAAS,CAOV,EACC,GAAM,CAAC7B,aAAAA,CAAY,CAAC,CAAGpB,CAAAA,EAAAA,EAAAA,CAAAA,EAAgB2O,EAAU1O,SAAS,CAAE0O,EAAUzO,QAAQ,CAAEyO,EAAUI,SAAS,CAAEJ,EAAUvO,IAAI,EAC7G,CAAC8B,EAAa,CAAGD,CAAAA,EAAAA,EAAAA,CAAAA,EAAgB0M,EAAU1O,SAAS,CAAE0O,EAAUzO,QAAQ,CAAEyO,EAAUI,SAAS,CAAEJ,EAAUvO,IAAI,EAC7G,CAACmN,MAAAA,CAAK,CAAED,YAAAA,CAAW,CAAE0B,SAAAA,CAAQ,CAAEC,WAAAA,CAAU,CAAC,CAAGC,SAoKnDC,CAA4B,CAC5BC,CAAoC,CACpCC,CAAyB,EAEzB,IAAMC,EAAe/P,CAAAA,EAAAA,EAAAA,MAAAA,EAAO4P,GAAOI,OAAS,IACtCC,EAAajQ,CAAAA,EAAAA,EAAAA,MAAAA,EAAO4P,GAAOM,KAAO,IAElC,CAAClC,EAAOmC,EAAS,CAAG9P,CAAAA,EAAAA,EAAAA,QAAAA,EACxByP,GAAYF,GAASC,EACjBC,EAASM,KAAK,CAACR,EAAMI,KAAK,CAAGH,EAAcG,KAAK,CAAEJ,EAAMM,GAAG,CAAGL,EAAcG,KAAK,CAAG,GACpF,EAAE,EAGFK,EAAczQ,CAAAA,EAAAA,EAAAA,WAAAA,EAAY,KACzBkQ,GAAaF,GAAUC,IAAiBE,CAAAA,EAAavP,OAAO,CAAG,KAAKyP,CAAAA,EAAWzP,OAAO,CAAG,IAE9F2P,EAASL,EAASM,KAAK,CAACL,EAAavP,OAAO,CAAGqP,EAAcG,KAAK,CAAEC,EAAWzP,OAAO,CAAGqP,EAAcG,KAAK,CAAG,GACjH,EAAG,CAACF,EAAUF,EAAOC,EAAc,EAEnCtO,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,KACJqO,GAASE,GAAaC,CAAAA,KAAAA,EAAavP,OAAO,EAAWyP,KAAAA,EAAWzP,OAAO,IACzEuP,EAAavP,OAAO,CAAGoP,EAAMI,KAAK,CAClCC,EAAWzP,OAAO,CAAGoP,EAAMM,GAAG,CAC9BG,IAEJ,EAAG,CAACP,EAAUF,EAAOC,EAAeQ,EAAY,EAEhD,IAAMZ,EAAW7P,CAAAA,EAAAA,EAAAA,WAAAA,EAAY,KAC3BmQ,EAAavP,OAAO,CAAG8P,KAAKC,GAAG,CAACR,EAAavP,OAAO,CAAGgQ,EAAUX,GAAeG,OAAS,IACzFK,GACF,EAAG,CAACR,GAAeG,MAAOK,EAAY,EAEhCX,EAAa9P,CAAAA,EAAAA,EAAAA,WAAAA,EAAY,KAC7BqQ,EAAWzP,OAAO,CAAG8P,KAAKG,GAAG,CAACR,EAAWzP,OAAO,CAAGgQ,EAAUX,GAAeK,KAAO,IACnFG,GACF,EAAG,CAACR,GAAeK,IAAKG,EAAY,EAE9BK,EAAcX,KAAAA,EAAavP,OAAO,EAAWuP,EAAavP,OAAO,GAAKqP,GAAeG,MACrFW,EAAgBV,KAAAA,EAAWzP,OAAO,EAAWyP,EAAWzP,OAAO,GAAKqP,GAAeK,IAEzF,MAAO,CACLlC,MAAAA,EACAD,YAAaC,EAAMQ,GAAG,CAAC,CAACoC,EAAGlC,IAAMqB,EAAavP,OAAO,CAAGkO,GACxDe,SAAUiB,EAAcjB,EAAW,KACnCC,WAAYiB,EAAgBjB,EAAa,IAC3C,CACF,EAjNIL,GAASO,MACTP,GAASQ,cACTR,GAASwB,qBAELC,EAAazB,GAASyB,WAE5B,MACE,WAACC,EAAAA,CAAgBA,CAACC,KAAK,E,UACrB,WAACD,EAAAA,CAAgBA,CAACjK,MAAM,EAACpD,UAAWA,E,UAClC,UAACuN,EAAAA,CAAYA,CAAAA,CAACC,OAAQ7B,GAAS8B,eAAgBC,IAAK,CAAC,EAAEhC,EAAU1O,SAAS,CAAC,IAAI,CAAC,CAAEsE,GAAI,CAACqM,GAAI,EAAGC,WAAY,CAAC,C,GAC3G,WAACC,EAAAA,CAAIA,CAAAA,CAACvM,GAAI,CAACwM,WAAY,IAAK3C,WAAY,QAAQ,E,UAC7CO,EAAU1O,SAAS,CAAC,IAAE0O,EAAUzO,QAAQ,C,GAE3C,UAAC4Q,EAAAA,CAAIA,CAAAA,CAACvM,GAAI,CAACyM,QAAS,CAAC,E,SAAG,M,GACxB,UAACF,EAAAA,CAAIA,CAAAA,CAACvM,GAAI,CAACwM,WAAY,GAAG,E,SAAIrS,CAAAA,EAAAA,EAAAA,EAAAA,EAAaiQ,EAAUrQ,GAAG,C,GACxD,UAACwS,EAAAA,CAAIA,CAAAA,CAACvM,GAAI,CAACyM,QAAS,CAAC,E,SAAG,M,GACxB,UAACF,EAAAA,CAAIA,CAAAA,CACHvM,GAAI,CAACwM,WAAY,IAAKE,aAAc,WAAYC,SAAU,SAAU9C,WAAY,SAAU+C,UAAW,KAAK,E,SAEzGxC,EAAUvO,IAAI,GAEhBuO,YAAAA,EAAU5I,IAAI,EACb,WAACnB,OAAAA,C,UAAK,IACF+J,EAAUQ,KAAK,CAACI,KAAK,CAAC,IAAEZ,EAAUQ,KAAK,CAACM,GAAG,C,MAInD,WAACa,EAAAA,CAAgBA,CAACjM,IAAI,EAACyK,aAAcA,EAAcD,eAAgBA,E,UACjE,WAACvK,EAAAA,CAAGA,CAAAA,CACFC,GAAI,CACF6M,OAAQ,oEACRC,aAAc,cACdL,QAAS,CACX,E,UAEA,WAACM,EAAAA,C,UACEjB,GAAc,UAACkB,EAAAA,CAASlB,WAAYA,C,GACpCA,GAAc,UAACmB,EAAAA,CAAWnB,WAAYA,C,MAExCrB,GAAY,UAACsB,EAAAA,CAAgBA,CAACmB,eAAe,EAACN,UAAU,QAAQO,SAAU1C,C,GAC3E,UAACsB,EAAAA,CAAgBA,CAACqB,OAAO,E,SACvB,UAACtE,EAAiBA,CAACE,MAAOA,EAAOD,YAAaA,C,KAE/C2B,GAAc,UAACqB,EAAAA,CAAgBA,CAACmB,eAAe,EAACN,UAAU,QAAQO,SAAUzC,C,MAE/E,WAACqB,EAAAA,CAAgBA,CAACsB,OAAO,E,UACvB,WAACtB,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B5M,KAAM6M,CAAAA,EAAAA,EAAAA,EAAAA,EAAgB,CAACnR,KAAMgO,EAAUzO,QAAQ,CAAEU,WAAY+N,EAAU1O,SAAS,GAChF+I,KAAM+I,EAAAA,QAAQA,C,UAEbpD,EAAU1O,SAAS,CAAC,IAAE0O,EAAUzO,QAAQ,C,GAG1CkB,GACC,WAACkP,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B7I,KAAMgJ,EAAAA,UAAUA,CAChB/M,KAAMgN,CAAAA,EAAAA,EAAAA,EAAAA,EAAU,CACdC,MAAOvD,EAAU1O,SAAS,CAC1BS,KAAMiO,EAAUzO,QAAQ,CACxBC,UAAWwO,EAAUI,SAAS,CAC9BoD,SAAUxD,EAAUvO,IAAI,CACxBgS,WAAYxD,GAASO,MAAMI,KAC7B,G,UAECnO,EAAaiR,UAAU,CAAC,IAAEjR,IAAAA,EAAaiR,UAAU,CAAS,cAAgB,e,GAI9EnQ,GACC,WAACoO,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B7I,KAAM2D,EAAAA,WAAWA,CACjB1H,KAAMqN,CAAAA,EAAAA,EAAAA,EAAAA,EAAW,CAACJ,MAAOvD,EAAU1O,SAAS,CAAES,KAAMiO,EAAUzO,QAAQ,CAAEC,UAAW+B,GAAcqQ,GAAG,G,UAEnGrQ,GAAcsQ,QAAQrM,YAAY,YAAS,UAACsM,EAAAA,CAAYA,CAAAA,CAACC,SAAUxQ,GAAcyQ,I,MAItF,WAACrC,EAAAA,CAAgBA,CAACuB,UAAU,EAAC7I,KAAM4J,EAAAA,gBAAgBA,CAAE3N,KAAM0J,EAAUlN,GAAG,C,UACrEkN,EAAU1O,SAAS,CAAC,IAAE0O,EAAUzO,QAAQ,CAAC,IAAEyO,EAAUvO,IAAI,CACzDuO,YAAAA,EAAU5I,IAAI,CACb,uB,UAAE,IACE4I,EAAUQ,KAAK,CAACI,KAAK,CAAC,IAAEZ,EAAUQ,KAAK,CAACM,GAAG,C,GAE7C,K,WAMhB,CAEO,SAAS6B,EAAkB,CAACuB,SAAAA,CAAQ,CAA4B,EACrE,MACE,UAACvO,EAAAA,CAAGA,CAAAA,CACFC,GAAI,CACFC,EAAG,EACHuC,QAAS,OACTQ,KAAM,EACND,WAAY,SACZD,eAAgB,gBAChByL,gBAAiB,gBACjB3L,aAAc,oEACdkK,aAAc,iBAChB,E,SAECwB,C,EAGP,CAEO,SAAStB,EAAS,CAAClB,WAAAA,CAAU,CAAoC,EACtE,MACE,UAAC0C,EAAAA,CAAQA,CAAAA,CAAC5O,MAAOkM,EAAW2C,QAAQ,CAAEjO,OAAM,GAACR,GAAI,CAAC0O,SAAU,OAAQ5J,MAAO,WAAW,EAAG6J,cAAY,Y,SACnG,UAACtO,OAAAA,C,SAAM,CAAC,EAAEyL,EAAW8C,QAAQ,CAACC,YAAY,CAAC,QAAQ,EAAE/C,EAAW8C,QAAQ,CAACE,aAAa,CAAC,WAAQ,EAAEhD,EAAW2C,QAAQ,CAAC,CAAC,E,EAG5H,CAEO,SAASxB,EAAW,CAACnB,WAAAA,CAAU,CAAoC,EACxE,IAAMiD,EAAiB,IAAIC,IAAIlD,EAAWmD,UAAU,CAAEC,EAAAA,EAAeA,CAACC,MAAM,EAC5EJ,EAAeK,YAAY,CAACC,GAAG,CAAC,WAAY,IAC5C,IAAMC,EAAsB,CACzB,aAAe,uBAChB7K,KAAM8K,EAAAA,YAAYA,CAClBC,KAAM,QACN/N,QAAS,UACFqK,EAAW2D,KAAK,EACnB,MAAMC,EAAa5D,EAAWmD,UAAU,CAAEnD,EAAWlK,WAAW,CAEpE,EACC,cAAgB,sBACjB5B,GAAI,CAAC2P,oBAAqB,EAAGC,uBAAwB,CAAC,CACxD,EAEA,MACE,WAAC7P,EAAAA,CAAGA,CAAAA,CAACC,GAAI,CAACwC,QAAS,MAAM,E,UACvB,UAACqN,EAAAA,CAAUA,CAAAA,CACTnP,KAAMoL,EAAWmD,UAAU,CAC3Ba,SAAU,EAAYC,QAAQ,CAAY1R,KAAAA,EAAT,OACjCmR,KAAK,QACLxP,GAAI,CAACgQ,aAAAA,EAAcC,GAAI,EAAGC,qBAAsB,EAAGC,wBAAyB,EAAGC,YAAa,MAAM,EAClGzB,cAAY,a,SACb,K,GAGA7C,EAAW2D,KAAK,CAEf,UAACY,EAAAA,CAAUA,CAAAA,CACTC,qBAAsB,GACtB/M,GAAG,IACHgN,aAAW,QACX7P,KAAMqO,EAAeyB,QAAQ,GAC5B,GAAGlB,CAAmB,GAIzB,UAACe,EAAAA,CAAUA,CAAAA,CAACC,qBAAsB,GAAO,GAAGhB,CAAmB,G,EAIvE,CAmDA,IAAM9D,EAAW,GACXwE,EAAe,CACnB,0BAA2B,CACzBS,eAAgB,MAClB,EACA,0BAA2B,CACzBA,eAAgB,MAClB,EACA,2BAA4B,CAC1BA,eAAgB,MAClB,CACF,EAEA,eAAef,EAAagB,CAAe,CAAEtU,CAAY,EACvD,IAAMuU,EAAS,MAAMC,MAAMF,EAAS,CAACG,OAAQ,KAAK,GAC5CC,EAAO,MAAMH,EAAOG,IAAI,GACxBC,EAAW/S,SAASgT,aAAa,CAAC,KACxCD,EAASlI,YAAY,CAAC,WAAYzM,GAClC,IAAMsE,EAAOsO,IAAIiC,eAAe,CAACH,EACjCC,CAAAA,EAASrQ,IAAI,CAAGA,EAChBqQ,EAASlI,YAAY,CAAC,SAAU,UAChCkI,EAASG,KAAK,GACdlC,IAAImC,eAAe,CAACzQ,EACtB,CAEA,GAAG,CAAEyJ,EAAqBvI,WAAW,EAAhCuI,CAAAA,EAAqBvI,WAAW,CAAK,sBAAqB,CAAE,CAAE,KAAM,CAAC,CAC1E,GAAG,CAAEmL,EAAkBnL,WAAW,EAA7BmL,CAAAA,EAAkBnL,WAAW,CAAK,mBAAkB,CAAE,CAAE,KAAM,CAAC,CACpE,GAAG,CAAEoL,EAASpL,WAAW,EAApBoL,CAAAA,EAASpL,WAAW,CAAK,UAAS,CAAE,CAAE,KAAM,CAAC,CAClD,GAAG,CAAEqL,EAAWrL,WAAW,EAAtBqL,CAAAA,EAAWrL,WAAW,CAAK,YAAW,CAAE,CAAE,KAAM,CAAC,C,qCCzQ/C,SAASwP,EAAkD,CAChEhH,UAAAA,CAAS,CAETE,eAAAA,CAAc,CACdC,aAAAA,CAAY,CACZ7L,UAAAA,CAAS,CAOV,EACC,MACE,WAACqN,EAAAA,CAAgBA,CAACC,KAAK,E,UACrB,WAACD,EAAAA,CAAgBA,CAACjK,MAAM,EAACpD,UAAWA,E,UAClC,UAAC2S,EAAAA,CAAOA,CAAAA,CAAC5M,KAAM6M,EAAAA,aAAaA,CAAEtR,GAAI,CAACqM,GAAI,CAAC,C,GACxC,UAACtM,EAAAA,CAAGA,CAAAA,CAACC,GAAI,CAAC0M,aAAc,WAAYC,SAAU,SAAU9C,WAAY,QAAQ,E,SAAIO,EAAUmH,OAAO,G,GAEnG,WAACxF,EAAAA,CAAgBA,CAACjM,IAAI,EAACyK,aAAcA,EAAcD,eAAgBA,E,UACjE,WAACvK,EAAAA,CAAGA,CAAAA,CAACC,GAAI,CAACwC,QAAS,OAAQ0G,cAAe,MAAOjJ,EAAG,CAAC,E,UACnD,UAACgM,EAAAA,CAAYA,CAAAA,CAACG,IAAK,CAAC,EAAEhC,EAAU6D,MAAM,CAACuD,KAAK,CAAC,IAAI,CAAC,CAAExR,GAAI,CAACqM,GAAI,EAAGC,WAAY,CAAC,C,GAC7E,UAACvM,EAAAA,CAAGA,CAAAA,CAACC,GAAI,CAAC0M,aAAc,WAAYC,SAAU,SAAU9C,WAAY,SAAU+C,UAAW,KAAK,E,SAC3FxC,EAAU6D,MAAM,CAACuD,KAAK,G,GAI3B,UAACzR,EAAAA,CAAGA,CAAAA,CACFC,GAAI,CACF4C,aAAc,mEAChB,C,GAGF,UAACmJ,EAAAA,CAAgBA,CAACqB,OAAO,E,SACvB,UAACqE,EAAAA,CAAcA,CAAAA,CAACC,aAAcC,CAAAA,EAAAA,EAAAA,EAAAA,EAAuBvH,EAAUmH,OAAO,C,KAGxE,UAACxR,EAAAA,CAAGA,CAAAA,CACFC,GAAI,CACF4C,aAAc,mEAChB,C,GAGF,WAACmJ,EAAAA,CAAgBA,CAACsB,OAAO,E,UACvB,WAACtB,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B5M,KAAM6M,CAAAA,EAAAA,EAAAA,EAAAA,EAAgB,CAACnR,KAAMgO,EAAUwH,UAAU,CAACxV,IAAI,CAAEC,WAAY+N,EAAUwH,UAAU,CAACjE,KAAK,GAC9FlJ,KAAM+I,EAAAA,QAAQA,C,UAEbpD,EAAUwH,UAAU,CAACjE,KAAK,CAAC,IAAEvD,EAAUwH,UAAU,CAACxV,IAAI,C,GAGzD,WAAC2P,EAAAA,CAAgBA,CAACuB,UAAU,EAAC5M,KAAM0J,EAAUyH,SAAS,CAAEpN,KAAM4J,EAAAA,gBAAgBA,C,UAC3EjE,EAAUwH,UAAU,CAACjE,KAAK,CAAC,IAAEvD,EAAUwH,UAAU,CAACxV,IAAI,CAAC,WAASgO,EAAU4D,GAAG,C,WAM1F,CAEA,GAAG,CAAEoD,EAAuBxP,WAAW,EAAlCwP,CAAAA,EAAuBxP,WAAW,CAAK,wBAAuB,CAAE,CAAE,KAAM,CAAC,C,eC1CvE,SAASkQ,EAAyB,CACvC1H,UAAAA,CAAS,CACTC,QAAAA,CAAO,CACPC,eAAAA,CAAc,CACdC,aAAAA,CAAY,CACZ7L,UAAAA,CAAS,CACqB,EAC9B,GAAM,CAAC7B,aAAAA,CAAY,CAAC,CAAGpB,CAAAA,EAAAA,EAAAA,CAAAA,EAAgB2O,EAAU1O,SAAS,CAAE0O,EAAUzO,QAAQ,CAAEyO,EAAUI,SAAS,CAAEJ,EAAUvO,IAAI,EAC7G,CAAC8B,EAAa,CAAGD,CAAAA,EAAAA,EAAAA,CAAAA,EAAgB0M,EAAU1O,SAAS,CAAE0O,EAAUzO,QAAQ,CAAEyO,EAAUI,SAAS,CAAEJ,EAAUvO,IAAI,EAEnH,MACE,WAACkQ,EAAAA,CAAgBA,CAACC,KAAK,E,UACrB,WAACD,EAAAA,CAAgBA,CAACjK,MAAM,EAACpD,UAAWA,E,UAClC,UAACuN,EAAAA,CAAYA,CAAAA,CAACC,OAAQ7B,GAAS8B,eAAgBC,IAAK,CAAC,EAAEhC,EAAU1O,SAAS,CAAC,IAAI,CAAC,CAAEsE,GAAI,CAACqM,GAAI,EAAGC,WAAY,CAAC,C,GAC3G,WAACC,EAAAA,CAAIA,CAAAA,CAACvM,GAAI,CAACwM,WAAY,IAAK3C,WAAY,QAAQ,E,UAC7CO,EAAU1O,SAAS,CAAC,IAAE0O,EAAUzO,QAAQ,C,GAE3C,UAAC4Q,EAAAA,CAAIA,CAAAA,CAACvM,GAAI,CAACyM,QAAS,CAAC,E,SAAG,M,GACxB,UAACF,EAAAA,CAAIA,CAAAA,CAACvM,GAAI,CAACwM,WAAY,GAAG,E,SAAIrS,CAAAA,EAAAA,EAAAA,EAAAA,EAAaiQ,EAAUrQ,GAAG,C,GACxD,UAACwS,EAAAA,CAAIA,CAAAA,CAACvM,GAAI,CAACyM,QAAS,CAAC,E,SAAG,M,GACxB,UAACF,EAAAA,CAAIA,CAAAA,CACHvM,GAAI,CAACwM,WAAY,IAAKE,aAAc,WAAYC,SAAU,SAAU9C,WAAY,SAAU+C,UAAW,KAAK,E,SAEzGxC,EAAUvO,IAAI,G,GAGnB,WAACkQ,EAAAA,CAAgBA,CAACjM,IAAI,EAACwK,eAAgBA,EAAgBC,aAAcA,E,UAClEF,GAAW,UAAC0H,EAAAA,CAAgC1H,QAASA,C,GAEtD,WAAC0B,EAAAA,CAAgBA,CAACsB,OAAO,E,UACvB,WAACtB,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B5M,KAAM6M,CAAAA,EAAAA,EAAAA,EAAAA,EAAgB,CAACnR,KAAMgO,EAAUzO,QAAQ,CAAEU,WAAY+N,EAAU1O,SAAS,GAChF+I,KAAM+I,EAAAA,QAAQA,C,UAEbpD,EAAU1O,SAAS,CAAC,IAAE0O,EAAUzO,QAAQ,C,GAG1CkB,GACC,WAACkP,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B7I,KAAMgJ,EAAAA,UAAUA,CAChB/M,KAAMgN,CAAAA,EAAAA,EAAAA,EAAAA,EAAU,CACdC,MAAOvD,EAAU1O,SAAS,CAC1BS,KAAMiO,EAAUzO,QAAQ,CACxBC,UAAWwO,EAAUI,SAAS,CAC9BoD,SAAUxD,EAAUvO,IAAI,CACxBgS,WAAYxD,GAASO,MAAMI,KAC7B,G,UAECnO,EAAaiR,UAAU,CAAC,gB,GAI5BnQ,GACC,WAACoO,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B7I,KAAM2D,EAAAA,WAAWA,CACjB1H,KAAMqN,CAAAA,EAAAA,EAAAA,EAAAA,EAAW,CAACJ,MAAOvD,EAAU1O,SAAS,CAAES,KAAMiO,EAAUzO,QAAQ,CAAEC,UAAW+B,GAAcqQ,GAAG,G,UAEnGrQ,GAAcsQ,QAAQrM,YAAY,YAAS,UAACsM,EAAAA,CAAYA,CAAAA,CAACC,SAAUxQ,GAAcyQ,I,MAItF,WAACrC,EAAAA,CAAgBA,CAACuB,UAAU,EAAC7I,KAAM4J,EAAAA,gBAAgBA,CAAE3N,KAAM0J,EAAUlN,GAAG,C,UACrEkN,EAAU1O,SAAS,CAAC,IAAE0O,EAAUzO,QAAQ,CAAC,IAAEyO,EAAUvO,IAAI,CACzDwO,EACC,uB,UAAE,IACEA,EAAQO,KAAK,CAACI,KAAK,CAAC,IAAEX,EAAQO,KAAK,CAACM,GAAG,C,GAEzC,K,WAMhB,CAEO,SAAS6G,EAAgC,CAAC1H,QAAAA,CAAO,CAA4D,EAClH,GAAM,CAAC2H,EAAWC,EAAa,CAAG5W,CAAAA,EAAAA,EAAAA,QAAAA,EAASgP,EAAQO,KAAK,CAACI,KAAK,EACxD,CAACkH,EAASC,EAAW,CAAG9W,CAAAA,EAAAA,EAAAA,QAAAA,EAASgP,EAAQO,KAAK,CAACM,GAAG,EAClDkH,EAAYxL,CAAAA,EAAAA,EAAAA,OAAAA,EAAQ,IAAMyL,EAAYhI,EAAQiI,QAAQ,CAAEjI,EAAQiI,QAAQ,CAAChT,MAAM,EAAG,CAAC+K,EAAQiI,QAAQ,CAAC,EACpG,CAACC,EAAaC,EAAe,CAAGnX,CAAAA,EAAAA,EAAAA,QAAAA,EAA6B,WAO7DyQ,EAAazB,GAASyB,WAEtBrB,EAAW7P,CAAAA,EAAAA,EAAAA,WAAAA,EAAY,KAE3BqX,EADwBQ,SA2EExI,CAAW,CAAEyI,CAAY,EACrD,IAAMC,EAAQC,EAAY3I,EAAKyI,GACzBG,EAAcC,SA4BFC,CAAqB,EACvC,IAAIC,EACJ,IAAK,IAAMC,KAAKF,EACdC,EAAOC,EAET,OAAOD,CACT,EAlC8B/I,EAAImB,KAAK,CAAC,EAAGuH,GAAOO,QAAQ,CAAC,YAEzD,OAAOb,EAAYpI,EADM4I,GAAaF,OAAS,EAEjD,EAhFiDtI,EAAQiI,QAAQ,CAAEN,GAEjE,EAAG,CAAC3H,EAAQiI,QAAQ,CAAEN,EAAU,EAE1BtH,EAAa9P,CAAAA,EAAAA,EAAAA,WAAAA,EAAY,KAC7B,IAAIuY,EAAkBjB,EAEtB,KAAOiB,EAAkBf,GAAae,EAAkBjB,EAAU,IAChEiB,EAAkBC,SA2EMnJ,CAAW,CAAEyI,CAAY,EACrD,IAAMC,EAAQC,EAAY3I,EAAKyI,GACzBW,EAAcpJ,EAAImB,KAAK,CAACuH,GAAOW,KAAK,CAAC,UACrCC,EAAmBF,EAAcV,EAAQU,EAAYV,KAAK,CAAI1I,EAAI3K,MAAM,CAC9E,OAAO+S,EAAYpI,EAAKsJ,EAC1B,EAhF6ClJ,EAAQiI,QAAQ,CAAEa,EAAkB,GAE7EhB,EAAWgB,EAAkB,EAC/B,EAAG,CAAC9I,EAAQiI,QAAQ,CAAEJ,EAASE,EAAU,EAEzC,MACE,WAACrS,EAAAA,CAAGA,CAAAA,CACFC,GAAI,CACF6M,OAAQ,oEACRC,aAAc,cACdL,QAAS,CACX,E,UAEA,WAACM,EAAiBA,C,UAChB,WAAChN,EAAAA,CAAGA,CAAAA,CAACC,GAAI,CAACwC,QAAS,OAAQO,WAAY,WAAYN,IAAK,CAAC,E,UACvD,WAAC+Q,EAAAA,CAAgBA,CAAAA,CAAC1S,aAAW,YAAY0O,KAAK,QAAQxO,SAhClC,IAC1B,IAAMyS,EAAU,CAAE,UAAW,OAAO,CAAWC,EAAiB,CAC5DD,GAAWlB,IAAgBkB,GAC7BjB,EAAeiB,EAEnB,EA2B6FzT,GAAI,CAACwD,SAAU,CAAC,E,UACnG,UAACgQ,EAAAA,CAAgBA,CAAC3N,MAAM,EAAC8N,SAAUpB,YAAAA,E,SAA0C,S,EAAX,YAGlE,UAACiB,EAAAA,CAAgBA,CAAC3N,MAAM,EAAC8N,SAAUpB,SAAAA,E,SAAkC,M,EAAN,O,GAIhEzG,GAAc,UAACkB,EAAQA,CAAClB,WAAYA,C,MAEtCA,GAAc,UAACmB,EAAUA,CAACnB,WAAYA,C,MAExCkG,EAAY,GAAK,UAACjG,EAAAA,CAAgBA,CAACmB,eAAe,EAACN,UAAU,QAAQO,SAAU1C,C,GAChF,UAACsB,EAAAA,CAAgBA,CAACqB,OAAO,E,SACtBmF,YAAAA,EACC,UAACxS,EAAAA,CAAGA,CAAAA,CACFqE,UAAU,yCACVpE,GAAI,CAAC,eAAgB,CAACuO,gBAAiBqF,GAAS,CAAC,EAAEA,EAAMC,MAAM,CAACC,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,E,SAGhF,UAACtC,EAAAA,CAAcA,CAAAA,CACbC,aAAcC,CAAAA,EAAAA,EAAAA,EAAAA,EACZtH,EAAQiI,QAAQ,CAChB,KACA,EAAE,CACF,GACAjU,KAAAA,EACAA,KAAAA,EACA2T,EACAE,E,KAKN,UAAC5R,OAAAA,C,SACC,UAACP,EAAAA,CAAGA,CAAAA,CAACwD,GAAG,MAAMvD,GAAI,CAACmJ,UAAW,MAAM,E,SACjCkB,EAAQiI,QAAQ,E,KAKxBJ,EAAUE,GAAa,UAACrG,EAAAA,CAAgBA,CAACmB,eAAe,EAACN,UAAU,QAAQO,SAAUzC,C,KAG5F,CAGA,SAAS2H,EAAYpI,CAAW,CAAE0I,CAAa,EAC7C,OAAOqB,SA2CMjB,CAA2B,EACxC,IAAIkB,EAAI,EACR,IAAK,IAAMrI,KAAKmH,EACdkB,IAEF,OAAOA,CACT,EAjDehK,EAAImB,KAAK,CAAC,EAAGuH,GAAOO,QAAQ,CAAC,QAAU,CACtD,CAkBA,SAASN,EAAY3I,CAAW,CAAEyI,CAAY,EAC5C,GAAIA,IAAAA,EACF,OAAO,EAET,IAAIC,EAAQ,GACZ,IAAK,IAAIjJ,EAAI,EAAGA,GAAKgJ,EAAMhJ,IAEzB,GAAIiJ,KADJA,CAAAA,EAAQ1I,EAAIiK,OAAO,CAAC,KAAMvB,EAAQ,EAAC,EAEjC,OAAO1I,EAAI3K,MAAM,CAGrB,OAAOqT,EAAQ,CACjB,CAoBA,GAAG,CAAEb,EAAyBlQ,WAAW,EAApCkQ,CAAAA,EAAyBlQ,WAAW,CAAK,0BAAyB,CAAE,CAAE,KAAM,CAAC,CAClF,GAAG,CAAEmQ,EAAgCnQ,WAAW,EAA3CmQ,CAAAA,EAAgCnQ,WAAW,CAAK,iCAAgC,CAAE,CAAE,KAAM,CAAC,CCtOzF,SAASuS,EAA4D,CAC1E/J,UAAAA,CAAS,CAETE,eAAAA,CAAc,CACdC,aAAAA,CAAY,CACZ7L,UAAAA,CAAS,CAOV,EACC,MACE,WAACqN,EAAAA,CAAgBA,CAACC,KAAK,E,UACrB,WAACD,EAAAA,CAAgBA,CAACjK,MAAM,EAACpD,UAAWA,E,UAClC,UAAC2S,EAAAA,CAAOA,CAAAA,CAAC5M,KAAM6M,EAAAA,aAAaA,CAAEtR,GAAI,CAACqM,GAAI,CAAC,C,GACxC,UAACtM,EAAAA,CAAGA,CAAAA,CAACC,GAAI,CAAC0M,aAAc,WAAYC,SAAU,SAAU9C,WAAY,QAAQ,E,SAAIO,EAAUxK,KAAK,G,GAEjG,WAACmM,EAAAA,CAAgBA,CAACjM,IAAI,EAACyK,aAAcA,EAAcD,eAAgBA,E,UACjE,WAACvK,EAAAA,CAAGA,CAAAA,CAACC,GAAI,CAACwC,QAAS,OAAQ0G,cAAe,MAAOjJ,EAAG,CAAC,E,UACnD,UAACgM,EAAAA,CAAYA,CAAAA,CAACG,IAAK,CAAC,EAAEhC,EAAUgK,WAAW,CAAC,IAAI,CAAC,CAAEpU,GAAI,CAACqM,GAAI,EAAGC,WAAY,CAAC,C,GAC5E,UAACvM,EAAAA,CAAGA,CAAAA,CAACC,GAAI,CAAC0M,aAAc,WAAYC,SAAU,SAAU9C,WAAY,SAAU+C,UAAW,KAAK,E,SAC3FxC,EAAUgK,WAAW,G,GAI1B,UAACrU,EAAAA,CAAGA,CAAAA,CACFC,GAAI,CACF4C,aAAc,mEAChB,C,GAGF,UAACmJ,EAAAA,CAAgBA,CAACqB,OAAO,E,SACvB,UAACqE,EAAAA,CAAcA,CAAAA,CAACC,aAAcC,CAAAA,EAAAA,EAAAA,EAAAA,EAAuBvH,EAAUxK,KAAK,C,KAGtE,UAACG,EAAAA,CAAGA,CAAAA,CACFC,GAAI,CACF4C,aAAc,mEAChB,C,GAGF,WAACmJ,EAAAA,CAAgBA,CAACsB,OAAO,E,UACvB,WAACtB,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B5M,KAAM6M,CAAAA,EAAAA,EAAAA,EAAAA,EAAgB,CAACnR,KAAMgO,EAAUwH,UAAU,CAACxV,IAAI,CAAEC,WAAY+N,EAAUwH,UAAU,CAACvV,UAAU,GACnGoI,KAAM+I,EAAAA,QAAQA,C,UAEbpD,EAAUwH,UAAU,CAACvV,UAAU,CAAC,IAAE+N,EAAUwH,UAAU,CAACxV,IAAI,C,GAG9D,UAAC2P,EAAAA,CAAgBA,CAACuB,UAAU,EAAC5M,KAAM0J,EAAUlN,GAAG,CAAEuH,KAAM4J,EAAAA,gBAAgBA,C,SACrEjE,EAAUlN,GAAG,G,QAM1B,CAEA,GAAG,CAAEiX,EAA4BvS,WAAW,EAAvCuS,CAAAA,EAA4BvS,WAAW,CAAK,6BAA4B,CAAE,CAAE,KAAM,CAAC,CCnDjF,SAASyS,EAAqF,CACnGjK,UAAAA,CAAS,CACTC,QAAAA,CAAO,CACPC,eAAAA,CAAc,CACdC,aAAAA,CAAY,CACZ7L,UAAAA,CAAS,CAOV,EACC,IAAM4V,EAAoB,IAAIlX,IACxBmX,EAAmB,IAAInX,IAE7B,GAAIiN,GAASmK,OAAS,mBACpB,IAAK,IAAMC,KAAOpK,EAAQqK,qBAAqB,EAAI,EAAE,CAAE,CACrD,GAAI,CAACD,EAAI5I,mBAAmB,CAAE,SAC9B,IAAM3K,EAAM,CAAC,EAAEuT,EAAI/Y,SAAS,CAAC,CAAC,EAAE+Y,EAAI9Y,QAAQ,CAAC,CAAC,EAAE8Y,EAAI5Y,IAAI,CAAC,CAAC,CACrDyY,EAAkBK,GAAG,CAACzT,IACzBoT,EAAkBjF,GAAG,CAACnO,EAAK,EAAE,EAE/BoT,EAAkBM,GAAG,CAAC1T,GAAM3B,IAAI,CAACkV,EACnC,MACK,GAAIpK,GAASmK,OAAS,gBAAiB,CAC5C,IAAK,IAAMC,KAAOpK,EAAQwK,kBAAkB,EAAI,EAAE,CAAE,CAClD,GAAI,CAACJ,EAAI5I,mBAAmB,CAAE,SAC9B,IAAM3K,EAAM,CAAC,EAAEuT,EAAI/Y,SAAS,CAAC,CAAC,EAAE+Y,EAAI9Y,QAAQ,CAAC,CAAC,EAAE8Y,EAAI5Y,IAAI,CAAC,CAAC,CACrDyY,EAAkBK,GAAG,CAACzT,IACzBoT,EAAkBjF,GAAG,CAACnO,EAAK,EAAE,EAE/BoT,EAAkBM,GAAG,CAAC1T,GAAM3B,IAAI,CAACkV,EACnC,CAEA,IAAK,IAAM1a,KAAOsQ,GAASyK,mBAAqB,EAAE,CAAE,CAClD,GAAI,CAAC/a,EAAI8R,mBAAmB,CAAE,SAC9B,IAAM3K,EAAM,CAAC,EAAEnH,EAAI2B,SAAS,CAAC,CAAC,EAAE3B,EAAI4B,QAAQ,CAAC,CAAC,EAAE5B,EAAI8B,IAAI,CAAC,CAAC,CACrD0Y,EAAiBI,GAAG,CAACzT,IACxBqT,EAAiBlF,GAAG,CAACnO,EAAK,EAAE,EAE9BqT,EAAiBK,GAAG,CAAC1T,GAAM3B,IAAI,CAACxF,EAClC,CACF,CAEA,IAAMgb,EAAgB,IAAIT,EAAkBU,MAAM,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE,EAAI,IAAIT,EAAiBS,MAAM,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE,CACjGC,EAAiBX,EAAkB9E,IAAI,CAAG,EAC1C0F,EAAgBX,EAAiB/E,IAAI,CAAG,EAExC2F,EAAuB,IAAIb,EAAkBU,MAAM,GAAG,CAAC1V,MAAM,CAC7D8V,EAAmB,IAAId,EAAkBU,MAAM,GAAG,CAACK,MAAM,CAAC,CAACC,EAAKC,IAAaD,EAAMC,EAASjW,MAAM,CAAE,GACpGkW,EAAsB,IAAIjB,EAAiBS,MAAM,GAAG,CAAC1V,MAAM,CAC3DmW,EAAkB,IAAIlB,EAAiBS,MAAM,GAAG,CAACK,MAAM,CAAC,CAACC,EAAKI,IAAaJ,EAAMI,EAASpW,MAAM,CAAE,GAElG,CAACzC,aAAAA,CAAY,CAAC,CAAGpB,CAAAA,EAAAA,EAAAA,CAAAA,EACrBsZ,GAAerZ,UACfqZ,GAAepZ,SACfoZ,GAAevK,UACfuK,GAAelZ,MAGX,CAAC8B,EAAa,CAAGD,CAAAA,EAAAA,EAAAA,CAAAA,EACrBqX,GAAerZ,UACfqZ,GAAepZ,SACfoZ,GAAevK,UACfuK,GAAelZ,MAGjB,MACE,WAACkQ,EAAAA,CAAgBA,CAACC,KAAK,E,UACrB,UAACD,EAAAA,CAAgBA,CAACjK,MAAM,EAACpD,UAAWA,E,SAAY0L,EAAUhO,IAAI,GAC9D,WAAC2P,EAAAA,CAAgBA,CAACjM,IAAI,EAACyK,aAAcA,EAAcD,eAAgBA,E,UAChE2K,GACC,uB,UACE,WAAClJ,EAAAA,CAAgBA,CAAC4J,cAAc,E,UAC7BP,EAAiB,IAAEA,IAAAA,EAAyB,aAAe,cAC3DD,EAAuB,EAAI,CAAC,QAAQ,EAAEA,EAAqB,MAAM,CAAC,CAAG,K,GAEvE,IAAIb,EAAkBU,MAAM,GAAG,CAACxL,GAAG,CAAC,CAACoM,EAAMlM,IAC1C,UAACqC,EAAAA,CAAgBA,CAAC8J,qBAAqB,EAAqBjW,MAAOgW,CAAI,CAAC,EAAE,CAAE/Z,IAAI,CAAEia,cAAepM,IAAAA,E,SAC/F,UAACqC,EAAAA,CAAgBA,CAACqB,OAAO,E,SACtBwI,EAAKpM,GAAG,CAAC,CAACiL,EAAKsB,IACdtB,EAAI5I,mBAAmB,CACrB,UAAC/C,EAAiBA,CAEhBG,mBAAoBwL,IAAAA,EAAI5I,mBAAmB,CAACvM,MAAM,CAClD0J,MAAOyL,EAAI5I,mBAAmB,CAC9B9C,YAAaiN,EAAevB,E,EAHvBsB,GAKL,K,IAVmCH,CAAI,CAAC,EAAE,CAAE/Z,IAAI,G,GAkB/DqZ,GACC,uB,UACE,WAACnJ,EAAAA,CAAgBA,CAAC4J,cAAc,E,UAC7BF,EAAgB,IAAEA,IAAAA,EAAwB,YAAc,aACxDD,EAAsB,EAAI,CAAC,QAAQ,EAAEA,EAAoB,MAAM,CAAC,CAAG,K,GAErE,IAAIjB,EAAiBS,MAAM,GAAG,CAACxL,GAAG,CAAC,CAACyM,EAAMvM,IACzC,UAACqC,EAAAA,CAAgBA,CAAC8J,qBAAqB,EAErCjW,MAAOqW,CAAI,CAAC,EAAE,CAAEpa,IAAI,CACpBia,cAAepM,IAAAA,GAAW,CAACuL,E,SAE3B,UAAClJ,EAAAA,CAAgBA,CAACqB,OAAO,E,SACtB6I,EAAKzM,GAAG,CAAC,CAACzP,EAAKgc,IACdhc,EAAI8R,mBAAmB,CACrB,UAAC/C,EAAiBA,CAEhBG,mBAAoBlP,IAAAA,EAAI8R,mBAAmB,CAACvM,MAAM,CAClD0J,MAAOjP,EAAI8R,mBAAmB,CAC9B9C,YAAaiN,EAAejc,E,EAHvBgc,GAKL,K,IAbHE,CAAI,CAAC,EAAE,CAAEpa,IAAI,G,GAqB1B,WAACkQ,EAAAA,CAAgBA,CAACsB,OAAO,E,UACtB0H,GACC,WAAChJ,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B5M,KAAM6M,CAAAA,EAAAA,EAAAA,EAAAA,EAAgB,CAACnR,KAAM2Y,EAAcpZ,QAAQ,CAAEU,WAAY0Y,EAAcrZ,SAAS,GACxF+I,KAAM+I,EAAAA,QAAQA,C,UAEbuH,EAAcrZ,SAAS,CAAC,IAAEqZ,EAAcpZ,QAAQ,C,GAIpDkB,GAAgBkY,GACf,WAAChJ,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B7I,KAAMgJ,EAAAA,UAAUA,CAChB/M,KAAMgN,CAAAA,EAAAA,EAAAA,EAAAA,EAAU,CACdC,MAAOoH,EAAcrZ,SAAS,CAC9BS,KAAM4Y,EAAcpZ,QAAQ,CAC5BC,UAAWmZ,EAAcvK,SAAS,CAClCoD,SAAUmH,EAAclZ,IAAI,G,UAG7BgB,EAAaiR,UAAU,CAAC,IAAEjR,IAAAA,EAAaiR,UAAU,CAAS,cAAgB,e,GAI9EnQ,GAAgBoX,GACf,WAAChJ,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B7I,KAAM2D,EAAAA,WAAWA,CACjB1H,KAAMqN,CAAAA,EAAAA,EAAAA,EAAAA,EAAW,CACfJ,MAAOoH,EAAcrZ,SAAS,CAC9BS,KAAM4Y,EAAcpZ,QAAQ,CAC5BC,UAAW+B,GAAcqQ,GAC3B,G,UAECrQ,GAAcsQ,QAAQrM,YAAY,YAAS,UAACsM,EAAAA,CAAYA,CAAAA,CAACC,SAAUxQ,GAAcyQ,I,MAIrF2G,GACC,WAAChJ,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B7I,KAAM4J,EAAAA,gBAAgBA,CACtB3N,KAAMwV,CAAAA,EAAAA,EAAAA,EAAAA,EAAS,CACbvI,MAAOoH,EAAcrZ,SAAS,CAC9BS,KAAM4Y,EAAcpZ,QAAQ,CAC5BC,UAAWmZ,EAAcvK,SAAS,CAClCoD,SAAUmH,EAAclZ,IAAI,G,UAG7BkZ,EAAcrZ,SAAS,CAAC,IAAEqZ,EAAcpZ,QAAQ,CAAC,IAAEoZ,EAAclZ,IAAI,C,WAOpF,CAEA,SAASma,EAAe,CAACpL,MAAAA,CAAK,CAAW,SACvC,EAGO,MAAUA,EAAMM,GAAG,CAAGN,EAAMI,KAAK,CAAG,GAAGmL,IAAI,CAAC,MAAM3M,GAAG,CAAC,CAACoC,EAAGlC,IAAMkB,EAAMI,KAAK,CAAGtB,GAF5E,EAAE,CAKb,GAAG,CAAE2K,EAAuBzS,WAAW,EAAlCyS,CAAAA,EAAuBzS,WAAW,CAAK,wBAAuB,CAAE,CAAE,KAAM,CAAC,CCjM9E,IAAMwU,EAAiB,GACrB,GAAoBpL,MAIbqL,EAAcnL,GAAG,CAAG,CAAC,EAAEmL,EAAcrL,KAAK,CAAC,CAAC,EAAEqL,EAAcnL,GAAG,CAAC,CAAC,CAAG,CAAC,EAAEmL,EAAcrL,KAAK,CAAC,CAAC,CAH1F,GAMLsL,EAAoB,IACxB,IAAM1L,EAAQwL,EAAehM,EAAUiM,aAAa,EAC9Cxa,EAAOuO,EAAUlN,GAAG,CAAC7C,KAAK,CAACkc,OAAOC,QAAQ,CAACC,IAAI,CAAC,CAAC,EAAE,CACzD,MAAO,CAAC/V,KAAM0J,EAAUlN,GAAG,CAAG0N,EAAO/O,KAAMA,EAAO+O,EAAOA,MAAAA,CAAK,CAChE,EAEO,SAAS8L,EAAsD,CACpEtM,UAAAA,CAAS,CACTC,QAAAA,CAAO,CACPC,eAAAA,CAAc,CACdC,aAAAA,CAAY,CACZ7L,UAAAA,CAAS,CAOV,EACC,IAAMiY,EACJ,EAAYC,QAAQ,EAAIxM,EAAUyM,QAAQ,EACxCzM,EAAU0M,IAAI,EAAI1M,EAAU2M,IAAI,CAE9B,CAACla,aAAAA,CAAY,CAAC,CAAGpB,CAAAA,EAAAA,EAAAA,CAAAA,EACrBkb,EAAiBjb,SAAS,CAC1Bib,EAAiBhb,QAAQ,CACzBgb,EAAiBnM,SAAS,CAC1BmM,EAAiB9a,IAAI,EAGjB,CAAC8B,EAAa,CAAGD,CAAAA,EAAAA,EAAAA,CAAAA,EACrBiZ,EAAiBjb,SAAS,CAC1Bib,EAAiBhb,QAAQ,CACzBgb,EAAiBnM,SAAS,CAC1BmM,EAAiB9a,IAAI,EAEjB,CAAC6E,KAAAA,CAAI,CAAE7E,KAAAA,CAAI,CAAE+O,MAAAA,CAAK,CAAC,CAAG0L,EAAkBlM,GAE9C,MACE,WAAC2B,EAAAA,CAAgBA,CAACC,KAAK,E,UACrB,WAACD,EAAAA,CAAgBA,CAACjK,MAAM,EAACpD,UAAWA,E,UAClC,UAACuN,EAAAA,CAAYA,CAAAA,CACXC,OAAQ7B,GAAS8B,eACjBC,IAAK,CAAC,EAAEuK,EAAiBjb,SAAS,CAAC,IAAI,CAAC,CACxCsE,GAAI,CAACqM,GAAI,EAAGC,WAAY,CAAC,C,GAE3B,WAACvM,EAAAA,CAAGA,CAAAA,CAACC,GAAI,CAAC0M,aAAc,WAAYC,SAAU,SAAU9C,WAAY,QAAQ,E,UACzE8M,EAAiBjb,SAAS,CAAC,IAAEib,EAAiBhb,QAAQ,CAAC,IAAEgb,EAAiB9a,IAAI,CAAC,IAAE+O,E,MAGtF,UAACmB,EAAAA,CAAgBA,CAACjM,IAAI,EAACyK,aAAcA,EAAcD,eAAgBA,E,SACjE,WAACyB,EAAAA,CAAgBA,CAACsB,OAAO,E,UACvB,WAACtB,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B5M,KAAM6M,CAAAA,EAAAA,EAAAA,EAAAA,EAAgB,CAACnR,KAAMua,EAAiBhb,QAAQ,CAAEU,WAAYsa,EAAiBjb,SAAS,GAC9F+I,KAAM+I,EAAAA,QAAQA,C,UAEbmJ,EAAiBjb,SAAS,CAAC,IAAEib,EAAiBhb,QAAQ,C,GAGxDkB,GACC,WAACkP,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B7I,KAAMgJ,EAAAA,UAAUA,CAChB/M,KAAMgN,CAAAA,EAAAA,EAAAA,EAAAA,EAAU,CACdC,MAAOgJ,EAAiBjb,SAAS,CACjCS,KAAMwa,EAAiBhb,QAAQ,CAC/BC,UAAW+a,EAAiBnM,SAAS,CACrCoD,SAAU+I,EAAiB9a,IAAI,G,UAGhCgB,EAAaiR,UAAU,CAAC,IAAEjR,IAAAA,EAAaiR,UAAU,CAAS,cAAgB,e,GAI9EnQ,GACC,WAACoO,EAAAA,CAAgBA,CAACuB,UAAU,EAC1B7I,KAAM2D,EAAAA,WAAWA,CACjB1H,KAAMqN,CAAAA,EAAAA,EAAAA,EAAAA,EAAW,CACfJ,MAAOgJ,EAAiBjb,SAAS,CACjCS,KAAMwa,EAAiBhb,QAAQ,CAC/BC,UAAW+B,GAAcqQ,GAC3B,G,UAECrQ,GAAcsQ,QAAQrM,YAAY,YAAS,UAACsM,EAAAA,CAAYA,CAAAA,CAACC,SAAUxQ,GAAcyQ,I,MAItF,UAACrC,EAAAA,CAAgBA,CAACuB,UAAU,EAAC7I,KAAM4J,EAAAA,gBAAgBA,CAAE3N,KAAMA,E,SACxD7E,C,UAMb,CAEA,GAAG,CAAE6a,EAAyB9U,WAAW,EAApC8U,CAAAA,EAAyB9U,WAAW,CAAK,0BAAyB,CAAE,CAAE,KAAM,CAAC,C,eC3F3E,SAASoV,EAAwB,CAACC,YAAAA,CAAW,CAA+B,EACjF,GAAM,CAAC7M,UAAAA,CAAS,CAAEC,QAAAA,CAAO,CAAEC,eAAAA,CAAc,CAAEC,aAAAA,CAAY,CAAE2M,iBAAAA,CAAgB,CAAC,CAAGC,IAE7E,MACE,UAACC,EAAAA,CACChN,UAAWA,EACXC,QAASA,EACTC,eAAgBA,EAChBC,aAAcA,EACd7L,UAAWuY,EAAcC,EAAmB7Y,KAAAA,C,EAGlD,CAEA,SAAS+Y,EAA4D,CACnEhN,UAAAA,CAAS,CACTC,QAAAA,CAAO,CACPC,eAAAA,CAAc,CACdC,aAAAA,CAAY,CACZ7L,UAAAA,CAAS,CAOV,EACC,OAAQ0L,EAAU5I,IAAI,EACpB,IAAK,SACH,MACE,UAAC6S,EAAsBA,CAErBjK,UAAWA,EAGXC,QACEA,EAEFC,eAAgBA,EAChBC,aAAcA,EACd7L,UAAWA,C,EATN2Y,CAAAA,EAAAA,EAAAA,EAAAA,EAAYjN,GAYvB,KAAK,OACL,IAAK,UACH,MAAO,eAAgCkN,YAAY,CACjD,UAACxF,EAAwBA,CAEvB1H,UAAWA,EACXC,QAASA,EACTE,aAAcA,EACdD,eAAgBA,EAChB5L,UAAWA,C,EALN2Y,CAAAA,EAAAA,EAAAA,EAAAA,EAAYjN,IAQnB,UAACD,EAAoBA,CAEnBC,UAAWA,EACXC,QAASA,EACTC,eAAgBA,EAChBC,aAAcA,EACd7L,UAAWA,C,EALN2Y,CAAAA,EAAAA,EAAAA,EAAAA,EAAYjN,GAQvB,KAAK,YACH,MACE,UAACsM,EAAwBA,CAEvBtM,UAAWA,EACXC,QAASA,EACTC,eAAgBA,EAChBC,aAAcA,EACd7L,UAAWA,C,EALN2Y,CAAAA,EAAAA,EAAAA,EAAAA,EAAYjN,GAQvB,KAAK,SACH,MACE,UAACgH,EAAsBA,CAErBhH,UAAWA,EAEXE,eAAgBA,EAChBC,aAAcA,EACd7L,UAAWA,C,EALN2Y,CAAAA,EAAAA,EAAAA,EAAAA,EAAYjN,GAQvB,KAAK,eACH,MACE,UAAC+J,EAA2BA,CAE1B/J,UAAWA,EAEXE,eAAgBA,EAChBC,aAAcA,EACd7L,UAAWA,C,EALN2Y,CAAAA,EAAAA,EAAAA,EAAAA,EAAYjN,GAQvB,KAAK,aACH,MAAO,UAACmN,EAAAA,CAAyBA,CAAAA,CAA8BnN,UAAWA,EAAW1L,UAAWA,C,EAAzD2Y,CAAAA,EAAAA,EAAAA,EAAAA,EAAYjN,GACrD,SACE,OAAO,IACX,CACF,CAKO,SAAS+M,IACd,IAAMnV,EAAUC,CAAAA,EAAAA,EAAAA,CAAAA,IAEVmI,EAAYtO,CADJiG,EAAAA,EAAAA,EAAAA,IACUyV,iBAAiB,CAEnC,CAACvT,UAAAA,CAAS,CAAEwT,QAAAA,CAAO,CAAEC,KAAAA,CAAI,CAAC,CAAGC,CAAAA,EAAAA,EAAAA,CAAAA,EAAS,CAE1CC,SAAU,CAAC,UAAW,aAAcxN,GAAW5I,KAAM4I,EAAYiN,CAAAA,EAAAA,EAAAA,EAAAA,EAAYjN,GAAa/L,KAAAA,EAAU,CACpGwZ,QAAS,UACP,GAAI,CAACzN,EAAW,OAAO,KAEvB,IAAMuG,EAAS,MAAM3O,EAAQ8V,OAAO,CAACC,gBAAgB,CAAC3N,UACtD,EAAYxN,EAAE,CAEP+T,EAAOqH,OAAO,CAFE,IAGzB,EAEAC,UAAWC,OAAOC,SAAS,GAK7B,MAAO,CACL/N,UAAAA,EACA8M,iBAJuBtc,CAAAA,EAAAA,EAAAA,WAAAA,EAAY,IAAMoH,EAAQoW,eAAe,CAAC,MAAO,CAACpW,EAAQ,EAKjFqI,QAASqN,GAAQrZ,KAAAA,EACjBiM,eAAgBrG,EAChBsG,aAAckN,CAChB,CACF,CAEA,GAAG,CAAET,EAAwBpV,WAAW,EAAnCoV,CAAAA,EAAwBpV,WAAW,CAAK,yBAAwB,CAAE,CAAE,KAAM,CAAC,CAChF,GAAG,CAAEwV,EAA4BxV,WAAW,EAAvCwV,CAAAA,EAA4BxV,WAAW,CAAK,6BAA4B,CAAE,CAAE,KAAM,CAAC,CChKjF,SAASyW,IACd,GAAM,CAACnB,iBAAAA,CAAgB,CAAE9M,UAAAA,CAAS,CAAC,CAAG+M,IAChC,CAACmB,WAAAA,CAAU,CAAC,CAAGC,CAAAA,EAAAA,EAAAA,EAAAA,IACfC,EAAcF,EAAaG,EAAAA,EAAUA,CAACC,KAAK,CAC3C9Y,EAgCN,GAAmB4B,OACZ,aACI,CAAC,yBAAyB,EAAE4I,EAAUuO,KAAK,CAAC,CAAC,CAAC,CAE9C,YAnCX,MACE,WAACjZ,EAAAA,CAAMA,CAAAA,CACLoB,aAAYlB,EACZgZ,OAAQ,CAAC,CAACxO,EACV1L,UAAWwY,EACXlX,GAAI,CACFwC,QAAS,OACT0G,cAAe,SACfyD,SAAU,SACVG,aAAc,4BACd+L,OAAQ,EACR,GAAIL,EACA,CACErT,OAAQ,CAAC,OAAQ,OAAO,CACxB2T,IAAK,OACLjZ,MAAO,OACT,EACA,CACEiZ,IAAK,OACLjZ,MAAO,QACP6O,SAAU,QACZ,CAAC,E,UAGP,UAAChP,EAAAA,CAAMA,CAACoC,MAAM,E,SAAElC,C,GAChB,UAACoX,EAAuBA,CAAAA,G,EAG9B,CAWA,GAAG,CAAEqB,EAA8BzW,WAAW,EAAzCyW,CAAAA,EAA8BzW,WAAW,CAAK,+BAA8B,CAAE,CAAE,KAAM,CAAC,C","sources":["ui/packages/ref-utils/ref-utils.ts","ui/packages/use-client-value/use-client-value.ts","ui/packages/use-contributors/use-contributors.ts","ui/packages/use-latest-commit/use-latest-commit.ts","ui/packages/use-render-phase/use-render-phase.ts","ui/packages/copilot-chat/components/ExperimentsDialog.tsx","ui/packages/copilot-chat/components/Header.tsx","ui/packages/copilot-reference-preview/components/SimpleCodeListing.tsx","ui/packages/copilot-reference-preview/components/CodeReferencePreview.tsx","ui/packages/copilot-reference-preview/components/CommitReferencePreview.tsx","ui/packages/copilot-reference-preview/components/MarkdownReferencePreview.tsx","ui/packages/copilot-reference-preview/components/PullRequestReferencePreview.tsx","ui/packages/copilot-reference-preview/components/SymbolReferencePreview.tsx","ui/packages/copilot-reference-preview/components/FileDiffReferencePreview.tsx","ui/packages/copilot-reference-preview/CopilotReferencePreview.tsx","ui/packages/copilot-reference-preview/CopilotReferencePreviewDialog.tsx"],"sourcesContent":["export type RefType = 'branch' | 'tag'\n\nexport const mapRefType = (ref?: string): RefType | undefined => {\n  if (!ref) return undefined\n  if (ref.startsWith('refs/tags/')) return 'tag'\n  if (ref.startsWith('refs/heads/')) return 'branch'\n  return undefined\n}\nexport const qualifyRef = (ref: string, refType: RefType) => {\n  if (refType === 'branch') return `refs/heads/${ref}`\n  if (refType === 'tag') return `refs/tags/${ref}`\n  return ref\n}\nexport const unqualifyRef = (ref?: string) => {\n  if (!ref) return undefined\n  const refType = mapRefType(ref)\n  if (!refType) return ref\n  const [, , ...unqualifiedRef] = ref.split('/')\n  return unqualifiedRef.join('/')\n}\n","import {useCallback, useState, useRef, type DependencyList} from 'react'\n// eslint-disable-next-line no-restricted-imports\nimport {useHydratedEffect} from '@github-ui/use-hydrated-effect'\n// eslint-disable-next-line no-restricted-imports\nimport {RenderPhase, useRenderPhase} from '@github-ui/use-render-phase'\n\ntype ClientValueCallback<T> = (previousValue?: T) => T\n\n/**\n * This hook allows reading browser-only values in an SSR / hydration safe manner while guaranteeing the minimum\n * number of re-renders during CSR.\n * - In CSR, this hook will resolve the `clientValueCallback` on first render.\n * - In SSR, the `serverValue` will be returned.\n * - Finally, after hydration, the `clientValueCallback` will be resolved.\n *\n * Note that between SSR and hydration, this can cause flashes of unhydrated content when server and client values\n * differ, however this hook will not result in hydration mismatch warnings and bugs.\n *\n * @see https://thehub.github.com/epd/engineering/dev-practicals/frontend/react/ssr/ssr-tools/#useclientvalue-source\n *\n * @example\n * const [origin, updateOrigin] = useClientValue(() => window.location.origin, 'github.com', [window?.location?.origin])\n *\n * @param clientValueCallback A function that returns the value to be used on the client.\n * @param serverValue A value to be used during SSR on the server.\n * @param deps A dependency array used to memoize the `clientValueCallback`.\n *         Note that if including a browser global in the array, be sure to check for it's existence\n *         (eg `window?.api?.value`) as it may not be available in SSR.\n * @returns  [\n *             `clientValue` (Either a browser-only value, or a server fallback),\\n\n *             `updateValue` (A function that can be used to update the `clientValue` by re-running the `clientValueCallback`)\n *           ]\n *\n * *Credit https://www.benmvp.com/blog/handling-react-server-mismatch-error/ for inspiration*\n */\nexport function useClientValue<T>(\n  clientValueCallback: ClientValueCallback<T>,\n  serverValue: T,\n  deps?: DependencyList,\n): [T, () => void]\nexport function useClientValue<T>(\n  clientValueCallback: ClientValueCallback<T>,\n  serverValue?: T,\n  deps?: DependencyList,\n): [T | undefined, () => void]\nexport function useClientValue<T>(\n  clientValueCallback: ClientValueCallback<T>,\n  serverValue?: T,\n  deps: DependencyList = [],\n) {\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const memoizedCallback = useCallback(clientValueCallback, deps)\n  const renderPhase = useRenderPhase()\n  const isCSRFirstRender = useRef(renderPhase === RenderPhase.ClientRender)\n\n  const [clientValue, setClientValue] = useState<T | undefined>(() => {\n    if (renderPhase === RenderPhase.ClientRender) return memoizedCallback()\n    return serverValue\n  })\n\n  const updateClientValue = useCallback(() => {\n    setClientValue(memoizedCallback)\n  }, [memoizedCallback])\n\n  useHydratedEffect(() => {\n    // in CSR on first render we've already set the value in the `useState` above\n    if (!isCSRFirstRender.current) {\n      setClientValue(memoizedCallback)\n    }\n    isCSRFirstRender.current = false\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [memoizedCallback, ...deps])\n\n  return [clientValue, updateClientValue]\n}\n","import {repositoryTreePath} from '@github-ui/paths'\nimport type {ContributorsInfo} from '@github-ui/repos-types'\nimport {verifiedFetchJSON} from '@github-ui/verified-fetch'\nimport {useEffect, useState} from 'react'\n\ninterface ContributorsState {\n  contributors?: ContributorsInfo\n  loading?: boolean\n  error?: boolean\n}\n\n/**\n * Retrieve information of contributors of current path\n *\n * returns an object with contributors, loading state and error\n * while loading returns {loading: true}\n * if cannot retrieve contributor , returns {error: true}\n */\nexport function useContributors(\n  repoOwner: string | undefined,\n  repoName: string | undefined,\n  commitish: string | undefined,\n  path: string | undefined,\n): ContributorsState {\n  const [state, setState] = useState<ContributorsState>({loading: true})\n\n  const fileContributorsPath =\n    repoName && repoOwner && commitish && path\n      ? repositoryTreePath({\n          repo: {name: repoName, ownerLogin: repoOwner},\n          commitish,\n          action: 'file-contributors',\n          path,\n        })\n      : null\n\n  useEffect(() => {\n    if (!fileContributorsPath) return\n\n    let cancelled = false\n    const update = async () => {\n      setState({loading: true})\n      const response = await verifiedFetchJSON(fileContributorsPath)\n\n      if (cancelled) {\n        return\n      }\n\n      try {\n        if (response.ok) {\n          setState({contributors: await response.json()})\n        } else {\n          setState({error: true})\n        }\n      } catch (e) {\n        setState({error: true})\n      }\n    }\n\n    update()\n\n    // This method will be called if fileContributorsPath changes, in order to ignore the old result\n    return function cancel() {\n      cancelled = true\n    }\n  }, [fileContributorsPath])\n\n  return state\n}\n","import memoize from '@github/memoize'\nimport {repositoryTreePath} from '@github-ui/paths'\nimport type {CommitWithStatus} from '@github-ui/repos-types'\nimport {SOFT_NAV_STATE} from '@github-ui/soft-nav/states'\nimport {verifiedFetchJSON} from '@github-ui/verified-fetch'\nimport {useEffect, useState} from 'react'\n\nasync function fetchJSON(url: string): Promise<CommitWithStatus | undefined> {\n  const response = await verifiedFetchJSON(url)\n  if (response.ok) {\n    return await response.json()\n  } else {\n    return undefined\n  }\n}\n\nconst memoizeCache = new Map()\nconst memoizeFetchJSON = memoize(fetchJSON, {cache: memoizeCache})\n\nexport function resetMemoizeFetchJSON() {\n  memoizeCache.clear()\n}\n\n/**\n * Retrieve information of latest commit of current blob or ref and path\n * If we have a current blob payload and it has latest commit, it will be returned immediately\n * Otherwise, we will fetch the latest commit from the server with the ref and path\n * Tree commits are always fetched from the server using the ref and path\n *\n * returns an array with latest commit, loading state and error\n * while loading returns [undefined, true, false]\n * if cannot retrieve latest commit, returns [undefined, false, true]\n */\nexport function useLatestCommit(\n  repoOwner: string | undefined,\n  repoName: string | undefined,\n  commitish: string | undefined,\n  path: string | undefined,\n): [CommitWithStatus | undefined, boolean, boolean] {\n  const [latestCommit, setLatestCommit] = useState<CommitWithStatus>()\n  const [error, setError] = useState(false)\n  const [loading, setLoading] = useState(true)\n\n  const commitInfoPath =\n    repoName && repoOwner && commitish && path\n      ? repositoryTreePath({\n          repo: {name: repoName, ownerLogin: repoOwner},\n          commitish,\n          action: 'latest-commit',\n          path,\n        })\n      : null\n\n  // Adding a hook-specific reset call solution to reset memoize cache\n  // We accept the cost of resetting the cache once per hook instance, as the cost of resetting the cache is cheap\n  // If we implement Relay, it replaces this solution\n  useEffect(() => {\n    document.addEventListener(SOFT_NAV_STATE.START, resetMemoizeFetchJSON)\n\n    return () => {\n      document.removeEventListener(SOFT_NAV_STATE.START, resetMemoizeFetchJSON)\n    }\n  })\n\n  useEffect(() => {\n    let cancelled = false\n\n    const update = async () => {\n      if (!commitInfoPath) return\n\n      setError(false)\n      setLoading(true)\n      setLatestCommit(undefined)\n      const commit = await memoizeFetchJSON(commitInfoPath)\n\n      if (cancelled) {\n        return\n      }\n\n      try {\n        if (commit) {\n          setLatestCommit(commit)\n        } else {\n          setError(true)\n        }\n      } catch (e) {\n        setError(true)\n      }\n      setLoading(false)\n    }\n\n    update()\n\n    return function cancel() {\n      cancelled = true\n    }\n  }, [commitInfoPath, commitish])\n\n  return [latestCommit, loading, error]\n}\n","import {RenderPhaseContext, RenderPhase} from '@github-ui/render-phase-provider'\nimport {useContext} from 'react'\n\n/**\n * @package\n *\n * Prefer `useClientValue` over this hook. You can think of it as \"environment sniffing\" vs \"feature detection\"\n * (with [similar considerations to browser sniffing](https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent#avoiding_user_agent_detection)):\n * `useClientValue` is a feature detection mechanism, whereas `useRenderPhase` is an environment sniffing mechanism.\n *\n * This hook allows you to determine what phase of rendering you are in:\n * - During SSR, there are three distinct phases of rendering: `ServerRender`, `ClientHydrate` and `ClientRender`.\n * - During CSR, there is only one phase: `ClientRender`.\n */\nexport function useRenderPhase() {\n  const renderPhase = useContext(RenderPhaseContext)\n  return renderPhase\n}\n\nexport {RenderPhase}\n","/* eslint eslint-comments/no-use: off */\nimport {Box, FormControl, Link, Portal, TextInput} from '@primer/react'\nimport {Dialog} from '@primer/react/drafts'\nimport {useRef, useState} from 'react'\n\nimport {getCopilotExperiments, setCopilotExperiments} from '../utils/experiments'\n\nconst experimentsQuery = 'repo:github/copilot-api path:experiments.go'\n\nexport interface ExperimentsDialogProps {\n  experimentsDialogRef: React.MutableRefObject<HTMLDivElement | null>\n  onDismiss: () => void\n}\n\nexport const ExperimentsDialog = ({onDismiss, experimentsDialogRef}: ExperimentsDialogProps): JSX.Element => {\n  const [experiments, setExperiments] = useState(() => getCopilotExperiments().join(','))\n  const [statusMessage, setStatusMessage] = useState<string | undefined>(undefined)\n  const statusMessageAriaHack = useRef('\\u200B')\n  const saveExperiments = () => {\n    const experimentsArray = []\n    for (const pair of experiments.split(',')) {\n      if (pair.trim() === '') continue\n\n      if (pair.split('=').length !== 2) {\n        const invalidMessage = `Invalid experiment key=value pair${statusMessageAriaHack.current}`\n        setStatusMessage(invalidMessage)\n        statusMessageAriaHack.current += '\\u200B'\n        return\n      } else {\n        setStatusMessage('')\n      }\n      experimentsArray.push(pair)\n    }\n\n    setCopilotExperiments(experimentsArray)\n    onDismiss()\n  }\n\n  return (\n    <Portal>\n      <Dialog ref={experimentsDialogRef} onClose={onDismiss} title={'Experiments'} width=\"xlarge\">\n        <Dialog.Body>\n          <Box sx={{p: 3}}>\n            <FormControl>\n              <FormControl.Label>Experiments</FormControl.Label>\n              <FormControl.Caption>\n                <span>\n                  List experiments as comma separated <code>key=value</code> pairs. To see available experiments,{' '}\n                  <Link inline target=\"_blank\" href={`/search?q=${encodeURIComponent(experimentsQuery)}`}>\n                    read this code\n                  </Link>\n                  .\n                </span>\n              </FormControl.Caption>\n              <TextInput\n                sx={{width: '100%', my: 2}}\n                aria-label=\"Experiments\"\n                name=\"experiments\"\n                value={experiments}\n                onChange={e => setExperiments(e.target.value)}\n                onKeyDown={e => {\n                  // eslint-disable-next-line @github-ui/ui-commands/no-manual-shortcut-logic\n                  if (e.key === 'Enter') {\n                    saveExperiments()\n                  }\n                }}\n              />\n              {statusMessage && <FormControl.Validation variant=\"error\">{statusMessage}</FormControl.Validation>}\n            </FormControl>\n          </Box>\n        </Dialog.Body>\n        <Dialog.Footer>\n          <Dialog.Buttons\n            buttons={[\n              {type: 'button', onClick: onDismiss, content: 'Cancel'},\n              {type: 'submit', onClick: saveExperiments, content: 'Save', buttonType: 'primary'},\n            ]}\n          />\n        </Dialog.Footer>\n      </Dialog>\n    </Portal>\n  )\n}\n\ntry{ ExperimentsDialog.displayName ||= 'ExperimentsDialog' } catch {}","import {sendEvent} from '@github-ui/hydro-analytics'\nimport {IconButtonWithTooltip} from '@github-ui/icon-button-with-tooltip'\nimport {isStaff} from '@github-ui/stats'\nimport {useNavigate} from '@github-ui/use-navigate'\nimport {\n  ArrowLeftIcon,\n  BeakerIcon,\n  ChevronDownIcon,\n  ChevronUpIcon,\n  CommentDiscussionIcon,\n  HistoryIcon,\n  KebabHorizontalIcon,\n  PlusIcon,\n  ScreenFullIcon,\n  TrashIcon,\n  XIcon,\n} from '@primer/octicons-react'\nimport {ActionList, ActionMenu, Box, Button, Heading, Label} from '@primer/react'\nimport {useCallback, useMemo, useState} from 'react'\n\nimport {COPILOT_PATH, isDocset, isRepository} from '../utils/copilot-chat-helpers'\nimport type {CopilotChatThread} from '../utils/copilot-chat-types'\nimport {copilotFeatureFlags} from '../utils/copilot-feature-flags'\nimport {useChatState} from '../utils/CopilotChatContext'\nimport {useChatManager} from '../utils/CopilotChatManagerContext'\nimport AllTopicsButton from './AllTopicsButton'\nimport CopilotBadge from './CopilotBadge'\nimport {ExperimentsDialog} from './ExperimentsDialog'\nimport {ActionMenuOverlay} from './PortalContainerUtils'\n\nexport const HEADER_BUTTON_ID = 'copilot-chat-header-button'\n\nexport interface HeaderProps {\n  view: 'thread' | 'list'\n  experimentsDialogRef: React.MutableRefObject<HTMLDivElement | null>\n  showExperimentsDialog: boolean\n  setShowExperimentsDialog: (value: boolean) => void\n  isImmersive?: boolean\n  isCollapsed?: boolean\n  isResponding?: boolean\n  hasUnreadMessages?: boolean\n  startResize?: (e: React.MouseEvent, horizontal: boolean, vertical: boolean) => void\n}\n\nexport const Header = (props: HeaderProps) => {\n  const state = useChatState()\n  const manager = useChatManager()\n  const thread = manager.getSelectedThread(state)\n  const {showTopicPicker, messages} = state\n\n  const handleThreadDelete = useCallback(async () => {\n    return thread && manager.deleteThread(thread)\n  }, [thread, manager])\n\n  return (\n    <Box\n      sx={{\n        display: 'flex',\n        gap: 2,\n        p: 2,\n        pl: state.mode === 'immersive' ? 1 : 3,\n        borderBottom: state.messages.length > 0 ? '1px solid' : 'none',\n        borderColor: 'border.default',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n      }}\n    >\n      <Box sx={{display: 'flex', flex: 1, minWidth: 0}}>\n        {props.view === 'thread' ? (\n          !showTopicPicker && !props.isImmersive && messages.length === 0 && !state.chatIsCollapsed ? (\n            <AllTopicsButton />\n          ) : (\n            <Heading\n              as=\"h2\"\n              sx={{\n                fontSize: 1,\n                display: 'flex',\n                alignItems: 'center',\n                flexGrow: 1,\n                gap: 2,\n                minWidth: 0,\n                cursor: copilotFeatureFlags.copilotFloatingButton ? 'default' : 'pointer',\n              }}\n              // This is an affordance, there is a keyboard-accessible IconButtonWithTooltip that expands the chat below\n              onClick={\n                props.isCollapsed\n                  ? () => manager.expandChat()\n                  : copilotFeatureFlags.copilotFloatingButton\n                    ? undefined\n                    : () => manager.collapseChat()\n              }\n            >\n              {props.view === 'thread' ? (\n                <>\n                  {(messages.length > 0 || state.chatIsCollapsed) && (\n                    <CopilotBadge isLoading={props.isResponding} hasUnreadMessages={props.hasUnreadMessages} />\n                  )}\n\n                  {thread?.name ? (\n                    <span className=\"Truncate\">\n                      {/* Primer tooltips are broken in portals, so we need to use a title here */}\n                      {/* eslint-disable-next-line github/a11y-no-title-attribute */}\n                      <span className=\"Truncate-text\" title={thread.name}>\n                        {thread.name}\n                      </span>\n                    </span>\n                  ) : props.isResponding && state.chatIsCollapsed ? (\n                    <span>Responding…</span>\n                  ) : state.chatIsCollapsed ? (\n                    <span>Ask Copilot</span>\n                  ) : (\n                    !showTopicPicker && <span>New conversation</span>\n                  )}\n                </>\n              ) : (\n                'Copilot'\n              )}\n            </Heading>\n          )\n        ) : (\n          <ReturnToCurrentThreadButton />\n        )}\n      </Box>\n\n      <Box\n        sx={{\n          display: 'flex',\n          alignItems: 'center',\n        }}\n      >\n        {!props.isCollapsed && (\n          <>\n            {props.view === 'thread' ? (\n              <>\n                <IconButtonWithTooltip\n                  hidden={messages.length === 0}\n                  variant=\"invisible\"\n                  icon={PlusIcon}\n                  label=\"New conversation\"\n                  tooltipDirection=\"w\"\n                  onClick={async () => {\n                    await manager.createThread()\n                  }}\n                  sx={{color: 'fg.muted'}}\n                />\n                <ThreadOptionButton\n                  handleDelete={handleThreadDelete}\n                  thread={thread}\n                  setShowExperimentsDialog={props.setShowExperimentsDialog}\n                />\n              </>\n            ) : (\n              <IconButtonWithTooltip\n                variant=\"invisible\"\n                icon={PlusIcon}\n                label=\"New conversation\"\n                tooltipDirection=\"w\"\n                onClick={async () => {\n                  await manager.createThread()\n                }}\n                sx={{color: 'fg.muted'}}\n              />\n            )}\n          </>\n        )}\n\n        {!props.isImmersive && (\n          <>\n            {!props.isCollapsed && (\n              <Box\n                sx={{\n                  mx: 2,\n                  height: '20px',\n                  width: '1px',\n                  bg: 'border.muted',\n                }}\n              />\n            )}\n            {!copilotFeatureFlags.copilotFloatingButton && (\n              <IconButtonWithTooltip\n                variant=\"invisible\"\n                icon={props.isCollapsed ? ChevronUpIcon : ChevronDownIcon}\n                label={props.isCollapsed ? 'Expand' : 'Collapse'}\n                tooltipDirection=\"w\"\n                onClick={() => {\n                  setCopilotButtonAriaExpanded(props.isCollapsed)\n                  props.isCollapsed ? manager.expandChat() : manager.collapseChat()\n                }}\n                sx={{color: 'fg.muted'}}\n                data-hotkey=\"Shift+Z\"\n              />\n            )}\n            <IconButtonWithTooltip\n              variant=\"invisible\"\n              icon={XIcon}\n              aria-label=\"Close\"\n              label=\"Close Copilot chat\"\n              tooltipDirection=\"w\"\n              onClick={() => {\n                setCopilotButtonAriaExpanded(false)\n                manager.closeChat(state.chatVisibleSettingPath)\n              }}\n              sx={{color: 'fg.muted'}}\n              data-hotkey=\"Shift+X\"\n            />\n          </>\n        )}\n      </Box>\n      {props.showExperimentsDialog && (\n        <ExperimentsDialog\n          experimentsDialogRef={props.experimentsDialogRef}\n          onDismiss={() => props.setShowExperimentsDialog(false)}\n        />\n      )}\n    </Box>\n  )\n}\n\nconst ReturnToCurrentThreadButton = () => {\n  const {mode} = useChatState()\n  const manager = useChatManager()\n\n  return (\n    <Button\n      leadingVisual={ArrowLeftIcon}\n      variant=\"invisible\"\n      onClick={() => manager.viewCurrentThread()}\n      sx={{color: 'fg.muted', marginLeft: mode === 'assistive' ? '-8px' : undefined}}\n    >\n      Back\n    </Button>\n  )\n}\n\ninterface ThreadOptionButtonProps {\n  handleDelete: () => void\n  thread?: CopilotChatThread | null\n  setShowExperimentsDialog: (value: boolean) => void\n}\n\nexport const ThreadOptionButton = (props: ThreadOptionButtonProps) => {\n  const [open, setOpen] = useState(false)\n  const {currentTopic, mode, streamingMessage} = useChatState()\n  const {thread} = props\n  const navigate = useNavigate()\n  const manager = useChatManager()\n\n  const handleClickViewAll = useCallback(() => {\n    manager.viewAllThreads()\n    sendEvent('copilot.view-conversations-clicked')\n  }, [manager])\n\n  const handleSelectDelete = () => {\n    props.handleDelete()\n    setOpen(false)\n  }\n\n  const userIsStaff = useMemo(() => {\n    return isStaff()\n  }, [])\n\n  const deleteDisabled = !props.thread\n\n  const immersiveURL: string = useMemo(() => {\n    if (thread) {\n      return `${COPILOT_PATH}/c/${thread.id}`\n    } else if (currentTopic && isRepository(currentTopic)) {\n      return `${COPILOT_PATH}/r/${currentTopic.ownerLogin}/${currentTopic.name}`\n    } else if (currentTopic && isDocset(currentTopic)) {\n      return `${COPILOT_PATH}/d/${currentTopic.id}`\n    } else {\n      return COPILOT_PATH\n    }\n  }, [thread, currentTopic])\n\n  return (\n    <>\n      <ActionMenu open={open} onOpenChange={() => setOpen(prev => !prev)}>\n        <ActionMenu.Anchor>\n          <IconButtonWithTooltip\n            icon={KebabHorizontalIcon}\n            variant=\"invisible\"\n            label=\"Open conversation options\"\n            tooltipDirection=\"sw\"\n            hideTooltip={open}\n            sx={{color: 'fg.muted'}}\n          />\n        </ActionMenu.Anchor>\n        <ActionMenuOverlay>\n          <ActionList>\n            {mode !== 'immersive' && (\n              <ActionList.Item onSelect={() => navigate(immersiveURL)} disabled={!!streamingMessage}>\n                <ActionList.LeadingVisual>\n                  <ScreenFullIcon />\n                </ActionList.LeadingVisual>\n                Take conversation to immersive\n              </ActionList.Item>\n            )}\n            <ActionList.Item\n              variant={deleteDisabled ? 'default' : 'danger'}\n              onSelect={handleSelectDelete}\n              disabled={deleteDisabled}\n              aria-describedby=\"delete-conversation-description\"\n            >\n              <ActionList.LeadingVisual>\n                <TrashIcon />\n              </ActionList.LeadingVisual>\n              Delete conversation\n              <p id=\"delete-conversation-description\" className=\"sr-only\">\n                This is a destructive action that cannot be undone\n              </p>\n            </ActionList.Item>\n            <ActionList.Divider />\n            {mode === 'assistive' && (\n              <ActionList.Item onSelect={handleClickViewAll}>\n                <ActionList.LeadingVisual>\n                  <HistoryIcon />\n                </ActionList.LeadingVisual>\n                View all conversations\n              </ActionList.Item>\n            )}\n            <ActionList.LinkItem\n              href=\"https://gh.io/copilot-enterprise-feedback\"\n              rel=\"noopener noreferrer\"\n              target=\"_blank\"\n            >\n              <ActionList.LeadingVisual>\n                <CommentDiscussionIcon />\n              </ActionList.LeadingVisual>\n              Give feedback\n            </ActionList.LinkItem>\n            {userIsStaff && (\n              <ActionList.Item onSelect={() => props.setShowExperimentsDialog(true)}>\n                <ActionList.LeadingVisual>\n                  <BeakerIcon />\n                </ActionList.LeadingVisual>\n                Configure experiments\n                <ActionList.TrailingVisual>\n                  <Label variant=\"attention\">Staff</Label>\n                </ActionList.TrailingVisual>\n              </ActionList.Item>\n            )}\n          </ActionList>\n        </ActionMenuOverlay>\n      </ActionMenu>\n    </>\n  )\n}\n\nexport function setCopilotButtonAriaExpanded(ariaExpanded?: boolean) {\n  const copilotButton = document.getElementById(HEADER_BUTTON_ID)\n  // If it is currently collapsed, we are expanding the chat\n  copilotButton?.setAttribute('aria-expanded', ariaExpanded ? 'true' : 'false')\n}\n\ntry{ Header.displayName ||= 'Header' } catch {}\ntry{ ReturnToCurrentThreadButton.displayName ||= 'ReturnToCurrentThreadButton' } catch {}\ntry{ ThreadOptionButton.displayName ||= 'ThreadOptionButton' } catch {}","import type {SafeHTMLString} from '@github-ui/safe-html'\nimport {SafeHTMLDiv} from '@github-ui/safe-html'\nimport {Box} from '@primer/react'\n\ninterface SimpleCodeListingProps {\n  lineNumbers: number[]\n  lines: SafeHTMLString[]\n  trimLineBeginnings?: boolean\n}\n\nexport function SimpleCodeListing({lineNumbers, lines, trimLineBeginnings}: SimpleCodeListingProps) {\n  return (\n    <Box sx={{display: 'flex', flexDirection: 'row', overflowX: 'auto', pb: 3}}>\n      <table\n        style={{\n          fontSize: '12px',\n          fontFamily: 'ui-monospace,SFMono-Regular,SF Mono,Menlo,Consolas,Liberation Mono,monospace',\n          overflowX: 'auto',\n        }}\n      >\n        {lineNumbers.map((num, i) => (\n          <tr key={`line-row-${num}`}>\n            <td key={num}>{num}</td>\n            <td style={{whiteSpace: 'pre', paddingLeft: '16px'}}>\n              <SafeHTMLDiv\n                key={`line-${i}`}\n                html={\n                  trimLineBeginnings\n                    ? trimLineBeginning(lines[i] ?? ('' as SafeHTMLString))\n                    : lines[i] || ('\\n' as SafeHTMLString)\n                }\n              />\n            </td>\n          </tr>\n        ))}\n      </table>\n    </Box>\n  )\n}\n\nfunction trimLineBeginning(str: SafeHTMLString): SafeHTMLString {\n  return str.trimStart() as SafeHTMLString\n}\n\ntry{ SimpleCodeListing.displayName ||= 'SimpleCodeListing' } catch {}","import type {\n  FileReference,\n  LineRange,\n  ReferenceDetails,\n  ReferenceHeaderInfo,\n  SnippetReference,\n} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport {GitHubAvatar} from '@github-ui/github-avatar'\nimport {blamePath, commitPath, repoOverviewUrl} from '@github-ui/paths'\nimport {unqualifyRef} from '@github-ui/ref-utils'\nimport {ssrSafeLocation} from '@github-ui/ssr-utils'\nimport {useContributors} from '@github-ui/use-contributors'\nimport {useLatestCommit} from '@github-ui/use-latest-commit'\nimport {DownloadIcon, HistoryIcon, LinkExternalIcon, PeopleIcon, RepoIcon} from '@primer/octicons-react'\nimport {Box, IconButton, LinkButton, RelativeTime, Text, Truncate} from '@primer/react'\nimport {useCallback, useEffect, useRef, useState, type PropsWithChildren} from 'react'\n\nimport {ReferencePreview} from './ReferencePreview'\nimport {SimpleCodeListing} from './SimpleCodeListing'\n\nexport function CodeReferencePreview<T extends SnippetReference | FileReference>({\n  reference,\n  details,\n  detailsLoading,\n  detailsError,\n  onDismiss,\n}: {\n  reference: T\n  details: ReferenceDetails<T> | undefined\n  detailsLoading: boolean\n  detailsError: boolean\n  onDismiss?: () => void\n}) {\n  const {contributors} = useContributors(reference.repoOwner, reference.repoName, reference.commitOID, reference.path)\n  const [latestCommit] = useLatestCommit(reference.repoOwner, reference.repoName, reference.commitOID, reference.path)\n  const {lines, lineNumbers, expandUp, expandDown} = useExpandableRange(\n    details?.range,\n    details?.expandedRange,\n    details?.highlightedContents,\n  )\n  const headerInfo = details?.headerInfo\n\n  return (\n    <ReferencePreview.Frame>\n      <ReferencePreview.Header onDismiss={onDismiss}>\n        <GitHubAvatar square={details?.repoIsOrgOwned} src={`${reference.repoOwner}.png`} sx={{mr: 2, flexShrink: 0}} />\n        <Text sx={{fontWeight: 600, whiteSpace: 'nowrap'}}>\n          {reference.repoOwner}/{reference.repoName}\n        </Text>\n        <Text sx={{marginX: 1}}>·</Text>\n        <Text sx={{fontWeight: 400}}>{unqualifyRef(reference.ref)}</Text>\n        <Text sx={{marginX: 1}}>·</Text>\n        <Text\n          sx={{fontWeight: 400, textOverflow: 'ellipsis', overflow: 'hidden', whiteSpace: 'nowrap', direction: 'rtl'}}\n        >\n          {reference.path}\n        </Text>\n        {reference.type === 'snippet' && (\n          <span>\n            :{reference.range.start}-{reference.range.end}\n          </span>\n        )}\n      </ReferencePreview.Header>\n      <ReferencePreview.Body detailsError={detailsError} detailsLoading={detailsLoading}>\n        <Box\n          sx={{\n            border: '1px solid var(--borderColor-default, var(--color-border-default))',\n            borderRadius: '6px 6px 0 0',\n            marginX: 3,\n          }}\n        >\n          <BlobPreviewHeader>\n            {headerInfo && <BlobSize headerInfo={headerInfo} />}\n            {headerInfo && <RawButtons headerInfo={headerInfo} />}\n          </BlobPreviewHeader>\n          {expandUp && <ReferencePreview.ContentExpander direction=\"above\" onExpand={expandUp} />}\n          <ReferencePreview.Content>\n            <SimpleCodeListing lines={lines} lineNumbers={lineNumbers} />\n          </ReferencePreview.Content>\n          {expandDown && <ReferencePreview.ContentExpander direction=\"below\" onExpand={expandDown} />}\n        </Box>\n        <ReferencePreview.Details>\n          <ReferencePreview.DetailLink\n            href={repoOverviewUrl({name: reference.repoName, ownerLogin: reference.repoOwner})}\n            icon={RepoIcon}\n          >\n            {reference.repoOwner}/{reference.repoName}\n          </ReferencePreview.DetailLink>\n\n          {contributors && (\n            <ReferencePreview.DetailLink\n              icon={PeopleIcon}\n              href={blamePath({\n                owner: reference.repoOwner,\n                repo: reference.repoName,\n                commitish: reference.commitOID,\n                filePath: reference.path,\n                lineNumber: details?.range.start,\n              })}\n            >\n              {contributors.totalCount} {contributors.totalCount === 1 ? 'contributor' : 'contributors'}\n            </ReferencePreview.DetailLink>\n          )}\n\n          {latestCommit && (\n            <ReferencePreview.DetailLink\n              icon={HistoryIcon}\n              href={commitPath({owner: reference.repoOwner, repo: reference.repoName, commitish: latestCommit?.oid})}\n            >\n              {latestCommit?.author?.displayName} updated <RelativeTime datetime={latestCommit?.date} />\n            </ReferencePreview.DetailLink>\n          )}\n\n          <ReferencePreview.DetailLink icon={LinkExternalIcon} href={reference.url}>\n            {reference.repoOwner}/{reference.repoName}/{reference.path}\n            {reference.type === 'snippet' ? (\n              <>\n                #{reference.range.start}-{reference.range.end}\n              </>\n            ) : null}\n          </ReferencePreview.DetailLink>\n        </ReferencePreview.Details>\n      </ReferencePreview.Body>\n    </ReferencePreview.Frame>\n  )\n}\n\nexport function BlobPreviewHeader({children}: PropsWithChildren<object>) {\n  return (\n    <Box\n      sx={{\n        p: 2,\n        display: 'flex',\n        flex: 1,\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        backgroundColor: 'canvas.subtle',\n        borderBottom: '1px solid var(--borderColor-default, var(--color-border-default))',\n        borderRadius: '6px 6px 0px 0px',\n      }}\n    >\n      {children}\n    </Box>\n  )\n}\n\nexport function BlobSize({headerInfo}: {headerInfo: ReferenceHeaderInfo}) {\n  return (\n    <Truncate title={headerInfo.blobSize} inline sx={{maxWidth: '100%', color: 'fg.subtle'}} data-testid=\"blob-size\">\n      <span>{`${headerInfo.lineInfo.truncatedLoc} lines (${headerInfo.lineInfo.truncatedSloc} loc) · ${headerInfo.blobSize}`}</span>\n    </Truncate>\n  )\n}\n\nexport function RawButtons({headerInfo}: {headerInfo: ReferenceHeaderInfo}) {\n  const lfsDownloadUrl = new URL(headerInfo.rawBlobUrl, ssrSafeLocation.origin)\n  lfsDownloadUrl.searchParams.set('download', '')\n  const downloadButtonProps = {\n    ['aria-label']: 'Download raw content',\n    icon: DownloadIcon,\n    size: 'small',\n    onClick: async () => {\n      if (!headerInfo.isLfs) {\n        await downloadFile(headerInfo.rawBlobUrl, headerInfo.displayName)\n      }\n    },\n    ['data-testid']: 'download-raw-button',\n    sx: {borderTopLeftRadius: 0, borderBottomLeftRadius: 0},\n  } as const\n\n  return (\n    <Box sx={{display: 'flex'}}>\n      <LinkButton\n        href={headerInfo.rawBlobUrl}\n        download={!headerInfo.viewable ? 'true' : undefined}\n        size=\"small\"\n        sx={{linkButtonSx, px: 2, borderTopRightRadius: 0, borderBottomRightRadius: 0, borderRight: 'none'}}\n        data-testid=\"raw-button\"\n      >\n        Raw\n      </LinkButton>\n      {headerInfo.isLfs ? (\n        // eslint-disable-next-line primer-react/a11y-remove-disable-tooltip\n        <IconButton\n          unsafeDisableTooltip={true}\n          as=\"a\"\n          data-turbo=\"false\"\n          href={lfsDownloadUrl.toString()}\n          {...downloadButtonProps}\n        />\n      ) : (\n        // eslint-disable-next-line primer-react/a11y-remove-disable-tooltip\n        <IconButton unsafeDisableTooltip={true} {...downloadButtonProps} />\n      )}\n    </Box>\n  )\n}\n\nfunction useExpandableRange<T>(\n  range: LineRange | undefined,\n  expandedRange: LineRange | undefined,\n  allLines: T[] | undefined,\n) {\n  const startLineRef = useRef(range?.start ?? -1)\n  const endLineRef = useRef(range?.end ?? -1)\n\n  const [lines, setLines] = useState<T[]>(\n    allLines && range && expandedRange\n      ? allLines.slice(range.start - expandedRange.start, range.end - expandedRange.start + 1)\n      : [],\n  )\n\n  const updateLines = useCallback(() => {\n    if (!allLines || !range || !expandedRange || startLineRef.current < 0 || endLineRef.current < 0) return\n\n    setLines(allLines.slice(startLineRef.current - expandedRange.start, endLineRef.current - expandedRange.start + 1))\n  }, [allLines, range, expandedRange])\n\n  useEffect(() => {\n    if (range && allLines && (startLineRef.current === -1 || endLineRef.current === -1)) {\n      startLineRef.current = range.start\n      endLineRef.current = range.end\n      updateLines()\n    }\n  }, [allLines, range, expandedRange, updateLines])\n\n  const expandUp = useCallback(() => {\n    startLineRef.current = Math.max(startLineRef.current - pageSize, expandedRange?.start ?? -1)\n    updateLines()\n  }, [expandedRange?.start, updateLines])\n\n  const expandDown = useCallback(() => {\n    endLineRef.current = Math.min(endLineRef.current + pageSize, expandedRange?.end ?? -1)\n    updateLines()\n  }, [expandedRange?.end, updateLines])\n\n  const canExpandUp = startLineRef.current !== -1 && startLineRef.current !== expandedRange?.start\n  const canExpandDown = endLineRef.current !== -1 && endLineRef.current !== expandedRange?.end\n\n  return {\n    lines,\n    lineNumbers: lines.map((_, i) => startLineRef.current + i),\n    expandUp: canExpandUp ? expandUp : null,\n    expandDown: canExpandDown ? expandDown : null,\n  }\n}\n\nconst pageSize = 25\nconst linkButtonSx = {\n  '&:hover:not([disabled])': {\n    textDecoration: 'none',\n  },\n  '&:focus:not([disabled])': {\n    textDecoration: 'none',\n  },\n  '&:active:not([disabled])': {\n    textDecoration: 'none',\n  },\n}\n\nasync function downloadFile(rawHref: string, name: string) {\n  const result = await fetch(rawHref, {method: 'get'})\n  const blob = await result.blob()\n  const aElement = document.createElement('a')\n  aElement.setAttribute('download', name)\n  const href = URL.createObjectURL(blob)\n  aElement.href = href\n  aElement.setAttribute('target', '_blank')\n  aElement.click()\n  URL.revokeObjectURL(href)\n}\n\ntry{ CodeReferencePreview.displayName ||= 'CodeReferencePreview' } catch {}\ntry{ BlobPreviewHeader.displayName ||= 'BlobPreviewHeader' } catch {}\ntry{ BlobSize.displayName ||= 'BlobSize' } catch {}\ntry{ RawButtons.displayName ||= 'RawButtons' } catch {}","import {transformContentToHTML} from '@github-ui/copilot-chat/utils/markdown'\nimport type {CommitReference} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport {GitHubAvatar} from '@github-ui/github-avatar'\nimport {MarkdownViewer} from '@github-ui/markdown-viewer'\nimport {repoOverviewUrl} from '@github-ui/paths'\nimport {GitCommitIcon, LinkExternalIcon, RepoIcon} from '@primer/octicons-react'\nimport {Box, Octicon} from '@primer/react'\n\nimport {ReferencePreview} from './ReferencePreview'\n\nexport function CommitReferencePreview<T extends CommitReference>({\n  reference,\n  // TODO: details,\n  detailsLoading,\n  detailsError,\n  onDismiss,\n}: {\n  reference: T\n  // details: ReferenceDetails<T> | undefined\n  detailsLoading: boolean\n  detailsError: boolean\n  onDismiss?: () => void\n}) {\n  return (\n    <ReferencePreview.Frame>\n      <ReferencePreview.Header onDismiss={onDismiss}>\n        <Octicon icon={GitCommitIcon} sx={{mr: 2}} />\n        <Box sx={{textOverflow: 'ellipsis', overflow: 'hidden', whiteSpace: 'nowrap'}}>{reference.message}</Box>\n      </ReferencePreview.Header>\n      <ReferencePreview.Body detailsError={detailsError} detailsLoading={detailsLoading}>\n        <Box sx={{display: 'flex', flexDirection: 'row', p: 3}}>\n          <GitHubAvatar src={`${reference.author.login}.png`} sx={{mr: 2, flexShrink: 0}} />\n          <Box sx={{textOverflow: 'ellipsis', overflow: 'hidden', whiteSpace: 'nowrap', direction: 'rtl'}}>\n            {reference.author.login}\n          </Box>\n        </Box>\n\n        <Box\n          sx={{\n            borderBottom: '1px solid var(--borderColor-default, var(--color-border-default))',\n          }}\n        />\n\n        <ReferencePreview.Content>\n          <MarkdownViewer verifiedHTML={transformContentToHTML(reference.message)} />\n        </ReferencePreview.Content>\n\n        <Box\n          sx={{\n            borderBottom: '1px solid var(--borderColor-default, var(--color-border-default))',\n          }}\n        />\n\n        <ReferencePreview.Details>\n          <ReferencePreview.DetailLink\n            href={repoOverviewUrl({name: reference.repository.name, ownerLogin: reference.repository.owner})}\n            icon={RepoIcon}\n          >\n            {reference.repository.owner}/{reference.repository.name}\n          </ReferencePreview.DetailLink>\n\n          <ReferencePreview.DetailLink href={reference.permalink} icon={LinkExternalIcon}>\n            {reference.repository.owner}/{reference.repository.name}/commit/{reference.oid}\n          </ReferencePreview.DetailLink>\n        </ReferencePreview.Details>\n      </ReferencePreview.Body>\n    </ReferencePreview.Frame>\n  )\n}\n\ntry{ CommitReferencePreview.displayName ||= 'CommitReferencePreview' } catch {}","import {transformContentToHTML} from '@github-ui/copilot-chat/utils/markdown'\nimport type {\n  FileReference,\n  FileReferenceDetails,\n  SnippetReference,\n  SnippetReferenceDetails,\n} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport {GitHubAvatar} from '@github-ui/github-avatar'\nimport {MarkdownViewer} from '@github-ui/markdown-viewer'\nimport {blamePath, commitPath, repoOverviewUrl} from '@github-ui/paths'\nimport {unqualifyRef} from '@github-ui/ref-utils'\nimport {useContributors} from '@github-ui/use-contributors'\nimport {useLatestCommit} from '@github-ui/use-latest-commit'\nimport {HistoryIcon, LinkExternalIcon, PeopleIcon, RepoIcon} from '@primer/octicons-react'\nimport {Box, RelativeTime, SegmentedControl, Text} from '@primer/react'\nimport {useCallback, useMemo, useState} from 'react'\n\nimport {ReferencePreview} from './ReferencePreview'\nimport {BlobPreviewHeader, BlobSize, RawButtons} from './CodeReferencePreview'\n\nexport interface MarkdownReferencePreviewProps {\n  reference: FileReference | SnippetReference\n  details: FileReferenceDetails | SnippetReferenceDetails | undefined\n  detailsLoading: boolean\n  detailsError: boolean\n  onDismiss?: () => void\n}\n\nexport function MarkdownReferencePreview({\n  reference,\n  details,\n  detailsLoading,\n  detailsError,\n  onDismiss,\n}: MarkdownReferencePreviewProps) {\n  const {contributors} = useContributors(reference.repoOwner, reference.repoName, reference.commitOID, reference.path)\n  const [latestCommit] = useLatestCommit(reference.repoOwner, reference.repoName, reference.commitOID, reference.path)\n\n  return (\n    <ReferencePreview.Frame>\n      <ReferencePreview.Header onDismiss={onDismiss}>\n        <GitHubAvatar square={details?.repoIsOrgOwned} src={`${reference.repoOwner}.png`} sx={{mr: 2, flexShrink: 0}} />\n        <Text sx={{fontWeight: 600, whiteSpace: 'nowrap'}}>\n          {reference.repoOwner}/{reference.repoName}\n        </Text>\n        <Text sx={{marginX: 1}}>·</Text>\n        <Text sx={{fontWeight: 400}}>{unqualifyRef(reference.ref)}</Text>\n        <Text sx={{marginX: 1}}>·</Text>\n        <Text\n          sx={{fontWeight: 400, textOverflow: 'ellipsis', overflow: 'hidden', whiteSpace: 'nowrap', direction: 'rtl'}}\n        >\n          {reference.path}\n        </Text>\n      </ReferencePreview.Header>\n      <ReferencePreview.Body detailsLoading={detailsLoading} detailsError={detailsError}>\n        {details && <MarkdownReferencePreviewContent details={details} />}\n\n        <ReferencePreview.Details>\n          <ReferencePreview.DetailLink\n            href={repoOverviewUrl({name: reference.repoName, ownerLogin: reference.repoOwner})}\n            icon={RepoIcon}\n          >\n            {reference.repoOwner}/{reference.repoName}\n          </ReferencePreview.DetailLink>\n\n          {contributors && (\n            <ReferencePreview.DetailLink\n              icon={PeopleIcon}\n              href={blamePath({\n                owner: reference.repoOwner,\n                repo: reference.repoName,\n                commitish: reference.commitOID,\n                filePath: reference.path,\n                lineNumber: details?.range.start,\n              })}\n            >\n              {contributors.totalCount} contributors\n            </ReferencePreview.DetailLink>\n          )}\n\n          {latestCommit && (\n            <ReferencePreview.DetailLink\n              icon={HistoryIcon}\n              href={commitPath({owner: reference.repoOwner, repo: reference.repoName, commitish: latestCommit?.oid})}\n            >\n              {latestCommit?.author?.displayName} updated <RelativeTime datetime={latestCommit?.date} />\n            </ReferencePreview.DetailLink>\n          )}\n\n          <ReferencePreview.DetailLink icon={LinkExternalIcon} href={reference.url}>\n            {reference.repoOwner}/{reference.repoName}/{reference.path}\n            {details ? (\n              <>\n                #{details.range.start}-{details.range.end}\n              </>\n            ) : null}\n          </ReferencePreview.DetailLink>\n        </ReferencePreview.Details>\n      </ReferencePreview.Body>\n    </ReferencePreview.Frame>\n  )\n}\n\nexport function MarkdownReferencePreviewContent({details}: {details: FileReferenceDetails | SnippetReferenceDetails}) {\n  const [startLine, setStartLine] = useState(details.range.start)\n  const [endLine, setEndLine] = useState(details.range.end)\n  const lineCount = useMemo(() => indexToLine(details.contents, details.contents.length), [details.contents])\n  const [displayMode, setDisplayMode] = useState<'preview' | 'code'>('preview')\n  const handleSegmentChange = (selectedTabIndex: number) => {\n    const newMode = (['preview', 'code'] as const)[selectedTabIndex]\n    if (newMode && displayMode !== newMode) {\n      setDisplayMode(newMode)\n    }\n  }\n  const headerInfo = details?.headerInfo\n\n  const expandUp = useCallback(() => {\n    const prevHeadingLine = findPrecedingHeading(details.contents, startLine)\n    setStartLine(prevHeadingLine)\n  }, [details.contents, startLine])\n\n  const expandDown = useCallback(() => {\n    let nextHeadingLine = endLine\n    // add headings to the current display until we're increasing the line count by at least 10\n    while (nextHeadingLine < lineCount && nextHeadingLine < endLine + 10) {\n      nextHeadingLine = findFollowingHeading(details.contents, nextHeadingLine + 1)\n    }\n    setEndLine(nextHeadingLine - 1)\n  }, [details.contents, endLine, lineCount])\n\n  return (\n    <Box\n      sx={{\n        border: '1px solid var(--borderColor-default, var(--color-border-default))',\n        borderRadius: '6px 6px 0 0',\n        marginX: 3,\n      }}\n    >\n      <BlobPreviewHeader>\n        <Box sx={{display: 'flex', alignItems: 'baseline', gap: 2}}>\n          <SegmentedControl aria-label=\"File view\" size=\"small\" onChange={handleSegmentChange} sx={{fontSize: 1}}>\n            <SegmentedControl.Button selected={displayMode === 'preview'} key=\"preview'\">\n              Preview\n            </SegmentedControl.Button>\n            <SegmentedControl.Button selected={displayMode === 'code'} key=\"raw\">\n              Code\n            </SegmentedControl.Button>\n          </SegmentedControl>\n          {headerInfo && <BlobSize headerInfo={headerInfo} />}\n        </Box>\n        {headerInfo && <RawButtons headerInfo={headerInfo} />}\n      </BlobPreviewHeader>\n      {startLine > 1 && <ReferencePreview.ContentExpander direction=\"above\" onExpand={expandUp} />}\n      <ReferencePreview.Content>\n        {displayMode === 'preview' ? (\n          <Box\n            className=\"js-snippet-clipboard-copy-unpositioned\"\n            sx={{'.highlighted': {backgroundColor: theme => `${theme.colors.accent.subtle}`}}}\n          >\n            {/* isAssitive is false - in assitive mode, clicking a reference redirects you to the reference URL instead of opening the reference dialog */}\n            <MarkdownViewer\n              verifiedHTML={transformContentToHTML(\n                details.contents,\n                null,\n                [],\n                false,\n                undefined,\n                undefined,\n                startLine,\n                endLine,\n              )}\n            />\n          </Box>\n        ) : (\n          <code>\n            <Box as=\"pre\" sx={{overflowX: 'auto'}}>\n              {details.contents}\n            </Box>\n          </code>\n        )}\n      </ReferencePreview.Content>\n      {endLine < lineCount && <ReferencePreview.ContentExpander direction=\"below\" onExpand={expandDown} />}\n    </Box>\n  )\n}\n\n/** find the line number (starting from 1) the given character index occurs on */\nfunction indexToLine(str: string, index: number) {\n  return count(str.slice(0, index).matchAll(/\\n/g)) + 1\n}\n\n/** find the line of the last heading before the given line */\nfunction findPrecedingHeading(str: string, line: number) {\n  const index = lineToIndex(str, line)\n  const lastHeading = getLast(str.slice(0, index).matchAll(/^#+\\s/gm))\n  const lastHeadingIndex = lastHeading?.index ?? 0\n  return indexToLine(str, lastHeadingIndex)\n}\n\n/** find the line of the first heading after the given line */\nfunction findFollowingHeading(str: string, line: number) {\n  const index = lineToIndex(str, line)\n  const nextHeading = str.slice(index).match(/^#+\\s/m)\n  const nextHeadingIndex = nextHeading ? index + nextHeading.index! : str.length\n  return indexToLine(str, nextHeadingIndex)\n}\n\nfunction lineToIndex(str: string, line: number) {\n  if (line === 1) {\n    return 0\n  }\n  let index = -1\n  for (let i = 2; i <= line; i++) {\n    index = str.indexOf('\\n', index + 1)\n    if (index === -1) {\n      return str.length\n    }\n  }\n  return index + 1\n}\n\n/** get the last item in an iterable */\nfunction getLast<T>(iterator: Iterable<T>): T | undefined {\n  let last: T | undefined\n  for (const v of iterator) {\n    last = v\n  }\n  return last\n}\n\n/** count the items in an interable */\nfunction count(iterator: Iterable<unknown>) {\n  let c = 0\n  for (const _ of iterator) {\n    c++\n  }\n  return c\n}\n\ntry{ MarkdownReferencePreview.displayName ||= 'MarkdownReferencePreview' } catch {}\ntry{ MarkdownReferencePreviewContent.displayName ||= 'MarkdownReferencePreviewContent' } catch {}","import {transformContentToHTML} from '@github-ui/copilot-chat/utils/markdown'\nimport type {PullRequestReference} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport {GitHubAvatar} from '@github-ui/github-avatar'\nimport {MarkdownViewer} from '@github-ui/markdown-viewer'\nimport {repoOverviewUrl} from '@github-ui/paths'\nimport {GitCommitIcon, LinkExternalIcon, RepoIcon} from '@primer/octicons-react'\nimport {Box, Octicon} from '@primer/react'\n\nimport {ReferencePreview} from './ReferencePreview'\n\nexport function PullRequestReferencePreview<T extends PullRequestReference>({\n  reference,\n  // TODO: details,\n  detailsLoading,\n  detailsError,\n  onDismiss,\n}: {\n  reference: T\n  // details: ReferenceDetails<T> | undefined\n  detailsLoading: boolean\n  detailsError: boolean\n  onDismiss?: () => void\n}) {\n  return (\n    <ReferencePreview.Frame>\n      <ReferencePreview.Header onDismiss={onDismiss}>\n        <Octicon icon={GitCommitIcon} sx={{mr: 2}} />\n        <Box sx={{textOverflow: 'ellipsis', overflow: 'hidden', whiteSpace: 'nowrap'}}>{reference.title}</Box>\n      </ReferencePreview.Header>\n      <ReferencePreview.Body detailsError={detailsError} detailsLoading={detailsLoading}>\n        <Box sx={{display: 'flex', flexDirection: 'row', p: 3}}>\n          <GitHubAvatar src={`${reference.authorLogin}.png`} sx={{mr: 2, flexShrink: 0}} />\n          <Box sx={{textOverflow: 'ellipsis', overflow: 'hidden', whiteSpace: 'nowrap', direction: 'rtl'}}>\n            {reference.authorLogin}\n          </Box>\n        </Box>\n\n        <Box\n          sx={{\n            borderBottom: '1px solid var(--borderColor-default, var(--color-border-default))',\n          }}\n        />\n\n        <ReferencePreview.Content>\n          <MarkdownViewer verifiedHTML={transformContentToHTML(reference.title)} />\n        </ReferencePreview.Content>\n\n        <Box\n          sx={{\n            borderBottom: '1px solid var(--borderColor-default, var(--color-border-default))',\n          }}\n        />\n\n        <ReferencePreview.Details>\n          <ReferencePreview.DetailLink\n            href={repoOverviewUrl({name: reference.repository.name, ownerLogin: reference.repository.ownerLogin})}\n            icon={RepoIcon}\n          >\n            {reference.repository.ownerLogin}/{reference.repository.name}\n          </ReferencePreview.DetailLink>\n\n          <ReferencePreview.DetailLink href={reference.url} icon={LinkExternalIcon}>\n            {reference.url}\n          </ReferencePreview.DetailLink>\n        </ReferencePreview.Details>\n      </ReferencePreview.Body>\n    </ReferencePreview.Frame>\n  )\n}\n\ntry{ PullRequestReferencePreview.displayName ||= 'PullRequestReferencePreview' } catch {}","import type {\n  CodeNavSymbolDetails,\n  CodeNavSymbolReference,\n  CodeReferenceDetails,\n  ReferenceDetails,\n  SuggestionSymbolDetails,\n  SuggestionSymbolReference,\n} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport {blamePath, blobPath, commitPath, repoOverviewUrl} from '@github-ui/paths'\nimport {useContributors} from '@github-ui/use-contributors'\nimport {useLatestCommit} from '@github-ui/use-latest-commit'\nimport {HistoryIcon, LinkExternalIcon, PeopleIcon, RepoIcon} from '@primer/octicons-react'\nimport {RelativeTime} from '@primer/react'\n\nimport {ReferencePreview} from './ReferencePreview'\nimport {SimpleCodeListing} from './SimpleCodeListing'\n\ntype DefOrRef = CodeNavSymbolDetails | CodeReferenceDetails | SuggestionSymbolDetails\n\nexport function SymbolReferencePreview<T extends CodeNavSymbolReference | SuggestionSymbolReference>({\n  reference,\n  details,\n  detailsLoading,\n  detailsError,\n  onDismiss,\n}: {\n  reference: T\n  details: ReferenceDetails<T> | undefined\n  detailsLoading: boolean\n  detailsError: boolean\n  onDismiss?: () => void\n}) {\n  const definitionsByFile = new Map<string, DefOrRef[]>()\n  const referencesByFile = new Map<string, DefOrRef[]>()\n\n  if (details?.kind === 'suggestionSymbol') {\n    for (const def of details.suggestionDefinitions ?? []) {\n      if (!def.highlightedContents) continue\n      const key = `${def.repoOwner}/${def.repoName}/${def.path}`\n      if (!definitionsByFile.has(key)) {\n        definitionsByFile.set(key, [])\n      }\n      definitionsByFile.get(key)!.push(def)\n    }\n  } else if (details?.kind === 'codeNavSymbol') {\n    for (const def of details.codeNavDefinitions ?? []) {\n      if (!def.highlightedContents) continue\n      const key = `${def.repoOwner}/${def.repoName}/${def.path}`\n      if (!definitionsByFile.has(key)) {\n        definitionsByFile.set(key, [])\n      }\n      definitionsByFile.get(key)!.push(def)\n    }\n\n    for (const ref of details?.codeNavReferences ?? []) {\n      if (!ref.highlightedContents) continue\n      const key = `${ref.repoOwner}/${ref.repoName}/${ref.path}`\n      if (!referencesByFile.has(key)) {\n        referencesByFile.set(key, [])\n      }\n      referencesByFile.get(key)!.push(ref)\n    }\n  }\n\n  const firstDefOrRef = [...definitionsByFile.values()][0]?.[0] ?? [...referencesByFile.values()][0]?.[0]\n  const hasDefinitions = definitionsByFile.size > 0\n  const hasReferences = referencesByFile.size > 0\n\n  const totalDefinitionFiles = [...definitionsByFile.values()].length\n  const totalDefinitions = [...definitionsByFile.values()].reduce((sum, nextDefs) => sum + nextDefs.length, 0)\n  const totalReferenceFiles = [...referencesByFile.values()].length\n  const totalReferences = [...referencesByFile.values()].reduce((sum, nextRefs) => sum + nextRefs.length, 0)\n\n  const {contributors} = useContributors(\n    firstDefOrRef?.repoOwner,\n    firstDefOrRef?.repoName,\n    firstDefOrRef?.commitOID,\n    firstDefOrRef?.path,\n  )\n\n  const [latestCommit] = useLatestCommit(\n    firstDefOrRef?.repoOwner,\n    firstDefOrRef?.repoName,\n    firstDefOrRef?.commitOID,\n    firstDefOrRef?.path,\n  )\n\n  return (\n    <ReferencePreview.Frame>\n      <ReferencePreview.Header onDismiss={onDismiss}>{reference.name}</ReferencePreview.Header>\n      <ReferencePreview.Body detailsError={detailsError} detailsLoading={detailsLoading}>\n        {hasDefinitions && (\n          <>\n            <ReferencePreview.SectionDivider>\n              {totalDefinitions} {totalDefinitions === 1 ? 'definition' : 'definitions'}\n              {totalDefinitionFiles > 1 ? ` across ${totalDefinitionFiles} files` : null}\n            </ReferencePreview.SectionDivider>\n            {[...definitionsByFile.values()].map((defs, i) => (\n              <ReferencePreview.CollapsibleSubsection key={defs[0]!.path} title={defs[0]!.path} initiallyOpen={i === 0}>\n                <ReferencePreview.Content>\n                  {defs.map((def, j) =>\n                    def.highlightedContents ? (\n                      <SimpleCodeListing\n                        key={j}\n                        trimLineBeginnings={def.highlightedContents.length === 1}\n                        lines={def.highlightedContents}\n                        lineNumbers={getLineNumbers(def)}\n                      />\n                    ) : null,\n                  )}\n                </ReferencePreview.Content>\n              </ReferencePreview.CollapsibleSubsection>\n            ))}\n          </>\n        )}\n\n        {hasReferences && (\n          <>\n            <ReferencePreview.SectionDivider>\n              {totalReferences} {totalReferences === 1 ? 'reference' : 'references'}\n              {totalReferenceFiles > 1 ? ` across ${totalReferenceFiles} files` : null}\n            </ReferencePreview.SectionDivider>\n            {[...referencesByFile.values()].map((refs, i) => (\n              <ReferencePreview.CollapsibleSubsection\n                key={refs[0]!.path}\n                title={refs[0]!.path}\n                initiallyOpen={i === 0 && !hasDefinitions}\n              >\n                <ReferencePreview.Content>\n                  {refs.map((ref, j) =>\n                    ref.highlightedContents ? (\n                      <SimpleCodeListing\n                        key={j}\n                        trimLineBeginnings={ref.highlightedContents.length === 1}\n                        lines={ref.highlightedContents}\n                        lineNumbers={getLineNumbers(ref)}\n                      />\n                    ) : null,\n                  )}\n                </ReferencePreview.Content>\n              </ReferencePreview.CollapsibleSubsection>\n            ))}\n          </>\n        )}\n\n        <ReferencePreview.Details>\n          {firstDefOrRef && (\n            <ReferencePreview.DetailLink\n              href={repoOverviewUrl({name: firstDefOrRef.repoName, ownerLogin: firstDefOrRef.repoOwner})}\n              icon={RepoIcon}\n            >\n              {firstDefOrRef.repoOwner}/{firstDefOrRef.repoName}\n            </ReferencePreview.DetailLink>\n          )}\n\n          {contributors && firstDefOrRef && (\n            <ReferencePreview.DetailLink\n              icon={PeopleIcon}\n              href={blamePath({\n                owner: firstDefOrRef.repoOwner,\n                repo: firstDefOrRef.repoName,\n                commitish: firstDefOrRef.commitOID,\n                filePath: firstDefOrRef.path,\n              })}\n            >\n              {contributors.totalCount} {contributors.totalCount === 1 ? 'contributor' : 'contributors'}\n            </ReferencePreview.DetailLink>\n          )}\n\n          {latestCommit && firstDefOrRef && (\n            <ReferencePreview.DetailLink\n              icon={HistoryIcon}\n              href={commitPath({\n                owner: firstDefOrRef.repoOwner,\n                repo: firstDefOrRef.repoName,\n                commitish: latestCommit?.oid,\n              })}\n            >\n              {latestCommit?.author?.displayName} updated <RelativeTime datetime={latestCommit?.date} />\n            </ReferencePreview.DetailLink>\n          )}\n\n          {firstDefOrRef && (\n            <ReferencePreview.DetailLink\n              icon={LinkExternalIcon}\n              href={blobPath({\n                owner: firstDefOrRef.repoOwner,\n                repo: firstDefOrRef.repoName,\n                commitish: firstDefOrRef.commitOID,\n                filePath: firstDefOrRef.path,\n              })}\n            >\n              {firstDefOrRef.repoOwner}/{firstDefOrRef.repoName}/{firstDefOrRef.path}\n            </ReferencePreview.DetailLink>\n          )}\n        </ReferencePreview.Details>\n      </ReferencePreview.Body>\n    </ReferencePreview.Frame>\n  )\n}\n\nfunction getLineNumbers({range}: DefOrRef): number[] {\n  if (!range) {\n    return []\n  }\n  return new Array(range.end - range.start + 1).fill(null).map((_, i) => range.start + i)\n}\n\ntry{ SymbolReferencePreview.displayName ||= 'SymbolReferencePreview' } catch {}","import type {\n  FileDiffReference,\n  FileReference,\n  ReferenceDetails,\n  SnippetReference,\n} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport {GitHubAvatar} from '@github-ui/github-avatar'\nimport {blamePath, commitPath, repoOverviewUrl} from '@github-ui/paths'\nimport {useContributors} from '@github-ui/use-contributors'\nimport {useLatestCommit} from '@github-ui/use-latest-commit'\nimport {HistoryIcon, LinkExternalIcon, PeopleIcon, RepoIcon} from '@primer/octicons-react'\nimport {Box, RelativeTime} from '@primer/react'\n\nimport {ReferencePreview} from './ReferencePreview'\n\nconst getRangeString = (selectedRange: FileDiffReference['selectedRange']) => {\n  if (!selectedRange?.start) {\n    return ''\n  }\n\n  return selectedRange.end ? `${selectedRange.start}-${selectedRange.end}` : `${selectedRange.start}`\n}\n\nconst splitReferenceURL = (reference: FileDiffReference) => {\n  const range = getRangeString(reference.selectedRange)\n  const path = reference.url.split(window.location.host)[1]\n  return {href: reference.url + range, path: path + range, range}\n}\n\nexport function FileDiffReferencePreview<T extends FileDiffReference>({\n  reference,\n  details,\n  detailsLoading,\n  detailsError,\n  onDismiss,\n}: {\n  reference: T\n  details: ReferenceDetails<T> | undefined\n  detailsLoading: boolean\n  detailsError: boolean\n  onDismiss?: () => void\n}) {\n  const contentReference =\n    ((reference.headFile ?? reference.baseFile) as FileReference) ??\n    ((reference.head ?? reference.base) as SnippetReference)\n\n  const {contributors} = useContributors(\n    contentReference.repoOwner,\n    contentReference.repoName,\n    contentReference.commitOID,\n    contentReference.path,\n  )\n\n  const [latestCommit] = useLatestCommit(\n    contentReference.repoOwner,\n    contentReference.repoName,\n    contentReference.commitOID,\n    contentReference.path,\n  )\n  const {href, path, range} = splitReferenceURL(reference)\n\n  return (\n    <ReferencePreview.Frame>\n      <ReferencePreview.Header onDismiss={onDismiss}>\n        <GitHubAvatar\n          square={details?.repoIsOrgOwned}\n          src={`${contentReference.repoOwner}.png`}\n          sx={{mr: 2, flexShrink: 0}}\n        />\n        <Box sx={{textOverflow: 'ellipsis', overflow: 'hidden', whiteSpace: 'nowrap'}}>\n          {contentReference.repoOwner}/{contentReference.repoName}/{contentReference.path} {range}\n        </Box>\n      </ReferencePreview.Header>\n      <ReferencePreview.Body detailsError={detailsError} detailsLoading={detailsLoading}>\n        <ReferencePreview.Details>\n          <ReferencePreview.DetailLink\n            href={repoOverviewUrl({name: contentReference.repoName, ownerLogin: contentReference.repoOwner})}\n            icon={RepoIcon}\n          >\n            {contentReference.repoOwner}/{contentReference.repoName}\n          </ReferencePreview.DetailLink>\n\n          {contributors && (\n            <ReferencePreview.DetailLink\n              icon={PeopleIcon}\n              href={blamePath({\n                owner: contentReference.repoOwner,\n                repo: contentReference.repoName,\n                commitish: contentReference.commitOID,\n                filePath: contentReference.path,\n              })}\n            >\n              {contributors.totalCount} {contributors.totalCount === 1 ? 'contributor' : 'contributors'}\n            </ReferencePreview.DetailLink>\n          )}\n\n          {latestCommit && (\n            <ReferencePreview.DetailLink\n              icon={HistoryIcon}\n              href={commitPath({\n                owner: contentReference.repoOwner,\n                repo: contentReference.repoName,\n                commitish: latestCommit?.oid,\n              })}\n            >\n              {latestCommit?.author?.displayName} updated <RelativeTime datetime={latestCommit?.date} />\n            </ReferencePreview.DetailLink>\n          )}\n\n          <ReferencePreview.DetailLink icon={LinkExternalIcon} href={href}>\n            {path}\n          </ReferencePreview.DetailLink>\n        </ReferencePreview.Details>\n      </ReferencePreview.Body>\n    </ReferencePreview.Frame>\n  )\n}\n\ntry{ FileDiffReferencePreview.displayName ||= 'FileDiffReferencePreview' } catch {}","import {useChatState} from '@github-ui/copilot-chat/CopilotChatContext'\nimport {useChatManager} from '@github-ui/copilot-chat/CopilotChatManagerContext'\nimport {referenceID} from '@github-ui/copilot-chat/utils/copilot-chat-helpers'\nimport type {\n  CodeNavSymbolReferenceDetails,\n  CopilotChatReference,\n  FileDiffReference,\n  FileReference,\n  ReferenceDetails,\n  SnippetReference,\n  SuggestionSymbolReferenceDetails,\n} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport {useQuery} from '@tanstack/react-query'\nimport {useCallback} from 'react'\n\nimport {CodeReferencePreview} from './components/CodeReferencePreview'\nimport {CommitReferencePreview} from './components/CommitReferencePreview'\nimport {MarkdownReferencePreview} from './components/MarkdownReferencePreview'\nimport {PullRequestReferencePreview} from './components/PullRequestReferencePreview'\nimport {SymbolReferencePreview} from './components/SymbolReferencePreview'\nimport {FileDiffReferencePreview} from './components/FileDiffReferencePreview'\nimport {WebSearchReferencePreview} from './components/WebSearchReferencePreview'\n\nexport interface CopilotReferencePreviewProps {\n  dismissable?: boolean\n}\n\nexport function CopilotReferencePreview({dismissable}: CopilotReferencePreviewProps) {\n  const {reference, details, detailsLoading, detailsError, dismissReference} = useReferences()\n\n  return (\n    <CopilotReferencePreviewImpl\n      reference={reference!}\n      details={details}\n      detailsLoading={detailsLoading}\n      detailsError={detailsError}\n      onDismiss={dismissable ? dismissReference : undefined}\n    />\n  )\n}\n\nfunction CopilotReferencePreviewImpl<T extends CopilotChatReference>({\n  reference,\n  details,\n  detailsLoading,\n  detailsError,\n  onDismiss,\n}: {\n  reference: T\n  details: ReferenceDetails<T> | undefined\n  detailsLoading: boolean\n  detailsError: boolean\n  onDismiss?: () => void\n}) {\n  switch (reference.type) {\n    case 'symbol':\n      return (\n        <SymbolReferencePreview\n          key={referenceID(reference)}\n          reference={reference}\n          // Narrowing the type for reference in the switch does not\n          // automatically narrow the type for details, which is kind of a bummer\n          details={\n            details as ReferenceDetails<CodeNavSymbolReferenceDetails | SuggestionSymbolReferenceDetails> | undefined\n          }\n          detailsLoading={detailsLoading}\n          detailsError={detailsError}\n          onDismiss={onDismiss}\n        />\n      )\n    case 'file':\n    case 'snippet':\n      return (reference as SnippetReference).languageName === 'Markdown' ? (\n        <MarkdownReferencePreview\n          key={referenceID(reference)}\n          reference={reference}\n          details={details as ReferenceDetails<SnippetReference | FileReference> | undefined}\n          detailsError={detailsError}\n          detailsLoading={detailsLoading}\n          onDismiss={onDismiss}\n        />\n      ) : (\n        <CodeReferencePreview\n          key={referenceID(reference)}\n          reference={reference}\n          details={details as ReferenceDetails<SnippetReference | FileReference> | undefined}\n          detailsLoading={detailsLoading}\n          detailsError={detailsError}\n          onDismiss={onDismiss}\n        />\n      )\n    case 'file-diff':\n      return (\n        <FileDiffReferencePreview\n          key={referenceID(reference)}\n          reference={reference}\n          details={details as ReferenceDetails<FileDiffReference> | undefined}\n          detailsLoading={detailsLoading}\n          detailsError={detailsError}\n          onDismiss={onDismiss}\n        />\n      )\n    case 'commit':\n      return (\n        <CommitReferencePreview\n          key={referenceID(reference)}\n          reference={reference}\n          // TODO: details={details as ReferenceDetails<CommitReference>}\n          detailsLoading={detailsLoading}\n          detailsError={detailsError}\n          onDismiss={onDismiss}\n        />\n      )\n    case 'pull-request':\n      return (\n        <PullRequestReferencePreview\n          key={referenceID(reference)}\n          reference={reference}\n          // details={details as ReferenceDetails<PullRequestReference>}\n          detailsLoading={detailsLoading}\n          detailsError={detailsError}\n          onDismiss={onDismiss}\n        />\n      )\n    case 'web-search':\n      return <WebSearchReferencePreview key={referenceID(reference)} reference={reference} onDismiss={onDismiss} />\n    default:\n      return null\n  }\n}\n\n/**\n * Manages the currently displayed reference.\n */\nexport function useReferences() {\n  const manager = useChatManager()\n  const state = useChatState()\n  const reference = state.selectedReference\n\n  const {isLoading, isError, data} = useQuery({\n    // eslint-disable-next-line @tanstack/query/exhaustive-deps\n    queryKey: ['copilot', 'references', reference?.type, reference ? referenceID(reference) : undefined],\n    queryFn: async () => {\n      if (!reference) return null\n\n      const result = await manager.service.hydrateReference(reference)\n      if (!result.ok) return null\n\n      return result.payload\n    },\n    // references include an OID and are thus not going to change ever\n    staleTime: Number.MIN_VALUE,\n  })\n\n  const dismissReference = useCallback(() => manager.selectReference(null), [manager])\n\n  return {\n    reference,\n    dismissReference,\n    details: data ?? undefined,\n    detailsLoading: isLoading,\n    detailsError: isError,\n  }\n}\n\ntry{ CopilotReferencePreview.displayName ||= 'CopilotReferencePreview' } catch {}\ntry{ CopilotReferencePreviewImpl.displayName ||= 'CopilotReferencePreviewImpl' } catch {}","import {Dialog} from '@primer/react'\nimport {ScreenSize, useScreenSize} from '@github-ui/screen-size'\n\nimport {CopilotReferencePreview, useReferences} from './CopilotReferencePreview'\nimport type {CopilotChatReference} from '@github-ui/copilot-chat/utils/copilot-chat-types'\n\nexport function CopilotReferencePreviewDialog() {\n  const {dismissReference, reference} = useReferences()\n  const {screenSize} = useScreenSize()\n  const smallScreen = screenSize < ScreenSize.large\n  const title = dialogTitleForReference(reference)\n  return (\n    <Dialog\n      aria-label={title}\n      isOpen={!!reference}\n      onDismiss={dismissReference}\n      sx={{\n        display: 'flex',\n        flexDirection: 'column',\n        overflow: 'hidden',\n        borderRadius: 'var(--borderRadius-large)',\n        margin: 0,\n        ...(smallScreen\n          ? {\n              height: ['auto', 'auto'], // Needed for specificity - otherwise gets overridden by default small-screen dialog behavior\n              top: '1dvh',\n              width: '90dvw',\n            }\n          : {\n              top: '10vh',\n              width: '50dvw',\n              maxWidth: '1024px',\n            }),\n      }}\n    >\n      <Dialog.Header>{title}</Dialog.Header>\n      <CopilotReferencePreview />\n    </Dialog>\n  )\n}\n\nfunction dialogTitleForReference(reference: CopilotChatReference | null) {\n  switch (reference?.type) {\n    case 'web-search':\n      return `Bing search results for \"${reference.query}\"`\n    default:\n      return 'Reference'\n  }\n}\n\ntry{ CopilotReferencePreviewDialog.displayName ||= 'CopilotReferencePreviewDialog' } catch {}"],"names":["mapRefType","ref","startsWith","qualifyRef","refType","unqualifyRef","unqualifiedRef","split","join","useClientValue","clientValueCallback","serverValue","deps","memoizedCallback","useCallback","renderPhase","useRenderPhase","isCSRFirstRender","useRef","RenderPhase","ClientRender","clientValue","setClientValue","useState","updateClientValue","useHydratedEffect","current","useContributors","repoOwner","repoName","commitish","path","state","setState","loading","fileContributorsPath","repositoryTreePath","repo","name","ownerLogin","action","useEffect","cancelled","update","response","verifiedFetchJSON","ok","contributors","json","error","e","fetchJSON","url","memoizeCache","Map","memoizeFetchJSON","memoize","cache","resetMemoizeFetchJSON","clear","useLatestCommit","latestCommit","setLatestCommit","setError","setLoading","commitInfoPath","document","addEventListener","SOFT_NAV_STATE","START","removeEventListener","undefined","commit","useContext","RenderPhaseContext","ExperimentsDialog","onDismiss","experimentsDialogRef","experiments","setExperiments","getCopilotExperiments","statusMessage","setStatusMessage","statusMessageAriaHack","saveExperiments","experimentsArray","pair","trim","length","push","setCopilotExperiments","Portal","Dialog","onClose","title","width","Body","Box","sx","p","FormControl","Label","Caption","span","code","Link","inline","target","href","encodeURIComponent","TextInput","my","aria-label","value","onChange","onKeyDown","key","Validation","variant","Footer","Buttons","buttons","type","onClick","content","buttonType","displayName","HEADER_BUTTON_ID","Header","useChatState","manager","useChatManager","thread","getSelectedThread","showTopicPicker","messages","handleThreadDelete","deleteThread","display","gap","pl","mode","borderBottom","borderColor","justifyContent","alignItems","flex","minWidth","props","view","isImmersive","chatIsCollapsed","Heading","as","fontSize","flexGrow","cursor","copilotFeatureFlags","copilotFloatingButton","isCollapsed","expandChat","collapseChat","CopilotBadge","isLoading","isResponding","hasUnreadMessages","className","AllTopicsButton","ReturnToCurrentThreadButton","IconButtonWithTooltip","hidden","icon","PlusIcon","label","tooltipDirection","createThread","color","ThreadOptionButton","handleDelete","setShowExperimentsDialog","mx","height","bg","ChevronUpIcon","ChevronDownIcon","setCopilotButtonAriaExpanded","data-hotkey","XIcon","closeChat","chatVisibleSettingPath","showExperimentsDialog","Button","leadingVisual","ArrowLeftIcon","viewCurrentThread","marginLeft","open","setOpen","currentTopic","streamingMessage","navigate","useNavigate","handleClickViewAll","viewAllThreads","sendEvent","userIsStaff","useMemo","isStaff","deleteDisabled","immersiveURL","COPILOT_PATH","id","isRepository","isDocset","ActionMenu","onOpenChange","prev","Anchor","KebabHorizontalIcon","hideTooltip","ActionMenuOverlay","ActionList","Item","onSelect","disabled","LeadingVisual","ScreenFullIcon","aria-describedby","TrashIcon","Divider","HistoryIcon","LinkItem","rel","CommentDiscussionIcon","BeakerIcon","TrailingVisual","ariaExpanded","copilotButton","getElementById","setAttribute","SimpleCodeListing","lineNumbers","lines","trimLineBeginnings","flexDirection","overflowX","pb","table","style","fontFamily","map","num","i","tr","td","whiteSpace","paddingLeft","SafeHTMLDiv","html","str","trimStart","CodeReferencePreview","reference","details","detailsLoading","detailsError","commitOID","expandUp","expandDown","useExpandableRange","range","expandedRange","allLines","startLineRef","start","endLineRef","end","setLines","slice","updateLines","Math","max","pageSize","min","canExpandUp","canExpandDown","_","highlightedContents","headerInfo","ReferencePreview","Frame","GitHubAvatar","square","repoIsOrgOwned","src","mr","flexShrink","Text","fontWeight","marginX","textOverflow","overflow","direction","border","borderRadius","BlobPreviewHeader","BlobSize","RawButtons","ContentExpander","onExpand","Content","Details","DetailLink","repoOverviewUrl","RepoIcon","PeopleIcon","blamePath","owner","filePath","lineNumber","totalCount","commitPath","oid","author","RelativeTime","datetime","date","LinkExternalIcon","children","backgroundColor","Truncate","blobSize","maxWidth","data-testid","lineInfo","truncatedLoc","truncatedSloc","lfsDownloadUrl","URL","rawBlobUrl","ssrSafeLocation","origin","searchParams","set","downloadButtonProps","DownloadIcon","size","isLfs","downloadFile","borderTopLeftRadius","borderBottomLeftRadius","LinkButton","download","viewable","linkButtonSx","px","borderTopRightRadius","borderBottomRightRadius","borderRight","IconButton","unsafeDisableTooltip","data-turbo","toString","textDecoration","rawHref","result","fetch","method","blob","aElement","createElement","createObjectURL","click","revokeObjectURL","CommitReferencePreview","Octicon","GitCommitIcon","message","login","MarkdownViewer","verifiedHTML","transformContentToHTML","repository","permalink","MarkdownReferencePreview","MarkdownReferencePreviewContent","startLine","setStartLine","endLine","setEndLine","lineCount","indexToLine","contents","displayMode","setDisplayMode","findPrecedingHeading","line","index","lineToIndex","lastHeading","getLast","iterator","last","v","matchAll","nextHeadingLine","findFollowingHeading","nextHeading","match","nextHeadingIndex","SegmentedControl","newMode","selectedTabIndex","selected","theme","colors","accent","subtle","count","c","indexOf","PullRequestReferencePreview","authorLogin","SymbolReferencePreview","definitionsByFile","referencesByFile","kind","def","suggestionDefinitions","has","get","codeNavDefinitions","codeNavReferences","firstDefOrRef","values","hasDefinitions","hasReferences","totalDefinitionFiles","totalDefinitions","reduce","sum","nextDefs","totalReferenceFiles","totalReferences","nextRefs","SectionDivider","defs","CollapsibleSubsection","initiallyOpen","j","getLineNumbers","refs","blobPath","fill","getRangeString","selectedRange","splitReferenceURL","window","location","host","FileDiffReferencePreview","contentReference","headFile","baseFile","head","base","CopilotReferencePreview","dismissable","dismissReference","useReferences","CopilotReferencePreviewImpl","referenceID","languageName","WebSearchReferencePreview","selectedReference","isError","data","useQuery","queryKey","queryFn","service","hydrateReference","payload","staleTime","Number","MIN_VALUE","selectReference","CopilotReferencePreviewDialog","screenSize","useScreenSize","smallScreen","ScreenSize","large","query","isOpen","margin","top"],"sourceRoot":""}