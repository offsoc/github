---
summary: Update code security and analysis features for an enterprise
description: |-
  Updates the settings for advanced security, Dependabot alerts, secret scanning, and push protection for new repositories in an enterprise.

  The authenticated user must be an administrator of the enterprise to use this endpoint.

  OAuth app tokens and personal access tokens (classic) need the `admin:enterprise` scope to use this endpoint.
tags:
  - enterprise-admin
operationId: secret-scanning/patch-security-analysis-settings-for-enterprise
externalDocs:
  description: API method documentation
  url: '${externalDocsUrl}/rest/enterprise-admin/code-security-and-analysis#update-code-security-and-analysis-features-for-an-enterprise'
x-github-internal:
  path: /enterprises/{enterprise}/code_security_and_analysis
  http-method: patch
  published: true
  owner: '@github/security-products-ems'
x-github-releases:
  - ghec
  - ghes: '>= 3.8'
parameters:
  - $ref: '../../components/parameters/enterprise.yaml'
requestBody:
  required: false
  content:
    application/json:
      schema:
        type: object
        properties:
          advanced_security_enabled_for_new_repositories:
            type: boolean
            description: |-
              Whether GitHub Advanced Security is automatically enabled for new repositories. For more information, see "[About GitHub Advanced Security](${externalDocsUrl}/get-started/learning-about-github/about-github-advanced-security)."
          advanced_security_enabled_new_user_namespace_repos:
            type: boolean
            description: |-
              Whether GitHub Advanced Security is automatically enabled for new user namespace repositories. For more information, see "[About GitHub Advanced Security](${externalDocsUrl}/get-started/learning-about-github/about-github-advanced-security)."
          dependabot_alerts_enabled_for_new_repositories:
            type: boolean
            description: |-
              Whether Dependabot alerts are automatically enabled for new repositories. For more information, see "[About Dependabot alerts](${externalDocsUrl}/code-security/dependabot/dependabot-alerts/about-dependabot-alerts)."
          secret_scanning_enabled_for_new_repositories:
            type: boolean
            description: |-
              Whether secret scanning is automatically enabled for new repositories. For more information, see "[About secret scanning](${externalDocsUrl}/code-security/secret-scanning/about-secret-scanning)."
          secret_scanning_push_protection_enabled_for_new_repositories:
            type: boolean
            description: |-
              Whether secret scanning push protection is automatically enabled for new repositories. For more information, see "[Protecting pushes with secret scanning](${externalDocsUrl}/code-security/secret-scanning/protecting-pushes-with-secret-scanning)."
          secret_scanning_push_protection_custom_link:
            type: string
            nullable: true
            description: |-
              The URL that will be displayed to contributors who are blocked from pushing a secret. For more information, see "[Protecting pushes with secret scanning](${externalDocsUrl}/code-security/secret-scanning/protecting-pushes-with-secret-scanning)."
              To disable this functionality, set this field to `null`.
          secret_scanning_non_provider_patterns_enabled_for_new_repositories:
            type: boolean
            nullable: true
            description: |-
              Whether secret scanning of non-provider patterns is enabled for new repositories under this enterprise.
      examples:
        default:
          value:
            advanced_security_enabled_for_new_repositories: true
            advanced_security_enabled_new_user_namespace_repos: true
            dependabot_alerts_enabled_for_new_repositories: true
            secret_scanning_enabled_for_new_repositories: true
            secret_scanning_push_protection_enabled_for_new_repositories: true
            secret_scanning_push_protection_custom_link: "https://github.com/test-org/test-repo/blob/main/README.md"
            secret_scanning_non_provider_patterns_enabled_for_new_repositories: true
responses:
  '204':
    description: Action started
  '422':
    description: The action could not be taken due to an in progress enablement,
      or a policy is preventing enablement
  '404':
    $ref: '../../components/responses/not_found.yaml'
x-github:
  githubCloudOnly: true
  enabledForGitHubApps: false
  category: enterprise-admin
  subcategory: code-security-and-analysis
x-githubEnterpriseOverlays:
  '< 3.15':
    requestBody:
      content:
        application/json:
          schema:
            properties:
              secret_scanning_non_provider_patterns_enabled_for_new_repositories:
          examples:
            default:
              value:
                secret_scanning_non_provider_patterns_enabled_for_new_repositories:
  '< 3.13':
    requestBody:
      content:
        application/json:
          schema:
            properties:
              advanced_security_enabled_new_user_namespace_repos:
          examples:
            default:
              value:
                advanced_security_enabled_new_user_namespace_repos:
  '< 3.9':
    description: |-
      Updates the settings for advanced security, secret scanning, and push protection for new repositories in an enterprise.

      The authenticated user must be an administrator of the enterprise to use this endpoint.

      OAuth app tokens and personal access tokens (classic) need the `admin:enterprise` scope to use this endpoint.
    requestBody:
      required: false
      content:
        application/json:
          schema:
            type: object
            properties:
              advanced_security_enabled_for_new_repositories:
              secret_scanning_enabled_for_new_repositories:
              secret_scanning_push_protection_enabled_for_new_repositories:
              secret_scanning_push_protection_custom_link:
          examples:
            default:
              value:
                advanced_security_enabled_for_new_repositories: true
                secret_scanning_enabled_for_new_repositories: true
                secret_scanning_push_protection_enabled_for_new_repositories: true
                secret_scanning_push_protection_custom_link: "https://github.com/test-org/test-repo/blob/main/README.md"
