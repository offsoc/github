"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_stafftools_react_react-staffbar-element_ts"],{41417:(t,e,a)=>{a.d(e,{z:()=>o});function o(t,e=2){return new Intl.NumberFormat("en",{notation:"compact",style:"unit",unit:"byte",unitDisplay:"narrow",minimumFractionDigits:e,maximumFractionDigits:e}).format(t)}},41953:(t,e,a)=>{a.r(e);var o=a(39595),n=a(41417);function r(t,e,a,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,a,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(s=(r<3?n(s):r>3?n(e,a,s):n(e,a))||s);return r>3&&s&&Object.defineProperty(e,a,s),s}let s=class ReactStaffbarElement extends HTMLElement{connectedCallback(){document.addEventListener("soft-nav:payload",this.onSoftNavPayload),document.addEventListener("turbo:load",this.onTurboLoad),this.updateReactVersion()}disconnectedCallback(){document.removeEventListener("soft-nav:payload",this.onSoftNavPayload),document.removeEventListener("turbo:load",this.onTurboLoad)}updateReactVersion(){let t=document.querySelector("#staffbar-react-version");if(!t)return;let e="18.3.1".replace(/^(.*)-\d+$/,"$1");t.textContent=`| React ${e}`}checkReactApp(t,e){let a=document.querySelector("react-app")||document.querySelector("projects-v2");if(a){let o=a.getAttribute("app-name")||"";this.payloads=this.payloads.filter(t=>"app"!==t.type);let n={name:o,payload:t,appPayload:e,type:"app",size:this.getPayloadChars(t,e),ssrError:!!a.ssrError,hasSSRContent:a.hasSSRContent};this.payloads.push(n)}}updatePayload(){let t=!1,e=!1,a=0,o=[];for(let n of this.payloads)n.ssrError&&(t=!0),n.hasSSRContent&&(e=!0),a+=n.size,"app"===n.type?o.push(()=>{console.group(`React App - ${n.name}`),console.log({payload:n.payload,appPayload:n.appPayload}),console.groupEnd()}):"partial"===n.type&&o.push(()=>{console.group(`React Partial - ${n.name}`),console.log(n.embeddedData),console.groupEnd()});let r=(0,n.z)(a,2);this.payloadSize.textContent=r,this.viewPayloadButton.ariaLabel=`${r}, React payload size`,this.payloadText.textContent=`The payload size is ${r}.`;let s=t,l=e&&!s;if(this.ssrLink.hidden=!l,this.ssrError.hidden=!s,this.updateSpeedscopeLink(),this.updateVisibility(),this.payloads.length>0){let t=this.logPayloadButton;t&&(t.onclick=()=>{for(let t of(console.group("React Payloads"),o))t();console.groupEnd()})}}extractPartialPayloads(){for(let t of document.querySelectorAll("react-partial")){let e=t.getAttribute("partial-name"),a=t.querySelector(`react-partial[partial-name="${e}"] > script[type="application/json"][data-target="react-partial.embeddedData"]`),o=a?.textContent||"{}",n={name:e,embeddedData:JSON.parse(o),size:o.length,type:"partial",ssrError:!!t.ssrError,hasSSRContent:t.hasSSRContent};this.payloads.push(n)}}getPayloadChars(t,e){return(t?JSON.stringify(t).length:0)+(e?JSON.stringify(e).length:0)}updateVisibility(){this.hidden=0===this.payloads.length}updateSpeedscopeLink(){let t=`${document.location.pathname.replaceAll("/","_")}_${new Date().toISOString()}.stackprof.json`,e=`${document.location.origin}${document.location.pathname}?flamegraph=1&flamegraph_interval=500&flamegraph_output=json&flamegraph_json`;this.speedscopeLink.href=`/_speedscope/index.html#profileURL=${encodeURIComponent(e)}&title=${encodeURIComponent(t)}`}constructor(...t){super(...t),this.payloads=[],this.onSoftNavPayload=t=>{let{payload:e,appPayload:a}=t.detail;this.checkReactApp(e,a),this.updatePayload()},this.onTurboLoad=()=>{this.extractPartialPayloads(),this.updatePayload()}}};r([o.aC],s.prototype,"payloadSize",void 0),r([o.aC],s.prototype,"logPayloadButton",void 0),r([o.aC],s.prototype,"speedscopeLink",void 0),r([o.aC],s.prototype,"payloadText",void 0),r([o.aC],s.prototype,"ssrLink",void 0),r([o.aC],s.prototype,"ssrError",void 0),r([o.aC],s.prototype,"viewPayloadButton",void 0),s=r([o.p_],s)}}]);
//# sourceMappingURL=app_components_stafftools_react_react-staffbar-element_ts-ad9cd1f89567.js.map