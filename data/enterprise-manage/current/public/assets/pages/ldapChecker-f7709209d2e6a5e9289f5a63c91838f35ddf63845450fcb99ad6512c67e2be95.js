(function(){var t=function(t,s){return function(){return t.apply(s,arguments)}};this.LdapChecker=function(){function s(s,r){this.button=s,this.url=r,this.onError=t(this.onError,this),this.onSuccess=t(this.onSuccess,this),this.loading=$(".js-testing-ldap"),this.result=$("#ldap_test_result"),this.ldap_fields=$(".js-ldap-field .js-required")}return s.prototype.onWorking=function(){return this.loading.show(),this.button.attr("disabled",!0)},s.prototype.onFinished=function(){return this.loading.hide(),this.button.attr("disabled",!1)},s.prototype.onSuccess=function(t){var s,r,e,i,n,o;if((e=t.redirect_to)&&(document.location.href=e),this.onFinished(),"success"===t.status)return this.result.addClass("flash flash-success").html("Successfully connected to LDAP.").show();for(this.result.addClass("flash flash-error").show(),o=[],s=0,r=(n=t.error).length;s<r;s++)i=n[s],o.push($("<p>",{text:i}).appendTo(this.result));return o},s.prototype.onError=function(t,s,r){return this.onFinished(),this.result.addClass("error").html(r)},s.prototype.checkRequiredFields=function(){var t,s,r,e,i;for(t=[],s=function(s){if(!$(s).val())return t.push(s)},r=0,e=(i=this.ldap_fields).length;r<e;r++)s(i[r]);return t},s.prototype.check=function(){var t;return this.result.removeClass("flash flash-error flash-success").html("").hide(),t=this.checkRequiredFields(),this.ldap_fields.trigger("change"),0===t.length?(this.onWorking(),$(".js-ldap-search-test").val($(".js-ldap-search-test-input").val()),$.ajax({url:this.url,data:$("#settings-form").serialize(),dataType:"json",type:"POST",success:this.onSuccess,error:this.onError})):this.result.html("You must fill out the required LDAP settings.").addClass("flash flash-error").show()},s}()}).call(this);