# generated by turbocassette ts/cassettes/sessions/pull_requests_test.go
---
http_interactions:
  - request:
      method: post
      uri: http://localhost:8888/twirp/github.turboscan.Results/Annotations
      body:
        encoding: UTF-8
        string: |-
          {
            "head_commit_oid": "0000000000000000000000000000000000000003",
            "numbers": [
              7
            ],
            "repositoryId": 105
          }
      headers:
        Content-Type:
          - application/json
    response:
      status:
        code: 200
        message: null
      headers:
        Content-Length:
          - "3182"
        Content-Type:
          - application/json
      body:
        encoding: UTF-8
        string: |-
          {
            "results": [
              {
                "hasCodePaths": true,
                "relatedLocations": [
                  {
                    "createdAt": "0001-01-01T00:00:00Z",
                    "id": "7",
                    "location": {
                      "endColumn": 58,
                      "endLine": 5,
                      "filePath": "controllers/chat.js",
                      "startColumn": 40,
                      "startLine": 5
                    },
                    "message": "a user-provided value",
                    "physicalAlertId": "8",
                    "replacementIndex": 1,
                    "updatedAt": "0001-01-01T00:00:00Z"
                  }
                ],
                "result": {
                  "createdAt": "0001-01-01T00:00:00Z",
                  "fixedAt": null,
                  "guid": "11111111-2222-3333-4444-000000000000",
                  "isFixed": false,
                  "messageMarkdown": "",
                  "messageText": "\\[Score = 0.9441410000\\] This may be a NoSQL query depending on [a user-provided value](1) \\[Source origins: known; sink origins: predicted (scores: NotASink=0.055551, XssSink=0.000011, NosqlInjectionSink=0.944141, SqlInjectionSink=0, TaintedPathSink=0.000297)\\]",
                  "mostRecentInstance": {
                    "analysisKey": {
                      "analysisKey": "abc",
                      "category": "abc",
                      "commitOid": "0000000000000000000000000000000000000003",
                      "environment": "{}",
                      "id": "4",
                      "tool": "CodeQL"
                    },
                    "classification": [],
                    "commitOid": "0000000000000000000000000000000000000003",
                    "createdAt": "0001-01-01T00:00:00Z",
                    "hasFileClassification": false,
                    "isFixed": false,
                    "isOutdated": false,
                    "location": {
                      "endColumn": 66,
                      "endLine": 9,
                      "filePath": "controllers/chat.js",
                      "startColumn": 61,
                      "startLine": 9
                    },
                    "messageText": "\\[Score = 0.9441410000\\] This may be a NoSQL query depending on [a user-provided value](1) \\[Source origins: known; sink origins: predicted (scores: NotASink=0.055551, XssSink=0.000011, NosqlInjectionSink=0.944141, SqlInjectionSink=0, TaintedPathSink=0.000297)\\]",
                    "refNameBytes": "cmVmcy9wdWxsLzEvbWVyZ2U="
                  },
                  "number": 7,
                  "resolution": "NO_RESOLUTION",
                  "resolutionNote": "",
                  "resolvedAt": null,
                  "resolverId": 0,
                  "rule": {
                    "fullDescription": "Building a database query from user-controlled sources is vulnerable to insertion of malicious code by the user.",
                    "help": "",
                    "helpUri": "",
                    "name": "adaptive-threat-modeling/js/nosql-injection",
                    "queryUri": "",
                    "sarifIdentifier": "adaptive-threat-modeling/js/nosql-injection",
                    "severity": "ERROR",
                    "shortDescription": "NoSQL database query built from user-controlled sources (boosted)",
                    "tags": [
                      "experimental",
                      "experimental/atm",
                      "security"
                    ]
                  },
                  "ruleSeverity": "ERROR",
                  "securitySeverity": "HIGH",
                  "tool": {
                    "alertCount": "0",
                    "guid": "",
                    "name": "CodeQL",
                    "version": "2.7.1+202111121759plus"
                  },
                  "updatedAt": "0001-01-01T00:00:00Z"
                }
              }
            ]
          }
      http_version: null
    recorded_at: Wed, 10 May 2023 18:46:00 GMT
recorded_with: VCR 6.0.0
