<%= render layout: "stafftools/stafftools" do %>
  <div class="boxed-group">
    <h3>Unprocessed Billing Messages</h3>
    <div class="boxed-group-inner">
      <table class="d-table width-full site-admin-table">
        <thead class="text-left">
          <tr>
            <th>ID</th>
            <th>Azure Storage Acct Name</th>
            <th>Created At</th>
            <th>...</th>
            <th>...</th>
          </tr>
        </thead>
        <tbody>
          <% messages.each do |message| %>
            <tr>
              <td><%= message.message_id %></td>
              <td><%= message.azure_storage_account_name %></td>
              <td><%= message.created_at.to_formatted_s(:short) %></td>
              <td><%= link_to "Sentry Issue", "https://sentry.io/organizations/github/issues/?project=1885898&query=codespace_azure_message_id%3A#{message.message_id}&statsPeriod=90d" %></td>
              <td><%= link_to "Details", stafftools_codespaces_unprocessed_billing_message_path(message.id) %></td>
            </tr>
          <% end %>
        </tbody>
      </table>

      <div class="paginate-container">
        <%= will_paginate messages %>
      </div>

    </div>
  </div>

<% end %>
