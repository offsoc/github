"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_advisories_severity-score-element_ts"],{32438:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});var r=s(39595);function o(e,t,s,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,s,r);else for(var n=e.length-1;n>=0;n--)(o=e[n])&&(a=(i<3?o(a):i>3?o(t,s,a):o(t,s))||a);return i>3&&a&&Object.defineProperty(t,s,a),a}let i={critical:"Label--danger",high:"Label--orange",moderate:"Label--warning",low:"Label--primary"},a={low:"0.1 - 3.9",moderate:"4.0 - 6.9",high:"7.0 - 8.9",critical:"9.0 - 10.0"},n=class SeverityScoreElement extends HTMLElement{async calculateScore(e){let t;this.hideFormGroupError(this.scoreFieldElement),this.scoreElement.classList.remove(this.pendingScoreTextColorClass);try{t=await this.fetchScoreData(e)}catch(e){this.showFormGroupError(this.scoreFieldElement);return}this.score=t.score.toFixed(1);let s=t.severity.toLowerCase();this.showSeverityLabel(s)}async fetchScoreData(e){let t=new FormData;e.startsWith("CVSS:4.0/")?t.append("cvss_v4",e):t.append("cvss_v3",e);let s=this.scoreElement.getAttribute("data-action-url");if(!s)throw Error("The endpoint url to get the score must be specified");let r=await fetch(s,{method:"POST",headers:{Accept:"application/json","Scoped-CSRF-Token":this.scoreAuthenticityTokenInput.value},body:t});return r.ok?r.json():Promise.reject(Error("Score could not be calculated"))}hideFormGroupError(e){e.classList.contains("errored")&&e.classList.remove("errored")}hideSeverityLabel(){this.severityLabelElement.hidden=!0}get pending(){return this.severityLabelElement.textContent?.toLowerCase()==="unknown"&&this.score===this.scoreElement.getAttribute("data-empty-message")&&this.scoreElement.classList.contains(this.pendingScoreTextColorClass)}get score(){return this.scoreElement.textContent}set score(e){this.scoreElement.textContent=e}set severity(e){this.showSeverityLabel(e),this.score=a[e]||""}set severityLabel(e){this.severityLabelElement.textContent=e.charAt(0).toUpperCase()+e.slice(1)}setPending(){this.showSeverityLabel("unknown"),this.score=this.scoreElement.getAttribute("data-empty-message"),this.scoreElement.classList.add(this.pendingScoreTextColorClass)}showFormGroupError(e){e.classList.contains("errored")||e.classList.add("errored")}showSeverityLabel(e){this.severityLabel=e,this.severityLabelElement.classList.remove(...Object.values(i));let t=i[e];t&&!this.severityLabelElement.classList.contains(t)&&this.severityLabelElement.classList.add(t)}constructor(...e){super(...e),this.pendingScoreTextColorClass="color-fg-muted"}};o([r.aC],n.prototype,"scoreFieldElement",void 0),o([r.aC],n.prototype,"scoreAuthenticityTokenInput",void 0),o([r.aC],n.prototype,"scoreElement",void 0),o([r.aC],n.prototype,"severityLabelElement",void 0),n=o([r.p_],n)}}]);
//# sourceMappingURL=app_components_advisories_severity-score-element_ts-6e08b54f6410.js.map