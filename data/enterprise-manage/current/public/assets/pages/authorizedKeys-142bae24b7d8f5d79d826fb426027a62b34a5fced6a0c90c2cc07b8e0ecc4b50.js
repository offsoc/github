(function(){this.AuthorizedKeys=function(){function e(){this.page=$(".js-authorized-keys"),this.listOfKeys=$(".js-list-group-authorized-keys"),this.key=$(".js-authorized-key"),this.emptySSHKeys=$(".js-empty-ssh-keys"),this.nonEmptySSHKeys=$(".js-non-empty-ssh-keys"),this.button=$(".js-authorized-key-submit"),this.deleteNote=$(".js-remove-ssh-key"),this.sshAccessError=$(".js-ssh-access-error")}return e.prototype.add=function(e){var t,s;return e.val()?(this.button.attr("disabled",!0),t={authorized_key:e.val(),_csrf:$("input[name=_csrf]").val()},$.ajax({url:"/setup/settings/authorized-keys",type:"POST",dataType:"json",data:t,success:(s=this,function(t){var r;return(r=t.redirect_to)&&(document.location.href=r),s.addAuthorizedKey(e,t)}),error:function(t){return function(s){var r;return r=$.parseJSON(s.responseText),e.addClass("invalid"),t.sshAccessError.html(r.error).removeClass("hidden"),t.button.attr("disabled",!1)}}(this)})):(e.addClass("invalid"),void e.focus())},e.prototype.remove=function(e){var t,s;return this.deleteNote.addClass("disabled"),t={authorized_key:e.attr("key"),_csrf:$("input[name=_csrf]").val()},$.ajax({url:"/setup/settings/authorized-keys",type:"DELETE",data:t,success:(s=this,function(t){var r;if((r=t.redirect_to)&&(document.location.href=r),s.deleteNote.removeClass("disabled"),e.parent("li").remove(),0===s.listOfKeys.children().length)return s.emptySSHKeys.removeClass("hidden"),s.nonEmptySSHKeys.addClass("hidden"),s.listOfKeys.addClass("hidden")}),error:function(e){return function(){return e.deleteNote.removeClass("disabled")}}(this)})},e.prototype.addAuthorizedKey=function(e,t){var s,r,i,o,n,a,d,u,h;return e.val(""),o=this.listOfKeys,n=$("<li>",{"class":"list-group-item"}),d=(a=t[t.length-1])["pretty-print"],s=a.comment,u=$("<a>",{"class":"js-remove-ssh-key list-group-remove-item pull-right","data-confirm":"Are you sure you want to delete this key?",key:a.key}),$("<span>",{"class":"octicon octicon-trashcan"}).appendTo(u),u.appendTo(n),i=$("<div>",{"class":"ssh-key",text:d}),r=$("<div>",{"class":"ssh-key-comment",text:s}),i.appendTo(n),r.appendTo(n),n.appendTo(o),e.removeClass("invalid"),o.removeClass("hidden"),o.show(),this.nonEmptySSHKeys.removeClass("hidden"),this.emptySSHKeys.addClass("hidden"),this.sshAccessError.addClass("hidden"),this.button.attr("disabled",!1),u.click((h=this,function(){return h.removeAuthorizedKey(u)}))},e.prototype.removeAuthorizedKey=function(e){var t;return!e.hasClass("disabled")&&(t=e.attr("data-confirm"),confirm(t)?this.remove(e):void 0)},e}(),$(document).ready(function(){return $(".js-authorized-key-submit").click(function(e){return e.preventDefault(),(new AuthorizedKeys).add($(".js-authorized-key"))}),$(".js-remove-ssh-key").click(function(e){var t;return e.preventDefault(),t=$(this),(new AuthorizedKeys).removeAuthorizedKey(t)}),$(".js-dev-zone-add-key-link").click(function(e){return e.preventDefault(),$(".js-authorized-key").val($(".js-dev-zone-add-key-link").attr("key")),$(".js-submit").attr("disabled",!1)})})}).call(this);