{
  "$schema": "http://json-schema.org/draft-04/hyper-schema",
  "id": "https://schema.github.com/internal/service-mappings.json",
  "title": "Service Mappings",
  "description": "Mapping file of services to their maintaining teams.",
  "type": "object",
  "definitions": {
    "team": {}
  },
  "properties": {
    "services": {
      "description": "The list of logical services comprising the GitHub monolith.",
      "type": "object",
      "patternProperties": {
        "^[\\w\\-]+$": {
          "type": "object",
          "properties": {
            "product_manager": {
              "type": "string",
              "pattern": "^[^@/]+[^/]+$",
              "$comment": "Product Manager should not include leading @"
            },
            "name": {
              "type": "string",
              "pattern": "^[A-Z].+$"
            },
            "description": {
              "type": "string",
              "pattern": "^[A-Z-].+\\."
            },
            "exec": {
              "type": "string",
              "pattern": "^[\\w\\-]+$"
            },
            "team": {
              "type": "string",
              "pattern": "^[0-9a-z\\-]+$"
            },
            "qos": {
              "type": "string",
              "enum": [
                "critical",
                "best_effort",
                "maintenance",
                "deprecated",
                "down",
                "unstaffed",
                "experimental"
              ]
            },
            "additional_review_team": {
              "type": "string",
              "pattern": "^[\\w\\-]+$"
            },
            "repo": {
              "type": "string",
              "pattern": "^https://github.com/github/.+"
            },
            "issues": {
              "type": "string",
              "pattern": "^https://github.com/github/.+"
            },
            "support_squad_slack": {
              "type": "string",
              "pattern": "^[\\w\\-]+$"
            },
            "dependencies": {
              "type": "array",
              "items": {
                "type": "string",
                "pattern": "^[\\w\\-/]+$"
              }
            },
            "tags": {
              "type": "array",
              "items": {
                "type": "string",
                "pattern": "^[\\w\\-/]+$"
              }
            },
            "tier": {
              "type": "number",
              "enum": [
                0,
                1,
                2,
                3
              ]
            },
            "package": { "type": "string" },
            "playbook": {
              "type": "string",
              "pattern": "^https://ops.githubapp.com/docs/playbooks/.+"
            },
            "ae_playbook": {
              "type": "string",
              "pattern": "^https://ops.githubapp.com/docs/playbooks/.+"
            },
            "datadog_dashboard": {
              "type": "string",
              "pattern": "^https://app.datadoghq.com/dashboard/.+"
            },
            "looker_dashboard": {
              "type": "string",
              "pattern": "^https://looker.githubapp.com/dashboards/.+"
            },
            "ae_dashboard": {
              "type": "string",
              "pattern": "^https://jarvis-west.dc.ad.msft.net/dashboard/GitHubGHAEProd/.+"
            },
            "kind": {
              "type": "string",
              "enum": [
                "code",
                "artifact"
              ]
            },
            "component_of": {
              "type": "string",
              "pattern": "^[\\w\\-/]+$"
            }
          },
          "required": [
            "description",
            "team"
          ],
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "review_groups": {
      "description": "The list of teams responsible for reviewing code for service subsets in the GitHub monolith.",
      "type": "object",
      "patternProperties": {
        "^[\\w\\-]+$": {
          "type": "object",
          "properties": {
            "team": {
              "type": "string",
              "pattern": "^[\\w\\-]+$"
            }
          },
          "required": [
            "team"
          ],
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "orgs": {
      "description": "The list of organizations containing teams.",
      "type": "object",
      "patternProperties": {
        "^[a-z\\-]+$": {
          "type": "object",
          "properties": {
            "exec": {
              "type": "string",
              "pattern": "^[\\w\\-]+$"
            }
          },
          "required": [
            "exec"
          ],
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "teams": {
      "description": "The list of teams responsible for maintaining services in the GitHub monolith.",
      "type": "object",
      "patternProperties": {
        "^[0-9a-z\\-]+$": {
          "type": "object",
          "patternProperties": {
            "^sev[1-3]$": {
              "type": "object",
              "properties": {
                "alert_slack": {
                  "type": "string",
                  "pattern": "^[\\w\\-]+$"
                }
              }
            }
          },
          "properties": {
            "reviewers_team": {
              "type": "string",
              "pattern": "^[\\w\\-]+\\-reviewers$"
            },
            "org": {
              "type": "string",
              "pattern": "^[a-z\\-]+$"
            },
            "product_manager": {
              "type": "string",
              "pattern": "^[^@/]+[^/]+$",
              "$comment": "Product Manager should not include leading @"
            },
            "pagerduty_escalation_policy": {
              "type": "string",
              "pattern": "^[\\w]+$"
            },
            "repo": {
              "type": "string",
              "pattern": "^https://github.com/github/.+"
            },
            "issues": {
              "type": "string",
              "pattern": "^https://github.com/github/.+"
            },
            "alert_issues": {
              "type": "string",
              "pattern": "^https://github.com/github/.+"
            },
            "slack": {
              "type": "string",
              "pattern": "^[\\w\\-]+$"
            },
            "alert_slack": {
              "type": "string",
              "pattern": "^[\\w\\-]+$"
            },
            "support_squad_slack": {
              "type": "string",
              "pattern": "^[\\w\\-]+$"
            }
          },
          "required": [
            "org",
            "slack"
          ],
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  },
  "required": [
    "services",
    "review_groups",
    "orgs",
    "teams"
  ],
  "additionalProperties": false
}
