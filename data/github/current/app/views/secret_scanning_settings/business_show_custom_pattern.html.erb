<% page_info title: "GitHub Advanced Security",
  selected_link: :business_advanced_security,
  stafftools: stafftools_enterprise_path(business) %>
<%= render layout: "businesses/layout", locals: {
    business: business
} do %>
  <%= render SecretScanning::CustomPatterns::FormComponent.new(
    pattern: custom_pattern,
    owner: business,
    mode: mode,
    settings_path: settings_path,
    submit_path: custom_pattern_form_submit_path,
    update_custom_pattern_settings_path: settings_business_update_custom_pattern_settings_enterprise_path,
    test_pattern_path: test_custom_pattern_path,
    remove_pattern_path: remove_custom_pattern_path,
    show_publish_alert_message: true,
    dry_run_info: dry_run_info,
    cancel_custom_pattern_dry_run_path: cancel_custom_pattern_dry_run_path,
    form_actions_path: form_actions_path,
    get_alert_metrics_path: get_alert_metrics_path,
    get_push_protection_metrics_path: get_push_protection_metrics_path,
    get_generated_expressions_path: get_generated_expressions_path,
    error_message: flash[:custom_pattern_error_message]
  ) %>
<% end %>
