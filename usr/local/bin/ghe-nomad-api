#!/bin/bash
#/
#/ Usage: ghe-nomad-api <api>
#/ Usage: ghe-nomad-api --node 10.0.1.42 <api>
#/
#/ Example: ghe-nomad-api jobs
#/
set -e

usage() {
    grep '^#/' < "$0" | cut -c 4-
    exit 2
}

if [ $# -eq 0 ]; then
  usage
fi

api=
node='localhost'
while [ $# -gt 0 ]; do
  case "$1" in
    --node)
      if [ -n "$2" ]; then node="$2"; fi
      shift 2
      ;;
    *)
      api="$1"
      shift
      break
      ;;
  esac
done

curl --noproxy '*' -fs --show-error "http://$node:4646/v1/$api" "$@"
