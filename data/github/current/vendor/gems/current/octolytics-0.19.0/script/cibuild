#!/bin/sh
# Usage: cibuild
# CI build script for app.

set -e

git log -n 1 HEAD | cat
echo ""

PROJECT_ROOT=$(cd "$(dirname $0)"/.. && pwd)

export PATH="/usr/share/rbenv/shims:/opt/boxen/rbenv/shims:$PATH"
export RBENV_VERSION="1.9.3-p194"
export RUBY_GC_MALLOC_LIMIT=1000000000
export RUBY_HEAP_SLOTS_GROWTH_FACTOR=1.4
export RUBY_HEAP_MIN_SLOTS=1000000
export RUBY_FREE_MIN=1500000
export RUBYLIB=
export RUBYOPT=

# Some useful debugging stuff.
echo "hostname: $(hostname)"
echo "pwd: $(pwd)"
echo ""

ruby -v
bundle -v
echo ""

rm -f Gemfile.lock

script/test
