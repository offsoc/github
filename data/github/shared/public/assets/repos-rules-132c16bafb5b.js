"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["repos-rules"],{94153:(e,t,r)=>{r.d(t,{A:()=>l});var s=r(38267),a=r(59299),n=r(44999);let l=s.Ay.a.withConfig({displayName:"BranchName",componentId:"sc-sg8jsy-0"})(["display:inline-block;padding:2px 6px;font-size:var(--text-body-size-small,",");font-family:var(--fontStack-monospace,",");color:var(--fgColor-link,",");background-color:var(--bgColor-accent-muted,",");border-radius:var(--borderRadius-medium,",");text-decoration:none;&:is(:not(a)){color:var(--fgColor-muted);}",";"],(0,a.Jt)("fontSizes.0"),(0,a.Jt)("fonts.mono"),(0,a.Jt)("colors.accent.fg"),(0,a.Jt)("colors.accent.subtle"),(0,a.Jt)("radii.2"),n.A)},10871:(e,t,r)=>{r.d(t,{z:()=>i});var s=r(55293),a=r(51526),n=r(44683);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(null,arguments)}let i=(0,s.forwardRef)(({children:e,as:t="a",sx:r=n.E,...i},o)=>s.createElement(a.u,l({as:t,ref:o,sx:r},i),e))},6185:(e,t,r)=>{r.d(t,{A:()=>l});var s=r(38267),a=r(59299),n=r(44999);let l=s.Ay.div.withConfig({displayName:"ButtonGroup",componentId:"sc-1gxhls1-0"})(["display:inline-flex;vertical-align:middle;isolation:isolate;&& > *:not([data-loading-wrapper]){margin-inline-end:-1px;position:relative;border-radius:0;:first-child{border-top-left-radius:",";border-bottom-left-radius:",";}:last-child{border-top-right-radius:",";border-bottom-right-radius:",";}:focus,:active,:hover{z-index:1;}}[data-loading-wrapper]{:first-child{button,a{border-top-left-radius:",";border-bottom-left-radius:",";}}:last-child{button,a{border-top-right-radius:",";border-bottom-right-radius:",";}}}[data-loading-wrapper] > *{margin-inline-end:-1px;position:relative;border-radius:0;:focus,:active,:hover{z-index:1;}}",";"],(0,a.Jt)("radii.2"),(0,a.Jt)("radii.2"),(0,a.Jt)("radii.2"),(0,a.Jt)("radii.2"),(0,a.Jt)("radii.2"),(0,a.Jt)("radii.2"),(0,a.Jt)("radii.2"),(0,a.Jt)("radii.2"),n.A)},19797:(e,t,r)=>{r.d(t,{A:()=>h});var s=r(55293),a=r(23606),n=r(71382),l=r(60414),i=r(91677);r(23102);var o=r(10227),d=r(66889),c=r(47553),u=r(4590);function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(null,arguments)}let m=({children:e,disabled:t,onChange:r,...n})=>{let l=s.Children.toArray(e).filter(e=>s.isValidElement(e)&&e.type===d.A).map(e=>s.isValidElement(e)?e.props.children:[]).flat(),i=s.Children.toArray(l).filter(e=>s.isValidElement(e)&&e.type===c.A).map(e=>s.isValidElement(e)&&(e.props.checked||e.props.defaultChecked)&&e.props.value).filter(Boolean),[m,h]=(0,o.F)(i),x=e=>{let{value:t,checked:r}=e.currentTarget;if(r){h([...m.current||[],t]);return}h((m.current||[]).filter(e=>e!==t))};return s.createElement(u.I.Provider,{value:{disabled:t,onChange:e=>{r&&(x(e),r(m.current||[],e))}}},s.createElement(a.A,p({disabled:t},n),e))};m.displayName="CheckboxGroup";var h=Object.assign(m,{Caption:n.A,Label:l.A,Validation:i.A})},13473:(e,t,r)=>{r.d(t,{A:()=>l});var s=r(38267),a=r(59299),n=r(44999);let l=s.Ay.div.withConfig({displayName:"Pagehead",componentId:"sc-diawfz-0"})(["position:relative;padding-top:",";padding-bottom:",";margin-bottom:",";border-bottom:1px solid ",";",";"],(0,a.Jt)("space.4"),(0,a.Jt)("space.4"),(0,a.Jt)("space.4"),(0,a.Jt)("colors.border.default"),n.A)},33665:(e,t,r)=>{r.d(t,{A:()=>h});var s=r(20053),a=r(55293),n=r(38267),l=r(75177),i=r(59299),o=r(44999);let d=n.Ay.div.withConfig({displayName:"Timeline",componentId:"sc-1nkzbnu-0"})(["display:flex;flex-direction:column;"," ",";"],e=>e.clipSidebar&&(0,n.AH)([".Timeline-Item:first-child{padding-top:0;}.Timeline-Item:last-child{padding-bottom:0;}"]),o.A),c=n.Ay.div.attrs(e=>({className:(0,s.A)("Timeline-Item",e.className)})).withConfig({displayName:"Timeline__TimelineItem",componentId:"sc-1nkzbnu-1"})(["display:flex;position:relative;padding:"," 0;margin-left:",";&::before{position:absolute;top:0;bottom:0;left:0;display:block;width:2px;content:'';background-color:",";}"," ",";"],(0,i.Jt)("space.3"),(0,i.Jt)("space.3"),(0,i.Jt)("colors.border.muted"),e=>e.condensed&&(0,n.AH)(["padding-top:",";padding-bottom:0;&:last-child{padding-bottom:",";}.TimelineItem-Badge{height:16px;margin-top:",";margin-bottom:",";color:",";background-color:",";border:0;}"],(0,i.Jt)("space.1"),(0,i.Jt)("space.3"),(0,i.Jt)("space.2"),(0,i.Jt)("space.2"),(0,i.Jt)("colors.fg.muted"),(0,i.Jt)("colors.canvas.default")),o.A),u=e=>a.createElement(l.A,{position:"relative",zIndex:1},a.createElement(l.A,{display:"flex",className:"TimelineItem-Badge",flexShrink:0,borderRadius:"50%",borderWidth:"2px",borderStyle:"solid",borderColor:"canvas.default",overflow:"hidden",color:"fg.muted",bg:"timeline.badgeBg",width:"32px",height:"32px",mr:2,ml:"-15px",alignItems:"center",justifyContent:"center",sx:e.sx},e.children));u.displayName="TimelineBadge";let p=n.Ay.div.withConfig({displayName:"Timeline__TimelineBody",componentId:"sc-1nkzbnu-2"})(["min-width:0;max-width:100%;margin-top:",";color:",";flex:auto;font-size:",";",";"],(0,i.Jt)("space.1"),(0,i.Jt)("colors.fg.muted"),(0,i.Jt)("fontSizes.1"),o.A),m=n.Ay.div.withConfig({displayName:"Timeline__TimelineBreak",componentId:"sc-1nkzbnu-3"})(["position:relative;z-index:1;height:24px;margin:0;margin-bottom:-",";margin-left:0;background-color:",";border:0;border-top:"," solid ",";",";"],(0,i.Jt)("space.3"),(0,i.Jt)("colors.canvas.default"),(0,i.Jt)("space.1"),(0,i.Jt)("colors.border.default"),o.A);c.displayName="Timeline.Item",u.displayName="Timeline.Badge",p.displayName="Timeline.Body",m.displayName="Timeline.Break";var h=Object.assign(d,{Item:c,Badge:u,Body:p,Break:m})},18536:(e,t,r)=>{var s,a;r.d(t,{n:()=>a,v:()=>s}),function(e){e[e.ALWAYS=0]="ALWAYS",e[e.PRS_ONLY=1]="PRS_ONLY"}(s||(s={})),function(e){e.NoOrgBypass="no_org_bypass",e.OrgBypassPRsOnly="org_bypass_prs_only",e.OrgBypassAny="org_bypass_any"}(a||(a={}))},73209:(e,t,r)=>{function s(e,t,r){return r.some(({actorId:r,actorType:s})=>r===e&&s===t)}function a(e,t,r){return r.find(({actorId:r,actorType:s})=>r===e&&s===t)}r.d(t,{J:()=>s,x:()=>a})},30366:(e,t,r)=>{r.d(t,{K:()=>n});var s=r(28784);let a=(e,t,r="Unexpected error")=>async a=>{let n=await (0,s.lS)(e,{body:a,method:t});if(n.ok)try{return await n.json()}catch(e){throw Error("Failed to read response")}else throw Error(r)},n=(e,t)=>a(`${e}?q=${encodeURIComponent(t)}`,"GET")()},72035:(e,t,r)=>{r.d(t,{S:()=>s});let s={couldNotUpdateAssignees:"Could not update assignees",couldNotSearchAssignees:"Could not search assignees",couldNotUpdateLabels:"Could not update labels",couldNotSearchLabels:"Could not search labels",couldNotUpdateMilestone:"Could not update milestone",couldNotSearchMilestones:"Could not search milestones",couldNotUpdateIssueType:"Could not update issue type",couldNotSearchRepositories:"Could not search repositories",couldNotSearchPullRequests:"Could not search pull requests",couldNotSearchProjects:"Could not search projects",couldNotSearchBranches:"Could not search branches",noMatches:"No matches",noResults:"No results",couldNotCreateBranch:"Could not create branch",couldNotCreateLabel:"Could not create label"}},94276:(e,t,r)=>{r.d(t,{B:()=>s});let s={itemPickerRootId:"item-picker-root-id",itemPickerTestId:"item-picker-root"}},57832:(e,t,r)=>{r.d(t,{Z:()=>s});let s={activePickerOption:e=>`[data-id="${e}"] [data-is-active-descendant="activated-directly"]`}},47555:(e,t,r)=>{r.d(t,{A2:()=>d,J4:()=>o,Q3:()=>n,v8:()=>l});var s=r(59857),a=r(72035);let n={leadingVisual:s.CircleSlashIcon,text:a.S.noMatches,disabled:!0,selected:void 0,key:"no-matches",id:"no-matches"},l={leadingVisual:s.CircleSlashIcon,text:a.S.noResults,disabled:!0,selected:void 0,key:"no-results",id:"no-results"},i=e=>{try{new URL(e)}catch(e){return!1}return new RegExp(/^.+\/issues\/\d+$/).test(e)};function o(e,t,r){let s=e.indexOf("/"),a="in:name archived:false";if(r&&(a=`${a} -repo:${r}`),s>0&&2===e.split("/").length){let t=e.split("/")[0],r=e.split("/")[1];return`${a} org:${t} ${r}`}return t?`${a} org:${t} ${e}`:`${a} ${e}`}let d=(e="",t="",r="")=>{let s=e&&`owner:${e.trim()} `,a=r&&`repo:${r.trim()} `,n=t&&` ${t.trim()}`,l=i(t),o="in:title";n&&!isNaN(Number(n))&&(o+=" in:number");let d=`${s}${a}is:issue ${o} `;return{commenters:`${d}commenter:@me${n}`,mentions:`${d}mentions:@me${n}`,assignee:`${d}assignee:@me${n}`,author:`${d}author:@me${n}`,open:`${d}state:open${n}`,resource:l?encodeURI(t):"",queryIsUrl:l}}},43151:(e,t,r)=>{r.d(t,{D7:()=>a,MQ:()=>s,gE:()=>n});let s=e=>{if(e){if(e.startsWith("refs/tags/"))return"tag";if(e.startsWith("refs/heads/"))return"branch"}},a=(e,t)=>"branch"===t?`refs/heads/${e}`:"tag"===t?`refs/tags/${e}`:e,n=e=>{if(!e)return;if(!s(e))return e;let[,,...t]=e.split("/");return t.join("/")}},64851:(e,t,r)=>{r.d(t,{Yj:()=>a.Y,dm:()=>s.d,yz:()=>n.y});var s=r(9916),a=r(3228),n=r(49557)},55952:(e,t,r)=>{var s,a,n,l=r(9449),i=r(48378),o=r(21605),d=r(42024),c=r(73627);let u=()=>c.X()?.is_stafftools??!1,p={};function m({children:e}){return u()?(0,l.jsx)(x,{children:(0,l.jsx)(h,{children:e})}):(0,l.jsx)(h,{children:e})}function h({children:e}){return(0,l.jsx)(o.y,{appName:"repository-rulesets",category:"repository-rulesets",metadata:p,children:(0,l.jsx)(d.LB,{children:e})})}function x({children:e}){return(0,l.jsx)(i.NP,{colorMode:"day",children:e})}try{m.displayName||(m.displayName="App")}catch{}try{h.displayName||(h.displayName="InnerApp")}catch{}try{x.displayName||(x.displayName="StafftoolsThemeWrapper")}catch{}var f=r(55293),g=r(82897),y=r(75177),j=r(94407);let v=({heading:e,children:t})=>(0,l.jsx)(y.A,{sx:{textAlign:"center"},children:(0,l.jsxs)(j.A,{children:[(0,l.jsx)(j.A.Heading,{as:"h3",children:e}),t&&(0,l.jsx)(j.A.Description,{children:t})]})});try{v.displayName||(v.displayName="Blankslate")}catch{}let b="~DEFAULT_BRANCH",_="~ALL";!function(e){e.Enabled="enabled",e.Disabled="disabled",e.Evaluate="evaluate"}(s||(s={})),function(e){e.CREATING="creating",e.EDITING="editing",e.CLOSED="closed"}(a||(a={}));let A=({name:e,rows:t,condensed:r,showHeader:s,renderCreateButton:n,renderRow:i,renderBlankslate:o,children:d,className:c,headerClassName:u,...p})=>{let m={py:2,px:3},h={padding:0,border:0,height:0},x=t&&(t?.length===0||t.every(({_modalState:e})=>e===a.CREATING));return(0,l.jsxs)("div",{className:`Box ${c||""}`,...p,children:[!x&&s?(0,l.jsxs)(y.A,{className:`Box-header d-flex flex-justify-between flex-items-center ${u||""}`,sx:{...r?m:{}},children:[(0,l.jsx)("h2",{className:"Box-title",children:e}),n?.()||null]}):null,t&&i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("ul",{children:t.map(e=>(0,l.jsx)(y.A,{as:"li",className:"Box-row d-flex position-relative",sx:{...r?m:{},...e._modalState===a.CREATING?h:{}},children:(0,l.jsx)("div",{className:"d-flex flex-1 width-fit",children:i(e)})},e.id||e._id))}),x?(0,l.jsx)(v,{heading:"No rules have been added yet",children:o?.()}):null]}):d]})};try{A.displayName||(A.displayName="BorderBox")}catch{}var N=r(58143),w=r(43151),S=r(47767),C=r(45588),I=r(27788);let R=()=>{let{pathname:e,search:t}=(0,S.zy)(),r=(0,f.useRef)(new URLSearchParams(t)),s=(0,I.Z)(),a=(0,f.useCallback)((t,a,n=!0,l=!1)=>{if(n&&(r.current=new URLSearchParams),a)for(let[e,t]of new URLSearchParams(a))""===t?r.current.delete(e):r.current.set(e,t);return s((0,C.o1)({pathname:t,search:r.current.toString()},e),{replace:l})},[s,e,r]),n=(0,f.useCallback)(t=>(0,C.o1)({pathname:t},e).pathname,[e]);return{pathname:e,search:t,params:r.current,navigate:a,resolvePath:n}},k=({gitRef:e,repo:t,branchListCacheKey:r})=>{let{pathname:s,navigate:a}=R(),[n,i]=(0,f.useState)(()=>"branch");return(0,l.jsx)(N.PI,{currentCommitish:(0,w.gE)(e)??"All",defaultBranch:t.defaultBranch,owner:t.ownerLogin,repo:t.name,canCreate:!1,cacheKey:r,selectedRefType:(0,w.MQ)(e),onSelectItem:e=>a(s,`ref=${(0,w.D7)(e,n)}`),onRefTypeChanged:e=>{i(e)},types:["branch","tag"],hideShowAll:!0,customFooterItemProps:{text:"View all rules",onClick:()=>{a(s,"ref=")},sx:{alignItems:"center",display:"flex",justifyContent:"center"}}})};try{k.displayName||(k.displayName="BranchSelector")}catch{}var T=r(85053);let E=({heading:e,description:t,className:r,alphaOrBeta:s,renderAction:a})=>(0,l.jsxs)("div",{className:`Subhead d-flex flex-justify-between flex-items-center ${r||""}`,children:[(0,l.jsxs)("div",{className:"d-flex flex-items-center gap-2",children:[(0,l.jsx)("h1",{className:"Subhead-heading f2-light",children:e}),s&&(0,l.jsx)(T.A,{variant:"success",sx:{mr:2},children:s}),t?(0,l.jsx)("p",{className:"Subhead-description mb-2",children:t}):null]}),a&&a()]});try{E.displayName||(E.displayName="Subhead")}catch{}var O=r(59857),$=r(281),L=r(87330),B=r(15820);let z={branch:"branches",tag:"tags",push:"pushes",member_privilege:"member privileges"},P={ref:"refs",repository:"repositories",organization:"organizations"},D={ref_name:{branch:["main","releases/**/*","users/**/*"],tag:["*-beta","releases/**/*","v*"]},repository_name:{branch:["prod-*","test-*"],tag:["prod-*","test-*"]}},F={repository_name:"repository",repository_id:"repository",repository_property:"repository",ref_name:"ref",organization_name:"organization",organization_id:"organization"},M=["organization","repository","ref"],V="PENDING",W={Enterprise:0,Organization:1,Upstream:2,Repository:3};function U(e,t,r,s=!0){let a;a="object"==typeof r?r[t]:r;let n=1===e?t:a;return s?e>100?`100+ ${n}`:`${e} ${n}`:n}function G(e){return e[0].toUpperCase()+e.slice(1)}function H(e){return e.replaceAll("_"," ")}var q=r(56226),K=r(30729),Q=r(69909);function J(e){switch(e){case s.Enabled:return"Active";case s.Evaluate:return"Evaluate";case s.Disabled:return"Disabled"}}function Y({upsellInfo:e,hideText:t,enforcement:r}){let a="",n=null;if(!e||(e.rulesets.featureEnabled||r===s.Disabled)&&(e.enterpriseRulesets.featureEnabled||r!==s.Evaluate))switch(r){case s.Enabled:a=J(r),n=(0,l.jsx)(K.A,{icon:O.PlayIcon,sx:{marginRight:1,color:"success.fg"},"aria-label":J(r)});break;case s.Evaluate:a=J(r),n=(0,l.jsx)(K.A,{icon:O.MeterIcon,sx:{marginRight:1,color:"severe.fg"},"aria-label":J(r)});break;default:a=J(r),n=(0,l.jsx)(K.A,{icon:O.SkipIcon,sx:{marginRight:1,color:"fg.muted"},"aria-label":J(r)})}else a="Not enforced",n=(0,l.jsx)(K.A,{icon:O.NoEntryIcon,sx:{marginRight:1,color:"attention.fg"},"aria-label":"Not enforced"});return t?n:(0,l.jsxs)(y.A,{as:"span",sx:{alignItems:"center",display:"inline-flex",backgroundColor:"neutral.subtle",borderRadius:2,paddingLeft:1,paddingRight:2,paddingY:1},children:[n,(0,l.jsx)(Q.A,{sx:{fontSize:0,fontWeight:"bold"},children:a})]})}try{Y.displayName||(Y.displayName="EnforcementIcon")}catch{}var X=r(17909),Z=r(28784);async function ee(e,t){try{let r=await (0,Z.lS)(e,{method:"GET"}),s=await r.json();if(0===Object.keys(s).length)return;let a=JSON.stringify(s,null,2),n=new Blob([a],{type:"text/json"}),l=`${t}.json`,i=window.navigator;if(i.msSaveOrOpenBlob)i.msSaveOrOpenBlob(n,l);else{let e=document.createElement("a");e.href=URL.createObjectURL(n),e.download=l,e.click(),URL.revokeObjectURL(e.href)}}catch{throw Error("Error exporting ruleset")}}var et=r(84300),er=r(55847);function es({isOpen:e,title:t,text:r,buttonText:s,onDismiss:a,onConfirm:n}){return(0,l.jsxs)(et.A,{isOpen:e,onDismiss:a,children:[(0,l.jsx)(et.A.Header,{children:t}),(0,l.jsxs)(y.A,{sx:{p:3},children:[(0,l.jsx)("span",{children:r}),(0,l.jsxs)(y.A,{sx:{display:"flex",justifyContent:"flex-end",mt:3},children:[(0,l.jsx)(er.Q,{type:"button",onClick:a,children:"Cancel"}),(0,l.jsx)(er.Q,{type:"button",variant:"danger",onClick:n,sx:{ml:2},children:s})]})]})]})}try{es.displayName||(es.displayName="DangerConfirmationDialog")}catch{}var ea=r(37252);let en=({ruleset:e,rulesetsUrl:t,isRestored:r,insightsEnabled:s,showDeleteAction:a,readOnly:n,rulesHistory:i,rulesImportExport:o,enterpriseEnabled:d,setFlashAlert:c,setMenuOpen:p})=>{let m=u(),h=i&&(m||!m&&!n&&d);return(0,l.jsxs)(X.l,{children:[h&&(0,l.jsxs)(X.l.LinkItem,{as:q.N,"aria-label":`View history for the ruleset named ${e.name}`,to:`${t}/${e.id}/history`,className:"text-decoration-skip",children:[(0,l.jsx)(X.l.LeadingVisual,{children:(0,l.jsx)(O.HistoryIcon,{size:16})}),"History",(0,l.jsx)(X.l.TrailingVisual,{children:(0,l.jsx)(T.A,{variant:"success",children:"Beta"})})]}),(0,l.jsx)(el,{ruleset:e,rulesetsUrl:t,insightsEnabled:s,readOnly:n,rulesHistory:i,rulesImportExport:o}),o&&(!n||m)&&(0,l.jsxs)(X.l.LinkItem,{download:`${e.name}.json`,target:"_self",onClick:async()=>{if(r)p(!1),c({variant:"danger",message:"Cannot export a ruleset while restoring. Save or cancel and try again."});else try{await ee(`${t}/${e.id}/export_ruleset`,e.name)}catch{p(!1),c({variant:"danger",message:"Error exporting ruleset"})}},sx:{textDecoration:"none",whiteSpace:"nowrap"},children:[(0,l.jsx)(X.l.LeadingVisual,{children:(0,l.jsx)(O.DownloadIcon,{size:16})}),"Export ruleset",(0,l.jsx)(X.l.TrailingVisual,{children:(0,l.jsx)(T.A,{variant:"success",children:"Beta"})})]}),!n&&!m&&(0,l.jsx)(ei,{deletePath:`${t}/${e.id}`,redirectPath:t,isRestored:r,showDeleteAction:a,setFlashAlert:c,setMenuOpen:p})]})},el=({ruleset:e,rulesetsUrl:t,insightsEnabled:r,readOnly:a,rulesHistory:n,rulesImportExport:i})=>{let o=e.source.type,d=u();return(!a||d)&&e.enforcement!==s.Disabled&&"Repository"===o&&r?n||i?(0,l.jsxs)(X.l.LinkItem,{as:q.N,"aria-label":`View insights for the ruleset named ${e.name}`,to:`${t}/insights?ruleset=${e.name}`,className:"text-decoration-skip",children:[(0,l.jsx)(X.l.LeadingVisual,{children:(0,l.jsx)(O.GraphIcon,{size:16})}),"Insights"]}):(0,l.jsx)(L.K,{as:q.N,"aria-label":`View insights for the ruleset named ${e.name}`,variant:"invisible",icon:O.PulseIcon,to:`insights?ruleset=${e.name}`,reloadDocument:!0}):null},ei=({deletePath:e,redirectPath:t,isRestored:r,showDeleteAction:s,setFlashAlert:a,setMenuOpen:n})=>{let{navigate:i}=R(),[o,d]=(0,f.useState)(!1),c=async()=>{if(!await (0,ea.Ay)()){n(!1),a({variant:"danger",message:"Unauthorized"});return}try{(await (0,Z.DI)(e,{method:"delete"})).ok?(d(!1),t&&i(t,void 0,!0,!0)):(n(!1),a({variant:"danger",message:"Error deleting ruleset"}))}catch(e){n(!1),a({variant:"danger",message:"Error deleting ruleset"})}};return s?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(X.l.Item,{variant:"danger",onSelect:e=>{r?(n(!1),a({variant:"danger",message:"Cannot delete a ruleset while restoring. Save or cancel and try again."})):d&&d(!0),e.preventDefault()},children:[(0,l.jsx)(X.l.LeadingVisual,{children:(0,l.jsx)(O.TrashIcon,{size:16})}),"Delete ruleset"]}),(0,l.jsx)(es,{isOpen:o,title:"Delete ruleset?",text:"Are you sure you want to delete this ruleset? This action cannot be undone.",buttonText:"Delete",onDismiss:()=>{d(!1)},onConfirm:c})]}):null};var eo=r(83056);function ed(e,t){return e?.preview?Object.fromEntries(e.preview.filter(e=>void 0!==e[t]).map(e=>[e.rulesetId,e[t]])):{}}function ec(e,t,r){return e.filter(e=>t(e.matches)).reduce((e,t)=>({...e,[t.id]:r(t.matches)}),{})}function eu(e,t,r,s=10){let a=(0,B.u)("property_ruleset_async_preview"),[n,l]=(0,f.useState)(()=>ec(r,e=>Array.isArray(e),e=>e.length)),[i,o]=(0,f.useState)(()=>ec(r,e=>Array.isArray(e),e=>e.slice(0,10))),[d,c]=(0,f.useState)(()=>ec(r,e=>"string"==typeof e&&""!==e,e=>e)),p=u();return(0,f.useEffect)(()=>{async function n(e,t,{itemsPerGroup:r=s}={}){for(let s=0;s<e.length;s+=r){let a=e.slice(s,s+r).map(e=>e.id);try{if(d)return;let e=await (0,Z.lS)(t,{body:{ruleset_ids:a},method:"POST"}),r=await e.json();l(e=>({...e,...ed(r,"count")})),o(e=>({...e,...ed(r,"sampleTargetNames")})),c(e=>({...e,...ed(r,"errorMessage")}))}catch(e){return{}}}}async function i(e,t){n(e,t,{itemsPerGroup:e.length})}let d=!1,u=r.filter(e=>!e.matches);async function m(e){let t=p?(0,eo.Qp)({owner:e.name}):(0,eo.lu)({owner:e.name}),[r,s]=function(e,t){let r=[],s=[];for(let a of e)t(a)?r.push(a):s.push(a);return[r,s]}(u,e=>e.conditions.some(e=>"repository_property"===e.target));s.length>0&&await i(s,t),r.length>0&&await n(r,t)}async function h(e){let t=p?(0,eo.MY)({owner:e.ownerLogin,repo:e.name}):(0,eo.zv)({owner:e.ownerLogin,repo:e.name});await i(u,t)}if(a)switch(t){case"organization":m(e);break;case"repository":h(e)}return function(){d=!0}},[a,t,e,s,r,p]),{rulesetPreviewCounts:n,rulesetPreviewSamples:i,rulesetPreviewErrors:d}}let ep=({ruleset:e,upsellInfo:t,sourceType:r,readOnly:s,setFlashAlert:a,rulesetTargetCount:n})=>{let i=(0,B.u)("rules_history"),o=(0,B.u)("rules_import_export"),{search:d,resolvePath:c}=R(),p=e.source.type,m=u(),[h,x]=(0,f.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(i||o)&&(0,l.jsx)("div",{className:"align-center",children:(0,l.jsx)(Y,{upsellInfo:t,hideText:!0,enforcement:e.enforcement})}),(0,l.jsxs)("div",{className:"d-flex flex-column",children:[(0,l.jsx)("div",{className:"f5 text-bold",children:(0,l.jsx)(q.N,{className:"color-fg-default",to:{pathname:c(`${e.id}`),search:d},children:e.name})}),i||o?(0,l.jsx)("div",{className:"d-flex flex-row my-1",children:(0,l.jsx)("span",{className:"text-small color-fg-muted mr-1",children:(0,l.jsx)(eh,{ruleset:e,sourceType:r,targetCount:n})})}):(0,l.jsxs)("div",{className:"d-flex flex-row my-1 text-small color-fg-muted flex-items-center gap-1",children:[(0,l.jsx)(Y,{upsellInfo:t,enforcement:e.enforcement}),(0,l.jsx)(eh,{ruleset:e,sourceType:r,targetCount:n})]}),(0,l.jsx)(ex,{ruleset:e})]}),(i||o)&&(m||!s)&&"Repository"===p?(0,l.jsx)("div",{className:"ml-auto d-flex flex-items-center",children:(0,l.jsxs)($.W,{open:h,onOpenChange:()=>x(!h),children:[(0,l.jsx)($.W.Anchor,{children:(0,l.jsx)(L.K,{icon:O.KebabHorizontalIcon,size:"small",variant:"invisible",className:"color-fg-muted align-center","aria-label":"Ruleset menu"})}),(0,l.jsx)($.W.Overlay,{children:(0,l.jsx)(en,{ruleset:e,rulesetsUrl:c(""),insightsEnabled:t.enterpriseRulesets.featureEnabled,showDeleteAction:i||o,readOnly:s,rulesHistory:i,rulesImportExport:o,enterpriseEnabled:t.enterpriseRulesets.featureEnabled,setFlashAlert:a,setMenuOpen:x})})]})}):(0,l.jsx)("div",{className:"d-flex flex-items-center gap-2",children:(0,l.jsx)(el,{ruleset:e,rulesetsUrl:c(""),insightsEnabled:t.enterpriseRulesets.featureEnabled,readOnly:s,rulesHistory:i,rulesImportExport:o})})]})},em=({rulesets:e,upsellInfo:t,sourceType:r,source:s,readOnly:a,setFlashAlert:n})=>{let i=(0,B.u)("rules_history"),o=(0,B.u)("rules_import_export"),{rulesetPreviewCounts:d}=eu(s,r,e),c=e=>(0,l.jsx)(ep,{ruleset:e,upsellInfo:t,sourceType:r,readOnly:a,setFlashAlert:n,rulesetTargetCount:d[e.id]});return(0,l.jsx)("ul",{children:e.map(e=>(0,l.jsx)("li",{className:"Box-row d-flex px-3 py-2 flex-justify-between flex-items-center",children:i||o?(0,l.jsx)("div",{className:"d-flex flex-row width-full",children:c(e)}):c(e)},e.id))})},eh=({ruleset:e,sourceType:t,targetCount:r})=>{let s;let a=U(e.rules.length,`${H(e.target)} rule`,`${H(e.target)} rules`);return void 0===r?s=void 0:"enterprise"===t?s=U(r,"organization","organizations"):"organization"===t?s=U(r,"repository","repositories"):"repository"===t&&(s="push"!==e.target?U(r,H(e.target),z):"all pushes"),(0,l.jsx)("span",{children:`${a}${s?" \u2022 targeting ":""}${s||""}`})},ex=({ruleset:e})=>{if("push"===e.target)return null;if(e.missingConditionTargets.length>0&&e.enforcement===s.Enabled){let t="",r=e.missingConditionTargets[0];return t="ref"===r?`${G(e.target)} conditions missing`:`${G(r)} conditions missing`,(0,l.jsxs)("div",{className:"text-small color-fg-danger mt-1",children:[(0,l.jsx)(O.AlertIcon,{size:"small"}),(0,l.jsx)("span",{children:" "}),(0,l.jsx)("em",{children:t})]})}return null};try{eh.displayName||(eh.displayName="Subtext")}catch{}var ef=r(65481),eg=r(10871),ey=r(86519),ej=r(73729),ev=r(71312),eb=r(6185);let e_=({text:e,href:t,...r})=>t?(0,l.jsx)(er.Q,{type:"button",as:q.N,to:t,...r,children:e}):(0,l.jsx)(er.Q,{type:"button",...r,children:e}),eA=({actions:e,ariaLabel:t})=>{let r=(0,f.useRef)(null),[s,a]=(0,f.useState)(!1);return e?.length===1?(0,l.jsx)(e_,{...e[0]}):(e?.length||0)>1?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(eb.A,{ref:r,className:"my-2",children:[(0,l.jsx)(e_,{...e[0],variant:"primary"}),(0,l.jsx)(L.K,{"aria-expanded":s,variant:"primary",icon:O.TriangleDownIcon,onClick:()=>a(e=>!e),"aria-label":t})]}),(0,l.jsx)($.W,{anchorRef:r,open:s,onOpenChange:a,children:(0,l.jsx)($.W.Overlay,{children:(0,l.jsx)(X.l,{children:e.slice(1).map(e=>e.href?(0,f.createElement)(X.l.LinkItem,{...e,as:q.N,key:e.text,to:e.href,children:[(0,l.jsx)(y.A,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:e.text}),"New push ruleset"===e.text&&(0,l.jsx)(X.l.TrailingVisual,{children:(0,l.jsx)(T.A,{variant:"success",children:"Beta"})})]}):(0,l.jsx)(X.l.Item,{onSelect:e.onClick,children:e.text},e.text))})})})]}):null};try{e_.displayName||(e_.displayName="ButtonOrLinkButton")}catch{}try{eA.displayName||(eA.displayName="ComboButton")}catch{}let eN=({rulesetsUrl:e,reloadDocument:t,sx:r,defaultEnforcement:a=s.Disabled,setFlashAlert:n=()=>{},supportedTargets:i})=>{let o=(0,B.u)("push_rulesets"),d=(0,B.u)("rules_import_export"),c=(0,B.u)("member_privilege_rulesets"),{navigate:u}=R(),[p,m]=(0,f.useState)(!1),h=[];i.includes("branch")&&h.push({text:"New branch ruleset",href:`${e}new?target=branch&enforcement=${a}`,reloadDocument:t}),i.includes("tag")&&h.push({text:"New tag ruleset",href:`${e}new?target=tag&enforcement=${a}`,reloadDocument:t}),i.includes("member_privilege")&&h.push({text:"New policy",href:`${e}new?target=member_privilege&enforcement=${a}`,reloadDocument:t}),i.includes("push")&&o&&h.push({text:"New push ruleset",href:`${e}new?target=push&enforcement=${a}`,reloadDocument:t});let x=function(){let[e,t]=(0,f.useState)(!1),r=(0,f.useRef)(null),s=(0,f.useCallback)(e=>{e.preventDefault(),r.current&&r.current.click()},[]);return{inputRef:r,handleUploadIntent:s,handleUpload:(0,f.useCallback)(async r=>{let s;let a=r?.[0];if(!e){if(!a)throw Error("No file specified");if("text/json"!==a.type&&"application/json"!==a.type)throw Error("Invalid file type");t(!0);try{s=await a.text()}catch{throw t(!1),Error("Error importing ruleset")}try{JSON.parse(s)}catch{throw t(!1),Error("Invalid ruleset specified")}return t(!1),s}},[e]),isUploading:e}}();return d?(0,l.jsx)(y.A,{sx:{...r,display:"flex"},children:(0,l.jsxs)($.W,{open:p,onOpenChange:()=>m(!p),children:[(0,l.jsx)($.W.Anchor,{children:(0,l.jsx)(er.Q,{variant:"primary",trailingAction:O.TriangleDownIcon,children:c&&i.includes("member_privilege")?"New policy":"New ruleset"})}),(0,l.jsx)($.W.Overlay,{children:(0,l.jsxs)(X.l,{children:[i.includes("branch")&&(0,l.jsx)(X.l.LinkItem,{as:q.N,to:`${e}new?target=branch&enforcement=${encodeURI(a)}`,className:"text-decoration-skip",children:"New branch ruleset"}),i.includes("tag")&&(0,l.jsx)(X.l.LinkItem,{as:q.N,to:`${e}new?target=tag&enforcement=${a}`,className:"text-decoration-skip",children:"New tag ruleset"}),o&&i.includes("push")&&(0,l.jsxs)(X.l.LinkItem,{as:q.N,className:"text-decoration-skip",to:`${e}new?target=push&enforcement=${a}`,children:[(0,l.jsx)(y.A,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:"New push ruleset"}),(0,l.jsx)(X.l.TrailingVisual,{children:(0,l.jsx)(T.A,{variant:"success",children:"Beta"})})]}),c&&i.includes("member_privilege")&&(0,l.jsxs)(X.l.LinkItem,{as:q.N,className:"text-decoration-skip",to:`${e}new?target=member_privilege&enforcement=${a}`,children:[(0,l.jsx)(y.A,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:"New policy"}),(0,l.jsx)(X.l.TrailingVisual,{children:(0,l.jsx)(T.A,{variant:"success",children:"Beta"})})]}),(0,l.jsx)(X.l.Divider,{}),(0,l.jsxs)(X.l.Item,{as:"button",onSelect:x.handleUploadIntent,disabled:x.isUploading,children:["Import a ruleset",(0,l.jsx)(X.l.TrailingVisual,{children:(0,l.jsx)(T.A,{variant:"success",children:"Beta"})})]}),(0,l.jsx)("input",{hidden:!0,ref:x.inputRef,type:"file",accept:".json",onChange:async t=>{try{let r=await x.handleUpload(t.target.files);if(!r)throw Error("Cannot import an empty ruleset");let s=await (0,Z.lS)(`${e}new?imported_ruleset=${encodeURIComponent(r)}`,{method:"GET"}),a=await s.json();if(a.errors)throw Error(`Error importing ruleset: ${a.errors}`);u(`${e}new`,`imported_ruleset=${encodeURIComponent(r)}`)}catch(e){m(!1),n({message:e.message||"Error importing ruleset",variant:"danger"})}}})]})})]})}):(0,l.jsx)(eA,{actions:h,ariaLabel:"Open ruleset creation menu"})};try{eN.displayName||(eN.displayName="NewRulesetButton")}catch{}let ew=({organization:e,askAdmin:t,ctaPath:r,sourceType:s})=>{let{sendClickAnalyticsEvent:a}=(0,ev.S)();return(0,l.jsxs)(ef.A,{variant:"warning",className:"d-flex flex-items-center flex-justify-between",children:[(0,l.jsx)(eS,{organization:e,askAdmin:t,ctaPath:r,button:!0,sourceType:s}),!t&&(0,l.jsx)(eg.z,{className:"ml-5",href:r,onClick:()=>a({category:"rulesets.upsell",action:"RULESETS_UPSELL_BUTTON_CLICKED",label:"RULESET_LEARN_MORE_LINK"}),children:"Upgrade"})]})},eS=({organization:e,askAdmin:t,ctaPath:r,button:s,sourceType:a})=>{let{sendClickAnalyticsEvent:n}=(0,ev.S)(),i="",o="";return"organization"===a?(i="Organization rulesets won't be enforced ",o="until you upgrade this organization account to GitHub Enterprise."):(i="Your rulesets won't be enforced on this private repository until",t?(i=i.concat(" your "),o="organization account admins upgrade this organization account to GitHub Team."):(i=i.concat(" you "),o=e?"upgrade this organization account to GitHub Team.":"move to GitHub Team organization account.")),(0,l.jsxs)("div",{className:"d-flex my-2",children:[(0,l.jsx)("div",{children:(0,l.jsx)(K.A,{icon:O.AlertIcon,sx:{color:"attention.fg",mr:2}})}),s?(0,l.jsxs)(l.Fragment,{children:[i,o]}):(0,l.jsx)("div",{className:"color-fg-muted",children:t?(0,l.jsxs)(l.Fragment,{children:[i,o]}):(0,l.jsxs)(l.Fragment,{children:[i,(0,l.jsx)(ey.A,{href:r,onClick:()=>n({category:"rulesets.upsell",action:"RULESETS_UPGRADE_LINK_CLICKED",label:"RULESETS_UPSELL_TEXT_LINK"}),children:o})]})})]})},eC=({headingText:e,withBorder:t,showNewRulesetButton:r,askAdmin:s,cta:a,infoVariant:n,sourceType:i,organization:o,setFlashAlert:d,supportedRulesetTargets:c})=>{let u={askAdmin:s,ctaPath:a.path,organization:o,sourceType:i},{resolvePath:p}=R();return(0,l.jsxs)("div",{className:t?"d-md-flex border rounded-2 color-border-default p-3 mb-3":"d-flex",children:[(0,l.jsx)("div",{className:"mr-3",children:(0,l.jsx)("span",{className:"branch-action-item-icon completeness-indicator completeness-indicator-problem float-none ml-0",children:(0,l.jsx)(K.A,{icon:O.GitBranchIcon})})}),(0,l.jsxs)("div",{children:[(0,l.jsx)(ej.A,{as:"h2",sx:{fontSize:2,mb:2},children:e}),(0,l.jsx)(eI,{infoVariant:n,supportedRulesetTargets:c}),a.visible&&(0,l.jsx)(eS,{...u}),r&&(0,l.jsx)(eN,{rulesetsUrl:p("./"),setFlashAlert:d,supportedTargets:c})]})]})};function eI({infoVariant:e,supportedRulesetTargets:t}){let r;let s="https://docs.github.com/repositories/configuring-branches-and-merges-in-your-repository/managing-rulesets/about-rulesets",{sendClickAnalyticsEvent:a}=(0,ev.S)(),n="rulesets.learn_more",i="RULESETS_INFO_LINK_CLICKED";return r=t.includes("member_privilege")?"one"===e?" define whether members can perform operations on repositories such as delete and transfer. ":"Define whether members can perform operations on repositories such as delete and transfer. ":"one"===e?" define whether collaborators can delete or force push and set requirements for any pushes, such as passing status checks or a linear commit history.":"Define whether collaborators can delete or force push and set requirements for any pushes, such as passing status checks or a linear commit history. ",(0,l.jsx)("p",{className:"color-fg-muted",children:"one"===e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ey.A,{href:s,onClick:()=>a({category:n,action:i,label:"RULESETS_DOC_LINK"}),inline:!0,children:"Rulesets"}),r]}):(0,l.jsxs)(l.Fragment,{children:[r,(0,l.jsx)(ey.A,{href:s,onClick:()=>a({category:n,action:i,label:"RULESET_LEARN_MORE_LINK"}),inline:!0,children:"Learn more about rulesets."})]})})}try{ew.displayName||(ew.displayName="FlashUpsellBanner")}catch{}try{eS.displayName||(eS.displayName="UpsellBannerText")}catch{}try{eI.displayName||(eI.displayName="InfoVariants")}catch{}function eR(e,t){let r=[],s=[];for(let a of e)t(a)?r.push(a):s.push(a);return[r,s]}function ek(e,t){let r=[],s=[];for(let a of e.entries())t(a[0],a[1])?r.push([a[0],a[1]]):s.push([a[0],a[1]]);return[r,s]}function eT(e,t){return(W[e]??1/0)-(W[t]??1/0)}function eE(e,t){return e.id!==t.source.id||e.type.toLowerCase()!==t.source.type.toLowerCase()}var eO=r(78680);function e$(){let{source:e,sourceType:t,upsellInfo:r,rulesets:s,matchingRulesets:a,editableRulesets:n,branch:i,branchListCacheKey:o,readOnly:d,supportedTargets:c}=(0,g.B)(),{resolvePath:u}=R(),[p,m]=(0,f.useState)({message:"",variant:"default"}),h=(0,f.useRef)(null);(0,f.useEffect)(()=>{h.current?.focus()},[p,h]);let x=s.reduce((e,t)=>{if(i&&!a.includes(t.id))return e;let r=t.source.type;return e[r]||(e[r]=[]),e[r].push(t),e},{}),y=Object.keys(x).sort(eT),j=s.length>0&&0===y.length,b="Rulesets",_="";return c.includes("member_privilege")&&(b="Repository policies",_="Beta"),(0,l.jsxs)("div",{className:"settings-next position-relative",children:[(0,l.jsx)(eO.p,{flashAlert:p,setFlashAlert:m,ref:h}),(0,l.jsx)(E,{heading:b,alphaOrBeta:_,renderAction:()=>d?null:s.length>0?(0,l.jsx)(eN,{rulesetsUrl:u("./"),sx:{my:2},setFlashAlert:m,supportedTargets:c}):null}),(0,l.jsxs)("div",{className:"d-flex flex-column gap-3",children:[r.rulesets.cta.visible&&y.length>0&&(0,l.jsx)(ew,{askAdmin:r.askAdmin,ctaPath:r.rulesets.cta.path,organization:r.organization,sourceType:t}),"repository"===t&&s.length>0?(0,l.jsx)("div",{children:(0,l.jsx)(k,{gitRef:i,repo:e,branchListCacheKey:o})}):null,y.length>0?y.map(s=>(0,l.jsxs)(f.Fragment,{children:[(0,l.jsx)(A,{name:`${G(s)} rulesets`,showHeader:y.length>1||"repository"===t&&!y.includes("Repository"),renderCreateButton:()=>{if(t===s.toLowerCase())return null;let e=x[s][0].source.name;return(0,l.jsxs)("div",{className:"text-small color-fg-muted mt-1",children:["Managed by ",e]})},children:(0,l.jsx)(em,{rulesets:x[s],upsellInfo:r,sourceType:t,source:e,readOnly:d,setFlashAlert:m})}),!d&&s.toLowerCase()!==t&&n.includes(x[s][0].id)&&(0,l.jsxs)("div",{className:"text-small",children:[(0,l.jsx)("span",{className:"text-bold",children:"Tip:"})," ",(0,l.jsxs)("span",{className:"color-fg-muted",children:["As a ",x[s][0]?.source.name," admin, you can",(0,l.jsxs)("a",{href:x[s][0]?.source.url,children:[" ","manage ",e.name," rulesets in ",s.toLocaleLowerCase()," settings."]})]})]})]},s)):(0,l.jsx)(l.Fragment,{children:j?(0,l.jsx)(v,{heading:"No rulesets matched your search",children:"Try expanding your search or creating a new ruleset"}):(0,l.jsx)(eC,{headingText:"You haven't created any rulesets",withBorder:!1,showNewRulesetButton:!d,askAdmin:r.askAdmin,infoVariant:"two",sourceType:t,cta:r.rulesets.cta,organization:r.organization,setFlashAlert:m,supportedRulesetTargets:c})})]})]})}try{e$.displayName||(e$.displayName="OverviewPage")}catch{}var eL=r(89504),eB=r(18536);let ez=(e,t)=>e?.map(e=>({...e,_id:t.current--,_enabled:!0,_dirty:!1,_modalState:a.CLOSED}))||[],eP=(e,t)=>e.findIndex(({id:e,_id:r})=>Number.isFinite(e)?e===t.id:Number.isFinite(r)&&r===t._id),eD=(e,t,r)=>s=>{let n=e.parameterSchema.fields.reduce((e,t)=>(void 0===t.default_value||(e[t.name]=t.default_value),e),{}),l={ruleType:t,parameters:n,_id:r,_enabled:!0,_dirty:!0,_modalState:a.CREATING};return e.metadataPatternSchema&&!l.parameters.operator&&(l.parameters.operator=e.metadataPatternSchema.supportedOperators[0].type),[...s,{ruleType:t,parameters:n,_id:r,_enabled:!0,_dirty:!0,_modalState:e.metadataPatternSchema?a.CREATING:void 0}]},eF=(e,t)=>r=>{let s=eP(r,e);if(-1===s)return r;let a={...r[s],ruleType:e.ruleType,_dirty:!0,parameters:{...r[s].parameters,...t}};return[...s>0?r.slice(0,s):[],a,...s<r.length?r.slice(s+1):[]]},eM=(e,t)=>r=>{let s=eP(r,e);if(-1===s)return r;let a={...r[s],_modalState:t};return[...s>0?r.slice(0,s):[],a,...s<r.length?r.slice(s+1):[]]},eV=(e,t)=>r=>{let s=eP(r,e);if(-1===s)return r;let a={...e,_dirty:!0,_enabled:t};if(void 0!==e.parameters.max_ref_updates){for(let e=0;e<r.length;e++)r[e].parameters.max_ref_updates&&(r[s]=a);return[...r]}return e.id?[...s>0?r.slice(0,s):[],a,...s<r.length?r.slice(s+1):[]]:[...s>0?r.slice(0,s):[],...s<r.length?r.slice(s+1):[]]},eW=(e,t)=>e?.map(e=>({...e,_id:t.current--,_enabled:!0,_dirty:!1}))||[],eU=(e,t)=>e.findIndex(({id:e,_id:r})=>Number.isFinite(e)?e===t.id:Number.isFinite(r)&&r===t._id),eG=(e,t,r,s,a,n)=>l=>{let i=l.findIndex(r=>r.actorId===e&&r.actorType===t);if(-1!==i){if(l[i]._enabled)return l;let e={...l[i],_enabled:!0,_dirty:!0};return[...i>0?l.slice(0,i):[],e,...i<l.length?l.slice(i+1):[]]}return[...l,{_id:n,actorId:e,actorType:t,name:r,_enabled:!0,_dirty:!0,bypassMode:s,owner:a}]},eH=e=>t=>{let r=eU(t,e);return -1===r?t:e.id?[...r>0?t.slice(0,r):[],{...e,_dirty:!0,_enabled:!1},...r<t.length?t.slice(r+1):[]]:[...t.slice(0,r),...t.slice(r+1)]},eq=e=>t=>{let r=eU(t,e);return -1===r?t:t[r]?[...t.slice(0,r),e,...t.slice(r+1)]:t},eK=e=>e?.map(e=>({...e,_dirty:!1}))||[],eQ=(e,t)=>r=>{let s=r.findIndex(t=>t.target===e);if(-1!==s){let e={...r[s],parameters:t,_dirty:!0};return[...s>0?r.slice(0,s):[],e,...s<r.length?r.slice(s+1):[]]}return[...r,{parameters:t,target:e,_dirty:!0}]},eJ=e=>t=>t.filter(t=>t.target!==e.target);var eY=r(6117);let eX=e=>{let{validate:t,...r}=(0,eY.$)(e,"ruleset_name"),s=async(e,s,a={})=>e.length?t({name:e,id:s},a):(r.reset(),!0);return{...r,validate:s}};var eZ=r(70170);let e0=(e,t)=>{let r=(0,f.useRef)(-1),[s,n]=(0,f.useState)(e),[l,i]=(0,f.useState)(eK(s.conditions)),[o,d]=(0,f.useState)(s.orgAdminBypassMode),[c,u]=(0,f.useState)(s.deployKeyBypass),[p,m]=(0,f.useState)(eW(s.bypassActors,r)),[h,x]=(0,f.useState)(s.name??""),[g,y]=(0,f.useState)(void 0),[j,v]=(0,f.useState)(s.enforcement),[b,_]=(0,f.useState)(t),[A,N]=(0,f.useState)(ez(s.rules,r)),w=(0,f.useRef)(void 0),S=(0,f.useRef)(void 0),{resolvePath:C}=R(),I=eX(C("../validate_value")),k=(0,eL.t)(),T=(0,f.useMemo)(()=>A.filter(e=>e._dirty&&e._modalState!==a.CREATING),[A]),E=(0,f.useMemo)(()=>l.filter(e=>e._dirty),[l]),O=(0,f.useMemo)(()=>p.filter(e=>e._dirty),[p]),$=()=>{w.current?.cancel(),S.current?.abort()},L=(0,f.useCallback)(async(e,t=!1)=>{let r=e.trim();if($(),!r){let e="Name cannot be empty";return y(e),e}if(S.current=new AbortController,t){let e=await I.validate(r,s.id,{signal:S.current.signal})?void 0:"Name must be unique";return y(e),e}w.current=(0,eZ.s)(async()=>{y(await I.validate(r,s.id,{signal:S.current?.signal})?void 0:"Name must be unique")},500),w?.current()},[s.id,I]),B=(0,f.useCallback)(async()=>($(),{name:await L(h,!0)}),[L,h]);return{repo:k,rulesetId:s.id??void 0,rulesetTarget:s.target,rulesetName:s.name,rulesetMatches:s.matches,dirtyRulesetName:h,orgAdminBypassMode:s.orgAdminBypassMode,dirtyOrgAdminBypassMode:o,deployKeyBypass:s.deployKeyBypass,dirtyDeployKeyBypass:c,enforcement:s.enforcement,dirtyEnforcement:j,bypassActors:p,setBypassActors:m,rules:A,ruleSchemas:b,dirtyRules:T,conditions:l,dirtyConditions:E,dirtyBypassActors:O,rulesetNameError:g,initializeRuleset:(0,f.useCallback)(e=>{r.current=-1,N(ez(e.ruleset.rules,r)),i(eK(e.ruleset.conditions)),m(eW(e.ruleset.bypassActors,r)),d(e.ruleset.orgAdminBypassMode),u(e.ruleset.deployKeyBypass),x(e.ruleset.name),y(void 0),v(e.ruleset.enforcement),n(e.ruleset),_(e.ruleSchemas)},[]),addRule:(0,f.useCallback)(e=>{N(t=>{let s=b.find(t=>t.type===e);if(!s)throw Error("Rule schema not found");if(!s.metadataPatternSchema){let r=t.find(t=>t.ruleType===e);if(r)return eV(r,!0)(t)}return eD(s,e,r.current--)(t)})},[b]),updateRuleParameters:(0,f.useCallback)((e,t)=>{N(eF(e,t))},[]),setRuleModalState:(0,f.useCallback)((e,t)=>{N(eM(e,t))},[]),removeRule:(0,f.useCallback)(e=>{N(eV(e,!1))},[]),restoreRule:(0,f.useCallback)(e=>{N(eV(e,!0))},[]),addOrUpdateCondition:(0,f.useCallback)((e,t)=>{i(eQ(e,t))},[]),removeCondition:(0,f.useCallback)(e=>{i(eJ(e))},[]),renameRuleset:(0,f.useCallback)(e=>{x(e),y(void 0),L(e)},[L]),validateForm:B,setRulesetEnforcement:v,addBypassActor:(0,f.useCallback)((e,t,s,a,n)=>{"OrganizationAdmin"===t?d(a===eB.v.ALWAYS?eB.n.OrgBypassAny:eB.n.OrgBypassPRsOnly):"DeployKey"===t?u(!0):m(eG(e,t,s,a,n,r.current--))},[]),removeBypassActor:(0,f.useCallback)(e=>{"OrganizationAdmin"===e.actorType?d(eB.n.NoOrgBypass):"DeployKey"===e.actorType?u(!1):m(eH(e))},[]),updateBypassActor:(0,f.useCallback)(e=>{"OrganizationAdmin"===e.actorType?d(e.bypassMode===eB.v.ALWAYS?eB.n.OrgBypassAny:eB.n.OrgBypassPRsOnly):"DeployKey"===e.actorType?u(!1):m(eq(e))},[])}};let ValidationError=class ValidationError extends Error{constructor(e){super(e.message),e.detailed_errors&&(this.details=e.detailed_errors)}};let e1=(e,t,r="Unexpected error")=>async s=>{let a=await (0,Z.lS)(e,{body:s,method:t});if(a.ok)try{return await a.json()}catch(e){throw Error("Failed to read response")}else if(422===a.status)throw new ValidationError(await a.json());else throw Error(r)},e2=(e,t)=>e1(e,"POST","Failed to update")({ruleset:t}),e3=e=>e1(e,"GET")(),e5=(e,t)=>e1(`${e}?q=${encodeURIComponent(t)}`,"GET")(),e9=(e,{query:t,excludePublicRepos:r})=>e1(`${e}?q=${encodeURIComponent(t)}&excludePublicRepos=${r?"true":"false"}`,"GET")(),e4=(e,{query:t})=>e1(`${e}?q=${encodeURIComponent(t)}`,"GET")(),e7=(e,t)=>e1(`${e}?ruleset_target=${t}`,"GET")(),e6=(e,t)=>e1(`${e}?type=workflows&repoName=${encodeURIComponent(t)}`,"GET")(),e8=(e,t="")=>e1(`${e}?type=repos&q=${encodeURIComponent(t)}`,"GET")(),te=(e,t,r)=>e1(`${e}?type=sha&ref=${encodeURIComponent(r)}&repoName=${encodeURIComponent(t)}`,"GET")(),tt=(e,t)=>e1(e,"POST")(t);var tr=r(66889),ts=r(44981);let ta=[{type:s.Enabled,text:"Active",description:"Rules will be enforced",icon:(0,l.jsx)(K.A,{icon:O.PlayIcon,sx:{color:"success.fg"}})},{type:s.Evaluate,text:"Evaluate",description:"Evaluate Rulesets to trial rules and view insights",icon:(0,l.jsx)(K.A,{icon:O.MeterIcon,sx:{color:"severe.fg"}})},{type:s.Disabled,text:"Disabled",description:"Do not evaluate or enforce rules",icon:(0,l.jsx)(K.A,{icon:O.SkipIcon,sx:{color:"fg.muted"}})}],tn="Enforcement status",tl=({readOnly:e,upsellInfo:t,name:r,sourceType:a,enforcement:n,generalErrors:i,nameRef:o,renameRuleset:d,setRulesetEnforcement:c,rulesetNameError:u,rulesetTarget:p})=>{let[m,h]=(0,f.useState)(!1),[x,g]=(0,f.useState)(!1),[y,j]=(0,f.useState)(""),v=t.enterpriseRulesets.cta.visible&&t.organization,[b,_]=(0,f.useState)(n),A=ta.filter(e=>!(e.type===s.Evaluate&&"member_privilege"===p)&&(t.enterpriseRulesets.featureEnabled||v||e.type!==s.Evaluate)),N=A.find(e=>e.type===n)||A[A.length-1];return(0,f.useEffect)(()=>{if(i?.name&&i.name.length){j(i.name.map(e=>e.message).join(","));return}},[i]),(0,l.jsxs)(l.Fragment,{children:[e?(0,l.jsxs)("div",{"data-testid":"general-panel-readOnly",children:[(0,l.jsx)(ti,{title:"Name",children:r}),(0,l.jsxs)(ti,{title:tn,children:[(0,l.jsx)("span",{className:"text-bold",children:N.text}),(0,l.jsxs)("span",{children:[" - ",N.description]})]})]}):(0,l.jsxs)("div",{className:"d-flex flex-column gap-3 mb-4 mt-2","data-testid":"general-panel",children:[(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tr.A.Label,{children:"Ruleset Name"}),(0,l.jsx)(ts.A,{sx:{width:"35%"},placeholder:r,ref:o,value:r,"aria-invalid":!!u,onChange:e=>{d(e.target.value)}}),u&&(0,l.jsx)(tr.A.Validation,{variant:"error",children:u}),y&&(0,l.jsx)(tr.A.Validation,{variant:"error","aria-live":"polite",children:y})]}),(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tr.A.Label,{children:tn}),N.type===s.Evaluate&&v&&(0,l.jsx)(tr.A.Caption,{children:(0,l.jsxs)("span",{children:["Evaluate mode is only available to Enterprise organizations."," ",t.enterpriseRulesets.cta.path&&(0,l.jsx)(q.N,{to:t.enterpriseRulesets.cta.path,children:"Upgrade to Enterprise to use this mode."})]})}),(0,l.jsxs)($.W,{open:x,onOpenChange:()=>g(!x),children:[(0,l.jsxs)($.W.Button,{"aria-label":`${N.text}, ${tn}`,children:[(0,l.jsx)("div",{className:"d-inline pr-2",children:N.icon}),N.text]}),(0,l.jsx)($.W.Overlay,{width:"medium",children:(0,l.jsx)(X.l,{selectionVariant:"single",children:(0,l.jsxs)(X.l.Group,{children:[(0,l.jsx)(X.l.GroupHeading,{children:tn}),A.map(e=>(0,l.jsxs)(X.l.Item,{selected:e.type===N.type,onSelect:t=>{"organization"===a&&e.type===s.Enabled?(t.preventDefault(),c(e.type),_(n),g(!1),h(!0)):c(e.type)},children:[(0,l.jsx)(X.l.LeadingVisual,{children:e.icon}),e.text,e.type===s.Evaluate&&v&&(0,l.jsx)(T.A,{className:"ml-1",variant:"accent",children:"Enterprise"}),(0,l.jsx)(X.l.Description,{variant:"block",children:e.description})]},e.type))]})})})]})]})]}),(0,l.jsx)(es,{isOpen:m,title:"Enable Organization Ruleset",text:"I want rules enforced on targeted repositories in this ruleset.",buttonText:"Confirm",onDismiss:()=>{h(!1),c(b)},onConfirm:()=>{h(!1),c(s.Enabled)}})]})};function ti({title:e,children:t}){return(0,l.jsxs)(y.A,{className:"Box-row",sx:{display:"grid",gridTemplateColumns:"1fr 3fr;"},children:[(0,l.jsx)("span",{className:"text-bold",children:e}),(0,l.jsx)("span",{className:"flex-1",children:t})]})}try{tl.displayName||(tl.displayName="GeneralPanel")}catch{}try{ti.displayName||(ti.displayName="ReadOnlyRow")}catch{}function to(e,t){return("repository_name"===e||"organization_name"===e)&&1===t.include.length&&t.include[0]===_&&0===t.exclude.length}function td(e,t){if("organization"===e)return"organization_name";if("repository"===e)return t?.supportedConditionTargetObjects?.includes("organization")?"all_repos":"repository_name";if("ref"===e)return"ref_name";throw Error(`Unknown target object type: ${e}`)}var tc=r(94153),tu=r(30631);let tp=({target:e})=>{let t=(0,w.MQ)(e);return"tag"===t?(0,l.jsx)(K.A,{icon:O.TagIcon,sx:{mr:1}}):"branch"===t?(0,l.jsx)(K.A,{icon:O.GitBranchIcon,sx:{mr:1}}):null},tm=({param:e,displayAsLabel:t=!1,showIcon:r,showQualifiedRef:s,maxWidth:a=100})=>t?(0,l.jsx)(T.A,{variant:"secondary",children:e}):s?(0,l.jsx)(tc.A,{as:"span",children:(0,l.jsx)(tu.A,{title:e,maxWidth:a,sx:{display:"flex"},children:(0,l.jsxs)(Q.A,{sx:{overflowX:"hidden",textOverflow:"ellipsis"},children:[r?(0,l.jsx)(tp,{target:e}):null,e]})})}):(0,l.jsx)(tc.A,{as:"span",children:(0,l.jsx)(tu.A,{title:(0,w.gE)(e)||"",maxWidth:a,sx:{display:"flex"},children:(0,l.jsxs)(Q.A,{sx:{overflowX:"hidden",textOverflow:"ellipsis"},children:[r?(0,l.jsx)(tp,{target:e}):null,(0,w.gE)(e)]})})});try{tp.displayName||(tp.displayName="RefIcon")}catch{}try{tm.displayName||(tm.displayName="RefPill")}catch{}function th({renderTitle:e,renderAction:t,onRemove:r,targets:s,headerRowText:a,blankslate:n,readOnly:i}){let[o,d]=eR(s,e=>"include"===e.type);return(0,l.jsx)(y.A,{className:"settings-next",sx:{position:"relative"},children:(0,l.jsxs)(A,{children:[(0,l.jsxs)("div",{className:"Box-header d-flex flex-row flex-justify-between flex-items-center",children:[e(),i||!t?null:t()]}),0===s.length?(0,l.jsx)(v,{heading:n.heading,children:n.description}):(0,l.jsxs)("ul",{children:[a&&(0,l.jsxs)(y.A,{as:"li",className:"Box-row",sx:{display:"flex",flexDirection:"row",px:3,py:2,alignItems:"center"},children:[(0,l.jsx)(O.InfoIcon,{className:"mr-2"}),(0,l.jsx)(Q.A,{sx:{color:"fg.muted"},children:a})]}),o.length>0&&(0,l.jsx)(tx,{readOnly:i,targets:o,onRemove:r}),d.length>0&&(0,l.jsx)(tx,{readOnly:i,targets:d,onRemove:r})]})]})})}function tx({targets:e,readOnly:t,onRemove:r}){return(0,l.jsx)(l.Fragment,{children:e?.map(e=>l.jsxs("li",{className:"Box-row d-flex flex-row flex-items-center px-3 py-2",children:[l.jsx("div",{className:"flex-1",children:l.jsx(ty,{target:e})}),t?null:l.jsx("div",{children:l.jsx(L.K,{type:"button","aria-label":`Delete ${e.type} of ${e.display||e.value}`,size:"small",variant:"invisible",onClick:()=>{e.onRemove&&e.onRemove(),r?.(e.type,e.value,e.prefix)},className:"ml-2",icon:O.TrashIcon})})]},`${e.prefix}/${e.value}`))})}let tf={[d.Gy.small]:100,[d.Gy.medium]:150,[d.Gy.large]:150,[d.Gy.xlarge]:270,[d.Gy.xxlarge]:460,[d.Gy.xxxlarge]:460,[d.Gy.xxxxlarge]:460},tg=e=>tf[e]??tf[d.Gy.small];function ty({target:e}){let{screenSize:t}=(0,d.lm)(),r=tg(t);return(0,l.jsxs)("div",{className:"d-flex flex-direction-row flex-items-start",children:[(0,l.jsxs)("div",{className:"d-flex flex-items-center flex-direction-row",children:["include"===e.type?(0,l.jsx)(O.PlusCircleIcon,{className:"color-fg-success mr-2"}):(0,l.jsx)(O.XCircleIcon,{className:"color-fg-danger mr-2"}),e.prefix&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tu.A,{title:e.prefix,maxWidth:r-2,children:(0,l.jsx)(Q.A,{sx:{overflowX:"hidden",textOverflow:"ellipsis"},children:e.prefix})}),":\xa0"]})]}),(0,l.jsx)("div",{className:"flex-wrap d-flex gap-1",children:Array.isArray(e.display)?e.display.map(t=>(0,l.jsx)(y.A,{sx:{mr:1,display:"inline"},children:(0,l.jsx)(tm,{param:t,displayAsLabel:e.displayAsLabel})},t)):(0,l.jsx)(tm,{param:e.display||`${e.value}`,displayAsLabel:e.displayAsLabel,maxWidth:r})})]})}try{th.displayName||(th.displayName="TargetsTable")}catch{}try{tx.displayName||(tx.displayName="TargetList")}catch{}try{ty.displayName||(ty.displayName="Condition")}catch{}var tj=r(47553),tv=r(86079);let tb=e=>{let{validate:t,...r}=(0,eY.$)(e,"condition_target"),s=async(e,s,a)=>e.length?t({conditionTarget:e,target:s,id:a}):(r.reset(),!0);return{...r,validate:s}},t_=({rulesetId:e,onAdd:t,onClose:r,target:s,includeOrExclude:a,rulesetTarget:n,fnmatchHelpUrl:i})=>{let o=(0,f.useRef)(null),d=D[s]?.[n],c=`${G(a)} by pattern`,u=G("repository_name"===s?"Repositories":"organization_name"===s?"Organizations":z[n]),p=`${u} that ${"include"===a?"match":"do not match"} the matching pattern will be targeted by this ruleset.`,m="repository_name"===s?"Repository":"organization_name"===s?"Organization":G(n),h=`Add ${"include"===a?"Inclusion":"Exclusion"} pattern`,[x,g]=(0,f.useState)(""),{resolvePath:y}=R(),j=tb(y("../validate_value")),v=async()=>{let e=o.current.value.trim();if(!e||""===e){g("Pattern cannot be empty"),o.current?.focus();return}j.isValid&&(t(e),o.current.value="")};return(0,f.useEffect)(()=>{setTimeout(()=>{o.current?.focus()})},[]),(0,l.jsx)(tv.l,{"aria-label":c,title:c,subtitle:(0,l.jsx)("span",{className:"text-normal text-small color-fg-muted",children:p}),footerButtons:[{content:"Cancel",buttonType:"normal",onClick:r},{content:h,onClick:v,buttonType:"primary"}],onClose:r,width:"medium",children:(0,l.jsxs)(tr.A,{sx:{flex:1,mr:2},children:[(0,l.jsx)(tr.A.Label,{children:(0,l.jsxs)("span",{className:"text-bold",children:[m," naming pattern"]})}),(0,l.jsx)(ts.A,{leadingVisual:()=>"include"===a?(0,l.jsx)(K.A,{icon:O.PlusCircleIcon,sx:{color:"success.fg"}}):(0,l.jsx)(K.A,{icon:O.XCircleIcon,sx:{color:"danger.fg"}}),ref:o,"aria-label":"Enter new target",className:"width-full",onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),v())},onBlur:e=>{if(!e.target.value||""===e.target.value.trim()){g("Pattern cannot be empty"),o.current?.focus();return}g("")},onChange:t=>{x&&g(""),j.validate(t.target.value.trim(),s,e)}}),(d?.length||0)>0&&(0,l.jsxs)(tr.A.Caption,{children:['Example patterns: "',d.join('", "'),'".',i&&(0,l.jsxs)(l.Fragment,{children:["\xa0",(0,l.jsx)(ey.A,{inline:!0,target:"_blank",href:i,children:"Learn more about fnmatch"}),"."]})]}),j.showError&&(0,l.jsx)(tr.A.Validation,{variant:"error","aria-live":"polite",children:"Invalid pattern"}),x&&(0,l.jsx)(tr.A.Validation,{variant:"error",children:x})]})})};try{t_.displayName||(t_.displayName="AddTargetDialog")}catch{}let tA=({rulesetId:e,readOnly:t,rulesetTarget:r,fnmatchHelpUrl:s,parameters:a,panelTitle:n,targetType:i,updateParameters:o,headerRowText:d,blankslate:c})=>{let u;let[p,m]=(0,f.useState)("include_target"),[h,x]=(0,f.useState)(!1),g=function(e,t){let r=[];return"ref_name"===t&&("branch"===e&&r.push({type:"include_default_branch",text:"Include default branch",includeOrExclude:"include",target:b}),r.push({type:"include_all",text:`Include all ${U(2,e,z,!1)}`,includeOrExclude:"include",target:_})),r.push({type:"include_target",text:"Include by pattern",actionGroup:"Target by inclusion or exclusion pattern",openDialog:!0,includeOrExclude:"include"}),r.push({type:"exclude_target",text:"Exclude by pattern",actionGroup:"Target by inclusion or exclusion pattern",openDialog:!0,includeOrExclude:"exclude"}),r}(r,i),y=g.find(e=>e.type===p)||g[0];switch(i){case"ref_name":u=`All ${U(2,r,z,!1)}`;break;case"repository_name":u="All repositories";break;case"organization_name":u="All organizations"}let j=e=>{m(e),(g.find(t=>t.type===e)||g[0]).openDialog?x(!0):v("",e)},v=(e,s=p)=>{if(t)return;let n=e.trim();if(n||"include_default_branch"===s||"include_all"===s){if("ref_name"===i)switch(r){case"branch":n=`refs/heads/${n}`;break;case"tag":n=`refs/tags/${n}`}a.include.concat(a.exclude).includes(n)||("include_default_branch"===s?a.include.includes(b)||o({...a,include:[...a.include,b]}):"include_target"===s?o({...a,include:[...a.include,n]}):"include_all"===s?a.include.includes(_)||o({...a,include:[...a.include,_]}):"exclude_target"===s&&o({...a,exclude:[...a.exclude,n]}))}},A=(0,f.useCallback)(e=>e===_?u:e===b?"Default":void 0,[u]),N=(0,f.useMemo)(()=>[a.include.map(e=>({t:"include",v:e})),a.exclude.map(e=>({t:"exclude",v:e}))].flat(1).map(e=>{var t;return{type:e.t,prefix:(t=e.v,"ref_name"===i||t===_)?void 0:"name",value:e.v,display:A(e.v),displayAsLabel:void 0!==A(e.v)}}),[a,i,A]),w=g.filter(e=>!e.actionGroup),S=g.filter(e=>e.actionGroup).reduce((e,t)=>{let r=e.get(t.actionGroup)||[];return r.push(t),e.set(t.actionGroup,r),e},new Map);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(th,{renderTitle:()=>(0,l.jsx)("h3",{className:"Box-title",children:n}),renderAction:()=>(0,l.jsxs)($.W,{children:[(0,l.jsx)($.W.Button,{children:"Add target"}),(0,l.jsx)($.W.Overlay,{width:"medium",children:(0,l.jsxs)(X.l,{children:[w.length>0&&w.map(e=>(0,l.jsxs)(X.l.Item,{onSelect:()=>j(e.type),disabled:!!e.target&&a.include.includes(e.target),children:[(0,l.jsx)(X.l.LeadingVisual,{children:"include"===e.includeOrExclude?(0,l.jsx)(K.A,{icon:O.PlusCircleIcon,sx:{color:"success.fg"}}):(0,l.jsx)(K.A,{icon:O.XCircleIcon,sx:{color:"danger.fg"}})}),e.text]},e.type)),Array.from(S).map(([e,t],r)=>(0,l.jsxs)(f.Fragment,{children:[(w.length>0||r>0)&&(0,l.jsx)(X.l.Divider,{}),(0,l.jsxs)(X.l.Group,{variant:"subtle",children:[(0,l.jsx)(X.l.GroupHeading,{children:e}),t.map(e=>(0,l.jsxs)(X.l.Item,{onSelect:()=>j(e.type),children:[(0,l.jsx)(X.l.LeadingVisual,{children:"include"===e.includeOrExclude?(0,l.jsx)(K.A,{icon:O.PlusCircleIcon,sx:{color:"success.fg"}}):(0,l.jsx)(K.A,{icon:O.XCircleIcon,sx:{color:"danger.fg"}})}),e.text]},e.type))]})]},e))]})})]}),headerRowText:d,blankslate:c,targets:N,onRemove:(e,r)=>{if(t)return;let s=("include"===e?a.include:a.exclude).filter(e=>e!==r);o("include"===e?{...a,include:s}:{...a,exclude:s})},readOnly:t}),!t&&("repository_name"===i||"repository_id"===i)&&(0,l.jsx)("div",{className:"py-3",children:(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tj.A,{checked:a.protected||!1,onChange:()=>{o({...a,protected:!a.protected})}}),(0,l.jsx)(tr.A.Label,{children:"Prevent renaming of target repositories"}),(0,l.jsx)(tr.A.Caption,{children:"When checked, target repositories can only be renamed by those with bypass permission."})]})}),t||!h?null:(0,l.jsx)(t_,{rulesetId:e,onAdd:e=>{v(e),x(!1)},onClose:()=>x(!1),target:i,includeOrExclude:y.includeOrExclude,rulesetTarget:r,fnmatchHelpUrl:s})]})};try{tA.displayName||(tA.displayName="IncludeExcludeTarget")}catch{}var tN=r(13473);let tw=({title:e,subtitle:t})=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tN.A,{sx:{pb:2,mb:2,fontSize:4,fontWeight:"normal"},children:e}),(0,l.jsx)(Q.A,{sx:{color:"fg.muted"},children:t})]});try{tw.displayName||(tw.displayName="PanelHeader")}catch{}var tS=r(10056);let tC=({readOnly:e,parameters:t,metadata:r,updateParameters:s,headerRowText:a,excludePublicRepos:n=!1,blankslate:i})=>{let[o,d]=(0,f.useState)([]),c=(0,f.useMemo)(()=>{let e=(r?.repositories||[]).concat(o).reduce((e,t)=>(e[t.nodeId]=t,e),{});return t.repository_ids.reduce((t,r)=>(e[r]&&t.push(e[r]),t),[])},[r,t,o]),{resolvePath:u}=R(),p=async e=>await e9(u("repo_suggestions"),{query:e,excludePublicRepos:n}),m=(0,f.useCallback)(async t=>{e||(s({repository_ids:t.map(e=>e.nodeId)}),d(t))},[e,s]),h=r=>{e||s({repository_ids:t.repository_ids.filter(e=>e!==r)})};(0,f.useEffect)(()=>{c.length!==t.repository_ids.length&&m(c)},[c,t,m]);let x=(0,f.useMemo)(()=>c.map(e=>({type:"include",prefix:"repo",value:e.nodeId,display:e.name})),[c]);return(0,l.jsx)(th,{renderTitle:()=>(0,l.jsx)("h3",{className:"Box-title",children:"Repositories"}),renderAction:()=>(0,l.jsx)(tS.P,{currentSelection:c,repositoryLoader:p,selectionVariant:"multiple",selectAllOption:!1,onSelect:e=>m(e)}),headerRowText:a,blankslate:i,targets:x,onRemove:(e,t)=>h(t),readOnly:e})};try{tC.displayName||(tC.displayName="RepositoryIdTarget")}catch{}var tI=r(60441),tR=r(35625);let tk=r(64851).Yj.map(({name:e})=>e),tT=({properties:e,onAdd:t,onClose:r,includeOrExclude:s})=>{let[a,n]=(0,f.useState)(""),[i,o]=(0,f.useState)([]),[d,c]=(0,f.useState)(void 0),[u,p]=(0,f.useState)(!1),[m,h]=(0,f.useState)([]),[x,g]=(0,f.useState)(""),y=(0,f.useMemo)(()=>m.map(e=>({text:e,id:e})),[m]),j=(0,f.useCallback)(e=>{h([]),c(e)},[]),v=(0,f.useCallback)(async t=>{try{o(e.filter(e=>e.name.toLowerCase().includes(t.toLowerCase())))}catch(e){}},[e]);(0,f.useEffect)(()=>{v(a)},[a,v]);let b=(0,f.useCallback)(e=>{h(m.filter(t=>t!==e))},[m]),_=(0,f.useCallback)(()=>{let e=m;if(d?.valueType==="string"&&w.current?.value.length&&(e=e.concat(w.current?.value||"")),!d||0===e.length){p(!0);return}t(d?.name||"",d?.source,e)},[m,d,t]),A=(0,f.useMemo)(()=>{if(!d)return[];if("language"===d.name&&"system"===d.source)return tk;switch(d.valueType){case"true_false":return["true","false"];case"single_select":case"multi_select":return d.allowedValues||[];default:return[]}},[d]).filter(e=>e.toLowerCase().includes(x.toLowerCase())),N=(0,f.useCallback)(e=>{let t=e.displayName;return t.length>24&&(t=`${t.substring(0,24)}...`),{id:e.displayName,text:t,descriptionVariant:"block",source:e,showDivider:!0,leadingVisual:tO[e.icon]}},[]),w=(0,f.useRef)(null),S=(0,f.useCallback)(e=>{"Enter"===e.key&&w&&(e.preventDefault(),h(m.concat(w.current?.value||"")),w.current.value="")},[m]),C=d?.displayName;return(0,l.jsxs)(tv.l,{title:`${tE(s)} repositories by property`,footerButtons:[{content:"Cancel",buttonType:"normal",onClick:r},{content:"Add target",onClick:_,buttonType:"primary"}],onClose:r,sx:{width:"500px"},children:[(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tr.A.Label,{children:(0,l.jsx)("span",{className:"text-bold",children:"Property"})}),(0,l.jsx)(tR.O,{renderAnchor:e=>(0,l.jsx)(er.Q,{trailingAction:O.TriangleDownIcon,alignContent:"start",...e,children:(0,l.jsx)(tu.A,{title:C||"Select property",maxWidth:195,children:C||"Select property"})}),placeholderText:"Search for properties",items:i,enforceAtleastOneSelected:!0,selectionVariant:"single",initialSelectedItems:d?[d]:[],maxVisibleItems:5,height:"medium",width:"medium",onSelectionChange:e=>{e.length>0&&j(e[0])},filterItems:n,getItemKey:e=>`${e.name}-${e.source}`,convertToItemProps:N}),u&&!d&&(0,l.jsx)(tr.A.Validation,{variant:"error","aria-live":"polite",children:"Please select a property"})]}),d&&(0,l.jsxs)(tr.A,{sx:{mt:2},children:[(0,l.jsx)(tr.A.Label,{children:"Value"}),(0,l.jsx)(t$,{valueType:d.valueType,items:A,valueInputRef:w,valueBoxKeyHandler:S,selectedValueTokens:y,removeValue:b,selectedValues:m,setSelectedValues:h,setFilterValueText:g}),u&&0===m.length&&(0,l.jsx)(tr.A.Validation,{variant:"error","aria-live":"polite",children:"Please select at least one value"})]})]})},tE=e=>e.charAt(0).toUpperCase()+e.slice(1),tO={note:O.NoteIcon,eye:O.EyeIcon,"repo-forked":O.RepoForkedIcon,code:O.CodeIcon};function t$({valueType:e,items:t,valueInputRef:r,valueBoxKeyHandler:s,selectedValueTokens:a,removeValue:n,selectedValues:i,setSelectedValues:o,setFilterValueText:d}){let c={setSelectedValues:o,selectedValues:i,setFilterValueText:d,items:t};switch(e){case"string":return(0,l.jsx)(tI.A,{sx:{width:"100%"},size:"large",ref:r,onKeyDown:s,tokens:a,onTokenRemove:n});case"single_select":case"multi_select":return(0,l.jsx)(tL,{renderAnchor:e=>(0,l.jsx)(er.Q,{alignContent:"start",trailingAction:O.TriangleDownIcon,...e,children:i.length>0?i.length>1?`${i.length} values selected`:i[0]:"Select a value"}),selectionVariant:"multiple",...c});case"true_false":return(0,l.jsx)(tL,{...c,selectionVariant:"single",renderAnchor:e=>(0,l.jsx)(er.Q,{alignContent:"start",trailingAction:O.TriangleDownIcon,...e,children:i.length>0?i[0]:"Select a value"})});default:return null}}function tL({renderAnchor:e,items:t,selectedValues:r,selectionVariant:s,setSelectedValues:a,setFilterValueText:n}){return(0,l.jsx)(tR.O,{renderAnchor:e,placeholderText:"Search for values",items:t,loading:!1,selectionVariant:s,initialSelectedItems:r,onSelectionChange:a,getItemKey:e=>e,convertToItemProps:e=>{let t=e;return t.length>24&&(t=`${t.substring(0,24)}...`),{id:e,text:t,source:e}},filterItems:n})}try{tk.displayName||(tk.displayName="LANGUAGE_NAMES")}catch{}try{tT.displayName||(tT.displayName="AddPropertyDialog")}catch{}try{t$.displayName||(t$.displayName="PropertyValueControl")}catch{}try{tL.displayName||(tL.displayName="ValueItemPicker")}catch{}let tB=["include","exclude"],tz=({readOnly:e,parameters:t,updateParameters:r,headerRowText:s,rulesetTarget:a,blankslate:n})=>{let[i,o]=(0,f.useState)("include"),[d,c]=(0,f.useState)(!1),[u,p]=(0,f.useState)([]),[m,h]=(0,f.useState)(!1),{resolvePath:x}=R(),g=async e=>{o(e),c(!0),m||(p((await e7(x("../available_properties"),a)).properties),h(!0))},y=(0,f.useMemo)(()=>t.include.some(e=>"language"===e.name&&"system"===e.source)||t.exclude.some(e=>"language"===e.name&&"system"===e.source),[t]),j=(s,a,n)=>{if(!e&&0!==s.length&&0!==n.length)switch(i){case"include":t.include.some(e=>tP(s,a,e))||r({...t,include:[...t.include,{name:s,source:a,property_values:n}]});break;case"exclude":t.exclude.some(e=>tP(s,a,e))||r({...t,exclude:[...t.exclude,{name:s,source:a,property_values:n}]})}},v=(0,f.useCallback)((s,a,n)=>{if(!e&&a)switch(s){case"include":r({...t,include:t.include.filter(e=>!tP(a,n,e))});break;case"exclude":r({...t,exclude:t.exclude.filter(e=>!tP(a,n,e))})}},[t,e,r]),b=(0,f.useMemo)(()=>{function e(e,t){let r=e.property_values.join(", ");return{type:t,prefix:"system"===e.source?e.name:`props.${e.name}`,value:r,display:e.property_values,onRemove:()=>v(t,e.name,e.source)}}return[...t.include.map(t=>e(t,"include")),...t.exclude.map(t=>e(t,"exclude"))]},[t,v]),_=u.filter(e=>!("include"===i?t.include:t.exclude).some(t=>t.name===e.name&&(t.source||"custom")===e.source));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(th,{renderTitle:()=>(0,l.jsx)("h3",{className:"Box-title",children:"Target by repository properties"}),renderAction:()=>(0,l.jsxs)($.W,{children:[(0,l.jsx)($.W.Button,{children:"Add a target"}),(0,l.jsx)($.W.Overlay,{width:"medium",children:(0,l.jsx)(X.l,{children:tB.map(e=>(0,l.jsxs)(X.l.Item,{onSelect:()=>g(e),children:[(0,l.jsx)(X.l.LeadingVisual,{children:"include"===e?(0,l.jsx)(K.A,{icon:O.PlusCircleIcon,sx:{color:"success.fg"}}):(0,l.jsx)(K.A,{icon:O.XCircleIcon,sx:{color:"danger.fg"}})}),"include"===e?"Include by property":"Exclude by property"]},e))})})]}),blankslate:n,headerRowText:s,targets:b,readOnly:e}),e||!d?null:(0,l.jsx)(tT,{properties:_,onAdd:(e,t,r)=>{j(e,t,r),c(!1)},onClose:()=>c(!1),includeOrExclude:i}),y&&(0,l.jsx)(ef.A,{sx:{fontSize:0,p:2,my:2,borderRadius:2,borderWidth:1,borderStyle:"solid",borderColor:"warning.muted"},children:"Please note that the 'language' property is determined by the current contents of the repository. As new commits are made the language may change, which could affect the evaluation of this property."})]})};function tP(e,t="custom",r){return r.name===e&&(r.source||"custom")===t}try{tz.displayName||(tz.displayName="RepositoryPropertyTarget")}catch{}let tD="Push rulesets only apply to private repositories and their forks",tF=({rulesetId:e,readOnly:t,fnmatchHelpUrl:r,rulesetTarget:s,targetType:a,parameters:n,metadata:i,updateParameters:o})=>{let d=to(a,n)?"all_repos":a;return"all_repos"!==d||t?(0,l.jsx)("div",{children:"repository_name"===d?(0,l.jsx)(tA,{rulesetId:e,readOnly:t,rulesetTarget:s,fnmatchHelpUrl:r,parameters:n,panelTitle:"Targeting criteria",targetType:"repository_name",updateParameters:o,headerRowText:"push"===s?tD:void 0,blankslate:{heading:"No repository targets have been added yet"}}):"repository_id"===d?(0,l.jsx)(tC,{readOnly:t,parameters:n,metadata:i,updateParameters:o,headerRowText:"push"===s?tD:void 0,excludePublicRepos:"push"===s,blankslate:{heading:"No repository targets have been added yet",description:t?void 0:(0,l.jsx)(l.Fragment,{children:"Repository targeting determines which repositories will be protected by this ruleset."})}}):"repository_property"===d?(0,l.jsx)(tz,{readOnly:t,parameters:n,updateParameters:o,headerRowText:"push"===s?tD:void 0,rulesetTarget:s,blankslate:{heading:"No repository targets have been added yet",description:t?void 0:(0,l.jsx)(l.Fragment,{children:"Repository targeting determines which repositories will be protected by this ruleset."})}}):(0,l.jsx)(th,{renderTitle:()=>(0,l.jsx)("h3",{className:"Box-title",children:"Repositories"}),blankslate:{heading:"No repository targets have been added yet",description:t?void 0:(0,l.jsx)(l.Fragment,{children:"Repository targeting determines which repositories will be protected by this ruleset."})},headerRowText:"push"===s?tD:void 0,targets:[{type:"include",value:_}],readOnly:!0})}):null};try{tF.displayName||(tF.displayName="RepositoryTarget")}catch{}function tM({errorId:e,children:t,errorRef:r,sx:s}){return(0,l.jsx)(y.A,{sx:{display:"flex",gap:2,flexDirection:"column",my:2,...s},children:(0,l.jsx)(ef.A,{ref:r,variant:"danger",sx:{display:"flex",alignItems:"center"},id:e,tabIndex:0,children:t})})}try{tM.displayName||(tM.displayName="RulesetFormErrorFlash")}catch{}function tV(e,t){return!!t&&!t.ui_control&&("string"===t.type||"integer"===t.type)}let tW=({errors:e,fields:t,filters:r,useDefaultFilters:s=!0})=>(0,f.useMemo)(()=>{if(s&&(r={...r,removeNonUIControlErrors:{args:"errorAndField",func:tV}}),void 0===r)return{unregistered:e};let[a,n]=Object.keys(r).reduce(([e,s],a)=>{if(0===s.length)return[e,s];let[n,l]=s.reduce(([e,s],n)=>{let l=t.find(e=>e.name===n.field);return r&&void 0!==r[a]?("errorAndField"===r[a].args?r[a].func(n,l):r[a].func(n))?[[...e,n],s]:[e,[...s,n]]:[e,s]},[[],[]]);return[{...e,[`${a}`]:n},[...l]]},[{},e]);return{...a,unregistered:n}},[e,t,r]),tU={unexpectedType:{args:"error",func:e=>"repository_id"===e.field&&"Invalid parameter repository_ids: repository ids cannot be empty"===e.message}},tG=({errors:e,errorId:t,errorRef:r})=>{let s;let a=tW({errors:e,fields:[],filters:tU});return a.unexpectedType&&a.unexpectedType.length>0?s="Repository conditions cannot be empty":a.unregistered&&a.unregistered.length>0&&(s=a.unregistered[0]?.message||"An error occurred"),s&&(0,l.jsx)(tM,{errorId:t,errorRef:r,children:s})||null};try{tG.displayName||(tG.displayName="RepositoryConditionsError")}catch{}let tH=()=>(0,B.u)("rules_exclude_public_repositories_from_targeting")?(0,l.jsx)(ef.A,{children:(0,l.jsxs)("div",{className:"d-flex flex-row flex-items-center",children:[(0,l.jsx)(K.A,{icon:O.InfoIcon}),(0,l.jsx)("span",{children:"Push rulesets only apply to private or internal repositories and their forks."})]})}):null;try{tH.displayName||(tH.displayName="PushRulePublicTargetingBanner")}catch{}function tq(e,t){let r=e.property_values.map(tK).join(","),s="system"===e.source?"":"props.";return`${t}${s}${e.name}:${r}`}function tK(e){return e.includes(" ")?`"${e}"`:e}var tQ=r(67269),tJ=r(22868);let tY=({baseAvatarUrl:e,selectedOrgs:t,selectOrg:r,removeOrg:s,orgLoader:a})=>{let[n,i]=(0,f.useState)([]),o=(0,f.useMemo)(()=>n.map(a=>({text:a.name,id:JSON.stringify(a),leadingVisual:()=>(0,l.jsx)(tJ.r,{alt:a.name,src:`${e}/u/${a.id}`}),onAction:()=>{var e;let n=(e=a.nodeId,t.find(({nodeId:t})=>t===e));n?s(n.nodeId):r(a.id,a.nodeId,a.name)}})),[n,t,r,s,e]),[d,c]=(0,f.useState)(!1),[u,p]=(0,f.useState)(!1),[m,h]=(0,f.useState)(""),x=async()=>{u?p(!1):(p(!0),c(!0),i(await a("")),c(!1))},g=(0,f.useCallback)((0,eZ.s)(async e=>{""===e?i(await a("")):i(await a(e))},200),[a,i]);return(0,l.jsx)(tQ.X,{loading:d,title:"Select organizations",renderAnchor:({"aria-labelledby":e,...t})=>(0,l.jsx)(er.Q,{leadingVisual:O.OrganizationIcon,trailingVisual:O.TriangleDownIcon,"aria-labelledby":` ${e}`,...t,"aria-haspopup":"dialog",children:"Select organizations"}),open:u,onOpenChange:x,items:o,selected:o.filter(e=>{if("string"==typeof e.id){var r;return r=JSON.parse(e.id).nodeId,t.some(({nodeId:e})=>e===r)}}),onSelectedChange:()=>{},placeholderText:"Filter organizations",filterValue:m,onFilterChange:e=>{h(e),g(e)},overlayProps:{width:"medium",height:"medium"}})};try{tY.displayName||(tY.displayName="OrgSelector")}catch{}let tX=({readOnly:e,parameters:t,metadata:r,updateParameters:s,headerRowText:a,blankslate:n})=>{let{baseAvatarUrl:i}=(0,g.B)(),[o,d]=(0,f.useState)([]),c=(0,f.useMemo)(()=>{let e=(r?.organizations||[]).concat(o).reduce((e,t)=>(e[t.nodeId]=t,e),{});return t.organization_ids.reduce((t,r)=>(e[r]&&t.push(e[r]),t),[])},[r,t,o]),{resolvePath:u}=R(),p=async e=>await e4(u("org_suggestions"),{query:e}),m=(0,f.useCallback)(async t=>{e||(s({organization_ids:t.map(e=>e.nodeId)}),d(t))},[e,s]);(0,f.useEffect)(()=>{c.length!==t.organization_ids.length&&m(c)},[c,t,m]);let h=(r,a,n)=>{e||(s({organization_ids:[...t.organization_ids,a]}),d([...o,{id:r,nodeId:a,name:n}]))},x=r=>{e||(s({organization_ids:t.organization_ids.filter(e=>e!==r)}),d(o.filter(e=>e.nodeId!==r)))},y=(0,f.useMemo)(()=>c.map(e=>({type:"include",prefix:"org",value:e.nodeId,display:e.name})),[c]);return(0,l.jsx)(th,{renderTitle:()=>(0,l.jsx)("h3",{className:"Box-title",children:"Organizations"}),renderAction:()=>(0,l.jsx)(tY,{baseAvatarUrl:i,selectedOrgs:c,selectOrg:h,removeOrg:x,orgLoader:p}),headerRowText:a,blankslate:n,targets:y,onRemove:(e,t)=>x(t),readOnly:e})};try{tX.displayName||(tX.displayName="OrganizationIdTarget")}catch{}let tZ="Push rulesets only apply to private repositories and their forks",t0=({rulesetId:e,readOnly:t,fnmatchHelpUrl:r,rulesetTarget:s,targetType:a,parameters:n,metadata:i,updateParameters:o,supportsEmuTargeting:d})=>{let c=n.include_emu_accounts,u=(0,f.useCallback)(()=>{o({...n,include_emu_accounts:!c})},[c,n,o]),p=to(a,n)?"all_orgs":a;return(0,l.jsxs)("div",{children:["organization_name"===p?(0,l.jsx)(tA,{rulesetId:e,readOnly:t,rulesetTarget:s,fnmatchHelpUrl:r,parameters:n,panelTitle:"Targeting criteria",targetType:"organization_name",updateParameters:o,headerRowText:"push"===s?tZ:void 0,blankslate:{heading:"No organization targets have been added yet"}}):"organization_id"===p?(0,l.jsx)(tX,{readOnly:t,parameters:n,metadata:i,updateParameters:o,headerRowText:"push"===s?tZ:void 0,blankslate:{heading:"No organization targets have been added yet",description:t?void 0:(0,l.jsx)(l.Fragment,{children:"Organization targeting determines which repositories will be protected by this ruleset."})}}):null,!t&&d&&(0,l.jsx)("div",{className:"all_orgs"===p?"pb-3":"py-3",children:(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tj.A,{checked:c||!1,onChange:u}),(0,l.jsx)(tr.A.Label,{children:"Target all enterprise managed user accounts"}),(0,l.jsx)(tr.A.Caption,{children:"If enabled, this ruleset will also apply to all repositories owned by enterprise managed users."})]})})]})};try{t0.displayName||(t0.displayName="OrganizationTarget")}catch{}let t1=[{condition:"all_repos",name:"All repositories",description:"Target all repositories within the organization",beta:!1},{condition:"repository_name",name:"Dynamic list by name",description:"Target repositories based on name",beta:!1},{condition:"repository_property",name:"Dynamic list by property",description:"Target repositories based on properties",beta:!1},{condition:"repository_id",name:"Select repositories",description:"Target a specific list of selected repositories",beta:!1}];function t2({excludeConditions:e=[],currentRepoCondition:t,setRepoCondition:r}){let s=to(t.target,t.parameters)?"all_repos":t.target,a=t1.filter(({condition:t})=>!e.includes(t));return(0,l.jsx)(t9,{selectedTargetType:s,selectOption:e=>r(e.condition),options:a})}let t3=[{condition:"all_orgs",name:"All organizations",description:"Target all organizations within the enterprise",beta:!1},{condition:"organization_name",name:"Dynamic list by name",description:"Target organizations based on name",beta:!1},{condition:"organization_id",name:"Select organizations",description:"Target a specific list of selected organizations",beta:!1}];function t5({currentOrgCondition:e,setOrgCondition:t}){let r=to(e.target,e.parameters)?"all_orgs":e.target;return(0,l.jsx)(t9,{selectedTargetType:r,selectOption:e=>t(e.condition),options:t3})}function t9({selectedTargetType:e,selectOption:t,options:r}){let s=r.find(t=>t.condition===e)||r[0];return(0,l.jsxs)($.W,{children:[(0,l.jsx)($.W.Button,{children:(0,l.jsxs)("div",{className:"d-flex gap-1",children:[(0,l.jsx)("span",{className:"text-normal",children:"Target:"}),(0,l.jsx)("span",{className:"text-bold",children:s.name})]})}),(0,l.jsx)($.W.Overlay,{width:"medium",children:(0,l.jsx)(X.l,{selectionVariant:"single",children:r.map(e=>(0,l.jsxs)(X.l.Item,{selected:e===s,onSelect:()=>e!==s&&t(e),children:[e.name,(0,l.jsx)(X.l.Description,{variant:"block",children:e.description}),e.beta&&(0,l.jsx)(X.l.TrailingVisual,{children:(0,l.jsx)(T.A,{variant:"success",children:"Beta"})})]},e.name))})})]})}function t4(e){switch(e){case"repository_name":case"ref_name":case"repository_property":case"organization_name":default:return{include:[],exclude:[]};case"repository_id":return{repository_ids:[]};case"organization_id":return{organization_ids:[]};case"all_repos":case"all_orgs":return{include:[_],exclude:[]}}}try{t2.displayName||(t2.displayName="RepositoryTargetTypeSelector")}catch{}try{t5.displayName||(t5.displayName="OrganizationTargetTypeSelector")}catch{}try{t9.displayName||(t9.displayName="TargetTypeSelector")}catch{}let t7=({rulesetPreviewCount:e,rulesetPreviewSamples:t,rulesetError:r,conditions:s,sourceName:a,targetObjectType:n})=>{if(r)return(0,l.jsx)(y.A,{sx:{mt:1},children:(0,l.jsx)(Q.A,{className:"text-small color-fg-muted",as:"span",sx:{mr:1},children:r})});if("number"!=typeof e)return null;let i=s?.find(e=>"repository_property"===e.target);if(i){let t=function({orgName:e,parameters:t}){let r=[...t.include.map(e=>tq(e,"")),...t.exclude.map(e=>tq(e,"-"))].join(" ");return(0,eo.Qe)({owner:e,query:r})}({orgName:a,parameters:i.parameters});return(0,l.jsx)(y.A,{sx:{mt:1},children:(0,l.jsxs)(Q.A,{className:"text-small color-fg-muted",as:"span",sx:{mr:1},children:["Applies to"," ",(0,l.jsx)(ey.A,{inline:!0,href:t,children:U(e,n,P)}),"."]})})}return(0,l.jsxs)(y.A,{sx:{mt:1},children:[(0,l.jsxs)("span",{className:"text-small color-fg-muted",children:["Applies to ",U(e,"target","targets"),1===e?":":"",t&&t.length>1?" including ":""]}),t&&t.map((r,s)=>(0,l.jsxs)("span",{children:[s===t.length-1&&e<=10&&s>0&&(0,l.jsx)(Q.A,{className:"text-small color-fg-muted mt-1",as:"span",sx:{mr:1},children:"and"}),(0,l.jsx)(tm,{param:r}),(0,l.jsx)("span",{className:"text-small color-fg-muted mt-1",children:s<t.length-1?", ":e>10?" and others":""})]},r)),(0,l.jsx)("span",{className:"text-small color-fg-muted",children:"."})]})},t6=({rulesetId:e,readOnly:t,rulesetTarget:r,rulesetPreviewCount:s,rulesetPreviewSamples:a,rulesetError:n,fnmatchHelpUrl:i,dirtyConditions:o,conditions:d,conditionErrors:c,supportedConditionTargetObjects:u,repositoryConditionRef:p,refConditionRef:m,addOrUpdateCondition:h,removeCondition:x,source:g})=>{let y=void 0!==e,j=(0,B.u)("emu_inherit_rulesets_from_business")&&g.enterpriseManaged,v=(0,f.useMemo)(()=>M.reduce((e,t)=>{let r=d.find(e=>F[e.target]===t);if(!r){let e=td(t,{supportedConditionTargetObjects:u});r={target:td(t),parameters:t4(e),_dirty:!0}}return e.set(t,r),e},new Map),[d,u]),b=(0,f.useMemo)(()=>M.reduce((e,t)=>{let r=v.get(t);return e.set(t,r.target),e},new Map),[v]),_=(0,f.useCallback)(e=>{let t=e;"all_orgs"===e&&(t="organization_name"),"all_repos"===e&&(t="repository_name");let r=d.find(e=>F[e.target]===F[t]);r&&x(r),h(t,t4(e))},[d,x,h]);(0,f.useEffect)(()=>{for(let e of u){let t=v.get(e);t&&(d.find(({target:e})=>e===t.target)||h(t.target,t.parameters))}},[d,v,u,h]);let A=u.includes("ref"),N=u.includes("repository"),w=u.includes("organization"),S=A&&N?`repositories and ${U(2,r,z,!1)}`:A?`${U(2,r,z,!1)}`:N?"repositories":"";function C(e,t){return`${G(e)} targeting determines which ${t} will be protected by this ruleset. Use inclusion patterns to expand the list of ${t} under this ruleset. Use exclusion patterns to exclude ${t}.`}return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tw,{title:"Targets",subtitle:`Which ${S} do you want to make a ruleset for?`}),(0,l.jsxs)("div",{className:"d-flex flex-column",children:[w&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:`mb-${t?0:3}`,children:[(0,l.jsx)(ej.A,{as:"h3",sx:{mb:1,mt:4,fontSize:3,fontWeight:"normal"},children:"Target organizations"}),(0,l.jsx)("span",{className:"color-fg-muted",children:C("organization","organizations")})]}),!t&&(0,l.jsx)("div",{className:"pb-3",children:(0,l.jsx)(t5,{currentOrgCondition:v.get("organization"),setOrgCondition:_})}),(0,l.jsx)(t0,{rulesetId:e,readOnly:t,fnmatchHelpUrl:i,rulesetTarget:r,targetType:b.get("organization"),parameters:v.get("organization").parameters,metadata:v.get("organization").metadata,updateParameters:e=>h(b.get("organization"),e),supportsEmuTargeting:j}),!to(b.get("organization"),v.get("organization").parameters)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t7,{rulesetPreviewCount:s,rulesetPreviewSamples:a,rulesetError:n,conditions:d,sourceName:g.name,targetObjectType:"organization"}),(0,l.jsx)("div",{className:"d-flex flex-column",children:y&&o.some(e=>"organization"===F[e.target])&&(0,l.jsxs)("div",{className:"text-small mt-1 d-flex color-fg-attention",children:[(0,l.jsx)(O.AlertIcon,{}),(0,l.jsx)("span",{className:"ml-1","aria-live":"polite",children:"Targets have changed and organization match list will update on save."})]})})]})]}),N&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:`mb-${t?0:3}`,children:[(0,l.jsx)(ej.A,{as:"h3",sx:{mb:1,mt:4,fontSize:3,fontWeight:"normal"},children:"Target repositories"}),(0,l.jsx)("span",{className:"color-fg-muted",children:C("repository","repositories")}),c?.repository?.[0]?.message&&(0,l.jsx)(tG,{errors:c?.repository,errorId:"repo-target-error",errorRef:p})]}),"push"===r&&(0,l.jsx)("div",{className:"mb-3",children:(0,l.jsx)(tH,{})}),(0,l.jsxs)("div",{"data-testid":"targets-repository-name-conditions",children:[!t&&(0,l.jsx)("div",{className:"pb-3",children:(0,l.jsx)(t2,{excludeConditions:w?["repository_id","repository_name"]:[],currentRepoCondition:v.get("repository"),setRepoCondition:_})}),(0,l.jsx)(tF,{rulesetId:e,readOnly:t,fnmatchHelpUrl:i,rulesetTarget:r,targetType:b.get("repository"),parameters:v.get("repository").parameters,metadata:v.get("repository").metadata,updateParameters:e=>h(b.get("repository"),e)}),!w&&!to(b.get("repository"),v.get("repository").parameters)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t7,{rulesetPreviewCount:s,rulesetPreviewSamples:a,rulesetError:n,conditions:d,sourceName:g.name,targetObjectType:"repository"}),(0,l.jsx)("div",{className:"d-flex flex-column",children:y&&o.some(e=>"repository"===F[e.target])&&(0,l.jsxs)("div",{className:"text-small mt-1 d-flex color-fg-attention",children:[(0,l.jsx)(O.AlertIcon,{}),(0,l.jsx)("span",{className:"ml-1","aria-live":"polite",children:"Targets have changed and repository match list will update on save."})]})})]})]})]}),A&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:`mb-${t?0:3}`,children:[(0,l.jsxs)(ej.A,{as:"h3",sx:{mb:1,mt:4,fontSize:3,fontWeight:"normal"},children:["Target ",U(2,r,z,!1)]}),!t&&(0,l.jsx)("span",{className:"fg-color-muted",children:C(r,U(2,r,z,!1))}),c?.ref?.[0]?.message&&(0,l.jsx)(tM,{errorId:"ref-target-error",sx:{mt:1},errorRef:m,children:c.ref[0].message})]}),(0,l.jsxs)("div",{"data-testid":"targets-ref-name-conditions",children:[(0,l.jsx)(tA,{rulesetId:e,readOnly:t,rulesetTarget:r,fnmatchHelpUrl:i,parameters:v.get("ref").parameters,panelTitle:`${G(r)} targeting criteria`,targetType:"ref_name",updateParameters:e=>h(b.get("ref"),e),blankslate:{heading:`${G(r)} targeting has not been configured`}}),!N&&(0,l.jsx)(t7,{rulesetPreviewCount:s,rulesetPreviewSamples:a,rulesetError:n,conditions:d,sourceName:g.name,targetObjectType:"ref"}),(0,l.jsx)("div",{className:"d-flex flex-column",children:y&&o.findIndex(e=>"ref"===F[e.target])>=0&&(0,l.jsxs)("div",{className:"text-small mt-1 d-flex color-fg-attention",children:[(0,l.jsx)(O.AlertIcon,{}),(0,l.jsxs)("span",{className:"ml-1","aria-live":"polite",children:["Targets have changed and ",r," match list will update on save."]})]})})]})]})]})]})};try{t7.displayName||(t7.displayName="AffectedTargetsSummary")}catch{}try{t6.displayName||(t6.displayName="TargetsPanel")}catch{}function t8({field:e,value:t,onValueChange:r,readOnly:s,errors:a}){t=t??e.default_value;let n=`${e.name}Label`;return s?(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-bold",children:e.display_name}),(0,l.jsx)("span",{className:"d-block text-small color-fg-muted",children:e.description})]}):(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tj.A,{"aria-labelledby":n,checked:"ALLGREEN"===t,onChange:e=>{r?.(e.target.checked?"ALLGREEN":"HEADGREEN")}}),(0,l.jsx)(tr.A.Label,{id:n,children:e.display_name}),(0,l.jsx)(tr.A.Caption,{children:e.description}),a.length>0&&(0,l.jsx)(tr.A.Validation,{variant:"error",children:a[0]?.message})]})}try{t8.displayName||(t8.displayName="MergeQueueGroupingStrategy")}catch{}var re=r(38553);async function rt(e,t,r=1,s=3){try{let r=await (0,Z.DI)(e,{signal:t.signal});if(!r.ok)throw Error(`Error ${r.status}`);return{values:await r.json()}}catch(a){if(a instanceof DOMException&&"AbortError"===a.name)return{error:"Repository settings load was cancelled"};if(r<=s)return await new Promise(e=>{setTimeout(e,100),t.signal.addEventListener("abort",e)}),rt(e,t,r+1,s);return{error:"Failed to load repository settings"}}}function rr({field:e,value:t,onValueChange:r,readOnly:s}){let[a,n]=(0,f.useState)(!0),[i,o]=(0,f.useState)([]),[d,c]=(0,f.useState)(void 0),{resolvePath:u}=R(),p="allowed_options"in e?e.allowed_options?.find(e=>e.value===t)?.display_name??t:t;(0,f.useEffect)(()=>{if(s)return;n(!0),c(void 0);let e=new AbortController;return(async()=>{let t=u("../merge_queue_merge_methods.json"),{values:r,error:s}=await rt(t,e);r?(c(void 0),o(r)):(c(s),o([])),n(!1)})(),()=>e.abort()},[s,u]);let m="Merge method",h="Method to use when merging changes from queued pull requests.";return s?(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-bold",children:m}),(0,l.jsxs)("span",{children:[" ",p]}),(0,l.jsx)("span",{className:"d-block text-small color-fg-muted",children:h})]}):(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tr.A.Label,{children:m}),(0,l.jsx)(tr.A.Caption,{children:h}),(0,l.jsxs)($.W,{children:[(0,l.jsx)($.W.Button,{"aria-label":"Select merge method",children:p}),(0,l.jsx)($.W.Overlay,{width:"medium",children:a?(0,l.jsx)("div",{className:"p-3",children:(0,l.jsx)(re.A,{size:"medium"})}):d?(0,l.jsxs)("div",{className:"p-3 color-fg-danger",children:[(0,l.jsx)(O.AlertIcon,{className:"mr-1"}),(0,l.jsx)("span",{children:d})]}):(0,l.jsx)(X.l,{selectionVariant:"single",showDividers:!0,children:i.map(e=>(0,l.jsxs)(X.l.Item,{selected:e.value===t,onSelect:()=>{r?.(e.value)},disabled:!e.enabled,children:[e.label,!e.enabled&&!!e.disabled_reason&&(0,l.jsx)(X.l.Description,{variant:"block",children:e.disabled_reason})]},e.label))})})]})]})}try{rr.displayName||(rr.displayName="MergeQueueMergeMethod")}catch{}var rs=r(65556);let ra=[],rn={id:void 0,name:"Any source"};function rl(e,t){return e.context===t.context&&e.integration_id===t.integration_id}function ri({sourceType:e,value:t,onValueChange:r,readOnly:s,metadata:a,helpUrls:n}){let i=t||ra,{resolvePath:o}=R(),{safeSetTimeout:d}=(0,rs.A)(),c=(0,f.useRef)({}),u=(0,f.useRef)(void 0),p=(0,f.useRef)(!1),[m,h]=(0,f.useState)(""),[x,g]=(0,f.useState)([]),[j,v]=(0,f.useState)(!1),[b,_]=(0,f.useState)(void 0),[A,N]=(0,f.useState)(!s),w=i.length?"Status checks that are required":"No required checks";return(0,f.useEffect)(()=>{(async function(){if(p.current)return;p.current=!0;let e=[rn,...a?.integrations||[]];if(!s)try{let t=await (0,Z.DI)(o("../integration_suggestions.json"));if(t.ok)for(let r of(await t.json()))e.find(e=>e.id===r.id)||e.push(r)}finally{N(!1)}_(Array.from(e).sort((e,t)=>e.name.localeCompare(t.name)))})()},[o,a,s]),(0,f.useEffect)(()=>{async function t(e){g([]);try{if(!m){v(!1);return}h(m.trim()),v(!0);let t=await (0,Z.DI)(o(`../status_check_suggestions.json?query=${encodeURIComponent(m)}`),{signal:e.signal});if(e.signal.aborted||!t.ok)return;g(await t.json())}finally{v(!1)}}if("organization"===e)return;u.current?.abort();let r=new AbortController;u.current=r,v(!0);let s=d(()=>{t(r)},1e3);return()=>clearTimeout(s)},[o,d,e,m]),(0,l.jsx)(l.Fragment,{children:s?(0,l.jsx)(ro,{selectedRequiredStatusChecks:i,readOnly:s,helpUrls:n,fetchingIntegrations:!1,integrations:b,onValueChange:r,userAddedStatusCheckContextsRef:c}):(0,l.jsxs)("div",{className:"Box",children:[(0,l.jsxs)(y.A,{className:"Box-header d-flex flex-justify-between",sx:{alignItems:"center"},children:[(0,l.jsx)("div",{className:"Box-title",children:w}),(0,l.jsx)(rp,{value:i,onValueChange:r,setFilter:h,suggestions:x,integrations:b,loading:j,statusCheckFilter:m})]}),(0,l.jsx)(ro,{selectedRequiredStatusChecks:i,readOnly:s,helpUrls:n,fetchingIntegrations:A,integrations:b,onValueChange:r,userAddedStatusCheckContextsRef:c})]})})}function ro({selectedRequiredStatusChecks:e,readOnly:t,helpUrls:r,fetchingIntegrations:s,integrations:a,onValueChange:n,userAddedStatusCheckContextsRef:i}){return(0,l.jsx)(l.Fragment,{children:e.length?(0,l.jsx)("ul",{children:e.filter((e,t,r)=>r.findIndex(t=>rl(t,e))===t).map((r,o)=>(0,l.jsxs)("li",{className:"Box-row d-flex flex-justify-between flex-items-center",children:[(0,l.jsx)("span",{children:r.context}),(0,l.jsxs)("div",{className:"d-flex flex-items-center",children:[s?(0,l.jsx)(re.A,{size:"small"}):(0,l.jsx)(rm,{requiredStatusCheck:r,readOnly:t,integrations:a,onChange:t=>{let r=e.concat();r[o]={...r[o],integration_id:t},n?.(r)}}),!t&&(0,l.jsx)(L.K,{className:"ml-2",icon:O.TrashIcon,type:"button","aria-label":`Delete ${r.context}}`,size:"small",variant:"invisible",onClick:()=>{delete i.current[r.context],n?.(e.filter(e=>!rl(e,r)))}})]})]},`${r.context}_${r.integration_id?.toString()||"any"}`))}):(0,l.jsx)(v,{heading:"No checks have been added",children:!t&&r&&(0,l.jsx)(ey.A,{target:"_blank",href:r.statusChecks,children:"Learn more about status checks"})})})}let rd={groupId:"newEntries"},rc={groupId:"suggestions",header:{title:"Suggestions",variant:"filled"}},ru={groupId:"alreadyAdded"};function rp({value:e,suggestions:t,integrations:r,loading:s,statusCheckFilter:a,onValueChange:n,setFilter:i}){let o=(0,f.useRef)(!1),d=(0,f.useRef)([]),c=(0,f.useMemo)(()=>t.filter(t=>!e.find(e=>e.context===t.context)),[t,e]),u=(0,f.useCallback)(t=>c.length>0&&c.find(e=>e.context===t.context)?rc.groupId:t.context!==a||e.find(e=>e.context===a)?ru.groupId:rd.groupId,[c,a,e]),p=(0,f.useCallback)((e,t)=>t.find(t=>t.context===e),[]),m=(0,f.useCallback)((e,t)=>{let s={id:"",source:{context:"",integration_id:void 0},text:"",groupId:"",leadingVisual:void 0,selectionVariant:void 0};switch(e){case"standard":s.id=t.context,s.source=t,s.text=`Already added ${t.context}`,s.groupId=u(t),s.disabled=!0;break;case"newEntry":s.id=t.context,s.source=t,s.groupId=u(t),s.groupId===rc.groupId?(s.text=t.context,s.description=r?.find(e=>e.id===t.integration_id)?.name||rn.name):(s.text=`Add ${t.context}`,s.description="Any source",s.leadingVisual=()=>(0,l.jsx)(K.A,{icon:O.PlusIcon})),s.selectionVariant="multiple",s.onAction=(e,r)=>{if("click"===r.type){o.current=!0;let e=p(t.context,d.current);s.selected?e||(d.current=[...d.current,t]):e&&(d.current=d.current.filter(t=>t.context!==e.context))}}}return s},[u,r,p]),h=(0,f.useCallback)(t=>p(t.context,e)?m("standard",t):m("newEntry",t),[m,p,e]),x=e=>[{context:e,integration_id:void 0}],g=e=>({context:e.context,integration_id:e.latest_integration_id}),y=(0,f.useMemo)(()=>{let t=[],r=e.some(e=>e.context===a),s=!r&&!c.some(e=>e.context===a);return a&&(r&&t.push(ru),s&&t.push(rd),c.length>0&&t.push(rc)),t},[e,c,a]),j=(0,f.useMemo)(()=>{let t=p(a,e),r=c?.some(e=>e.context===a);if(!a)return[...d.current];if(!c)return t?[t]:x(a);{let e=c.map(g).slice(0,10);return r?e:t?[t,...e]:[...e,...x(a)]}},[p,a,e,c]);return(0,l.jsx)(tR.O,{title:"Add Checks",items:j,groups:y,initialSelectedItems:e,getItemKey:t=>p(t.context,e)?`${t.context}:${t.integration_id||"any"}`:p(t.context,c)?`${t.context}:${t.integration_id||"any"}:suggestion`:t.context,convertToItemProps:h,selectionVariant:"multiple",placeholderText:"Search for checks",filterItems:i,renderAnchor:e=>(0,l.jsx)(er.Q,{trailingAction:O.TriangleDownIcon,leadingVisual:O.PlusIcon,"aria-label":"Click to change required status check(s)",...e,children:"Add checks"}),loading:s,onSelectionChange:t=>{if(d.current=[],o.current&&t.length>0){let r=new Set([...e,...t]);n?.([...r])}o.current=!1}})}function rm({requiredStatusCheck:e,readOnly:t,integrations:r,onChange:s}){let[a,n]=(0,f.useState)(""),i=(0,f.useMemo)(()=>e.integration_id?r?r.find(t=>t.id===e.integration_id)||rn:{id:e.integration_id,name:"Unknown"}:rn,[r,e.integration_id]),o=(0,f.useMemo)(()=>a?r?.filter(e=>e.name.toLowerCase().indexOf(a.toLowerCase())>=0)||[]:r||[],[a,r]);return(0,l.jsx)(tR.O,{getItemKey:e=>e.id?.toString()||"any",items:o,placeholderText:"Select source",initialSelectedItems:[i],selectionVariant:"single",filterItems:n,convertToItemProps:e=>({id:e.id,source:e,text:e.name,leadingVisual:e.preferred_avatar_url?()=>(0,l.jsx)(tJ.r,{alt:e.name,src:e.preferred_avatar_url}):void 0}),renderAnchor:e=>{let r=(0,l.jsxs)(l.Fragment,{children:[i.preferred_avatar_url&&(0,l.jsx)(tJ.r,{className:"mr-2",alt:i.name,src:i.preferred_avatar_url}),i.name]});return t?(0,l.jsx)("span",{className:"d-inline-flex flex-items-center",children:r}):(0,l.jsx)(er.Q,{...e,className:"d-inline-flex flex-items-center",variant:"invisible","aria-label":"Click to change source",children:r})},onSelectionChange:e=>s(e[0]?.id)})}try{ri.displayName||(ri.displayName="RequiredStatusCheckSelectList")}catch{}try{ro.displayName||(ro.displayName="StatusCheckRows")}catch{}try{rp.displayName||(rp.displayName="StatusCheckPicker")}catch{}try{rm.displayName||(rm.displayName="IntegrationPicker")}catch{}var rh=r(73880);let rx=[],rf=["Contains secret(s)","Contains sensitive information","Company IP","Other"];function rg({value:e,onValueChange:t,readOnly:r}){let[s,a]=(0,f.useState)(""),[n,i]=(0,f.useState)(""),[o,d]=(0,f.useState)(""),c=e||rx,u=e=>{if(c.find(t=>t.oid===e.oid)||""===e.oid)return c;t?.([...c,e])},p=e=>{t?.(c.filter(t=>t.oid!==e.oid))};return(0,l.jsxs)(A,{children:[r?null:(0,l.jsxs)(y.A,{className:"Box-header",sx:{display:"grid",gridTemplateColumns:"2fr 1fr",alignItems:"end"},children:[(0,l.jsxs)(y.A,{sx:{p:1},children:[(0,l.jsx)(Q.A,{as:"h5",sx:{mb:1},children:"Add full or abbreviated commit hash"}),(0,l.jsx)(ts.A,{placeholder:"Commit ID",block:!0,sx:{mt:1},value:s,onChange:e=>a(e.target.value)})]}),(0,l.jsxs)(y.A,{sx:{p:1},children:[(0,l.jsx)(Q.A,{as:"h5",sx:{mb:1},children:"Reason"}),(0,l.jsxs)(y.A,{sx:{display:"grid",gridTemplateColumns:"4fr 1fr",gap:2,alignItems:"center"},children:[(0,l.jsx)("div",{children:(0,l.jsx)(rh.A,{placeholder:"Select reason",value:n,onChange:e=>i(e.target.value),children:rf.map(e=>(0,l.jsx)(rh.A.Option,{value:e,children:e},e))})}),(0,l.jsx)("div",{children:(0,l.jsx)(L.K,{type:"button","aria-label":"Add",size:"medium",icon:O.PlusIcon,onClick:()=>{a(""),d(""),i(""),u({oid:s,reason:"Other"===n?o:n})}})})]})]}),"Other"===n?(0,l.jsx)(y.A,{sx:{gridColumn:"1 / span-2",p:1},children:(0,l.jsx)(ts.A,{className:"width-full",placeholder:"Other reason",value:o,onChange:e=>d(e.target.value)})}):null]}),0===c.length?(0,l.jsx)(v,{heading:"No commit IDs have been added yet",children:r?void 0:"Add a commit ID restriction to prevent specific commits from ever being accepted into target branches"}):(0,l.jsx)("ul",{children:c.map(e=>(0,l.jsxs)("li",{className:"Box-row",children:[(0,l.jsxs)(y.A,{className:"flex-direction-row flex-justify-between",sx:{display:"flex"},children:[(0,l.jsx)("div",{children:(0,l.jsx)(tc.A,{children:e.oid})}),r?null:(0,l.jsx)(L.K,{type:"button","aria-label":"Remove",variant:"invisible",size:"small",icon:O.TrashIcon,onClick:()=>{p(e)}})]}),e.reason&&(0,l.jsx)("div",{children:(0,l.jsx)("p",{children:e.reason})})]},e.oid))})]})}try{rg.displayName||(rg.displayName="RestrictedCommitsList")}catch{}var ry=r(72507);let rj=[];function rv({sourceType:e,value:t,onValueChange:r,readOnly:s,helpUrls:a}){let n=t||rj,{resolvePath:i}=R(),{safeSetTimeout:o}=(0,rs.A)(),d=(0,f.useRef)(void 0),[c,u]=(0,f.useState)(!1),[p,m]=(0,f.useState)(""),[h,x]=(0,f.useState)([]),[g,y]=(0,f.useState)(!1),j=n.reduce((e,t)=>(e[t]=t,e),{}),b=h.map(e=>({id:e,text:e})).filter(e=>!j[e.id]);return(0,f.useEffect)(()=>{async function t(e){x([]);try{if(!p){y(!1);return}y(!0);let t=await (0,Z.DI)(i(`../deployment_environment_suggestions.json?query=${encodeURIComponent(p)}`),{signal:e.signal});if(e.signal.aborted||!t.ok)return;x(await t.json())}finally{y(!1)}}if("organization"===e)return;d.current?.abort();let r=new AbortController;d.current=r,y(!0);let s=o(()=>{t(r)},1e3);return()=>clearTimeout(s)},[p,i,o,e]),(0,l.jsxs)(l.Fragment,{children:[!s&&(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tr.A.Label,{id:"deploymentEnvironmentsLabel",visuallyHidden:!0,children:"Select deployment environments"}),(0,l.jsxs)(ry.A,{children:[(0,l.jsx)(ry.A.Input,{className:"width-full",placeholder:"Search for deployment environments",onChange:e=>m(e.target.value),onFocus:()=>u(!0)}),c&&p&&(0,l.jsx)(ry.A.Overlay,{children:(0,l.jsx)(ry.A.Menu,{"aria-labelledby":"deploymentEnvironmentsLabel",emptyStateText:"No deployment environments found",items:b,selectedItemIds:[],loading:g,onSelectedChange:e=>{Array.isArray(e)&&(m(""),r?.(e.map(e=>e.text).concat(n)))}})})]})]}),n.length?(0,l.jsxs)("div",{className:"Box mt-2",children:[(0,l.jsx)("div",{className:"Box-header",children:(0,l.jsx)("div",{className:"Box-title",children:"Deployment environments that are required."})}),(0,l.jsx)("ul",{children:[...new Set(n)].map(e=>(0,l.jsxs)("li",{className:"Box-row d-flex flex-justify-between flex-items-center",children:[(0,l.jsx)("span",{children:e}),(0,l.jsx)("div",{className:"d-flex flex-items-center",children:!s&&(0,l.jsx)(L.K,{className:"ml-2",type:"button",icon:O.TrashIcon,"aria-label":`Delete ${e}}`,size:"small",variant:"invisible",onClick:()=>r?.(n.filter(t=>t!==e))})})]},e))})]}):(0,l.jsx)(v,{heading:"No deployment environments have been added",children:!s&&a&&(0,l.jsx)(ey.A,{target:"_blank",href:a.deploymentEnvironments,children:"Learn more about deployment environments"})})]})}try{rv.displayName||(rv.displayName="RequiredDeployments")}catch{}function rb({value:e,onValueChange:t,readOnly:r,metadata:s,errors:a,fieldRef:n}){let[i,o]=(0,f.useState)(!1),[d,c]=(0,f.useState)(void 0),u=(0,f.useRef)(void 0),p=(0,f.useMemo)(()=>e||[],[e]),m=(0,f.useMemo)(()=>{let e={};for(let t of a[0]?.sub_errors||[])void 0!==t.repo_and_path&&(u.current=u.current||t.repo_and_path,e[t.repo_and_path]=t);return e},[a]),[h,x]=(0,f.useState)(()=>{let e={};if(s&&s.workflows)for(let t of s.workflows)t.repository&&(e[`${t.repository.id}/${t.path}`]={workflowName:t.name,repository:t.repository});return e}),g=(0,f.useCallback)((e,r)=>{let s;if(!d&&p.some(t=>rN(t,e)))return!1;if(d){let t=p.findIndex(e=>rN(e,d));s=[...p.slice(0,t),e,...p.slice(t+1)]}else s=[...p,e];return r&&x(t=>({...t,[`${e.repository_id}/${e.path}`]:r})),t?.(s),!0},[d,t,p]),y=e=>{c(e),o(!0)},j=e=>{let r=p.filter(t=>t!==e);t?.(r)};return(0,l.jsxs)("div",{className:"d-flex flex-column gap-2",children:[!r&&i?(0,l.jsx)(r_,{existingWorkflow:d?{workflow:d,metadata:h[`${d?.repository_id}/${d?.path}`]}:void 0,onSave:g,onClose:()=>{o(!1),c(void 0)}}):null,(0,l.jsxs)("div",{className:"Box",children:[(0,l.jsxs)("div",{className:"Box-header d-flex flex-items-center",children:[(0,l.jsx)("div",{className:"Box-title flex-1",children:"Workflow configurations"}),!r&&(0,l.jsx)(er.Q,{className:"ml-2",type:"button","aria-label":"Add workflow",size:"small",onClick:()=>o(!0),children:"Add workflow"})]}),p.length?(0,l.jsx)("div",{children:p.map(e=>(0,l.jsxs)("div",{className:"Box-row d-flex flex-justify-between flex-items-center",children:[(0,l.jsxs)("div",{className:"d-flex flex-column",children:[(0,l.jsx)("span",{className:"text-bold",children:h[`${e.repository_id}/${e.path}`]?.workflowName}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"color-fg-muted text-small pr-1",children:`${h[`${e.repository_id}/${e.path}`]?.repository.name||"Unknown repository"}/${e.path}`}),e.sha?(0,l.jsx)(tm,{param:e.sha.slice(0,7)}):e.ref?(0,l.jsx)(tm,{param:e.ref,showIcon:!0}):null]}),m[`${e.repository_id}/${e.path}`]&&(0,l.jsxs)(Q.A,{sx:{display:"flex",alignItems:"center",fontSize:0,color:"danger.fg"},id:`${e.repository_id}/${e.path}-error`,children:[(0,l.jsx)(K.A,{icon:O.AlertFillIcon,size:12}),"\xa0",m[`${e.repository_id}/${e.path}`]?.message]})]}),!r&&(0,l.jsxs)("div",{children:[(0,l.jsx)(L.K,{className:"ml-2",icon:O.PencilIcon,type:"button",ref:`${e.repository_id}/${e.path}`===u.current?n:void 0,"aria-describedby":`${e.repository_id}/${e.path}-error`,"aria-label":`Edit ${e.repository_id}/${e.path} workflow`,"aria-invalid":!!m[`${e.repository_id}/${e.path}`],size:"small",variant:"invisible",onClick:()=>y(e)}),(0,l.jsx)(L.K,{className:"ml-2",icon:O.TrashIcon,type:"button","aria-label":`Delete ${e}}`,size:"small",variant:"invisible",onClick:()=>j(e)})]})]},e.path))}):(0,l.jsx)(v,{heading:"No workflow configurations found"})]})]})}function r_({onSave:e,onClose:t,existingWorkflow:r}){let{resolvePath:s}=R(),[a,n]=(0,f.useState)(()=>r&&r.workflow.sha&&!r.workflow.ref?"sha":"ref"),[i,o]=(0,f.useState)({...r?.workflow}),[d,c]=(0,f.useState)(r?.metadata?.repository),[u]=function(e,t){let{resolvePath:r}=R(),[s,a]=(0,f.useState)(void 0),n=(0,f.useCallback)(async()=>{t&&e&&a((await te(r("../workflows"),e.name,t)).sha)},[r,a,t,e]);return(0,f.useEffect)(()=>{n()},[n,t,e]),[s]}(d,i.ref),p=function(e){let{resolvePath:t}=R(),[r,s]=(0,f.useState)(void 0),a=(0,f.useCallback)(async e=>{try{let r=await e6(t("../workflows"),e);s(r)}catch{s([])}},[t,s]);return(0,f.useEffect)(()=>{e&&a(e.name)},[a,e]),r}(d),[m,h]=(0,f.useState)(!1),[x,g]=(0,f.useState)(!1),{shaValid:y,validateSha:j}=function(e,t){let{resolvePath:r}=R(),[s,a]=(0,f.useState)(void 0);return{shaValid:s,validateSha:async()=>{if(t&&t.length>0&&e){if(40!==t.length){a("invalid");return}try{a("validating");let s=await tt(r("../validate_value/reachable_sha"),{sha:t,repo_id:e.id});a(s.valid?"valid":"invalid")}catch{a("invalid")}}else a(void 0)}}}(d,i.sha),v=(0,f.useCallback)(e=>{e&&(c(e),o({...i,repository_id:e.id,ref:(0,w.D7)(e.defaultBranch,"branch")}),h(!1))},[i]),b=(0,f.useCallback)(async e=>{let t=await e8(s("../workflows"),e);return t?.map(e=>({...e,enabled:e.actionsSharing}))||[]},[s]),_=(0,f.useCallback)(()=>{if(!i.path||!d||!i.sha&&!i.ref){h(!0);return}if(!e(i,{repository:d,workflowName:p?.find(e=>e.path===i.path)?.name})){g(!0);return}t()},[t,e,d,i,p]),A=(0,f.useMemo)(()=>[{content:"Cancel",onClick:t,buttonType:"normal"},{content:"Add workflow",onClick:_,buttonType:"primary"}],[t,_]);return(0,l.jsxs)(tv.l,{title:"Add required workflow",footerButtons:A,height:"auto",width:"medium",onClose:t,children:[(0,l.jsxs)(tr.A,{sx:{paddingBottom:3},required:!0,children:[(0,l.jsx)(tr.A.Label,{children:"Repository"}),(0,l.jsx)(tS.P,{currentSelection:d,repositoryLoader:b,onSelect:v,selectionVariant:"single",selectAllOption:!1,additionalButtonProps:{alignContent:"start",className:"width-full"}}),m&&!d&&(0,l.jsx)(tr.A.Validation,{variant:"error","aria-live":"polite",children:"Please select a repository"})]}),d&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(tr.A,{required:!0,children:[(0,l.jsx)(tr.A.Label,{children:"ref"===a?"Select branch or tag":"Enter a SHA"}),(0,l.jsxs)("div",{className:"d-flex flex-row width-full",children:["ref"===a?(0,l.jsx)(N.PI,{currentCommitish:(0,w.gE)(i.ref)??"Select ref",defaultBranch:d.defaultBranch,owner:d.ownerLogin,repo:d.name,canCreate:!1,cacheKey:d.refCacheKey,selectedRefType:(0,w.MQ)(i.ref),onSelectItem:(e,t)=>o({...i,ref:(0,w.D7)(e,t)}),types:["branch","tag"],buttonClassName:"width-full workflows-wide-selector",hideShowAll:!0}):(0,l.jsx)(ts.A,{className:"width-full",placeholder:"Enter a valid SHA",value:i.sha||"",onBlur:j,onChange:e=>o({...i,sha:e.target.value})}),(0,l.jsx)("div",{className:"pl-2",children:(0,l.jsx)(rA,{selected:a,onSelect:e=>{e!==a&&("sha"===e?o({...i,ref:void 0,sha:void 0}):"ref"===e&&o({...i,ref:(0,w.D7)(d.defaultBranch,"branch"),sha:void 0}),n(e))}})})]}),"sha"===a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tr.A.Caption,{children:"Enter the SHA for the commit you want to reference"}),void 0!==y&&"valid"===y?(0,l.jsx)(tr.A.Validation,{variant:"success","aria-live":"polite",children:"Valid SHA"}):void 0!==y&&"invalid"===y||m&&(!i.sha||0===i.sha.length)?(0,l.jsx)(tr.A.Validation,{variant:"error","aria-live":"polite",children:"Invalid SHA"}):void 0!==y&&"validating"===y?(0,l.jsx)(tr.A.Caption,{"aria-live":"polite",children:"Validating..."}):null]})]}),"ref"===a&&(0,l.jsxs)(tr.A,{sx:{paddingTop:2},children:[(0,l.jsx)(tj.A,{tabIndex:0,checked:"ref"===a&&void 0!==u&&i.sha===u,onChange:e=>{e.target.checked?o({...i,sha:u}):o({...i,sha:void 0})}}),(0,l.jsx)(tr.A.Label,{children:"Pin to commit"}),(0,l.jsxs)(tr.A.Caption,{children:[(0,l.jsx)("span",{children:"Always reference the current commit "}),u&&(0,l.jsx)(tm,{param:u.slice(0,7)})]})]}),(0,l.jsxs)(tr.A,{sx:{width:"100%",paddingTop:3},required:!0,children:[(0,l.jsx)(tr.A.Label,{children:"Pick a workflow file"}),(0,l.jsxs)(ry.A,{children:[(0,l.jsx)(ry.A.Input,{value:i.path,onChange:e=>o({...i,path:e.target.value}),placeholder:"path/workflow.yml",className:"width-full"}),(0,l.jsx)(ry.A.Overlay,{children:(0,l.jsx)(ry.A.Menu,{items:p?.map(e=>({id:e.path,text:e.path}))||[],selectionVariant:"single",onSelectedChange:e=>o({...i,path:Array.isArray(e)?e[0]?.text:e.text}),loading:void 0===p,selectedItemIds:[],"aria-labelledby":"autocompleteLabel-basic"})})]}),m&&!i.path?(0,l.jsx)(tr.A.Validation,{variant:"error","aria-live":"polite",children:"Please select a workflow path"}):x?(0,l.jsx)(tr.A.Validation,{variant:"error","aria-live":"polite",children:"Workflow already exists"}):null]})]})]})}function rA({selected:e,onSelect:t}){return(0,l.jsxs)($.W,{children:[(0,l.jsx)($.W.Anchor,{children:(0,l.jsx)(L.K,{icon:O.KebabHorizontalIcon,"aria-label":"Open additional options"})}),(0,l.jsx)($.W.Overlay,{width:"medium",position:"relative",children:(0,l.jsxs)(X.l,{selectionVariant:"single",children:[(0,l.jsx)(X.l.Item,{selected:"ref"===e,onSelect:()=>t("ref"),children:"Branch or tag"}),(0,l.jsx)(X.l.Item,{selected:"sha"===e,onSelect:()=>t("sha"),children:"SHA"})]})})]})}function rN(e,t){return e.path===t.path&&e.repository_id===t.repository_id}try{rb.displayName||(rb.displayName="Workflows")}catch{}try{r_.displayName||(r_.displayName="WorkflowDialog")}catch{}try{rA.displayName||(rA.displayName="RefOrShaSelector")}catch{}let rw={wildcardPresent:{args:"error",func:e=>"ref_name_wildcard_present"===e.error_code}};function rS({errors:e,errorId:t,errorRef:r,fields:s}){let a=tW({errors:e,fields:s,filters:rw});return a.wildcardPresent&&a.wildcardPresent.length>0?(0,l.jsxs)(tM,{errorId:t,errorRef:r,children:[(0,l.jsx)(O.GitMergeQueueIcon,{}),"Merge queue rules are only supported for named branches or the default branch. Please adjust your branch targets."]}):a.unregistered&&a.unregistered.length>0?(0,l.jsx)(tM,{errorId:t,errorRef:r,children:a.unregistered[0]?.message||"An error occurred"}):null}try{rS.displayName||(rS.displayName="MergeQueueError")}catch{}function rC({value:e,onValueChange:t,readOnly:r,boxName:s,buttonName:a,subtitle:n,label:i,examples:o,blankslate:d,validationError:c=()=>"",prefix:u}){let[p,m]=(0,f.useState)(!1),h=e||[];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(A,{name:s,showHeader:!0,"data-testid":"bypass-panel",renderCreateButton:()=>r?null:(0,l.jsx)("div",{className:"d-flex flex-items-center",children:(0,l.jsxs)(er.Q,{"aria-label":a,onClick:async()=>{m(!p)},children:[(0,l.jsx)(O.PlusIcon,{})," ",a]})}),children:h.length>0?(0,l.jsx)("ul",{children:[...new Set(h)].map(e=>(0,l.jsxs)("li",{className:"Box-row d-flex flex-row flex-items-center px-3 py-2",children:[(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)(y.A,{sx:{mr:1,display:"inline"},children:(0,l.jsx)(y.A,{as:"span",sx:{alignItems:"center",display:"inline-flex",backgroundColor:"neutral.subtle",borderRadius:2,paddingX:2},children:(0,l.jsx)(Q.A,{sx:{fontWeight:"light",fontFamily:"mono"},children:e})})})}),r?null:(0,l.jsx)("div",{children:(0,l.jsx)(L.K,{type:"button","aria-label":`Delete ${e}`,size:"small",variant:"invisible",onClick:()=>!r&&t?.(h.filter(t=>t!==e)),className:"ml-2",icon:O.TrashIcon})})]},e))}):(0,l.jsx)(v,{heading:d})}),!r&&p&&(0,l.jsx)(rI,{onAdd:e=>{t?.(h.concat(e)),m(!1)},onClose:()=>m(!1),buttonName:a,subtitle:n,label:i,examples:o,validationError:c,prefix:u,restrictedList:h})]})}let rI=({onAdd:e,onClose:t,buttonName:r,subtitle:s,label:a,examples:n,validationError:i,prefix:o,restrictedList:d})=>{let c=(0,f.useRef)(null),[u,p]=(0,f.useState)(""),m=e=>{let t=e.trim();if(""===t){let e=`${a} cannot be empty`;return p(e),e}if(i(e))return p(i(e)),i(e);if(d.includes(`${o||""}${t}`)){let e=`${a} has already been added`;return p(e),e}return p(""),""},h=async()=>{let t=c.current.value.trim();m(t)||(e(`${o||""}${t}`),c.current.value="")};return(0,l.jsx)(tv.l,{"aria-label":r,title:r,subtitle:(0,l.jsx)("span",{className:"text-normal text-small color-fg-muted",children:s}),footerButtons:[{content:"Cancel",buttonType:"normal",onClick:t},{content:r,onClick:h,buttonType:"primary"}],onClose:t,width:"medium",children:(0,l.jsxs)(tr.A,{sx:{flex:1,mr:2},children:[(0,l.jsx)(tr.A.Label,{children:(0,l.jsx)("span",{className:"text-bold",children:a})}),(0,l.jsx)(ts.A,{ref:c,className:"width-full",onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),h())},onBlur:e=>m(e.target.value),onChange:()=>{u&&p("")},leadingVisual:o}),(0,l.jsx)(tr.A.Caption,{children:n}),u&&(0,l.jsx)(tr.A.Validation,{variant:"error",children:u})]})})};try{rC.displayName||(rC.displayName="RestrictHelper")}catch{}try{rI.displayName||(rI.displayName="RestrictHelperDialog")}catch{}function rR({value:e,onValueChange:t,readOnly:r}){return(0,l.jsx)(rC,{value:e,onValueChange:t,readOnly:r,boxName:"Restricted file extensions",buttonName:"Add file extension",subtitle:"Commits that include files with the specified file extension will be rejected.",label:"File extension",examples:"Examples: `bin`, `exe`",blankslate:"No file extensions",validationError:e=>e.includes("\\")||e.includes("/")||e.includes("*")?"File extension cannot contain \\, /, or *":"",prefix:"*."})}try{rR.displayName||(rR.displayName="FileExtensionRestrictions")}catch{}function rk({value:e,onValueChange:t,readOnly:r}){return(0,l.jsx)(rC,{value:e,onValueChange:t,readOnly:r,boxName:"Restricted file paths",buttonName:"Add file path",subtitle:"Commits that include changes to files in the specified file path will be rejected.",label:"File path",examples:"Example: `.github/**/*`",blankslate:"No file paths"})}try{rk.displayName||(rk.displayName="FilePathRestrictions")}catch{}function rT(e){if(void 0===e)return;let[t,r]=e.split("..").map(e=>parseInt(e));return(void 0===t||isNaN(t))&&(t=void 0),(void 0===r||isNaN(r))&&(r=void 0),{min:t,max:r}}function rE({field:e,value:t,onValueChange:r,readOnly:s,label:a,description:n,fieldRef:i,errors:o}){if("integer"!==e.type)throw Error("Field type must be integer");let d=(0,f.useMemo)(()=>({empty:`${a} cannot be empty`,notInteger:`${a} must be a whole number`}),[a]),[c,u]=(0,f.useState)("");(0,f.useEffect)(()=>{let e=o[0]?.message;if(e?.includes("to be present")){u(d.empty);return}if(e?.includes("Expected integer")){u(d.notInteger);return}u(o[0]?.message||"")},[o[0]?.message]);let p=(0,f.useCallback)(e=>{if(u(""),!e||""===e.trim()){u(d.empty);return}let t=parseFloat(e);if(isNaN(t)||!Number.isInteger(t)){u(d.notInteger);return}},[d]);return(0,l.jsx)(A,{className:"p-3",children:s?(0,l.jsxs)("div",{children:[(0,l.jsxs)("span",{className:"text-bold",children:[a,": "]}),(0,l.jsx)("span",{children:t})]}):(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tr.A.Label,{children:a}),n&&(0,l.jsx)(tr.A.Caption,{children:n}),(0,l.jsx)(ts.A,{className:"width-full",type:"number",ref:i,min:rT(e.allowed_range)?.min,max:rT(e.allowed_range)?.max,value:t,onBlur:e=>{p(e.target.value)},onChange:e=>{p(e.target.value),r?.(parseFloat(e.target.value))}}),c&&(0,l.jsx)(tr.A.Validation,{variant:"error",children:c})]})})}try{rE.displayName||(rE.displayName="MaxHelper")}catch{}function rO({field:e,value:t,onValueChange:r,readOnly:s,fieldRef:a,errors:n}){return(0,l.jsx)(rE,{field:e,value:t,onValueChange:r,label:"Maximum file path length",readOnly:s,errors:n,fieldRef:a})}try{rO.displayName||(rO.displayName="MaxFilePathLength")}catch{}function r$({field:e,value:t,onValueChange:r,readOnly:s,fieldRef:a,errors:n}){return(0,l.jsx)(rE,{field:e,value:t,onValueChange:r,label:"Maximum file size (MB)",description:"This limit does not apply to Git Large File Storage (Git LFS).",readOnly:s,errors:n,fieldRef:a})}try{r$.displayName||(r$.displayName="MaxFileSize")}catch{}function rL(e){let{field:t,value:r,sourceType:s,onValueChange:a,helpUrls:n,readOnly:i}=e;if("array"!==t.type)return(0,l.jsx)(l.Fragment,{});let o=r||t.default_value,d=t.content_object.fields.filter(e=>"string"===e.type&&"tool"!==e.name);if(0===d.length)return(0,l.jsx)(l.Fragment,{});let c=o.reduce((e,t)=>(e[t.tool]=t,e),{}),u=d.reduce((e,t)=>(e[t.name]=t.default_value,e),{});return(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tr.A.Label,{visuallyHidden:!0,children:t.display_name}),(0,l.jsxs)(tr.A.Caption,{children:[t.description," ",n&&(0,l.jsx)(ey.A,{target:"_blank",href:n.codeScanning,sx:{textDecoration:"underline"},children:"Learn more about enabling code scanning."})]}),(0,l.jsxs)("div",{className:"Box width-full",children:[(0,l.jsx)("div",{className:"Box-header",children:(0,l.jsxs)("div",{className:"Box-title d-flex flex-justify-between flex-items-center",children:[(0,l.jsx)("span",{className:"flex-1",children:"Required tools and alert thresholds"})," ",!i&&(0,l.jsx)(rz,{sourceType:s,value:o.map(e=>e.tool),onValueChange:e=>a?.(e.map(e=>({...u,...c[e],tool:e})))})]})}),0===o.length?(0,l.jsxs)(j.A,{children:[(0,l.jsx)(j.A.Heading,{as:"h3",children:"No code scanning tools specified"}),!i&&n&&(0,l.jsx)(j.A.Description,{children:(0,l.jsx)(ey.A,{target:"_blank",href:n.statusChecks,children:"Learn more about code scanning thresholds"})})]}):(0,l.jsx)("ul",{children:o.map((e,t)=>(0,l.jsxs)(y.A,{as:"li","data-testid":`li-${e.tool}`,sx:{columnGap:1},className:"Box-row d-flex flex-justify-between flex-items-baseline width-full flex-wrap",children:[(0,l.jsx)("span",{className:"flex-1",children:e.tool}),(0,l.jsx)(y.A,{sx:{columnGap:1},className:"d-inline-flex flex-justify-between flex-items-baseline flex-wrap",children:d.map(t=>(0,l.jsx)(rB,{role:t.name,readOnly:i,value:e[t.name]||t.default_value,allowedOptions:t.allowed_options,onValueChange:r=>{a?.(o.map(s=>({...s,[t.name]:s.tool===e.tool?r:s[t.name]})))},ariaLabel:t.description,label:t.display_name},t.name))}),!i&&(0,l.jsx)(L.K,{className:"d-inline-block","data-testid":"delete-tool-button",icon:O.TrashIcon,type:"button","aria-label":"Delete Tool",size:"small",variant:"invisible",onClick:()=>a?.(o.filter(({tool:t})=>t!==e.tool))})]},t))})]})]})}function rB({label:e,allowedOptions:t,readOnly:r,value:s,onValueChange:a,ariaLabel:n,role:i}){let o=t.reduce((e,t)=>t.value===s?t.display_name:e,void 0);return r?(0,l.jsxs)(T.A,{children:[(0,l.jsxs)(y.A,{sx:{mr:1,color:"fg.muted",display:"inline-block"},children:[e,":"]}),(0,l.jsx)("span",{"data-testid":`${i}-value`,children:o})]}):(0,l.jsxs)($.W,{children:[(0,l.jsxs)($.W.Button,{variant:"invisible","aria-label":n,"data-testid":`${i}-button`,children:[(0,l.jsxs)(y.A,{sx:{color:"fg.muted",display:"inline-block"},children:[e.replace(/ threshold$/,""),":"]})," ",(0,l.jsx)("span",{"data-testid":`${i}-value`,children:o})]}),(0,l.jsx)($.W.Overlay,{align:"end",width:"small",children:(0,l.jsx)(X.l,{selectionVariant:"single",children:t.map(e=>(0,l.jsx)(X.l.Item,{selected:e.value===s,onSelect:()=>a?.(e.value),children:e.display_name},e.value))})})]})}function rz({value:e,sourceType:t,onValueChange:r}){let[s,a]=(0,f.useState)(""),{suggestions:n,loading:i}=function(e){let{resolvePath:t}=R(),{safeSetTimeout:r}=(0,rs.A)(),s=(0,f.useRef)(void 0),[a,n]=(0,f.useState)([]),[l,i]=(0,f.useState)(!1);return(0,f.useEffect)(()=>{async function a(r){n([]);try{i(!0);let s="repository"===e?t("../../../security/code-scanning/tools.json"):t("../../../security/alerts/code-scanning/tool-list.json").replace(RegExp("^/organizations/"),"/orgs/"),a=await (0,Z.lS)(s,{signal:r.signal});if(r.signal.aborted||!a.ok)return;let l=await a.json();n(l.map(({value:e})=>e.startsWith('"')&&e.endsWith('"')?e.slice(1,e.length-1).replaceAll('\\"','"'):e))}finally{i(!1)}}s.current?.abort();let l=new AbortController;s.current=l,i(!0);let o=r(()=>{a(l)},1e3);return()=>clearTimeout(o)},[t,r,e]),{suggestions:a,loading:l}}(t),o=[...new Set(["CodeQL",...n,...e])].filter(e=>e.toLowerCase().startsWith(s.toLowerCase())),d=o.map(e=>({text:e,id:e})),c=e.filter(e=>!o.includes(e)).map(e=>({text:e,id:e}));s.length>0&&!o.includes(s)&&d.push({text:s,id:s,leadingVisual:O.PlusIcon});let u=d.filter(t=>e.includes(t.id)),[p,m]=(0,f.useState)(!1);return(0,l.jsx)(tQ.X,{loading:i,title:"Tool name",renderAnchor:({"aria-labelledby":e,...t})=>(0,l.jsx)(er.Q,{leadingVisual:O.PlusIcon,trailingVisual:O.TriangleDownIcon,"aria-haspopup":"dialog","aria-labelledby":` ${e}`,...t,children:"Add tool"}),placeholderText:"Enter the name of a code scanning tool",open:p,onOpenChange:e=>{m(e),e||a("")},items:d,selected:u,onSelectedChange:e=>{if(Array.isArray(e)){let t=[...e,...c];r?.(t.map(e=>e.text).sort())}},filterValue:s,onFilterChange:a,overlayProps:{width:"medium",height:"xsmall"}})}try{rL.displayName||(rL.displayName="CodeScanningTools")}catch{}try{rB.displayName||(rB.displayName="ThresholdDropDown")}catch{}try{rz.displayName||(rz.displayName="ToolPicker")}catch{}let rP={unexpectedType:{args:"error",func:e=>{for(let t of e.sub_errors)if("required_status_checks"===e.field&&"unexpected_type"===t.error_code&&"Expected array, got NilClass"===t.message)return!0;return!1}}};function rD({errors:e,errorId:t,errorRef:r,fields:s}){let a;let n=tW({errors:e,fields:s,filters:rP});return(n.unexpectedType&&n.unexpectedType.length>0?a="Required status checks cannot be empty. Please add at least one status check or disable the rule.":n.unregistered&&n.unregistered.length>0&&(a=n.unregistered[0]?.message||"An error occurred"),a)?(0,l.jsx)(tM,{errorId:t,errorRef:r,children:a}):null}try{rD.displayName||(rD.displayName="RequiredStatusChecksError")}catch{}let rF={unexpectedType:{args:"error",func:e=>{for(let t of e.sub_errors)if("required_deployment_environments"===e.field&&"unexpected_type"===t.error_code&&"Expected array, got NilClass"===t.message)return!0;return!1}}};function rM({errors:e,errorId:t,errorRef:r,fields:s}){let a;let n=tW({errors:e,fields:s,filters:rF});return n.unexpectedType&&n.unexpectedType.length>0?a="Required deployments cannot be empty. Please add at least one deployment or disable the rule.":n.unregistered&&n.unregistered.length>0&&(a=n.unregistered[0]?.message||"An error occurred"),a&&(0,l.jsx)(tM,{errorId:t,errorRef:r,children:a})||null}try{rM.displayName||(rM.displayName="RequiredDeploymentsError")}catch{}let rV={maxFileSize:{args:"error",func:e=>"max_file_size"===e.field}},rW=({errors:e,errorId:t,errorRef:r,fields:s})=>{let a=tW({errors:e,fields:s,filters:rV});return a.unregistered&&a.unregistered.length>0?(0,l.jsx)(tM,{errorId:t,errorRef:r,children:a.unregistered[0]?.message||"An error occurred"}):null};try{rW.displayName||(rW.displayName="MaxFileSizeError")}catch{}let rU={maxFilePath:{args:"error",func:e=>"max_file_path_length"===e.field}},rG=({errors:e,errorId:t,errorRef:r,fields:s})=>{let a=tW({errors:e,fields:s,filters:rU});return a.unregistered&&a.unregistered.length>0?(0,l.jsx)(tM,{errorId:t,errorRef:r,children:a.unregistered[0]?.message||"An error occurred"}):null};try{rG.displayName||(rG.displayName="MaxFilePathError")}catch{}let rH={unexpectedType:{args:"error",func:e=>{for(let t of e.sub_errors)if("restricted_file_paths"===e.field&&"unexpected_type"===t.error_code&&"Expected array, got NilClass"===t.message)return!0;return!1}}},rq=({errors:e,errorId:t,errorRef:r,fields:s})=>{let a;let n=tW({errors:e,fields:s,filters:rH});return n.unexpectedType&&n.unexpectedType.length>0?a="Restricted file paths cannot be empty. Please add at least one restricted file path or disable the rule.":n.unregistered&&n.unregistered.length>0&&(a=n.unregistered[0]?.message||"An error occurred"),a&&(0,l.jsx)(tM,{errorId:t,errorRef:r,children:a})||null};try{rq.displayName||(rq.displayName="FilePathRestrictionsError")}catch{}let rK={unexpectedType:{args:"error",func:e=>{for(let t of e.sub_errors)if("restricted_file_extensions"===e.field&&"unexpected_type"===t.error_code&&"Expected array, got NilClass"===t.message)return!0;return!1}}},rQ=({errors:e,errorId:t,errorRef:r,fields:s})=>{let a;let n=tW({errors:e,fields:s,filters:rK});return n.unexpectedType&&n.unexpectedType.length>0?a="Restricted file extensions cannot be empty. Please add at least one restricted file extension or disable the rule.":n.unregistered&&n.unregistered.length>0&&(a=n.unregistered[0]?.message||"An error occurred"),a?(0,l.jsx)(tM,{errorId:t,errorRef:r,children:a}):null};try{rQ.displayName||(rQ.displayName="FileExtensionRestrictionsError")}catch{}let rJ={missing:{args:"error",func:e=>{for(let t of e.sub_errors)if("code_scanning_tools"===e.field&&"missing"===t.error_code)return!0;return!1}}},rY=({errors:e,errorId:t,errorRef:r,fields:s})=>{let a;let n=tW({errors:e,fields:s,filters:rJ});return n.missing&&n.missing.length>0?a=n.missing[0]?.sub_errors?.[0]?.message||"Please select at least one code scanning tool":n.unregistered&&n.unregistered.length>0&&(a=n.unregistered[0]?.message||"An error occurred"),a?(0,l.jsx)(tM,{errorId:t,errorRef:r,children:a}):null};try{rY.displayName||(rY.displayName="CodeScanningToolsError")}catch{}let rX={unexpectedType:{args:"error",func:e=>{for(let t of e.sub_errors)if("workflows"===e.field&&"unexpected_type"===t.error_code&&"Expected array, got NilClass"===t.message)return!0;return!1}},handledByFormControl:{args:"error",func:e=>{for(let t of e.sub_errors)if("workflows"===e.field&&void 0!==t.repo_and_path)return!0;return!1}}};function rZ({errors:e,errorId:t,errorRef:r,fields:s}){let a;let n=tW({errors:e,fields:s,filters:rX});return(n.unexpectedType&&n.unexpectedType.length>0?a="Workflows cannot be empty. Please add at least one workflow or disable the rule.":n.unregistered&&n.unregistered.length>0&&(a=n.unregistered[0]?.message||"An error occurred"),a)?(0,l.jsx)(tM,{errorId:t,errorRef:r,children:a}):null}try{rZ.displayName||(rZ.displayName="WorkflowsError")}catch{}let r0={restricted_commits:e=>(0,l.jsx)(rg,{...e}),required_status_checks:e=>(0,l.jsx)(ri,{...e}),required_deployments:e=>(0,l.jsx)(rv,{...e}),workflows:e=>(0,l.jsx)(rb,{...e}),merge_queue_grouping_strategy:e=>(0,l.jsx)(t8,{...e}),merge_queue_merge_method:e=>(0,l.jsx)(rr,{...e}),file_path_restriction:e=>(0,l.jsx)(rk,{...e}),file_extension_restriction:e=>(0,l.jsx)(rR,{...e}),max_file_path_length:e=>(0,l.jsx)(rO,{...e}),max_file_size:e=>(0,l.jsx)(r$,{...e}),code_scanning_tools:e=>(0,l.jsx)(rL,{...e})},r1={merge_queue:e=>(0,l.jsx)(f.Suspense,{children:(0,l.jsx)(rS,{...e})}),code_scanning:e=>(0,l.jsx)(f.Suspense,{children:(0,l.jsx)(rY,{...e})}),workflows:e=>(0,l.jsx)(f.Suspense,{children:(0,l.jsx)(rZ,{...e})}),required_status_checks:e=>(0,l.jsx)(f.Suspense,{children:(0,l.jsx)(rD,{...e})}),required_deployments:e=>(0,l.jsx)(f.Suspense,{children:(0,l.jsx)(rM,{...e})}),max_file_size:e=>(0,l.jsx)(f.Suspense,{children:(0,l.jsx)(rW,{...e})}),max_file_path_length:e=>(0,l.jsx)(f.Suspense,{children:(0,l.jsx)(rG,{...e})}),file_path_restriction:e=>(0,l.jsx)(f.Suspense,{children:(0,l.jsx)(rq,{...e})}),file_extension_restriction:e=>(0,l.jsx)(f.Suspense,{children:(0,l.jsx)(rQ,{...e})}),required_depoyments:e=>(0,l.jsx)(f.Suspense,{children:(0,l.jsx)(rM,{...e})})},r2={merge_queue_grouping_strategy:(e,t)=>(function({value:e,readonly:t}){return!t||"ALLGREEN"===e})({value:e,readonly:t})},r3=({errors:e,errorId:t,errorRef:r,fields:s})=>{let a=tW({errors:e,fields:s});return a.unregistered&&a.unregistered.length>0?(0,l.jsx)(tM,{errorId:t,errorRef:r,children:a.unregistered[0]?.message||"An error occurred"}):null};try{r3.displayName||(r3.displayName="RulesetError")}catch{}let r5=({readOnly:e,rulesetId:t,sourceType:r,rule:s,ruleSchema:a,errors:n,errorRef:i,fieldRefs:o,helpUrls:d,onAdd:c,onUpdateParameters:u,onRemove:p})=>{let[m,h]=(0,f.useState)(!1),x=s?.ruleType&&n.length>0?r1[s.ruleType]||(e=>(0,l.jsx)(r3,{...e})):void 0,g=e?a.parameterSchema.fields.filter(t=>(t.ui_control&&r2[t.ui_control]?.(s?.parameters[t.name],e))??("boolean"!==t.type||s?.parameters[t.name]===!0)):a.parameterSchema.fields,j=a.parameterSchema.ui_options?.hide_settings_container||!1,v=(0,f.useMemo)(()=>0!==n.length&&void 0!==s,[n.length,s]);return(0,l.jsxs)("div",{className:"d-flex flex-1 flex-column",children:[e?(0,l.jsxs)("div",{children:[a.beta?(0,l.jsxs)("span",{className:"d-flex flex-items-center text-bold",children:[a.displayName,(0,l.jsx)(T.A,{variant:"success",sx:{marginLeft:2},children:"Beta"})]}):(0,l.jsx)("span",{className:"text-bold",children:a.displayName}),(0,l.jsx)("span",{className:"d-block text-small color-fg-muted",children:a.description})]}):(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tj.A,{checked:void 0!==s,"aria-errormessage":`${s?.ruleType}-error`,"aria-invalid":v&&!!x,onChange:e=>{e.target.checked?(h(!0),c()):p()}}),a.beta?(0,l.jsxs)(tr.A.Label,{sx:{display:"flex",justifyContent:"center"},children:[a.displayName,(0,l.jsx)(T.A,{variant:"success",sx:{marginLeft:2},children:"Beta"})]}):(0,l.jsx)(tr.A.Label,{children:a.displayName}),(0,l.jsx)(tr.A.Caption,{children:a.description})]}),v&&x?(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)(y.A,{sx:{pl:2},children:(0,l.jsx)(y.A,{sx:{px:3},children:(0,l.jsx)(x,{errorId:`${s?.ruleType}-error`,rulesetId:t,errors:n,sourceType:r,errorRef:i,fields:g})})})}):null,s&&g.length>0&&(0,l.jsx)(l.Fragment,{children:j?(0,l.jsx)("div",{className:"flex-1 mt-2",children:(0,l.jsx)(y.A,{sx:{pl:`${e?"-2px":"2"}`},children:(0,l.jsx)(r4,{readOnly:e,rulesetId:t,sourceType:r,helpUrls:d,fields:g,fieldRefs:o,errors:n||[],parameters:s.parameters,metadata:s.metadata,onParametersChange:u})})}):(0,l.jsxs)("div",{className:"flex-1 mt-2",children:[(0,l.jsx)(y.A,{sx:{pl:`${e?"0":"12px"}`},children:(0,l.jsxs)(er.Q,{variant:"invisible",sx:{color:"fg.subtle"},onClick:()=>h(e=>!e),children:[(0,l.jsx)(Q.A,{sx:{mr:1},children:m?"Hide additional settings":"Show additional settings"}),m?(0,l.jsx)(O.ChevronUpIcon,{}):(0,l.jsx)(O.ChevronDownIcon,{})]})}),m&&(0,l.jsx)(y.A,{sx:{pl:`${e?"-2px":"10px"}`},children:(0,l.jsx)(r4,{readOnly:e,rulesetId:t,sourceType:r,helpUrls:d,fields:g,errors:n||[],fieldRefs:o,parameters:s.parameters,metadata:s.metadata,onParametersChange:u})})]})})]})};function r9({ariaLabel:e,selectedValue:t,options:r,onSelect:s}){return(0,l.jsxs)($.W,{children:[(0,l.jsx)($.W.Button,{"aria-label":e,children:r.find(e=>e.value===t)?.label||""}),(0,l.jsx)($.W.Overlay,{width:"small",children:(0,l.jsx)(X.l,{selectionVariant:"single",children:r.map(e=>(0,l.jsx)(X.l.Item,{selected:e.value===t,onSelect:()=>{s(e.value)},children:e.label},e.value))})})]})}let r4=({readOnly:e,rulesetId:t,sourceType:r,fields:s,errors:a,fieldRefs:n,parameters:i,metadata:o,helpUrls:d,onParametersChange:c})=>(0,l.jsx)("ul",{children:s.map(s=>{let u=null,p=a.filter(e=>e.field===s.name);if(s.ui_control){let a=r0[s.ui_control];if(!a)throw Error(`Unsupported control: ${s.ui_control}`);u=(0,l.jsx)(a,{readOnly:e,rulesetId:t,sourceType:r,helpUrls:d,field:s,fieldRef:n?.[s.name],value:i[s.name],metadata:o,errors:p,onValueChange:e=>c({...i,[s.name]:e})})}else switch(s.type){case"array":case"object":throw Error(`Field type requires custom control: ${JSON.stringify(s)}`);case"boolean":{let t=`${s.name}Label`;u=e?(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-bold",children:s.display_name}),(0,l.jsx)("span",{className:"d-block text-small color-fg-muted",children:s.description})]}):(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tj.A,{checked:i[s.name]||!1,onChange:e=>{c({...i,[s.name]:e.target.checked})}}),(0,l.jsx)(tr.A.Label,{id:t,children:s.display_name}),(0,l.jsx)(tr.A.Caption,{children:s.description})]});break}default:u=e?(0,l.jsxs)("div",{children:[(0,l.jsxs)("span",{className:"text-bold",children:[s.display_name,": "]}),(0,l.jsx)("span",{children:i[s.name]}),(0,l.jsx)("span",{className:"d-block text-small color-fg-muted",children:s.description})]}):(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tr.A.Label,{children:s.display_name}),(0,l.jsx)(tr.A.Caption,{children:s.description}),"integer"===s.type?s.allowed_range&&function(e){return"integer"===e.type&&void 0!==rT(e.allowed_range)&&(void 0===e.ui_prefer_dropdown||e.ui_prefer_dropdown)}(s)?(0,l.jsx)(r9,{ariaLabel:"Select number",selectedValue:i[s.name]||0,options:(function(e){let t=rT(e);if(!t)throw Error("Invalid range");let{min:r,max:s}=t;if(void 0===r||void 0===s)throw Error("Invalid range");return Array.from({length:s-r+1},(e,t)=>r+t)})(s.allowed_range).map(e=>({label:e.toString(),value:e})),onSelect:e=>{c({...i,[s.name]:e})}}):(0,l.jsx)(ts.A,{className:"width-full",type:"number",ref:n?.[s.name],min:rT(s.allowed_range)?.min,max:rT(s.allowed_range)?.max,"aria-invalid":p.length>0,value:i[s.name]||0,onChange:e=>{c({...i,[s.name]:parseInt(e.target.value)})}}):s.allowed_options?(0,l.jsx)(r9,{ariaLabel:`Select ${s.display_name}`,selectedValue:i[s.name]||s.default_value||s.allowed_options[0]?.value,options:s.allowed_options.map(e=>({label:e.display_name,value:e.value})),onSelect:e=>{c({...i,[s.name]:e})}}):s.allowed_values?(0,l.jsx)(r9,{ariaLabel:`Select ${s.display_name}`,selectedValue:i[s.name]||s.default_value||s.allowed_values[0],options:s.allowed_values.map(e=>({label:e,value:e})),onSelect:e=>{c({...i,[s.name]:e})}}):(0,l.jsx)(ts.A,{className:"width-full",type:"text","aria-invalid":p.length>0,ref:n?.[s.name],value:i[s.name]||"",onChange:e=>{c({...i,[s.name]:e.target.value})}}),p.length>0&&(0,l.jsx)(tr.A.Validation,{variant:"error",children:p[0]?.message})]})}return(0,l.jsx)("li",{className:"px-3 py-2 d-flex flex-column",children:u},s.name)})});try{r5.displayName||(r5.displayName="RuleRow")}catch{}try{r9.displayName||(r9.displayName="AdditionalSettingsDropdownMenu")}catch{}try{r4.displayName||(r4.displayName="AdditionalSettings")}catch{}function r7(e,t,r=!1){if(!t.metadataPatternSchema?.propertyDescription)return;let s=t.metadataPatternSchema?.supportedOperators?.find(t=>t.type===e.parameters.operator)?.displayName;if(s)return`${t.metadataPatternSchema.propertyDescription} must${e.parameters.negate?" not ":" "}${s}${r?` ${e.parameters.pattern||""}`:""}`}!function(e){e.ADDED="New",e.MODIFIED="Edited",e.REMOVED="Removed"}(n||(n={}));let r6=e=>e.id||void 0!==e.parameters.max_ref_updates?e._enabled?"Edited":"Removed":"New";var r8=r(37885);let se=({rule:e,ruleSchema:t,availableMetadataRuleSchemas:r,removeRule:s,updateRuleParameters:n,setRuleModalState:i,returnFocusRef:o})=>{let[d,c]=(0,f.useState)(e.parameters),u=(0,r8.f)(),[p,m]=(0,f.useState)({isValid:!1,touched:!1}),h=!p.isValid&&p.touched,{source:x,sourceType:j}=(0,g.B)(),v=e._modalState===a.CREATING||e._modalState===a.EDITING,b=e._modalState===a.EDITING?r.concat(t):r,_=()=>{e._modalState===a.CREATING&&s(e),i(e,a.CLOSED),c(e.parameters)},A=async()=>{if(!u.isValid||!p.isValid){let e=d.pattern??"",t=!1;if(""===e.trim()&&(m({isValid:!1,touched:!0}),t=!0),await u.validate(e)||(t=!0),t)return}n(e,d),i(e,a.CLOSED)};if(!v)return null;let N=`${e._modalState===a.CREATING?"Add":"Edit"} a metadata restriction`,w="Restrict commit author email addresses, committer email addresses, commit message content, and other metadata";e._modalState===a.CREATING&&0===r.length&&(N="All metadata restrictions have been used",w=null);let S=e._modalState===a.CREATING&&0===r.length?[{content:"Ok",onClick:_,buttonType:"normal"}]:[{content:"Cancel",onClick:_,buttonType:"normal"},{content:`${e._modalState===a.CREATING?"Add":"Update"}`,onClick:A,buttonType:"primary"}];return(0,l.jsx)(y.A,{sx:{display:"absolute"},children:(0,l.jsx)(tv.l,{title:N,subtitle:w,footerButtons:S,height:"auto",width:"xlarge",onClose:_,returnFocusRef:o,children:b.length?(0,l.jsxs)("div",{className:"d-flex flex-column gap-3",children:[(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tr.A.Label,{children:"Applies to"}),(0,l.jsx)(rh.A,{block:!0,value:e.ruleType,"aria-label":"Property",onChange:t=>{n({...e,ruleType:t.target.value},d)},children:b.map(e=>(0,l.jsx)(rh.A.Option,{value:e.type,children:e.metadataPatternSchema?.propertyDescription},e.type))})]}),(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tr.A.Label,{children:"Requirement"}),(0,l.jsxs)(rh.A,{block:!0,value:d.operator+(d.negate?":negate":""),"aria-label":"Operator",onChange:e=>{let[t,r]=e.target.value.split(":"),s=d.pattern??"";"regex"===t?u.validate(s):d.operator&&u.reset(!0),h&&m({isValid:""!==s.trim(),touched:!0}),c(e=>({...e,operator:t,negate:"negate"===r}))},children:[t.metadataPatternSchema?.supportedOperators?.map(e=>l.jsxs(rh.A.Option,{value:e.type,children:["Must ",e.displayName]},e.type)),t.metadataPatternSchema?.supportedOperators?.map(e=>l.jsxs(rh.A.Option,{value:`${e.type}:negate`,children:["Must not ",e.displayName]},`${e.type}:true`))]})]}),(0,l.jsxs)(tr.A,{required:!0,children:[u.showError?(0,l.jsx)(tr.A.Validation,{variant:"error","aria-live":"polite",children:"Invalid pattern"}):null,h?(0,l.jsx)(tr.A.Validation,{variant:"error","aria-live":"polite",children:"Pattern cannot be empty"}):null,(0,l.jsx)(tr.A.Label,{children:"Matching pattern"}),(0,l.jsx)(ts.A,{block:!0,value:d.pattern,onChange:e=>{c({...d,pattern:e.target.value}),u.reset(),m({isValid:!1,touched:!1})},onBlur:()=>{let e=d.pattern??"";"regex"===d.operator?u.validate(e):d.operator&&u.reset(!0),m({isValid:""!==e.trim(),touched:!0})}})]}),(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tr.A.Label,{children:"Description"}),(0,l.jsx)(ts.A,{block:!0,value:d.name,onChange:e=>c({...d,name:e.target.value}),placeholder:r7({...e,parameters:d},t,!0)}),(0,l.jsxs)(tr.A.Caption,{children:["How this rule will appear to your ",j,"'s users throughout ",x.name,"."]})]})]}):"This ruleset uses all metadata restriction types. You can edit the existing restrictions or remove them to add new ones."})})};try{se.displayName||(se.displayName="AddMetadataPatternRuleDialog")}catch{}var st=r(36861);let sr=({rule:e,ruleSchema:t,readOnly:r,removeRule:s,restoreRule:n,setRuleModalState:i})=>{let{pattern:o}=e.parameters,d=e.parameters.name;return d||(d=r7(e,t)),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(y.A,{sx:{display:"flex",alignItems:"center",flex:1,maxWidth:"calc(100% - 120px)",overflowX:"hidden",mr:2},children:(0,l.jsx)(y.A,{sx:{maxWidth:"100%"},children:(0,l.jsxs)(Q.A,{as:"label",sx:{display:"flex",flexDirection:"row",flexWrap:"wrap"},children:[(0,l.jsx)(y.A,{as:"span",sx:{mr:1},children:d}),(0,l.jsx)(tu.A,{title:o,sx:{maxWidth:200,color:"accent.fg",px:1,whiteSpace:"nowrap",backgroundColor:"accent.subtle",borderRadius:2},children:(0,l.jsx)(Q.A,{sx:{overflowX:"hidden",textOverflow:"ellipsis"},children:o})})]})})}),r?null:(0,l.jsx)(y.A,{sx:{display:"flex",alignItems:"center"},children:e._enabled?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(L.K,{type:"button",icon:O.PencilIcon,"aria-label":"Edit this metadata rule",size:"small",variant:"invisible",onClick:()=>{i(e,a.EDITING)},sx:{display:"flex",alignItems:"center"}}),(0,l.jsx)(L.K,{sx:{ml:1,display:"flex",alignItems:"center"},icon:O.TrashIcon,type:"button",size:"small",variant:"invisible",onClick:()=>s(e),"aria-label":"Delete this metadata rule"})]}):(0,l.jsx)(L.K,{type:"button",icon:O.ReplyIcon,"aria-label":"Restore this metadata rule",size:"small",variant:"invisible",onClick:()=>n(e),sx:{display:"flex",alignItems:"center"}})})]})};try{sr.displayName||(sr.displayName="MetadataPatternRuleRow")}catch{}let ss=({readOnly:e,upsellInfo:t,helpUrl:r,title:s,rules:a,removeRule:n,restoreRule:i,setRuleModalState:o})=>a.length?(0,l.jsxs)("ul",{children:[t.enterpriseRulesets.cta.visible&&(0,l.jsxs)("li",{className:"Box-row d-flex flex-items-center",children:[(0,l.jsx)(K.A,{className:"color-fg-accent",icon:O.RepoLockedIcon,size:54}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsxs)("h2",{className:"f4",children:[s," restrictions are available to Enterprise organizations"]}),(0,l.jsxs)("p",{className:"color-fg-muted",children:[s," restrictions can ensure that commit messages contain a GitHub issue number, or enforce the format of new branch and tag names."]}),t?.enterpriseRulesets.cta.path&&(0,l.jsx)(eg.z,{href:t?.enterpriseRulesets.cta.path,variant:"primary",children:"Upgrade"})]})]}),a.map(t=>(0,l.jsx)("li",{className:"Box-row d-flex flex-row flex-justify-between",children:(0,l.jsx)(sr,{readOnly:e,rule:t,ruleSchema:t.schema,removeRule:n,restoreRule:i,setRuleModalState:o})},t.id||t._id))]}):(0,l.jsx)(v,{heading:`No ${s.toLocaleLowerCase()} restrictions have been added`,children:!e&&r&&(0,l.jsxs)(ey.A,{target:"_blank",href:r,children:["Learn more about ",s.toLocaleLowerCase()," restrictions"]})});try{ss.displayName||(ss.displayName="RulesList")}catch{}let sa=({readOnly:e,upsellInfo:t,helpUrl:r,title:s,rules:a,availableRuleSchemas:n,removeRule:i,restoreRule:o,setRuleModalState:d,addRule:c,metadataPatternRuleSchemas:u,setMetadataRestrictionTypes:p,rulesetTarget:m,sourceType:h,ruleErrors:x,errorRefs:f,addRestrictionButtonRef:g})=>{let j=(0,l.jsxs)(tN.A,{sx:{mb:0,pb:2,fontSize:3,fontWeight:"normal",display:"flex",alignItems:"center"},children:["Restrictions",t.enterpriseRulesets.cta.visible&&(0,l.jsx)(T.A,{variant:"attention",size:"large",sx:{ml:1},children:"Enterprise"})]}),b=[{metadataRestrictionTypes:["commit_message_pattern","commit_author_email_pattern","committer_email_pattern"],label:"Restrict commit metadata",caption:"Restrict commit author email addresses, committer email addresses, commit message content, and other metadata"},{metadataRestrictionTypes:["branch_name_pattern","tag_name_pattern"],label:`Restrict ${m} names`,caption:`Restrict ${m} names`}];return a.length>0||!e?(0,l.jsx)(y.A,{className:"Box",sx:{borderTop:0,borderLeft:0,borderRight:0,borderRadius:0},children:(0,l.jsx)(st.u,{title:"Restrictions",metadata:j,children:b.map(m=>(0,l.jsx)(sn,{readOnly:e,upsellInfo:t,helpUrl:r,title:s,rules:a.filter(e=>m.metadataRestrictionTypes.includes(e.ruleType)),removeRule:i,restoreRule:o,setRuleModalState:d,metadataRestrictionTypes:m.metadataRestrictionTypes,label:m.label,caption:m.caption,availableRuleSchemas:n,addRule:c,metadataPatternRuleSchemas:u,setMetadataRestrictionTypes:p,sourceType:h,errors:Object.fromEntries(Object.entries(x).filter(([e,t])=>m.metadataRestrictionTypes.includes(e))),errorRef:f[Object.keys(x).find(e=>m.metadataRestrictionTypes.includes(e))??""]?.errorRef,addRestrictionButtonRef:g},m.label))})}):(0,l.jsxs)(y.A,{sx:{mb:4},children:[(0,l.jsx)(ej.A,{as:"h3",sx:{mb:1,mt:3,fontSize:3,fontWeight:"normal"},children:"Restrictions"}),(0,l.jsx)("div",{className:"Box mt-0",children:(0,l.jsx)(v,{heading:"No restrictions have been added"})})]})},sn=({readOnly:e,upsellInfo:t,helpUrl:r,title:s,rules:a,removeRule:n,restoreRule:i,setRuleModalState:o,metadataRestrictionTypes:d,label:c,caption:u,availableRuleSchemas:p,addRule:m,metadataPatternRuleSchemas:h,setMetadataRestrictionTypes:x,sourceType:g,errors:y,errorRef:j,addRestrictionButtonRef:v})=>{let[b,_]=(0,f.useState)(a.length>0),A=(0,f.useMemo)(()=>Object.values(y).flat().length>0,[y]);return(0,l.jsx)("li",{className:"Box-row d-flex flex-justify-between flex-items-center gap-2 pl-0",children:(0,l.jsxs)("div",{className:"d-flex flex-1 flex-column",children:[e?(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-bold",children:c}),(0,l.jsx)("span",{className:"d-block text-small color-fg-muted",children:u})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(tr.A,{children:[(0,l.jsx)(tj.A,{checked:b,onChange:()=>{if(b)for(let e of a)n(e);_(!b)}}),(0,l.jsx)(tr.A.Label,{children:c}),(0,l.jsx)(tr.A.Caption,{children:u})]}),b&&A&&(0,l.jsx)("div",{className:"pl-2",children:(0,l.jsx)("div",{className:"px-3",children:(0,l.jsx)(r3,{errorRef:j,errorId:`${c}-error`,sourceType:g,fields:[],errors:Object.values(y).flat()})})})]}),b&&(0,l.jsx)("div",{className:"pl-2 mt-2",children:(0,l.jsx)("div",{className:"px-3 py-2 d-flex flex-column",children:(0,l.jsx)("div",{className:"d-flex flex-column gap-2",children:(0,l.jsxs)("div",{className:"Box",children:[(0,l.jsxs)("div",{className:"Box-header d-flex flex-items-center p-2",children:[(0,l.jsx)("div",{className:"Box-title flex-1",children:"Metadata restrictions"}),!e&&(0,l.jsx)(er.Q,{ref:v,className:"ml-2",type:"button","aria-label":"Add workflow",size:"small",onClick:()=>{x(d),m(p.find(e=>d.includes(e.type))?.type||h.find(e=>d.includes(e.type)).type)},children:"Add restriction"})]}),(0,l.jsx)(ss,{readOnly:e,upsellInfo:t,helpUrl:r,title:s,rules:a,removeRule:n,restoreRule:i,setRuleModalState:o,errors:Object.values(y).flat()||[]})]})})})})]})})};try{sa.displayName||(sa.displayName="RestrictionsPanel")}catch{}try{sn.displayName||(sn.displayName="RestrictionsBox")}catch{}let sl=({readOnly:e,upsellInfo:t,helpUrls:r,rulesetId:s,rulesetTarget:i,sourceType:o,rules:d,ruleSchemas:c,ruleErrors:u,errorRefs:p,addRule:m,removeRule:h,restoreRule:x,setRuleModalState:g,updateRuleParameters:j})=>{let[b,_]=(0,f.useState)([]),N=(0,f.useMemo)(()=>d.filter(e=>e._modalState!==a.CREATING&&r6(e)!==n.REMOVED),[d]),w=(0,f.useMemo)(()=>c.reduce((e,t)=>(e[t.type]=t,e),{}),[c]),{refRules:S,commitMetadataRules:C}=(0,f.useMemo)(()=>N.reduce((e,t)=>{let r={...t,schema:w[t.ruleType]};return r.schema.metadataPatternSchema?e.commitMetadataRules.push(r):e.refRules.push(r),e},{refRules:[],commitMetadataRules:[]}),[w,N]),{branchRuleSchemas:I,metadataPatternRuleSchemas:R}=(0,f.useMemo)(()=>c.reduce((e,t)=>(t.metadataPatternSchema?e.metadataPatternRuleSchemas.push(t):e.branchRuleSchemas.push(t),e),{branchRuleSchemas:[],metadataPatternRuleSchemas:[]}),[c]),k=(0,f.useMemo)(()=>R.filter(e=>!C.find(t=>t.ruleType===e.type)),[R,C]),T=(0,f.useMemo)(()=>{let e=d.find(e=>e._modalState&&[a.CREATING,a.EDITING].includes(e._modalState));if(!e)return;let t=w[e.ruleType];if(t.metadataPatternSchema)return{...e,schema:t}},[w,d]),E=(0,f.useRef)(null);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tw,{title:"Rules",subtitle:"Which rules should be applied?"}),(0,l.jsxs)("div",{className:"d-flex flex-column gap-4","data-testid":"rules-panel",children:[(!e||S.length)&&I.length?(0,l.jsx)(y.A,{className:"Box",sx:{borderTop:0,borderLeft:0,borderRight:0,borderRadius:0,mb:0},children:(0,l.jsx)(st.u,{title:`${G(H(i))} rules`,metadata:(0,l.jsx)(si,{rulesetTarget:i}),children:(0,l.jsx)(so,{readOnly:e,helpUrls:r,rulesetId:s,sourceType:o,ruleErrors:u,errorRefs:p,addRule:m,removeRule:h,updateRuleParameters:j,branchRuleSchemas:I,refRules:S})})}):(0,l.jsx)(A,{name:`${G(H(i))} protections`,showHeader:!0,children:(!e||S.length)&&I.length?(0,l.jsx)("ul",{children:(0,l.jsx)(so,{readOnly:e,helpUrls:r,rulesetId:s,sourceType:o,ruleErrors:u,addRule:m,removeRule:h,updateRuleParameters:j,branchRuleSchemas:I,refRules:S,errorRefs:p})}):(0,l.jsx)(v,{heading:`No ${H(i)} protections have been added`})}),T&&(0,l.jsx)(se,{rule:T,ruleSchema:T.schema,availableMetadataRuleSchemas:k.filter(e=>b.includes(e.type)),removeRule:h,setRuleModalState:g,updateRuleParameters:j,returnFocusRef:E})]}),R.length>0&&(0,l.jsx)(sa,{readOnly:e,upsellInfo:t,helpUrl:r?.commitMetadataRules,title:"Metadata",rules:C,availableRuleSchemas:k,removeRule:h,restoreRule:x,setRuleModalState:g,addRule:m,metadataPatternRuleSchemas:R,setMetadataRestrictionTypes:_,sourceType:o,rulesetTarget:i,ruleErrors:u,errorRefs:p,addRestrictionButtonRef:E})]})};function si({rulesetTarget:e}){return(0,l.jsxs)(tN.A,{sx:{mb:0,pb:2,fontSize:3,fontWeight:"normal"},children:[G(H(e))," rules"]})}let so=({readOnly:e,helpUrls:t,rulesetId:r,sourceType:s,ruleErrors:a,errorRefs:n,addRule:i,removeRule:o,updateRuleParameters:d,branchRuleSchemas:c,refRules:u})=>(0,l.jsx)(l.Fragment,{children:c.map(c=>{let p=u.find(e=>e.ruleType===c.type);return e&&!p?null:(0,l.jsx)("li",{className:"Box-row d-flex flex-justify-between flex-items-center gap-2 pl-0",children:(0,l.jsx)(r5,{rulesetId:r,sourceType:s,helpUrls:t,readOnly:e,rule:p,ruleSchema:c,errors:a[c.type]||[],errorRef:n[c.type]?.errorRef,fieldRefs:n[c.type]?.fields,onAdd:()=>i(c.type),onRemove:()=>o(u.find(e=>e.ruleType===c.type)),onUpdateParameters:e=>d(p,e)})},c.type)})});try{sl.displayName||(sl.displayName="RulesPanel")}catch{}try{si.displayName||(si.displayName="ProtectionsHeader")}catch{}try{so.displayName||(so.displayName="ProtectionsList")}catch{}var sd=r(30386),sc=r(58762),su=r(96238);let sp={actorId:1,actorType:"OrganizationAdmin",name:"Organization admin",_dirty:!0,_enabled:!0,bypassMode:eB.v.ALWAYS},sm={actorId:null,actorType:"DeployKey",name:"Deploy keys",_dirty:!0,_enabled:!0,bypassMode:eB.v.ALWAYS},sh=["DeployKey"],sx=[{type:eB.v.ALWAYS,text:"Always",description:"Always allow rules to be bypassed",shortName:"Always allow"},{type:eB.v.PRS_ONLY,text:"For pull requests only",description:"Only allow rules to be bypassed on pull requests",shortName:"Allow for pull requests only"}];function sf({actor:e,baseAvatarUrl:t,readOnly:r,removeBypassActor:s,updateBypassActor:a,isBypassModeEnabled:n}){function i(e,t){let r=sx.find(t=>t.type===e.bypassMode);return t?r?.type:r?.shortName}function o(e){if("RepositoryRole"===e.actorType)switch(e.name){case"admin":return"Repository admin";case"maintain":return"Maintain";case"write":return"Write"}return e.name}return(0,l.jsxs)("li",{className:"Box-row d-flex flex-justify-between flex-items-center py-2",children:[(0,l.jsxs)("div",{className:"d-flex flex-items-center gap-3",children:[(0,l.jsx)(sc.u,{baseUrl:t,id:e.actorId,name:o(e),type:e.actorType}),(0,l.jsxs)("div",{children:[o(e),(0,l.jsx)(su.o,{actorType:e.actorType}),function({actorType:e,name:t,owner:r}){return"Team"===e?(0,l.jsxs)("span",{className:"note",children:[" \u2022 ",`@${t}`," "]}):"Integration"===e&&r?(0,l.jsxs)("span",{className:"note",children:[" \u2022 ",r," "]}):null}(e)]})]}),(0,l.jsx)("div",{className:"d-flex pl-3 flex-items-center",children:i(e,!1)&&(r?(0,l.jsx)(l.Fragment,{children:i(e,!1)}):(0,l.jsx)(sy,{actor:e,updateBypassActor:a,isBypassModeEnabled:n,getSelectedMode:i,modeIsSelected:function(e,t){return i(e,!0)===t.type},removeBypassActor:s}))})]},e._id)}function sg({actor:e,updateBypassActor:t,unboxRules:r,modeIsSelected:s}){return(0,l.jsx)(l.Fragment,{children:sx.map(a=>(0,l.jsxs)(X.l.Item,{selected:s(e,a),onSelect:()=>{t({...e,bypassMode:a.type,_dirty:!0})},children:[(0,l.jsx)(y.A,{sx:{...r&&{whiteSpace:"nowrap",overflow:"hidden"}},children:a.text}),!r&&(0,l.jsx)(X.l.Description,{variant:"block",children:a.description})]},a.type))})}function sy({actor:e,updateBypassActor:t,isBypassModeEnabled:r,getSelectedMode:s,modeIsSelected:a,removeBypassActor:n}){return(0,l.jsxs)(l.Fragment,{children:[r&&(0,l.jsx)(Q.A,{sx:{color:"fg.muted",mr:2},children:s(e,!1)}),(0,l.jsxs)(tr.A,{children:[r&&(0,l.jsx)(tr.A.Label,{visuallyHidden:!0,children:"Select bypass mode"}),(0,l.jsxs)($.W,{children:[(0,l.jsx)($.W.Anchor,{children:(0,l.jsx)(L.K,{sx:{color:"fg.muted"},icon:O.KebabHorizontalIcon,variant:"invisible","aria-label":"Bypass actor actions",title:"Bypass actor actions"})}),(0,l.jsx)($.W.Overlay,{width:"auto",children:(0,l.jsx)(X.l,{children:(0,l.jsxs)(l.Fragment,{children:[r&&!sh.includes(e.actorType)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(X.l.Group,{selectionVariant:"single",children:[(0,l.jsx)(X.l.GroupHeading,{children:"Allow"}),(0,l.jsx)(sg,{actor:e,updateBypassActor:t,unboxRules:!0,modeIsSelected:a})]}),(0,l.jsx)(X.l.Divider,{})]}),(0,l.jsxs)(X.l.Item,{variant:"danger",onSelect:()=>n(e),children:[(0,l.jsx)(X.l.LeadingVisual,{children:(0,l.jsx)(O.TrashIcon,{})}),"Delete bypass"]})]})})})]})]})]})}try{sf.displayName||(sf.displayName="BypassListRow")}catch{}try{sg.displayName||(sg.displayName="BypassActorMenu")}catch{}try{sy.displayName||(sy.displayName="RowRightHalfUnboxed")}catch{}let sj=({readOnly:e,isBypassModeEnabled:t,removeBypassActor:r,updateBypassActor:s,enabledBypassActors:a,baseAvatarUrl:n})=>(0,l.jsx)(l.Fragment,{children:a.map(a=>(0,l.jsx)(sf,{actor:a,baseAvatarUrl:n,readOnly:e,removeBypassActor:r,updateBypassActor:s,isBypassModeEnabled:t},`${a.actorType}-${a.id||a._id}`))});try{sj.displayName||(sj.displayName="BypassList")}catch{}var sv=r(30366),sb=r(73209);let s_=e=>{let t=`${(0,su.V)(e.actorType)}`;return"Team"===e.actorType?t=`${t} \u{2022} @${e.name}`:"Integration"===e.actorType&&e.owner&&(t=`${t} \u{2022} ${e.owner}`),t},sA=({baseAvatarUrl:e,enabledBypassActors:t,addBypassActor:r,removeBypassActor:s,suggestionsUrl:a,addReviewerSubtitle:n})=>{let[i,o]=(0,f.useState)([]),d=(0,f.useMemo)(()=>i.map(a=>({text:a.name,description:s_(a),id:JSON.stringify(a),leadingVisual:()=>(0,l.jsx)(sc.u,{baseUrl:e,id:a.actorId,name:a.name,type:a.actorType}),onAction:()=>{let e=(0,sb.x)(a.actorId,a.actorType,t);e?s(e):r(a.actorId,a.actorType,a.name,eB.v.ALWAYS,a.owner)}})),[i,e,t,r,s]),[c,u]=(0,f.useState)(!1),[p,m]=(0,f.useState)(!1),[h,x]=(0,f.useState)(""),g=async()=>{p?m(!1):(m(!0),u(!0),o(await (0,sv.K)(a,"")),u(!1))},y=(0,f.useCallback)((0,eZ.s)(async e=>{""===e?o(await (0,sv.K)(a,"")):o(await (0,sv.K)(a,e))},200),[a,o]);return(0,l.jsx)(tQ.X,{loading:c,title:"Add bypass",subtitle:n,renderAnchor:({"aria-labelledby":e,...t})=>(0,l.jsx)(er.Q,{leadingVisual:O.PlusIcon,trailingVisual:O.TriangleDownIcon,"aria-labelledby":` ${e}`,...t,"aria-haspopup":"dialog",children:"Add bypass"}),open:p,onOpenChange:g,items:d,selected:d.filter(e=>{if("string"==typeof e.id){let r=JSON.parse(e.id);return(0,sb.J)(r.actorId,r.actorType,t)}}),onSelectedChange:()=>{},placeholderText:"Filter bypass actors",filterValue:h,onFilterChange:e=>{x(e),y(e)},overlayProps:{width:"medium",height:"medium"}})};try{sA.displayName||(sA.displayName="BypassSelectPanel")}catch{}let sN=({readOnly:e,bypassActors:t,addBypassActor:r,removeBypassActor:s,rulesetTarget:a,orgAdminBypassMode:n,deployKeyBypass:i,updateBypassActor:o,setFlashAlert:d})=>{let{baseAvatarUrl:c,sourceType:u}=(0,g.B)(),{resolvePath:p}=R(),[m,h]=(0,f.useState)(!1),[x,j]=(0,f.useState)(!1),[b,_]=(0,f.useState)([]),A=p("bypass_suggestions"),N=(0,f.useMemo)(()=>{let e=[];return(n===eB.n.OrgBypassAny||n===eB.n.OrgBypassPRsOnly)&&(e=[...e,{...sp,bypassMode:n===eB.n.OrgBypassAny?eB.v.ALWAYS:eB.v.PRS_ONLY}]),i&&(e=[...e,sm]),[...e,...t.filter(({_enabled:e})=>e).sort(e=>"admin"===e.name&&"RepositoryRole"===e.actorType?-1:0)]},[t,i,n]);async function w(){try{h(!0);let e=await e5(A,"");h(!1),_(e)}catch(e){d({variant:"danger",message:"Failed to fetch suggestions"})}}let S=(0,f.useRef)(null),C="member_privilege"===a?"allow list":"bypass list",I=`Exempt roles${"repository"===u?", teams, or apps":" or teams"} from this ruleset by adding
    them to the ${C}.`,k=(0,B.u)("push_ruleset_delegated_bypass");"push"===a&&k&&(I="Select the roles and teams that can bypass and also approve bypass requests. Add the bots that can bypass this ruleset.");let T=(0,B.u)("add_bypass_dialog_select_panel_v1");return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(y.A,{className:"Box",sx:{borderTop:0,borderLeft:0,borderRight:0,borderRadius:0,pb:2,display:"flex",justifyContent:"space-between"},children:[(0,l.jsx)(ej.A,{as:"h2",sx:{fontSize:4,fontWeight:"normal"},children:G(C)}),T?!e&&(0,l.jsx)(sA,{baseAvatarUrl:c,enabledBypassActors:N,addBypassActor:r,removeBypassActor:s,suggestionsUrl:A,addReviewerSubtitle:"Choose which roles, teams, and apps can bypass this ruleset"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(sw,{readOnly:e,prepopulateSuggestions:w,setShowBypassDialog:j,isLoadingSuggestions:m,focusReturnRef:S}),!e&&x&&(0,l.jsx)(sd.p,{onClose:function(){j(!1),setTimeout(()=>{S.current?.focus()})},baseAvatarUrl:c,enabledBypassActors:N,addBypassActor:r,initialSuggestions:b,suggestionsUrl:A,addReviewerSubtitle:"Choose which roles, teams, and apps can bypass this ruleset"})]})]}),(0,l.jsx)(Q.A,{sx:{mt:2,mb:3,color:"fg.muted"},children:I}),(0,l.jsx)("div",{className:"Box",children:N.length>0||n===eB.n.OrgBypassAny||n===eB.n.OrgBypassPRsOnly?(0,l.jsx)(st.u,{title:G(C),children:(0,l.jsx)(sj,{readOnly:e,removeBypassActor:s,isBypassModeEnabled:"branch"===a,orgAdminBypassMode:n,updateBypassActor:o,enabledBypassActors:N,baseAvatarUrl:c})}):(0,l.jsx)(v,{heading:`${G(C)} is empty`})})]})},sw=({readOnly:e,prepopulateSuggestions:t,setShowBypassDialog:r,isLoadingSuggestions:s,focusReturnRef:a})=>(0,l.jsx)(l.Fragment,{children:e?null:(0,l.jsx)("div",{className:"d-flex flex-items-center",children:(0,l.jsxs)(er.Q,{ref:a,"aria-label":"Add bypass",onClick:async()=>{await t(),r(!0)},disabled:s,children:[(0,l.jsx)(O.PlusIcon,{})," Add bypass"]})})});try{sN.displayName||(sN.displayName="BypassListPanel")}catch{}try{sw.displayName||(sw.displayName="AddBypassButton")}catch{}var sS=r(21255);function sC(){let e=(0,B.u)("rules_history"),t=(0,B.u)("rules_import_export"),r=u(),{source:s,sourceType:a,upsellInfo:n,currentName:i,ruleset:o,ruleSchemas:d,readOnly:c=!1,isHistoryView:p=!1,supportedConditionTargetObjects:m,helpUrls:h,isImportedRuleset:x,isRestoredRuleset:y,noRulesets:j,initialErrors:v}=(0,g.B)(),{rulesetId:b,rulesetTarget:_,rulesetName:A,rulesetNameError:N,dirtyRulesetName:w,orgAdminBypassMode:S,dirtyOrgAdminBypassMode:C,deployKeyBypass:I,dirtyDeployKeyBypass:k,enforcement:E,dirtyEnforcement:$,rules:L,ruleSchemas:z,dirtyRules:P,conditions:D,dirtyConditions:M,bypassActors:V,setBypassActors:W,dirtyBypassActors:U,initializeRuleset:G,addRule:H,removeRule:K,restoreRule:Q,setRuleModalState:J,updateRuleParameters:Y,addOrUpdateCondition:X,removeCondition:ee,renameRuleset:et,setRulesetEnforcement:en,addBypassActor:el,removeBypassActor:ei,updateBypassActor:eo,validateForm:ed}=e0(o,d),[ec,ep]=(0,f.useState)([o]),{rulesetPreviewCounts:em,rulesetPreviewSamples:eh,rulesetPreviewErrors:ex}=eu(s,a,ec),{navigate:eg,resolvePath:ey}=R(),ej=(0,f.useRef)(null),ev=(0,f.useRef)(null),[eb,e_]=(0,f.useState)(!1),[eA,eN]=(0,f.useState)(!1),[eS,eI]=(0,f.useState)(!1),[eR,ek]=(0,f.useState)(o),[eT,e$]=(0,f.useState)({message:"",variant:"default"}),[eL,eB]=(0,f.useState)(null),[ez,eP]=(0,f.useState)(v?.rules||{}),[eD,eF]=(0,f.useState)(v?.general||{}),[eM,eV]=(0,f.useState)(v?.conditions||{}),[eW,eU]=(0,f.useState)({}),eG=(0,f.useRef)(null),eH=(0,f.useRef)(null),eq=(0,f.useRef)(null);(0,f.useEffect)(()=>{(function(){if(eL||Object.keys(eD).length||Object.keys(ez).length||Object.keys(eM).length){if(eD.name&&eD.name?.length>0){ev.current?.focus();return}if(Object.keys(eM).length>0){if(eM.repository&&eG.current){eG.current.focus();return}if(eM.ref&&eH.current){eH.current.focus();return}}if(ez){let e=Object.keys(ez).find(e=>eW[e]);if(e){if(eW[e]?.errorRef.current){eW[e]?.errorRef?.current?.focus();return}let t=e?eW[e]?.fields:null;if(t){for(let r of ez[e])if(r.field&&t[r.field]?.current){t[r.field]?.current?.focus();return}}}}e$({message:eL||"Failed to save ruleset",variant:"danger"})}})()},[ez,eD,eM,eL]),(0,f.useEffect)(()=>{ev?.current?.focus()},[]),(0,f.useEffect)(()=>{eq.current?.focus()},[eT,eq]);let eK=(0,f.useCallback)(e=>{let t={};for(let r of e.fields)t[r.name]=(0,f.createRef)();return t},[]);function eQ(){eP({}),eV({}),eF({}),eB(null)}(0,f.useEffect)(()=>{let e={};for(let t of z)e[t.type]={errorRef:(0,f.createRef)(),fields:eK(t.parameterSchema)};eU(e)},[z,eK]);let eJ=P.length>0||M.length>0||U.length>0||C!==S||k!==I||w!==A||$!==E,eY=eE({type:a,id:s.id},o),eX="You have unsaved changes. Are you sure you want to leave this page?",eZ=e=>{let t=D.find(t=>F[t.target]===e);if(!t)return!0;if("repository_id"===t.target)return 0===t.parameters.repository_ids.length;if("organization_id"===t.target)return 0===t.parameters.organization_ids.length;{let e=t.parameters;return 0===e.include.length&&0===e.exclude.length}};(0,f.useEffect)(()=>(document.body.setAttribute("data-turbo","false"),window.onbeforeunload=eJ?e=>{e.returnValue=eX}:null,()=>{document.body.removeAttribute("data-turbo"),window.onbeforeunload=null}),[eX,eJ]);let e1=async()=>{if(!eA&&!eb){if(!eJ){e$({message:"No changes have been made",variant:"default"});return}eN(!0);try{let e=await e3(ey("")),t=e.payload.ruleset,r=e.payload.ruleSchemas;G({ruleset:t,source:s,sourceType:a,upsellInfo:n,ruleSchemas:r,baseAvatarUrl:e.payload.baseAvatarUrl,supportedConditionTargetObjects:e.payload.supportedConditionTargetObjects,helpUrls:e.payload.helpUrls}),eQ(),e$({message:"Changes reverted",variant:"success"})}catch(e){e$({message:e.message||"Failed to get saved ruleset",variant:"danger"})}eN(!1)}};async function e5(){let e=await ed();return!Object.values(e).some(e=>e)||(ev.current&&e.name&&ev.current.focus(),!1)}let e9=async()=>{if(!eb&&!eA&&ej.current){if(e_(!0),eQ(),e$({message:"",variant:"default"}),!await (0,ea.Ay)()){e$({message:"Unauthorized",variant:"danger"}),e_(!1);return}if(!await e5()){e_(!1);return}try{let e={...o,orgAdminBypassMode:C,deployKeyBypass:k,name:w,enforcement:$,rules:L,conditions:D,bypassActors:V},t=await e2(ey(""),e);ek(t.ruleset),G(t),ep([t.ruleset]),e.id?y?(eg("",void 0,!0,!0),e$({message:"Ruleset restored",variant:"success"})):e$({message:"Ruleset updated",variant:"success"}):(eg(`../${t.ruleset.id}`,void 0,!0,!0),e$({message:x?"Ruleset imported":"Ruleset created",variant:"success"}))}catch(e){"No changes have been made"===e.message?e$({message:e.message,variant:"default"}):e.details&&(eP(e.details.rules),eV(e.details.conditions),eF(e.details.general),eB(e.message))}finally{e_(!1)}}},e4=async()=>{if(!await (0,ea.Ay)()){eI(!1),e$({variant:"danger",message:"Unauthorized"});return}try{(await (0,Z.DI)(ey(""),{method:"delete"})).ok?eg("..",void 0,!0,!0):(eI(!1),e$({variant:"danger",message:"Error deleting ruleset"}))}catch(e){eI(!1),e$({variant:"danger",message:"Error deleting ruleset"})}},e7="member_privilege"===_?"Protect your most important repositories":"Protect your most important branches";return(0,l.jsxs)("div",{className:"settings-next position-relative",children:[(0,l.jsx)(eO.p,{flashAlert:eT,setFlashAlert:e$,ref:eq}),(0,l.jsx)(sS.z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:(0,l.jsx)(sI,{rulesetTarget:_,resolvePath:ey,onGoBack:e=>{e.preventDefault(),(!eJ||window.confirm(eX))&&(eg(".."),window.onbeforeunload=null)},isHistoryView:p,currentName:i,rulesetId:b,rulesetName:A,readOnly:c,isStafftools:r,isInherited:eY,rulesetToExport:eR,upsellInfo:n,isRestoredRuleset:y,enforcement:E,setFlashAlert:e$})}),(0,l.jsx)("hr",{}),(0,l.jsxs)("form",{method:"post",action:ey(""),ref:ej,noValidate:!0,onSubmit:async e=>{e.preventDefault(),e9()},children:[j?(0,l.jsx)(eC,{headingText:e7,withBorder:!0,showNewRulesetButton:!1,supportedRulesetTargets:[],askAdmin:n.askAdmin,infoVariant:"one",sourceType:a,cta:n.rulesets.cta,organization:n.organization,setFlashAlert:e$}):n?.rulesets.cta.visible&&(0,l.jsx)(ew,{organization:n.organization,askAdmin:n.askAdmin,ctaPath:n.rulesets.cta.path,sourceType:a}),y&&n?.enterpriseRulesets.featureEnabled&&(0,l.jsx)("div",{className:"mb-2",children:(0,l.jsxs)(ef.A,{variant:"default",className:"d-flex flex-items-center",children:[(0,l.jsx)(T.A,{variant:"success",sx:{mr:2},children:"Beta"}),(0,l.jsxs)("span",{children:[(0,l.jsxs)("span",{className:"d-inline",children:["This ruleset has been restored to a previous version but the changes have not been saved. Review and save the changes below."," "]}),(0,l.jsx)(q.N,{to:"https://github.com/orgs/community/discussions/69918",children:"Give feedback"}),"."]})]})}),p&&(0,l.jsx)("div",{className:"mb-2",children:(0,l.jsx)(ef.A,{variant:"warning",className:"d-flex flex-items-center",children:(0,l.jsxs)("span",{children:[(0,l.jsxs)("span",{className:"d-inline",children:["You are viewing a previous version of this ruleset. This ruleset has been modified since this version. See the"," "]}),(0,l.jsx)(q.N,{reloadDocument:!0,to:ey("../../.."),children:"latest version"}),(0,l.jsx)("span",{children:"."})]})})}),"push"===_&&!b&&"repository"===a&&s.private&&(0,l.jsx)("div",{className:"mb-2",children:(0,l.jsx)(ef.A,{variant:"default",className:"d-flex flex-items-center",children:(0,l.jsx)("span",{children:(0,l.jsxs)("span",{className:"d-inline",children:["Push rulesets are applied to a repository and its downstream repositories. To review the downstream repositories that will inherit this ruleset,"," ",(0,l.jsx)(q.N,{to:ey("../../../forks"),children:"visit the forks page"}),"."]})})})}),x&&(0,l.jsx)("div",{className:"mb-2",children:(0,l.jsxs)(ef.A,{variant:"default",className:"d-flex flex-items-center",children:[(0,l.jsx)(T.A,{variant:"success",sx:{mr:2},children:"Beta"}),(0,l.jsxs)("span",{children:[(0,l.jsx)("span",{className:"d-inline",children:"This ruleset has been imported but the changes have not been saved."}),(0,l.jsx)("span",{className:"text-bold d-inline",children:" Review and save the changes below. "}),(0,l.jsx)(q.N,{to:"https://github.com/orgs/community/discussions/69918",children:"Give feedback"}),"."]})]})}),!n.rulesets.cta.visible&&m.length>0&&m.every(e=>eZ(e))&&b&&(0,l.jsx)("div",{className:"mb-2",children:(0,l.jsxs)(ef.A,{variant:"warning",className:"d-flex flex-items-center",children:[(0,l.jsx)(O.NoEntryIcon,{}),"This ruleset does not target any resources and will not be applied."]})}),(0,l.jsxs)("div",{className:"d-flex flex-column",children:[(0,l.jsx)(tl,{readOnly:c,upsellInfo:n,sourceType:a,name:w,enforcement:$,rulesetId:b,renameRuleset:et,rulesetNameError:N,setRulesetEnforcement:en,generalErrors:eD,nameRef:ev,rulesetTarget:_}),(!c||r||p)&&(0,l.jsx)(sN,{readOnly:c,bypassActors:V,setBypassActors:W,addBypassActor:el,removeBypassActor:ei,updateBypassActor:eo,rulesetTarget:_,orgAdminBypassMode:C,setFlashAlert:e$,deployKeyBypass:k}),m.length>0&&(0,l.jsx)(t6,{rulesetId:b,readOnly:c,rulesetTarget:_,fnmatchHelpUrl:h?.fnmatch,rulesetPreviewCount:em[o.id],rulesetPreviewSamples:eh[o.id],rulesetError:ex[o.id],dirtyConditions:M,supportedConditionTargetObjects:m,conditions:D,conditionErrors:eM,repositoryConditionRef:eG,refConditionRef:eH,source:s,addOrUpdateCondition:X,removeCondition:ee}),(0,l.jsx)(sl,{readOnly:c,upsellInfo:n,helpUrls:h,rulesetId:b,rulesetTarget:_,sourceType:a,rules:L,ruleSchemas:z,ruleErrors:ez,errorRefs:eW,addRule:H,removeRule:K,restoreRule:Q,setRuleModalState:J,updateRuleParameters:Y})]}),!c&&(0,l.jsxs)("div",{className:"d-flex gap-2 mt-4","data-testid":"ruleset-buttons",children:[(0,l.jsx)(er.Q,{variant:"primary",type:"submit",disabled:eb||eA,children:b?eb?(0,l.jsx)(l.Fragment,{children:"Saving..."}):(0,l.jsxs)(l.Fragment,{children:["Save",(0,l.jsx)("span",{className:"hide-md",children:"\xa0changes"})]}):"Create"}),b&&(0,l.jsx)(er.Q,{variant:"default",type:"button",onClick:e1,disabled:eA||eb,children:eA?(0,l.jsx)(l.Fragment,{children:"Reverting..."}):(0,l.jsxs)(l.Fragment,{children:["Revert",(0,l.jsx)("span",{className:"hide-md hide-sm",children:"\xa0changes"})]})})]})]}),!(e||t)&&(0,l.jsx)(es,{isOpen:eS,title:"Delete ruleset?",text:"Are you sure you want to delete this ruleset? This action cannot be undone.",buttonText:"Delete",onDismiss:()=>{eI(!1)},onConfirm:e4})]})}function sI({rulesetTarget:e,resolvePath:t,onGoBack:r,isHistoryView:a,currentName:n,rulesetId:i,rulesetName:o,readOnly:d,isStafftools:c,isInherited:u,rulesetToExport:p,upsellInfo:m,isRestoredRuleset:h,enforcement:x,setFlashAlert:g}){let j=(0,B.u)("rules_history"),v=(0,B.u)("rules_import_export"),[b,_]=(0,f.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"d-flex gap-1 flex-items-center f3",children:[(0,l.jsx)(q.N,{to:t(".."),onClick:r,children:"Rulesets"}),(0,l.jsx)("span",{children:"/"}),a?(0,l.jsx)(q.N,{reloadDocument:!0,to:t("../../.."),children:n}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("span",{children:i?n||o:`New ${H(e)} ruleset`})}),a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:"/"}),(0,l.jsx)("span",{children:"History"})]}),!m.rulesets.cta.visible&&!a&&i&&(0,l.jsx)(T.A,{sx:{ml:2},variant:function(e){switch(e){case s.Enabled:return"success";case s.Evaluate:return"severe";case s.Disabled:return"secondary"}}(x),children:J(x)})]}),(0,l.jsxs)(y.A,{sx:{display:"flex",alignItems:"center",columnGap:2},children:["push"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(T.A,{variant:"success",children:"Beta"}),(0,l.jsx)(q.N,{to:"https://github.com/orgs/community/discussions/118843",className:"f6",children:"Give feedback"})]}),i&&(!d||c&&!u)?(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)($.W,{open:b,onOpenChange:()=>_(!b),children:[(0,l.jsx)($.W.Anchor,{children:(0,l.jsx)(L.K,{icon:O.KebabHorizontalIcon,"aria-label":"Open additional options"})}),(0,l.jsx)($.W.Overlay,{children:(0,l.jsx)(en,{ruleset:p,rulesetsUrl:t(".."),insightsEnabled:(j||v)&&m.enterpriseRulesets.featureEnabled,showDeleteAction:!0,readOnly:d,rulesHistory:j,isRestored:h,rulesImportExport:v,enterpriseEnabled:m.enterpriseRulesets.featureEnabled,setFlashAlert:g,setMenuOpen:_})})]})}):null]})]})}try{sC.displayName||(sC.displayName="RulesetPage")}catch{}try{sI.displayName||(sI.displayName="RulesHeader")}catch{}var sR=r(33665),sk=r(89169),sT=r(33520);function sE({showCreateButton:e,setFlashAlert:t,supportedRulesetTargets:r}){let{resolvePath:a}=R();return(0,l.jsxs)("div",{className:"blankslate",children:[(0,l.jsx)(K.A,{icon:O.PulseIcon,size:24}),(0,l.jsx)("h3",{className:"blankslate-heading",children:"No rule evaluations matched your search"}),e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{children:"Try expanding your search or creating a new ruleset in evaluate mode"}),(0,l.jsx)(eN,{rulesetsUrl:a("../"),reloadDocument:!0,defaultEnforcement:s.Evaluate,sx:{mt:4,justifyContent:"center"},setFlashAlert:t,supportedTargets:r})]})]})}try{sE.displayName||(sE.displayName="InsightsBlank")}catch{}var sO=r(38170),s$=r(25995);let sL=["all","pass","fail","bypass"],sB={all:"All statuses",pass:"Pass",fail:"Fail",bypass:"Bypass"};function sz({currentRuleStatus:e,onSelect:t}){return(0,l.jsx)(s$.$,{currentSelection:e,orderedValues:sL,displayValues:sB,onSelect:t})}try{sz.displayName||(sz.displayName="RuleStatusFilter")}catch{}var sP=r(52876);function sD({currentRuleset:e,allRulesets:t,onSelect:r}){return(0,l.jsxs)($.W,{children:[(0,l.jsx)($.W.Button,{leadingVisual:O.RepoPushIcon,size:"medium",children:(0,l.jsx)(y.A,{sx:{maxWidth:125,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e?(0,l.jsx)("span",{children:e.name}):(0,l.jsx)("span",{children:"All rulesets"})})}),(0,l.jsx)($.W.Overlay,{width:"medium",children:(0,l.jsxs)(X.l,{selectionVariant:"single",children:[(0,l.jsx)(X.l.Item,{selected:null===e,onSelect:()=>r(void 0),children:(0,l.jsx)("div",{className:"d-flex",children:"All rulesets"})}),t.map(t=>(0,l.jsx)(X.l.Item,{selected:e?.name===t.name,onSelect:()=>r(t),children:(0,l.jsx)("span",{children:t.name})},t.id))]})})]})}try{sD.displayName||(sD.displayName="RulesetFilter")}catch{}function sF({filter:e}){let t=[];return e&&(e.branch&&t.push(`ref=${(0,eo.QU)(e.branch)}`),e.repository&&t.push(`repository=${(0,eo.QU)(e.repository)}`),e.actor&&t.push(`actor=${(0,eo.QU)(e.actor.login)}`),e.timePeriod&&t.push(`time_period=${(0,eo.QU)(e.timePeriod)}`),e.ruleset&&t.push(`ruleset=${(0,eo.QU)(e.ruleset.name)}`),e.ruleStatus&&t.push(`rule_status=${(0,eo.QU)(e.ruleStatus)}`),e.evaluateStatus&&t.push(`evaluate_status=${(0,eo.QU)(e.evaluateStatus)}`),e.page&&t.push(`page=${(0,eo.QU)(String(e.page))}`)),t.length>0?`${t.join("&")}`:""}var sM=r(5225);async function sV(e){let t=await (0,Z.lS)(e);return t.ok?await t.json():void 0}let sW=new Map,sU=(0,sM.A)(sV,{cache:sW}),sG=["active","evaluate","all"],sH={active:"Active rules",evaluate:"Evaluate rules",all:"All rules"};function sq({currentEvaluateStatus:e,onSelect:t}){return(0,l.jsx)(s$.$,{currentSelection:e,orderedValues:sG,displayValues:sH,onSelect:t})}try{sq.displayName||(sq.displayName="EvaluateStatusFilter")}catch{}let sK=({filter:e,source:t,sourceType:r,branchListCacheKey:s,rulesets:a,repositories:n})=>{let{actor:i,timePeriod:o,ruleset:d,branch:c,ruleStatus:u,evaluateStatus:p,repository:m}=e,{navigate:h}=R(),x=function(){let e=(0,eo.$6)(),[t,r]=(0,f.useState)({users:[],error:!1,loading:!0});return(0,f.useEffect)(()=>{let t=!1;return(async()=>{r({users:[],error:!1,loading:!0});let s=await sU(e);if(t)return;let a=[],n=!1;try{s?a=s.actors:n=!0}catch(e){n=!0}r({users:a,error:n,loading:!1})})(),function(){t=!0}},[e]),t}(),g=e=>{e.page=void 0,h(".",sF({filter:e}),!0)},j=(0,f.useMemo)(()=>n?.map(e=>({name:e}))||[],[n]);return(0,l.jsxs)(y.A,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap"},className:"mb-3",children:[(0,l.jsx)("div",{className:"d-flex p-1",children:(0,l.jsx)(sq,{currentEvaluateStatus:p||"active",onSelect:t=>{t!==p&&g({...e,evaluateStatus:t})}})}),(0,l.jsx)("div",{className:"d-flex p-1",children:(0,l.jsx)(sD,{currentRuleset:d,allRulesets:a,onSelect:t=>{t!==d&&g({...e,ruleset:t})}})}),"repository"===r&&(0,l.jsx)("div",{className:"d-flex p-1",children:(0,l.jsx)(N.PI,{currentCommitish:c||"All branches",defaultBranch:t.defaultBranch,owner:t.ownerLogin,repo:t.name,canCreate:!1,cacheKey:s,onSelectItem:t=>{t!==c&&g({...e,branch:t})},hotKey:"w",types:["branch"],hideShowAll:!0,customFooterItemProps:{text:"View for all branches",onClick:()=>{void 0!==c&&g({...e,branch:void 0})},sx:{alignItems:"center",display:"flex",justifyContent:"center"}}})}),"organization"===r&&(0,l.jsx)("div",{className:"d-flex p-1",children:(0,l.jsx)(tS.P,{currentSelection:m?{name:m}:void 0,repositoryLoader:(0,tS.w)(j),selectAllOption:!0,selectionVariant:"single",onSelect:t=>{t?.name!==m&&g({...e,repository:t?.name})}})}),(0,l.jsx)("div",{className:"d-flex p-1",children:(0,l.jsx)(sP.T,{defaultText:"All users",usersState:x,currentUser:i,onSelect:t=>{t!==i&&g({...e,actor:t})},renderCustomFooter:()=>(0,l.jsx)(X.l.Item,{onSelect:()=>{g({...e,actor:void 0})},children:"View for all users"})})}),(0,l.jsx)("div",{className:"d-flex p-1",children:(0,l.jsx)(sO.C,{currentTimePeriod:o||"day",onSelect:t=>{t!==o&&g({...e,timePeriod:t})}})}),(0,l.jsx)("div",{className:"d-flex p-1",children:(0,l.jsx)(sz,{currentRuleStatus:u||"all",onSelect:t=>{t!==u&&g({...e,ruleStatus:t})}})})]})};try{sK.displayName||(sK.displayName="InsightsFilterBar")}catch{}var sQ=r(22084);function sJ({user:e}){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ey.A,{"aria-label":`View ${e.login} profile`,href:e.path,children:(0,l.jsx)(tJ.r,{sx:{mr:2,cursor:"pointer"},src:e.primaryAvatarUrl,"data-hovercard-url":(0,eo.dC)({owner:e.login}),square:e.path.startsWith("/apps/")})}),(0,l.jsx)(ey.A,{muted:!0,href:e.path,"data-hovercard-url":(0,eo.dC)({owner:e.login}),sx:{fontWeight:600,color:"fg.default","&:hover":{color:"fg.default",textDecoration:"underline"}},children:e.login})]})}try{sJ.displayName||(sJ.displayName="User")}catch{}var sY=r(94977);function sX({state:e,avatarLabel:t,avatarUrl:r,hovercardUrl:s,title:a,description:n,warning:i,titleClass:o,paddingY:d,paddingLeft:c}){return(0,l.jsxs)(y.A,{as:"li",sx:{paddingY:d??2,marginX:3,paddingLeft:c??2,display:"flex",alignItems:"center",justifyContent:"flex-start",gap:2},children:[(0,l.jsx)(K.A,{icon:"success"===e?O.CheckIcon:O.XIcon,sx:{color:"success"===e?"success.fg":"danger.fg"}}),r&&(0,l.jsx)(tJ.r,{"aria-label":t,src:r,"data-hovercard-url":s}),(0,l.jsx)(Q.A,{className:o,sx:{fontWeight:o?void 0:"bold"},children:a}),n?(0,l.jsx)(Q.A,{sx:{color:"fg.muted",whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"clip"},children:n}):null,i&&(0,l.jsx)(sY.A,{"aria-label":i,wrap:!0,children:(0,l.jsx)(O.AlertIcon,{size:16})})]})}try{sX.displayName||(sX.displayName="ListItem")}catch{}function sZ({metadata:e}){return(0,l.jsx)("ul",{children:e.prReviewers.map(({state:e,stateSummary:t,user:r})=>(0,l.jsx)(sX,{state:"approved"===e?"success":e,avatarLabel:r.login,avatarUrl:r.primaryAvatarUrl,hovercardUrl:(0,eo.dC)({owner:r.login}),title:r.login,description:t},r.login))})}try{sZ.displayName||(sZ.displayName="PullRequestList")}catch{}function s0({metadata:e}){return(0,l.jsx)("ul",{children:e.checks.map(({integrationName:e,integrationAvatarUrl:t,checkRunName:r,state:s,id:a,sha:n,description:i,warning:o})=>(0,l.jsx)(sX,{state:s,avatarUrl:t,avatarLabel:e,title:`${e} / ${r}`,description:`${i} ${n?`\u{2022} ${n.toString().slice(0,6)}`:""}`,warning:o},a))})}try{s0.displayName||(s0.displayName="StatusChecksList")}catch{}function s1({metadata:e}){return(0,l.jsx)("ul",{children:e.deploymentResults.map(({status:e,name:t,sha:r,id:s})=>(0,l.jsx)(sX,{state:"active"===e?"success":e,title:t,description:r?`${r.toString().slice(0,6)}`:""},s))})}try{s1.displayName||(s1.displayName="DeploymentsList")}catch{}function s2({violations:e,format:t}){let r=e.items.length,s=e.total;return(0,l.jsxs)("ul",{children:[r<s&&(0,l.jsxs)(y.A,{sx:{paddingLeft:4,paddingTop:0,color:"danger.fg"},children:["Found ",s," violations (showing first ",r,")"]}),e.items.map((e,r)=>(0,l.jsx)(sX,{state:"failure",title:"path"===t?e.candidate?.substring(e.candidate.lastIndexOf("/")+1)||"Unknown":e.candidate,titleClass:"commit"===t?"text-mono":void 0,description:"path"===t?e.candidate||"N/A":void 0,paddingY:1},r))]})}try{s2.displayName||(s2.displayName="ViolationsList")}catch{}function s3({ruleRun:e}){switch(e.ruleType){case"pull_request":return(0,l.jsx)(sZ,{metadata:e.metadata});case"required_status_checks":return(0,l.jsx)(s0,{metadata:e.metadata});case"required_deployments":return(0,l.jsx)(s1,{metadata:e.metadata});case"file_extension_restriction":case"file_path_restriction":case"max_file_path_length":case"max_file_size":return(0,l.jsx)(s2,{violations:e.violations,format:"path"});case"commit_author_email_pattern":case"commit_message_pattern":case"commit_oid":case"committer_email_pattern":case"required_linear_history":case"required_signatures":case"ruleset_required_signatures":return(0,l.jsx)(s2,{violations:e.violations,format:"commit"})}return null}try{s3.displayName||(s3.displayName="RuleRunMetadataList")}catch{}let s5=({ruleSuite:e,visibleResult:t,onClose:r})=>{let{orderedCategories:s,passedRulesetCount:a,failedRulesetCount:n,bypassedRulesetCount:i}=function(e,t){let[r,s,a]=(0,f.useMemo)(()=>{let r=new Map,s=new Map;for(let t of e.ruleRuns){let e=t.insightsCategory.id||t.insightsCategory.name;r.set(e,t.insightsCategory);let a=s.get(e)||[];a.push(t),s.set(e,a)}let a=new Map;for(let[e,t]of s.entries())a.set(r.get(e),t);let[n,l]=ek(a,(e,t)=>t.some(e=>"evaluate_failed"===e.result||"failed"===e.result)),[i,o]=ek(new Map(n),(r,s)=>{let a=s.some(e=>"evaluate_failed"===e.result);return a&&"bypassed"===t||!a&&"bypassed"===e.result});return[o,l,i]},[e,t]);return{orderedCategories:r.concat(a).concat(s),failedRulesetCount:r.length,passedRulesetCount:s.length,bypassedRulesetCount:a.length}}(e,t),o=e.evaluationMetadata.preReceiveFailure||!1,d=e.evaluationMetadata.mergeGroupPullRequests,c="failed"===e.result&&e.evaluationMetadata.mergeQueueRemovalReason,u=e.evaluationMetadata.mergeQueueCheckResults;return(0,l.jsx)(tv.l,{width:"xlarge",onClose:r,sx:{overflowY:"auto"},renderHeader:()=>(0,l.jsxs)(y.A,{sx:{display:"flex",flexDirection:"row",padding:2},children:[(0,l.jsxs)(y.A,{sx:{display:"flex",flexDirection:"column",flex:1,gap:1,padding:2},children:[c?(0,l.jsx)(Q.A,{as:"h4",sx:{fontWeight:"bold",color:"danger.fg"},children:"Merge queue push failed"}):n>0?(0,l.jsx)(Q.A,{as:"h4",sx:{fontWeight:"bold",color:"danger.fg"},children:"Some rules did not pass"}):i>0?(0,l.jsx)(Q.A,{as:"h4",sx:{fontWeight:"bold",color:"fg.default"},children:"Some rules were bypassed"}):"push_rejected"===e.result?(0,l.jsx)(Q.A,{as:"h4",sx:{fontWeight:"bold",color:"success.fg"},children:"Push rules passed"}):(0,l.jsx)(Q.A,{as:"h4",sx:{fontWeight:"bold",color:"success.fg"},children:"All rules passed"}),(0,l.jsx)(Q.A,{sx:{color:"fg.muted"},children:function(e,t,r){let s=Array.from(new Map(Object.entries({passed:e,failed:t,bypassed:r})).entries()).filter(e=>e[1]>0);return s.length>2?s.map(e=>`${U(e[1],"ruleset","rulesets")} ${e[0]}`).join(", "):2===s.length?s.map(e=>`${U(e[1],"ruleset","rulesets")} ${e[0]}`).join(" and "):1===s.length?`${U(s[0][1],"ruleset","rulesets")} ${s[0][0]}`:"No rulesets ran"}(a,n,i)})]}),(0,l.jsx)(tv.l.CloseButton,{onClose:()=>r()})]}),renderBody:()=>(0,l.jsxs)(l.Fragment,{children:[o&&(0,l.jsxs)(ef.A,{variant:"warning",sx:{mx:3,mb:3,display:"flex",flexDirection:"column"},children:[(0,l.jsx)("span",{children:"Push rules blocked this update, preventing other rulesets from applying."}),"push_rejected"===e.result&&(0,l.jsx)("span",{children:"Other updates in this push were blocked impacting this change."})]}),(0,l.jsxs)("ul",{children:[s.map(([r,s])=>{let a=s.some(e=>"evaluate_failed"===e.result),n=a&&"bypassed"===t||!a&&"bypassed"===e.result;return(0,l.jsx)(y.A,{as:"li",sx:{display:"flex",border:0,borderTop:1,borderTopStyle:"solid",borderTopColor:"border.default"},children:(0,l.jsx)(s8,{ruleRuns:s,category:r,categoryBypassed:n})},`${r.name}/${r.id}`)}),(d?.length||u?.length)&&(0,l.jsx)(y.A,{as:"li",sx:{display:"flex",border:0,borderTop:1,borderTopStyle:"solid",borderTopColor:"border.default"},children:(0,l.jsx)(s9,{afterOid:e.afterOid,mergeGroupPrs:d,mergeQueueChecks:u})},"mqdetails")]})]})})};function s9({afterOid:e,mergeGroupPrs:t,mergeQueueChecks:r}){let[s,a]=(0,f.useState)(!1);return(0,l.jsxs)(y.A,{sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[(0,l.jsxs)(y.A,{sx:{display:"flex",flexDirection:"row",flexGrow:1,paddingY:3,paddingLeft:2,paddingRight:4,alignItems:"center"},children:[(0,l.jsx)(y.A,{sx:{display:"flex"},children:(0,l.jsx)(L.K,{sx:{color:"fg.muted",marginRight:1,flexShrink:0},icon:s?O.ChevronDownIcon:O.ChevronRightIcon,size:"small",variant:"invisible","aria-label":"View rule runs",title:"View rule runs",type:"button",onClick:()=>a(!s)})}),(0,l.jsx)(y.A,{sx:{display:"flex",alignItems:"baseline"},children:(0,l.jsx)(K.A,{icon:O.GitMergeQueueIcon,sx:{marginRight:2,color:"attention.fg"}})}),(0,l.jsx)(y.A,{sx:{display:"flex",alignItems:"baseline",flexGrow:1},children:(0,l.jsx)(Q.A,{sx:{fontWeight:"bold"},children:"Merge queue details"})})]}),s?(0,l.jsxs)(y.A,{as:"ul",sx:{backgroundColor:"canvas.subtle"},children:[t?.length&&(0,l.jsx)(s4,{mergeGroupPrs:t},"grp"),r?.length&&(0,l.jsx)(s7,{afterOid:e,mergeQueueChecks:r},"chk")]}):null]})}function s4({mergeGroupPrs:e}){return(0,l.jsxs)(y.A,{as:"li",sx:{display:"flex",flexDirection:"column",paddingTop:2,paddingRight:3,paddingBottom:2,paddingLeft:6,borderTopColor:"border.default",borderTopStyle:"solid",borderTopWidth:1},children:[(0,l.jsx)(Q.A,{sx:{flexShrink:0,flexBasis:"auto",paddingRight:2,paddingBottom:1,fontWeight:"bold"},children:"Pull requests in this merge group"}),(0,l.jsx)(y.A,{sx:{display:"flex",flexFlow:"row wrap",columnGap:2,flexGrow:1},children:e.map(e=>(0,l.jsxs)(ey.A,{href:e?.link,children:["#",e?.number]},e.id))})]})}function s7({afterOid:e,mergeQueueChecks:t}){return(0,l.jsxs)(y.A,{as:"li",sx:{display:"flex",flexDirection:"column",paddingTop:2,paddingRight:3,paddingBottom:2,paddingLeft:6,borderTopColor:"border.default",borderTopStyle:"solid",borderTopWidth:1},children:[(0,l.jsx)(y.A,{sx:{display:"flex",flexDirection:"row",flexGrow:0},children:(0,l.jsx)(Q.A,{sx:{flexGrow:0,fontWeight:"bold"},children:"Required checks run by the merge queue"})}),(0,l.jsx)(y.A,{as:"ul",sx:{display:"flex",flexDirection:"column",marginTop:1,marginBottom:1,paddingLeft:2,columnGap:1,borderTopStyle:"none"},children:t.map(t=>(0,l.jsx)(s6,{afterOid:e,mergeCheck:t},t.context))})]})}function s6({afterOid:e,mergeCheck:t}){return(0,l.jsx)(y.A,{as:"li",sx:{display:"flex",flexGrow:1,borderTopStyle:"none"},children:(0,l.jsx)(sX,{paddingY:0,state:t.state||"pending",title:` / ${t.context}`,description:` ${e?`\u{2022} ${e.toString().slice(0,6)}`:""}`},t.context)})}function s8({ruleRuns:e,category:t,categoryBypassed:r}){let[a,n]=(0,f.useState)(!1),i=e.every(e=>"allowed"===e.result||"evaluate_allowed"===e.result),o=e.filter(e=>"evaluate_failed"===e.result||"failed"===e.result).length,d=e.some(e=>e.insightsSourceOutOfDate),c=[...new Map(e.flatMap(e=>(e.exemptionResponses||[]).map(e=>[e.id,e]))).values()],u=null,p=null,m=c.filter(e=>"rejected"===e.status);if(m.length>0?p="rejected":(m=c.filter(e=>"approved"===e.status)).length>0&&(p="approved"),m.length>0&&p){let e=m[0];u=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(Q.A,{sx:{mr:1},children:[e.exemptionRequestUrl?(0,l.jsx)(ey.A,{href:e.exemptionRequestUrl,children:"Bypass request"}):"Bypass request"," ",p," by"]}),(0,l.jsx)(sJ,{user:e.reviewer}),m.length>1?`and ${m.length-1} others`:"","."]})}let h=eR(e,e=>"failed"===e.result||"evaluate_failed"===e.result).flat();return(0,l.jsxs)(y.A,{sx:{display:"flex",flexDirection:"column",flexGrow:1,overflowX:"clip"},children:[(0,l.jsxs)(y.A,{sx:{display:"flex",flexDirection:"column",paddingY:3},children:[(0,l.jsxs)(y.A,{sx:{display:"flex",flexDirection:"row",flexGrow:1,paddingLeft:2,paddingRight:4,alignItems:"center"},children:[(0,l.jsx)(y.A,{sx:{display:"flex"},children:(0,l.jsx)(L.K,{sx:{color:"fg.muted",marginRight:1,flexShrink:0},icon:a?O.ChevronDownIcon:O.ChevronRightIcon,size:"small",variant:"invisible","aria-label":"View rule runs",title:"View rule runs",type:"button",onClick:()=>n(!a)})}),(0,l.jsx)(y.A,{sx:{display:"flex",alignItems:"baseline"},children:i?(0,l.jsx)(K.A,{icon:O.CheckCircleFillIcon,sx:{marginRight:2,color:"success.fg"}}):(0,l.jsx)(K.A,{icon:O.XCircleFillIcon,sx:{marginRight:2,color:"danger.fg"}})}),(0,l.jsxs)(y.A,{sx:{display:"flex",alignItems:"baseline",flexGrow:1},children:[t.link?(0,l.jsx)(ey.A,{hoverColor:"accent.fg",sx:{color:"fg.default"},href:t.link,children:(0,l.jsx)(Q.A,{sx:{fontWeight:"bold"},children:t.name})}):(0,l.jsx)(Q.A,{sx:{fontWeight:"bold"},children:t.name}),d&&(0,l.jsx)(sY.A,{wrap:!0,"aria-label":"The ruleset that ran for this push has changed",children:(0,l.jsx)(T.A,{sx:{marginLeft:2},variant:"secondary",children:"Outdated"})}),!i&&(0,l.jsxs)(Q.A,{sx:{marginLeft:2,color:"danger.fg",fontSize:0},children:[U(o,"rule","rules")," ",r?"bypassed":"failed"]})]}),(0,l.jsx)(y.A,{sx:{display:"flex",alignItems:"baseline",marginLeft:1},children:(0,l.jsx)(Y,{enforcement:e.some(e=>"evaluate_allowed"===e.result||"evaluate_failed"===e.result)?s.Evaluate:s.Enabled})})]}),u&&(0,l.jsx)(y.A,{sx:{marginLeft:8},children:(0,l.jsx)(Q.A,{sx:{color:"fg.muted",fontSize:0},children:u})})]}),a?(0,l.jsx)("ul",{children:h.map(e=>(0,l.jsx)(ae,{ruleRun:e,bypassed:r},e.id))}):null]})}function ae({ruleRun:e,bypassed:t}){let[r,s]=(0,f.useState)(!1),{result:a,message:n}=e;return(0,l.jsxs)(y.A,{as:"li",sx:{display:"flex",paddingBottom:2,paddingLeft:4,paddingRight:3,backgroundColor:"canvas.subtle",borderTopColor:"border.default",borderTopStyle:"solid",borderTopWidth:1},children:[!function(e){switch(e.ruleType){case"pull_request":return e.metadata?.prReviewers.length;case"required_status_checks":return e.metadata?.checks.length;case"required_deployments":return e.metadata?.deploymentResults.length;case"commit_author_email_pattern":case"commit_message_pattern":case"commit_oid":case"committer_email_pattern":case"file_extension_restriction":case"file_path_restriction":case"max_file_path_length":case"max_file_size":case"required_linear_history":case"required_signatures":case"ruleset_required_signatures":return e.violations?.total}return!1}(e)?(0,l.jsx)(y.A,{sx:{paddingLeft:3,paddingRight:2,marginRight:2}}):(0,l.jsx)(L.K,{sx:{color:"fg.muted",marginRight:1,marginTop:1,flexShrink:0},icon:r?O.ChevronDownIcon:O.ChevronRightIcon,size:"small",variant:"invisible","aria-label":"View rule run",title:"View rule run",type:"button",onClick:()=>s(!r)}),(0,l.jsxs)(y.A,{sx:{display:"flex",flexDirection:"column",flexGrow:1,paddingTop:2,marginLeft:1,overflowX:"clip"},children:[(0,l.jsxs)(y.A,{sx:{display:"flex",flexDirection:"row",flexGrow:1},children:["allowed"===a||"evaluate_allowed"===a?(0,l.jsx)(K.A,{icon:O.CheckCircleFillIcon,sx:{marginTop:.9,marginRight:2,color:"success.fg"}}):(0,l.jsx)(K.A,{icon:O.XCircleFillIcon,sx:{marginTop:.9,marginRight:2,color:"danger.fg"}}),(0,l.jsx)(Q.A,{sx:{flexGrow:1,fontWeight:"bold"},children:function(e){let t=e.ruleDisplayName||e.ruleType;return"pull_request"===e.ruleType&&e.metadata?(0,l.jsxs)(l.Fragment,{children:[`${t} (`,(0,l.jsxs)(ey.A,{href:e.metadata.prLink,children:["#",e.metadata.prNumber]}),")"]}):t}(e)}),"failed"===a&&!t&&(0,l.jsx)(Q.A,{sx:{marginRight:3,color:"danger.fg",fontSize:0},children:"Push blocked"})]}),(0,l.jsx)(y.A,{sx:{marginLeft:4},children:n&&(0,l.jsx)(Q.A,{sx:{color:"fg.muted",fontSize:0},children:n})}),r?(0,l.jsx)(s3,{ruleRun:e}):null]})]})}try{s5.displayName||(s5.displayName="RuleSuiteDetailsDialog")}catch{}try{s9.displayName||(s9.displayName="MergeQueueDetailsRow")}catch{}try{s4.displayName||(s4.displayName="MergeGroupRow")}catch{}try{s7.displayName||(s7.displayName="MergeCheckList")}catch{}try{s6.displayName||(s6.displayName="MergeCheckRow")}catch{}try{s8.displayName||(s8.displayName="RulesetRow")}catch{}try{ae.displayName||(ae.displayName="RunListItem")}catch{}let at="refs/heads/",ar=({ruleSuite:e,visibleResult:t,sourceType:r,sourceName:s})=>{let[a,n]=(0,f.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(y.A,{as:"li",sx:{borderTopColor:"border.default",borderTopStyle:"solid",borderTopWidth:1,"&:first-child":{borderTopWidth:0},display:"flex",flexDirection:"column",justifyContent:"space-between"},children:(0,l.jsxs)(y.A,{sx:{display:"flex",justifyContent:"space-between",padding:2,paddingX:3},children:[(0,l.jsxs)(y.A,{sx:{display:"flex",flexDirection:"column",overflow:"hidden",justifyContent:"center"},children:[!function(e){return!aa(e)&&(!e.beforeOid||!e.afterOid)}(e)&&(0,l.jsx)(y.A,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:(0,l.jsx)(Q.A,{sx:{fontWeight:"bold"},children:function(e){return"failed"===e.result&&e.evaluationMetadata.mergeQueueRemovalReason?(0,l.jsxs)(l.Fragment,{children:["Merge group of ",e.evaluationMetadata.mergeGroupPullRequests?.length," pull requests blocked"]}):e.afterOid?e.commit?.message?function({commit:e}){return e.shortMessageHtmlLink?(0,l.jsx)(tu.A,{title:e.message,sx:{maxWidth:"100%"},children:(0,l.jsx)(sQ.oG,{sx:{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal",wordBreak:"break-word"},html:e.shortMessageHtmlLink})}):e.message}({commit:e.commit}):e.evaluationMetadata.blobEvaluation?"Added blobs":aa(e)?"Added commits":e.beforeOid?"Updated branch":"Created branch":"Deleted branch"}(e)})}),(0,l.jsxs)(y.A,{sx:{color:"fg.muted",fontSize:0,display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"baseline"},children:[e.actor&&(0,l.jsxs)(Q.A,{sx:{mr:1},children:[(0,l.jsx)(sJ,{user:e.actor}),e.actorIsPublicKey?(0,l.jsx)(K.A,{"aria-label":"Pushed with a deploy key",icon:O.KeyIcon,sx:{ml:1}}):null]}),(0,l.jsx)(Q.A,{sx:{whiteSpace:"nowrap"},children:(0,l.jsx)(an,{sourceType:r,ruleSuite:e,sourceName:s})}),(0,l.jsx)("span",{children:"\xa0"}),(0,l.jsx)(sk.A,{date:new Date(e.createdAt),tense:"past"})]})]}),(0,l.jsxs)(y.A,{sx:{display:["flex"],alignItems:"center",marginLeft:2},children:[(0,l.jsx)(as,{ruleSuite:e,visibleResult:t}),(0,l.jsx)(L.K,{sx:{color:"fg.muted"},icon:O.KebabHorizontalIcon,variant:"invisible","aria-label":"View rule runs",title:"View rule runs",type:"button",onClick:()=>n(!a)})]})]})}),a?(0,l.jsx)(s5,{ruleSuite:e,visibleResult:t,onClose:()=>n(!1)}):null]})};function as({ruleSuite:e,visibleResult:t}){return"allowed"===t?(0,l.jsx)(T.A,{variant:"success",children:"Pass"}):"bypassed"===t?(0,l.jsx)(T.A,{variant:"secondary",children:"Bypass"}):"failed"===t&&e.evaluationMetadata.mergeQueueRemovalReason?(0,l.jsx)(T.A,{variant:"danger",children:"Merge queue failed"}):(0,l.jsx)(T.A,{variant:"danger",children:"Fail"})}function aa(e){return"refs/__gh__/UNKNOWN"===e.refName}function an({sourceType:e,ruleSuite:t,sourceName:r}){let s=t.refName.startsWith(at)?t.refName.substring(at.length):t.refName,a=t.beforeOid?.slice(0,7),n=t.afterOid?.slice(0,7),i=t.evaluationMetadata.preReceiveFailure||!1,o=t.beforeOid===V||t.afterOid===V,d="enter_queue_failed"===t.result,c="",u=null;return t.afterOid?t.beforeOid?(c=d?"blocked":"pushed",i||o||(u=(0,l.jsx)(ey.A,{href:(0,eo.bS)({repo:t.repository,base:t.beforeOid,head:t.afterOid}),children:`${a}..${n}`}))):(c="created",!i&&aa(t)&&!o&&(u=(0,l.jsx)(ey.A,{href:(0,eo.bS)({repo:t.repository,head:t.afterOid}),children:n}))):c="deleted",(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:`${c} `}),u&&(0,l.jsxs)(l.Fragment,{children:[u,(0,l.jsx)("span",{children:" "})]}),d&&(0,l.jsx)("span",{children:"from merge queue "}),(u||"pushed"===c)&&!aa(t)&&(0,l.jsx)("span",{children:"to "}),!aa(t)&&(0,l.jsx)(tc.A,{href:(0,eo.PU)({repo:t.repository,branch:s}),children:s}),"organization"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:" in repo "}),(0,l.jsxs)(tc.A,{href:(0,eo.SH)({owner:t.repository.ownerLogin,repo:t.repository.name}),children:[t.repository.ownerLogin!==r&&`${t.repository.ownerLogin}/`,t.repository.name]})]})]})}try{ar.displayName||(ar.displayName="RuleSuiteRow")}catch{}try{as.displayName||(as.displayName="RuleEvaluationLabel")}catch{}try{an.displayName||(an.displayName="ActionText")}catch{}function al(){let{upsellInfo:e,learnMoreUrl:t,source:r}=(0,g.B)();return e?.enterpriseRulesets.cta.visible?(0,l.jsxs)("div",{children:[(0,l.jsx)(E,{heading:"Rule insights"}),(0,l.jsx)(ai,{upsellInfo:e,learnMoreUrl:t,sourceName:r.ownerLogin})]}):(0,l.jsx)(ao,{})}let ai=({upsellInfo:e,learnMoreUrl:t,sourceName:r})=>{let{sendClickAnalyticsEvent:s}=(0,ev.S)(),a="";return a=e?.organization?`/account/enterprises/new/${r}`:"/account/enterprises/new",(0,l.jsx)("div",{className:"border rounded-2 color-bg-premium",children:(0,l.jsxs)("div",{className:"ml-3 d-flex flex-items-center flex-column flex-justify-center my-5",children:[(0,l.jsx)(K.A,{className:"color-fg-muted",icon:O.PulseIcon,size:24}),(0,l.jsx)(ej.A,{as:"h1",sx:{fontSize:4,mt:3,mx:5,textAlign:"center"},children:"See how rulesets are affecting this repository"}),(0,l.jsx)(Q.A,{className:"color-fg-muted mt-3 mx-5",sx:{textAlign:"center"},children:"Enterprise accounts enable you to review commits against rulesets to track pass, fail, or bypass status for greater oversight and understanding."}),e?.enterpriseRulesets.cta.path&&(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsx)(eg.z,{className:"btn-premium",href:a,leadingVisual:()=>(0,l.jsx)(K.A,{icon:O.RocketIcon,className:"color-fg-sponsors"}),onClick:()=>{s({category:"repository-rule-insights",action:"click_rule_insights_upsell",label:"RULE_INSIGHTS_UPSELL_BUTTON"})},children:"Try GitHub Enterprise"})}),(0,l.jsx)(ey.A,{className:"mt-3",href:t,children:"Learn more"})]})})};function ao(){let{source:e,sourceType:t,branchListCacheKey:r,filter:s,rulesets:a,repositories:n,ruleSuiteRuns:i,visibleResults:o,hasMoreSuites:d,readOnly:c,supportedTargets:u}=(0,g.B)(),{navigate:p}=R(),[m,h]=(0,f.useState)({message:"",variant:"default"}),x=(0,f.useRef)(null),{page:j}=s;j=j||1;let v=d?j+1:j,b="repository"===t&&e.isFork,_=(0,f.useMemo)(()=>i.reduce((e,t)=>{let r=new Date(t.createdAt).toDateString();return e[r]||(e[r]=[]),e[r]?.push(t),e},{}),[i]),A=(0,f.useMemo)(()=>a.filter(r=>!eE({type:t,id:e.id},r)),[a,t,e]);return(0,l.jsxs)("div",{children:[(0,l.jsx)(eO.p,{flashAlert:m,setFlashAlert:h,ref:x}),(0,l.jsx)(E,{heading:"Rule insights"}),(0,l.jsx)(sK,{filter:s,source:e,sourceType:t,branchListCacheKey:r,rulesets:A,repositories:n}),i.length>0?(0,l.jsx)(sR.A,{children:Object.keys(_).map(r=>(0,l.jsxs)(sR.A.Item,{condensed:!0,children:[(0,l.jsx)(sR.A.Badge,{children:(0,l.jsx)(K.A,{icon:O.PulseIcon})}),(0,l.jsxs)(sR.A.Body,{children:[(0,l.jsx)("span",{children:"Activity on "}),(0,l.jsx)(sk.A,{datetime:r,precision:"day",threshold:"P0D",prefix:"",year:"numeric"}),(0,l.jsx)(y.A,{className:"ml-n6 ml-sm-0",as:"ol",sx:{display:"flex",flexDirection:"column",borderRadius:2,overflow:"hidden",backgroundColor:"canvas.default",borderColor:"border.default",borderStyle:"solid",borderWidth:1,marginTop:3,color:"fg.default",position:"relative"},children:_[r]?.map(r=>l.jsx(ar,{ruleSuite:r,visibleResult:o[r.id],sourceType:t,sourceName:e.name},r.id))})]})]},r))}):(0,l.jsx)(y.A,{sx:{display:"flex",flexDirection:"column",borderRadius:2,overflow:"hidden",borderColor:"border.default",borderStyle:"solid",borderWidth:1,marginTop:2},children:(0,l.jsx)(sE,{showCreateButton:!c&&!b,setFlashAlert:h,supportedRulesetTargets:u})}),(1!==j||1!==v)&&(0,l.jsx)(sT.A,{pageCount:v,currentPage:j,onPageChange:(e,t)=>{e.preventDefault(),j!==t&&p(".",sF({filter:{...s,page:t}}),!0)},showPages:!1})]})}try{al.displayName||(al.displayName="InsightsPage")}catch{}try{ai.displayName||(ai.displayName="UpsellInsightsBanner")}catch{}try{ao.displayName||(ao.displayName="InsightsPageComponent")}catch{}let ad=()=>{let{navigate:e,resolvePath:t}=R(),{ruleset:r,diffHtml:s,history:a}=(0,g.B)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(y.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:3},children:[(0,l.jsxs)(y.A,{sx:{display:"flex",gap:1,alignItems:"center",fontSize:3},children:[(0,l.jsx)(q.N,{to:t("../../../.."),children:"Rulesets"}),(0,l.jsx)("span",{children:"/"}),(0,l.jsx)(q.N,{to:t("../../.."),children:(0,l.jsx)(Q.A,{sx:{display:"block",maxWidth:200,textOverflow:"ellipsis",overflowX:"hidden",whiteSpace:"nowrap"},children:r.name})}),(0,l.jsx)("span",{children:"/"}),(0,l.jsx)(q.N,{to:t("../.."),children:(0,l.jsx)(Q.A,{sx:{display:"block",maxWidth:200,textOverflow:"ellipsis",overflowX:"hidden",whiteSpace:"nowrap"},children:"History"})}),(0,l.jsx)("span",{children:"/"}),(0,l.jsx)("span",{children:"Compare"})]}),(0,l.jsxs)(y.A,{sx:{display:"flex"},children:[(0,l.jsx)(T.A,{variant:"success",children:"Beta"}),(0,l.jsx)(y.A,{sx:{ml:2},children:(0,l.jsx)(q.N,{to:"https://github.com/orgs/community/discussions/69918",children:"Give feedback"})})]})]}),(0,l.jsx)(y.A,{sx:{display:"flex",flexDirection:"column",border:"1px solid",borderColor:"border.default",borderRadius:6,mb:3},children:(0,l.jsxs)(y.A,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:2,px:3,py:2},children:[(0,l.jsxs)(y.A,{sx:{display:"flex",minWidth:0,fontSize:1,alignItems:"center",width:"max-content",gap:2,flexBasis:0,flexGrow:1},children:[(0,l.jsx)(tJ.r,{sx:{marginRight:2},src:a.updated_by.static_avatar_url}),(0,l.jsx)("span",{children:a.updated_by.display_login}),(0,l.jsxs)(y.A,{sx:{display:"flex",gap:1,color:"fg.muted"},children:[(0,l.jsx)("span",{children:"edited"}),(0,l.jsx)("relative-time",{datetime:a.created_at})]})]}),a.is_current?null:(0,l.jsx)(eg.z,{"aria-label":"Restore ruleset",sx:{alignItems:"center",color:"fg.default",...ac},onClick:async()=>{e("../../..",`history_id_to_restore=${a.id}`)},href:"",variant:"invisible",size:"small",leadingVisual:O.ReplyIcon,children:(0,l.jsx)(Q.A,{sx:{color:"fg.default"},children:"Restore"})})]})}),(0,l.jsx)(y.A,{sx:{display:"flex",flexDirection:"column",border:"1px solid",borderColor:"border.default",borderRadius:6},children:(0,l.jsx)("div",{className:"prose-diff no-level-zero-box-shadow",children:(0,l.jsx)(sQ.oG,{className:"markdown-body",style:{overflow:"auto",fontSize:"85%",lineHeight:1.45,fontFamily:"ui-monospace,SFMono-Regular,SF Mono,Menlo,Consolas,Liberation Mono,monospace"},html:s})})})]})},ac={"&:hover:not([disabled])":{textDecoration:"none"},"&:focus:not([disabled])":{textDecoration:"none"},"&:active:not([disabled])":{textDecoration:"none"}};try{ad.displayName||(ad.displayName="HistoryComparisonPage")}catch{}var au=r(79345),ap=r(53800),am=r(8539),ah=r(69818),ax=r(48077),af=r(30014);let ag=()=>{let{navigate:e,resolvePath:t}=R(),{readOnly:r,ruleset:s,hasMore:a,page:n}=(0,g.B)(),[i,o]=(0,f.useState)({message:"",variant:"default"}),d=(0,f.useRef)(null),c=a?n+1:n,u=a||n>1;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eO.p,{flashAlert:i,setFlashAlert:o,ref:d}),(0,l.jsxs)(y.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:3},children:[(0,l.jsxs)(y.A,{sx:{display:"flex",gap:1,alignItems:"center",fontSize:3},children:[(0,l.jsx)(q.N,{to:t("../.."),children:"Rulesets"}),(0,l.jsx)("span",{children:"/"}),(0,l.jsx)(q.N,{to:t(".."),children:(0,l.jsx)(Q.A,{sx:{display:"block",maxWidth:200,textOverflow:"ellipsis",overflowX:"hidden",whiteSpace:"nowrap"},children:s.name})}),(0,l.jsx)("span",{children:"/"}),(0,l.jsx)("span",{children:"History"})]}),(0,l.jsxs)(y.A,{sx:{display:"flex"},children:[(0,l.jsx)(T.A,{variant:"success",children:"Beta"}),(0,l.jsx)(y.A,{sx:{ml:2},children:(0,l.jsx)(q.N,{to:"https://github.com/orgs/community/discussions/69918",children:"Give feedback"})})]})]}),(0,l.jsx)(A,{children:(s.histories?.length||0)>0?(0,l.jsx)(st.u,{title:"Ruleset history",variant:"compact",children:s.histories?.map(({id:e,created_at:t,updated_by:a,is_current:n},i)=>l.jsxs(af.c,{title:l.jsx(ax.a,{containerSx:{display:"flex",gap:1},value:a.display_login}),secondaryActions:l.jsx(au.L,{staticMenuActions:[{key:"history",render:()=>l.jsx(ay,{rulesetName:s.name,historyId:e,readOnly:r,prevHistoryId:s.histories?.[i+1]?.id||null,canRestore:!n,setFlashAlert:o})}]}),children:[l.jsx(am.B,{children:l.jsx(tJ.r,{sx:{marginRight:2,alignSelf:"center"},src:a.static_avatar_url})}),l.jsx(ah.Q,{children:l.jsxs(ap.U,{children:[l.jsx("span",{children:"edited"}),l.jsx("relative-time",{datetime:t})]})})]},e))}):(0,l.jsx)(v,{heading:"No ruleset history available"})}),u?(0,l.jsx)(sT.A,{pageCount:c,currentPage:n,onPageChange:(t,r)=>{t.preventDefault(),e(".",`page=${r}`,!1)},showPages:!1}):null]})},ay=({rulesetName:e,historyId:t,prevHistoryId:r,readOnly:s=!1,canRestore:a=!0,setFlashAlert:n})=>{let{navigate:i,resolvePath:o}=R();return(0,l.jsxs)(X.l,{children:[(0,l.jsxs)(X.l.Item,{onSelect:()=>r?i(`./${t}/compare`,`compare_history_id=${r}`,!1):i(`./${t}/compare`,void 0,!1),children:[(0,l.jsx)(X.l.LeadingVisual,{children:(0,l.jsx)(O.FileDiffIcon,{size:16})}),"Compare changes",(0,l.jsx)(X.l.Description,{variant:"block",children:"View a diff of these changes"})]}),s?null:(0,l.jsxs)(X.l.Item,{disabled:!a,onSelect:async()=>{i("..",`history_id_to_restore=${t}`)},children:[(0,l.jsx)(X.l.LeadingVisual,{children:(0,l.jsx)(O.ReplyIcon,{size:16})}),"Restore",(0,l.jsx)(X.l.Description,{variant:"block",children:"Restore the ruleset to this version"})]}),(0,l.jsxs)(X.l.LinkItem,{download:`${e}.json`,target:"_self",onClick:async()=>{try{await ee(o(`../export_ruleset/${t}`),e)}catch{n({variant:"danger",message:"Error exporting ruleset"})}},className:"text-decoration-skip",children:[(0,l.jsx)(X.l.LeadingVisual,{children:(0,l.jsx)(O.DownloadIcon,{size:16})}),"Download",(0,l.jsx)(X.l.Description,{variant:"block",children:"Download raw file"})]})]})};try{ag.displayName||(ag.displayName="HistorySummaryPage")}catch{}try{ay.displayName||(ay.displayName="HistoryActionMenu")}catch{}var aj=r(79840),av=r(86233);let ab=[(0,av.a)({path:"/:owner/:repo/settings/rules",Component:e$}),(0,av.a)({path:"/:owner/:repo/settings/rules/insights",Component:al}),(0,av.a)({path:"/:owner/:repo/settings/rules/:rulesetId",Component:sC}),(0,av.a)({path:"/:owner/:repo/settings/rules/:rulesetId/history/:historyId/compare/*",Component:ad}),(0,av.a)({path:"/:owner/:repo/settings/rules/:rulesetId/history",Component:ag}),(0,av.a)({path:"/:owner/:repo/settings/rules/:rulesetId/history/:historyId/view",Component:sC}),(0,av.a)({path:"/:owner/:repo/rules",Component:e$}),(0,av.a)({path:"/:owner/:repo/rules/:rulesetId",Component:sC}),(0,av.a)({path:"/:owner/:repo/rules/:rulesetId/history",Component:ag})],a_=[(0,av.a)({path:"/stafftools/repositories/:owner/:repo/repository_rules",Component:e$}),(0,av.a)({path:"/stafftools/repositories/:owner/:repo/repository_rules/insights",Component:al}),(0,av.a)({path:"/stafftools/repositories/:owner/:repo/repository_rules/:rulesetId",Component:sC}),(0,av.a)({path:"/stafftools/repositories/:owner/:repo/repository_rules/:rulesetId/history/:historyId/compare/*",Component:ad}),(0,av.a)({path:"/stafftools/repositories/:owner/:repo/repository_rules/:rulesetId/history",Component:ag}),(0,av.a)({path:"/stafftools/users/:organizationId/organization_rules",Component:e$}),(0,av.a)({path:"/stafftools/users/:organizationId/organization_rules/insights",Component:al}),(0,av.a)({path:"/stafftools/users/:organizationId/organization_rules/:rulesetId",Component:sC}),(0,av.a)({path:"/stafftools/users/:organizationId/organization_rules/:rulesetId/history/:historyId/compare/*",Component:ad}),(0,av.a)({path:"/stafftools/users/:organizationId/organization_rules/:rulesetId/history",Component:ag})],aA=[(0,av.a)({path:"/organizations/:org/settings/member_privilege_rules",Component:e$}),(0,av.a)({path:"/organizations/:org/settings/member_privilege_rules/:rulesetId",Component:sC}),(0,av.a)({path:"/enterprises/:enterprise/settings/policies/repositories",Component:e$}),(0,av.a)({path:"/enterprises/:enterprise/settings/policies/repositories/:rulesetId",Component:sC})];(0,aj.Q)("repos-rules",()=>({App:m,routes:[...ab,...a_,...aA]}))},71312:(e,t,r)=>{r.d(t,{S:()=>i,s:()=>l});var s=r(55293),a=r(51848),n=r(31481);function l(){let e=(0,s.useContext)(n.I);if(!e)throw Error("useAnalytics must be used within an AnalyticsContext");let{appName:t,category:r,metadata:l}=e;return{sendAnalyticsEvent:(0,s.useCallback)((e,s,n={})=>{let i={react:!0,app_name:t,category:r,...l};(0,a.BI)(e,{...i,...n,target:s})},[t,r,l])}}function i(){let{sendAnalyticsEvent:e}=l();return{sendClickAnalyticsEvent:(0,s.useCallback)((t={})=>{e("analytics.click",void 0,t)},[e])}}},6664:(e,t,r)=>{r.d(t,{AR:()=>s,_N:()=>l});var s,a=r(51012),n=r(55293);!function(e){e.ctrlKey="ctrlKey",e.altKey="altKey",e.shiftKey="shiftKey",e.metaKey="metaKey"}(s||(s={}));let l=(e,t,r)=>{let l=(0,n.useRef)(t);(0,a.N)(()=>{l.current=t});let i=(0,n.useCallback)(t=>{!([...document.querySelectorAll('#__primerPortalRoot__, [id$="-portal-root"]')].some(function e(t){if(t.clientHeight>0)return!0;for(let r of t.children)if(e(r))return!0;return!1})&&!r?.triggerWhenPortalIsActive||!function(e,t){for(let r of Object.values(s))if(t&&t[r]&&!e[r]||e[r]&&(!t||!t[r]))return!1;return!0}(t,r)&&!r?.ignoreModifierKeys||!r?.triggerWhenInputElementHasFocus&&function(e){return e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLInputElement}(t))&&e.some(e=>/^\d$/.test(e)?t.code===`Digit${e}`:"/"===e?"Slash"===t.code:t.key===e)&&l.current(t)},[e,r]);(0,n.useEffect)(()=>{let e=r?.scopeRef?.current||document;return e.addEventListener("keydown",i),()=>e.removeEventListener("keydown",i)},[i,r?.scopeRef])}},52876:(e,t,r)=>{r.d(t,{T:()=>j});var s=r(9449),a=r(22868),n=r(59857),l=r(281),i=r(75177),o=r(30729),d=r(17909),c=r(44981),u=r(38553),p=r(65481),m=r(55293),h=r(76024);let x=m.memo(function({user:e,isCurrent:t,onSelect:r}){return(0,s.jsxs)(d.l.Item,{selected:t,onSelect:()=>{r&&r(e)},children:[(0,s.jsx)(d.l.LeadingVisual,{children:(0,s.jsx)(a.r,{src:e.primaryAvatarUrl,square:e.path.startsWith("/apps/")})}),e.login,(0,s.jsx)(d.l.Description,{children:e.name})]})});try{x.displayName||(x.displayName="UserItem")}catch{}function f(e){return e.users.length>20?(0,s.jsx)(y,{...e}):(0,s.jsx)(g,{...e})}function g({users:e,currentUser:t,onSelect:r,sx:a={}}){return(0,s.jsx)(i.A,{sx:{maxHeight:330,overflowY:"auto",...a},children:e.map(e=>(0,s.jsx)(x,{user:e,isCurrent:e.login===t?.login,onSelect:r},e.login))})}function y({users:e,currentUser:t,onSelect:r,sx:a={}}){return(0,s.jsx)(h.F,{items:e,itemHeight:33,sx:{maxHeight:330,overflowY:"auto",...a},makeKey:e=>e.login,renderItem:e=>(0,s.jsx)(x,{user:e,isCurrent:e.login===t?.login,onSelect:r},e.login)})}try{f.displayName||(f.displayName="UsersList")}catch{}try{g.displayName||(g.displayName="FullUsersList")}catch{}try{y.displayName||(y.displayName="VirtualUsersList")}catch{}function j(e){let{defaultText:t,usersState:r,currentUser:c,onSelect:u,hotKey:p,onOpenChange:h,renderCustomFooter:x,size:g,showTypedInUser:y=!1,width:j="large",label:N=""}=e,[w,S]=(0,m.useState)(""),C=function(e,t){if(!e)return[];let r=t.trim().toLowerCase();return r?e.filter(e=>e.login.toLowerCase().includes(r)||e.name?.toLowerCase().includes(r)):e}(r.users,w);return(0,s.jsx)("div",{children:(0,s.jsxs)(l.W,{onOpenChange:h,children:[(0,s.jsx)(l.W.Button,{"data-hotkey":p,size:g,"data-testid":"user-selector-button",children:(0,s.jsxs)(i.A,{sx:{display:"flex"},children:[(0,s.jsx)(i.A,{sx:{mr:2},children:c?(0,s.jsx)(a.r,{size:16,src:c.primaryAvatarUrl,square:c.path.startsWith("/apps/")}):(0,s.jsx)(o.A,{icon:n.PeopleIcon,size:"small",sx:{color:"fg.muted"}})}),(0,s.jsx)(i.A,{sx:{maxWidth:125,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:c?(0,s.jsxs)("span",{children:[N,c.login]}):(0,s.jsx)("span",{children:t})})]})}),(0,s.jsx)(l.W.Overlay,{width:j,children:(0,s.jsxs)(d.l,{showDividers:!0,selectionVariant:"single",children:[(0,s.jsx)(v,{defaultText:w,onFilterChange:S}),(0,s.jsx)(d.l.Divider,{}),r.loading?(0,s.jsx)(b,{}):r.error?(0,s.jsx)(_,{}):0===C.length?(0,s.jsx)(A,{showTypedInUser:y,filterText:w,onSelect:u}):(0,s.jsx)(f,{users:C,currentUser:c,onSelect:u,sx:x?{pb:"10px",pt:1}:{pt:1}}),x&&(0,s.jsx)(d.l.Divider,{sx:{marginTop:0}}),x?.()]})})]})})}function v({onFilterChange:e,defaultText:t}){return(0,s.jsx)(d.l.Group,{sx:{px:2},children:(0,s.jsx)(c.A,{leadingVisual:n.SearchIcon,value:t,sx:{width:"100%"},placeholder:"Find a user...",onChange:t=>e(t.target.value)})})}function b(){return(0,s.jsx)(i.A,{sx:{display:"flex",justifyContent:"center",p:2},children:(0,s.jsx)(u.A,{size:"medium","aria-label":"Loading users..."})})}function _(){return(0,s.jsx)(p.A,{variant:"danger",children:"Could not load users"})}function A({showTypedInUser:e,filterText:t,onSelect:r}){return e?(0,s.jsx)(d.l.Item,{sx:{display:"flex",justifyContent:"center",mb:2},onSelect:()=>{r&&r({login:t,name:t,path:"",primaryAvatarUrl:""})},children:(0,s.jsxs)(s.Fragment,{children:["Filter on author\xa0",(0,s.jsx)(i.A,{as:"span",sx:{fontWeight:600},children:t})]})}):(0,s.jsx)(i.A,{sx:{p:3,display:"flex",justifyContent:"center"},children:"Nothing to show"})}try{j.displayName||(j.displayName="UserSelector")}catch{}try{v.displayName||(v.displayName="UserFilter")}catch{}try{b.displayName||(b.displayName="Loading")}catch{}try{_.displayName||(_.displayName="LoadingFailed")}catch{}try{A.displayName||(A.displayName="UsersZeroState")}catch{}},25995:(e,t,r)=>{r.d(t,{$:()=>l});var s=r(9449),a=r(281),n=r(17909);function l({buttonProps:e,overlayProps:t,actionListProps:r,currentSelection:l,orderedValues:i,displayValues:o,onSelect:d}){return(0,s.jsxs)(a.W,{children:[(0,s.jsx)(a.W.Button,{size:"medium",...e,children:o[l]}),(0,s.jsx)(a.W.Overlay,{width:"medium",...t,children:(0,s.jsx)(n.l,{selectionVariant:"single",...r,children:i.map(e=>(0,s.jsx)(n.l.Item,{selected:e===l,onSelect:()=>{d(e)},children:o[e]},e))})})]})}try{l.displayName||(l.displayName="ActionMenuSelector")}catch{}},38170:(e,t,r)=>{r.d(t,{C:()=>o});var s=r(9449),a=r(59857),n=r(25995);let l=["hour","day","week","month"],i={hour:"Last hour",day:"Last 24 hours",week:"Last week",month:"Last month"};function o({currentTimePeriod:e,onSelect:t}){return(0,s.jsx)(n.$,{buttonProps:{leadingVisual:a.ClockIcon},currentSelection:e,orderedValues:l,displayValues:i,onSelect:t})}try{o.displayName||(o.displayName="TimeFilter")}catch{}},96238:(e,t,r)=>{r.d(t,{V:()=>n,o:()=>a});var s=r(9449);let a=({actorType:e})=>"RepositoryRole"===e||"OrganizationAdmin"===e?(0,s.jsx)("span",{className:"note ml-2",children:"Role"}):"Integration"===e?(0,s.jsx)("span",{className:"note ml-2",children:"App"}):"DeployKey"===e?null:"EnterpriseTeam"===e?(0,s.jsx)("span",{className:"note ml-2",children:"Enterprise team"}):"EnterpriseOwner"===e?(0,s.jsx)("span",{className:"note ml-2",children:"Role"}):(0,s.jsx)("span",{className:"note ml-2",children:e});function n(e){switch(e){case"RepositoryRole":case"OrganizationAdmin":case"EnterpriseOwner":return"Role";case"Integration":return"App";case"DeployKey":return"";case"EnterpriseTeam":return"Enterprise team";default:return e}}},58762:(e,t,r)=>{r.d(t,{u:()=>o});var s=r(9449),a=r(22868),n=r(30729),l=r(59857);let i={Write:l.PencilIcon,Maintain:l.ToolsIcon,"Repository admin":l.EyeIcon,"Organization admin":l.EyeIcon},o=({baseUrl:e,id:t,type:r,name:o,size:d=16})=>"Team"===r?(0,s.jsx)(a.r,{alt:o,src:`${e}/t/${t}`,size:d}):"Integration"===r?(0,s.jsx)(a.r,{alt:o,src:`${e}/in/${t}`,size:d}):"RepositoryRole"===r||"OrganizationAdmin"===r?(0,s.jsx)(n.A,{icon:i[o]||l.PersonIcon,sx:{color:"fg.muted"}}):"DeployKey"===r?(0,s.jsx)(n.A,{icon:l.KeyIcon,sx:{color:"fg.muted"}}):"EnterpriseTeam"===r||"EnterpriseOwner"===r?(0,s.jsx)(n.A,{icon:l.PeopleIcon,sx:{color:"fg.muted"}}):null},30386:(e,t,r)=>{r.d(t,{p:()=>I});var s,a=r(9449),n=r(55293),l=r(86079),i=r(94407),o=r(70170),d=r(30366),c=r(18536),u=r(75177),p=r(19797),m=r(66889),h=r(47553),x=r(30631),f=r(69909),g=r(58762),y=r(96238),j=r(73209);function v({actorId:e,actorType:t,name:r,owner:s,selected:l,setSelected:i,baseAvatarUrl:o,enabledBypassActors:d}){let p=l.some(r=>r.actorId===e&&r.actorType===t);return(0,a.jsxs)(m.A,{children:[(0,a.jsx)(h.A,{"data-testid":"bypass-dialog-checkbox",value:"actorId",checked:p||(0,j.J)(e,t,d),onChange:()=>{if(p){let r=l.findIndex(r=>r?.actorId===e&&r?.actorType===t);r>-1&&i([...l.slice(0,r),...l.slice(r+1)])}else i([...l,{actorId:e,actorType:t,name:r,_enabled:!0,_dirty:!0,bypassMode:c.v.ALWAYS,owner:s}])}}),(0,a.jsx)(m.A.LeadingVisual,{children:(0,a.jsx)(g.u,{baseUrl:o,id:e,name:r,type:t})}),(0,a.jsx)(m.A.Label,{children:(0,a.jsxs)(u.A,{sx:{display:"flex",alignItems:"center",fontWeight:"normal"},children:[(0,a.jsx)(x.A,{title:r,maxWidth:250,children:(0,a.jsx)(f.A,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:r})}),(0,a.jsx)(y.o,{actorType:t}),"Team"===t?(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)(f.A,{className:"note",sx:{marginLeft:1,marginRight:1},children:"\u2022"}),(0,a.jsx)(x.A,{title:`@${r}`,maxWidth:250,children:(0,a.jsx)(f.A,{className:"note",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:`@${r}`})})]}):null,"Integration"===t&&s?(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)(f.A,{className:"note",sx:{marginLeft:1,marginRight:1},children:"\u2022"}),(0,a.jsx)(x.A,{title:s,maxWidth:250,children:(0,a.jsx)(f.A,{className:"note",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:s})})]}):null]})})]})}try{v.displayName||(v.displayName="BypassDialogRow")}catch{}function b({suggestions:e,selected:t,setSelected:r,baseAvatarUrl:s,enabledBypassActors:n}){let l=e.filter(e=>!(0,j.J)(e.actorId,e.actorType,n));return(0,a.jsx)(u.A,{sx:{height:175},children:l.length>0?(0,a.jsx)(p.A,{"aria-labelledby":"suggestionsHeading",sx:{paddingBottom:4},children:(0,a.jsx)("ul",{className:"list-style-none",children:l.map(e=>(0,a.jsx)("li",{children:(0,a.jsx)(v,{actorId:e.actorId,actorType:e.actorType,name:e.name,owner:e.owner,selected:t,setSelected:r,baseAvatarUrl:s,enabledBypassActors:n})},`${e.actorId}-${e.actorType}`))})}):(0,a.jsx)(u.A,{sx:{py:"6%"},children:(0,a.jsx)(u.A,{sx:{textAlign:"center"},children:(0,a.jsx)(i.A,{children:(0,a.jsx)(i.A.Heading,{as:"h3",children:"No suggestions"})})})})})}try{b.displayName||(b.displayName="BypassDialogBody")}catch{}var _=r(87330),A=r(44981),N=r(59857),w=r(78680);function S({onClose:e,bypassListFilter:t,setBypassListFilter:r,dialogLabelId:s,flashAlert:i,setFlashAlert:o,addReviewerSubtitle:d}){let c=(0,n.useRef)(null);return(0,n.useEffect)(()=>{c.current?.focus()},[i,c]),(0,a.jsxs)(n.Fragment,{children:[(0,a.jsxs)(u.A,{sx:{padding:3,display:"flex",flexDirection:"column"},children:[(0,a.jsx)(w.p,{flashAlert:i,setFlashAlert:o,ref:c}),(0,a.jsxs)(u.A,{sx:{display:"flex",alignItems:"center"},children:[(0,a.jsx)(l.l.Title,{id:s,sx:{fontWeight:"bold",flex:1},children:"Add bypass"}),(0,a.jsx)(_.K,{variant:"invisible","aria-label":"Close Dialog",icon:N.XIcon,onClick:e})]}),(0,a.jsx)(f.A,{sx:{fontWeight:"normal",color:"fg.subtle"},children:d}),(0,a.jsxs)(m.A,{sx:{marginTop:1},children:[(0,a.jsx)(m.A.Label,{visuallyHidden:!0,children:"Search for bypass actors"}),(0,a.jsx)(A.A,{block:!1,sx:{width:"100%",fontWeight:"normal"},leadingVisual:N.SearchIcon,placeholder:"Search",onChange:e=>r(e.target.value),value:t})]})]}),(0,a.jsx)(u.A,{className:"color-bg-subtle color-border-default",sx:{display:"flex",paddingLeft:3,paddingTop:1,paddingBottom:1,borderTopWidth:1,borderBottomWidth:1,borderLeftWidth:0,borderRightWidth:0,borderStyle:"solid"},children:(0,a.jsx)(f.A,{id:"suggestionsHeading",className:"text-small",sx:{fontWeight:"bold",color:"fg.muted"},children:"Suggestions"})})]})}try{S.displayName||(S.displayName="BypassDialogHeader")}catch{}var C=r(15820);let I=({onClose:e,baseAvatarUrl:t,enabledBypassActors:r,addBypassActor:s,initialSuggestions:h,suggestionsUrl:x,addReviewerSubtitle:g})=>{let[y,_]=(0,n.useState)(""),[I,R]=(0,n.useState)(h),[k,T]=(0,n.useState)([]),[E,O]=(0,n.useState)({message:"",variant:"default"}),$=(0,n.useCallback)((0,o.s)(async e=>{if(""===e)R(h);else try{let t=await (0,d.K)(x,e);R(t)}catch(e){O({variant:"danger",message:"Failed to fetch suggestions"})}},200),[x,R]);(0,n.useEffect)(()=>{$(y)},[y,$]);let L=[{content:"Cancel",onClick:e,buttonType:"normal"},{content:"Add selected",onClick:()=>{for(let e of k){if(r.some(({actorId:t,actorType:r})=>t===e.actorId&&r===e.actorType)){O({variant:"danger",message:"Actor is already added"});return}"Organization admin"!==e.actorId&&s(e.actorId,e.actorType,e.name,c.v.ALWAYS,e.owner)}e()},buttonType:"primary"}],B=(0,n.useRef)(null);(0,n.useEffect)(()=>{B.current?.focus()},[E,B]);let z=I.filter(e=>!(0,j.J)(e.actorId,e.actorType,r));return(0,C.u)("a11y_add_bypass_dialog")?(0,a.jsx)(l.l,{title:"Add bypass",height:"auto",width:"xlarge",footerButtons:L,onClose:e,children:(0,a.jsxs)(l.l.Body,{sx:{padding:0},children:[(0,a.jsxs)(u.A,{sx:{marginBottom:3,display:"flex",flexDirection:"column"},children:[(0,a.jsx)(w.p,{flashAlert:E,setFlashAlert:O,ref:B}),(0,a.jsxs)(m.A,{sx:{marginTop:1},children:[(0,a.jsx)(m.A.Label,{sx:{fontWeight:"normal"},children:g}),(0,a.jsx)(A.A,{block:!1,sx:{width:"100%",fontWeight:"normal"},leadingVisual:N.SearchIcon,placeholder:"Search",onChange:e=>_(e.target.value),value:y})]})]}),(0,a.jsx)(u.A,{sx:{display:"flex",marginBottom:1},children:(0,a.jsx)(f.A,{id:"suggestionsHeading",sx:{fontWeight:"semibold"},children:"Suggestions"})}),(0,a.jsx)(u.A,{sx:{height:175},children:z.length>0?(0,a.jsx)(p.A,{"aria-labelledby":"suggestionsHeading",sx:{paddingBottom:4},children:z.map(e=>(0,a.jsx)(v,{actorId:e.actorId,actorType:e.actorType,name:e.name,owner:e.owner,selected:k,setSelected:T,baseAvatarUrl:t,enabledBypassActors:r},`${e.actorId}-${e.actorType}`))}):(0,a.jsx)(i.A,{children:(0,a.jsx)(i.A.Heading,{children:"No suggestions"})})})]})}):(0,a.jsx)(l.l,{renderHeader:({dialogLabelId:t})=>(0,a.jsx)(S,{onClose:e,bypassListFilter:y,setBypassListFilter:_,dialogLabelId:t,flashAlert:E,setFlashAlert:O,addReviewerSubtitle:g}),height:"auto",width:"xlarge",footerButtons:L,onClose:e,children:(0,a.jsx)(b,{suggestions:I,selected:k,setSelected:T,baseAvatarUrl:t,enabledBypassActors:r})})};try{I.displayName||(I.displayName="BypassDialog")}catch{}try{(s=DialogHeader).displayName||(s.displayName="DialogHeader")}catch{}},89504:(e,t,r)=>{r.d(t,{d:()=>l,t:()=>i});var s=r(9449),a=r(55293);let n=a.createContext({});function l({repository:e,children:t}){return(0,s.jsxs)(n.Provider,{value:e,children:[" ",t," "]})}function i(){return a.useContext(n)}try{n.displayName||(n.displayName="CurrentRepositoryContext")}catch{}try{l.displayName||(l.displayName="CurrentRepositoryProvider")}catch{}},35625:(e,t,r)=>{r.d(t,{O:()=>m});var s=r(9449),a=r(6664),n=r(67269),l=r(55293),i=r(1093),o=r(47555),d=r(94276),c=r(57832),u=r(90600),p=r(15820);function m({items:e,initialSelectedItems:t,openHotkey:r,placeholderText:m,selectionVariant:h,loading:x,groups:f,filterItems:g,renderAnchor:y,getItemKey:j,convertToItemProps:v,onSelectionChange:b,onOpen:_,onClose:A,height:N="small",width:w="small",selectPanelRef:S,enforceAtleastOneSelected:C,insidePortal:I,maxVisibleItems:R=9,nested:k=!1,resultListAriaLabel:T,title:E,subtitle:O,preventClose:$,triggerOpen:L,initialFilter:B,customNoResultsItem:z,customNoMatchItem:P,footer:D,keybindingCommandId:F}){let[M,V]=(0,l.useState)(L??!1),[W,U]=(0,l.useState)([]),[G,H]=(0,l.useState)(B??""),{updateOpenState:q,anyItemPickerOpen:K}=(0,i.t)(),Q=(0,l.useId)();(0,l.useEffect)(()=>{void 0!==L&&V(L)},[L]);let{issues_react_ui_commands_migration:J}=(0,p.h)(),Y=(0,l.useCallback)(()=>{K()||M||(V(!0),_&&_())},[K,M,_]),X=(0,l.useCallback)(e=>{K()||M||(e.preventDefault(),e.stopPropagation(),V(!0),_&&_())},[K,M,_]);(0,a._N)(r?[r]:[],X,{triggerWhenInputElementHasFocus:!1,triggerWhenPortalIsActive:I||!1}),(0,l.useEffect)(()=>{q(Q,M)},[Q,M,q]);let Z=(0,l.useMemo)(()=>new Map,[Q,t]),ee=(0,l.useCallback)((e,t)=>{let r=j(e),s=Z.get(r);if(s)return s;(s=v(e)).selected=t;let a=s.onAction;return s.onAction=(t,s)=>{let n=Z.get(r);if(n){if(n.selected=!n.selected,"single"===h&&e.id!==G)for(let[,e]of Z)e!==n&&(e.selected=!1);a&&a(t,s)}},Z.set(r,s),s},[v,G,j,Z,h]),et=(0,l.useCallback)(e=>"string"==typeof e?e:j(e),[j]),er=(0,l.useMemo)(()=>{let r=e.map(e=>e.__isNew__?(delete e.__isNew__,P&&Z.delete(j(P)),ee(e,!0)):ee(e,t.some(t=>et(t)===j(e))));return 0===r.length?P?[ee(P,!1)]:G?[P??o.Q3]:[z??o.v8]:r},[P,e,Z,ee,t,et,j,G,z]);(0,l.useEffect)(()=>{U(er.filter(e=>e.selected))},[er]);let es=(0,l.useMemo)(()=>"single"===h?W[0]:W,[W,h]),ea=(0,l.useCallback)(e=>{if(void 0===e){C||U([]);return}U((Array.isArray(e)?e:[e]).map(e=>er.find(t=>e.id===t.id)).filter(e=>void 0!==e))},[C,er]);(0,a._N)([" "],e=>{if(M){let t=document.querySelector(c.Z.activePickerOption(d.B.itemPickerRootId));if(t){let r=t.getAttribute("data-id"),s=[...Z.values()].find(e=>e.id===r);s&&(e.preventDefault(),e.stopPropagation(),s.selected=!s.selected,U([...Z.values()].filter(e=>e.selected)))}}},{triggerWhenInputElementHasFocus:!0,triggerWhenPortalIsActive:!0});let en=(0,l.useCallback)(e=>{if($&&!e)return;if(V(e),e&&_){_();return}H(""),A&&A();let r=[...Z.values()].filter(e=>e.selected).map(e=>e.source);(r.length!==t.length||r.some(e=>!t.some(t=>et(t)===j(e))))&&b(r)},[$,A,Z,t,_,et,j,b]);(0,l.useEffect)(()=>{g(G)},[G,g]);let el=er.length>0;1===er.length&&(er[0].id===o.Q3.id||er[0].id===o.v8.id)&&(el=!1);let ei=(0,l.useMemo)(()=>f&&f?.length>1&&el?{groupMetadata:f}:{},[f,el]),eo=er.length<=R?"auto":N,ed=(0,l.useMemo)(()=>({renderAnchor:y,placeholderText:m,open:M,onOpenChange:en,loading:x,items:er,selected:es,onSelectedChange:ea,filterValue:G,onFilterChange:H,showItemDividers:!0,overlayProps:{width:w,height:eo},...ei,"aria-label":T,"data-id":d.B.itemPickerRootId,"data-testid":d.B.itemPickerTestId,title:E,subtitle:O,footer:D}),[y,m,M,en,x,er,es,ea,G,w,eo,ei,T,E,O,D]);return(0,s.jsxs)(s.Fragment,{children:[J&&F&&(0,s.jsx)(u.ak,{commands:{[F]:Y}}),(0,s.jsx)(n.X,{anchorRef:k?void 0:S,...ed})]})}try{m.displayName||(m.displayName="ItemPicker")}catch{}},1093:(e,t,r)=>{r.d(t,{D:()=>l,t:()=>i});var s=r(9449),a=r(55293);let n=(0,a.createContext)({updateOpenState:()=>void 0,anyItemPickerOpen:()=>!1});function l({children:e}){let t=(0,a.useRef)({}),r=(0,a.useCallback)((e,r)=>{let s=t.current;return s[e]===r||(t.current={...s,[e]:r}),t.current},[]),l=(0,a.useCallback)(()=>Object.values(t.current).some(e=>e),[t]),i=(0,a.useMemo)(()=>({updateOpenState:r,anyItemPickerOpen:l}),[l,r]);return(0,s.jsx)(n.Provider,{value:i,children:e})}function i(){let e=(0,a.useContext)(n);if(!e)throw Error("useItemPickersContext must be used within a ItemPickersContextProvider.");return e}try{n.displayName||(n.displayName="ItemPickersContext")}catch{}try{l.displayName||(l.displayName="ItemPickersContextProvider")}catch{}},10056:(e,t,r)=>{r.d(t,{P:()=>c,w:()=>u});var s=r(9449),a=r(55293),n=r(59857),l=r(30631),i=r(55847),o=r(70170),d=r(35625);function c({currentSelection:e,repositoryLoader:t,onSelect:r,selectionVariant:c,selectAllOption:u,additionalButtonProps:p,buttonText:m=""}){let[h,x]=(0,a.useState)(""),[f,g]=(0,a.useState)([]),[y,j]=(0,a.useState)(!0),v=(0,a.useCallback)((0,o.s)(async e=>{try{let r=await t(e);g(r)}catch(e){}j(!1)},200),[t,g,j]);(0,a.useEffect)(()=>{j(!0),v(h)},[h,v,j]);let b=(0,a.useCallback)(e=>{"single"===c?!e[0]||e[0]._all?r(void 0):r(e[0]):r(e)},[c,r]),_=(0,a.useMemo)(()=>"multiple"===c?e||[]:e?[e]:[],[c,e]),A=(0,a.useCallback)(e=>{let t;return(e.name.length>24&&(t=`${e.name.substring(0,24)}...`),e._all)?{id:e.name,text:"All repositories",source:e,groupId:"all"}:{id:e.name,text:t||e.name,source:e,appendOnly:!1,groupId:"select",disabled:!1===e.enabled,leadingVisual:()=>e.private?(0,s.jsx)(n.RepoLockedIcon,{size:16}):(0,s.jsx)(n.RepoIcon,{size:16})}},[]),N=(0,a.useCallback)(e=>e.name,[]),w=(0,a.useMemo)(()=>{let e=[];e.push(...f);let t=_.filter(t=>e.every(e=>e.name!==t.name))||[];return e.push(...t),u&&e.push({name:"$all$",_all:!0}),e},[f,u,_]),S=m,C=n.RepoIcon;return S||("multiple"===c?S=_.length>0?`${_.length} repositor${_.length>1?"ies":"y"}`:"Select repositories":_.length>0&&_[0]?(S=_[0].name,C=_[0].private?n.RepoLockedIcon:n.RepoIcon):S=u?"All repositories":"Select a repository"),(0,s.jsx)(d.O,{renderAnchor:({"aria-labelledby":e,...t})=>(0,s.jsx)(i.Q,{leadingVisual:C,trailingAction:n.TriangleDownIcon,"aria-labelledby":` ${e}`,...t,...p,children:(0,s.jsx)(l.A,{title:S,maxWidth:195,children:S})}),placeholderText:"Repos",items:w,loading:y,groups:u?[{groupId:"all"},{groupId:"select"}]:[],selectionVariant:c,initialSelectedItems:_,onSelectionChange:b,filterItems:x,getItemKey:N,convertToItemProps:A})}function u(e){return async t=>{let r=t.trim().toLowerCase();return r?e.filter(e=>e.name.toLowerCase().includes(r)||e.name.toLowerCase().includes(r)):e}}try{c.displayName||(c.displayName="ReposSelector")}catch{}},42024:(e,t,r)=>{r.d(t,{Gy:()=>s,LB:()=>c,lm:()=>d,nn:()=>u});var s,a=r(9449),n=r(70170),l=r(55293);!function(e){e[e.small=1]="small",e[e.medium=544]="medium",e[e.large=768]="large",e[e.xlarge=1012]="xlarge",e[e.xxlarge=1280]="xxlarge",e[e.xxxlarge=1350]="xxxlarge",e[e.xxxxlarge=1440]="xxxxlarge"}(s||(s={}));let i=[1440,1350,1280,1012,768,544,1],o=l.createContext({screenSize:1});function d(){return l.useContext(o)}function c({children:e,initialValue:t}){let r=(0,l.useSyncExternalStore)(()=>()=>{},()=>t??u(window.innerWidth),()=>t??1),s=(0,l.useRef)(r),[i,d]=(0,l.useState)(r),c=(0,l.useCallback)(()=>{let e=u(window.innerWidth);s.current!==e&&(s.current=e,d(e))},[]);(0,l.useEffect)(()=>{let e=new ResizeObserver((0,n.s)(c));return e.observe(document.documentElement),()=>e.disconnect()},[c]);let p=(0,l.useMemo)(()=>({screenSize:i}),[i]);return(0,a.jsx)(o.Provider,{value:p,children:e})}function u(e){for(let t of i)if(e>=t)return t;return 1}try{o.displayName||(o.displayName="ScreenContext")}catch{}try{c.displayName||(c.displayName="ScreenSizeProvider")}catch{}},35822:(e,t,r)=>{r.d(t,{v:()=>h,z:()=>x});var s,a=r(55293);function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}var l=["bottom","height","left","right","top","width"],i=new Map,o=function e(){var t=[];i.forEach(function(e,r){var s,a,n=r.getBoundingClientRect();s=n,a=e.rect,void 0===s&&(s={}),void 0===a&&(a={}),l.some(function(e){return s[e]!==a[e]})&&(e.rect=n,t.push(e))}),t.forEach(function(e){e.callbacks.forEach(function(t){return t(e.rect)})}),s=window.requestAnimationFrame(e)},d="undefined"!=typeof window?a.useLayoutEffect:a.useEffect;function c(e,t){var r=t.rect;return e.height!==r.height||e.width!==r.width?r:e}var u=function(){return 50},p=function(e){return e},m=function(e,t){return e[t?"offsetWidth":"offsetHeight"]},h=function(e){for(var t=Math.max(e.start-e.overscan,0),r=Math.min(e.end+e.overscan,e.size-1),s=[],a=t;a<=r;a++)s.push(a);return s};function x(e){var t,r=e.size,l=void 0===r?0:r,x=e.estimateSize,g=void 0===x?u:x,y=e.overscan,j=void 0===y?1:y,v=e.paddingStart,b=void 0===v?0:v,_=e.paddingEnd,A=e.parentRef,N=e.horizontal,w=e.scrollToFn,S=e.useObserver,C=e.initialRect,I=e.onScrollElement,R=e.scrollOffsetFn,k=e.keyExtractor,T=void 0===k?p:k,E=e.measureSize,O=void 0===E?m:E,$=e.rangeExtractor,L=void 0===$?h:$,B=N?"width":"height",z=N?"scrollLeft":"scrollTop",P=a.useRef({scrollOffset:0,measurements:[]}),D=a.useState(0),F=D[0],M=D[1];P.current.scrollOffset=F;var V=(S||function(e,t){void 0===t&&(t={width:0,height:0});var r=a.useState(e.current),n=r[0],l=r[1],u=a.useReducer(c,t),p=u[0],m=u[1],h=a.useRef(!1);return d(function(){e.current!==n&&l(e.current)}),d(function(){n&&!h.current&&(h.current=!0,m({rect:n.getBoundingClientRect()}))},[n]),a.useEffect(function(){if(n){var e,t=(e=function(e){m({rect:e})},{observe:function(){var t=0===i.size;i.has(n)?i.get(n).callbacks.push(e):i.set(n,{rect:void 0,hasRectChanged:!1,callbacks:[e]}),t&&o()},unobserve:function(){var t=i.get(n);if(t){var r=t.callbacks.indexOf(e);r>=0&&t.callbacks.splice(r,1),t.callbacks.length||i.delete(n),i.size||cancelAnimationFrame(s)}}});return t.observe(),function(){t.unobserve()}}},[n]),p})(A,C)[B];P.current.outerSize=V;var W=a.useCallback(function(e){A.current&&(A.current[z]=e)},[A,z]),U=w||W;w=a.useCallback(function(e){U(e,W)},[W,U]);var G=a.useState({}),H=G[0],q=G[1],K=a.useCallback(function(){return q({})},[]),Q=a.useRef([]),J=a.useMemo(function(){var e=Q.current.length>0?Math.min.apply(Math,Q.current):0;Q.current=[];for(var t=P.current.measurements.slice(0,e),r=e;r<l;r++){var s=T(r),a=H[s],n=t[r-1]?t[r-1].end:b,i="number"==typeof a?a:g(r),o=n+i;t[r]={index:r,start:n,size:i,end:o,key:s}}return t},[g,H,b,l,T]),Y=((null==(t=J[l-1])?void 0:t.end)||b)+(void 0===_?0:_);P.current.measurements=J,P.current.totalSize=Y;var X=I?I.current:A.current,Z=a.useRef(R);Z.current=R,d(function(){if(!X){M(0);return}var e=function(e){M(Z.current?Z.current(e):X[z])};return e(),X.addEventListener("scroll",e,{capture:!1,passive:!0}),function(){X.removeEventListener("scroll",e)}},[X,z]);var ee=function(e){for(var t=e.measurements,r=e.outerSize,s=e.scrollOffset,a=t.length-1,n=f(0,a,function(e){return t[e].start},s),l=n;l<a&&t[l].end<s+r;)l++;return{start:n,end:l}}(P.current),et=ee.start,er=ee.end,es=a.useMemo(function(){return L({start:et,end:er,overscan:j,size:J.length})},[et,er,j,J.length,L]),ea=a.useRef(O);ea.current=O;var en=a.useMemo(function(){for(var e=[],t=0,r=es.length;t<r;t++)!function(t,r){var s=es[t],a=J[s],l=n(n({},a),{},{measureRef:function(e){if(e){var t=ea.current(e,N);if(t!==l.size){var r=P.current.scrollOffset;l.start<r&&W(r+(t-l.size)),Q.current.push(s),q(function(e){var r;return n(n({},e),{},((r={})[l.key]=t,r))})}}}});e.push(l)}(t);return e},[es,W,N,J]),el=a.useRef(!1);d(function(){el.current&&q({}),el.current=!0},[g]);var ei=a.useCallback(function(e,t){var r=(void 0===t?{}:t).align,s=void 0===r?"start":r,a=P.current,n=a.scrollOffset,l=a.outerSize;"auto"===s&&(s=e<=n?"start":e>=n+l?"end":"start"),"start"===s?w(e):"end"===s?w(e-l):"center"===s&&w(e-l/2)},[w]),eo=a.useCallback(function(e,t){var r=void 0===t?{}:t,s=r.align,a=void 0===s?"auto":s,i=function(e,t){if(null==e)return{};var r,s,a={},n=Object.keys(e);for(s=0;s<n.length;s++)t.indexOf(r=n[s])>=0||(a[r]=e[r]);return a}(r,["align"]),o=P.current,d=o.measurements,c=o.scrollOffset,u=o.outerSize,p=d[Math.max(0,Math.min(e,l-1))];if(p){if("auto"===a){if(p.end>=c+u)a="end";else{if(!(p.start<=c))return;a="start"}}ei("center"===a?p.start+p.size/2:"end"===a?p.end:p.start,n({align:a},i))}},[ei,l]);return{virtualItems:en,totalSize:Y,scrollToOffset:ei,scrollToIndex:a.useCallback(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];eo.apply(void 0,t),requestAnimationFrame(function(){eo.apply(void 0,t)})},[eo]),measure:K}}var f=function(e,t,r,s){for(;e<=t;){var a=(e+t)/2|0,n=r(a);if(n<s)e=a+1;else{if(!(n>s))return a;t=a-1}}return e>0?e-1:0}}},e=>{var t=t=>e(e.s=t);e.O(0,["react-lib","primer-react-css","vendors-node_modules_dompurify_dist_purify_js","vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_primer_octicons-react_di-b40d97","vendors-node_modules_primer_react_lib-esm_Box_Box_js","vendors-node_modules_primer_react_lib-esm_Button_Button_js","vendors-node_modules_primer_react_lib-esm_TooltipV2_Tooltip_js","vendors-node_modules_primer_react_node_modules_primer_octicons-react_dist_index_esm_mjs","vendors-node_modules_primer_react_lib-esm_ActionList_index_js","vendors-node_modules_primer_react_lib-esm_ActionMenu_ActionMenu_js-node_modules_primer_react_-5b2420","vendors-node_modules_primer_react_lib-esm_Text_Text_js-node_modules_primer_react_lib-esm_Text-7845da","vendors-node_modules_primer_react_lib-esm_FormControl_FormControl_js","vendors-node_modules_github_catalyst_lib_index_js-node_modules_github_hydro-analytics-client_-7901e7","vendors-node_modules_react-router-dom_dist_index_js","vendors-node_modules_primer_behaviors_dist_esm_focus-zone_js","vendors-node_modules_primer_react_lib-esm_FilteredActionList_FilteredActionList_js","vendors-node_modules_github_relative-time-element_dist_index_js","vendors-node_modules_primer_react_lib-esm_ConfirmationDialog_ConfirmationDialog_js","vendors-node_modules_react-relay_index_js","vendors-node_modules_primer_react_lib-esm_Avatar_Avatar_js-node_modules_primer_react_lib-esm_-b1b3d3","vendors-node_modules_lodash-es__Stack_js-node_modules_lodash-es__Uint8Array_js-node_modules_l-4faaa6","vendors-node_modules_github_hotkey_dist_index_js-node_modules_lodash-es_capitalize_js","vendors-node_modules_primer_react_lib-esm_AvatarStack_AvatarStack_js-node_modules_primer_reac-fd5a37","vendors-node_modules_github_remote-form_dist_index_js-node_modules_delegated-events_dist_inde-893f9f","vendors-node_modules_primer_behaviors_dist_esm_anchored-position_js-node_modules_primer_react-ac6973","vendors-node_modules_primer_react_lib-esm_Heading_Heading_js-node_modules_primer_react_lib-es-8775aa","vendors-node_modules_primer_react_lib-esm_Dialog_js-node_modules_primer_react_lib-esm_PageHea-0e8c96","ui_packages_react-core_create-browser-history_ts-ui_packages_safe-storage_safe-storage_ts-ui_-682c2c","ui_packages_react-core_register-app_ts","ui_packages_list-view_src_ListItem_ListItem_tsx-ui_packages_list-view_src_ListItem_Title_tsx--68e5b9","ui_packages_ui-commands_ui-commands_ts","ui_packages_filter_providers_index_ts-ui_packages_filter_Filter_tsx","ui_packages_ref-selector_RefSelector_tsx","ui_packages_fuzzy-score_fuzzy-filter_ts-ui_packages_repos-async-validation_hooks_use-validate-2f0377"],()=>t(55952)),e.O()}]);
//# sourceMappingURL=repos-rules-18b8b63b1804.js.map