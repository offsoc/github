apiVersion: apps/v1
kind: Deployment
metadata:
    name: redis
spec:
    replicas: 1
    template:
        metadata:
            labels:
                service: redis
            annotations:
        spec:
            containers:
                - name: redis
                  image: octofactory.service.private-us-east-1.github.net/kustomize-labs-docker-releases-local/github/redis-container/redis:934d4c081f0503239ac2cf26015b721e60cc919f
                  args: ["/config/redis.conf"]
                  resources:
                    limits:
                        cpu: 0.1
                        memory: "100Mi"
                    requests:
                        cpu: 0.05
                        memory: "100Mi"
                  volumeMounts:
                    - name: redis-conf
                      mountPath: /config
                    - name: tz-config
                      mountPath: /etc/localtime
                      readOnly: true
                  ports:
                    - name: data
                      containerPort: 6379
                  readinessProbe:
                    tcpSocket:
                        port: data
            restartPolicy: Always
            volumes:
                - name: redis-conf
                  configMap:
                    name: general
                    items:
                        - key: empty-redis-conf
                          path: redis.conf
                - name: tz-config
                  hostPath:
                    path: /usr/share/zoneinfo/America/Los_Angeles
    selector:
        matchLabels:
            service: redis
