<div class="site-admin-unboxed">
  <div class="site-admin-subhead ruleless">
    <h2 class="site-admin-subhead-heading">
      <%= link_to \
        "RepoVulnAlerts",
        gh_stafftools_repository_vulnerability_alerts_path(current_repository) %>
      /
      RepoVulnAlert #<%= alert.id %>
    </h2>
  </div>

  <div class="site-admin-table">
    <table>
      <tr>
        <th>Vulnerability</th>
        <td><%= link_to(alert.vulnerability.ghsa_id, global_advisory_path(alert.vulnerability.ghsa_id)) %></td>
      </tr>
      <th>Dismissed by</th>
      <td>
        <% if alert.dismisser %>
          <%= link_to alert.dismisser, stafftools_user_path(alert.dismisser) %>
          <% if alert.dismisser.spammy? %>
            &ndash;
            <%= primer_octicon(:alert, classes: "error") %>
            flagged as spam
          <% end %>
        <% elsif alert.dismissed_at %>
          account has been deleted
        <% end %>
      </td>
    </table>
  </div>

  <%= render \
    partial: "stafftools/database",
    locals: {record: alert} %>

  <div class="site-admin-subhead ruleless">
    <h2 class="site-admin-subhead-heading">
      Audit log
    </h2>
  </div>

  <% if stafftools_action_authorized?(controller: Stafftools::SearchController, action: :audit_log) %>
    <%= render \
      partial: "stafftools/audit_log",
      locals: {
        query: query,
        logs: logs,
        more_results: more_results,
      } %>
  <% else %>
    <p><%= stafftools_not_authorized_html %></p>
  <% end %>
</div>
