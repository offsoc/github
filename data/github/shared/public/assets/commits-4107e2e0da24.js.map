{"version":3,"file":"commits-xxxxxxxxxxxx.js","mappings":"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","sources":["ui/packages/diff-lines/components/CommentIndicator.module.css","ui/packages/diff-lines/components/DiffFindPopover.module.css","ui/packages/diff-lines/components/DiffHighlightedOverlay.module.css","ui/packages/diff-lines/components/DiffLines.module.css","ui/packages/diff-lines/components/ExpandableHunkHeaderDiffLine.module.css","ui/packages/diff-lines/components/HiddenDiffPatch.module.css","ui/packages/diff-lines/components/SelectedDiffLinesOverlay.module.css","ui/packages/assert-data-present/assert-data-present.ts","ui/packages/code-view-shared/hooks/shortcuts.ts","ui/packages/code-view-shared/utilities/web-worker.ts","ui/packages/code-view-shared/worker-jobs/debounced-worker-manager.ts","ui/packages/commits/routes/Commit.tsx","ui/packages/commits/App.tsx","ui/packages/commits/components/Commit/CommitBranchInfo.tsx","ui/packages/commits/components/Commit/CommitTagInfo.tsx","ui/packages/commits/components/Commit/SpoofedCommitWarningBanner.tsx","ui/packages/commits/components/Commit/WeirichCommitBanner.tsx","ui/packages/commits/components/Commit/CommitInfo.tsx","ui/packages/commits/utils/grab-and-append-url-parameters.ts","ui/packages/commits/components/Commit/CommitUnavailable.tsx","ui/packages/commits/hooks/use-update-user-split-preference.ts","ui/packages/commits/contexts/DiffViewSettingsContext.tsx","ui/packages/commits/hooks/use-load-deferred-diffs.ts","ui/packages/commits/utils/get-file-extension.ts","ui/packages/commits/utils/sticky-header-offset.ts","ui/packages/commits/hooks/use-diff-lines.ts","ui/packages/commits/components/Commit/BlobActionsMenu.tsx","ui/packages/commits/components/Commit/CommitRichDiff.tsx","ui/packages/commits/hooks/use-load-rich-diff-data.ts","ui/packages/commits/components/Commit/Diff.tsx","ui/packages/commits/hooks/use-diff-inline-commenting.ts","ui/packages/commits/hooks/use-diff-inline-marker-nav.ts","ui/packages/commits/hooks/use-comment-info.ts","ui/packages/commits/components/Commit/LoadingContentBlock.tsx","ui/packages/commits/components/Commit/Diffs.tsx","ui/packages/commits/components/Commit/DiffViewPreferenceToggle.tsx","ui/packages/commits/components/Commit/DiffWhitespaceToggle.tsx","ui/packages/commits/components/Commit/DiffViewSettings.tsx","ui/packages/commits/components/Commit/DiffsHeader.tsx","ui/packages/commits/hooks/use-sticky-observer.ts","ui/packages/commits/components/Commit/FileTree.tsx","ui/packages/commits/components/Commit/SSRDiffs.tsx","ui/packages/commits/hooks/use-fetch-deferred-comment-data.ts","ui/packages/commits/components/Commit/ExpandButton.tsx","ui/packages/commits/hooks/use-tree-pane.tsx","ui/packages/commits/hooks/use-update-user-tree-preference.ts","ui/packages/commits/hooks/use-load-branch-commits.ts","ui/packages/commits/utils/split-diff-entry-data.ts","ui/packages/commits/components/Commits/CommitHelpMessage.tsx","ui/packages/commits/contexts/FilterContext.tsx","ui/packages/commits/components/Commits/FileHistory.tsx","ui/packages/commits/components/Commits/CommitList.tsx","ui/packages/commits/hooks/use-load-author-data.ts","ui/packages/commits/utils/add-or-modify-url-parameters.ts","ui/packages/commits/components/Commits/ListHeader.tsx","ui/packages/commits/utils/extract-range.ts","ui/packages/commits/components/Commits/Pagination.tsx","ui/packages/commits/components/Layout.tsx","ui/packages/commits/routes/Commits.tsx","ui/packages/commits/commits.ts","ui/packages/commits/shared/use-load-deferred-commit-data.ts","ui/packages/conversations/helpers.ts","ui/packages/conversations/hooks/use-persisted-comment-data.ts","ui/packages/conversations/suggested-changes.ts","ui/packages/conversations/test-utils/query-data.ts","ui/packages/conversations/types.ts","ui/packages/conversations/util/ensure-previous-active-dialog-is-closed.ts","ui/packages/conversations/util/validate-suggested-change.ts","ui/packages/copilot-chat/utils/copilot-chat-events.ts","ui/packages/copilot-chat/utils/copilot-chat-types.ts","ui/packages/copilot-code-chat/__generated__/useFileDiffReference_Comparison.graphql.ts","ui/packages/copilot-code-chat/__generated__/useFileDiffReference_DiffEntry.graphql.ts","ui/packages/copilot-code-chat/diff-view/react/__generated__/DiffChatWrapper_ComparisonQuery.graphql.ts","ui/packages/copilot-code-chat/diff-view/react/__generated__/DiffChatWrapper_DiffEntryQuery.graphql.ts","ui/packages/copilot-code-chat/diff-view/react/__generated__/DiffChatWrapper_ViewerQuery.graphql.ts","ui/packages/copilot-code-chat/use-file-diff-reference.ts","ui/packages/diff-file-header/LinesChangedCounterLabel.tsx","ui/packages/diff-file-header/DiffFileHeader.module.css","ui/packages/diff-file-header/DiffFileHeader.tsx","ui/packages/diff-file-helpers/diff-file-helpers.ts","ui/packages/diff-file-tree/diff-file-tree-helpers.ts","ui/packages/diff-file-tree/FileStatusIcon.tsx","ui/packages/diff-file-tree/DiffFileTree.tsx","ui/packages/diff-lines/constants/focus.ts","ui/packages/diff-lines/constants/values.ts","ui/packages/diff-lines/helpers/conversation-helpers.ts","ui/packages/diff-lines/helpers/diff-row-selected-checker.ts","ui/packages/diff-lines/helpers/document-hash-helpers.ts","ui/packages/diff-lines/helpers/find-in-diff.ts","ui/packages/diff-lines/helpers/grid-navigator.ts","ui/packages/diff-lines/helpers/hunk-data-helpers.ts","ui/packages/diff-lines/helpers/line-helpers.ts","ui/packages/diff-lines/helpers/not-empty.ts","ui/packages/diff-lines/helpers/overlay-helpers.ts","ui/packages/diff-lines/hooks/use-action-bar-dialogs.ts","ui/packages/diff-lines/hooks/use-action-bar-focus.ts","ui/packages/diff-lines/hooks/use-diff-search-results.ts","ui/packages/diff-lines/hooks/use-expand-hunk.ts","ui/packages/diff-lines/hooks/use-focus-next-cell-after-expand.ts","ui/packages/diff-lines/hooks/use-grid-navigation.ts","ui/packages/diff-lines/hooks/use-selected-diff-row-range-content.ts","ui/packages/diff-lines/hooks/use-stable-callback.ts","ui/packages/diff-lines/hooks/use-suggested-changes.ts","ui/packages/diff-lines/types.ts","ui/packages/file-renderer-blob/use-file-renderer.ts","ui/packages/use-file-tree-tooltip/use-file-tree-tooltip.ts","ui/packages/use-hide-footer/use-hide-footer.ts","ui/packages/use-verified-fetch/use-verified-fetch.ts","ui/packages/use-virtual/use-virtual-dynamic.ts","ui/packages/use-virtual/use-virtual-window.ts","ui/packages/user-selector/UserItem.tsx","ui/packages/user-selector/UsersList.tsx","ui/packages/user-selector/UserSelector.tsx","ui/packages/commenting/components/CommentHeader.tsx","ui/packages/commenting/components/CompactCommentButton.tsx","ui/packages/commits/shared/CommitsBlankState.tsx","ui/packages/conversations/components/AddCommentEditor.tsx","ui/packages/conversations/components/Annotation.tsx","ui/packages/conversations/components/AnnotationDialog.tsx","ui/packages/conversations/components/AnnotationIcon.tsx","ui/packages/conversations/components/CodeSuggestionActions.tsx","ui/packages/conversations/components/CodeSuggestionActions/AddToExistingBatch.tsx","ui/packages/conversations/components/CodeSuggestionActions/ApplyOrAddToBatch.tsx","ui/packages/conversations/components/CodeSuggestionActions/ApplySuggestionDialog.tsx","ui/packages/conversations/components/CodeSuggestionActions/CodeSuggestionUnavailable.tsx","ui/packages/conversations/components/CodeSuggestionActions/CommitOrRemoveFromBatch.tsx","ui/packages/conversations/components/ConversationCommentBox.tsx","ui/packages/conversations/components/GlobalMarkerNavigation.tsx","ui/packages/conversations/components/Markers.tsx","ui/packages/conversations/components/MarkersListActionMenu.tsx","ui/packages/conversations/components/ReviewThread.tsx","ui/packages/conversations/components/ReviewThreadComment.tsx","ui/packages/conversations/components/ReviewThreadDialog.tsx","ui/packages/conversations/components/StartConversation.tsx","ui/packages/conversations/components/StartThreadComment.tsx","ui/packages/conversations/components/StaticUnifiedDiffPreview.tsx","ui/packages/conversations/components/SuggestedChangeView.tsx","ui/packages/conversations/contexts/ConversationMarkdownSubjectContext.tsx","ui/packages/conversations/contexts/DialogStateContext.tsx","ui/packages/copilot-code-chat/diff-view/react/CopilotDiffChatBlobActionsMenuItems.tsx","ui/packages/copilot-code-chat/diff-view/react/CopilotDiffChatContextMenu.tsx","ui/packages/copilot-code-chat/diff-view/react/DiffChatWrapper.tsx","ui/packages/copilot-code-chat/diff-view/shared/DiffLinesAttachMenuItem.tsx","ui/packages/copilot-code-chat/diff-view/shared/DiffLinesDiscussMenuItem.tsx","ui/packages/copilot-code-chat/diff-view/shared/DiffLinesExplainMenuItem.tsx","ui/packages/diff-file-tree/FileFilter.module.css","ui/packages/diff-file-tree/FileFilter.tsx","ui/packages/diff-lines/components/ActionBar.tsx","ui/packages/diff-lines/components/CommentIndicator.tsx","ui/packages/diff-lines/components/DiffFindPopover.tsx","ui/packages/diff-lines/components/DiffHighlightedOverlay.tsx","ui/packages/diff-lines/components/DiffLineScreenReaderSummary.tsx","ui/packages/diff-lines/components/DiffLineTableCellContextMenus.tsx","ui/packages/diff-lines/components/DiffLineTableCellParts.tsx","ui/packages/diff-lines/components/DiffLineTableRow.tsx","ui/packages/diff-lines/components/DiffLines.tsx","ui/packages/diff-lines/components/ExpandableHunkHeaderDiffLine.tsx","ui/packages/diff-lines/components/HiddenDiffPatch.tsx","ui/packages/diff-lines/components/InProgressCommentIndicator.tsx","ui/packages/diff-lines/components/RichDiff.tsx","ui/packages/diff-lines/components/SelectedDiffLinesOverlay.tsx","ui/packages/diff-lines/components/SplitDiffLines.tsx","ui/packages/diff-lines/components/StartConversationContextMenuItems.tsx","ui/packages/diff-lines/components/UnifiedDiffLines.tsx","ui/packages/diff-lines/contexts/DiffContext.tsx","ui/packages/diff-lines/contexts/DiffFindOpenContext.tsx","ui/packages/diff-lines/contexts/DiffLineContext.tsx","ui/packages/diff-lines/contexts/MarkersDialogContext.tsx","ui/packages/diff-lines/contexts/SelectedDiffRowRangeContext.tsx","ui/packages/file-renderer-blob/FileRendererBlob.tsx","ui/packages/react-core/JsonRoute.tsx","ui/packages/screen-size/ScreenSize.tsx","ui/packages/status-avatar/StatusAvatar.tsx","ui/packages/status-avatar/StatusIcon.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"commentIndicatorContainer\":\"CommentIndicator-module__commentIndicatorContainer--L8lU3\"};","// extracted by mini-css-extract-plugin\nexport default {\"visibilityHidden\":\"DiffFindPopover-module__visibilityHidden--HCMWu\",\"visibilityVisible\":\"DiffFindPopover-module__visibilityVisible--AknNV\",\"defaultStyles\":\"DiffFindPopover-module__defaultStyles--IjqxB\",\"stickyStyles\":\"DiffFindPopover-module__stickyStyles--oNP5J\",\"notStickyStyles\":\"DiffFindPopover-module__notStickyStyles--_E6rW\"};","// extracted by mini-css-extract-plugin\nexport default {\"visibilityHidden\":\"DiffHighlightedOverlay-module__visibilityHidden--v59uf\",\"visibilityVisible\":\"DiffHighlightedOverlay-module__visibilityVisible--zJWJ5\",\"userSelectNone\":\"DiffHighlightedOverlay-module__userSelectNone--i39lB\",\"focusedResultStyles\":\"DiffHighlightedOverlay-module__focusedResultStyles--QZMIm\",\"nonFocusedResultStyles\":\"DiffHighlightedOverlay-module__nonFocusedResultStyles--x2N7d\",\"nonHunkStyles\":\"DiffHighlightedOverlay-module__nonHunkStyles--_dJlQ\"};","// extracted by mini-css-extract-plugin\nexport default {\"tableLayoutFixed\":\"DiffLines-module__tableLayoutFixed--YZcIJ\"};","// extracted by mini-css-extract-plugin\nexport default {\"expand-button-line\":\"ExpandableHunkHeaderDiffLine-module__expand-button-line--rnQN5\",\"expand-up-and-down\":\"ExpandableHunkHeaderDiffLine-module__expand-up-and-down--hCan_\"};","// extracted by mini-css-extract-plugin\nexport default {\"gridColumnTemplate\":\"HiddenDiffPatch-module__gridColumnTemplate--3bEGq\"};","// extracted by mini-css-extract-plugin\nexport default {\"overlay\":\"SelectedDiffLinesOverlay-module__overlay--mWvvK\",\"overlayOpacity\":\"SelectedDiffLinesOverlay-module__overlayOpacity--B9iKM\"};","export const errorMessage = 'Failed to load page data.'\n\nexport function assertDataPresent<T>(data: T): asserts data is NonNullable<T> {\n  if (data === undefined || data === null) {\n    throw new Error(errorMessage)\n  }\n}\n","import {useClientValue} from '@github-ui/use-client-value'\nimport {useIsPlatform} from '@github-ui/use-is-platform'\n\n//If you want a shortcut to work while the blob is focused, you need to set useWhileBlobFocused to true and also\n//add the hotkey without any modifiers to the alphanumeric hotkey array\nexport interface Shortcut {\n  text?: string\n  hotkey?: string\n  ariaKeyShortcuts?: string\n  useWhileBlobFocused?: boolean\n  noModifierHotkey?: string[]\n  modifierRequired?: boolean\n}\n\ninterface Shortcuts {\n  cursorNavigationHopWordLeft: Shortcut\n  cursorNavigationHopWordRight: Shortcut\n  cursorNavigationTopOfPage: Shortcut\n  cursorNavigationBottomOfPage: Shortcut\n  alternativeGoToLineShortcut: Shortcut\n  cursorNavigationEnd: Shortcut\n  cursorNavigationHome: Shortcut\n  cursorNavigationOpenHelpDialog: Shortcut\n  expandAndFocusLineContextMenu: Shortcut\n  cursorNavigationSpace: Shortcut\n  cursorNavigationShiftSpace: Shortcut\n  cursorNavigationPageUp: Shortcut\n  cursorNavigationPageDown: Shortcut\n  cursorNavigationArrowDown: Shortcut\n  cursorNavigationArrowUp: Shortcut\n  cursorNavigationArrowLeft: Shortcut\n  cursorNavigationArrowRight: Shortcut\n  cursorNavigationShiftHopWordLeft: Shortcut\n  cursorNavigationShiftHopWordRight: Shortcut\n  cursorNavigationShiftTopOfPage: Shortcut\n  cursorNavigationShiftBottomOfPage: Shortcut\n  cursorNavigationShiftEnd: Shortcut\n  cursorNavigationShiftHome: Shortcut\n  cursorNavigationShiftPageUp: Shortcut\n  cursorNavigationShiftPageDown: Shortcut\n  cursorNavigationShiftArrowDown: Shortcut\n  cursorNavigationShiftArrowUp: Shortcut\n  cursorNavigationShiftArrowLeft: Shortcut\n  cursorNavigationShiftArrowRight: Shortcut\n  cursorNavigationHighlightLine: Shortcut\n  cursorNavigationGoLineUp: Shortcut\n  cursorNavigationGoLineDown: Shortcut\n  cursorNavigationEnter: Shortcut\n  copyFilePathShortcut: Shortcut\n  copyPermalinkShortcut: Shortcut\n  copyRawContentShortcut: Shortcut\n  downloadRawContentShortcut: Shortcut\n  editFileShortcut: Shortcut\n  goToLineShortcut: Shortcut\n  escapeRightClickMenu: Shortcut\n  findInFileShortcut: Shortcut\n  findSelectionShortcut: Shortcut\n  refSelectorShortcut: Shortcut\n  findFilesShortcut: Shortcut\n  findNextShortcut: Shortcut\n  findPrevShortcut: Shortcut\n  openWithGitHubDevShortcut: Shortcut\n  openWithGitHubDevInNewWindowShortcut: Shortcut\n  permalinkShortcut: Shortcut\n  searchShortcut: Shortcut\n  selectAllShortcut: Shortcut\n  selectEditTabShortcut: Shortcut\n  submitCommitDialogShortcut: Shortcut\n  toggleFocusedPaneShortcut: Shortcut\n  toggleSymbolsShortcut: Shortcut\n  toggleTreeShortcut: Shortcut\n  viewBlameShortcut: Shortcut\n  viewCodeShortcut: Shortcut\n  viewPreviewShortcut: Shortcut\n  viewRawContentShortcut: Shortcut\n  findSymbolShortcut: Shortcut\n}\n\nconst macShortcuts: Shortcuts = {\n  cursorNavigationHopWordLeft: {\n    hotkey: 'Alt+ArrowLeft,Ctrl+ArrowLeft',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowLeft'],\n    modifierRequired: true,\n  },\n  cursorNavigationHopWordRight: {\n    hotkey: 'Alt+ArrowRight,Ctrl+ArrowRight',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowRight'],\n    modifierRequired: true,\n  },\n  cursorNavigationTopOfPage: {\n    hotkey: 'Meta+ArrowUp',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowUp'],\n    modifierRequired: true,\n  },\n  cursorNavigationBottomOfPage: {\n    hotkey: 'Meta+ArrowDown',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowDown'],\n    modifierRequired: true,\n  },\n  cursorNavigationEnd: {\n    hotkey: 'End,Meta+ArrowRight',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['End'],\n  },\n  cursorNavigationHome: {\n    hotkey: 'Home,Meta+ArrowLeft',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['Home'],\n  },\n  cursorNavigationPageUp: {\n    hotkey: 'PageUp',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['PageUp'],\n  },\n  cursorNavigationPageDown: {\n    hotkey: 'PageDown',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['PageDown'],\n  },\n  cursorNavigationArrowDown: {\n    hotkey: 'ArrowDown',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowDown'],\n  },\n  cursorNavigationArrowUp: {\n    hotkey: 'ArrowUp',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowUp'],\n  },\n  cursorNavigationArrowLeft: {\n    hotkey: 'ArrowLeft',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowLeft'],\n  },\n  cursorNavigationArrowRight: {\n    hotkey: 'ArrowRight',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowRight'],\n  },\n  cursorNavigationShiftHopWordLeft: {\n    hotkey: 'Alt+Shift+ArrowLeft,Ctrl+Shift+ArrowLeft',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowLeft'],\n    modifierRequired: true,\n  },\n  cursorNavigationShiftHopWordRight: {\n    hotkey: 'Alt+Shift+ArrowRight,Ctrl+Shift+ArrowRight',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowRight'],\n    modifierRequired: true,\n  },\n  cursorNavigationShiftTopOfPage: {\n    hotkey: 'Meta+Shift+ArrowUp',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowUp'],\n    modifierRequired: true,\n  },\n  cursorNavigationShiftBottomOfPage: {\n    hotkey: 'Meta+Shift+ArrowDown',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowDown'],\n    modifierRequired: true,\n  },\n  cursorNavigationShiftEnd: {\n    hotkey: 'Shift+End,Meta+Shift+ArrowRight',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['End'],\n    modifierRequired: true,\n  },\n  cursorNavigationShiftHome: {\n    hotkey: 'Shift+Home,Meta+Shift+ArrowLeft',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['Home'],\n    modifierRequired: true,\n  },\n  cursorNavigationShiftPageUp: {\n    hotkey: 'Shift+PageUp',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['PageUp'],\n    modifierRequired: true,\n  },\n  cursorNavigationShiftPageDown: {\n    hotkey: 'Shift+PageDown',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['PageDown'],\n    modifierRequired: true,\n  },\n  cursorNavigationShiftArrowDown: {\n    hotkey: 'Shift+ArrowDown',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowDown'],\n    modifierRequired: true,\n  },\n  cursorNavigationShiftArrowUp: {\n    hotkey: 'Shift+ArrowUp',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowUp'],\n    modifierRequired: true,\n  },\n  cursorNavigationShiftArrowLeft: {\n    hotkey: 'Shift+ArrowLeft',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowLeft'],\n    modifierRequired: true,\n  },\n  cursorNavigationShiftArrowRight: {\n    hotkey: 'Shift+ArrowRight',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['ArrowRight'],\n    modifierRequired: true,\n  },\n  cursorNavigationHighlightLine: {\n    text: 'J',\n    hotkey: 'Shift+J',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['J'],\n    modifierRequired: true,\n  },\n  cursorNavigationGoLineUp: {\n    hotkey: 'Ctrl+p',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['p'],\n    modifierRequired: true,\n  },\n  cursorNavigationOpenHelpDialog: {\n    hotkey: 'Alt+F1,Control+Alt+,Control+Alt+h',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['F1', 'h', ''],\n    modifierRequired: true,\n  },\n  cursorNavigationGoLineDown: {\n    hotkey: 'Ctrl+n',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['n'],\n    modifierRequired: true,\n  },\n  cursorNavigationEnter: {\n    text: ' Enter',\n    hotkey: 'Meta+Enter',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['Enter'],\n    modifierRequired: true,\n  },\n  cursorNavigationSpace: {\n    hotkey: ' ',\n    useWhileBlobFocused: true,\n    noModifierHotkey: [' '],\n    modifierRequired: false,\n  },\n  cursorNavigationShiftSpace: {\n    hotkey: 'Shift+ ',\n    useWhileBlobFocused: true,\n    noModifierHotkey: [' '],\n    modifierRequired: true,\n  },\n  expandAndFocusLineContextMenu: {\n    text: 'Shift Alt C',\n    hotkey: 'Alt+Shift+C,Alt+Shift+',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['C'],\n    modifierRequired: true,\n  },\n  copyFilePathShortcut: {\n    text: ' shift .',\n    hotkey: 'Meta+Shift+>',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['.'],\n    modifierRequired: true,\n  },\n  copyPermalinkShortcut: {\n    text: ' shift ,',\n    hotkey: 'Meta+Shift+<',\n    useWhileBlobFocused: true,\n    noModifierHotkey: [','],\n    modifierRequired: true,\n  },\n  copyRawContentShortcut: {\n    text: ' shift c',\n    hotkey: 'Meta+Shift+C',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['c'],\n    modifierRequired: true,\n  },\n  downloadRawContentShortcut: {\n    text: ' shift s',\n    hotkey: 'Meta+Shift+S',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['s'],\n    modifierRequired: true,\n  },\n  editFileShortcut: {\n    hotkey: 'e,Shift+E',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['e', 'E'],\n  },\n  goToLineShortcut: {\n    text: 'l',\n    hotkey: 'l,Shift+L',\n    ariaKeyShortcuts: 'l',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['l', 'L'],\n  },\n  alternativeGoToLineShortcut: {\n    hotkey: 'Mod+Alt+g',\n    ariaKeyShortcuts: 'Mod+Alt+g',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['g', 'G'],\n  },\n  findInFileShortcut: {\n    hotkey: 'Meta+f, F3',\n    text: ' f',\n    ariaKeyShortcuts: 'Meta+F',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['f', 'F3'],\n    modifierRequired: true,\n  },\n  findFilesShortcut: {\n    hotkey: 't,Shift+T',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['t', 'T'],\n  },\n  findSelectionShortcut: {\n    hotkey: 'Meta+e',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['e'],\n    modifierRequired: true,\n  },\n  findNextShortcut: {\n    hotkey: 'Mod+g',\n  },\n  findPrevShortcut: {\n    hotkey: 'Mod+Shift+G',\n  },\n  openWithGitHubDevShortcut: {\n    hotkey: '., Meta+Shift+/',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['.'],\n  },\n  openWithGitHubDevInNewWindowShortcut: {\n    hotkey: 'Shift+.,Shift+>,>',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['>'],\n  },\n  permalinkShortcut: {\n    hotkey: 'y,Shift+Y',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['y', 'Y'],\n  },\n  searchShortcut: {\n    hotkey: '/',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['/'],\n  },\n  selectAllShortcut: {\n    hotkey: 'Meta+a',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['a'],\n    modifierRequired: true,\n  },\n  selectEditTabShortcut: {\n    hotkey: 'Mod+Shift+P',\n  },\n  submitCommitDialogShortcut: {\n    hotkey: 'Mod+Enter',\n  },\n  refSelectorShortcut: {\n    hotkey: 'w',\n    text: 'w',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['w'],\n  },\n  escapeRightClickMenu: {\n    hotkey: 'Escape',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['Escape'],\n  },\n  toggleFocusedPaneShortcut: {\n    // we don't need a separate command to go backwards because there's only two options (for now)\n    hotkey: 'Meta+F6,Meta+Shift+F6',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['F6'],\n    modifierRequired: true,\n  },\n  toggleSymbolsShortcut: {\n    hotkey: 'Meta+i',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['i'],\n    modifierRequired: true,\n  },\n  toggleTreeShortcut: {\n    hotkey: 'Meta+b',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['b'],\n    modifierRequired: true,\n  },\n  viewBlameShortcut: {\n    hotkey: 'b,Shift+B,Meta+/ Meta+b',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['b'],\n  },\n  viewCodeShortcut: {\n    hotkey: 'Meta+/ Meta+c',\n    useWhileBlobFocused: true,\n    modifierRequired: true,\n  },\n  viewPreviewShortcut: {\n    hotkey: 'Meta+/ Meta+p',\n  },\n  viewRawContentShortcut: {\n    text: ' /  r',\n    hotkey: 'Meta+/ Meta+r',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['r'],\n    modifierRequired: true,\n  },\n  findSymbolShortcut: {\n    hotkey: 'r,Shift+R',\n    useWhileBlobFocused: true,\n    noModifierHotkey: ['r', 'R'],\n    modifierRequired: false,\n  },\n}\n\nfunction modifyForNonMac(shortcuts: Shortcuts): Shortcuts {\n  return Object.keys(shortcuts).reduce((acc, key) => {\n    const shortcut = shortcuts[key as keyof Shortcuts]\n    acc[key as keyof Shortcuts] = {\n      hotkey: shortcut.hotkey?.replace(/Meta/g, 'Control'),\n      text: shortcut.text?.replace(//g, 'Ctrl').replace(//g, 'Shift'),\n      ariaKeyShortcuts: shortcut.ariaKeyShortcuts?.replace(/Meta/g, 'Control'),\n      useWhileBlobFocused: shortcut.useWhileBlobFocused,\n      modifierRequired: shortcut.modifierRequired,\n      noModifierHotkey: shortcut.noModifierHotkey,\n    }\n    return acc\n  }, {} as Shortcuts)\n}\n/***\nThis function is necessary in SSR because the data-hotkey attribute does not\nrecognize changes to hotkeys that happen during hydration. So we needed the\ndata-hotkey attribute to not exist until during hydration. We had\nthe useClientValue returning false on whether or not the user was using a mac,\nso all hotkeys were being changed to have control in them instead of meta.\nThis was causing mac users to not be able to use any hotkeys that had Meta\nin them if they got the SSR'd version of the blob page.\n***/\nfunction modifyForSSR(shortcuts: Shortcuts): Shortcuts {\n  return Object.keys(shortcuts).reduce((acc, key) => {\n    const shortcut = shortcuts[key as keyof Shortcuts]\n    acc[key as keyof Shortcuts] = {\n      hotkey: undefined,\n      text: shortcut.text?.replace(//g, 'Ctrl').replace(//g, 'Shift'),\n      ariaKeyShortcuts: shortcut.ariaKeyShortcuts?.replace(/Meta/g, 'Control'),\n      useWhileBlobFocused: shortcut.useWhileBlobFocused,\n      modifierRequired: shortcut.modifierRequired,\n      noModifierHotkey: shortcut.noModifierHotkey,\n    }\n    return acc\n  }, {} as Shortcuts)\n}\n\n// Memo this result globally to avoid running this transformation function for each component\n// isMac -> shortcuts\nconst shortcutMemo: Map<number, Shortcuts> = new Map()\n\nexport function useShortcut(): Shortcuts {\n  const isMac = useIsPlatform(['mac'])\n  const [isSSR] = useClientValue(() => false, true, [])\n  //we want the modification scripts to run again whether isMac changes from the default false value OR the SSR value\n  //changes from the default value of true.\n  let key = 0\n  if (isMac) {\n    key = 1\n  } else if (!isSSR) {\n    key = 2\n  }\n\n  if (!shortcutMemo.has(key)) {\n    let shortcuts = macShortcuts\n\n    if (!isMac && !isSSR) {\n      shortcuts = modifyForNonMac(shortcuts)\n    }\n    if (isSSR) {\n      shortcuts = modifyForSSR(shortcuts)\n    }\n\n    shortcutMemo.set(key, shortcuts)\n  }\n\n  return shortcutMemo.get(key) as Shortcuts\n}\nexport function useBlobFocusedModifierShortcuts(): string[] {\n  const shortcuts = useShortcut()\n  return Object.keys(shortcuts).reduce((acc, key) => {\n    const shortcut = shortcuts[key as keyof Shortcuts]\n    if (shortcut.useWhileBlobFocused && shortcut.noModifierHotkey && shortcut.modifierRequired) {\n      for (const alphaNumericHotkey of shortcut.noModifierHotkey) {\n        if (!acc.includes(alphaNumericHotkey)) {\n          acc.push(alphaNumericHotkey)\n        }\n      }\n    }\n    return acc\n  }, [] as string[])\n}\nexport function useBlobFocusedShortcuts(): string[] {\n  const shortcuts = useShortcut()\n  return Object.keys(shortcuts).reduce((acc, key) => {\n    const shortcut = shortcuts[key as keyof Shortcuts]\n    if (shortcut.useWhileBlobFocused && shortcut.noModifierHotkey && !shortcut.modifierRequired) {\n      for (const alphaNumericHotkey of shortcut.noModifierHotkey) {\n        if (!acc.includes(alphaNumericHotkey)) {\n          acc.push(alphaNumericHotkey)\n        }\n      }\n    }\n    return acc\n  }, [] as string[])\n}\n","type WorkerEventListener<Data> = (response: {data: Data}) => void\n\ninterface AbstractWorker<TRequest, TResponse> {\n  onmessage?: WorkerEventListener<TResponse>\n  postMessage(request: TRequest): void\n  terminate(): void\n}\n\n/**\n * WebWorker is an abstraction that exposes similar interface as a Service Worker.\n * However, besides the path it also requires a callback, same function as the one run in the worker thread.\n * This callback is used as a fallback if worker cannot be created.\n */\nexport class WebWorker<TRequest, TResponse> implements AbstractWorker<TRequest, TResponse> {\n  worker: Worker | MainThreadWorker<TRequest, TResponse>\n\n  set onmessage(listener: WorkerEventListener<TResponse>) {\n    this.worker.onmessage = listener\n  }\n\n  constructor(path: string, job: (request: {data: TRequest}) => TResponse) {\n    try {\n      this.worker = new Worker(path)\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.warn('Web workers are not available. Please enable web workers to benefit from the improved performance.')\n      this.worker = new MainThreadWorker(job)\n    }\n  }\n\n  postMessage(request: TRequest) {\n    this.worker.postMessage(request)\n  }\n\n  terminate() {\n    this.worker.terminate()\n  }\n}\n\nexport class MainThreadWorker<TRequest, TResponse> implements AbstractWorker<TRequest, TResponse> {\n  private terminated = false\n\n  onmessage: WorkerEventListener<TResponse> | undefined\n\n  constructor(private job: (request: {data: TRequest}) => TResponse) {}\n\n  async postMessage(request: TRequest) {\n    if (this.terminated) {\n      return\n    }\n    const response = {data: this.job({data: request})}\n    this.onmessage?.(response)\n  }\n\n  terminate() {\n    this.terminated = true\n  }\n}\n","import type {WebWorker} from '@github-ui/code-view-shared/utilities/web-worker'\n\nexport class DebouncedWorkerManager<TRequest, TResponse> {\n  private currentRequest: TRequest | undefined = undefined\n  private nextRequest: TRequest | undefined = undefined\n  public onResponse: ((response: TResponse) => void) | undefined\n  private delayId: NodeJS.Timeout | undefined\n\n  constructor(\n    private worker: Worker | WebWorker<TRequest, TResponse>,\n    private delayMs = 200,\n    private debounceOverrideCondition?: (req: TRequest) => boolean,\n  ) {\n    this.worker.onmessage = ({data}: {data: TResponse}) => {\n      if (this.onResponse) {\n        this.onResponse(data)\n      }\n      if (this.nextRequest) {\n        this.postNow(this.nextRequest)\n        this.nextRequest = undefined\n      } else {\n        this.currentRequest = undefined\n      }\n    }\n  }\n\n  public post(request: TRequest) {\n    if (this.debounceOverrideCondition && this.debounceOverrideCondition(request)) {\n      if (this.delayId) {\n        clearTimeout(this.delayId)\n      }\n      return this.postNow(request)\n    }\n\n    if (this.idle()) {\n      if (this.delayId) {\n        clearTimeout(this.delayId)\n      }\n\n      this.delayId = setTimeout(() => {\n        this.postNow(request)\n      }, this.delayMs)\n    } else {\n      this.nextRequest = request\n    }\n  }\n\n  private postNow(request: TRequest) {\n    this.currentRequest = request\n    this.worker.postMessage(request)\n  }\n\n  public idle() {\n    return !this.currentRequest\n  }\n\n  public terminate() {\n    this.worker.terminate()\n  }\n}\n","import type {DiffDelta} from '@github-ui/diff-file-tree'\nimport {DiffFindOpenProvider, SelectedDiffRowRangeContextProvider} from '@github-ui/diff-lines'\nimport {updateURLHash} from '@github-ui/diff-lines/document-hash-helpers'\nimport {DiffPlaceholder} from '@github-ui/diffs/DiffParts'\nimport {commitContextLinesPath, commitPath} from '@github-ui/paths'\nimport {useRoutePayload} from '@github-ui/react-core/use-route-payload'\nimport {relayEnvironmentWithMissingFieldHandlerForNode} from '@github-ui/relay-environment'\nimport {ssrSafeWindow} from '@github-ui/ssr-utils'\nimport {GlobalCommands} from '@github-ui/ui-commands'\nimport {useClientValue} from '@github-ui/use-client-value'\nimport {useHideFooter} from '@github-ui/use-hide-footer'\nimport {SplitPageLayout} from '@primer/react'\nimport {useCallback, useEffect, useMemo, useState} from 'react'\nimport {RelayEnvironmentProvider} from 'react-relay'\n\nimport {DiscussionComments} from '../components/Commit/comments/DiscussionComments'\nimport {CommitInfo} from '../components/Commit/CommitInfo'\nimport {CommitUnavailable} from '../components/Commit/CommitUnavailable'\nimport {Diffs} from '../components/Commit/Diffs'\nimport {DiffsHeader as DiffsHeaderComponent} from '../components/Commit/DiffsHeader'\nimport {DIFF_FILE_TREE_ID, FileTree, type PostSelectAction} from '../components/Commit/FileTree'\nimport {SSRDiffs} from '../components/Commit/SSRDiffs'\nimport {DiffViewSettingsProvider} from '../contexts/DiffViewSettingsContext'\nimport {DiscussionCommentsProvider} from '../contexts/DiscussionCommentsContext'\nimport {InlineCommentsProvider} from '../contexts/InlineCommentsContext'\nimport {useDeferredCommentData} from '../hooks/use-fetch-deferred-comment-data'\nimport {useLoadBranchCommits} from '../hooks/use-load-branch-commits'\nimport {useTreePane} from '../hooks/use-tree-pane'\nimport type {CommitPayload} from '../types/commit-types'\nimport {splitDiffEntryData} from '../utils/split-diff-entry-data'\n\nconst relayEnvironment = relayEnvironmentWithMissingFieldHandlerForNode()\n\nexport function Commit() {\n  useHideFooter(true)\n\n  const payload = useRoutePayload<CommitPayload>()\n  const {splitPagePaneHiddenSx, splitPageContentHidden, treeToggleElement, collapseTree} = useTreePane(\n    DIFF_FILE_TREE_ID,\n    payload.fileTreeExpanded,\n  )\n\n  const [unselectedFileExtensions, setUnselectedFileExtensions] = useState(new Set<string>())\n  const [isSSR] = useClientValue(() => false, true, [])\n  const [selectedPathDigest, setSelectedPathDigest] = useState('')\n  const [searchTerm, setSearchTerm] = useState('')\n  //TODO: make this actually update properly, right now i just have the overlay appearing in a fixed spot\n  // eslint-disable-next-line unused-imports/no-unused-vars\n  const [isStickied, setIsStickied] = useState(false)\n\n  const handleFileSelected = useCallback(\n    (file: DiffDelta, postSelectAction?: PostSelectAction) => {\n      updateURLHash(`diff-${file.pathDigest}`)\n      setSelectedPathDigest(file.pathDigest)\n      if (postSelectAction === 'close_tree') {\n        collapseTree()\n      }\n    },\n    [collapseTree],\n  )\n  const commitInfo = useLoadBranchCommits(payload.commit.oid)\n  const contextLinePathURL = commitContextLinesPath({\n    owner: payload.repo.ownerLogin,\n    repo: payload.repo.name,\n    commitish: payload.commit.oid,\n  })\n\n  const handleFileExtensionsChange = useCallback(\n    (type: 'selectFileExtension' | 'unselectFileExtension', extension: string) => {\n      const unselectedExtensions = new Set(unselectedFileExtensions)\n\n      if (type === 'selectFileExtension') {\n        unselectedExtensions.delete(extension)\n      } else if (type === 'unselectFileExtension') {\n        unselectedExtensions.add(extension)\n      }\n\n      setUnselectedFileExtensions(unselectedExtensions)\n    },\n    [unselectedFileExtensions],\n  )\n\n  useEffect(() => {\n    setUnselectedFileExtensions(new Set<string>())\n  }, [payload.commit])\n\n  useEffect(() => {\n    const hash = ssrSafeWindow?.location.hash\n    if (hash?.indexOf('diff-') !== -1) {\n      const hashArray = hash?.split('diff-')\n      if (hashArray && hashArray.length === 2) {\n        setSelectedPathDigest(hashArray[1] ?? '')\n      }\n    }\n  }, [])\n\n  const viewSettings = useMemo(() => {\n    return {\n      hideWhitespace: payload.ignoreWhitespace,\n      splitPreference: payload.splitViewPreference,\n    }\n  }, [payload.ignoreWhitespace, payload.splitViewPreference])\n\n  //scroll to the top of the page on a soft nav\n  useEffect(() => {\n    if ((ssrSafeWindow?.scrollY ?? 0) > 0) {\n      ssrSafeWindow?.scrollTo(0, 0)\n    }\n  }, [payload.path])\n\n  // hook for fetching inline + discussion consolidated comment data\n  const {deferredCommentData, state} = useDeferredCommentData(payload.repo, payload.commit.oid)\n  const threadData = deferredCommentData?.threadMarkers\n\n  const DiffsHeader = () => {\n    return <DiffsHeaderComponent treeToggleElement={treeToggleElement} headerInfo={payload.headerInfo} />\n  }\n\n  if (payload.unavailableReason) {\n    return (\n      <CommitUnavailable\n        commit={payload.commit}\n        commitInfo={commitInfo}\n        unavailableReason={payload.unavailableReason}\n      />\n    )\n  }\n\n  const [completeDiffData, fileTreeData] = splitDiffEntryData(payload.diffEntryData)\n\n  const onCreatePermalink = () => {\n    const permalink = commitPath({\n      owner: payload.repo.ownerLogin,\n      repo: payload.repo.name,\n      commitish: payload.commit.oid,\n    })\n    window.history.pushState(null, document.title, permalink)\n  }\n\n  return (\n    <RelayEnvironmentProvider environment={relayEnvironment}>\n      <InlineCommentsProvider initialFiles={threadData}>\n        <GlobalCommands\n          commands={{\n            'commit-diff-view:create-permalink': onCreatePermalink,\n          }}\n        />\n        <SplitPageLayout>\n          <SplitPageLayout.Header>\n            <h1 className=\"sr-only\">{payload.commit.shortMessage}</h1>\n            <CommitInfo commit={payload.commit} commitInfo={commitInfo} />\n          </SplitPageLayout.Header>\n          <SplitPageLayout.Pane\n            position=\"start\"\n            sticky\n            sx={splitPagePaneHiddenSx}\n            divider={{regular: 'line', narrow: 'none'}}\n            widthStorageKey=\"diff-tree-pane-width\"\n            resizable={true}\n          >\n            <FileTree\n              diffs={fileTreeData}\n              onFileSelected={handleFileSelected}\n              unselectedFileExtensions={unselectedFileExtensions}\n              diffsHeader={<DiffsHeader />}\n              onFileExtensionsChange={handleFileExtensionsChange}\n            />\n          </SplitPageLayout.Pane>\n          <SplitPageLayout.Content\n            as=\"div\"\n            width=\"full\"\n            hidden={splitPageContentHidden}\n            padding=\"none\"\n            sx={{p: [3, 3, 3, 4], pt: [0, 0, 0, 0]}}\n          >\n            <SelectedDiffRowRangeContextProvider>\n              <DiffViewSettingsProvider viewSettings={viewSettings}>\n                <DiffsHeader />\n                {isSSR ? (\n                  <SSRDiffs\n                    diffEntryData={completeDiffData}\n                    contextLinePathURL={contextLinePathURL}\n                    repo={payload.repo}\n                    oid={payload.commit.oid}\n                  />\n                ) : (\n                  <DiffFindOpenProvider searchTerm={searchTerm} setSearchTerm={setSearchTerm}>\n                    <Diffs\n                      commitInfo={commitInfo}\n                      isStickied={isStickied}\n                      searchTerm={searchTerm}\n                      setSearchTerm={setSearchTerm}\n                      ignoreWhitespace={payload.ignoreWhitespace}\n                      diffEntryData={completeDiffData}\n                      contextLinePathURL={contextLinePathURL}\n                      unselectedFileExtensions={unselectedFileExtensions}\n                      selectedPathDigest={selectedPathDigest}\n                      repo={payload.repo}\n                      oid={payload.commit.oid}\n                    />\n                  </DiffFindOpenProvider>\n                )}\n                <DiscussionCommentsProvider\n                  comments={deferredCommentData?.discussionComments?.comments}\n                  commentCount={deferredCommentData?.discussionComments?.count}\n                  canLoadMore={deferredCommentData?.discussionComments?.canLoadMore}\n                  subscribed={deferredCommentData?.subscribed}\n                  providerState={state}\n                  repo={payload.repo}\n                  commitOid={payload.commit.oid}\n                >\n                  <DiscussionComments commit={payload.commit} commentInfo={payload.commentInfo} />\n                </DiscussionCommentsProvider>\n                {/* DiffPlaceholder is used for the skeleton placeholder when a diff isn't loaded, it needs to be\n              somewhere on the page so that it can be drawn from within the diff lines component.  */}\n                <DiffPlaceholder />\n              </DiffViewSettingsProvider>\n            </SelectedDiffRowRangeContextProvider>\n          </SplitPageLayout.Content>\n        </SplitPageLayout>\n      </InlineCommentsProvider>\n    </RelayEnvironmentProvider>\n  )\n}\n\ntry{ Commit.displayName ||= 'Commit' } catch {}\ntry{ DiffsHeader.displayName ||= 'DiffsHeader' } catch {}","import {CurrentRepositoryProvider} from '@github-ui/current-repository'\nimport {CurrentUserProvider} from '@github-ui/current-user'\nimport {useRoutePayload} from '@github-ui/react-core/use-route-payload'\nimport type React from 'react'\nimport {useState} from 'react'\n\nimport type {CommitsBasePayload} from './types/shared'\n\n/**\n * The App component is used to render content which should be present on _all_ routes within this app\n */\nexport function App(props: {children?: React.ReactNode}) {\n  const payload = useRoutePayload<CommitsBasePayload>()\n  const [repo] = useState(payload?.repo)\n  const [user] = useState(payload?.currentUser)\n\n  return (\n    <CurrentUserProvider user={user}>\n      <CurrentRepositoryProvider repository={repo}>{props.children}</CurrentRepositoryProvider>\n    </CurrentUserProvider>\n  )\n}\n\ntry{ App.displayName ||= 'App' } catch {}","import {type Repository, useCurrentRepository} from '@github-ui/current-repository'\nimport {branchPath, issueLinkedPullRequestHovercardPath, pullRequestPath} from '@github-ui/paths'\nimport {LoadingSkeleton} from '@github-ui/skeleton/LoadingSkeleton'\nimport {GitBranchIcon} from '@primer/octicons-react'\nimport {BranchName, Link, Octicon} from '@primer/react'\nimport React from 'react'\n\nimport type {BranchCommitState, BranchInfo, LinkedPullRequest} from '../../hooks/use-load-branch-commits'\n\nexport interface CommitBranchInfoProps {\n  data: BranchCommitState\n}\n\nexport function CommitBranchInfo({data}: CommitBranchInfoProps) {\n  const repo = useCurrentRepository()\n\n  if (!data.loading && data.branches.length === 0) {\n    return null\n  }\n\n  return (\n    <div className=\"d-flex flex-items-center flex-wrap fgColor-muted border-bottom p-3 gap-1\">\n      <Octicon className=\"mr-1\" icon={GitBranchIcon} />\n      {data.loading ? (\n        <LoadingSkeleton width=\"60px\" variant=\"rounded\" height=\"22px\" />\n      ) : (\n        data.branches.map((branch, branchIndex) => {\n          return (\n            <div key={branch.branch}>\n              <BranchFragment branch={branch} repo={repo} />\n\n              {branchIndex !== data.branches.length - 1 ? <span className=\"ml-1 user-select-none\">+</span> : null}\n            </div>\n          )\n        })\n      )}\n    </div>\n  )\n}\n\nfunction BranchFragment({branch, repo}: {branch: BranchInfo; repo: Repository}) {\n  return (\n    <>\n      <BranchName className=\"mx-1\" href={branchPath({owner: repo.ownerLogin, repo: repo.name, branch: branch.branch})}>\n        {branch.branch}\n      </BranchName>\n      {branch.prs.length > 0 ? (\n        <>\n          {'('}\n          {branch.prs.map((pr, index) => (\n            <React.Fragment key={`pr-${pr.repo.ownerLogin}-${pr.repo.name}-${pr.number}`}>\n              <PullRequestLink pullRequest={pr} />\n              {index !== branch.prs.length - 1 ? <>,&nbsp;</> : null}\n            </React.Fragment>\n          ))}\n          {')'}\n        </>\n      ) : null}\n    </>\n  )\n}\n\nfunction PullRequestLink({pullRequest}: {pullRequest: LinkedPullRequest}) {\n  const {repo, number, showPrefix} = pullRequest\n  const prefix = showPrefix ? `${repo.ownerLogin}/${repo.name}` : ''\n\n  return (\n    <Link\n      href={pullRequestPath({repo, number})}\n      className=\"fgColor-muted\"\n      data-hovercard-url={issueLinkedPullRequestHovercardPath({\n        owner: repo.ownerLogin,\n        repo: repo.name,\n        pullRequestNumber: number,\n      })}\n    >\n      {prefix}#{number}\n    </Link>\n  )\n}\n\ntry{ CommitBranchInfo.displayName ||= 'CommitBranchInfo' } catch {}\ntry{ BranchFragment.displayName ||= 'BranchFragment' } catch {}\ntry{ PullRequestLink.displayName ||= 'PullRequestLink' } catch {}","import {type Repository, useCurrentRepository} from '@github-ui/current-repository'\nimport {tagPath} from '@github-ui/paths'\nimport {KebabHorizontalIcon, TagIcon} from '@primer/octicons-react'\nimport {ActionList, IconButton, Link, Octicon} from '@primer/react'\nimport {Dialog} from '@primer/react/experimental'\nimport {useCallback, useRef, useState} from 'react'\n\nimport type {BranchCommitState} from '../../hooks/use-load-branch-commits'\n\nexport interface CommitTagInfoProps {\n  data: BranchCommitState\n}\n\nexport function CommitTagInfo({data}: CommitTagInfoProps) {\n  const repo = useCurrentRepository()\n\n  if (data.tags.length === 0) {\n    return null\n  }\n\n  const renderTagsInLine = data.tags.length > 2 && data.tags.length < 25\n  const renderTagsInDialog = data.tags.length >= 25\n\n  return (\n    <div className=\"d-flex flex-items-center flex-wrap border-bottom p-3 gap-1\">\n      <Octicon className=\"mr-2\" icon={TagIcon} />\n\n      <Link href={tagPath({owner: repo.ownerLogin, repo: repo.name, tag: data.tags[0]!})} className=\"fgColor-default\">\n        {data.tags[0]}\n      </Link>\n\n      {renderTagsInLine ? <ExpandedTags tags={data.tags} repo={repo} /> : null}\n      {renderTagsInDialog ? <CommitTagsDialog tags={data.tags} repo={repo} /> : null}\n\n      {data.tags.length > 1 ? (\n        <Link\n          href={tagPath({owner: repo.ownerLogin, repo: repo.name, tag: data.tags[data.tags.length - 1]!})}\n          className=\"fgColor-muted\"\n        >\n          {data.tags[data.tags.length - 1]}\n        </Link>\n      ) : null}\n    </div>\n  )\n}\n\nfunction ExpandedTags({tags, repo}: {tags: string[]; repo: Repository}) {\n  const [tagsExpanded, setTagsExpanded] = useState(false)\n  const firstExpandedTagRef = useRef<HTMLAnchorElement>(null)\n\n  const onExpand = useCallback(() => {\n    setTagsExpanded(true)\n    requestAnimationFrame(() => firstExpandedTagRef.current?.focus())\n  }, [])\n\n  return tagsExpanded ? (\n    <>\n      {tags.slice(1, tags.length - 1).map((tag, index) => {\n        return (\n          <Link\n            ref={index === 0 ? firstExpandedTagRef : null}\n            href={tagPath({owner: repo.ownerLogin, repo: repo.name, tag})}\n            className=\"fgColor-muted mx-1\"\n            key={tag}\n          >\n            {tag}\n          </Link>\n        )\n      })}\n    </>\n  ) : (\n    // eslint-disable-next-line primer-react/a11y-remove-disable-tooltip\n    <IconButton\n      aria-label=\"Show more tags\"\n      unsafeDisableTooltip={true}\n      icon={KebabHorizontalIcon}\n      size=\"small\"\n      variant=\"invisible\"\n      onClick={onExpand}\n    />\n  )\n}\n\nfunction CommitTagsDialog({tags, repo}: {tags: string[]; repo: Repository}) {\n  const [dialogOpen, setDialogOpen] = useState(false)\n  const returnFocusRef = useRef(null)\n\n  return (\n    <>\n      {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n      <IconButton\n        aria-label=\"Show all tags\"\n        unsafeDisableTooltip={true}\n        icon={KebabHorizontalIcon}\n        size=\"small\"\n        variant=\"invisible\"\n        onClick={() => setDialogOpen(true)}\n        ref={returnFocusRef}\n      />\n      {dialogOpen && (\n        <Dialog\n          title={`${tags.length} tags`}\n          onClose={() => setDialogOpen(false)}\n          returnFocusRef={returnFocusRef}\n          width=\"medium\"\n          height={tags.length >= 12 ? 'small' : 'auto'}\n          renderBody={() => {\n            return (\n              <ActionList className=\"overflow-y-auto py-2\" data-testid=\"tag-dialog-list\">\n                {tags.map(tag => (\n                  <ActionList.LinkItem key={tag} href={tagPath({owner: repo.ownerLogin, repo: repo.name, tag})}>\n                    {tag}\n                  </ActionList.LinkItem>\n                ))}\n              </ActionList>\n            )\n          }}\n        />\n      )}\n    </>\n  )\n}\n\ntry{ CommitTagInfo.displayName ||= 'CommitTagInfo' } catch {}\ntry{ ExpandedTags.displayName ||= 'ExpandedTags' } catch {}\ntry{ CommitTagsDialog.displayName ||= 'CommitTagsDialog' } catch {}","import {AlertIcon} from '@primer/octicons-react'\nimport {Flash, Octicon} from '@primer/react'\n\nexport function SpoofedCommitWarningBanner() {\n  return (\n    <Flash variant=\"warning\" className=\"mb-4\">\n      <Octicon icon={AlertIcon} className=\"mr-2\" />\n      <span className=\"overflow-hidden\">\n        This commit does not belong to any branch on this repository, and may belong to a fork outside of the\n        repository.\n      </span>\n    </Flash>\n  )\n}\n\ntry{ SpoofedCommitWarningBanner.displayName ||= 'SpoofedCommitWarningBanner' } catch {}","import type {Repository} from '@github-ui/current-repository'\nimport {Box, Flash} from '@primer/react'\n\nimport {isWeirichCommit} from '../../utils/weirich-commit'\n\nexport function WeirichCommitBanner({oid, repo}: {oid: string; repo: Repository}) {\n  if (!isWeirichCommit(oid, repo.id)) {\n    return null\n  }\n\n  return (\n    <Flash className=\"mb-4\">\n      <Box\n        as=\"img\"\n        src=\"/images/modules/commit/flowers@2x.png\"\n        alt=\"flower image\"\n        className=\"mr-4 mt-1 float-left\"\n        sx={{width: '88px', height: '49px'}}\n      />\n      <h2>Thanks for everything, Jim.</h2>\n      <p>We will miss you.</p>\n    </Flash>\n  )\n}\n\ntry{ WeirichCommitBanner.displayName ||= 'WeirichCommitBanner' } catch {}","import {useCurrentRepository} from '@github-ui/current-repository'\nimport {commitHovercardPath, commitPath, repositoryTreePath} from '@github-ui/paths'\nimport {Link} from '@github-ui/react-core/link'\nimport {useFeatureFlag} from '@github-ui/react-core/use-feature-flag'\nimport {SafeHTMLText} from '@github-ui/safe-html'\nimport {SignedCommitBadge} from '@github-ui/signed-commit-badge'\nimport {LoadingSkeleton} from '@github-ui/skeleton/LoadingSkeleton'\nimport {FileCodeIcon} from '@primer/octicons-react'\nimport {Button, Label, Link as PrimerLink} from '@primer/react'\nimport {Tooltip} from '@primer/react/next'\nimport {Fragment} from 'react'\n\nimport {useCommitsAppPayload} from '../../hooks/use-commits-app-payload'\nimport type {BranchCommitState} from '../../hooks/use-load-branch-commits'\nimport {useLoadSingleDeferredCommitData} from '../../shared/use-load-deferred-commit-data'\nimport type {CommitExtended} from '../../types/commit-types'\nimport {grabAndAppendUrlParameters} from '../../utils/grab-and-append-url-parameters'\nimport {shortSha} from '../../utils/short-sha'\nimport {AsyncChecksStatusBadge} from '../AsyncChecksStatusBadge'\nimport {CommitAttribution} from '../CommitAttribution'\nimport {verifiedBadgeWidth} from '../CommitRowBadges'\nimport {CopySHA} from '../CopySHA'\nimport {Panel} from '../Panel'\nimport {CommitBranchInfo} from './CommitBranchInfo'\nimport {CommitTagInfo} from './CommitTagInfo'\nimport {SpoofedCommitWarningBanner} from './SpoofedCommitWarningBanner'\nimport {WeirichCommitBanner} from './WeirichCommitBanner'\n\ninterface CommitInfoProps {\n  commit: CommitExtended\n  commitInfo: BranchCommitState\n}\n\nconst alphaFeedback = {\n  badgeLabel: 'Alpha',\n  // swap this out for the real feedback link when we have it\n  feedbackLink: 'https://github-grid.enterprise.slack.com/archives/C0357UQ03KN',\n}\n\nconst betaFeedback = {\n  badgeLabel: 'Beta',\n  feedbackLink: 'https://gh.io/diff-refresh-feedback',\n}\n\nexport function CommitInfo({commit, commitInfo}: CommitInfoProps) {\n  const diffUXRefreshBeta = useFeatureFlag('diff_ux_refresh_beta')\n  const {feedbackLink, badgeLabel} = diffUXRefreshBeta ? betaFeedback : alphaFeedback\n\n  const repo = useCurrentRepository()\n  const {helpUrl} = useCommitsAppPayload()\n\n  const deferredData = useLoadSingleDeferredCommitData(\n    `${commitPath({owner: repo.ownerLogin, repo: repo.name, commitish: commit.oid})}/deferred_commit_data`,\n  )\n  let checkStatusCount = ''\n  try {\n    checkStatusCount = deferredData?.statusCheckStatus?.short_text?.split('checks')[0]?.trim() || ''\n  } catch {\n    //noop\n  }\n\n  return (\n    <div>\n      {!commitInfo.loading && commitInfo.branches.length === 0 ? <SpoofedCommitWarningBanner /> : null}\n      <WeirichCommitBanner oid={commit.oid} repo={repo} />\n\n      <Panel>\n        {/* Title and description */}\n        <div className=\"d-flex flex-column bgColor-muted p-3 border-bottom rounded-top-2\">\n          <div className=\"d-flex flex-justify-end flex-md-justify-between flex-column-reverse flex-md-row gap-2\">\n            <div className=\"d-flex flex-items-center flex-wrap gap-2\">\n              <SafeHTMLText html={commit.shortMessageMarkdown} className=\"markdown-title f4 text-semibold\" />\n              <AsyncChecksStatusBadge\n                oid={commit.oid}\n                status={deferredData?.statusCheckStatus?.state}\n                descriptionString={checkStatusCount}\n                repo={repo}\n              />\n            </div>\n            <div className=\"d-flex gap-2 flex-items-center flex-justify-between flex-md-justify-end\">\n              <div className=\"d-flex flex-items-center gap-2\">\n                <Label className=\"v-align-middle\" variant=\"success\">\n                  {badgeLabel}\n                </Label>\n\n                <PrimerLink href={feedbackLink} target=\"_blank\" rel=\"noopener noreferrer\" className=\"no-wrap\">\n                  Give feedback\n                </PrimerLink>\n              </div>\n\n              <Tooltip text=\"Browse the repository at this point in the history\">\n                <Button\n                  as={PrimerLink}\n                  href={repositoryTreePath({repo, action: 'tree', commitish: commit.oid})}\n                  leadingVisual={FileCodeIcon}\n                >\n                  Browse files\n                </Button>\n              </Tooltip>\n            </div>\n          </div>\n          {commit.bodyMessageHtml && (\n            <SafeHTMLText\n              html={commit.bodyMessageHtml}\n              className=\"ws-pre-wrap extended-commit-description-container pt-2 f6 fgColor-muted wb-break-word text-mono\"\n            />\n          )}\n        </div>\n        <CommitBranchInfo data={commitInfo} />\n        <CommitTagInfo data={commitInfo} />\n        {/* Commit attribution */}\n        <div className=\"d-flex flex-justify-between p-3 gap-2 flex-column flex-md-row\">\n          <CommitAttribution\n            commit={commit}\n            repo={repo}\n            settings={{fontColor: 'fg.default', avatarSize: 20, fontWeight: 'bold'}}\n          >\n            {deferredData ? (\n              deferredData.signatureInformation ? (\n                <div className=\"pl-2\">\n                  <SignedCommitBadge\n                    commitOid={commit.oid}\n                    hasSignature={true}\n                    verificationStatus={deferredData.verifiedStatus}\n                    signature={{helpUrl, ...deferredData.signatureInformation}}\n                  />\n                </div>\n              ) : null\n            ) : (\n              <LoadingSkeleton className=\"ml-2\" variant=\"rounded\" width={verifiedBadgeWidth} />\n            )}\n          </CommitAttribution>\n          <pre className=\"color-fg-muted d-flex flex-items-center\">\n            {`${commit.parents.length} parent${commit.parents.length > 1 || commit.parents.length === 0 ? 's' : ''} `}\n            {commit.parents.map((parent, index) => {\n              return (\n                <Fragment key={parent}>\n                  {index !== 0 ? ' + ' : ''}\n                  <PrimerLink\n                    to={\n                      commitPath({owner: repo.ownerLogin, repo: repo.name, commitish: parent}) +\n                      grabAndAppendUrlParameters()\n                    }\n                    as={Link}\n                    className=\"color-fg-default Link--inTextBlock\"\n                    data-hovercard-url={commitHovercardPath({\n                      owner: repo.ownerLogin,\n                      repo: repo.name,\n                      commitish: parent,\n                    })}\n                  >\n                    {shortSha(parent)}\n                  </PrimerLink>\n                </Fragment>\n              )\n            })}\n            {' commit '}\n            <span className=\"fgColor-default\">{shortSha(commit.oid)}</span>\n            <CopySHA sha={commit.oid} direction=\"sw\" />\n          </pre>\n        </div>\n      </Panel>\n    </div>\n  )\n}\n\ntry{ CommitInfo.displayName ||= 'CommitInfo' } catch {}","import {ssrSafeLocation} from '@github-ui/ssr-utils'\n\nexport function grabAndAppendUrlParameters() {\n  const urlObject = new URL(\n    ssrSafeLocation.origin + ssrSafeLocation.pathname + ssrSafeLocation.search,\n    ssrSafeLocation.origin,\n  )\n\n  // return just the search params already appended for soft navs to keep it consistent\n  return urlObject.search\n}\n","/* eslint eslint-comments/no-use: off */\n/* eslint-disable primer-react/no-system-props */\nimport {contactPath} from '@github-ui/paths'\nimport {AlertIcon, HourglassIcon} from '@primer/octicons-react'\nimport {Blankslate, Stack} from '@primer/react/drafts'\n\nimport type {BranchCommitState} from '../../hooks/use-load-branch-commits'\nimport type {CommitExtended, CommitPayload} from '../../types/commit-types'\nimport {CommitInfo} from './CommitInfo'\n\nexport function CommitUnavailable({\n  unavailableReason,\n  commit,\n  commitInfo,\n}: {\n  unavailableReason: NonNullable<CommitPayload['unavailableReason']>\n  commit: CommitExtended\n  commitInfo: BranchCommitState\n}) {\n  const unavailableReasonMetadata = unavailableReasonsMap[unavailableReason]\n\n  return (\n    <>\n      <Stack data-hpc padding={{narrow: 'normal', regular: 'spacious'}}>\n        <h1 className=\"sr-only\">{commit.shortMessage}</h1>\n        <CommitInfo commit={commit} commitInfo={commitInfo} />\n      </Stack>\n      <Blankslate>\n        <Blankslate.Visual>{unavailableReasonMetadata.visual}</Blankslate.Visual>\n        <Blankslate.Heading>{unavailableReasonMetadata.heading}</Blankslate.Heading>\n        <Blankslate.Description>{unavailableReasonMetadata.description}</Blankslate.Description>\n        {unavailableReasonMetadata.secondaryAction}\n      </Blankslate>\n    </>\n  )\n}\n\ntype UnavailableReasonMetadata = {\n  visual: React.ReactNode\n  heading: string\n  description: string\n  secondaryAction?: React.ReactNode\n}\n\nconst unavailableReasonsMap: Record<NonNullable<CommitPayload['unavailableReason']>, UnavailableReasonMetadata> = {\n  corrupt: {\n    visual: <AlertIcon />,\n    heading: 'Sorry, this diff is unavailable.',\n    description: 'The repository may be missing relevant data.',\n    secondaryAction: (\n      <Blankslate.SecondaryAction href={contactPath()}>\n        Please contact support for more information\n      </Blankslate.SecondaryAction>\n    ),\n  },\n  'missing commits': {\n    visual: <AlertIcon />,\n    heading: 'Sorry, this diff is unavailable.',\n    description: 'The repository may be missing relevant data.',\n    secondaryAction: (\n      <Blankslate.SecondaryAction href={contactPath()}>\n        Please contact support for more information\n      </Blankslate.SecondaryAction>\n    ),\n  },\n  timeout: {\n    visual: <HourglassIcon />,\n    heading: 'Sorry, this diff is taking too long to generate.',\n    description: 'It may be too large to display on GitHub.',\n  },\n  'too busy': {\n    visual: <HourglassIcon />,\n    heading: 'Sorry, this diff is temporarily unavailable due to heavy server load.',\n    description: 'Please try again later.',\n  },\n}\n\ntry{ CommitUnavailable.displayName ||= 'CommitUnavailable' } catch {}","// eslint-disable-next-line import/no-deprecated\nimport {useVerifiedFetch} from '@github-ui/use-verified-fetch'\n\nimport type {SplitPreference} from '../types/commit-types'\n\nconst UPDATE_SPLIT_PREFERENCES_URL = '/users/diffview'\n\nexport function useUpdateUserSplitPreference() {\n  // eslint-disable-next-line import/no-deprecated\n  const updateToSplit = useVerifiedFetch<void>(`${UPDATE_SPLIT_PREFERENCES_URL}?diff=split`, 'post')\n  // eslint-disable-next-line import/no-deprecated\n  const updateToUnified = useVerifiedFetch<void>(`${UPDATE_SPLIT_PREFERENCES_URL}?diff=unified`, 'post')\n\n  async function updateSplitPreferences(splitPreference: SplitPreference) {\n    if (splitPreference === 'split') {\n      await updateToSplit()\n    } else if (splitPreference === 'unified') {\n      await updateToUnified()\n    }\n  }\n\n  return updateSplitPreferences\n}\n","import {useNavigate, useSearchParams} from '@github-ui/use-navigate'\nimport type React from 'react'\nimport {createContext, useCallback, useContext, useMemo, useState} from 'react'\n\nimport {useUpdateUserSplitPreference} from '../hooks/use-update-user-split-preference'\nimport type {DiffViewSettings, SplitPreference} from '../types/commit-types'\n\nconst defaultViewSettings: DiffViewSettingsContextProps = {\n  hideWhitespace: false,\n  splitPreference: 'split',\n  updateHideWhitespace: () => {},\n  updateSplitPreference: () => {},\n}\n\ntype DiffViewSettingsContextProps = {\n  updateHideWhitespace: (newPreference: boolean) => void\n  updateSplitPreference: (newPreference: SplitPreference) => void\n} & DiffViewSettings\n\nconst DiffViewSettingsContext = createContext<DiffViewSettingsContextProps>(defaultViewSettings)\n\nexport function DiffViewSettingsProvider({\n  viewSettings,\n  children,\n}: React.PropsWithChildren<{viewSettings: DiffViewSettings}>) {\n  const navigate = useNavigate()\n\n  // user + query params preferences\n  const userSplitPreference = useSplitViewPreference(viewSettings.splitPreference)\n  const userWhitespaceParam = useWhitespacePreference(viewSettings.hideWhitespace)\n\n  // context state variables\n  const [splitPreference, setSplitPreference] = useState(userSplitPreference)\n  const [hideWhitespace, setHideWhitespace] = useState(userWhitespaceParam)\n\n  // update user preferences\n  const updateUserSplitPreference = useUpdateUserSplitPreference()\n\n  const updateSplitPreference = useCallback(\n    (newPreference: SplitPreference) => {\n      updateQueryParam('diff', newPreference)\n      setSplitPreference(newPreference)\n      updateUserSplitPreference(newPreference)\n    },\n    [updateUserSplitPreference],\n  )\n\n  const updateHideWhitespace = useCallback(\n    (newPreference: boolean) => {\n      setHideWhitespace(newPreference)\n      navigate(`${window.location.pathname}?w=${newPreference ? '1' : '0'}`)\n    },\n    [navigate],\n  )\n\n  const diffViewSettings = useMemo(\n    () => ({\n      hideWhitespace,\n      splitPreference,\n      updateHideWhitespace,\n      updateSplitPreference,\n    }),\n    [hideWhitespace, splitPreference, updateHideWhitespace, updateSplitPreference],\n  )\n\n  return <DiffViewSettingsContext.Provider value={diffViewSettings}>{children}</DiffViewSettingsContext.Provider>\n}\n\nexport function useDiffViewSettings() {\n  return useContext(DiffViewSettingsContext)\n}\n\nfunction useSplitViewPreference(defaultPreference: SplitPreference): SplitPreference {\n  let splitPreference = defaultPreference\n\n  const [searchParams] = useSearchParams()\n  const splitPreferenceParam = searchParams.get('diff')\n\n  if (splitPreferenceParam === 'split' || splitPreferenceParam === 'unified') {\n    splitPreference = splitPreferenceParam\n  }\n\n  return splitPreference\n}\n\nfunction useWhitespacePreference(defaultPreference: boolean): boolean {\n  let hideWhitespace = defaultPreference\n\n  const [searchParams] = useSearchParams()\n  const whitespaceParam = searchParams.get('w')\n\n  if (whitespaceParam === '1') {\n    hideWhitespace = true\n  } else if (whitespaceParam === '0') {\n    hideWhitespace = false\n  }\n\n  return hideWhitespace\n}\n\nfunction updateQueryParam(paramName: string, value: string) {\n  const url = new URL(window.location.href, window.location.origin)\n\n  if (value) {\n    const encodedValue = encodeURIComponent(value)\n    url.searchParams.set(paramName, encodedValue)\n  } else {\n    url.searchParams.delete(paramName)\n  }\n  window.history.replaceState({path: url.toString()}, '', url.toString())\n}\n\ntry{ DiffViewSettingsContext.displayName ||= 'DiffViewSettingsContext' } catch {}\ntry{ DiffViewSettingsProvider.displayName ||= 'DiffViewSettingsProvider' } catch {}","import {verifiedFetchJSON} from '@github-ui/verified-fetch'\nimport {useEffect, useRef, useState} from 'react'\n\nimport type {DiffEntryDataWithExtraInfo} from '../types/commit-types'\n\ninterface ExtraDiffType {\n  extraDiffEntries: DiffEntryDataWithExtraInfo[]\n  loading: boolean\n  error: boolean\n}\n\nconst baseEmptyStateLoading = {extraDiffEntries: [], loading: true, error: false}\n\nexport function useLoadDeferredDiffs(\n  byteCount: number,\n  lineShownCount: number,\n  startIndex: number,\n  url: string,\n  shouldSendRequest: boolean,\n  ignoreWhitespace: boolean,\n): ExtraDiffType {\n  const [state, setState] = useState<ExtraDiffType>(baseEmptyStateLoading)\n  const cumulativeDiffEntries = useRef([] as DiffEntryDataWithExtraInfo[])\n  const previousStartingIndex = useRef(startIndex)\n\n  useEffect(() => {\n    if (!url || !shouldSendRequest) return\n\n    let cancelled = false\n    const update = async (startingIndex: number, bytesCount: number, linesShownCount: number) => {\n      setState(baseEmptyStateLoading)\n      const response = await verifiedFetchJSON(\n        `${url}?start_entry=${startingIndex}&bytes=${bytesCount}&lines=${linesShownCount}`,\n      )\n\n      if (cancelled) {\n        return\n      }\n\n      try {\n        if (response.ok) {\n          const data = await response.json()\n          if (data) {\n            data.loading = data.loadMore\n            cumulativeDiffEntries.current = cumulativeDiffEntries.current.concat(data.extraDiffEntries)\n            data.extraDiffEntries = cumulativeDiffEntries.current\n            if (data.loadMore && previousStartingIndex.current !== data.asyncDiffLoadInfo.startIndex) {\n              previousStartingIndex.current = data.asyncDiffLoadInfo.startIndex\n              setState(data)\n              setTimeout(\n                //doing a 0ms timeout allows the state updates to flush, giving the user the parts of the diff\n                //as we get them rather than waiting until they're fully loaded\n                () =>\n                  update(\n                    data.asyncDiffLoadInfo.startIndex,\n                    data.asyncDiffLoadInfo.byteCount,\n                    data.asyncDiffLoadInfo.lineShownCount,\n                  ),\n                0,\n              )\n            } else if (previousStartingIndex.current === data.asyncDiffLoadInfo.startIndex) {\n              data.error = true\n              data.loading = false\n              setState(data)\n            } else {\n              //TODO: all state changes are saved for the very end of an effect, but we ideally would\n              //progressively be adding diffs as they were loading rather than waiting for them all to load...\n              //unsure the best way to handle that\n              data.error = false\n              data.loading = false\n              setState(data)\n            }\n          }\n        } else {\n          setState(oldState => ({\n            ...oldState,\n            loading: false,\n            error: true,\n            extraDiffEntries: cumulativeDiffEntries.current,\n          }))\n        }\n      } catch (e) {\n        //do this to keep any diffs we  have already received rather than wiping them out\n        setState(oldState => ({\n          ...oldState,\n          loading: false,\n          error: true,\n          extraDiffEntries: cumulativeDiffEntries.current,\n        }))\n      }\n    }\n\n    update(startIndex, byteCount, lineShownCount)\n\n    return function cancel() {\n      cancelled = true\n    }\n  }, [byteCount, lineShownCount, shouldSendRequest, startIndex, url, ignoreWhitespace])\n\n  //if we soft nav to a new diff, reset the cumulative\n  useEffect(() => {\n    cumulativeDiffEntries.current = []\n    previousStartingIndex.current = startIndex\n  }, [url, startIndex, ignoreWhitespace])\n\n  return state\n}\n","import {NO_FILE_EXTENSION} from '@github-ui/diff-file-tree/file-filter'\n\nexport function getFileExtension(path: string) {\n  if (!path) {\n    return ''\n  }\n\n  const lastPeriodIndex = path.lastIndexOf('.')\n\n  if (!lastPeriodIndex || lastPeriodIndex < 0) {\n    return NO_FILE_EXTENSION\n  }\n\n  return `.${path.substring(lastPeriodIndex + 1)}`\n}\n","import type {SxProp} from '@primer/react'\n\nexport const filesChangedHeaderHeightNumber = 64 //split page layout padding normal\nexport const mobileFilesChangedHeaderHeightNumber = 56 //split page layout padding condensed (when < 768px)\nexport const stickyHeaderHeight = 60 // height to be used when scrolling to a PR, the 4px difference looks nicer\n\nexport const fileStickyHeaderMargin = (filesChangedHeaderHeight: number, offset = 0) =>\n  `calc(${filesChangedHeaderHeight}px + ${offset}px)`\n\nexport const stickyDiffHeaderSx: SxProp['sx'] = {\n  position: 'sticky',\n  zIndex: 1,\n  // backgroundColor, pl, pr, ml, mr values are being used here to hide the actionbar element behind right side of the DiffFileHeaderListView\n  // when it intersects with the DiffFileHeaderListView on the right side of the DiffEntry\n  backgroundColor: 'canvas.default',\n  // :before is used to cover up scrolling content behind the sticky header rounded corners\n  // it also needs to go beyond the parent border to cover box shadow from the parent\n  '&::before': {\n    bg: 'canvas.default',\n    content: '\"\"',\n    position: 'absolute',\n    display: 'block',\n    height: '100%',\n    width: 'calc(100% + 30px)', // Would be set to 32px but we need to offset the left border to address resizable sidebar\n    ml: '-14px', // Need to use a magic variable to make sure negative margin does not overlap with resizable sidebar from the navigation\n    mr: -3,\n  },\n}\n","import type {RepositoryNWO} from '@github-ui/current-repository'\nimport type {DiffLine} from '@github-ui/diff-lines'\nimport {getInsightsUrl, reportTraceData} from '@github-ui/internal-api-insights'\nimport {diffLinesPath} from '@github-ui/paths'\nimport {reactFetchJSON} from '@github-ui/verified-fetch'\n\ntype DiffLinesResponse = {\n  diffLines: DiffLine[]\n}\n\ntype LoadDiffLinesProps = {\n  repo: RepositoryNWO\n  sha1: string\n  sha2: string\n  /**\n   * The index of the diff entry to load\n   */\n  entry: string\n}\nexport type ContextLineRange = {\n  start: number\n  end: number\n}\n\nexport type ContextLineResponse = {\n  diffEntryWithContext: DiffLine[]\n}\n\nfunction getRangesAsSeparateURLParams(contextLineRanges: ContextLineRange[]) {\n  let returnString = ''\n  for (let i = 0; i < contextLineRanges.length; i++) {\n    returnString += `&lineRanges[]=${JSON.stringify(contextLineRanges[i])}`\n  }\n  return returnString\n}\n\nexport function useDiffLines() {\n  return {fetchInjectedContextLines, fetchDiffLines}\n}\n\n/**\n * Fetches the context lines for a given diff entry\n */\nasync function fetchInjectedContextLines(\n  contextLineRanges: ContextLineRange[],\n  url: string,\n  pathDigest: string,\n): Promise<ContextLineResponse | undefined> {\n  const response = await reactFetchJSON(\n    `${url}?pathDigest=${pathDigest}${getRangesAsSeparateURLParams(contextLineRanges)}`,\n  )\n\n  if (response.ok) {\n    const data = await response.json()\n\n    return data ?? undefined\n  }\n}\n\n/**\n * Fetches the diff lines for a given diff entry\n * This is used when the diff is truncated (ie - deleted or generated)\n * The user can click on the \"Load more\" button to fetch the diff lines\n */\nasync function fetchDiffLines({repo, sha1, sha2, entry}: LoadDiffLinesProps) {\n  const response = await reactFetchJSON(\n    getInsightsUrl(\n      diffLinesPath({\n        owner: repo.ownerLogin,\n        repo: repo.name,\n        entry,\n        sha1,\n        sha2,\n      }),\n    ),\n  )\n\n  if (response.ok) {\n    const data: DiffLinesResponse = await response.json()\n    reportTraceData(data)\n    return data.diffLines\n  } else {\n    return undefined\n  }\n}\n","import {\n  CopilotDiffChatBlobActionsMenuItems,\n  type CopilotDiffChatBlobActionsMenuItemsProps,\n} from '@github-ui/copilot-code-chat/CopilotDiffChatBlobActionsMenuItems'\nimport type {Repository} from '@github-ui/current-repository'\nimport {blobPath} from '@github-ui/paths'\nimport {EyeIcon, KebabHorizontalIcon, PencilIcon, TrashIcon} from '@primer/octicons-react'\nimport {ActionList, ActionMenu} from '@primer/react'\n\ninterface BlobActionsMenuProps {\n  oid: string\n  path: string\n  repo: Repository\n  isViewable?: boolean\n  copilotDiffChatProps?: CopilotDiffChatBlobActionsMenuItemsProps\n}\n\nexport default function BlobActionsMenu({\n  oid,\n  path,\n  repo,\n  isViewable = true,\n  copilotDiffChatProps,\n}: BlobActionsMenuProps) {\n  return (\n    <ActionMenu>\n      <ActionMenu.Anchor>\n        <button className=\"Button Button--iconOnly Button--invisible\" aria-label=\"More options\">\n          <KebabHorizontalIcon />\n        </button>\n      </ActionMenu.Anchor>\n\n      <ActionMenu.Overlay>\n        <ActionList>\n          <ActionList.LinkItem\n            href={blobPath({\n              repo: repo.name,\n              owner: repo.ownerLogin,\n              filePath: path,\n              commitish: oid,\n            })}\n            inactiveText={isViewable ? undefined : 'Action unavailable'}\n          >\n            <ActionList.LeadingVisual>\n              <EyeIcon />\n            </ActionList.LeadingVisual>\n            View file\n          </ActionList.LinkItem>\n          <ActionList.Item inactiveText=\"Action unavailable\">\n            <ActionList.LeadingVisual>\n              <PencilIcon />\n            </ActionList.LeadingVisual>\n            Edit file\n          </ActionList.Item>\n          <ActionList.Item inactiveText=\"Action unavailable\">\n            <ActionList.LeadingVisual>\n              <TrashIcon />\n            </ActionList.LeadingVisual>\n            Delete file\n          </ActionList.Item>\n          {copilotDiffChatProps && <CopilotDiffChatBlobActionsMenuItems {...copilotDiffChatProps} />}\n        </ActionList>\n      </ActionMenu.Overlay>\n    </ActionMenu>\n  )\n}\n\ntry{ BlobActionsMenu.displayName ||= 'BlobActionsMenu' } catch {}","import {RichDiff} from '@github-ui/diff-lines'\nimport type {FileRendererBlobData} from '@github-ui/file-renderer-blob'\nimport type {SafeHTMLString} from '@github-ui/safe-html'\nimport {memo} from 'react'\n\nimport {useLoadRichDiffData} from '../../hooks/use-load-rich-diff-data'\n\nexport const CommitRichDiff = memo(function CommitRichDiff({\n  commitOid,\n  path,\n  proseDiffHtml,\n  fileRendererInfo,\n  dependencyDiffPath,\n}: {\n  commitOid: string\n  path: string\n  proseDiffHtml?: SafeHTMLString\n  fileRendererInfo?: FileRendererBlobData\n  dependencyDiffPath?: string\n}) {\n  const {loaded, richDiffData} = useLoadRichDiffData(\n    commitOid,\n    {proseDiffHtml, fileRendererInfo},\n    path,\n    dependencyDiffPath,\n  )\n\n  return (\n    <RichDiff\n      dependencyDiffPath={dependencyDiffPath}\n      fileRendererInfo={richDiffData.fileRendererInfo}\n      loading={!loaded}\n      proseDiffHtml={richDiffData.proseDiffHtml}\n    />\n  )\n})\n\ntry{ CommitRichDiff.displayName ||= 'CommitRichDiff' } catch {}","import {useCurrentRepository} from '@github-ui/current-repository'\nimport type {FileRendererBlobData} from '@github-ui/file-renderer-blob'\nimport {commitPath} from '@github-ui/paths'\nimport type {SafeHTMLString} from '@github-ui/safe-html'\nimport {verifiedFetchJSON} from '@github-ui/verified-fetch'\nimport {useCallback, useEffect, useState} from 'react'\n\nexport interface RichDiffData {\n  proseDiffHtml?: SafeHTMLString\n  fileRendererInfo?: FileRendererBlobData\n}\n\nexport function useLoadRichDiffData(\n  commitOid: string,\n  initialState: RichDiffData,\n  path: string,\n  dependencyDiffPath?: string,\n) {\n  const initiallyLoaded = !!initialState.proseDiffHtml || !!initialState.fileRendererInfo || !!dependencyDiffPath\n\n  const repo = useCurrentRepository()\n  const [loaded, setLoaded] = useState<boolean>(initiallyLoaded)\n  const [richDiffData, setRichDiffData] = useState<RichDiffData>(initialState)\n\n  const loadDiffData = useCallback(async () => {\n    const response = await verifiedFetchJSON(\n      `${commitPath({owner: repo.ownerLogin, repo: repo.name, commitish: commitOid})}/rich_diff/${encodeURIComponent(\n        path,\n      )}`,\n    )\n\n    if (response.ok) {\n      const data: RichDiffData = await response.json()\n      setRichDiffData(data)\n    }\n\n    setLoaded(true)\n  }, [commitOid, path, repo])\n\n  useEffect(() => {\n    if (!initiallyLoaded) {\n      loadDiffData()\n    }\n  }, [initiallyLoaded, loadDiffData])\n\n  return {loaded, richDiffData}\n}\n","import type {Repository} from '@github-ui/current-repository'\nimport {useCurrentUser} from '@github-ui/current-user'\nimport {DiffFileHeader} from '@github-ui/diff-file-header'\nimport {type DiffLine, DiffLines, type DiffMatchContent, type Thread} from '@github-ui/diff-lines'\nimport {Box} from '@primer/react'\nimport React, {useCallback, useEffect, useMemo, useRef, useState} from 'react'\n\nimport {type CommentThreadData, useInlineComments} from '../../contexts/InlineCommentsContext'\nimport {useCommentInfo} from '../../hooks/use-comment-info'\nimport {useDiffInlineCommenting} from '../../hooks/use-diff-inline-commenting'\nimport {useDiffInlineMarkerNav} from '../../hooks/use-diff-inline-marker-nav'\nimport {type ContextLineRange, useDiffLines} from '../../hooks/use-diff-lines'\nimport type {DiffEntryDataWithExtraInfo, ScrollToIndexOptions} from '../../types/commit-types'\nimport type {CurrentUserExtended} from '../../types/shared'\nimport {\n  filesChangedHeaderHeightNumber,\n  fileStickyHeaderMargin,\n  mobileFilesChangedHeaderHeightNumber,\n  stickyDiffHeaderSx,\n} from '../../utils/sticky-header-offset'\nimport BlobActionsMenu from './BlobActionsMenu'\nimport {CommitRichDiff} from './CommitRichDiff'\n\nconst diffLineContextToAddCount = 40\nconst maxLinesOfFileToExpandFullDiff = 5000\nconst subject = {\n  isInMergeQueue: false,\n  state: 'OPEN', //???\n}\n\ninterface DiffProps {\n  diffMatches?: DiffMatchContent[]\n  focusedSearchResult?: number\n  diffEntryData: React.MutableRefObject<DiffEntryDataWithExtraInfo[]>\n  splitPreference: 'split' | 'unified'\n  contextLinePathURL: string\n  recalcTotalHeightOfVirtualWindow: () => void\n  index: number\n  helpUrl: string\n  headerStickyOffset?: number\n  repo: Repository\n  oid: string\n  ignoreWhitespace: boolean\n  prId: string | undefined\n  virtualizerScrollTo?: (index: number, options?: ScrollToIndexOptions | undefined) => void\n}\n\nexport const Diff = React.memo(React.forwardRef(DiffUnmemoized))\n\nexport function DiffUnmemoized(\n  {\n    prId,\n    diffMatches,\n    focusedSearchResult,\n    diffEntryData,\n    splitPreference,\n    contextLinePathURL,\n    recalcTotalHeightOfVirtualWindow,\n    helpUrl,\n    headerStickyOffset = 0,\n    repo,\n    oid,\n    index,\n    ignoreWhitespace,\n    virtualizerScrollTo,\n  }: DiffProps,\n  ref: React.Ref<HTMLDivElement>,\n) {\n  const currentUser = useCurrentUser() as CurrentUserExtended | undefined\n  const commentingImplementation = useDiffInlineCommenting()\n  const markerNavigationImplementation = useDiffInlineMarkerNav()\n  const commentInfo = useCommentInfo()\n  const {getThreadDataByPathAndPosition} = useInlineComments()\n\n  const [diffEntryToUse, _setDiffEntryToUse] = useState(\n    mapThreadDataIntoDiffEntry(diffEntryData.current[index]!, getThreadDataByPathAndPosition),\n  )\n\n  const setDiffEntryToUse = useCallback(\n    (newDiffEntry: DiffEntryDataWithExtraInfo) => {\n      _setDiffEntryToUse(mapThreadDataIntoDiffEntry(newDiffEntry, getThreadDataByPathAndPosition))\n    },\n    [getThreadDataByPathAndPosition],\n  )\n\n  const [isCollapsed, setIsCollapsed] = useState(diffEntryToUse.collapsed)\n  const [showRichDiff, setShowRichDiff] = useState(diffEntryToUse.defaultToRichDiff)\n  const [linesManuallyUnhidden, setLinesManuallyUnhidden] = useState(diffEntryToUse.diffManuallyExpanded)\n  const toggleCollapse = () => {\n    diffEntryToUse.collapsed = !isCollapsed\n    diffEntryData.current[index]!.collapsed = !isCollapsed\n    setIsCollapsed(!isCollapsed)\n  }\n  const hasExpandedAllRanges = useRef(false)\n  const {fetchInjectedContextLines: getContextLines, fetchDiffLines} = useDiffLines()\n  const expandedRangesArray = useRef<ContextLineRange[]>([])\n\n  const dealWithInjectedLines = useCallback(\n    async (range: ContextLineRange) => {\n      expandedRangesArray.current.push(range)\n      const response = await getContextLines(expandedRangesArray.current, contextLinePathURL, diffEntryToUse.pathDigest)\n      if (response !== undefined) {\n        const prevDiffData = {...diffEntryToUse}\n        prevDiffData.diffLines = response.diffEntryWithContext\n        setDiffEntryToUse(prevDiffData)\n        diffEntryData.current[index] = prevDiffData\n        recalcTotalHeightOfVirtualWindow()\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [contextLinePathURL, diffEntryData, diffEntryToUse, index],\n  )\n\n  const expandAllContextLines = async () => {\n    expandedRangesArray.current = []\n    if (!hasExpandedAllRanges.current) {\n      if ((diffEntryToUse.newTreeEntry?.lineCount ?? 0) < maxLinesOfFileToExpandFullDiff) {\n        //if file is small just expand the whole thing\n        expandedRangesArray.current.push({\n          start: 1,\n          end: Math.max(diffEntryToUse.oldTreeEntry?.lineCount ?? 0, diffEntryToUse.newTreeEntry?.lineCount ?? 0),\n        })\n      } else {\n        //if the file is large, only expand relevant context rather than the entire file\n        expandedRangesArray.current = getRangesOutOfDiffLines(\n          diffEntryToUse.diffLines,\n          diffEntryToUse.newTreeEntry?.lineCount ?? 0,\n        )\n      }\n    }\n    hasExpandedAllRanges.current = !hasExpandedAllRanges.current\n    const response = await getContextLines(expandedRangesArray.current, contextLinePathURL, diffEntryToUse.pathDigest)\n    if (response !== undefined) {\n      const prevDiffData = {...diffEntryToUse}\n      prevDiffData.diffLines = response.diffEntryWithContext\n      setDiffEntryToUse(prevDiffData)\n      diffEntryData.current[index] = prevDiffData\n      recalcTotalHeightOfVirtualWindow()\n    }\n  }\n\n  const onLoadDiff = useCallback(async () => {\n    if (diffEntryToUse.diffLines.length === 0) {\n      const diffLines = await fetchDiffLines({\n        repo,\n        sha1: diffEntryToUse.oldOid,\n        sha2: diffEntryToUse.newOid,\n        entry: diffEntryToUse.diffNumber.toString(),\n      })\n\n      if (!diffLines) {\n        return\n      }\n\n      const prevDiffData = {...diffEntryToUse}\n      prevDiffData.diffLines = diffLines\n      setDiffEntryToUse(prevDiffData)\n      diffEntryData.current[index] = prevDiffData\n    }\n\n    diffEntryToUse.diffManuallyExpanded = true\n    diffEntryData.current[index]!.diffManuallyExpanded = true\n    setLinesManuallyUnhidden(true)\n    recalcTotalHeightOfVirtualWindow()\n    requestAnimationFrame(() => {\n      virtualizerScrollTo?.(index, {align: 'center'})\n    })\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [diffEntryData, diffEntryToUse, index, recalcTotalHeightOfVirtualWindow])\n\n  useEffect(() => {\n    setDiffEntryToUse(diffEntryData.current[index]!)\n    expandedRangesArray.current = []\n  }, [ignoreWhitespace, index, diffEntryData, oid, repo.name, repo.ownerLogin, diffEntryToUse.path, setDiffEntryToUse])\n\n  const canExpandOrCollapseLines = useMemo(() => {\n    if (hasExpandedAllRanges.current) return true\n    const firstDiffLineNumber = diffEntryData.current[index]?.diffLines?.[1]?.blobLineNumber || 0\n\n    if (firstDiffLineNumber > 1) return true\n\n    const initialDiffLineCount = diffEntryData.current[index]?.diffLines?.length || 0\n    const lastDiffLineNumber = diffEntryData.current[index]?.diffLines?.[initialDiffLineCount - 1]?.blobLineNumber || 0\n    const fileLineCount = diffEntryData.current[index]?.newTreeEntry?.lineCount || 0\n\n    //- 1 on the diff line count because there is always the top hunk diff line no matter what\n    if (lastDiffLineNumber < fileLineCount || initialDiffLineCount - 1 < fileLineCount) return true\n\n    return false\n  }, [\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    diffEntryData.current[index]?.diffLines,\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    diffEntryData.current[index]?.newTreeEntry?.lineCount,\n    index,\n    diffEntryData,\n  ])\n\n  const viewerData = useMemo(() => {\n    return {\n      avatarUrl: currentUser?.avatarURL ?? '',\n      diffViewPreference: splitPreference,\n      isSiteAdmin: false,\n      login: currentUser?.login ?? '',\n      tabSizePreference: currentUser?.tabSize ?? 8,\n      viewerCanComment: commentInfo.canComment,\n      viewerCanApplySuggestion: false,\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [splitPreference, currentUser?.avatarURL, currentUser, currentUser?.login, currentUser?.tabSize])\n\n  const copilotDiffChatProps = useMemo(() => {\n    if (!prId || !diffEntryToUse.copilotChatReferenceData) {\n      return undefined\n    }\n\n    return {\n      referenceData: diffEntryToUse.copilotChatReferenceData,\n      queryVariables: {\n        pullRequestId: prId,\n        startOid: diffEntryToUse.oldOid,\n        endOid: diffEntryToUse.newOid,\n      },\n    }\n  }, [diffEntryToUse, prId])\n\n  return (\n    <div className=\"position-relative\" ref={ref}>\n      <Box\n        sx={{\n          ...stickyDiffHeaderSx,\n          top: [\n            fileStickyHeaderMargin(mobileFilesChangedHeaderHeightNumber, headerStickyOffset),\n            fileStickyHeaderMargin(filesChangedHeaderHeightNumber, headerStickyOffset),\n          ],\n        }}\n      >\n        <DiffFileHeader\n          areLinesExpanded={hasExpandedAllRanges.current}\n          canExpandOrCollapseLines={canExpandOrCollapseLines}\n          defaultToRichDiff={diffEntryToUse.defaultToRichDiff}\n          fileLinkHref={`#diff-${diffEntryToUse.pathDigest}`}\n          isCollapsed={isCollapsed}\n          canToggleRichDiff={diffEntryToUse.canToggleRichDiff}\n          linesAdded={diffEntryToUse.linesAdded}\n          linesDeleted={diffEntryToUse.linesDeleted}\n          newMode={diffEntryToUse.newTreeEntry?.mode}\n          newPath={diffEntryToUse.newTreeEntry?.path}\n          oldMode={diffEntryToUse.oldTreeEntry?.mode}\n          oldPath={diffEntryToUse.oldTreeEntry?.path}\n          patchStatus={diffEntryToUse.status}\n          path={diffEntryToUse.path}\n          onToggleExpandAllLines={expandAllContextLines}\n          onToggleFileCollapsed={toggleCollapse}\n          onToggleDiffDisplay={rich => setShowRichDiff(rich)}\n          rightSideContent={\n            <BlobActionsMenu\n              oid={diffEntryToUse.status === 'REMOVED' && diffEntryToUse.deletedSha ? diffEntryToUse.deletedSha : oid}\n              path={diffEntryToUse.path}\n              repo={repo}\n              isViewable={!diffEntryToUse.isSubmodule}\n              copilotDiffChatProps={copilotDiffChatProps}\n            />\n          }\n        />\n      </Box>\n      {!isCollapsed ? (\n        <div className=\"border position-relative rounded-bottom-2\">\n          {showRichDiff ? (\n            <CommitRichDiff\n              commitOid={oid}\n              path={diffEntryToUse.path}\n              proseDiffHtml={diffEntryToUse.proseDifffHtml}\n              fileRendererInfo={diffEntryToUse.renderInfo}\n              dependencyDiffPath={diffEntryToUse.dependencyDiffPath}\n            />\n          ) : (\n            <DiffLines\n              diffContext={'commit'}\n              copilotChatReferenceData={prId ? diffEntryToUse.copilotChatReferenceData : undefined}\n              searchResults={diffMatches}\n              focusedSearchResult={focusedSearchResult}\n              diffEntryData={diffEntryToUse}\n              baseHelpUrl={helpUrl}\n              commentingEnabled={true}\n              commentBatchPending={false}\n              repositoryId={repo.id.toString()}\n              //the subject and subjectID are PR specific things, but we can likely use them for our\n              //commenting implementation as well\n              subject={subject}\n              subjectId={prId?.toString() ?? ''}\n              viewerData={viewerData}\n              newCommitOid={diffEntryToUse.newOid}\n              oldCommitOid={diffEntryToUse.oldOid}\n              addInjectedContextLines={dealWithInjectedLines}\n              commentingImplementation={commentingImplementation}\n              markerNavigationImplementation={markerNavigationImplementation}\n              diffLinesManuallyUnhidden={linesManuallyUnhidden}\n              onHandleLoadDiff={onLoadDiff}\n            />\n          )}\n        </div>\n      ) : null}\n    </div>\n  )\n}\n\nfunction getRangesOutOfDiffLines(currentLines: DiffLine[], fileLineCount: number) {\n  const currentRanges = [] as ContextLineRange[]\n\n  //the ranges can overlap and can also go higher than the number of lines in the file, which allows us to\n  //severely simplify this logic without caring too much\n  for (let i = 0; i < currentLines.length; i++) {\n    const currentLine = currentLines[i]\n    if (currentLine!.type === 'HUNK') {\n      const previousLine = currentLines[i - 1 >= 0 ? i - 1 : 0]\n      const nextLine = currentLines[i + 1 < currentLines.length ? i + 1 : currentLines.length - 1]\n      const previousLineNumber = previousLine?.blobLineNumber\n      const nextLineNumber = nextLine?.blobLineNumber\n      if (previousLineNumber && nextLineNumber) {\n        currentRanges.push({start: previousLineNumber, end: previousLineNumber + diffLineContextToAddCount})\n        currentRanges.push({start: Math.max(nextLineNumber - diffLineContextToAddCount, 1), end: nextLineNumber})\n      }\n    }\n  }\n  const lastLineNumber = currentLines[currentLines.length - 1]!.blobLineNumber\n  if (lastLineNumber < fileLineCount) {\n    currentRanges.push({start: lastLineNumber, end: lastLineNumber + diffLineContextToAddCount})\n  }\n  return currentRanges\n}\n\nfunction mapThreadDataIntoDiffEntry(\n  diffEntry: DiffEntryDataWithExtraInfo,\n  threadDataFetcher: (path: string, position: number) => CommentThreadData | undefined,\n) {\n  for (const diffLine of diffEntry.diffLines ?? []) {\n    const threadData = threadDataFetcher(diffEntry.path, diffLine.position!)\n\n    if (!threadData) {\n      diffLine.threadsData = undefined\n    } else {\n      diffLine.threadsData = {\n        totalCommentsCount: threadData.count,\n        totalCount: threadData.count,\n        threads: (threadData.threads ?? []).map(thread => {\n          const mapped: Thread = {\n            id: thread.id,\n            diffSide: thread.diffSide,\n            commentsData: thread.commentsData,\n            line: diffLine.blobLineNumber,\n            isOutdated: false,\n          }\n\n          return mapped\n        }),\n      }\n    }\n  }\n\n  return diffEntry\n}\n\ntry{ Diff.displayName ||= 'Diff' } catch {}\ntry{ DiffUnmemoized.displayName ||= 'DiffUnmemoized' } catch {}","import type {Comment, CommentingImplementation, Thread} from '@github-ui/conversations'\nimport type {DiffLine} from '@github-ui/diff-lines'\nimport {noop} from '@github-ui/noop'\nimport {useRoutePayload} from '@github-ui/react-core/use-route-payload'\nimport {useCallback, useMemo} from 'react'\n\nimport {useInlineComments} from '../contexts/InlineCommentsContext'\nimport type {CommitPayload} from '../types/commit-types'\nimport {type DeleteResult, type EditResult, type HideResult, type Result, useCommenting} from './use-commenting'\nimport {useFetchThread} from './use-fetch-commit-thread'\n\nexport function useDiffInlineCommenting(): CommentingImplementation {\n  const payload = useRoutePayload<CommitPayload>()\n  const {commit, commentInfo} = payload\n  const fetchThread = useFetchThread({commit, repo: payload.repo, viewerCanReply: commentInfo.canComment})\n  const {addComment, deleteComment, editComment, hideComment, unhideComment} = useCommenting()\n  const {findInlineComment} = useInlineComments()\n\n  const addThreadReply = useCallback(\n    ({\n      filePath,\n      onCompleted,\n      onError,\n      text,\n      thread,\n    }: {\n      commentsConnectionIds?: string[]\n      filePath: string\n      onCompleted?: (commentDatabaseId?: number) => void\n      onError: (error: Error) => void\n      text: string\n      thread: Thread\n      threadsConnectionId?: string\n    }) => {\n      const [path, position] = thread.id.split('::')\n\n      if (!path || !position) {\n        onError(new Error('Invalid threadId'))\n        return\n      }\n\n      // eslint-disable-next-line github/no-then\n      addComment(text, filePath, position).then((result: Result) => {\n        if (result.comment) {\n          onCompleted?.(result.comment.id)\n        } else {\n          onError(new Error('Failed to add comment'))\n        }\n      })\n    },\n    [addComment],\n  )\n\n  const addThread = useCallback(\n    ({\n      text,\n      diffLine,\n      filePath,\n      onCompleted,\n      onError,\n    }: {\n      text: string\n      diffLine?: DiffLine\n      filePath: string\n      onCompleted?: (threadId: string, commentDatabaseId?: number) => void\n      onError?: (error: Error) => void\n    }) => {\n      // commit comments require position but PRs does not\n      // so we pass it into our build_file_diff_payload\n      if (!diffLine) return\n      if (!diffLine.position) return\n\n      // eslint-disable-next-line github/no-then\n      addComment(text, filePath, diffLine.position.toString()).then((result: Result) => {\n        if (result.comment) {\n          const commentId = result.comment.id\n          const threadId = `${filePath}::${diffLine.position}` // TODO - get thread id from response\n\n          // TODO - refresh diff lines to get new thread marker\n          onCompleted?.(threadId, commentId)\n        } else {\n          onError?.(new Error('Failed to add comment'))\n        }\n      })\n    },\n    [addComment],\n  )\n\n  const editThreadComment = useCallback(\n    ({\n      comment,\n      text,\n      onCompleted,\n      onError,\n    }: {\n      comment: Comment\n      onCompleted?: () => void\n      onError: (error: Error) => void\n      text: string\n    }) => {\n      const existingComment = findInlineComment(comment.id)\n\n      if (!existingComment) {\n        onError(new Error('Comment not found'))\n        return\n      }\n\n      const commitComment = {\n        id: existingComment.id,\n        bodyVersion: existingComment.bodyVersion,\n      }\n\n      // eslint-disable-next-line github/no-then\n      editComment(text, commitComment).then((result: EditResult) => {\n        if (result.updatedFields) {\n          onCompleted?.()\n        } else {\n          onError(new Error('Failed to edit comment'))\n        }\n      })\n    },\n    [editComment, findInlineComment],\n  )\n\n  const deleteThreadComment = useCallback(\n    ({\n      commentId,\n      onCompleted,\n      onError,\n    }: {\n      commentConnectionId?: string\n      commentId: string // relay id\n      filePath: string\n      onCompleted?: () => void\n      onError?: (error: Error) => void\n      threadCommentCount?: number\n      threadId: string\n      threadsConnectionId?: string\n    }) => {\n      // we are provided the relay id, but we need the database id\n      // so we need to find the comment in the context first\n      const existingComment = findInlineComment(commentId)\n\n      if (!existingComment) {\n        onError?.(new Error('Comment not found'))\n        return\n      }\n\n      // eslint-disable-next-line github/no-then\n      deleteComment(existingComment.id.toString()).then((result: DeleteResult) => {\n        if (result === 'success') {\n          onCompleted?.()\n        } else if (result === 'error') {\n          onError?.(new Error('Failed to delete comment'))\n        } else if (result === 'canceled') {\n          // do nothing\n        }\n      })\n    },\n    [deleteComment, findInlineComment],\n  )\n\n  const hideThreadComment = useCallback(\n    ({\n      commentId,\n      reason,\n      onCompleted,\n      onError,\n    }: {\n      commentId: string\n      reason: string\n      onCompleted?: () => void\n      onError: (error: Error) => void\n    }) => {\n      // we are provided the relay id, but we need the database id\n      // so we need to find the comment in the context first\n      const existingComment = findInlineComment(commentId)\n\n      if (!existingComment) {\n        onError?.(new Error('Comment not found'))\n        return\n      }\n\n      // eslint-disable-next-line github/no-then\n      hideComment(existingComment.id.toString(), reason).then((result: HideResult) => {\n        if (result === 'success') {\n          onCompleted?.()\n        } else if (result === 'error') {\n          onError(new Error('Failed to hide comment'))\n        }\n      })\n    },\n    [findInlineComment, hideComment],\n  )\n\n  const unhideThreadComment = useCallback(\n    ({\n      commentId,\n      onCompleted,\n      onError,\n    }: {\n      commentId: string\n      onCompleted?: () => void\n      onError: (error: Error) => void\n    }) => {\n      // we are provided the relay id, but we need the database id\n      // so we need to find the comment in the context first\n      const existingComment = findInlineComment(commentId)\n\n      if (!existingComment) {\n        onError?.(new Error('Comment not found'))\n        return\n      }\n\n      // eslint-disable-next-line github/no-then\n      unhideComment(existingComment.id.toString()).then((result: HideResult) => {\n        if (result === 'success') {\n          onCompleted?.()\n        } else if (result === 'error') {\n          onError(new Error('Failed to unhide comment'))\n        }\n      })\n    },\n    [findInlineComment, unhideComment],\n  )\n\n  return useMemo(\n    () => ({\n      batchingEnabled: false,\n      commentSubjectType: 'commit',\n      multilineEnabled: false,\n      resolvingEnabled: false,\n      suggestedChangesEnabled: false,\n      lazyFetchReactionGroups: true,\n      lazyFetchEditHistory: true,\n      addThread,\n      addThreadReply,\n      deleteComment: deleteThreadComment,\n      editComment: editThreadComment,\n      pendingSuggestedChangesBatch: [],\n      submitSuggestedChanges: noop,\n      addSuggestedChangeToPendingBatch: noop,\n      removeSuggestedChangeFromPendingBatch: noop,\n      addFileLevelThread: noop,\n      resolveThread: noop,\n      unresolveThread: noop,\n      hideComment: hideThreadComment,\n      unhideComment: unhideThreadComment,\n      fetchThread,\n      commentBoxConfig: {\n        pasteUrlsAsPlainText: false,\n        useMonospaceFont: false,\n      },\n    }),\n    [\n      addThread,\n      addThreadReply,\n      deleteThreadComment,\n      editThreadComment,\n      fetchThread,\n      hideThreadComment,\n      unhideThreadComment,\n    ],\n  )\n}\n","import type {MarkerNavigationImplementation} from '@github-ui/conversations'\nimport {noop} from '@github-ui/noop'\nimport {useMemo} from 'react'\n\nexport function useDiffInlineMarkerNav(): MarkerNavigationImplementation {\n  return useMemo(\n    () => ({\n      filteredMarkers: [],\n      activeGlobalMarkerID: '',\n      decrementActiveMarker: noop,\n      incrementActiveMarker: noop,\n      onActivateGlobalMarkerNavigation: noop,\n    }),\n    [],\n  )\n}\n","import {useRoutePayload} from '@github-ui/react-core/use-route-payload'\n\nimport type {CommitPayload} from '../types/commit-types'\n\nexport function useCommentInfo() {\n  const payload = useRoutePayload<CommitPayload>()\n  return payload.commentInfo\n}\n","import {LoadingSkeleton} from '@github-ui/skeleton/LoadingSkeleton'\nimport React from 'react'\n\nexport const LoadingContentBlock = React.memo(LoadingContentBlockUnmemoized)\n\n//using boxes specifically because they provide some styling stuff that makes the skeleton look nicer\nfunction LoadingContentBlockUnmemoized() {\n  return (\n    <div className=\"pt-3\">\n      <div className=\"border borderColor-muted rounded-top-2\">\n        <div className=\"gap-2 p-3 border-bottom borderColor-muted bgColor-muted rounded-top-2\">\n          <LoadingSkeleton height=\"sm\" variant=\"rounded\" width=\"140px\" />\n        </div>\n        <div className=\"d-flex flex-column gap-2 p-3\">\n          <LoadingSkeleton height=\"sm\" variant=\"rounded\" width=\"random\" />\n          <LoadingSkeleton height=\"sm\" variant=\"rounded\" width=\"random\" />\n          <LoadingSkeleton height=\"sm\" variant=\"rounded\" width=\"random\" />\n          <LoadingSkeleton height=\"sm\" variant=\"rounded\" width=\"random\" />\n        </div>\n      </div>\n    </div>\n  )\n}\n\ntry{ LoadingContentBlock.displayName ||= 'LoadingContentBlock' } catch {}\ntry{ LoadingContentBlockUnmemoized.displayName ||= 'LoadingContentBlockUnmemoized' } catch {}","import {useShortcut} from '@github-ui/code-view-shared/hooks/shortcuts'\nimport type {Repository} from '@github-ui/current-repository'\nimport {DiffFindPopover, type FocusedSearchResult, useDiffFindOpen, useDiffSearchResults} from '@github-ui/diff-lines'\nimport {parseDiffHash} from '@github-ui/diff-lines/document-hash-helpers'\nimport {noop} from '@github-ui/noop'\nimport {commitDiffEntriesPath} from '@github-ui/paths'\nimport {useAppPayload} from '@github-ui/react-core/use-app-payload'\nimport {useRoutePayload} from '@github-ui/react-core/use-route-payload'\nimport {ssrSafeDocument, ssrSafeLocation, ssrSafeWindow} from '@github-ui/ssr-utils'\nimport {GlobalCommands} from '@github-ui/ui-commands'\nimport {useVirtualDynamic, useVirtualWindow} from '@github-ui/use-virtual'\nimport {Flash} from '@primer/react'\nimport type React from 'react'\nimport {useCallback, useEffect, useRef, useState} from 'react'\nimport {defaultRangeExtractor} from 'react-virtual'\n\nimport {useDiffViewSettings} from '../../contexts/DiffViewSettingsContext'\nimport {useCommitsAppPayload} from '../../hooks/use-commits-app-payload'\nimport type {BranchCommitState} from '../../hooks/use-load-branch-commits'\nimport {useLoadDeferredDiffs} from '../../hooks/use-load-deferred-diffs'\nimport type {CommitAppPayload, CommitPayload, DiffEntryDataWithExtraInfo} from '../../types/commit-types'\nimport {getFileExtension} from '../../utils/get-file-extension'\nimport {stickyHeaderHeight} from '../../utils/sticky-header-offset'\nimport {Diff} from './Diff'\nimport {LoadingContentBlock} from './LoadingContentBlock'\n\ninterface DiffsProps {\n  diffEntryData: DiffEntryDataWithExtraInfo[]\n  contextLinePathURL: string\n  selectedPathDigest: string\n  unselectedFileExtensions?: Set<string>\n  repo: Repository\n  oid: string\n  ignoreWhitespace: boolean\n  commitInfo?: BranchCommitState\n  searchTerm: string\n  setSearchTerm: (searchTerm: string) => void\n  isStickied: boolean\n}\n\n/**\n * Calculates the height of a diff based on the number of lines and threads.\n *\n * This is an estimate, and we use it to pre-calculate the height of virtual diff placeholders so we get a fairly\n * accurate scroll height before every diff has been rendered.\n *\n */\nfunction calculateDiffHeight(diff?: NonNullableDiff) {\n  let height = baseDiffHeight\n  if (diff?.collapsed) {\n    return height\n  }\n\n  if (diff?.newTreeEntry?.isGenerated && !diff?.diffManuallyExpanded) {\n    return generatedFileDiffHeight\n  }\n\n  if (diff?.isTooBig) {\n    return tooLargeDiffHeight\n  }\n\n  if (diff?.diffLines) {\n    height += diff.diffLines.length * estimatedLineHeight\n  }\n\n  //if we have more context lines at the bottom of the file, account for the bottom context line element\n  if (\n    diff?.newTreeEntry?.lineCount &&\n    diff.newTreeEntry.lineCount > (diff?.diffLines[diff?.diffLines.length - 1]?.right ?? 0)\n  ) {\n    height += singleDirectionExpansionHeight\n  }\n  return height\n}\n\ntype NonNullableDiff = NonNullable<DiffEntryDataWithExtraInfo>\n// includes header, padding, and margin\nconst baseDiffHeight = 67\n// This is just the empty line minimum line height\nconst estimatedLineHeight = 25\n\n// includes the base height along with a placeholder saying we can't show the diff.\nconst tooLargeDiffHeight = 104\n\n//includes base height and the placeholder with the load diff option\nconst generatedFileDiffHeight = 199\n\n//height of context lines expansion with only one direction\nconst singleDirectionExpansionHeight = 32\n\nconst virtualizationFileLimit = 40\n\n//height of context lines expansion with both directions\n//TODO: determine if we want to iterate through every single line to determine if we should use 32 or 40px as the estimate,\n//or do we just overestimate and do 40. If we underestimate, the comment box at the bottom overlaps with some diffs, hence\n//the functionality rework in this PR\n// eslint-disable-next-line unused-imports/no-unused-vars\nconst bothDirectionExpansionHeight = 40\n\nexport function Diffs({\n  diffEntryData,\n  contextLinePathURL,\n  selectedPathDigest,\n  unselectedFileExtensions,\n  repo,\n  oid,\n  ignoreWhitespace,\n  commitInfo,\n  searchTerm,\n  setSearchTerm,\n  isStickied,\n}: DiffsProps) {\n  const diffViewSettings = useDiffViewSettings()\n  const payload = useRoutePayload<CommitPayload>()\n\n  // Triggers a re-render because the object literal will be a new object every time\n  const resetVirtualizerHeight = useCallback(() => recalculateWhichDiffsShouldBeShown({}), [])\n  //we don't care about the value of the state, it is purely used to trigger a re-render\n  const [usedToRecalculateWhichDiffsAreShown, recalculateWhichDiffsShouldBeShown] = useState({})\n  const diffEntriesToUse = useRef(diffEntryData)\n  const {findInDiffWorkerPath} = useCommitsAppPayload()\n  const allDiffEntriesWithNoFiltering = useRef(diffEntryData)\n  const shouldVirtualize = useRef(diffEntryData.length > virtualizationFileLimit)\n  const errorFlashRef = useRef<HTMLDivElement | null>(null)\n  const [shouldIgnoreWhitespace, setShouldIgnoreWhitespace] = useState(ignoreWhitespace)\n  const currentPathDigestIndex = useRef(0)\n  const [oidToUse, setOidToUse] = useState(oid)\n  const {diffFindOpen, setDiffFindOpen} = useDiffFindOpen()\n  const {findInFileShortcut} = useShortcut()\n  const inputContainer = useRef<HTMLInputElement>(null)\n  const {focusedSearchResult, setFocusedSearchResult, searchResults, currentIndex, setCurrentIndex} =\n    useDiffSearchResults(\n      diffEntriesToUse.current,\n      searchTerm,\n      findInDiffWorkerPath,\n      usedToRecalculateWhichDiffsAreShown,\n    )\n\n  function onHotkeyPressed() {\n    setDiffFindOpen(true)\n    const selection = window.getSelection()?.toString()\n    if (selection) {\n      setSearchTerm(selection)\n    }\n    if (diffFindOpen) {\n      inputContainer?.current?.focus()\n    }\n  }\n\n  useEffect(() => {\n    if (unselectedFileExtensions && unselectedFileExtensions.size > 0) {\n      diffEntriesToUse.current = allDiffEntriesWithNoFiltering.current.filter(\n        diffEntry => !unselectedFileExtensions.has(getFileExtension(diffEntry.path)),\n      )\n    } else {\n      diffEntriesToUse.current = allDiffEntriesWithNoFiltering.current\n    }\n    shouldVirtualize.current = diffEntriesToUse.current.length > virtualizationFileLimit\n    resetVirtualizerHeight()\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [unselectedFileExtensions?.size])\n\n  useEffect(() => {\n    diffEntriesToUse.current = diffEntryData\n    allDiffEntriesWithNoFiltering.current = diffEntryData\n    shouldVirtualize.current = diffEntriesToUse.current.length > virtualizationFileLimit\n    resetVirtualizerHeight()\n    setShouldIgnoreWhitespace(ignoreWhitespace)\n    setOidToUse(oid)\n    // reset when we soft nav to a new commit\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [payload.path])\n\n  const scrollDiffCellIntoView = (focusedResult: FocusedSearchResult | undefined) => {\n    const indexOfDiff = getDiffWithPathDigest(focusedResult?.pathDigest ?? '', diffEntriesToUse.current)\n\n    if (indexOfDiff === -1) {\n      //something went wrong finding the diff, just return and don't do anything\n      return\n    }\n    virtualizer.scrollToIndex(indexOfDiff, {align: 'center'})\n    requestAnimationFrame(() => {\n      scrollToSearchElement(focusedResult?.indexWithinDigest ?? 0, focusedResult?.pathDigest ?? '')\n    })\n  }\n\n  const appPayload = useAppPayload<CommitAppPayload>()\n  const url = commitDiffEntriesPath({\n    owner: payload.repo.ownerLogin,\n    repo: payload.repo.name,\n    commitish: payload.commit.oid,\n  })\n  const extraDiffs = useLoadDeferredDiffs(\n    payload.asyncDiffLoadInfo.byteCount,\n    payload.asyncDiffLoadInfo.lineShownCount,\n    payload.asyncDiffLoadInfo.startIndex,\n    url,\n    payload.moreDiffsToLoad,\n    ignoreWhitespace,\n  )\n\n  useEffect(() => {\n    const concatenatedDiffEntries = diffEntriesToUse.current.concat(extraDiffs.extraDiffEntries)\n\n    if (unselectedFileExtensions && unselectedFileExtensions.size > 0) {\n      diffEntriesToUse.current = concatenatedDiffEntries.filter(\n        diffEntry => !unselectedFileExtensions.has(getFileExtension(diffEntry.path)),\n      )\n    } else {\n      diffEntriesToUse.current = concatenatedDiffEntries\n    }\n\n    allDiffEntriesWithNoFiltering.current = concatenatedDiffEntries\n    shouldVirtualize.current = diffEntriesToUse.current.length > virtualizationFileLimit\n    resetVirtualizerHeight()\n\n    //run this when the extra diffs finish loading\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [extraDiffs.extraDiffEntries.length])\n\n  const diffsParentRef = useRef<HTMLDivElement>(null)\n\n  //TODO: the ideal scenario would probably be splitting this up into diffsVirtualized and diffsNotVirtualized so\n  //we don't have to do the virtualizer setup work unnecessarily, but then we have a million code paths again...\n  //idk\n  const virtualizer = useVirtualWindow<HTMLElement>({\n    // additionalScrollOffset: -totalStickyHeaderHeight,\n    parentRef: diffsParentRef,\n    size: diffEntriesToUse.current.length,\n    estimateSize: useCallback(\n      (index: number) => {\n        return calculateDiffHeight(diffEntriesToUse.current[index])\n      },\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      [diffEntriesToUse.current.length, usedToRecalculateWhichDiffsAreShown],\n    ),\n    useVirtualImpl: useVirtualDynamic,\n    // inspect the range of materialized items, and ensure that any patch with focus within stays in the virtual window\n    rangeExtractor(range) {\n      const hash = ssrSafeLocation.hash.substring(1)\n      const fileDigest = parseDiffHash(hash)\n      const focusedPathDigest = document\n        .querySelector('[data-path-digest]:focus-within')\n        ?.getAttribute('data-path-digest')\n\n      const focusedDiffIndex = diffEntriesToUse.current.findIndex(patch => patch.pathDigest === focusedPathDigest)\n      const anchoredDiffIndex = diffEntriesToUse.current.findIndex(patch => fileDigest?.endsWith(patch.pathDigest))\n\n      if (focusedDiffIndex < 0 && anchoredDiffIndex < 0) {\n        return defaultRangeExtractor(range)\n      }\n\n      const nextRange = new Set([\n        ...defaultRangeExtractor(range),\n        ...[focusedDiffIndex, anchoredDiffIndex].filter(index => index > -1),\n      ])\n      return Array.from(nextRange).sort((a, b) => a - b)\n    },\n  })\n\n  useEffect(() => {\n    const isHighlightingRightRow = selectedPathDigest.includes('R')\n    const isHighlightingLeftRow = selectedPathDigest.includes('L')\n    const isHighlightingRow = isHighlightingLeftRow || isHighlightingRightRow\n    const pathDigest = isHighlightingRow\n      ? isHighlightingLeftRow\n        ? selectedPathDigest.split('L')[0]\n        : selectedPathDigest.split('R')[0]\n      : selectedPathDigest\n    const indexOfDiff = getDiffWithPathDigest(pathDigest ?? selectedPathDigest, diffEntriesToUse.current)\n    if (indexOfDiff === -1) {\n      if (extraDiffs.error && errorFlashRef !== null) {\n        const flashComponent = errorFlashRef.current?.childNodes[0] as HTMLDivElement\n        flashComponent?.focus()\n        flashComponent?.scrollIntoView({block: 'center'})\n      }\n      return\n    }\n\n    if (shouldVirtualize.current) {\n      virtualizer.scrollToIndex(indexOfDiff, {align: 'center'})\n      requestAnimationFrame(() => {\n        if (isHighlightingRow && focusRowElement(diffsParentRef, selectedPathDigest)) {\n          //if we are in here, then nothing else to do, otherwise we couldn't find the row (was a context row)\n          //to highlight so default to just highlighting the file itself\n        } else {\n          const collapseButton = diffsParentRef.current?.querySelectorAll(\n            `[aria-label=\"collapse file: ${diffEntriesToUse.current[indexOfDiff]?.path}\"]`,\n          )\n          if (collapseButton && collapseButton.length === 1) {\n            const collapseButtonToFocus = collapseButton[0]! as HTMLElement\n            collapseButtonToFocus.focus()\n          }\n        }\n      })\n    } else {\n      if (isHighlightingRow && focusRowElement(diffsParentRef, selectedPathDigest)) {\n        //if we are in here, then nothing else to do, otherwise we couldn't find the row (was a context row)\n        //to highlight so default to just highlighting the file itself\n      } else {\n        const allDiffLinesElements = diffsParentRef.current?.querySelectorAll(`[data-diff-anchor=diff-${pathDigest}]`)\n        if (allDiffLinesElements && allDiffLinesElements.length === 1) {\n          const elementToScrollTo = allDiffLinesElements[0]! as HTMLElement\n          const yOffset =\n            elementToScrollTo.getBoundingClientRect().top +\n            (ssrSafeWindow?.scrollY ?? 0) -\n            baseDiffHeight -\n            stickyHeaderHeight\n          ssrSafeWindow?.scrollTo(0, yOffset)\n          const collapseButton = diffsParentRef.current?.querySelectorAll(\n            `[aria-label=\"collapse file: ${diffEntriesToUse.current[indexOfDiff]?.path}\"]`,\n          )\n          if (collapseButton && collapseButton.length === 1) {\n            const collapseButtonToFocus = collapseButton[0]! as HTMLElement\n            collapseButtonToFocus.focus()\n          }\n        }\n      }\n    }\n    //if the extra diffs loaded we want to run this again to check if the selected path digest was within\n    //the diffs which just returned\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedPathDigest, extraDiffs])\n\n  return (\n    <div data-hpc ref={diffsParentRef}>\n      {!shouldVirtualize.current &&\n        diffEntriesToUse.current.map((diffEntry, index) => {\n          return (\n            <div\n              key={diffEntry.pathDigest}\n              style={{\n                paddingTop: index === 0 ? 0 : 16,\n                left: 3,\n                right: 3,\n              }}\n            >\n              <Diff\n                prId={commitInfo?.branches[0]?.prs[0]?.globalRelayId}\n                diffEntryData={diffEntriesToUse}\n                index={index}\n                splitPreference={diffViewSettings.splitPreference}\n                contextLinePathURL={contextLinePathURL}\n                recalcTotalHeightOfVirtualWindow={noop}\n                repo={repo}\n                helpUrl={appPayload.helpUrl}\n                oid={oidToUse}\n                ignoreWhitespace={shouldIgnoreWhitespace}\n              />\n            </div>\n          )\n        })}\n\n      {shouldVirtualize.current && (\n        <>\n          <GlobalCommands\n            commands={{\n              'commit-diff-view:open-find': onHotkeyPressed,\n            }}\n          />\n          {/* need to have one button and one global command because the preventDefault by default messes with\n          the behavior of pressing the findInFile hotkey */}\n          <button hidden={true} data-hotkey={findInFileShortcut.hotkey} onClick={onHotkeyPressed} />\n\n          {diffFindOpen && (\n            <DiffFindPopover\n              inputContainer={inputContainer}\n              currentPathDigestIndex={currentPathDigestIndex}\n              stickied={isStickied}\n              searchTerm={searchTerm}\n              focusedSearchResult={focusedSearchResult}\n              currentIndex={currentIndex}\n              setCurrentIndex={setCurrentIndex}\n              setFocusedSearchResult={setFocusedSearchResult}\n              setSearchTerm={setSearchTerm}\n              searchResults={searchResults}\n              scrollDiffCellIntoView={scrollDiffCellIntoView}\n              onClose={() => {\n                setDiffFindOpen(false)\n              }}\n            />\n          )}\n          <div style={{height: virtualizer.totalSize, width: '100%', position: 'relative'}}>\n            {virtualizer.virtualItems.map(virtualRow => {\n              const diffEntry = diffEntriesToUse.current[virtualRow.index]\n              let diffMatches = undefined\n              let currentlyFocusedResult = undefined\n              if (searchResults.has(diffEntry?.pathDigest ?? '')) {\n                //we have a match within this diff, highlight it\n                diffMatches = searchResults.get(diffEntry?.pathDigest ?? '') ?? []\n              }\n              //we only care about the focused search result if WE are the focused search result, which happens\n              //in this condition\n              if (focusedSearchResult && diffEntry?.pathDigest === focusedSearchResult?.pathDigest) {\n                currentlyFocusedResult = focusedSearchResult?.indexWithinDigest ?? -1\n              }\n\n              if (!diffEntry) return null\n\n              return (\n                <div\n                  key={diffEntry.pathDigest}\n                  ref={virtualRow.measureRef}\n                  data-key={virtualRow.key}\n                  style={{\n                    position: 'absolute',\n                    paddingTop: virtualRow.index === 0 ? 0 : 16,\n                    left: 3,\n                    right: 3,\n                    transform: `translateY(${virtualRow.start}px)`,\n                  }}\n                >\n                  <Diff\n                    prId={commitInfo?.branches[0]?.prs[0]?.globalRelayId}\n                    diffMatches={diffMatches}\n                    focusedSearchResult={currentlyFocusedResult}\n                    diffEntryData={diffEntriesToUse}\n                    index={virtualRow.index}\n                    splitPreference={diffViewSettings.splitPreference}\n                    contextLinePathURL={contextLinePathURL}\n                    recalcTotalHeightOfVirtualWindow={resetVirtualizerHeight}\n                    headerStickyOffset={-virtualRow.start}\n                    helpUrl={appPayload.helpUrl}\n                    repo={repo}\n                    oid={oidToUse}\n                    ignoreWhitespace={shouldIgnoreWhitespace}\n                    virtualizerScrollTo={virtualizer.scrollToIndex}\n                  />\n                </div>\n              )\n            })}\n          </div>\n        </>\n      )}\n      {payload.moreDiffsToLoad && (\n        <>\n          {extraDiffs.loading && <LoadingContentBlock />}\n          {extraDiffs.error && (\n            <div style={{justifyContent: 'center', paddingTop: '16px'}} ref={errorFlashRef}>\n              <Flash variant=\"danger\" tabIndex={0}>\n                <div className={'d-flex flex-items-center'} style={{justifyContent: 'center'}}>\n                  There was a problem loading the remainder of the diff.\n                </div>\n              </Flash>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  )\n}\n\nfunction getDiffWithPathDigest(pathDigest: string, diffEntries: DiffEntryDataWithExtraInfo[]) {\n  for (let i = 0; i < diffEntries.length; i++) {\n    if (pathDigest === diffEntries[i]?.pathDigest) return i\n  }\n  return -1\n}\n\nfunction focusRowElement(diffsParentRef: React.RefObject<HTMLDivElement>, selectedPathDigest: string) {\n  const lineToHighlight = diffsParentRef.current?.querySelectorAll(`[data-line-anchor=diff-${selectedPathDigest}]`)\n  if (lineToHighlight && lineToHighlight.length === 1) {\n    const collapseButtonToFocus = lineToHighlight[0]! as HTMLElement\n    collapseButtonToFocus.focus()\n    return true\n  }\n  return false\n}\n\nfunction scrollToSearchElement(indexToScrollTo: number, pathDigest: string) {\n  const lineToHighlight = ssrSafeDocument?.getElementById(`match-${pathDigest}-${indexToScrollTo}`)\n  if (lineToHighlight) {\n    lineToHighlight.scrollIntoView({block: 'center'})\n  }\n}\n\ntry{ Diffs.displayName ||= 'Diffs' } catch {}","import {ActionList} from '@primer/react'\n\nimport {useDiffViewSettings} from '../../contexts/DiffViewSettingsContext'\n\nexport function DiffViewPreferenceToggle() {\n  const {splitPreference, updateSplitPreference} = useDiffViewSettings()\n\n  return (\n    <ActionList.Group selectionVariant=\"single\">\n      <ActionList.GroupHeading>Layout</ActionList.GroupHeading>\n      <ActionList.Item selected={splitPreference === 'unified'} onSelect={() => updateSplitPreference('unified')}>\n        Unified\n      </ActionList.Item>\n      <ActionList.Item selected={splitPreference === 'split'} onSelect={() => updateSplitPreference('split')}>\n        Split\n      </ActionList.Item>\n    </ActionList.Group>\n  )\n}\n\ntry{ DiffViewPreferenceToggle.displayName ||= 'DiffViewPreferenceToggle' } catch {}","import {ActionList} from '@primer/react'\n\nimport {useDiffViewSettings} from '../../contexts/DiffViewSettingsContext'\n\nexport function DiffWhitespaceToggle() {\n  const {hideWhitespace, updateHideWhitespace} = useDiffViewSettings()\n\n  return (\n    <ActionList.Group selectionVariant=\"single\" variant=\"subtle\">\n      <ActionList.GroupHeading>Whitespace</ActionList.GroupHeading>\n      <ActionList.Item selected={hideWhitespace} onSelect={() => updateHideWhitespace(!hideWhitespace)}>\n        Hide whitespace\n      </ActionList.Item>\n    </ActionList.Group>\n  )\n}\n\ntry{ DiffWhitespaceToggle.displayName ||= 'DiffWhitespaceToggle' } catch {}","import {GearIcon} from '@primer/octicons-react'\nimport {ActionList, ActionMenu} from '@primer/react'\n\nimport {DiffViewPreferenceToggle} from './DiffViewPreferenceToggle'\nimport {DiffWhitespaceToggle} from './DiffWhitespaceToggle'\n\nexport function DiffViewSettings() {\n  return (\n    <ActionMenu>\n      <ActionMenu.Anchor>\n        <button className=\"Button Button--iconOnly Button--invisible ml-2\" aria-label=\"Diff view settings\">\n          <GearIcon />\n        </button>\n      </ActionMenu.Anchor>\n      <ActionMenu.Overlay>\n        <ActionList>\n          <DiffViewPreferenceToggle />\n          <ActionList.Divider />\n          <DiffWhitespaceToggle />\n        </ActionList>\n      </ActionMenu.Overlay>\n    </ActionMenu>\n  )\n}\n\ntry{ DiffViewSettings.displayName ||= 'DiffViewSettings' } catch {}","import {LinesChangedCounterLabel} from '@github-ui/diff-file-header'\nimport {ArrowUpIcon} from '@primer/octicons-react'\nimport {Button, Heading, Text} from '@primer/react'\nimport {useRef} from 'react'\n\nimport {useStickyObserver} from '../../hooks/use-sticky-observer'\nimport type {HeaderInfo} from '../../types/commit-types'\nimport {DiffViewSettings} from './DiffViewSettings'\n\ninterface DiffsHeaderProps {\n  headerInfo: HeaderInfo\n  treeToggleElement: JSX.Element\n}\n\nexport function DiffsHeader({treeToggleElement, headerInfo}: DiffsHeaderProps) {\n  const diffHeaderRef = useRef<HTMLDivElement>(null)\n  const isStickied = useStickyObserver(diffHeaderRef)\n  const hideLinesChangedSx = isStickied ? {display: ['none', 'inherit']} : {} // make room for the Top button on mobile\n\n  return (\n    <div\n      className={`d-flex flex-items-center flex-justify-between gap-2 pt-3 pt-lg-4 pb-2 position-sticky top-0 color-bg-default`}\n      style={{zIndex: 2}}\n      ref={diffHeaderRef}\n    >\n      <div className=\"d-flex flex-items-center\">\n        {treeToggleElement}\n        <Heading as=\"h2\" className=\"mx-2 f4\">\n          {headerInfo.filesChangedString} file{headerInfo.filesChanged > 1 ? 's' : ''} changed\n        </Heading>\n        <LinesChangedCounterLabel sx={hideLinesChangedSx} isAddition>\n          +{headerInfo.additions}\n        </LinesChangedCounterLabel>\n        <LinesChangedCounterLabel sx={hideLinesChangedSx} isAddition={false}>\n          -{headerInfo.deletions}\n        </LinesChangedCounterLabel>\n        <Text sx={{fontSize: 0, ml: 2, color: 'fg.muted', whiteSpace: 'nowrap', ...hideLinesChangedSx}}>\n          lines changed\n        </Text>\n      </div>\n\n      <div className=\"d-flex\">\n        {isStickied && <GoToTopButton />}\n        <DiffViewSettings />\n      </div>\n    </div>\n  )\n}\n\nconst GoToTopButton = () => {\n  return (\n    <Button\n      leadingVisual={ArrowUpIcon}\n      variant=\"invisible\"\n      className=\"fgColor-default px-2 f6 gap-1\"\n      onClick={event => {\n        event.preventDefault()\n        window.scrollTo({top: 0, behavior: 'smooth'})\n      }}\n    >\n      Top\n    </Button>\n  )\n}\n\ntry{ DiffsHeader.displayName ||= 'DiffsHeader' } catch {}\ntry{ GoToTopButton.displayName ||= 'GoToTopButton' } catch {}","import type React from 'react'\nimport {useCallback, useEffect, useState} from 'react'\n\nexport function useStickyObserver(elementRef: React.RefObject<HTMLDivElement>): boolean {\n  const [isStickied, setIsStickied] = useState(false)\n  const stickyCallback = useCallback(\n    (entries: IntersectionObserverEntry[]) => {\n      // There can be multiple entries if the user scrolled down and up quickly.\n      // Just respond to the last one.\n      const e = entries[entries.length - 1]\n      // Less than 1 means some portion of the element is scrolled out of view\n      // With top: -1px we expect this to be < 1 when the element is stuck.\n      const isIntersecting = e!.intersectionRatio < 1\n      if (isIntersecting !== isStickied) {\n        setIsStickied(isIntersecting)\n      }\n    },\n    [isStickied, setIsStickied],\n  )\n\n  useEffect(() => {\n    const element = elementRef.current\n    const options = {threshold: [1], rootMargin: '-1px 0px 0px 0px'}\n\n    const observer = new IntersectionObserver(stickyCallback, options)\n\n    if (elementRef.current) {\n      observer.observe(elementRef.current)\n    }\n\n    return () => {\n      if (element) observer.unobserve(element)\n    }\n  }, [elementRef, stickyCallback])\n\n  return isStickied\n}\n","import {debounce} from '@github/mini-throttle'\nimport type {DiffDelta} from '@github-ui/diff-file-tree'\nimport {DiffFileTree} from '@github-ui/diff-file-tree'\nimport {type FileFilterBaseProps, FileFilterShared} from '@github-ui/diff-file-tree/file-filter'\nimport {getCurrentSize, ScreenSize} from '@github-ui/screen-size'\nimport {type ReactNode, useMemo, useRef, useState} from 'react'\n\nimport {useInlineComments} from '../../contexts/InlineCommentsContext'\nimport type {CommitFile} from '../../types/commit-types'\nimport {getFileExtension} from '../../utils/get-file-extension'\n\nexport const DIFF_FILE_TREE_ID = 'diff_file_tree'\n\nexport type PostSelectAction = 'close_tree'\n\nexport type FileTreeProps = {\n  diffs: CommitFile[]\n  onFileSelected: (file: DiffDelta, postSelectAction?: PostSelectAction) => void\n  diffsHeader: ReactNode\n} & Pick<FileFilterProps, 'onFileExtensionsChange' | 'unselectedFileExtensions'>\n\nexport function FileTree({\n  diffs,\n  onFileSelected,\n  diffsHeader,\n  unselectedFileExtensions,\n  onFileExtensionsChange,\n}: FileTreeProps) {\n  const [filterText, setFilterText] = useState('')\n  const {getCommentCountByPath} = useInlineComments()\n\n  const narrowDiffHeader = useRef<HTMLDivElement>(null)\n\n  const fileExtensions = useMemo(() => new Set(diffs.map(diff => getFileExtension(diff.path))), [diffs])\n\n  let tempDiffs = diffs\n  if (unselectedFileExtensions && unselectedFileExtensions.size > 0) {\n    tempDiffs = tempDiffs.filter(diffEntry => !unselectedFileExtensions.has(getFileExtension(diffEntry.path)))\n  }\n\n  const filteredDiffs = (\n    filterText ? tempDiffs.filter(diff => diff.path.toLowerCase().includes(filterText.toLowerCase())) : tempDiffs\n  ).map(diff => {\n    const commentCount = getCommentCountByPath(diff.path)\n\n    return {\n      ...diff,\n      totalCommentsCount: commentCount ?? 0,\n    }\n  })\n\n  const onSelect = (file: DiffDelta) => {\n    // we can do this since the onselect is on the client\n    const currentSize = getCurrentSize(window.innerWidth)\n    const isNarrowBreakpoint = currentSize <= ScreenSize.medium\n    const postSelectAction: PostSelectAction | undefined = isNarrowBreakpoint ? 'close_tree' : undefined\n    onFileSelected(file, postSelectAction)\n  }\n\n  return (\n    <div className=\"d-flex flex-column gap-2\" id={DIFF_FILE_TREE_ID}>\n      <h2 className=\"sr-only\">File tree</h2>\n      <div className=\"d-md-none\" ref={narrowDiffHeader}>\n        {diffsHeader}\n      </div>\n      <FileFilter\n        filterText={filterText}\n        onFilterTextChange={setFilterText}\n        fileExtensions={fileExtensions}\n        unselectedFileExtensions={unselectedFileExtensions}\n        onFileExtensionsChange={onFileExtensionsChange}\n      />\n      <DiffFileTree diffs={filteredDiffs} onSelect={onSelect} />\n    </div>\n  )\n}\n\ntype FileFilterProps = {\n  onFilterTextChange(filterText: string): void\n  onFileExtensionsChange(type: 'selectFileExtension' | 'unselectFileExtension', extension: string): void\n} & Omit<FileFilterBaseProps, 'onFilterChange'>\n\nfunction FileFilter({\n  filterText,\n  onFilterTextChange,\n  fileExtensions,\n  unselectedFileExtensions,\n  onFileExtensionsChange,\n}: FileFilterProps) {\n  const debouncedOnSearch = useRef(debounce((newQuery: string) => onFilterTextChange(newQuery), 250))\n\n  const onFilterChange = (\n    type: 'selectFileExtension' | 'unselectFileExtension',\n    payload: {\n      extension: string\n    },\n  ) => {\n    onFileExtensionsChange(type, payload.extension)\n  }\n\n  return (\n    <FileFilterShared\n      filterText={filterText}\n      fileExtensions={fileExtensions}\n      unselectedFileExtensions={unselectedFileExtensions}\n      onFilterTextChange={text => debouncedOnSearch.current(text)}\n      onFilterChange={onFilterChange}\n    />\n  )\n}\n\ntry{ FileTree.displayName ||= 'FileTree' } catch {}\ntry{ FileFilter.displayName ||= 'FileFilter' } catch {}","import type {Repository} from '@github-ui/current-repository'\nimport {noop} from '@github-ui/noop'\nimport {useAppPayload} from '@github-ui/react-core/use-app-payload'\nimport {useRoutePayload} from '@github-ui/react-core/use-route-payload'\nimport {useRef} from 'react'\n\nimport {useDiffViewSettings} from '../../contexts/DiffViewSettingsContext'\nimport type {CommitAppPayload, CommitPayload, DiffEntryDataWithExtraInfo} from '../../types/commit-types'\nimport {Diff} from './Diff'\n\ninterface DiffsProps {\n  diffEntryData: DiffEntryDataWithExtraInfo[]\n  contextLinePathURL: string\n  unselectedFileExtensions?: Set<string>\n  repo: Repository\n  oid: string\n}\n\nexport function SSRDiffs({diffEntryData, contextLinePathURL, repo, oid}: DiffsProps) {\n  const diffViewSettings = useDiffViewSettings()\n  const diffEntriesToUse = useRef(diffEntryData)\n  const payload = useAppPayload<CommitAppPayload>()\n  const commitPayload = useRoutePayload<CommitPayload>()\n\n  return (\n    <div data-hpc>\n      {diffEntryData.map((currentDiffData, index) => {\n        return (\n          <div key={currentDiffData.pathDigest} className={index === 0 ? 'pt-0' : 'pt-3'}>\n            <Diff\n              prId={undefined}\n              diffEntryData={diffEntriesToUse}\n              index={index}\n              helpUrl={payload.helpUrl}\n              splitPreference={diffViewSettings.splitPreference}\n              contextLinePathURL={contextLinePathURL}\n              recalcTotalHeightOfVirtualWindow={noop}\n              repo={repo}\n              ignoreWhitespace={commitPayload.ignoreWhitespace}\n              oid={oid}\n            />\n          </div>\n        )\n      })}\n    </div>\n  )\n}\n\ntry{ SSRDiffs.displayName ||= 'SSRDiffs' } catch {}","import type {Repository} from '@github-ui/current-repository'\nimport {getInsightsUrl, reportTraceData} from '@github-ui/internal-api-insights'\nimport {commitCommentDeferredCommentDataPath} from '@github-ui/paths'\nimport {reactFetchJSON} from '@github-ui/verified-fetch'\nimport {useEffect, useState} from 'react'\n\nimport type {CommentThreadData} from '../contexts/InlineCommentsContext'\nimport type {CommitComment} from '../types/commit-types'\nimport type {Commit, FetchRequestState} from '../types/shared'\n\nexport type DeferredCommentData = {\n  threadMarkers: CommentThreadData[]\n  discussionComments: {\n    comments: CommitComment[]\n    count: number\n    canLoadMore: boolean\n  }\n  subscribed: boolean\n}\n\nexport function useDeferredCommentData(repo: Repository, commitOid: Commit['oid']) {\n  const [deferredData, setDeferredData] = useState<DeferredCommentData | undefined>(undefined)\n  const [state, setState] = useState<FetchRequestState>('initial')\n\n  useEffect(() => {\n    setDeferredData(undefined)\n    setState('loading')\n\n    const fetchDeferredData = async () => {\n      const deferredCommentData = await fetchDeferredCommentData({repo, commitOid})\n\n      setDeferredData(deferredCommentData)\n      setState('loaded')\n    }\n\n    fetchDeferredData()\n  }, [commitOid, repo])\n\n  return {\n    deferredCommentData: deferredData,\n    state,\n  }\n}\n\nexport async function fetchDeferredCommentData({repo, commitOid}: {repo: Repository; commitOid: Commit['oid']}) {\n  const response = await reactFetchJSON(\n    getInsightsUrl(\n      commitCommentDeferredCommentDataPath({\n        owner: repo.ownerLogin,\n        repo: repo.name,\n        commitOid,\n      }),\n    ),\n  )\n\n  if (response.ok) {\n    const data: DeferredCommentData = await response.json()\n    reportTraceData(data)\n    return data\n  } else {\n    throw new Error('Failed to fetch comment data')\n  }\n}\n","import {SidebarCollapseIcon, SidebarExpandIcon} from '@primer/octicons-react'\nimport {IconButton, Tooltip, type TooltipProps} from '@primer/react'\nimport {clsx} from 'clsx'\nimport React from 'react'\n\ninterface ExpandButtonProps {\n  expanded?: boolean\n  onToggleExpanded: React.MouseEventHandler<HTMLButtonElement>\n  testid: string\n  alignment: 'left' | 'right'\n  ariaLabel: string\n  ariaControls: string\n  dataHotkey?: string\n  className?: string\n  tooltipDirection?: TooltipProps['direction']\n}\n\n// TODO - copied from React Shared, need to move it out to its own package\nexport const ExpandButton = React.forwardRef(\n  (\n    {\n      expanded,\n      testid,\n      ariaLabel,\n      ariaControls,\n      onToggleExpanded,\n      alignment,\n      dataHotkey,\n      className,\n      tooltipDirection,\n    }: ExpandButtonProps,\n    ref: React.ForwardedRef<HTMLButtonElement>,\n  ) => (\n    <Tooltip aria-label={ariaLabel} id={`expand-button-${testid}`} direction={tooltipDirection}>\n      {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n      <IconButton\n        unsafeDisableTooltip={true}\n        ref={ref}\n        data-testid={expanded ? `collapse-${testid}` : `expand-${testid}`}\n        aria-labelledby={`expand-button-${testid}`}\n        aria-expanded={expanded}\n        aria-controls={ariaControls}\n        icon={\n          expanded\n            ? alignment === 'left'\n              ? SidebarExpandIcon\n              : SidebarCollapseIcon\n            : alignment === 'left'\n              ? SidebarCollapseIcon\n              : SidebarExpandIcon\n        }\n        data-hotkey={dataHotkey}\n        onClick={e => {\n          onToggleExpanded(e)\n        }}\n        variant=\"invisible\"\n        className={clsx(className, 'fgColor-muted')}\n      />\n    </Tooltip>\n  ),\n)\n\nExpandButton.displayName = 'ExpandButton'\n","// eslint-disable-next-line filenames/match-regex\nimport {useCurrentUser} from '@github-ui/current-user'\nimport {getCurrentSize, ScreenSize} from '@github-ui/screen-size'\nimport {useClientValue} from '@github-ui/use-client-value'\nimport type {SplitPageLayoutContentProps, SplitPageLayoutPaneProps} from '@primer/react'\nimport {useCallback, useMemo, useRef, useState} from 'react'\n\nimport {ExpandButton} from '../components/Commit/ExpandButton'\nimport {useUpdateUserTreePreference} from './use-update-user-tree-preference'\n\ntype ExpandTreeFunction = () => void\ntype CollapseTreeFunction = () => void\n\ninterface TreePane {\n  splitPagePaneHiddenSx: SplitPageLayoutPaneProps['sx']\n  splitPageContentHidden: SplitPageLayoutContentProps['hidden']\n  treeToggleElement: JSX.Element\n  treeToggleRef: React.RefObject<HTMLButtonElement>\n  expandTree: ExpandTreeFunction\n  collapseTree: CollapseTreeFunction\n}\n\nexport function useTreePane(fileTreeId: string, userPrefTreeExpanded: boolean): TreePane {\n  const updateExpandPreferences = useUpdateUserTreePreference()\n  const [isSSR] = useClientValue(() => false, true, [])\n  const currentUser = useCurrentUser()\n\n  const treeToggleRef = useRef<HTMLButtonElement>(null)\n  const mobileTreeToggleRef = useRef<HTMLButtonElement>(null)\n\n  const [isTreeExpanded, setIsTreeExpanded] = useState(userPrefTreeExpanded)\n  const [isMobileTreeExpanded, setIsMobileTreeExpanded] = useState(false)\n\n  const expandTree: ExpandTreeFunction = useCallback(() => {\n    // we can do this since we're now on the client when this occurs\n    const currentSize = getCurrentSize(window.innerWidth)\n\n    if (currentSize <= ScreenSize.medium) {\n      setIsMobileTreeExpanded(true)\n      requestAnimationFrame(() => mobileTreeToggleRef.current?.focus())\n    } else {\n      setIsTreeExpanded(true)\n      updateExpandPreferences(true, currentUser)\n      requestAnimationFrame(() => treeToggleRef.current?.focus())\n    }\n  }, [currentUser, updateExpandPreferences])\n\n  const collapseTree: CollapseTreeFunction = useCallback(() => {\n    // we can do this since we're now on the client when this occurs\n    const currentSize = getCurrentSize(window.innerWidth)\n\n    if (currentSize <= ScreenSize.medium) {\n      setIsMobileTreeExpanded(false)\n      requestAnimationFrame(() => mobileTreeToggleRef.current?.focus())\n    } else {\n      setIsTreeExpanded(false)\n      updateExpandPreferences(false, currentUser)\n      requestAnimationFrame(() => treeToggleRef.current?.focus())\n    }\n  }, [currentUser, updateExpandPreferences])\n\n  const regularTreeToggleElement = useMemo(\n    () => (\n      <ExpandButton\n        expanded={isTreeExpanded}\n        alignment=\"left\"\n        ariaLabel={isTreeExpanded ? 'Collapse file tree' : 'Expand file tree'}\n        tooltipDirection=\"se\"\n        testid=\"file-tree-button\"\n        ariaControls={fileTreeId}\n        ref={treeToggleRef}\n        onToggleExpanded={() => {\n          isTreeExpanded ? collapseTree() : expandTree()\n        }}\n        className=\"d-none d-md-flex position-relative\"\n      />\n    ),\n    [isTreeExpanded, fileTreeId, collapseTree, expandTree],\n  )\n\n  const mobileTreeToggleElement = useMemo(\n    () => (\n      <ExpandButton\n        expanded={isMobileTreeExpanded}\n        alignment=\"left\"\n        ariaLabel={isMobileTreeExpanded ? 'Collapse file tree' : 'Expand file tree'}\n        tooltipDirection=\"se\"\n        testid=\"file-tree-button\"\n        ariaControls={fileTreeId}\n        ref={mobileTreeToggleRef}\n        onToggleExpanded={() => {\n          isMobileTreeExpanded ? collapseTree() : expandTree()\n        }}\n        className=\"d-md-none position-relative\"\n      />\n    ),\n    [isMobileTreeExpanded, fileTreeId, collapseTree, expandTree],\n  )\n\n  const treeToggleElement = useMemo(\n    () => (\n      <>\n        {mobileTreeToggleElement}\n        {regularTreeToggleElement}\n      </>\n    ),\n    [mobileTreeToggleElement, regularTreeToggleElement],\n  )\n\n  let splitPagePaneHiddenSx: TreePane['splitPagePaneHiddenSx'] = {}\n\n  // this SX hackery instead of using panel[\"hidden\"] brought to you by SSR\n  if (isSSR && !userPrefTreeExpanded) {\n    splitPagePaneHiddenSx = {display: 'none'}\n  } else {\n    splitPagePaneHiddenSx = {\n      flexDirection: ['column', 'column', 'inherit'],\n      '@media screen and (max-width: 768px)': !isMobileTreeExpanded ? {display: 'none'} : {mt: -3},\n      '@media screen and (min-width: 769px)': isTreeExpanded\n        ? {\n            height: '100vh',\n            maxHeight: '100vh !important',\n          }\n        : {display: 'none'},\n    }\n  }\n\n  return {\n    splitPagePaneHiddenSx,\n    splitPageContentHidden: {narrow: isMobileTreeExpanded, regular: false},\n    expandTree,\n    collapseTree,\n    treeToggleElement,\n    treeToggleRef,\n  }\n}\n","import {userPRFileTreeVisibilitySettingPath} from '@github-ui/paths'\nimport type {CurrentUser} from '@github-ui/repos-types'\nimport {verifiedFetch} from '@github-ui/verified-fetch'\n\nexport function useUpdateUserTreePreference() {\n  async function updateFileTreePreference(treeValue: boolean, currentUser?: CurrentUser) {\n    if (!currentUser) {\n      return\n    }\n\n    const formData = new FormData()\n    formData.set('file_tree_visible', treeValue ? 'true' : 'false')\n\n    verifiedFetch(userPRFileTreeVisibilitySettingPath(currentUser), {\n      method: 'PUT',\n      body: formData,\n      headers: {Accept: 'application/json'},\n    })\n  }\n\n  return updateFileTreePreference\n}\n","import {type Repository, useCurrentRepository} from '@github-ui/current-repository'\nimport {branchCommmitsPath} from '@github-ui/paths'\nimport {verifiedFetchJSON} from '@github-ui/verified-fetch'\nimport {useEffect, useState} from 'react'\n\nexport interface BranchInfo {\n  branch: string\n  prs: LinkedPullRequest[]\n}\n\ninterface BranchCommitData {\n  branches: BranchInfo[]\n  tags: string[]\n}\n\nexport interface LinkedPullRequest {\n  number: number\n  showPrefix: string\n  repo: Pick<Repository, 'name' | 'ownerLogin'>\n  globalRelayId: string\n}\n\nexport interface BranchCommitState extends BranchCommitData {\n  loading: boolean\n}\n\nexport function useLoadBranchCommits(commitOid: string): BranchCommitState {\n  const repo = useCurrentRepository()\n\n  const [state, setState] = useState<BranchCommitState>({branches: [], tags: [], loading: true})\n\n  useEffect(() => {\n    let cancelled = false\n    const update = async () => {\n      setState({branches: [], tags: [], loading: true})\n      const response = await verifiedFetchJSON(\n        branchCommmitsPath({owner: repo.ownerLogin, repo: repo.name, commitish: commitOid}),\n      )\n\n      if (cancelled) {\n        return\n      }\n\n      try {\n        if (response.ok) {\n          const data = await response.json()\n          data.loading = false\n          if (data) {\n            setState({...data, loading: false})\n          }\n        } else {\n          setState({branches: [], tags: [], loading: false})\n        }\n      } catch (e) {\n        setState({branches: [], tags: [], loading: false})\n      }\n    }\n\n    update()\n\n    return function cancel() {\n      cancelled = true\n    }\n  }, [repo.ownerLogin, repo.name, commitOid])\n\n  return state\n}\n","import type {DiffEntryData} from '@github-ui/diff-lines'\n\nimport type {CommitFile, DiffEntryDataWithExtraInfo} from '../types/commit-types'\n\nexport function splitDiffEntryData(\n  data: DiffEntryDataWithExtraInfo[] | Array<Pick<DiffEntryData, 'path' | 'status' | 'pathDigest'>>,\n): [DiffEntryDataWithExtraInfo[], CommitFile[]] {\n  const lastIndexOfCompleteDiffData =\n    data.findIndex(diffEntry => {\n      return (diffEntry as DiffEntryDataWithExtraInfo).oldOid === undefined\n    }) - 1\n\n  let completeDiffData: DiffEntryDataWithExtraInfo[]\n  // No incomplete diff data\n  if (lastIndexOfCompleteDiffData === -2) {\n    completeDiffData = data as DiffEntryDataWithExtraInfo[]\n  } else {\n    completeDiffData = data.slice(0, lastIndexOfCompleteDiffData + 1) as DiffEntryDataWithExtraInfo[]\n  }\n\n  const fileTreeData: CommitFile[] = data.map(diffEntry => {\n    return {\n      path: diffEntry.path,\n      changeType: diffEntry.status,\n      pathDigest: diffEntry.pathDigest,\n    }\n  })\n\n  return [completeDiffData, fileTreeData]\n}\n","import {Link} from '@primer/react'\n\nexport function CommitHelpMessage({url}: {url: string}) {\n  return (\n    <>\n      <div className=\"text-center\">\n        <p className=\"color-fg-muted f6 mt-4\">\n          Seeing something unexpected? Take a look at the\n          <Link inline href={url}>\n            {' '}\n            GitHub commits guide\n          </Link>\n          .\n        </p>\n      </div>\n    </>\n  )\n}\n\ntry{ CommitHelpMessage.displayName ||= 'CommitHelpMessage' } catch {}","import type React from 'react'\nimport {createContext, useContext} from 'react'\n\nimport type {CommitsFilters} from '../types/commits-types'\n\nconst emptyFilters: CommitsFilters = {\n  since: null,\n  until: null,\n  author: null,\n  currentBlobPath: '',\n  pagination: {\n    hasNextPage: false,\n    hasPreviousPage: false,\n    endCursor: '',\n    startCursor: '',\n  },\n  newPath: null,\n  originalBranch: null,\n}\n\nconst FilterContext = createContext<CommitsFilters>(emptyFilters)\n\nexport function FilterProvider({filters, children}: React.PropsWithChildren<{filters: CommitsFilters}>) {\n  return <FilterContext.Provider value={filters}>{children}</FilterContext.Provider>\n}\n\nexport function useFilters() {\n  return useContext(FilterContext)\n}\n\ntry{ FilterContext.displayName ||= 'FilterContext' } catch {}\ntry{ FilterProvider.displayName ||= 'FilterProvider' } catch {}","import {useCurrentRepository} from '@github-ui/current-repository'\nimport {commitsPath} from '@github-ui/paths'\nimport {Link} from '@github-ui/react-core/link'\nimport {Spinner} from '@primer/react'\n\nimport {useIsDeferredDataLoading, useRenameHistoryData} from '../../contexts/DeferredCommitDataContext'\nimport {useFilters} from '../../contexts/FilterContext'\nimport {TimelineRow} from './TimelineRow'\n\nexport function useShouldClipTimeline() {\n  const hasRenamedToHistory = useHasRenamedToHistory()\n  const filters = useFilters()\n\n  return !hasRenamedToHistory && !filters.pagination.hasPreviousPage\n}\n\nfunction useHasRenamedToHistory() {\n  const filters = useFilters()\n\n  return filters.newPath && filters.originalBranch\n}\n\nexport function RenamedToHistory() {\n  const repo = useCurrentRepository()\n  const filters = useFilters()\n\n  if (!useHasRenamedToHistory()) {\n    return null\n  }\n\n  return (\n    <TimelineRow sx={{pt: 1, pb: 0}}>\n      <div className=\"d-flex flex-items-baseline\">\n        <TimelineRow.Heading as=\"h3\" title={`Renamed to ${filters.newPath}`} data-testid=\"commit-note-title\" />\n        <Link\n          to={commitsPath({\n            owner: repo.ownerLogin,\n            repo: repo.name,\n            ref: filters.originalBranch!,\n            path: filters.newPath!,\n          })}\n        >\n          (Browse History)\n        </Link>\n      </div>\n    </TimelineRow>\n  )\n}\n\nfunction RenamedFromHistory() {\n  const renameHistory = useRenameHistoryData()\n\n  if (!renameHistory?.hasRenameCommits) {\n    return null\n  }\n\n  return (\n    <TimelineRow>\n      <div className=\"d-flex flex-items-baseline\">\n        <TimelineRow.Heading as=\"h3\" title={`Renamed from ${renameHistory?.oldName}`} data-testid=\"commit-note-title\" />\n        <Link to={renameHistory?.historyUrl}>(Browse History)</Link>\n      </div>\n    </TimelineRow>\n  )\n}\n\nfunction EndOfFileHistory() {\n  const renameHistory = useRenameHistoryData()\n\n  if (renameHistory?.hasRenameCommits) {\n    return null\n  }\n\n  return (\n    <TimelineRow clipTimeline=\"bottom\">\n      <TimelineRow.Heading as=\"h3\" title=\"End of commit history for this file\" data-testid=\"commit-note-title\" />\n    </TimelineRow>\n  )\n}\n\nexport function EndOfFile() {\n  const filters = useFilters()\n  const isLoading = useIsDeferredDataLoading()\n\n  if (!filters.currentBlobPath) {\n    return null\n  }\n\n  if (filters.currentBlobPath && filters.pagination.hasNextPage) {\n    return null\n  }\n\n  return (\n    <>\n      {isLoading && <TimelineRow leadingVisual={<Spinner size=\"small\" />} />}\n      {!isLoading && (\n        <>\n          <RenamedFromHistory />\n          <EndOfFileHistory />\n        </>\n      )}\n    </>\n  )\n}\n\ntry{ RenamedToHistory.displayName ||= 'RenamedToHistory' } catch {}\ntry{ RenamedFromHistory.displayName ||= 'RenamedFromHistory' } catch {}\ntry{ EndOfFileHistory.displayName ||= 'EndOfFileHistory' } catch {}\ntry{ EndOfFile.displayName ||= 'EndOfFile' } catch {}","import {useCurrentRepository} from '@github-ui/current-repository'\nimport {Heading} from '@primer/react'\n\nimport {useFilters} from '../../contexts/FilterContext'\nimport {Commits} from '../../shared/Commits'\nimport {useLoadDeferredCommitData} from '../../shared/use-load-deferred-commit-data'\nimport type {CommitGroup as CommitGroupType} from '../../types/commits-types'\nimport {EndOfFile, RenamedToHistory, useShouldClipTimeline} from './FileHistory'\n\nexport function CommitList({\n  commitGroups,\n  deferredDataUrl,\n  softNavToCommit,\n}: {\n  commitGroups: CommitGroupType[]\n  deferredDataUrl: string\n  softNavToCommit: boolean\n}) {\n  const filters = useFilters()\n  const repo = useCurrentRepository()\n  const deferredCommitData = useLoadDeferredCommitData(deferredDataUrl)\n\n  return (\n    <div className=\"mb-3\" data-hpc>\n      <Heading as=\"h2\" className=\"sr-only\">\n        Commit History\n      </Heading>\n\n      <Commits\n        leadingContent={<RenamedToHistory />}\n        commitGroups={commitGroups}\n        trailingContent={<EndOfFile />}\n        repository={repo}\n        deferredCommitData={deferredCommitData}\n        shouldClipTimeline={useShouldClipTimeline()}\n        currentBlobPath={filters.currentBlobPath}\n        softNavToCommit={softNavToCommit}\n      />\n    </div>\n  )\n}\n\ntry{ CommitList.displayName ||= 'CommitList' } catch {}","import memoize from '@github/memoize'\nimport {useCurrentRepository} from '@github-ui/current-repository'\nimport type {User, UsersState} from '@github-ui/user-selector'\nimport {verifiedFetchJSON} from '@github-ui/verified-fetch'\nimport {useEffect, useState} from 'react'\n\ninterface ActorsResponse {\n  actors: User[]\n}\n\nasync function fetchJSON(url: string): Promise<ActorsResponse | undefined> {\n  const response = await verifiedFetchJSON(url)\n  if (response.ok) {\n    return await response.json()\n  } else {\n    return undefined\n  }\n}\n\nconst memoizeCache = new Map()\nconst memoizeFetchJSON = memoize(fetchJSON, {cache: memoizeCache})\n\nexport function useLoadAuthorData(url: string): UsersState {\n  const repo = useCurrentRepository()\n  const baseUrl = ''\n  const timePeriod = 'all'\n  const [usersState, setUsersState] = useState<UsersState>({\n    users: [],\n    error: false,\n    loading: true,\n  })\n\n  useEffect(() => {\n    let cancelled = false\n    const update = async () => {\n      setUsersState({\n        users: [],\n        error: false,\n        loading: true,\n      })\n      const actorsResponse = await memoizeFetchJSON(url)\n\n      if (cancelled) {\n        return\n      }\n\n      let users: User[] = []\n      let error = false\n\n      try {\n        if (actorsResponse) {\n          users = actorsResponse.authors\n        } else {\n          error = true\n        }\n      } catch (e) {\n        error = true\n      }\n\n      setUsersState({\n        users,\n        error,\n        loading: false,\n      })\n    }\n\n    update()\n\n    return function cancel() {\n      cancelled = true\n    }\n  }, [repo, baseUrl, url, timePeriod])\n\n  return usersState\n}\n","import {ssrSafeLocation} from '@github-ui/ssr-utils'\n\nexport function addOrModifyUrlParameters(\n  parameters: Record<string, string | number | boolean>,\n  parametersToRemove: string[],\n): string {\n  const urlObject = new URL(\n    ssrSafeLocation.origin + ssrSafeLocation.pathname + ssrSafeLocation.search,\n    ssrSafeLocation.origin,\n  )\n  const searchParams = urlObject.searchParams\n\n  for (const key of parametersToRemove) {\n    if (searchParams.has(key)) searchParams.delete(key)\n  }\n\n  for (const [key, value] of Object.entries(parameters)) {\n    searchParams.set(key, value.toString())\n  }\n\n  // return relative url for soft navs\n  return urlObject.pathname + urlObject.search\n}\n","import type {Repository} from '@github-ui/current-repository'\nimport {commitsPath, repositoryTreePath} from '@github-ui/paths'\nimport {RefSelector} from '@github-ui/ref-selector'\nimport {useNavigate} from '@github-ui/use-navigate'\nimport {type User, UserSelector} from '@github-ui/user-selector'\nimport {CalendarIcon, TriangleDownIcon} from '@primer/octicons-react'\nimport {ActionList, Box, type BoxProps, BranchName, Breadcrumbs, Button, Heading, Octicon} from '@primer/react'\nimport {isValid, parseISO} from 'date-fns'\nimport React, {lazy, Suspense} from 'react'\n\nimport {useLoadAuthorData} from '../../hooks/use-load-author-data'\nimport type {RefInfo} from '../../types/shared'\nimport {addOrModifyUrlParameters} from '../../utils/add-or-modify-url-parameters'\nimport {extractRange} from '../../utils/extract-range'\nimport {shortSha} from '../../utils/short-sha'\n\n// eslint-disable-next-line github/no-then\nconst DatePicker = lazy(() => import('@github-ui/date-picker').then(m => ({default: m.DatePicker})))\nconst StyledCalendarIcon = () => <Octicon icon={CalendarIcon} className=\"fgColor-muted\" sx={{my: '2px'}} />\n\ninterface ListHeaderProps {\n  repo: Repository\n  refInfo: RefInfo\n  path: string\n  author: User | null\n  contributorsUrl: string\n  since: string | null\n  until: string | null\n  sx?: BoxProps['sx']\n}\n\nexport function ListHeader({repo, refInfo, path, author, contributorsUrl, since, until, sx = {}}: ListHeaderProps) {\n  let refNameOrCommit = refInfo.name\n  if (refNameOrCommit === refInfo.currentOid) {\n    refNameOrCommit = shortSha(refInfo.currentOid)\n  }\n  const navigate = useNavigate()\n  const actorsState = useLoadAuthorData(contributorsUrl)\n\n  const value = React.useMemo(() => {\n    const from = parseISO(since ?? '')\n    const to = parseISO(until ?? '')\n    if (!isValid(from) || !isValid(to)) return null\n    return {from, to}\n  }, [since, until])\n\n  const pathSplit = path?.split('/')\n\n  return (\n    <Box sx={{display: 'flex', flexDirection: 'row', justifyContent: 'space-between', gap: 2, ...sx}}>\n      {path && (\n        <div className=\"d-flex flex-items-center\">\n          <div className=\"d-flex flex-items-baseline flex-column flex-sm-row\">\n            <Heading as=\"h2\" className=\"sr-only\">\n              Breadcrumbs\n            </Heading>\n\n            <span className=\"fgColor-default no-wrap\">History for</span>\n            <Breadcrumbs className=\"ml-1\">\n              <Breadcrumbs.Item href={commitsPath({owner: repo.ownerLogin, repo: repo.name})}>\n                {repo.name}\n              </Breadcrumbs.Item>\n              {pathSplit.map((part, index, parts) => {\n                const href = commitsPath({\n                  owner: repo.ownerLogin,\n                  repo: repo.name,\n                  ref: refInfo.name,\n                  path: parts.slice(0, index + 1).join('/'),\n                })\n\n                const isLastElement = index === parts.length - 1\n                const lastElementSx = isLastElement ? {fontWeight: 'bold'} : {}\n\n                return (\n                  <Breadcrumbs.Item\n                    sx={{whiteSpace: 'normal', ...lastElementSx}}\n                    key={href}\n                    href={href}\n                    selected={isLastElement}\n                  >\n                    {part}\n                  </Breadcrumbs.Item>\n                )\n              })}\n            </Breadcrumbs>\n            <div className=\"no-wrap\">\n              <span className=\"mr-2 ml-0 ml-sm-2 fgColor-default\">on</span>\n              <BranchName href={repositoryTreePath({repo, commitish: refInfo.name, action: 'tree'})}>\n                {refNameOrCommit}\n              </BranchName>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {!path && (\n        <>\n          <Heading as=\"h2\" className=\"sr-only\">\n            Branch selector\n          </Heading>\n          <RefSelector\n            cacheKey={refInfo.listCacheKey}\n            canCreate={false}\n            hotKey={'w'} // TODO - get from useShortcut?\n            currentCommitish={refInfo.name}\n            getHref={refName =>\n              commitsPath({\n                owner: repo.ownerLogin,\n                repo: repo.name,\n                ref: refName,\n              })\n            }\n            selectedRefType={refInfo.refType}\n            defaultBranch={repo.defaultBranch}\n            owner={repo.ownerLogin}\n            repo={repo.name}\n            idEnding=\"commits\"\n          />\n        </>\n      )}\n      <div className=\"d-flex flex-column flex-sm-row gap-2\">\n        <Heading as=\"h2\" className=\"sr-only\">\n          User selector\n        </Heading>\n        <UserSelector\n          defaultText=\"All users\"\n          width=\"medium\"\n          usersState={actorsState}\n          showTypedInUser={true}\n          currentUser={author ?? undefined}\n          onOpenChange={open => open}\n          onSelect={selectedUser => {\n            if (selectedUser.login !== author?.login) {\n              const authorRecord: Record<string, string> = {author: selectedUser.login}\n              navigate(addOrModifyUrlParameters(authorRecord, ['author', 'before', 'after']))\n            }\n          }}\n          renderCustomFooter={() => (\n            <ActionList.LinkItem href={addOrModifyUrlParameters({}, ['author'])}>\n              View commits for all users\n            </ActionList.LinkItem>\n          )}\n        />\n\n        <Suspense\n          fallback={\n            <Button leadingVisual={StyledCalendarIcon} trailingVisual={TriangleDownIcon}>\n              All time\n            </Button>\n          }\n        >\n          <Heading as=\"h2\" className=\"sr-only\">\n            Datepicker\n          </Heading>\n          <DatePicker\n            variant=\"range\"\n            value={value}\n            maxDate={new Date()}\n            showTodayButton={true}\n            showClearButton={true}\n            compressedHeader={true}\n            onChange={range => {\n              if (!range) {\n                // empty range is from the clear button\n                navigate(addOrModifyUrlParameters({}, ['since', 'until']))\n                return\n              }\n\n              const extractedRange = extractRange(range)\n              if (!extractedRange) return\n              const {startDate, endDate} = extractedRange\n              const urlRecord: Record<string, string> = {since: startDate, until: endDate}\n              const newUrl = addOrModifyUrlParameters(urlRecord, ['before', 'after'])\n              navigate(newUrl)\n            }}\n            placeholder=\"All time\"\n            anchor={({children, ...props}) => (\n              <Button\n                {...props}\n                data-testid=\"date-picker-commits\"\n                leadingVisual={StyledCalendarIcon}\n                trailingVisual={TriangleDownIcon}\n              >\n                {children}\n              </Button>\n            )}\n          />\n        </Suspense>\n      </div>\n    </Box>\n  )\n}\n\ntry{ DatePicker.displayName ||= 'DatePicker' } catch {}\ntry{ StyledCalendarIcon.displayName ||= 'StyledCalendarIcon' } catch {}\ntry{ ListHeader.displayName ||= 'ListHeader' } catch {}","import type {RangeSelection} from '@github-ui/date-picker'\nimport {formatISO} from 'date-fns'\n\nexport function extractRange(range: RangeSelection | null) {\n  if (!range) return\n  const startDate = formatISO(range.from, {representation: 'date'})\n  const endDate = formatISO(range.to, {representation: 'date'})\n\n  return {startDate, endDate}\n}\n","import {Link} from '@github-ui/react-core/link'\nimport {ChevronLeftIcon, ChevronRightIcon} from '@primer/octicons-react'\nimport {Button, ButtonGroup, type ButtonProps, Heading, Octicon} from '@primer/react'\n\nimport type {PaginationCursor} from '../../types/commits-types'\nimport {addOrModifyUrlParameters} from '../../utils/add-or-modify-url-parameters'\n\ninterface PaginationProps {\n  paginationInfo: PaginationCursor\n}\n\nexport function Pagination({paginationInfo}: PaginationProps) {\n  const hasPreviousPage = paginationInfo.hasPreviousPage\n  const hasNextPage = paginationInfo.hasNextPage\n\n  const getDisabledProps = (disabled: boolean) => {\n    const ariaDisabledProps: Pick<ButtonProps, 'className' | 'onClick' | 'aria-disabled' | 'sx'> = disabled\n      ? {\n          'aria-disabled': true,\n          sx: {\n            backgroundColor: 'transparent',\n            border: 'none',\n            cursor: 'default',\n            color: 'primer.fg.disabled',\n            fontWeight: 'normal',\n          },\n          onClick: e => e.preventDefault(),\n        }\n      : {}\n\n    return ariaDisabledProps\n  }\n\n  // If there's only one page, don't show pagination\n  if (!hasPreviousPage && !hasNextPage) {\n    return null\n  }\n\n  return (\n    <>\n      <Heading as=\"h2\" className=\"sr-only\">\n        Pagination\n      </Heading>\n\n      <div className=\"d-flex flex-justify-center mt-2\">\n        <ButtonGroup>\n          <Button\n            as={Link}\n            to={generateCommitPaginationUrl(paginationInfo, false)}\n            className=\"fgColor-accent text-normal\"\n            {...getDisabledProps(!hasPreviousPage)}\n            tabIndex={0}\n            variant=\"invisible\"\n            data-testid=\"pagination-prev-button\"\n            leadingVisual={hasPreviousPage ? () => <Octicon icon={ChevronLeftIcon} className=\"fgColor-accent\" /> : null}\n          >\n            Previous\n          </Button>\n          <Button\n            as={Link}\n            to={generateCommitPaginationUrl(paginationInfo, true)}\n            className=\"fgColor-accent text-normal\"\n            {...getDisabledProps(!hasNextPage)}\n            tabIndex={0}\n            variant=\"invisible\"\n            data-testid=\"pagination-next-button\"\n            trailingVisual={hasNextPage ? () => <Octicon icon={ChevronRightIcon} className=\"fgColor-accent\" /> : null}\n          >\n            Next\n          </Button>\n        </ButtonGroup>\n      </div>\n    </>\n  )\n}\n\nfunction generateCommitPaginationUrl(paginationInfo: PaginationCursor, isNext: boolean) {\n  let urlRecord: Record<string, string>\n  if (isNext) {\n    urlRecord = {after: paginationInfo.endCursor}\n  } else {\n    urlRecord = {before: paginationInfo.startCursor}\n  }\n  return addOrModifyUrlParameters(urlRecord, [isNext ? 'before' : 'after'])\n}\n\ntry{ Pagination.displayName ||= 'Pagination' } catch {}","import {Heading, PageLayout} from '@primer/react'\nimport type {PropsWithChildren} from 'react'\n\ntype LayoutProps = {\n  title: string\n}\n\nexport default function Layout({children, title}: PropsWithChildren<LayoutProps>) {\n  return (\n    <PageLayout rowGap=\"none\">\n      <PageLayout.Header divider=\"line\" sx={{mb: 3}}>\n        <div className=\"d-flex flex-items-center flex-justify-between\">\n          <Heading as=\"h1\" className=\"f2 text-normal pb-2\" id=\"commits-pagehead\">\n            {title}\n          </Heading>\n        </div>\n      </PageLayout.Header>\n\n      <PageLayout.Content as=\"div\">\n        <div>{children}</div>\n      </PageLayout.Content>\n    </PageLayout>\n  )\n}\n\ntry{ Layout.displayName ||= 'Layout' } catch {}","import {useCurrentRepository} from '@github-ui/current-repository'\nimport {useRoutePayload} from '@github-ui/react-core/use-route-payload'\nimport {ssrSafeLocation} from '@github-ui/ssr-utils'\nimport {useEffect} from 'react'\n\nimport {CommitHelpMessage} from '../components/Commits/CommitHelpMessage'\nimport {CommitList} from '../components/Commits/CommitList'\nimport {ListHeader} from '../components/Commits/ListHeader'\nimport {Pagination} from '../components/Commits/Pagination'\nimport Layout from '../components/Layout'\nimport {FilterProvider} from '../contexts/FilterContext'\nimport {useCommitsAppPayload} from '../hooks/use-commits-app-payload'\nimport {CommitsBlankState} from '../shared/CommitsBlankState'\nimport type {CommitsPayload} from '../types/commits-types'\n\nexport function Commits() {\n  const repo = useCurrentRepository()\n  const appPayload = useCommitsAppPayload()\n  const payload = useRoutePayload<CommitsPayload>()\n  const filters = payload.filters\n  const commitGroups = payload.commitGroups\n  const softNavToCommit = payload.metadata.softNavToCommit\n\n  const unavailableMessage = `There isn't any commit history to show here${\n    filters.since !== null || filters.until !== null ? ' for the selected date range' : ''\n  }`\n\n  useEffect(() => {\n    // scroll to top of code nav on file change if not going to a specific line and already scrolled down\n    if (!ssrSafeLocation.hash && window.scrollY > 0) {\n      const header = document.querySelector('#commits-pagehead') as HTMLElement\n      header?.scrollIntoView()\n    }\n  }, [payload.filters.pagination, payload.filters.since, payload.filters.until])\n\n  return (\n    <FilterProvider filters={payload.filters}>\n      <Layout title=\"Commits\">\n        <ListHeader\n          repo={repo}\n          contributorsUrl={payload.metadata.deferredContributorUrl}\n          since={filters.since}\n          until={filters.until}\n          author={filters.author}\n          refInfo={payload.refInfo}\n          path={filters.currentBlobPath}\n          sx={{mb: 3}}\n        />\n\n        {commitGroups.length === 0 && (\n          <CommitsBlankState timeoutMessage={payload.timedOutMessage} unavailableMessage={unavailableMessage} />\n        )}\n        {commitGroups.length > 0 && (\n          <>\n            <CommitList\n              commitGroups={commitGroups}\n              deferredDataUrl={payload.metadata.deferredDataUrl}\n              softNavToCommit={softNavToCommit}\n            />\n            <Pagination paginationInfo={filters.pagination} />\n          </>\n        )}\n        {payload.metadata.showProfileHelp && (\n          <CommitHelpMessage url={`${appPayload.helpUrl}/articles/troubleshooting-commits-on-your-timeline`} />\n        )}\n      </Layout>\n    </FilterProvider>\n  )\n}\n\ntry{ Commits.displayName ||= 'Commits' } catch {}","import {jsonRoute} from '@github-ui/react-core/json-route'\nimport {registerReactAppFactory} from '@github-ui/react-core/register-app'\n\nimport {App} from './App'\nimport {Commit} from './routes/Commit'\nimport {Commits} from './routes/Commits'\n\nregisterReactAppFactory('commits', () => ({\n  App,\n  routes: [\n    jsonRoute({path: '/:owner/:repo/commits', Component: Commits}),\n    jsonRoute({path: '/:owner/:repo/commits/:ref', Component: Commits}),\n    jsonRoute({path: '/:owner/:repo/commits/:ref/:path/*', Component: Commits}),\n    jsonRoute({path: '/:owner/:repo/commit/:oid', Component: Commit}),\n    jsonRoute({path: '/:owner/:repo/commit/:oid/:path/*', Component: Commit}),\n    jsonRoute({\n      path: '/_view_fragments/Voltron::CommitFragmentsController/show/:owner/:repo/:name/repo_layout',\n      Component: Commit,\n    }),\n  ],\n}))\n","import {getInsightsUrl, reportTraceData} from '@github-ui/internal-api-insights'\nimport {reactFetchJSON} from '@github-ui/verified-fetch'\nimport {useEffect, useRef, useState} from 'react'\n\nimport {baseEmptyStateLoading, baseEmptyStateNotLoading} from '../contexts/DeferredCommitDataContext'\nimport type {DeferredCommitData, DeferredData} from '../types/commits-types'\n\nexport function useLoadDeferredCommitData(url: string, updatedAt?: number): DeferredData {\n  const [state, setState] = useState<DeferredData>(baseEmptyStateLoading)\n\n  useEffect(() => {\n    if (!url) return\n\n    let cancelled = false\n    const update = async () => {\n      setState(baseEmptyStateLoading)\n      const response = await reactFetchJSON(getInsightsUrl(url))\n\n      if (cancelled) {\n        return\n      }\n\n      try {\n        if (response.ok) {\n          const data = await response.json()\n          data.loading = false\n          if (data) {\n            reportTraceData(data)\n            setState(data)\n          }\n        } else {\n          setState(baseEmptyStateNotLoading)\n        }\n      } catch (e) {\n        setState(baseEmptyStateNotLoading)\n      }\n    }\n\n    update()\n\n    return function cancel() {\n      cancelled = true\n    }\n  }, [url, updatedAt])\n\n  return state\n}\n\nexport function useLoadSingleDeferredCommitData(url: string): DeferredCommitData | null {\n  const [state, setState] = useState<DeferredCommitData | null>(null)\n\n  useEffect(() => {\n    if (!url) return\n\n    const update = async () => {\n      const response = await reactFetchJSON(getInsightsUrl(url))\n\n      try {\n        if (response.ok) {\n          const data = await response.json()\n          if (data) {\n            reportTraceData(data)\n            setState(data.data)\n          }\n        }\n      } catch (e) {\n        //noop\n      }\n    }\n\n    update()\n  }, [url])\n\n  return state\n}\n\nexport function useLoadDeferredCommitDataPaginated(\n  url: string,\n  startIndex: number,\n  commitCount: number,\n  dataUpdatedAt?: number,\n): DeferredData {\n  const [state, setState] = useState<DeferredData>(baseEmptyStateLoading)\n  const cumulativeDeferredCommitInfo = useRef([...new Array(commitCount)] as Array<DeferredCommitData | undefined>)\n  const previousStartingIndex = useRef(startIndex)\n\n  useEffect(() => {\n    if (!url) return\n\n    let cancelled = false\n    async function update(startingIndex: number) {\n      const response = await reactFetchJSON(`${url}?start_entry=${startingIndex}`)\n\n      if (cancelled) {\n        return\n      }\n\n      try {\n        if (response.ok) {\n          const data = await response.json()\n          if (data) {\n            let index = 0\n            for (let i = previousStartingIndex.current; i < data.nextIndex; i++) {\n              cumulativeDeferredCommitInfo.current[i] = data.deferredCommits[index]\n              index++\n            }\n            data.deferredCommits = cumulativeDeferredCommitInfo.current\n            if (data.loadMore && previousStartingIndex.current !== data.nextIndex) {\n              previousStartingIndex.current = data.nextIndex\n              setState(data)\n              setTimeout(\n                //doing a 0ms timeout allows the state updates to flush, giving the user the parts of the diff\n                //as we get them rather than waiting until they're fully loaded\n                () => update(data.nextIndex),\n                0,\n              )\n            } else if (previousStartingIndex.current === data.nextIndex) {\n              data.error = true\n              setState(data)\n            } else {\n              data.error = false\n              setState(data)\n            }\n          }\n        } else {\n          setState(oldState => ({\n            ...oldState,\n            loading: false,\n            error: true,\n            extraDiffEntries: cumulativeDeferredCommitInfo.current,\n          }))\n        }\n      } catch (e) {\n        //do this to keep any commit info we  have already received rather than wiping it out\n        setState(oldState => ({\n          ...oldState,\n          loading: false,\n          deferredCommits: cumulativeDeferredCommitInfo.current,\n        }))\n      }\n    }\n\n    update(startIndex)\n\n    return function cancel() {\n      cancelled = true\n    }\n  }, [url, dataUpdatedAt, startIndex])\n\n  //if we soft nav to a new diff, reset the cumulative\n  useEffect(() => {\n    cumulativeDeferredCommitInfo.current = []\n    previousStartingIndex.current = startIndex\n  }, [url, dataUpdatedAt, startIndex])\n\n  return state\n}\n","export function anchorComment(commentDatabaseId: string, anchorPrefix = 'r') {\n  history.replaceState(null, '', `#${anchorPrefix}${commentDatabaseId}`)\n}\n","import {jsonSafeStorage} from '@github-ui/safe-storage'\nimport {useEffect, useMemo} from 'react'\n\nconst {getItem, removeItem, setItem} = jsonSafeStorage<PersistedComment | PersistedDiffComment>('localStorage')\n\ntype DiffSide = 'LEFT' | 'RIGHT'\n\nconst buildKey = (\n  parts: {diffSide?: DiffSide; filePath: string; line?: number; subjectId: string},\n  fileLevelComment: boolean,\n) => {\n  const {diffSide, filePath, line, subjectId} = parts\n  if (fileLevelComment) {\n    return `PullRequest:${subjectId}-File:${filePath}`\n  }\n  if (line !== undefined && diffSide !== undefined) {\n    return `PullRequest:${subjectId}-File:${filePath}-Line:${line}-DiffSide:${diffSide}`\n  }\n\n  throw new Error('Cannot build diff line comment cache key for a comment without a line number or diff side')\n}\n\ninterface MultilineCommentArgs {\n  startLine?: number | null\n  startSide?: DiffSide | null\n}\n\nexport interface PersistedDiffComment extends MultilineCommentArgs {\n  text?: string\n}\n\ninterface PersistedCommentArgs extends MultilineCommentArgs {\n  text: string\n}\n\n/**\n * Hook that returns whether a persisted comment exists as well as a function to remove the persisted comment from storage\n */\nfunction usePersistedCommentDataBase<T>(localStorageKey: string, handlePersistedCommentExists?: (arg: T) => void) {\n  let persistedComment = getItem(localStorageKey)\n\n  let hasPersistedComment = !!persistedComment?.text?.trim()\n\n  useEffect(() => {\n    if (!hasPersistedComment) return\n    handlePersistedCommentExists?.(persistedComment as T)\n    // disabling this as hasPersistentComment is the only variable we want to rerun this effect on\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [hasPersistedComment])\n\n  const removePersistedCommentFromStorage = () => {\n    removeItem(localStorageKey)\n    hasPersistedComment = false\n    persistedComment = null\n  }\n\n  return {\n    hasPersistedComment,\n    removePersistedCommentFromStorage,\n  }\n}\n\nexport interface PersistedComment {\n  text: string\n}\n\n/**\n * Hook that returns whether a persisted comment exists\n * and functions to persist and remove pull request comment data from local storage\n *\n */\nexport function usePersistedCommentData({\n  subjectId,\n  handlePersistedCommentExists,\n}: {\n  subjectId: string\n  handlePersistedCommentExists?: (comment: PersistedComment) => void\n}) {\n  const persistedCommentLocalStorageKey = useMemo(() => {\n    return `Comment:${subjectId}`\n  }, [subjectId])\n\n  const {hasPersistedComment, removePersistedCommentFromStorage} = usePersistedCommentDataBase<PersistedComment>(\n    persistedCommentLocalStorageKey,\n    handlePersistedCommentExists,\n  )\n\n  const persistCommentToStorage = (commentText: string) => {\n    setItem(persistedCommentLocalStorageKey, {text: commentText})\n  }\n\n  return {\n    hasPersistedComment,\n    persistCommentToStorage,\n    removePersistedCommentFromStorage,\n  }\n}\n\n/**\n * Hook that returns whether a persisted pull request review comment exists\n * and functions to persist and remove pull request review comment data from local storage\n *\n */\nexport function usePersistedDiffCommentData({\n  diffSide,\n  filePath,\n  handlePersistedCommentExists,\n  line,\n  subjectId,\n  threadId,\n  fileLevelComment,\n}: {\n  diffSide?: DiffSide\n  filePath: string\n  line?: number\n  subjectId: string\n  threadId?: string\n  handlePersistedCommentExists?: (comment: PersistedDiffComment) => void\n  fileLevelComment: boolean\n}) {\n  const persistedCommentLocalStorageKey = useMemo(() => {\n    if (threadId) return threadId\n    return threadId ?? buildKey({diffSide, filePath, line, subjectId}, fileLevelComment)\n  }, [diffSide, filePath, line, subjectId, threadId, fileLevelComment])\n\n  const {hasPersistedComment, removePersistedCommentFromStorage} = usePersistedCommentDataBase<PersistedDiffComment>(\n    persistedCommentLocalStorageKey,\n    handlePersistedCommentExists,\n  )\n\n  const persistCommentToStorage = (args: PersistedCommentArgs) => {\n    let comment: PersistedCommentArgs = {text: args.text}\n    if (args.startLine && args.startSide) {\n      comment = {...comment, startLine: args.startLine, startSide: args.startSide}\n    }\n    setItem(persistedCommentLocalStorageKey, comment)\n  }\n\n  return {\n    hasPersistedComment,\n    persistCommentToStorage,\n    removePersistedCommentFromStorage,\n  }\n}\n","import type {\n  ApplySuggestedChangesValidationData,\n  SuggestedChange,\n  SuggestedChangeLineRange,\n  SuggestedChangesConfiguration,\n  Thread,\n} from './types'\n\n/**\n * Returns functions related to suggested changes\n */\n\n/**\n * Determines if two line ranges intersect\n * Based on https://stackoverflow.com/a/35754308\n */\nexport function lineRangesIntersect(range1: SuggestedChangeLineRange, range2: SuggestedChangeLineRange): boolean {\n  return range1.endLineNumber >= range2.startLineNumber && range1.startLineNumber <= range2.endLineNumber\n}\n\n/** Checks to see if a suggested change is in a pending batch of suggested changes */\nexport function isSuggestedChangeInPendingBatch(\n  suggestedChange: SuggestedChange,\n  pendingBatch: SuggestedChange[],\n): boolean {\n  return pendingBatch.some((batchedChange: SuggestedChange) => {\n    return isSuggestedChangeEqual(batchedChange, suggestedChange)\n  })\n}\n\n/** Determines whether a change is equivalent to another */\nexport function isSuggestedChangeEqual(a: SuggestedChange, b: SuggestedChange) {\n  return (\n    a.commentId === b.commentId &&\n    a.path === b.path &&\n    a.suggestion.length === b.suggestion.length &&\n    suggestionsAreEqual(a.suggestion, b.suggestion)\n  )\n}\n\n/** Checks to see if 2 suggestions are equal to each other */\nconst suggestionsAreEqual = (batchedSuggestion: string[], newSuggestion: string[]) => {\n  if (batchedSuggestion.length !== newSuggestion.length) return false\n  return !batchedSuggestion.some((sug, idx) => sug !== newSuggestion[idx])\n}\n\n// Arbitrary number we've chosen, can be tweaked based on performance\nexport const MAX_SUGGESTED_CHANGES_BATCH_SIZE = 50\n\n/**\n * Checks whether the suggested change lines intersect with any of the pending suggested changes in the batch\n * @param suggestedChange - the suggested change to check\n * @returns boolean\n */\nfunction suggestedChangeLineRangesIntersect(\n  suggestedChange: SuggestedChange,\n  pendingSuggestedChangesBatch: SuggestedChange[],\n): boolean {\n  for (const pendingChange of pendingSuggestedChangesBatch) {\n    if (suggestedChange.path !== pendingChange.path) continue\n    return lineRangesIntersect(suggestedChange.lineRange, pendingChange.lineRange)\n  }\n  return false\n}\n\nexport const SUGGESTED_CHANGES_ERRORS = {\n  USER_CANNOT_APPLY_SUGGESTION: 'You do not have permission to apply this suggestion.',\n  PULL_REQUEST_IS_CLOSED: 'This suggestion cannot be applied because the pull request is closed.',\n  PULL_REQUEST_IS_IN_MERGE_QUEUE: 'This suggestion cannot be applied because the pull request is queued to merge.',\n  IS_OUTDATED: 'This suggestion is outdated and cannot be applied.',\n  IS_PENDING: 'This suggestion is part of a pending comment and cannot be applied.',\n  IS_RESOLVED: 'This suggestion is part of a resolved comment and cannot be applied.',\n  UNCHANGED_CODE: 'This suggestion is invalid because no changes were made to the code.',\n  INVALID_RANGE: 'Unable to commit due to other pending changes affecting this line.',\n  BATCH_TOO_BIG: 'Unable to commit due to too many changes in the batch.',\n  DELETED_LINES: 'Unable to apply suggestions on deleted lines.',\n  RANGE_NOT_PROVIDED: 'This suggestion does not have a valid line range.',\n  UNABLE_TO_DETERMINE_VALIDITY: 'Unable to determine the validity of this suggestion.',\n}\n\n/**\n * Validates a suggested change can be applied, independent of batch\n */\nexport function validateSuggestedChangeCanBeApplied({\n  suggestedChange,\n  isOutdated,\n  isPending,\n  isResolved,\n  pullRequestIsClosed,\n  pullRequestIsInMergeQueue,\n  userCanApplySuggestion,\n  applySuggestedChangesValidationData,\n  suggestedChangesConfig,\n}: {\n  suggestedChange: SuggestedChange\n  isOutdated: boolean | undefined\n  isPending: boolean\n  isResolved: boolean\n  pullRequestIsClosed: boolean\n  pullRequestIsInMergeQueue: boolean\n  userCanApplySuggestion: boolean\n  applySuggestedChangesValidationData: ApplySuggestedChangesValidationData\n  suggestedChangesConfig: SuggestedChangesConfiguration | undefined\n}): {\n  isValid: boolean\n  reason?: string\n} {\n  const {lineRange} = applySuggestedChangesValidationData\n  if (isOutdated) return {isValid: false, reason: SUGGESTED_CHANGES_ERRORS.IS_OUTDATED}\n  if (isPending) return {isValid: false, reason: SUGGESTED_CHANGES_ERRORS.IS_PENDING}\n  if (isResolved) return {isValid: false, reason: SUGGESTED_CHANGES_ERRORS.IS_RESOLVED}\n  if (pullRequestIsClosed) return {isValid: false, reason: SUGGESTED_CHANGES_ERRORS.PULL_REQUEST_IS_CLOSED}\n  if (pullRequestIsInMergeQueue)\n    return {isValid: false, reason: SUGGESTED_CHANGES_ERRORS.PULL_REQUEST_IS_IN_MERGE_QUEUE}\n  if (!userCanApplySuggestion) return {isValid: false, reason: SUGGESTED_CHANGES_ERRORS.USER_CANNOT_APPLY_SUGGESTION}\n  if (!lineRange) return {isValid: false, reason: SUGGESTED_CHANGES_ERRORS.RANGE_NOT_PROVIDED}\n  if (!suggestedChangesConfig) return {isValid: false, reason: SUGGESTED_CHANGES_ERRORS.UNABLE_TO_DETERMINE_VALIDITY}\n\n  const isValidSuggestionRange = suggestedChangesConfig?.isValidSuggestionRange\n  if (!isValidSuggestionRange) return {isValid: false, reason: SUGGESTED_CHANGES_ERRORS.DELETED_LINES}\n\n  const originalLinesContentFromSuggestedChangeConfig = suggestedChangesConfig?.sourceContentFromDiffLines\n  const suggestedChangeText = suggestedChange.suggestion.join('\\n')\n  const isEmptyLineDeletion = suggestedChange.suggestion.length === 0\n\n  if (!isEmptyLineDeletion && suggestedChangeText === originalLinesContentFromSuggestedChangeConfig)\n    return {isValid: false, reason: SUGGESTED_CHANGES_ERRORS.UNCHANGED_CODE}\n\n  return {isValid: true}\n}\n\n/**\n * Validates whether a suggested change can be added to a batch\n */\nexport function validateSuggestedChangeCanBeAddedToBatch(\n  suggestedChange: SuggestedChange,\n  pendingSuggestedChangesBatch: SuggestedChange[],\n): {isValid: boolean; reason?: string} {\n  const invalidRangeResult = {\n    isValid: false,\n    reason: SUGGESTED_CHANGES_ERRORS.INVALID_RANGE,\n  }\n  const invalidBatchSizeResult = {\n    isValid: false,\n    reason: SUGGESTED_CHANGES_ERRORS.BATCH_TOO_BIG,\n  }\n  const validSuggestedChangeResult = {isValid: true}\n\n  if (pendingSuggestedChangesBatch.length >= MAX_SUGGESTED_CHANGES_BATCH_SIZE) return invalidBatchSizeResult\n\n  if (pendingSuggestedChangesBatch.find(pendingChange => pendingChange.threadId === suggestedChange.threadId))\n    return invalidRangeResult\n  if (suggestedChangeLineRangesIntersect(suggestedChange, pendingSuggestedChangesBatch)) return invalidRangeResult\n\n  return validSuggestedChangeResult\n}\n\n/**\n * Returns the line range the suggested change applies to\n */\nexport function generateSuggestedChangeLineRangeFromDiffThread(\n  thread: Thread | undefined,\n): SuggestedChangeLineRange | undefined {\n  if (!thread || thread.subjectType !== 'LINE' || !thread.subject) return undefined\n\n  const startDiffSide = thread.subject.startDiffSide ?? thread.subject.endDiffSide\n\n  if (!startDiffSide) {\n    return undefined\n  }\n\n  if (thread.isOutdated && thread.subject.originalStartLine && thread.subject.originalEndLine) {\n    return {\n      endLineNumber: thread.subject.originalEndLine,\n      endOrientation: thread.subject.endDiffSide || 'RIGHT',\n      startLineNumber: thread.subject.originalStartLine,\n      startOrientation: startDiffSide,\n    }\n  }\n\n  if (!thread.subject.endLine || !thread.subject.endDiffSide) {\n    return undefined\n  }\n\n  const startLine = thread.subject.startLine ?? thread?.subject.endLine\n  return {\n    endLineNumber: thread.subject.endLine,\n    endOrientation: thread.subject.endDiffSide,\n    startLineNumber: startLine,\n    startOrientation: startDiffSide || 'RIGHT',\n  }\n}\n","import {noop} from '@github-ui/noop'\n\nimport {\n  type Author,\n  type Comment,\n  type CommentingImplementation,\n  type DiffAnnotation,\n  DiffAnnotationLevels,\n  type MarkerNavigationImplementation,\n  type NavigationThread,\n  type StaticDiffLine,\n  type Thread,\n  type ThreadSubject,\n  type ThreadSummary,\n  type ViewerData,\n} from '../types'\n\nexport const mockCommentingImplementation: CommentingImplementation = {\n  addSuggestedChangeToPendingBatch: noop,\n  removeSuggestedChangeFromPendingBatch: noop,\n  addThread: noop,\n  addThreadReply: noop,\n  addFileLevelThread: noop,\n  batchingEnabled: false,\n  deleteComment: noop,\n  editComment: noop,\n  fetchThread: () => Promise.resolve(undefined),\n  multilineEnabled: false,\n  pendingSuggestedChangesBatch: [],\n  resolveThread: noop,\n  unresolveThread: noop,\n  hideComment: noop,\n  unhideComment: noop,\n  resolvingEnabled: true,\n  submitSuggestedChanges: noop,\n  commentBoxConfig: {\n    pasteUrlsAsPlainText: false,\n    useMonospaceFont: false,\n  },\n  suggestedChangesEnabled: true,\n  lazyFetchReactionGroups: false,\n  lazyFetchEditHistory: false,\n}\n\nexport function mockUUID(): string {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    const r = (Math.random() * 16) | 0\n    const v = c === 'x' ? r : (r & 0x3) | 0x8\n    return v.toString(16)\n  })\n}\n\nexport function twoDaysAgoDateTime() {\n  const date = new Date()\n  date.setDate(date.getDate() - 2)\n  return date.toISOString()\n}\n\nexport function buildComment({\n  id = mockUUID(),\n  author = buildCommentAuthor({}),\n  authorAssociation = 'OWNER',\n  // eslint-disable-next-line github/unescaped-html-literal\n  bodyHTML = '<p dir=\"auto\">This is a test comment with <strong>Markdown</strong> code enabled for testing links at <a href=\"github.com\">github</a> and stuff</p>',\n  body = 'test comment',\n  createdAt = twoDaysAgoDateTime(),\n  currentDiffResourcePath = '/monalisa/smile/pull/4/files#discussion_r3',\n  databaseId = null,\n  isHidden = false,\n  lastUserContentEdit = {\n    __typename: 'UserContentEdit',\n    id: mockUUID(),\n    editor: {\n      login: 'monalisa',\n      id: mockUUID(),\n      url: '#',\n      __typename: 'Author',\n    },\n  },\n  minimizedReason = null,\n  outdated = false,\n  publishedAt = twoDaysAgoDateTime(),\n  // reference is the associated PullRequest\n  reference = {\n    number: 4,\n    author: {\n      login: 'monalisa',\n    },\n  },\n  repository = {\n    id: mockUUID(),\n    isPrivate: false,\n    name: 'smile',\n    owner: {\n      id: mockUUID(),\n      login: 'monalisa',\n      url: '/monalisa',\n    },\n  },\n  stafftoolsUrl = '/stafftools/repositories/monalisa/smile/pull_requests/4/review_comments/3',\n  state = 'SUBMITTED',\n  url = '/monalisa/smile/pull/4/files#discussion_r3',\n  viewerRelationship = 'OWNER',\n  viewerDidAuthor = true,\n  viewerCanBlockFromOrg = true,\n  viewerCanDelete = true,\n  viewerCanMinimize = true,\n  viewerCanReport = true,\n  viewerCanReportToMaintainer = true,\n  viewerCanSeeMinimizeButton = true,\n  viewerCanSeeUnminimizeButton = true,\n  viewerCanUnblockFromOrg = true,\n  viewerCanUpdate = true,\n  subjectType = 'LINE',\n}: Partial<Comment>): Required<Comment> {\n  return {\n    id,\n    author,\n    authorAssociation,\n    bodyHTML,\n    body,\n    createdAt,\n    currentDiffResourcePath,\n    databaseId,\n    isHidden,\n    lastUserContentEdit,\n    minimizedReason,\n    outdated,\n    publishedAt,\n    reference,\n    repository,\n    stafftoolsUrl,\n    state,\n    subjectType,\n    url,\n    viewerRelationship,\n    viewerDidAuthor,\n    viewerCanBlockFromOrg,\n    viewerCanDelete,\n    viewerCanMinimize,\n    viewerCanReport,\n    viewerCanReportToMaintainer,\n    viewerCanSeeMinimizeButton,\n    viewerCanSeeUnminimizeButton,\n    viewerCanUnblockFromOrg,\n    viewerCanUpdate,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    ' $fragmentSpreads': [] as any,\n  }\n}\n\nexport function buildCommentAuthor({\n  id = mockUUID(),\n  login = 'monalisa',\n  avatarUrl = 'http://alambic.github.localhost/avatars/u/2',\n  url = '/monalisa',\n}): Author {\n  return {\n    id,\n    login,\n    avatarUrl,\n    url,\n    __typename: 'Author',\n  }\n}\n\ntype BuildThreadInput = Partial<Omit<Thread, 'commentsData'>> & {\n  comments?: Comment[]\n}\n\nexport function buildReviewThread(thread: BuildThreadInput = {}): Thread {\n  return {\n    id: thread.id ?? mockUUID(),\n    commentsData: {comments: thread.comments ?? [], totalCount: thread.comments?.length ?? 0},\n    isResolved: thread.isResolved ?? true,\n    viewerCanReply: thread.viewerCanReply ?? false,\n    isOutdated: thread.isOutdated ?? false,\n    subject: thread.subject,\n    subjectType: thread.subjectType,\n  } as unknown as Thread\n}\n\n/**\n * Build a pull request diff thread, one of the possible subjects of the pull request thread\n */\nexport function buildPullRequestDiffThread(diffThread: {\n  abbreviatedOid: string\n  diffLines?: StaticDiffLine[] | null\n  endDiffSide?: string\n  endLine?: number\n  originalEndLine?: number\n  originalStartLine?: number\n  startDiffSide?: string\n  startLine?: number\n}): ThreadSubject {\n  return {\n    pullRequestCommit: {\n      commit: {\n        abbreviatedOid: diffThread.abbreviatedOid,\n      },\n    },\n    diffLines: diffThread.diffLines,\n    endDiffSide: diffThread.endDiffSide,\n    endLine: diffThread.endLine,\n    originalEndLine: diffThread.originalEndLine,\n    originalStartLine: diffThread.originalStartLine,\n    startDiffSide: diffThread.startDiffSide,\n    startLine: diffThread.startLine,\n  } as ThreadSubject\n}\n\nexport function buildStaticDiffLine(diffLine: Partial<StaticDiffLine> = {}): StaticDiffLine {\n  return {\n    __id: mockUUID(),\n    left: diffLine.left || null,\n    right: diffLine.right || null,\n    html: diffLine.html || '',\n    text: diffLine.text || '',\n    type: diffLine.type || 'ADDITION',\n  } as StaticDiffLine\n}\n\nexport const mockMarkerNavigationImplementation: MarkerNavigationImplementation = {\n  incrementActiveMarker: noop,\n  decrementActiveMarker: noop,\n  filteredMarkers: [],\n  onActivateGlobalMarkerNavigation: noop,\n  activeGlobalMarkerID: undefined,\n}\n\nexport function threadSummary(threads: Thread[]): ThreadSummary[] {\n  const lineThreads =\n    threads?.flatMap(thread => {\n      const id = thread?.id\n      const firstAuthor = thread?.commentsData?.comments?.[0]?.author\n      const commentCount = thread?.commentsData.comments?.length ?? 0\n      const commentsConnectionId = thread?.commentsData?.__id\n      return id && firstAuthor\n        ? [\n            {\n              id,\n              author: firstAuthor,\n              commentCount,\n              commentsConnectionId,\n              diffSide: thread.diffSide,\n              isOutdated: thread.isOutdated ?? false,\n              startDiffSide: thread.diffSide,\n            },\n          ]\n        : []\n    }) ?? []\n\n  return lineThreads\n}\n\nexport function flattenThreadsForNavigation(threads: Thread[]): NavigationThread[] {\n  return threads.map(thread => {\n    return {\n      id: thread.id,\n      isResolved: thread.isResolved ?? false,\n      pathDigest: 'mock-path-digest',\n      firstReviewCommentId: 1,\n      path: 'mock-path',\n      line: 1,\n    }\n  })\n}\n\nexport const mockViewerData: ViewerData = {\n  avatarUrl: 'http://alambic.github.localhost/avatars/u/2',\n  diffViewPreference: 'UNIFIED',\n  isSiteAdmin: false,\n  login: 'monalisa',\n  tabSizePreference: 4,\n  viewerCanComment: true,\n  viewerCanApplySuggestion: true,\n}\n\ntype BuildAnnotationInput = Partial<Omit<DiffAnnotation, 'checkSuite'>> & {\n  checkSuite?: {\n    name?: string\n    app?: {\n      name: string\n      logoUrl: string\n    } | null\n  }\n}\nexport function buildAnnotation(data: BuildAnnotationInput): DiffAnnotation {\n  const id = mockUUID()\n  return {\n    id,\n    __id: id,\n    annotationLevel: data.annotationLevel ?? DiffAnnotationLevels.Warning,\n    databaseId: data.databaseId ?? Math.floor(Math.random() * 1000),\n    location: {\n      start: {\n        line: data.location?.start?.line ?? 1,\n      },\n      end: {\n        line: data.location?.end?.line ?? 1,\n      },\n    },\n    message: data.message ?? 'message',\n    rawDetails: data.rawDetails ?? 'raw details',\n    path: data.path ?? 'my-file-path',\n    pathDigest: data.pathDigest ?? mockUUID(),\n    title: data.title ?? 'annotation-title',\n    checkRun: {\n      name: data.checkRun?.name ?? 'check-run-name',\n      detailsUrl: data.checkRun?.detailsUrl\n        ? data.checkRun.detailsUrl\n        : data.checkRun?.detailsUrl == null\n          ? null\n          : 'http://github.localhost/monalisa/smile/actions/runs/1/job/1',\n    },\n    checkSuite: {\n      name: data.checkSuite?.name ?? 'check-suite-name',\n      app: data.checkSuite?.app\n        ? data.checkSuite.app\n        : data.checkSuite?.app == null\n          ? null\n          : {\n              name: 'github-app',\n              logoUrl: 'http://alambic.github.localhost/avatars/u/2',\n            },\n    },\n  }\n}\n","import type {CommentBoxConfig} from '@github-ui/comment-box/CommentBox'\nimport type {CommentSubjectTypes} from '@github-ui/commenting/CommentHeader'\nimport type {CommentAuthorAssociation as GraphQlCommentAuthorAssociation} from '@github-ui/commenting/IssueCommentHeader.graphql'\nimport type {DiffLine, LineRange} from '@github-ui/diff-lines'\nimport type {DiffLineType} from '@github-ui/diffs/types'\nimport type {FragmentRefs} from 'relay-runtime'\n\nexport type DiffAnnotationLocation = {\n  start: {\n    line: number\n  }\n  end: {\n    line: number\n  }\n}\n\nexport enum DiffAnnotationLevels {\n  Failure = 'FAILURE',\n  Notice = 'NOTICE',\n  Warning = 'WARNING',\n}\n\nexport type DiffAnnotation = {\n  id: string\n  __id: string\n  annotationLevel: DiffAnnotationLevels\n  databaseId: number | null | undefined\n  location: DiffAnnotationLocation\n  message: string\n  rawDetails: string | null | undefined\n  path: string\n  pathDigest: string\n  title: string | null | undefined\n  checkRun: {\n    name: string\n    detailsUrl: string | null | undefined\n  }\n  checkSuite: {\n    app:\n      | {\n          name: string\n          logoUrl: string\n        }\n      | null\n      | undefined\n    name: string | null | undefined\n  }\n}\n\nexport type DiffSide = 'LEFT' | 'RIGHT'\n\nexport type SuggestedChangeLineRange = {\n  endLineNumber: number\n  endOrientation: DiffSide\n  startLineNumber: number\n  startOrientation: DiffSide\n}\n\nexport type SuggestedChange = {\n  authorLogin: string\n  commentId: string\n  path: string\n  suggestion: string[]\n  threadId: string\n  lineRange: SuggestedChangeLineRange\n}\n\nexport type ApplySuggestedChangesValidationData = {\n  lineRange?: SuggestedChangeLineRange\n}\n\nexport type CommentingImplementation = {\n  batchingEnabled: boolean\n  multilineEnabled: boolean\n  resolvingEnabled: boolean\n  pendingSuggestedChangesBatch: SuggestedChange[]\n  suggestedChangesEnabled: boolean\n  lazyFetchReactionGroups: boolean\n  lazyFetchEditHistory: boolean\n\n  // submit single suggested change callback\n  submitSuggestedChanges: (args: {\n    commitMessage: string\n    suggestedChanges: SuggestedChange[]\n    onError: (error: Error, type?: string, friendlyMessage?: string) => void\n    onCompleted?: () => void\n  }) => void\n  // add suggested change to pending batch callback\n  addSuggestedChangeToPendingBatch: (suggestedChange: SuggestedChange) => void\n  // remove suggested change from pending batch callback\n  removeSuggestedChangeFromPendingBatch: (suggestedChange: SuggestedChange) => void\n  // thread mutation callbacks\n  addThread: (args: {\n    diffLine?: DiffLine\n    filePath: string\n    isLeftSide?: boolean\n    onCompleted?: (threadId: string, commentDatabaseId?: number) => void\n    onError: (error: Error) => void\n    selectedDiffRowRange?: LineRange\n    submitBatch?: boolean\n    text: string\n    /**\n     * Relay-specific field that allows us to update relay store\n     */\n    threadsConnectionId?: string\n  }) => void\n  addThreadReply: (args: {\n    /**\n     * Relay-specific field that allows us to update relay store\n     */\n    commentsConnectionIds?: string[]\n    filePath: string\n    onCompleted?: (commentDatabaseId?: number) => void\n    onError: (error: Error) => void\n    submitBatch?: boolean\n    text: string\n    thread: Thread\n    /**\n     * Relay-specific field that allows us to update relay store\n     */\n    threadsConnectionId?: string\n  }) => void\n  addFileLevelThread: (args: {\n    filePath: string\n    onCompleted?: (threadId: string, commentDatabaseId?: number) => void\n    onError: (error: Error) => void\n    submitBatch?: boolean\n    text: string\n    /**\n     * Relay-specific field that allows us to update relay store\n     */\n    threadsConnectionId?: string\n  }) => void\n  deleteComment: (args: {\n    commentConnectionId?: string\n    commentId: string\n    filePath: string\n    onCompleted?: () => void\n    onError: (error: Error) => void\n    threadCommentCount?: number\n    threadsConnectionId?: string\n    threadId: string\n  }) => void\n  editComment: (args: {\n    comment: Comment\n    onCompleted?: () => void\n    onError: (error: Error) => void\n    text: string\n  }) => void\n  hideComment: (args: {\n    commentId: string\n    reason: string\n    onCompleted?: () => void\n    onError: (error: Error) => void\n  }) => void\n  unhideComment: (args: {commentId: string; onCompleted?: () => void; onError: (error: Error) => void}) => void\n  resolveThread: (args: {onCompleted?: () => void; onError: (error: Error) => void; thread: Thread}) => void\n  unresolveThread: (args: {onCompleted?: () => void; onError: (error: Error) => void; thread: Thread}) => void\n\n  // data fetching\n  fetchThread: (threadId: string, includeAssociatedDiffLines?: boolean) => Promise<Thread | undefined>\n\n  // comment box presentation\n  commentBoxConfig: CommentBoxConfig\n\n  /**\n   * The type of the subject that comments are associated to.\n   * Used to determine the correct reference tooltip text to display.\n   */\n  commentSubjectType?: CommentSubjectTypes\n}\n\nexport type Thread = {\n  commentsData: Comments\n  diffSide?: DiffSide\n  id: string\n  isOutdated?: boolean\n  isResolved?: boolean\n  subject?: ThreadSubject\n  viewerCanReply?: boolean\n  subjectType?: 'LINE' | 'FILE'\n}\n\nexport type ThreadSubject = {\n  diffLines?: StaticDiffLine[]\n  endLine?: number | null\n  endDiffSide?: DiffSide\n  originalEndLine?: number | null\n  originalStartLine?: number | null\n  pullRequestCommit?: {\n    commit: {\n      abbreviatedOid: string\n    }\n  }\n  startDiffSide?: DiffSide | null\n  startLine?: number | null\n}\n\nexport type StaticDiffLine = {\n  __id: string\n  left: number | null\n  right: number | null\n  type: DiffLineType\n  html: string\n  text: string\n}\n\nexport type Comments = {\n  comments: Comment[]\n  __id?: string\n}\n\nexport type Comment = {\n  author: Author | null | undefined\n  authorAssociation: GraphQlCommentAuthorAssociation\n  body: string\n  bodyHTML: string\n  createdAt: string\n  publishedAt: string | null | undefined\n  currentDiffResourcePath?: string | null\n  id: string\n  databaseId?: number | null | undefined\n  isHidden: boolean\n  lastUserContentEdit: UserContentEdit | null | undefined\n  minimizedReason: string | null | undefined\n  outdated?: boolean\n  // reference is the associated PullRequest\n  reference: {\n    number: number | undefined\n    text?: string | null | undefined\n    author:\n      | {\n          login: string\n        }\n      | null\n      | undefined\n  }\n  repository: {\n    id: string\n    isPrivate: boolean\n    name: string\n    owner: {\n      id: string\n      login: string\n      url: string\n    }\n  }\n  state: string\n  viewerCanBlockFromOrg: boolean\n  viewerCanMinimize: boolean\n  viewerCanSeeMinimizeButton: boolean\n  viewerCanSeeUnminimizeButton: boolean\n  viewerCanReport: boolean\n  viewerCanReportToMaintainer: boolean\n  viewerCanUnblockFromOrg: boolean\n  viewerDidAuthor: boolean\n  viewerRelationship: string\n  subjectType?: string | undefined\n  stafftoolsUrl?: string | null\n  url: string\n  viewerCanDelete: boolean\n  viewerCanUpdate: boolean\n  ' $fragmentSpreads': FragmentRefs<'MarkdownEditHistoryViewer_comment' | 'ReactionViewerGroups'>\n}\n\nexport type Author = {\n  avatarUrl: string\n  id: string\n  login: string\n  url: string\n  __typename?: 'Author'\n}\n\nexport type CommentAuthor = {\n  avatarUrl: string\n  login: string\n  url: string\n}\n\nexport type UserContentEdit = {\n  editor: Partial<Author> | null | undefined\n  id?: string\n  __typename?: 'UserContentEdit'\n}\n\nexport type ThreadSummary = {\n  id: string\n  author: {\n    avatarUrl: string\n    login: string\n  }\n  commentCount: number\n  commentsConnectionId?: string\n  diffSide?: DiffSide | null\n  isOutdated: boolean\n  line?: number | null\n  startLine?: number | null\n  startDiffSide?: DiffSide | null\n}\n\nexport type NavigationThread = {\n  id: string\n  pathDigest: string\n  isResolved: boolean\n  firstReviewCommentId: number | undefined | null\n  line: number | null | undefined\n  path: string\n}\n\nexport interface MarkerNavigationImplementation {\n  /**\n   * Navigate to the next marker\n   */\n  incrementActiveMarker: (currentMarkerId: string) => void\n  /**\n   * Navigate to the previous marker\n   */\n  decrementActiveMarker: (currentMarkerId: string) => void\n  /**\n   * The threads and annotations available for navigation\n   */\n  filteredMarkers: Array<NavigationThread | DiffAnnotation>\n  /**\n   * Function to call after global marker navigation has been activated\n   */\n  onActivateGlobalMarkerNavigation: () => void\n  /**\n   * Active global marker id\n   */\n  activeGlobalMarkerID: string | undefined\n}\n\nexport type SuggestedChangesConfiguration = {\n  showSuggestChangesButton: boolean\n  isValidSuggestionRange: boolean\n  sourceContentFromDiffLines: string | undefined\n  onInsertSuggestedChange: () => void\n  shouldInsertSuggestedChange?: boolean\n}\n\nexport type ConfigureSuggestedChangesImplementation = {\n  selectedDiffRowRange: LineRange | undefined\n  configureSuggestedChangesFromLineRange: (\n    rowRange?: LineRange,\n    shouldInsertSuggestedChange?: boolean,\n  ) => SuggestedChangesConfiguration | undefined\n  shouldStartNewConversationWithSuggestedChange: boolean | undefined\n}\n\n// The subject of the comment\n// e.g. PullRequest or a Commit\nexport type Subject = {\n  isInMergeQueue?: boolean\n  state?: string\n}\n\nexport interface ViewerData {\n  avatarUrl: string\n  diffViewPreference: string\n  isSiteAdmin: boolean\n  login: string\n  tabSizePreference: number\n  viewerCanComment: boolean\n  viewerCanApplySuggestion: boolean\n}\n","export function ensurePreviousActiveDialogIsClosed() {\n  const activeDialogElement = document.querySelector('#__primerPortalRoot__ div[role=\"dialog\"]')\n  if (activeDialogElement) {\n    // This pattern of dispatching an event, on the document.body, to close open dialogs is used in place of a React based state management system.\n    // Implementing a state managed system would cause every diffline in the app to re-render.\n    // This workaround will use the \"Esc\" keypress eventListener, that is tied to the active dialog's React Portal, to close the active dialog.\n    // This code simply simulates a user typing \"Esc\" to ensure active dialogs are closed.\n    document.dispatchEvent(new KeyboardEvent('keydown', {key: 'Escape', code: 'Escape', ctrlKey: true}))\n  }\n}\n","import type {ValidationResult} from '@github-ui/entity-validators'\n\n/**\n * Validates any inline suggested changes contained in markdown input. A invalid result\n * is returned if any of the suggested changes contained in the markdown are invalid. A\n * suggested change is invalid if is identical to the supplied diff line content.\n */\nexport function validateSuggestedChange(markdown: string, diffLineContent: string): ValidationResult {\n  const duplicateSuggestionErrorMessage = 'Suggested change cannot be the same as the original line'\n\n  const suggestedChanges = suggestedChangesFromText(markdown)\n\n  for (const suggestedChangeText of suggestedChanges) {\n    if (suggestedChangeText === diffLineContent) {\n      return {\n        isValid: false,\n        errorMessage: duplicateSuggestionErrorMessage,\n      }\n    }\n  }\n\n  return {\n    isValid: true,\n    errorMessage: '',\n  }\n}\n\n/**\n * Extracts a list of suggested changes from a comment string. Handles most of the edgecases for fence blocks according to the CommonMark spec (https://spec.commonmark.org/0.28/#fenced-code-blocks)\n *\n * Handles:\n * - opening fence line may start with up to 3 spaces (Tabs not supported)\n * - if opening line is indented, an equal amount of leading indention will be trimmed from the content lines\n * - The fence is 3 or more backticks or ~'s\n * - The closing fence must be of equal or greater length than the opening fence\n * - Fences must be on their own lines but may have trailing whitespace\n * Does not handle:\n * - If a fence block is not manually closed, it will auto-close at the end of the current content block (e.g. end of a list item). Behavior: non-closed fence blocks are ignored.\n * - If a fence is indented and content contains a leading tab, then the tab is treated a 4 spaces\n * and de-indented accorindingly. Behavior: Tabs are not de-indented.\n */\nfunction suggestedChangesFromText(text: string, memo: string[] = []): string[] {\n  if (text === '') {\n    return memo\n  }\n\n  // Find the next opening fence to get things started\n  const fenceMatch = text.match(suggestionFenceRegExp())\n  if (!fenceMatch) {\n    return memo\n  }\n\n  const fence = fenceMatch.groups!['fence']\n  if (!fence) {\n    return memo\n  }\n\n  const fenceChar = fence.includes('~') ? '~' : '`'\n  // Build a strict regex based on what the opening fence looks like. The opening\n  // fence dictates the format of the closing fence.\n  const suggestionMatch = text.match(suggestionRegexp(fenceChar, fence.length))\n  if (!suggestionMatch) {\n    return memo\n  }\n\n  let indentSize = 0\n  const indent = fenceMatch.groups!['indent']!\n  if (indent !== '') {\n    indentSize = indent.length\n  }\n\n  let suggestion = suggestionMatch.groups!['suggestion']!\n  // Strip off leading indentation based on the fence opening\n  if (indentSize > 0) {\n    const search = new RegExp(`^ {0,${indentSize}}`, 'm')\n    suggestion = suggestion.replace(search, '')\n  }\n\n  memo.push(suggestion)\n\n  // Recurse with the rest of the string\n  const subtext = text.slice(suggestionMatch.index! + suggestionMatch[0].length)\n  return suggestedChangesFromText(subtext, memo)\n}\n\nfunction suggestionFenceRegExp(fenceChars: string[] = ['`', '~'], fixed?: number): RegExp {\n  const fenceLength = fixed ? `{${fixed}}` : '{3,}'\n  const fenceConstraints = fenceChars.map(char => {\n    return `${char}${fenceLength}`\n  })\n\n  return new RegExp(`^(?<indent> {0,3})(?<fence>${fenceConstraints.join('|')})suggestion[ \\t]*$`, 'm')\n}\n\nfunction suggestionRegexp(fenceChar: string, fixed: number): RegExp {\n  const openFence = suggestionFenceRegExp([fenceChar], fixed)\n  return new RegExp(\n    `${openFence.source}(?:\\r?\\n)(?<suggestion>.*?)(?:\\r?\\n)^ {0,3}${fenceChar}{${fixed},}[ \\t]*$`,\n    'ms',\n  )\n}\n","import type {CopilotChatEventPayload, CopilotChatReference} from './copilot-chat-types'\n\nexport class OpenCopilotChatEvent extends Event {\n  declare payload: CopilotChatEventPayload\n  constructor(payload: CopilotChatEventPayload) {\n    super('open-copilot-chat', {\n      bubbles: false,\n      cancelable: true,\n    })\n\n    this.payload = payload\n  }\n}\n\nexport class SearchCopilotEvent extends Event {\n  declare content: string\n  declare repoNwo: string\n  constructor(content: string, repoNwo: string) {\n    super('search-copilot-chat', {\n      bubbles: false,\n      cancelable: true,\n    })\n\n    this.content = content\n    this.repoNwo = repoNwo\n  }\n}\n\nexport class AddCopilotChatReferenceEvent extends Event {\n  declare reference: CopilotChatReference\n  declare openPanel?: boolean\n  declare id?: string\n  constructor(reference: CopilotChatReference, openPanel: boolean = false, id?: string) {\n    super('add-copilot-chat-reference', {\n      bubbles: false,\n      cancelable: true,\n    })\n    this.reference = reference\n    this.openPanel = openPanel\n    this.id = id\n  }\n}\n\nexport class SymbolChangedEvent extends Event {\n  declare context: CopilotChatReference\n  constructor(context: CopilotChatReference) {\n    super('symbol-changed', {\n      bubbles: false,\n      cancelable: true,\n    })\n\n    this.context = context\n  }\n}\n\ndeclare global {\n  interface WindowEventMap {\n    'open-copilot-chat': OpenCopilotChatEvent\n    'add-copilot-chat-reference': AddCopilotChatReferenceEvent\n    'search-copilot-chat': SearchCopilotEvent\n    'symbol-changed': SymbolChangedEvent\n  }\n}\n\nexport function publishOpenCopilotChat(payload: CopilotChatEventPayload): void {\n  window.dispatchEvent(new OpenCopilotChatEvent(payload))\n}\n\nexport function publishAddCopilotChatReference(\n  payload: CopilotChatReference,\n  openPanel: boolean = false,\n  id?: string,\n): void {\n  window.dispatchEvent(new AddCopilotChatReferenceEvent(payload, openPanel, id))\n}\n\nexport function subscribeOpenCopilotChat(listener: (e: OpenCopilotChatEvent) => void): () => void {\n  window.addEventListener('open-copilot-chat', listener)\n\n  return () => {\n    window.removeEventListener('open-copilot-chat', listener)\n  }\n}\n\nexport function subscribeAddCopilotChatReference(listener: (e: AddCopilotChatReferenceEvent) => void): () => void {\n  window.addEventListener('add-copilot-chat-reference', listener)\n  return () => {\n    window.removeEventListener('add-copilot-chat-reference', listener)\n  }\n}\n\nexport function subscribeSearchCopilot(listener: (e: SearchCopilotEvent) => void): () => void {\n  window.addEventListener('search-copilot-chat', listener)\n  return () => {\n    window.removeEventListener('search-copilot-chat', listener)\n  }\n}\n\nexport function subscribeSymbolChanged(listener: (e: SymbolChangedEvent) => void): () => void {\n  window.addEventListener('symbol-changed', listener)\n\n  return () => {\n    window.removeEventListener('symbol-changed', listener)\n  }\n}\n","import type {SafeHTMLString} from '@github-ui/safe-html'\n\nexport type TopicItem = {\n  key: string\n  actionItem: JSX.Element\n}\n\nexport type CopilotChatRepo = {\n  id: number\n  name: string\n  ownerLogin: string\n  ownerType: 'User' | 'Organization'\n  readmePath?: string\n  description?: string\n  commitOID: string\n  ref: string\n  refInfo: {\n    name: string\n    type: 'branch' | 'tag'\n  }\n  visibility: string\n  languages?: Array<{name: string; percent: number}>\n}\n\nexport type CopilotChatPlan = Record<string, never>\n\nexport type CopilotChatOrg = {\n  id: string\n  login: string\n  avatarUrl: string\n}\n\nexport type CopilotChatThread = {\n  id: string\n  name: string\n  repoID?: number\n  currentReferences: CopilotChatReference[] | undefined\n  createdAt: string\n  updatedAt: string\n}\n\nexport type CopilotChatSuggestions = {\n  referenceType?: string\n  suggestions: GeneratedSuggestion[]\n}\n\nexport type GeneratedSuggestion = {\n  question: string\n  skill: string\n}\n\nexport type SkillExecution = {\n  slug: string\n  status: FunctionCalledStatus\n  arguments?: string\n  errorMessage?: string\n  references?: CopilotChatReference[]\n}\n\nexport type CopilotChatAgent = {\n  name: string\n  slug: string\n  avatarUrl: string\n  integrationUrl: string\n}\n\nexport type CopilotChatMessage = {\n  id: string\n  intent?: string\n  role: 'user' | 'assistant'\n  content?: string\n  createdAt: string\n  threadID: string\n  error?: ChatError\n  references: CopilotChatReference[] | null\n  skillExecutions?: SkillExecution[]\n  copilotAnnotations?: CopilotAnnotations\n  interrupted?: boolean\n  confirmations?: CopilotAgentConfirmation[] | null // confirmation from copilot/agent\n  clientConfirmations?: CopilotClientConfirmation[] | null // users response to agent confirmation\n  agentErrors?: CopilotAgentError[]\n}\n\nexport type CopilotAgentConfirmation = {\n  title: string\n  message: string\n  confirmation: object\n}\n\nexport type CopilotAgentError = {\n  type: string\n  code: string\n  message: string\n  identifier: string\n}\n\nexport type CopilotClientConfirmation = {\n  state: CopilotClientConfirmationState\n  confirmation: object\n}\n\nexport type CopilotClientConfirmationState = 'accepted' | 'dismissed'\n\nexport type CopilotAnnotations = {\n  CodeVulnerability?: CodeVulnerability[]\n}\n\ntype CodeVulnerability = {\n  startOffset: number\n  endOffset: number\n  details: CodeVulnerabilityDetails\n}\n\ntype CodeVulnerabilityDetails = {\n  type: string\n  uiType: string\n  description: string\n  uiDescription: string\n}\n\nexport type RepositoryReference = CopilotChatRepo & {\n  type: 'repository'\n}\n\nexport interface ReferenceHeaderInfo {\n  blobSize: string\n  displayName: string\n  isLfs: boolean\n  lineInfo: {truncatedLoc: number; truncatedSloc: number}\n  rawBlobUrl: string\n  viewable: boolean\n}\n\ntype APIResponseResource =\n  | {resourceType: 'Repository'; data: Omit<RepositoryAPIReference, 'type'>}\n  | {resourceType: 'Issue'; data: Omit<IssueAPIReference, 'type'>}\n  | {resourceType: 'Release'; data: Omit<ReleaseAPIReference, 'type'>}\n  | {resourceType: 'PullRequest'; data: Omit<PullRequestAPIReference, 'type'>}\n  | {resourceType: 'Commit'; data: Omit<CommitAPIReference, 'type'>}\n  | {resourceType: 'Topic'; data: Omit<TopicAPIReference, 'type'>}\n\nexport type APIResponseReference = APIResponseResource & {\n  type: 'api-response'\n  id: number\n  repo?: string\n}\n\nexport type FileReference = {\n  type: 'file' | 'file-v2'\n  url: string\n  path: string\n  repoID: number\n  repoOwner: string\n  repoName: string\n  ref: string\n  commitOID: string\n  languageName?: string\n  languageId?: number\n}\n\nexport type FileChangesReference = {\n  type: 'file-changes'\n  ref: string\n  path: string\n  url: string\n  commits: Array<{\n    oid: string\n    shortSha: string\n    message: string\n    createdAt: string\n    author: {\n      name: string\n      email: string\n      login: string\n    }\n    blameLines: Array<{\n      lineNo: number\n      text: string\n    }>\n  }>\n  repository: {\n    id: number\n    name: string\n    owner: string\n  }\n}\n\nexport interface FileReferenceDetails extends FileReference {\n  contents: string\n  highlightedContents: SafeHTMLString[]\n  repoIsOrgOwned: boolean\n  range: LineRange\n  expandedRange: LineRange\n  headerInfo: ReferenceHeaderInfo\n}\n\nexport interface FileDiffReference {\n  type: 'file-diff'\n  id: string\n  url: string\n  base: SnippetReference | null // will be null if a file was 'added'\n  head: SnippetReference | null // will be null if a file was 'removed'\n  baseFile: FileReference | null // will be null if a file was 'added'\n  headFile: FileReference | null // will be null if a file was 'removed'\n  // user-selected, shown in location.hash, ex L1-R5\n  // won't be populated in the server props but should be present when calling CAPI\n  selectedRange?: {\n    start?: string\n    end?: string\n  }\n}\n\nexport interface FileDiffReferenceDetails extends FileDiffReference {\n  contents: string\n  highlightedContents: SafeHTMLString[]\n  repoIsOrgOwned: boolean\n  expandedRange: LineRange\n}\n\nexport interface SnippetReference {\n  type: 'snippet'\n  url: string\n  path: string\n  repoID: number\n  repoOwner: string\n  repoName: string\n  ref: string\n  commitOID: string\n  range: LineRange\n  languageID?: number\n  languageName?: string\n  title?: string\n}\n\nexport interface SnippetReferenceDetails extends SnippetReference {\n  contents: string\n  highlightedContents: SafeHTMLString[]\n  repoIsOrgOwned: boolean\n  expandedRange: LineRange\n  headerInfo: ReferenceHeaderInfo\n}\n\nexport interface CommitReference {\n  type: 'commit'\n  oid: string\n  message: string\n  permalink: string\n  author: {\n    name: string\n    email: string\n    login: string\n  }\n  repository: {\n    id: number\n    name: string\n    owner: string\n  }\n}\n\nexport interface PullRequestReference {\n  type: 'pull-request'\n  title: string\n  url: string\n  commit?: string\n  authorLogin: string\n  repository: CopilotChatRepo\n}\n\nexport const TREE_COMPARISON_REFERENCE_TYPE = 'tree-comparison'\nexport interface TreeComparisonReference {\n  type: typeof TREE_COMPARISON_REFERENCE_TYPE\n  baseRepoId: number\n  headRepoId: number\n  baseRevision: string\n  headRevision: string\n  diffHunks: DiffHunk[]\n}\n\nexport interface DiffHunk {\n  type: 'diff-hunk'\n  changeReference: string\n  diff: string\n  fileName: string\n  headerContext: string\n}\n\nexport interface IssueReference {\n  type: 'issue'\n  id: number\n  number: number\n  repository: {\n    id: number\n    name: string\n    owner: string\n  }\n  title?: string\n  body?: string\n  state?: string\n  authorLogin?: string\n  url?: string\n  assignees?: string[]\n  pullRequestUrl?: string\n}\n\nexport interface DiscussionReference {\n  type: 'discussion'\n  number: number\n  title: string\n  body: string\n  user: {\n    login: string\n  }\n  state: string\n  id: number\n  url: string\n  authorLogin: string\n  repository: {\n    id: number\n    name: string\n    owner: string\n  }\n}\n\nexport interface ReleaseReference {\n  type: 'release'\n  name?: string\n  tagName?: string\n  url?: string\n  repository: {\n    id: number\n    name: string\n    owner: string\n  }\n  body?: string\n  isDraft: boolean\n  isPrerelease: boolean\n  authorLogin?: string\n  targetCommitish?: string\n}\n\nexport interface ReleaseAPIReference {\n  type: 'release.api'\n  name?: string\n  tag_name: string\n  html_url?: string\n}\n\nexport interface PullRequestAPIReference {\n  type: 'pull-request.api'\n  title?: string\n  html_url?: string\n  number: number\n  repo?: string\n}\n\nexport interface AlertReference {\n  type: 'alert.api'\n  number: number\n  repo?: string\n}\n\nexport interface IssueAPIReference {\n  type: 'issue.api'\n  title?: string\n  html_url: string\n  number: number\n  repo?: string\n  state: string\n}\n\nexport interface RepositoryAPIReference {\n  type: 'repository.api'\n  name: string\n  description?: string\n  html_url?: string\n}\n\nexport interface CommitAPIReference {\n  type: 'commit.api'\n  sha: string\n  commit: {\n    message?: string\n  }\n  html_url?: string\n}\n\nexport interface DiffAPIReference {\n  type: 'diff.api'\n}\n\nexport interface FileAPIReference {\n  type: 'file.api'\n}\n\nexport interface TopicAPIReference {\n  type: 'topic.api'\n  name: string\n  display_name?: string\n  short_description?: string\n}\n\nexport interface TextReference {\n  type: 'text'\n  text?: string\n}\n\nexport interface UnsupportedAPIReference {\n  type: 'unsupported'\n  text?: string\n}\n\nexport interface LineRange {\n  start: number\n  end: number\n}\n\nexport interface CodeNavSymbolReference {\n  type: 'symbol'\n  kind: 'codeNavSymbol'\n  name: string\n  languageID?: number\n  codeNavDefinitions?: CodeNavSymbol[]\n  codeNavReferences?: CodeReference[]\n  languageName?: string\n}\n\nexport interface CodeNavSymbolReferenceDetails extends CodeNavSymbolReference {\n  codeNavDefinitions?: CodeNavSymbolDetails[]\n  codeNavReferences?: CodeReferenceDetails[]\n}\n\nexport interface SuggestionSymbolReference {\n  type: 'symbol'\n  kind: 'suggestionSymbol'\n  name: string\n  languageID?: number\n  suggestionDefinitions?: SuggestionSymbol[]\n}\n\nexport interface SuggestionSymbolReferenceDetails extends SuggestionSymbolReference {\n  suggestionDefinitions?: SuggestionSymbolDetails[]\n}\n\nexport type DocsetReference = {\n  type: 'docset'\n  name: string\n  id: string\n  scopingQuery: string // TODO: is this the correct name for CAPI?\n  avatarUrl: string\n  // Docset references coming from previous threads in CAPI currently don't have their\n  // repos serialized.\n  repos?: string[]\n  description: string\n}\n\nexport type GitHubAgentReference = {\n  type: 'github.agent'\n  login: string\n  avatarURL: string\n}\n\nexport type WebSearchReference = {\n  type: 'web-search'\n  query: string\n  results: Array<{title: string; excerpt: string; url: string}>\n  status: string\n}\n\nexport type SupportDocumentReference = {\n  type: 'support-document'\n  query: string\n  results: Array<{title: string; content: string; url: string}>\n  status: string\n}\n\nexport type JobReference = {\n  type: 'job'\n  id: string\n  repoId: number\n  repoName: string\n  repoOwner: string\n}\n\nexport type PlanReference = {\n  type: 'plan'\n}\n\ntype CodeNavSymbol = {\n  ident: Range\n  extent: Range\n} & CodeSymbol\n\ntype SuggestionSymbol = {\n  identOffset?: ByteOffset\n  extentOffset?: ByteOffset\n} & CodeSymbol\n\ntype CodeSymbol = {\n  kind: string\n  fullyQualifiedName: string\n  repoID: number\n  repoOwner: string\n  repoName: string\n  ref: string\n  commitOID: string\n  path: string\n}\n\ntype CodeReference = {\n  ident: Range\n  repoID: number\n  repoOwner: string\n  repoName: string\n  ref: string\n  commitOID: string\n  path: string\n}\n\ntype SymbolDetails = {\n  repoIsOrgOwned: boolean\n  highlightedContents?: SafeHTMLString[]\n  range?: LineRange\n}\n\nexport type CodeNavSymbolDetails = CodeNavSymbol & SymbolDetails\nexport type SuggestionSymbolDetails = SuggestionSymbol & SymbolDetails\nexport type CodeReferenceDetails = CodeReference & SymbolDetails\n\ntype Range = {\n  start: Position\n  end: Position\n}\n\ntype Position = {\n  line: number\n  column: number\n}\n\ntype ByteOffset = {\n  start: number\n  end: number\n}\n\nexport type CopilotChatReference =\n  | FileReference\n  | FileChangesReference\n  | SnippetReference\n  | FileDiffReference\n  | RepositoryReference\n  | CodeNavSymbolReference\n  | SuggestionSymbolReference\n  | DocsetReference\n  | CommitReference\n  | PullRequestReference\n  | GitHubAgentReference\n  | WebSearchReference\n  | TreeComparisonReference\n  | IssueReference\n  | TextReference\n  | ReleaseReference\n  | DiscussionReference\n  | JobReference\n  | PlanReference\n  | ReleaseAPIReference\n  | PullRequestAPIReference\n  | AlertReference\n  | IssueAPIReference\n  | RepositoryAPIReference\n  | CommitAPIReference\n  | DiffAPIReference\n  | FileAPIReference\n  | TopicAPIReference\n  | APIResponseReference\n  | UnsupportedAPIReference\n\nexport type NumberedCopilotChatReference = CopilotChatReference & {n: number}\n\nexport type CopilotChatReferenceDetails = SnippetReferenceDetails\n\nexport type ReferenceDetails<TReference extends CopilotChatReference> = TReference extends SnippetReference\n  ? SnippetReferenceDetails\n  : TReference extends FileReference\n    ? FileReferenceDetails\n    : TReference extends CodeNavSymbolReference\n      ? CodeNavSymbolReferenceDetails\n      : TReference extends SuggestionSymbolReference\n        ? SuggestionSymbolReferenceDetails\n        : TReference extends FileDiffReference\n          ? FileDiffReferenceDetails\n          : unknown\n\ntype CopilotChatExplainEventPayload = {\n  intent: typeof CopilotChatIntents.explain\n  content: string\n  references: CopilotChatReference[]\n  id?: string\n}\n\ntype CopilotChatAskEventPayload = {\n  intent: typeof CopilotChatIntents.conversation\n  references?: CopilotChatReference[]\n  id?: string\n}\n\ntype CopilotChatAskPrEventPayload = {\n  intent: typeof CopilotChatIntents.conversation\n  references: CopilotChatReference[]\n  id?: string\n}\n\ntype CopilotChatExplainPrEventPayload = {\n  intent: typeof CopilotChatIntents.explainFileDiff\n  content: string\n  references: CopilotChatReference[]\n  id?: string\n}\n\ntype CopilotChatSuggestEventPayload = {\n  intent: typeof CopilotChatIntents.suggest\n  content: string\n  references: CopilotChatReference[]\n  id?: string\n}\n\ntype CopilotChatReviewPrEventPayload = {\n  intent: typeof CopilotChatIntents.reviewPr\n  content: string\n  references: CopilotChatReference[]\n  completion: string\n  thread: CopilotChatThread\n  id?: string\n}\n\ntype CopilotChatStartConversationPayload = {\n  intent: typeof CopilotChatIntents.conversation\n  content: string\n  references: CopilotChatReference[]\n  id?: string\n}\n\nexport type CopilotChatEventPayload =\n  | CopilotChatExplainEventPayload\n  | CopilotChatAskEventPayload\n  | CopilotChatSuggestEventPayload\n  | CopilotChatAskPrEventPayload\n  | CopilotChatExplainPrEventPayload\n  | CopilotChatReviewPrEventPayload\n  | CopilotChatStartConversationPayload\n\nexport const CopilotChatIntents = {\n  explain: 'explain',\n  conversation: 'conversation',\n  suggest: 'suggest',\n  askDocs: 'ask-docs',\n  discussFileDiff: 'discuss-file-diff',\n  explainFileDiff: 'explain-file-diff',\n  reviewPr: 'review-pull-request',\n} as const\nexport type CopilotChatIntentsType = (typeof CopilotChatIntents)[keyof typeof CopilotChatIntents]\n\ninterface ChatErrorBase {\n  type: MessageStreamingErrorType | 'basic'\n  isError: boolean\n  message?: string\n  details?: unknown\n}\n\ninterface BasicChatError extends ChatErrorBase {\n  type: 'basic'\n  isError: true\n}\n\ninterface AgentError<TType extends MessageStreamingErrorType, TDetails> extends ChatErrorBase {\n  type: TType\n  isError: true\n  details: TDetails\n}\n\nexport type AgentUnauthorizedChatError = AgentError<'agentUnauthorized', NotAuthorizedForAgentErrorPayload>\nexport type AgentRequestChatError = AgentError<'agentRequest', AppAgentRequestErrorPayload>\nexport type AgentChatError = AgentUnauthorizedChatError | AgentRequestChatError\n\nexport type ChatError = BasicChatError | AgentChatError\n\nexport type BlackbirdSymbol = {\n  fully_qualified_name: string\n  kind: string\n  ident_start: number\n  ident_end: number\n  extent_start: number\n  extent_end: number\n}\n\nexport interface BlackbirdSuggestion {\n  kind: string\n  query: string\n  repository_nwo: string\n  language_id: number\n  path: string\n  repository_id: number\n  commit_sha: string\n  line_number: number\n  symbol: BlackbirdSymbol | null\n}\n\nexport type SuggestionsResponse = {\n  suggestions: BlackbirdSuggestion[]\n  queryErrors: string[]\n  failed: boolean\n}\n\nexport type KnowledgeBasesResponse = {\n  knowledgeBases: Docset[]\n  administratedCopilotEnterpriseOrganizations: CopilotChatOrg[] | null\n}\n\nexport interface Docset {\n  id: string\n  name: string\n  description: string\n  createdByID: number\n  ownerID: number\n  ownerLogin: string\n  ownerType: string\n  visibility: string\n  scopingQuery: string\n  repos: string[]\n  sourceRepos?: SourceRepo[]\n  visibleOutsideOrg: boolean\n  iconHtml?: SafeHTMLString\n  avatarUrl: string\n  adminableByUser: boolean\n  /**\n   * Orgs which own at least one repo in the docset but that the current user is not currently SSO'd into\n   */\n  protectedOrganizations: string[]\n}\n\nexport interface RepoData {\n  databaseId: number | null | undefined\n  name: string\n  nameWithOwner: string\n  isInOrganization: boolean\n  shortDescriptionHTML: string\n  paths?: string[]\n  owner: {\n    databaseId: number | null | undefined\n    avatarUrl: string\n    login: string\n  }\n}\n\nexport interface DocsetRepo extends RepoData {\n  paths: string[]\n}\n\nexport interface SourceRepo {\n  id: number\n  ownerID: number\n  paths: string[]\n}\n\nexport type MessageStreamingResponse =\n  | MessageStreamingResponseContent\n  | MessageStreamingResponseError\n  | MessageStreamingResponseComplete\n  | MessageStreamingResponseDebug\n  | MessageStreamingResponseFunctionCall\n  | MessageStreamingResponseConfirmation\n  | MessageStreamingResponseAgentError\n\nexport type MessageStreamingResponseContent = {\n  type: 'content'\n  body: string\n}\n\nexport type MessageStreamingResponseDebug = {\n  type: 'debug'\n  body: string\n}\n\nexport const MESSAGE_STREAMING_ERROR_TYPES = [\n  'exception',\n  'filtered',\n  'contentTooLarge',\n  'rateLimit',\n  'agentUnauthorized',\n  'agentRequest',\n  'networkError',\n  'multipleAgentsAttempt',\n] as const\n\ntype MessageStreamingErrorTypes = typeof MESSAGE_STREAMING_ERROR_TYPES\nexport type MessageStreamingErrorType = MessageStreamingErrorTypes[number]\n\nexport type MessageStreamingResponseError = {\n  type: 'error'\n  errorType: MessageStreamingErrorType\n  description: string\n}\n\nexport type MessageStreamingResponseComplete = {\n  type: 'complete'\n  id: string\n  turnID: string\n  createdAt: string\n  intent: string\n  references: CopilotChatReference[] | null\n  copilotAnnotations?: CopilotAnnotations\n}\n\nexport type MessageStreamingResponseFunctionCall = {\n  arguments: string\n  type: 'functionCall'\n  name: string\n  status: FunctionCalledStatus\n  errorMessage: string\n  references: CopilotChatReference[]\n}\n\nexport type MessageStreamingResponseConfirmation = {\n  type: 'confirmation'\n  title: string\n  message: string\n  confirmation: object\n}\n\nexport type MessageStreamingResponseAgentError = {\n  type: 'agentError'\n  agentErrorType: string\n  code: string\n  message: string\n  identifier: string\n}\n\nexport type FunctionArguments =\n  | BingSearchArguments\n  | FilePathSearchArguments\n  | SymbolSearchArguments\n  | CodeSearchArguments\n  | CreateIssueArguments\n  | GetIssueArguments\n  | GetPullRequestCommitsArguments\n  | GetCommitArguments\n  | GetAlertArguments\n  | GetReleaseArguments\n  | GetRepoArguments\n  | JobLogsArguments\n  | GetDiffArguments\n  | GetDiffByRangeArguments\n  | KnowledgeBaseSearchArguments\n  | GetFileArguments\n  | GetFileChangesArguments\n  | GetDiscussionArguments\n  | GetPullRequestArguments\n  | PlanArguments\n  | GitHubAPIArguments\n  | SupportSearchArguments\n\nexport type BingSearchArguments = {kind: 'bing-search'; query: string; freshness?: string}\nexport type SupportSearchArguments = {kind: 'support-search'; rawUserQuery: string}\nexport type CodeSearchArguments = {kind: 'codesearch'; query: string; scopingQuery: string}\nexport type KnowledgeBaseSearchArguments = {kind: 'kb-search'; query: string; kbID: string}\nexport type FilePathSearchArguments = {kind: 'pathsearch'; filename: string; scopingQuery: string}\nexport type GetFileArguments = {kind: 'getfile'; repo: string; path: string; ref?: string}\nexport type GetFileChangesArguments = {kind: 'getfilechanges'; repo: string; path: string; ref: string; max?: number}\nexport type SymbolSearchArguments = {kind: 'show-symbol-definition'; symbolName: string; scopingQuery: string}\nexport type CreateIssueArguments = {\n  kind: 'githubissuecreate'\n  repo: string\n  assignees: string[]\n  labels: string[]\n  title: string\n  body: string\n}\nexport type GetIssueArguments = {kind: 'getissue'; issueNumber: number; repo: string}\nexport type GetAlertArguments = {kind: 'getalert'; url: string}\nexport type GetPullRequestCommitsArguments = {kind: 'getprcommits'; pullRequestNumber: number; repo: string}\nexport type GetCommitArguments = {kind: 'getcommit'; commitish: number; repo: string}\nexport type GetReleaseArguments = {kind: 'getrelease'; repo: string; tagName?: string}\nexport type GetRepoArguments = {kind: 'getrepo'; repo: string}\nexport type JobLogsArguments = {\n  kind: 'get-actions-job-logs'\n  repo: string\n  jobId?: number\n  pullRequestNumber?: number\n  runId?: number\n  workflowPath?: string\n}\nexport type GetDiffArguments = {\n  kind: 'getdiff'\n  baseRepoId: number\n  headRepoId: number\n  baseRevision: string\n  headRevision: string\n}\nexport type GetDiffByRangeArguments = {kind: 'get-diff-by-range'; repo: string; range: string}\nexport type GetDiscussionArguments = {kind: 'getdiscussion'; repo: string; discussionNumber: number; owner: string}\nexport type GetPullRequestArguments = {kind: 'getpullrequest'; pullRequestNumber: number; repo: string}\nexport type PlanArguments = {kind: 'planskill'; user_query: string}\nexport type GitHubAPIArguments = {\n  kind: 'get-github-data'\n  endpoint: string\n  repo: string\n  endpointDescription?: string\n  task?: string\n}\n\nexport const SUPPORTED_FUNCTIONS = [\n  'bing-search',\n  'codesearch',\n  'kb-search',\n  'pathsearch',\n  'show-symbol-definition',\n  'getissue',\n  'getprcommits',\n  'getcommit',\n  'getrelease',\n  'getrepo',\n  'getdiff',\n  'get-diff-by-range',\n  'getfile',\n  'getfilechanges',\n  'getdiscussion',\n  'get-actions-job-logs',\n  'getpullrequest',\n  'getalert',\n  'planskill',\n  'get-github-data',\n  'support-search',\n]\n\nexport type FunctionCalledStatus = 'completed' | 'started' | 'error' | 'unsupported'\n\nexport type NotAuthorizedForAgentErrorPayload = {\n  authorize_url: string\n  client_id: string\n  name: string\n  avatar_url: string\n  slug: string\n  description: string\n}\n\nexport type AppAgentRequestErrorPayload = {\n  type: string\n  code: string\n  identifier: string\n  message: string\n}\n\nexport type CopilotChatMode = 'immersive' | 'assistive'\n\nexport type SuccessfulAPIResult<T> = {\n  status: number\n  ok: true\n  payload: T\n}\n\nexport type FailedAPIResult = {\n  status: number\n  ok: false\n  error: string\n}\n\nexport type APIResult<T> = SuccessfulAPIResult<T> | FailedAPIResult\n\ntype SuccessfulAPIStreamingResult = {\n  status: number\n  ok: true\n  response: Response\n}\n\nexport type APIStreamingResult = SuccessfulAPIStreamingResult | FailedAPIResult\n\nexport interface CopilotChatPayload {\n  agentsPath: string\n  apiURL: string\n  currentUserLogin: string\n  customInstructions?: string\n  renderKnowledgeBases?: boolean\n  optedInToUserFeedback: boolean\n  renderAttachKnowledgeBaseHerePopover?: boolean\n  renderKnowledgeBaseAttachedToChatPopover?: boolean\n  reviewLab: boolean\n}\n","/**\n * @generated SignedSource<<c34f1ed45ae3cb39eb54094e580e3055>>\n * @lightSyntaxTransform\n * @nogrep\n */\n\n/* tslint:disable */\n/* eslint-disable */\n// @ts-nocheck\n\nimport { Fragment, ReaderFragment } from 'relay-runtime';\nimport { FragmentRefs } from \"relay-runtime\";\nexport type useFileDiffReference_Comparison$data = {\n  readonly newCommit: {\n    readonly oid: any;\n    readonly repository: {\n      readonly databaseId: number | null | undefined;\n      readonly name: string;\n      readonly owner: {\n        readonly login: string;\n      };\n      readonly url: string;\n    };\n  };\n  readonly oldCommit: {\n    readonly oid: any;\n    readonly repository: {\n      readonly databaseId: number | null | undefined;\n      readonly name: string;\n      readonly owner: {\n        readonly login: string;\n      };\n      readonly url: string;\n    };\n  };\n  readonly \" $fragmentType\": \"useFileDiffReference_Comparison\";\n};\nexport type useFileDiffReference_Comparison$key = {\n  readonly \" $data\"?: useFileDiffReference_Comparison$data;\n  readonly \" $fragmentSpreads\": FragmentRefs<\"useFileDiffReference_Comparison\">;\n};\n\nconst node: ReaderFragment = (function(){\nvar v0 = [\n  {\n    \"alias\": null,\n    \"args\": null,\n    \"kind\": \"ScalarField\",\n    \"name\": \"oid\",\n    \"storageKey\": null\n  },\n  {\n    \"alias\": null,\n    \"args\": null,\n    \"concreteType\": \"Repository\",\n    \"kind\": \"LinkedField\",\n    \"name\": \"repository\",\n    \"plural\": false,\n    \"selections\": [\n      {\n        \"alias\": null,\n        \"args\": null,\n        \"kind\": \"ScalarField\",\n        \"name\": \"databaseId\",\n        \"storageKey\": null\n      },\n      {\n        \"alias\": null,\n        \"args\": null,\n        \"kind\": \"ScalarField\",\n        \"name\": \"name\",\n        \"storageKey\": null\n      },\n      {\n        \"alias\": null,\n        \"args\": null,\n        \"kind\": \"ScalarField\",\n        \"name\": \"url\",\n        \"storageKey\": null\n      },\n      {\n        \"alias\": null,\n        \"args\": null,\n        \"concreteType\": null,\n        \"kind\": \"LinkedField\",\n        \"name\": \"owner\",\n        \"plural\": false,\n        \"selections\": [\n          {\n            \"alias\": null,\n            \"args\": null,\n            \"kind\": \"ScalarField\",\n            \"name\": \"login\",\n            \"storageKey\": null\n          }\n        ],\n        \"storageKey\": null\n      }\n    ],\n    \"storageKey\": null\n  }\n];\nreturn {\n  \"argumentDefinitions\": [],\n  \"kind\": \"Fragment\",\n  \"metadata\": null,\n  \"name\": \"useFileDiffReference_Comparison\",\n  \"selections\": [\n    {\n      \"alias\": null,\n      \"args\": null,\n      \"concreteType\": \"Commit\",\n      \"kind\": \"LinkedField\",\n      \"name\": \"oldCommit\",\n      \"plural\": false,\n      \"selections\": (v0/*: any*/),\n      \"storageKey\": null\n    },\n    {\n      \"alias\": null,\n      \"args\": null,\n      \"concreteType\": \"Commit\",\n      \"kind\": \"LinkedField\",\n      \"name\": \"newCommit\",\n      \"plural\": false,\n      \"selections\": (v0/*: any*/),\n      \"storageKey\": null\n    }\n  ],\n  \"type\": \"PullRequestComparison\",\n  \"abstractKey\": null\n};\n})();\n\n(node as any).hash = \"fb70959c69497160ff44b9b0c7820e08\";\n\nexport default node;\n","/**\n * @generated SignedSource<<a32e260b0ef457460b648d2a46274c20>>\n * @lightSyntaxTransform\n * @nogrep\n */\n\n/* tslint:disable */\n/* eslint-disable */\n// @ts-nocheck\n\nimport { Fragment, ReaderFragment } from 'relay-runtime';\nimport { FragmentRefs } from \"relay-runtime\";\nexport type useFileDiffReference_DiffEntry$data = {\n  readonly isBinary: boolean;\n  readonly isLfsPointer: boolean;\n  readonly isSubmodule: boolean;\n  readonly newTreeEntry: {\n    readonly path: string | null | undefined;\n    readonly size: number;\n  } | null | undefined;\n  readonly oldTreeEntry: {\n    readonly path: string | null | undefined;\n    readonly size: number;\n  } | null | undefined;\n  readonly path: string;\n  readonly pathDigest: string;\n  readonly rawUrl: string | null | undefined;\n  readonly \" $fragmentType\": \"useFileDiffReference_DiffEntry\";\n};\nexport type useFileDiffReference_DiffEntry$key = {\n  readonly \" $data\"?: useFileDiffReference_DiffEntry$data;\n  readonly \" $fragmentSpreads\": FragmentRefs<\"useFileDiffReference_DiffEntry\">;\n};\n\nconst node: ReaderFragment = (function(){\nvar v0 = {\n  \"alias\": null,\n  \"args\": null,\n  \"kind\": \"ScalarField\",\n  \"name\": \"path\",\n  \"storageKey\": null\n},\nv1 = [\n  (v0/*: any*/),\n  {\n    \"alias\": null,\n    \"args\": null,\n    \"kind\": \"ScalarField\",\n    \"name\": \"size\",\n    \"storageKey\": null\n  }\n];\nreturn {\n  \"argumentDefinitions\": [],\n  \"kind\": \"Fragment\",\n  \"metadata\": null,\n  \"name\": \"useFileDiffReference_DiffEntry\",\n  \"selections\": [\n    {\n      \"alias\": null,\n      \"args\": null,\n      \"kind\": \"ScalarField\",\n      \"name\": \"pathDigest\",\n      \"storageKey\": null\n    },\n    (v0/*: any*/),\n    {\n      \"alias\": null,\n      \"args\": null,\n      \"kind\": \"ScalarField\",\n      \"name\": \"rawUrl\",\n      \"storageKey\": null\n    },\n    {\n      \"alias\": null,\n      \"args\": null,\n      \"kind\": \"ScalarField\",\n      \"name\": \"isBinary\",\n      \"storageKey\": null\n    },\n    {\n      \"alias\": null,\n      \"args\": null,\n      \"kind\": \"ScalarField\",\n      \"name\": \"isSubmodule\",\n      \"storageKey\": null\n    },\n    {\n      \"alias\": null,\n      \"args\": null,\n      \"kind\": \"ScalarField\",\n      \"name\": \"isLfsPointer\",\n      \"storageKey\": null\n    },\n    {\n      \"alias\": null,\n      \"args\": null,\n      \"concreteType\": \"TreeEntry\",\n      \"kind\": \"LinkedField\",\n      \"name\": \"oldTreeEntry\",\n      \"plural\": false,\n      \"selections\": (v1/*: any*/),\n      \"storageKey\": null\n    },\n    {\n      \"alias\": null,\n      \"args\": null,\n      \"concreteType\": \"TreeEntry\",\n      \"kind\": \"LinkedField\",\n      \"name\": \"newTreeEntry\",\n      \"plural\": false,\n      \"selections\": (v1/*: any*/),\n      \"storageKey\": null\n    }\n  ],\n  \"type\": \"PullRequestDiffEntry\",\n  \"abstractKey\": null\n};\n})();\n\n(node as any).hash = \"f853615ae640634aad832da060f944cf\";\n\nexport default node;\n","/**\n * @generated SignedSource<<717755d8375d3bec4d2f6da0830e504f>>\n * @relayHash fb6fd29b2f37f48929378e605adb454a\n * @lightSyntaxTransform\n * @nogrep\n */\n\n/* tslint:disable */\n/* eslint-disable */\n// @ts-nocheck\n\n// @relayRequestID fb6fd29b2f37f48929378e605adb454a\n\nimport { ConcreteRequest, Query } from 'relay-runtime';\nimport { FragmentRefs } from \"relay-runtime\";\nexport type DiffChatWrapper_ComparisonQuery$variables = {\n  endOid: string;\n  pullRequestId: string;\n  startOid: string;\n};\nexport type DiffChatWrapper_ComparisonQuery$data = {\n  readonly pullRequest: {\n    readonly comparison?: {\n      readonly \" $fragmentSpreads\": FragmentRefs<\"useFileDiffReference_Comparison\">;\n    } | null | undefined;\n  } | null | undefined;\n};\nexport type DiffChatWrapper_ComparisonQuery = {\n  response: DiffChatWrapper_ComparisonQuery$data;\n  variables: DiffChatWrapper_ComparisonQuery$variables;\n};\n\nconst node: ConcreteRequest = (function(){\nvar v0 = {\n  \"defaultValue\": null,\n  \"kind\": \"LocalArgument\",\n  \"name\": \"endOid\"\n},\nv1 = {\n  \"defaultValue\": null,\n  \"kind\": \"LocalArgument\",\n  \"name\": \"pullRequestId\"\n},\nv2 = {\n  \"defaultValue\": null,\n  \"kind\": \"LocalArgument\",\n  \"name\": \"startOid\"\n},\nv3 = [\n  {\n    \"kind\": \"Variable\",\n    \"name\": \"id\",\n    \"variableName\": \"pullRequestId\"\n  }\n],\nv4 = [\n  {\n    \"kind\": \"Variable\",\n    \"name\": \"endOid\",\n    \"variableName\": \"endOid\"\n  },\n  {\n    \"kind\": \"Variable\",\n    \"name\": \"startOid\",\n    \"variableName\": \"startOid\"\n  }\n],\nv5 = {\n  \"alias\": null,\n  \"args\": null,\n  \"kind\": \"ScalarField\",\n  \"name\": \"__typename\",\n  \"storageKey\": null\n},\nv6 = {\n  \"alias\": null,\n  \"args\": null,\n  \"kind\": \"ScalarField\",\n  \"name\": \"id\",\n  \"storageKey\": null\n},\nv7 = [\n  {\n    \"alias\": null,\n    \"args\": null,\n    \"kind\": \"ScalarField\",\n    \"name\": \"oid\",\n    \"storageKey\": null\n  },\n  {\n    \"alias\": null,\n    \"args\": null,\n    \"concreteType\": \"Repository\",\n    \"kind\": \"LinkedField\",\n    \"name\": \"repository\",\n    \"plural\": false,\n    \"selections\": [\n      {\n        \"alias\": null,\n        \"args\": null,\n        \"kind\": \"ScalarField\",\n        \"name\": \"databaseId\",\n        \"storageKey\": null\n      },\n      {\n        \"alias\": null,\n        \"args\": null,\n        \"kind\": \"ScalarField\",\n        \"name\": \"name\",\n        \"storageKey\": null\n      },\n      {\n        \"alias\": null,\n        \"args\": null,\n        \"kind\": \"ScalarField\",\n        \"name\": \"url\",\n        \"storageKey\": null\n      },\n      {\n        \"alias\": null,\n        \"args\": null,\n        \"concreteType\": null,\n        \"kind\": \"LinkedField\",\n        \"name\": \"owner\",\n        \"plural\": false,\n        \"selections\": [\n          (v5/*: any*/),\n          {\n            \"alias\": null,\n            \"args\": null,\n            \"kind\": \"ScalarField\",\n            \"name\": \"login\",\n            \"storageKey\": null\n          },\n          (v6/*: any*/)\n        ],\n        \"storageKey\": null\n      },\n      (v6/*: any*/)\n    ],\n    \"storageKey\": null\n  },\n  (v6/*: any*/)\n];\nreturn {\n  \"fragment\": {\n    \"argumentDefinitions\": [\n      (v0/*: any*/),\n      (v1/*: any*/),\n      (v2/*: any*/)\n    ],\n    \"kind\": \"Fragment\",\n    \"metadata\": null,\n    \"name\": \"DiffChatWrapper_ComparisonQuery\",\n    \"selections\": [\n      {\n        \"alias\": \"pullRequest\",\n        \"args\": (v3/*: any*/),\n        \"concreteType\": null,\n        \"kind\": \"LinkedField\",\n        \"name\": \"node\",\n        \"plural\": false,\n        \"selections\": [\n          {\n            \"kind\": \"InlineFragment\",\n            \"selections\": [\n              {\n                \"alias\": null,\n                \"args\": (v4/*: any*/),\n                \"concreteType\": \"PullRequestComparison\",\n                \"kind\": \"LinkedField\",\n                \"name\": \"comparison\",\n                \"plural\": false,\n                \"selections\": [\n                  {\n                    \"args\": null,\n                    \"kind\": \"FragmentSpread\",\n                    \"name\": \"useFileDiffReference_Comparison\"\n                  }\n                ],\n                \"storageKey\": null\n              }\n            ],\n            \"type\": \"PullRequest\",\n            \"abstractKey\": null\n          }\n        ],\n        \"storageKey\": null\n      }\n    ],\n    \"type\": \"Query\",\n    \"abstractKey\": null\n  },\n  \"kind\": \"Request\",\n  \"operation\": {\n    \"argumentDefinitions\": [\n      (v1/*: any*/),\n      (v2/*: any*/),\n      (v0/*: any*/)\n    ],\n    \"kind\": \"Operation\",\n    \"name\": \"DiffChatWrapper_ComparisonQuery\",\n    \"selections\": [\n      {\n        \"alias\": \"pullRequest\",\n        \"args\": (v3/*: any*/),\n        \"concreteType\": null,\n        \"kind\": \"LinkedField\",\n        \"name\": \"node\",\n        \"plural\": false,\n        \"selections\": [\n          (v5/*: any*/),\n          {\n            \"kind\": \"InlineFragment\",\n            \"selections\": [\n              {\n                \"alias\": null,\n                \"args\": (v4/*: any*/),\n                \"concreteType\": \"PullRequestComparison\",\n                \"kind\": \"LinkedField\",\n                \"name\": \"comparison\",\n                \"plural\": false,\n                \"selections\": [\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"concreteType\": \"Commit\",\n                    \"kind\": \"LinkedField\",\n                    \"name\": \"oldCommit\",\n                    \"plural\": false,\n                    \"selections\": (v7/*: any*/),\n                    \"storageKey\": null\n                  },\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"concreteType\": \"Commit\",\n                    \"kind\": \"LinkedField\",\n                    \"name\": \"newCommit\",\n                    \"plural\": false,\n                    \"selections\": (v7/*: any*/),\n                    \"storageKey\": null\n                  }\n                ],\n                \"storageKey\": null\n              }\n            ],\n            \"type\": \"PullRequest\",\n            \"abstractKey\": null\n          },\n          (v6/*: any*/)\n        ],\n        \"storageKey\": null\n      }\n    ]\n  },\n  \"params\": {\n    \"id\": \"fb6fd29b2f37f48929378e605adb454a\",\n    \"metadata\": {},\n    \"name\": \"DiffChatWrapper_ComparisonQuery\",\n    \"operationKind\": \"query\",\n    \"text\": null\n  }\n};\n})();\n\n(node as any).hash = \"e34cdc5b305060e84f51c908a09989a0\";\n\nexport default node;\n","/**\n * @generated SignedSource<<920b592c0d57570baa80c456aabaf9f0>>\n * @relayHash 7c9df64c41ef33594dd0882be84ef373\n * @lightSyntaxTransform\n * @nogrep\n */\n\n/* tslint:disable */\n/* eslint-disable */\n// @ts-nocheck\n\n// @relayRequestID 7c9df64c41ef33594dd0882be84ef373\n\nimport { ConcreteRequest, Query } from 'relay-runtime';\nimport { FragmentRefs } from \"relay-runtime\";\nexport type DiffChatWrapper_DiffEntryQuery$variables = {\n  diffEntryId: string;\n};\nexport type DiffChatWrapper_DiffEntryQuery$data = {\n  readonly diffEntry: {\n    readonly \" $fragmentSpreads\": FragmentRefs<\"useFileDiffReference_DiffEntry\">;\n  } | null | undefined;\n};\nexport type DiffChatWrapper_DiffEntryQuery = {\n  response: DiffChatWrapper_DiffEntryQuery$data;\n  variables: DiffChatWrapper_DiffEntryQuery$variables;\n};\n\nconst node: ConcreteRequest = (function(){\nvar v0 = [\n  {\n    \"defaultValue\": null,\n    \"kind\": \"LocalArgument\",\n    \"name\": \"diffEntryId\"\n  }\n],\nv1 = [\n  {\n    \"kind\": \"Variable\",\n    \"name\": \"id\",\n    \"variableName\": \"diffEntryId\"\n  }\n],\nv2 = {\n  \"alias\": null,\n  \"args\": null,\n  \"kind\": \"ScalarField\",\n  \"name\": \"path\",\n  \"storageKey\": null\n},\nv3 = [\n  (v2/*: any*/),\n  {\n    \"alias\": null,\n    \"args\": null,\n    \"kind\": \"ScalarField\",\n    \"name\": \"size\",\n    \"storageKey\": null\n  }\n];\nreturn {\n  \"fragment\": {\n    \"argumentDefinitions\": (v0/*: any*/),\n    \"kind\": \"Fragment\",\n    \"metadata\": null,\n    \"name\": \"DiffChatWrapper_DiffEntryQuery\",\n    \"selections\": [\n      {\n        \"alias\": \"diffEntry\",\n        \"args\": (v1/*: any*/),\n        \"concreteType\": null,\n        \"kind\": \"LinkedField\",\n        \"name\": \"node\",\n        \"plural\": false,\n        \"selections\": [\n          {\n            \"kind\": \"InlineFragment\",\n            \"selections\": [\n              {\n                \"args\": null,\n                \"kind\": \"FragmentSpread\",\n                \"name\": \"useFileDiffReference_DiffEntry\"\n              }\n            ],\n            \"type\": \"PullRequestDiffEntry\",\n            \"abstractKey\": null\n          }\n        ],\n        \"storageKey\": null\n      }\n    ],\n    \"type\": \"Query\",\n    \"abstractKey\": null\n  },\n  \"kind\": \"Request\",\n  \"operation\": {\n    \"argumentDefinitions\": (v0/*: any*/),\n    \"kind\": \"Operation\",\n    \"name\": \"DiffChatWrapper_DiffEntryQuery\",\n    \"selections\": [\n      {\n        \"alias\": \"diffEntry\",\n        \"args\": (v1/*: any*/),\n        \"concreteType\": null,\n        \"kind\": \"LinkedField\",\n        \"name\": \"node\",\n        \"plural\": false,\n        \"selections\": [\n          {\n            \"alias\": null,\n            \"args\": null,\n            \"kind\": \"ScalarField\",\n            \"name\": \"__typename\",\n            \"storageKey\": null\n          },\n          {\n            \"kind\": \"InlineFragment\",\n            \"selections\": [\n              {\n                \"alias\": null,\n                \"args\": null,\n                \"kind\": \"ScalarField\",\n                \"name\": \"pathDigest\",\n                \"storageKey\": null\n              },\n              (v2/*: any*/),\n              {\n                \"alias\": null,\n                \"args\": null,\n                \"kind\": \"ScalarField\",\n                \"name\": \"rawUrl\",\n                \"storageKey\": null\n              },\n              {\n                \"alias\": null,\n                \"args\": null,\n                \"kind\": \"ScalarField\",\n                \"name\": \"isBinary\",\n                \"storageKey\": null\n              },\n              {\n                \"alias\": null,\n                \"args\": null,\n                \"kind\": \"ScalarField\",\n                \"name\": \"isSubmodule\",\n                \"storageKey\": null\n              },\n              {\n                \"alias\": null,\n                \"args\": null,\n                \"kind\": \"ScalarField\",\n                \"name\": \"isLfsPointer\",\n                \"storageKey\": null\n              },\n              {\n                \"alias\": null,\n                \"args\": null,\n                \"concreteType\": \"TreeEntry\",\n                \"kind\": \"LinkedField\",\n                \"name\": \"oldTreeEntry\",\n                \"plural\": false,\n                \"selections\": (v3/*: any*/),\n                \"storageKey\": null\n              },\n              {\n                \"alias\": null,\n                \"args\": null,\n                \"concreteType\": \"TreeEntry\",\n                \"kind\": \"LinkedField\",\n                \"name\": \"newTreeEntry\",\n                \"plural\": false,\n                \"selections\": (v3/*: any*/),\n                \"storageKey\": null\n              }\n            ],\n            \"type\": \"PullRequestDiffEntry\",\n            \"abstractKey\": null\n          },\n          {\n            \"alias\": null,\n            \"args\": null,\n            \"kind\": \"ScalarField\",\n            \"name\": \"id\",\n            \"storageKey\": null\n          }\n        ],\n        \"storageKey\": null\n      }\n    ]\n  },\n  \"params\": {\n    \"id\": \"7c9df64c41ef33594dd0882be84ef373\",\n    \"metadata\": {},\n    \"name\": \"DiffChatWrapper_DiffEntryQuery\",\n    \"operationKind\": \"query\",\n    \"text\": null\n  }\n};\n})();\n\n(node as any).hash = \"064698bd6869b0c7d063a68d0b3666d8\";\n\nexport default node;\n","/**\n * @generated SignedSource<<8dfa0f88c036c397d0524b6c3960b125>>\n * @relayHash 16bed8244ee96ad06b6638dbb86dd0ff\n * @lightSyntaxTransform\n * @nogrep\n */\n\n/* tslint:disable */\n/* eslint-disable */\n// @ts-nocheck\n\n// @relayRequestID 16bed8244ee96ad06b6638dbb86dd0ff\n\nimport { ConcreteRequest, Query } from 'relay-runtime';\nexport type DiffChatWrapper_ViewerQuery$variables = Record<PropertyKey, never>;\nexport type DiffChatWrapper_ViewerQuery$data = {\n  readonly viewer: {\n    readonly isCopilotDotcomChatEnabled: boolean;\n  };\n};\nexport type DiffChatWrapper_ViewerQuery = {\n  response: DiffChatWrapper_ViewerQuery$data;\n  variables: DiffChatWrapper_ViewerQuery$variables;\n};\n\nconst node: ConcreteRequest = (function(){\nvar v0 = {\n  \"alias\": null,\n  \"args\": null,\n  \"kind\": \"ScalarField\",\n  \"name\": \"isCopilotDotcomChatEnabled\",\n  \"storageKey\": null\n};\nreturn {\n  \"fragment\": {\n    \"argumentDefinitions\": [],\n    \"kind\": \"Fragment\",\n    \"metadata\": null,\n    \"name\": \"DiffChatWrapper_ViewerQuery\",\n    \"selections\": [\n      {\n        \"alias\": null,\n        \"args\": null,\n        \"concreteType\": \"User\",\n        \"kind\": \"LinkedField\",\n        \"name\": \"viewer\",\n        \"plural\": false,\n        \"selections\": [\n          (v0/*: any*/)\n        ],\n        \"storageKey\": null\n      }\n    ],\n    \"type\": \"Query\",\n    \"abstractKey\": null\n  },\n  \"kind\": \"Request\",\n  \"operation\": {\n    \"argumentDefinitions\": [],\n    \"kind\": \"Operation\",\n    \"name\": \"DiffChatWrapper_ViewerQuery\",\n    \"selections\": [\n      {\n        \"alias\": null,\n        \"args\": null,\n        \"concreteType\": \"User\",\n        \"kind\": \"LinkedField\",\n        \"name\": \"viewer\",\n        \"plural\": false,\n        \"selections\": [\n          (v0/*: any*/),\n          {\n            \"alias\": null,\n            \"args\": null,\n            \"kind\": \"ScalarField\",\n            \"name\": \"id\",\n            \"storageKey\": null\n          }\n        ],\n        \"storageKey\": null\n      }\n    ]\n  },\n  \"params\": {\n    \"id\": \"16bed8244ee96ad06b6638dbb86dd0ff\",\n    \"metadata\": {},\n    \"name\": \"DiffChatWrapper_ViewerQuery\",\n    \"operationKind\": \"query\",\n    \"text\": null\n  }\n};\n})();\n\n(node as any).hash = \"4d1f99d4dad28f392f7ea1a3cecbcfff\";\n\nexport default node;\n","import type {FileDiffReference} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport {useMemo} from 'react'\nimport {graphql, useFragment} from 'react-relay'\nimport type {\n  useFileDiffReference_Comparison$data,\n  useFileDiffReference_Comparison$key,\n} from './__generated__/useFileDiffReference_Comparison.graphql'\nimport type {\n  useFileDiffReference_DiffEntry$data,\n  useFileDiffReference_DiffEntry$key,\n} from './__generated__/useFileDiffReference_DiffEntry.graphql'\n\nconst ComparisonFragment = graphql`\n  fragment useFileDiffReference_Comparison on PullRequestComparison {\n    oldCommit {\n      oid\n      repository {\n        databaseId\n        name\n        url\n        owner {\n          login\n        }\n      }\n    }\n    newCommit {\n      oid\n      repository {\n        databaseId\n        name\n        url\n        owner {\n          login\n        }\n      }\n    }\n  }\n`\n\nconst DiffEntryFragment = graphql`\n  fragment useFileDiffReference_DiffEntry on PullRequestDiffEntry {\n    pathDigest\n    path\n    rawUrl\n    isBinary\n    isSubmodule\n    isLfsPointer\n    oldTreeEntry {\n      path\n      size\n    }\n    newTreeEntry {\n      path\n      size\n    }\n  }\n`\n\n// CAPI will only pull in files that are less than 1MB in size\nconst ONE_MB = 1_048_576\n\n// omitting the $fragmentType just for easier use externally\ntype FileDiffReferenceDiffEntry = Omit<useFileDiffReference_DiffEntry$data, ' $fragmentType'>\n\n// force these to be writeable\ntype DeepWriteable<T> = {-readonly [P in keyof T]: DeepWriteable<T[P]>}\nexport type CopilotChatFileDiffReferenceData = DeepWriteable<FileDiffReferenceDiffEntry>\n\n/** Convert the GraphQL query result to a `FileDiffReference` compatible with Copilot. */\nexport const buildFileDiffReference = (\n  {oldCommit, newCommit}: useFileDiffReference_Comparison$data,\n  {oldTreeEntry, newTreeEntry, ...diffEntry}: FileDiffReferenceDiffEntry,\n  latestCommitOid?: string,\n): FileDiffReference | undefined => {\n  if (\n    diffEntry.isBinary ||\n    diffEntry.isSubmodule ||\n    diffEntry.isLfsPointer ||\n    !newTreeEntry || // deleted files\n    (oldTreeEntry?.size ?? 0) > ONE_MB ||\n    (newTreeEntry.size ?? 0) > ONE_MB\n  )\n    return undefined\n\n  const headFileCommitOid = oldTreeEntry || !latestCommitOid ? newCommit.oid : latestCommitOid\n  return {\n    type: 'file-diff',\n    id: `diff-${diffEntry.pathDigest}`,\n    url: diffEntry.rawUrl ?? '',\n    baseFile: oldTreeEntry\n      ? {\n          type: 'file',\n          repoID: oldCommit.repository.databaseId ?? 0,\n          repoName: oldCommit.repository.name,\n          repoOwner: oldCommit.repository.owner.login,\n          path: oldTreeEntry.path ?? '',\n          commitOID: oldCommit.oid,\n          url: `${oldCommit.repository.url}/raw/${oldCommit.oid}/${oldTreeEntry.path}`,\n          ref: oldCommit.oid,\n        }\n      : null,\n    headFile: {\n      type: 'file',\n      repoID: newCommit.repository.databaseId ?? 0,\n      repoName: newCommit.repository.name,\n      repoOwner: newCommit.repository.owner.login,\n      path: newTreeEntry.path ?? '',\n      commitOID: headFileCommitOid,\n      url: `${newCommit.repository.url}/raw/${headFileCommitOid}/${newTreeEntry.path}`,\n      ref: headFileCommitOid,\n    },\n    head: null,\n    base: null,\n  }\n}\n\nexport const useFileDiffReference = (\n  comparisonKey: useFileDiffReference_Comparison$key,\n  diffEntryKey: useFileDiffReference_DiffEntry$key,\n  latestCommitOid?: string,\n) => {\n  const comparison = useFragment(ComparisonFragment, comparisonKey)\n  const diffEntry = useFragment(DiffEntryFragment, diffEntryKey)\n\n  return useMemo(\n    () => buildFileDiffReference(comparison, diffEntry, latestCommitOid),\n    [comparison, diffEntry, latestCommitOid],\n  )\n}\n\nexport const useFileDiffReferenceWithEntryProvided = (\n  comparisonKey: useFileDiffReference_Comparison$key,\n  diffEntry: FileDiffReferenceDiffEntry,\n) => {\n  const comparison = useFragment(ComparisonFragment, comparisonKey)\n\n  return useMemo(() => buildFileDiffReference(comparison, diffEntry), [comparison, diffEntry])\n}\n","import {Box} from '@primer/react'\nimport type {PropsWithChildren} from 'react'\nimport type {BetterSystemStyleObject} from '@primer/react/lib-esm/sx'\n\nexport interface LinesChangedCounterLabelProps {\n  isAddition?: boolean\n  sx?: BetterSystemStyleObject\n}\n\nexport function LinesChangedCounterLabel({children, isAddition, sx}: PropsWithChildren<LinesChangedCounterLabelProps>) {\n  return (\n    <Box\n      sx={{\n        color: isAddition ? 'success.fg' : 'danger.fg',\n        ml: 1,\n        fontWeight: 'bold',\n        fontSize: 0,\n        ...sx,\n      }}\n    >\n      {children}\n    </Box>\n  )\n}\n\ntry{ LinesChangedCounterLabel.displayName ||= 'LinesChangedCounterLabel' } catch {}","// extracted by mini-css-extract-plugin\nexport default {\"diff-file-header\":\"DiffFileHeader-module__diff-file-header--TjXyn\",\"collapsed\":\"DiffFileHeader-module__collapsed--FPwYM\",\"file-name\":\"DiffFileHeader-module__file-name--mY1O5\"};","import {clsx} from 'clsx'\nimport {\n  ArrowRightIcon,\n  ChevronDownIcon,\n  ChevronRightIcon,\n  CodeIcon,\n  FileIcon,\n  FoldIcon,\n  UnfoldIcon,\n} from '@primer/octicons-react'\nimport {Link, Octicon, SegmentedControl} from '@primer/react'\nimport {Tooltip} from '@primer/react/next'\nimport type {PatchStatus} from '@github-ui/diff-file-helpers'\nimport {fileModeChangedOnly} from '@github-ui/diff-file-helpers'\nimport type {MouseEvent, ReactNode, RefObject} from 'react'\nimport {CopyToClipboardButton} from '@github-ui/copy-to-clipboard'\nimport {LinesChangedCounterLabel} from './LinesChangedCounterLabel'\nimport styles from './DiffFileHeader.module.css'\n\nfunction FileName({\n  newPath,\n  oldPath,\n  status,\n}: {\n  newPath?: string | null\n  oldPath?: string | null\n  status: PatchStatus\n}): JSX.Element {\n  const newPathStartsWithDot = newPath && newPath.startsWith('.')\n  const oldPathStartsWithDot = oldPath && oldPath.startsWith('.')\n  const newPathElement = newPathStartsWithDot ? <>&lrm;{newPath}</> : <>{newPath}</>\n  const oldPathElement = oldPathStartsWithDot ? <>&lrm;{oldPath}</> : <>{oldPath}</>\n  if (status === 'RENAMED') {\n    return (\n      <code>\n        {oldPathElement} <ArrowRightIcon /> {newPathElement}\n      </code>\n    )\n  } else if (status === 'DELETED' || status === 'REMOVED') {\n    return <code>{oldPathElement}</code>\n  } else {\n    return <code>{newPathElement}</code>\n  }\n}\n\nexport interface DiffFileHeaderProps {\n  /**\n   * Optional additional content to render to the left of the file name\n   */\n  additionalLeftSideContent?: ReactNode\n  /**\n   * Indicates whether the lines in the file have all been expanded\n   */\n  areLinesExpanded: boolean\n  /**\n   * Indicates whether the \"expand all\" button should be shown\n   */\n  canExpandOrCollapseLines: boolean\n  /**\n   * Indicates whether the diff should default to rich mode\n   */\n  defaultToRichDiff?: boolean\n  /**\n   * Indicates whether the file is in a collapsed state\n   */\n  isCollapsed: boolean\n  /**\n   * Indicates whether the diff can be displayed in rich mode\n   */\n  canToggleRichDiff: boolean\n  /**\n   * Count of the number of lines added to the file\n   */\n  linesAdded: number\n  /**\n   * Count of the number of lines deleted from the file\n   */\n  linesDeleted: number\n  /**\n   * The href to use for the file name link\n   */\n  fileLinkHref?: string\n  /**\n   * A ref to use for the file name link\n   */\n  fileLinkRef?: RefObject<HTMLAnchorElement>\n  /**\n   * The new git mode of the file\n   */\n  newMode?: number\n  /**\n   * The new path of the file\n   */\n  newPath?: string | null\n  /**\n   * The old git mode of the file\n   */\n  oldMode?: number\n  /**\n   * The old path of the file\n   */\n  oldPath?: string | null\n  /**\n   * Callback invoked when the user clicks the button to copy the file path\n   */\n  onCopyPath?: () => void\n  /**\n   * Callback invoked when the user clicks the header\n   */\n  onHeaderClick?: (e: MouseEvent<HTMLElement>) => void\n  /**\n   * Callback invoked when the user clicks the button to toggle the expanded state of all lines\n   */\n  onToggleExpandAllLines?: () => void\n  /**\n   * Callback invoked when the user clicks the button to toggle the collapsed state of the file\n   */\n  onToggleFileCollapsed: () => void\n  /**\n   * Callback invloked when the user clicks the button to toggle the display of the diff between rich and source\n   */\n  onToggleDiffDisplay?: (rich: boolean) => void\n  /**\n   * The status of the file\n   */\n  patchStatus: PatchStatus\n  /**\n   * The path of the file\n   */\n  path: string\n  /**\n   * Optional additional content to render after the file name. This content will be right-aligned.\n   */\n  rightSideContent?: ReactNode\n}\n\n/**\n * Renders the header of a diff file.\n */\nexport function DiffFileHeader({\n  additionalLeftSideContent,\n  areLinesExpanded,\n  canExpandOrCollapseLines,\n  defaultToRichDiff,\n  isCollapsed,\n  canToggleRichDiff,\n  linesAdded,\n  linesDeleted,\n  fileLinkHref,\n  fileLinkRef,\n  newMode,\n  newPath,\n  oldMode,\n  oldPath,\n  onCopyPath,\n  onHeaderClick,\n  onToggleDiffDisplay,\n  onToggleExpandAllLines,\n  onToggleFileCollapsed,\n  patchStatus,\n  path,\n  rightSideContent,\n}: DiffFileHeaderProps) {\n  return (\n    <div className={clsx(styles['diff-file-header'], isCollapsed ? styles['collapsed'] : '')}>\n      <button\n        onClick={onToggleFileCollapsed}\n        className=\"Button Button--iconOnly Button--invisible flex-shrink-0\"\n        aria-label={isCollapsed ? `expand file: ${path}` : `collapse file: ${path}`}\n      >\n        {isCollapsed ? <ChevronRightIcon /> : <ChevronDownIcon />}\n      </button>\n      {additionalLeftSideContent}\n      <div className=\"d-flex px-1 flex-items-center flex-1 overflow-hidden\">\n        <h3 className={clsx(styles['file-name'])}>\n          <Link className=\"Link--primary\" href={fileLinkHref} onClick={onHeaderClick} ref={fileLinkRef}>\n            <FileName newPath={newPath} oldPath={oldPath} status={patchStatus} />\n          </Link>\n        </h3>\n        <CopyToClipboardButton\n          className=\"ml-1 flex-shrink-0\"\n          textToCopy={newPath ?? oldPath ?? ''}\n          ariaLabel=\"Copy file name to clipboard\"\n          tooltipProps={{direction: 's', anchorSide: 'outside-bottom'}}\n          onCopy={onCopyPath}\n          avoidStyledComponent={true}\n          hasPortalTooltip={true}\n        />\n        {fileModeChangedOnly(patchStatus, oldMode, newMode) && (\n          <div className=\"p-2\">\n            <code>{oldMode}</code>\n            <Octicon icon={ArrowRightIcon} sx={{mx: 1}} />\n            <code>{newMode}</code>\n          </div>\n        )}\n        {canExpandOrCollapseLines && onToggleExpandAllLines && (\n          <Tooltip\n            text={areLinesExpanded ? `collapse non diff lines: ${path}` : `expand all lines: ${path}`}\n            direction=\"s\"\n          >\n            <button\n              onClick={onToggleExpandAllLines}\n              className={`Button Button--iconOnly Button--invisible flex-shrink-0 ${\n                areLinesExpanded ? '' : `js-expand-all-difflines-button`\n              }`}\n              aria-label={areLinesExpanded ? `collapse non diff lines: ${path}` : `expand all lines: ${path}`}\n              data-file-path={path}\n            >\n              {areLinesExpanded ? <FoldIcon /> : <UnfoldIcon />}\n            </button>\n          </Tooltip>\n        )}\n      </div>\n      <div className=\"d-flex mr-2 flex-justify-end flex-1\">\n        {linesAdded > 0 && <LinesChangedCounterLabel isAddition>+{linesAdded}</LinesChangedCounterLabel>}\n        {linesDeleted > 0 && <LinesChangedCounterLabel isAddition={false}>-{linesDeleted}</LinesChangedCounterLabel>}\n      </div>\n      {canToggleRichDiff && (\n        <SegmentedControl\n          aria-label=\"File view\"\n          size=\"small\"\n          sx={{mx: 2}}\n          onChange={onToggleDiffDisplay ? index => onToggleDiffDisplay(index === 1) : undefined}\n        >\n          <SegmentedControl.IconButton\n            aria-label=\"Display the source diff\"\n            defaultSelected={!defaultToRichDiff}\n            icon={CodeIcon}\n          />\n          <SegmentedControl.IconButton\n            aria-label=\"Display the rich diff\"\n            defaultSelected={defaultToRichDiff}\n            icon={FileIcon}\n          />\n        </SegmentedControl>\n      )}\n      {rightSideContent}\n    </div>\n  )\n}\n\ntry{ FileName.displayName ||= 'FileName' } catch {}\ntry{ DiffFileHeader.displayName ||= 'DiffFileHeader' } catch {}","/**\n * All possible statuses for a file in a diff. Type 'string' is included to allow for future statuses to be added\n * without breaking the current typing.\n */\nexport type PatchStatus = 'ADDED' | 'CHANGED' | 'COPIED' | 'DELETED' | 'REMOVED' | 'MODIFIED' | 'RENAMED' | string\n\n/**\n * Patch represents data about single file diff. This type mirrors the structure of a Patch in the GraphQL API.\n */\nexport interface Patch {\n  /**\n   * Git status of the patch and the change it represents.\n   */\n  status: PatchStatus\n  /**\n   * Data on the file before the change.\n   */\n  oldTreeEntry?: {mode: number} | null\n  /**\n   * Data on the file after the change.\n   */\n  newTreeEntry?: {mode: number; isGenerated?: boolean} | null\n  /**\n   * Number of lines changed in the file.\n   */\n  linesChanged?: number\n  /**\n   * Reason why the patch was truncated.\n   */\n  truncatedReason?: string | null\n}\n\nfunction hasChanges(patchData: Patch) {\n  return patchData.linesChanged !== undefined && patchData.linesChanged !== 0\n}\n\nexport function fileModeChangedOnly(status: PatchStatus, oldMode?: number, newMode?: number): boolean {\n  return status === 'MODIFIED' && oldMode !== newMode\n}\n\nexport function fileCopiedOnly(patchData: Patch): boolean {\n  return patchData.status === 'COPIED' && !hasChanges(patchData)\n}\n\nexport function fileRenamedOnly(patchData: Patch): boolean {\n  return patchData.status === 'RENAMED' && !hasChanges(patchData)\n}\n\nexport function fileWasDeleted(patchData: Patch): boolean {\n  return !!patchData.oldTreeEntry && patchData.newTreeEntry === null\n}\n\nexport function fileTruncated(patchData: Patch): boolean {\n  return !!patchData.truncatedReason\n}\n\nconst truncationReasonLiterals = ['maximum diff size exceeded.', 'maximum number of lines exceeded.']\nconst maxFilesRexExp = /^maximum file count exceeded/\n\nexport function truncatedReason(reason: string) {\n  let output = reason\n  if (truncationReasonLiterals.includes(reason)) {\n    output =\n      'Sorry, we could not display the changes to this file because there were too many other changes to display.'\n  } else if (maxFilesRexExp.test(reason)) {\n    output = 'Sorry, we could not display the changes to this file because there were too many other files to display.'\n  }\n\n  return output\n}\n\nexport function fileWasGenerated(patch: Patch): boolean {\n  return !!patch.newTreeEntry?.isGenerated\n}\n\nexport function whitespaceChangedOnly(patchData: Patch): boolean {\n  return patchData.linesChanged === 0\n}\n","import type {PatchStatus} from '@github-ui/diff-file-helpers'\n\nexport type SummaryDelta = {\n  readonly path: string\n  readonly pathDigest: string\n}\n\nexport type DiffDelta = SummaryDelta & {\n  readonly changeType: PatchStatus\n  readonly totalCommentsCount?: number\n  readonly totalAnnotationsCount?: number\n}\n\nfunction compareDirectoryNames<T extends SummaryDelta>(a: DirectoryNode<T>, b: DirectoryNode<T>) {\n  return a.name.localeCompare(b.name)\n}\n\nfunction compareFileNames<T extends SummaryDelta>(a: FileNode<T>, b: FileNode<T>) {\n  return a.fileName!.localeCompare(b.fileName!)\n}\n\nfunction getFileDiff<T extends SummaryDelta>(file: FileNode<T>) {\n  return file.diff\n}\n\nexport class FileNode<T extends SummaryDelta> {\n  filePath = this.diff.path\n  #pathParts = this.filePath.split('/')\n  fileName = this.#pathParts[this.#pathParts.length - 1]\n  directoryParts = this.#pathParts.slice(0, this.#pathParts.length - 1)\n\n  constructor(public diff: T) {}\n}\n\nexport class DirectoryNode<T extends SummaryDelta> {\n  directories: Array<DirectoryNode<T>> = []\n  files: Array<FileNode<T>> = []\n\n  #directoriesByName = new Map<string, DirectoryNode<T>>()\n\n  constructor(\n    public name: string,\n    public path: string,\n  ) {}\n\n  getOrCreateDirectory(name: string) {\n    let directory = this.#directoriesByName.get(name)\n\n    if (!directory) {\n      const pathPrefix = this.path ? `${this.path}/` : ''\n      directory = new DirectoryNode(name, `${pathPrefix}${name}`)\n      this.directories.push(directory)\n      this.#directoriesByName.set(name, directory)\n    }\n\n    return directory\n  }\n\n  sort() {\n    this.directories.sort(compareDirectoryNames)\n    this.files.sort(compareFileNames)\n\n    for (const subDirectory of this.directories) {\n      subDirectory.sort()\n    }\n  }\n\n  getOrderedDiffs() {\n    const diffs = this.files.map(getFileDiff)\n\n    for (const subDirectory of this.directories) {\n      diffs.push(...subDirectory.getOrderedDiffs())\n    }\n\n    return diffs\n  }\n}\n\nexport function getFileTree<T extends SummaryDelta>(summaryDeltas: readonly T[]): DirectoryNode<T> {\n  const baseNode = new DirectoryNode<T>('', '')\n  const files = summaryDeltas.map(diff => new FileNode<T>(diff))\n\n  for (const file of files) {\n    let directory = baseNode\n    for (const directoryPath of file.directoryParts) {\n      directory = directory.getOrCreateDirectory(directoryPath)\n    }\n    directory.files.push(file)\n  }\n\n  baseNode.sort()\n  return baseNode\n}\n\nexport function sortDiffEntries<T extends SummaryDelta>(patches: Array<T | null | undefined>): T[] {\n  const filteredPatches = patches.filter((patch): patch is T => !!patch)\n  const fileTree = getFileTree(filteredPatches)\n  return fileTree.getOrderedDiffs()\n}\n","import {FileAddedIcon, FileIcon, FileMovedIcon, FileRemovedIcon} from '@primer/octicons-react'\nimport {Octicon} from '@primer/react'\n\nimport type {PatchStatus} from '@github-ui/diff-file-helpers'\n\nexport function FileStatusIcon({status}: {status: PatchStatus}): JSX.Element {\n  switch (status) {\n    case 'ADDED':\n    case 'COPIED':\n      return <Octicon size={16} icon={FileAddedIcon} className=\"fgColor-success\" />\n    case 'DELETED':\n    case 'REMOVED':\n      return <Octicon size={16} icon={FileRemovedIcon} className=\"fgColor-danger\" />\n    case 'RENAMED':\n      return <Octicon size={16} icon={FileMovedIcon} className=\"fgColor-attention\" />\n    default:\n      return <Octicon size={16} icon={FileIcon} className=\"fgColor-muted\" />\n  }\n}\n\ntry{ FileStatusIcon.displayName ||= 'FileStatusIcon' } catch {}","import {CommentIcon} from '@primer/octicons-react'\nimport React, {memo, useCallback, useEffect} from 'react'\nimport {TreeView} from '@primer/react'\nimport {PortalTooltip} from '@github-ui/portal-tooltip/portalled'\nimport type {DiffDelta, DirectoryNode, FileNode} from './diff-file-tree-helpers'\nimport {parseDiffHash} from '@github-ui/diff-lines/document-hash-helpers'\nimport {getFileTree} from './diff-file-tree-helpers'\nimport {FileStatusIcon} from './FileStatusIcon'\nimport {useFileTreeTooltip} from '@github-ui/use-file-tree-tooltip'\nimport {GlobalCommands} from '@github-ui/ui-commands'\nimport {ssrSafeLocation} from '@github-ui/ssr-utils'\n\ninterface FileProps {\n  file: FileNode<DiffDelta>\n  depth: number\n  onSelect?(file: DiffDelta): void\n  hash: string\n}\n\nconst File = memo(function File({file, depth, hash, onSelect}: FileProps) {\n  const rowRef = React.useRef<HTMLElement>(null)\n  const showTooltip = useFileTreeTooltip({focusRowRef: rowRef, mouseRowRef: rowRef})\n\n  const totalCommentsCount = file.diff.totalCommentsCount ?? 0\n  const totalAnnotationsCount = file.diff.totalAnnotationsCount ?? 0\n  const totalCommentsAndAnnotationsCount = totalCommentsCount + totalAnnotationsCount\n\n  const navigateWindowPanes = useCallback(() => {\n    if (rowRef.current?.tabIndex === 0) {\n      rowRef.current?.focus()\n    }\n  }, [rowRef])\n\n  return (\n    <>\n      <GlobalCommands commands={{'pull-requests-diff-file-tree:focus-file-tree': navigateWindowPanes}} />\n      <TreeView.Item\n        defaultExpanded\n        aria-level={depth}\n        current={file.diff.pathDigest === hash}\n        id={file.diff.path}\n        onSelect={() => onSelect?.(file.diff)}\n        ref={rowRef}\n      >\n        <TreeView.LeadingVisual>\n          <FileStatusIcon status={file.diff.changeType} />\n        </TreeView.LeadingVisual>\n        {file.fileName}\n        {showTooltip && (\n          <PortalTooltip\n            data-testid={`${file.fileName}-item-tooltip`}\n            id={`${file.fileName}-item-tooltip`}\n            contentRef={rowRef}\n            aria-label={file.fileName}\n            open={true}\n            direction=\"ne\"\n          />\n        )}\n        {!!totalCommentsAndAnnotationsCount && (\n          <span className=\"sr-only\">\n            has {totalCommentsAndAnnotationsCount < 10 ? totalCommentsAndAnnotationsCount : '9+'}{' '}\n            {totalCommentsAndAnnotationsCount > 1 ? 'comments' : 'comment'}\n          </span>\n        )}\n        {/* Don't show the unresolved comment and annotation count if it's 0 */}\n        {!!totalCommentsAndAnnotationsCount && (\n          <TreeView.TrailingVisual>\n            <div className=\"d-flex flex-items-center flex-row\">\n              <CommentIcon />\n              <div className=\"ml-1 text-bold fgColor-default f6\">\n                {totalCommentsAndAnnotationsCount < 10 ? totalCommentsAndAnnotationsCount : '9+'}\n              </div>\n            </div>\n          </TreeView.TrailingVisual>\n        )}\n      </TreeView.Item>\n    </>\n  )\n})\n\ninterface DirectoryProps extends Pick<FileProps, 'onSelect'> {\n  directory: DirectoryNode<DiffDelta>\n  depth?: number\n  leadingPath?: string\n}\n\nfunction Directory({directory, depth = 0, leadingPath = '', ...fileProps}: DirectoryProps): JSX.Element {\n  const pathPrefix = leadingPath ? `${leadingPath}/` : ''\n  const [hash, setHash] = React.useState<string>('')\n  const rowRef = React.useRef<HTMLElement | null>(null)\n\n  const onHashChange = useCallback(() => {\n    const windowHash = parseDiffHash(ssrSafeLocation.hash ?? '') ?? ''\n    const hashWithoutPrefix = windowHash.replace('diff-', '')\n    setHash(hashWithoutPrefix)\n  }, [setHash])\n\n  useEffect(() => {\n    window.addEventListener('hashchange', onHashChange)\n\n    return () => {\n      window.removeEventListener('hashchange', onHashChange)\n    }\n  }, [onHashChange])\n\n  // Using listItemRef to fix a bug where two tooltips will stay rendered at the same time\n  const listItemRef = React.useRef<HTMLElement>(null)\n  const showTooltip = useFileTreeTooltip({focusRowRef: listItemRef, mouseRowRef: rowRef})\n\n  const navigateWindowPanes = useCallback(() => {\n    /** Primer uses useRovingTabIndex to manage tabIndex for keyboard navigation\n     *  Because of this, we can use tabIndex === 0 to determine which TreeView.Item to move focus back to.\n     */\n    if (listItemRef.current?.tabIndex === 0) {\n      listItemRef.current?.focus()\n    }\n  }, [listItemRef])\n\n  // collapse this directory if it has no files and only one child directory\n  if (!directory.files.length && directory.directories.length === 1) {\n    return (\n      <>\n        {directory.directories.map(subDirectory => (\n          <Directory\n            key={subDirectory.path}\n            /* Set depth to one for top-level directories that are collapsed so that tree styling is applied correctly */\n            depth={depth === 0 ? 1 : depth}\n            directory={subDirectory}\n            leadingPath={`${pathPrefix}${directory.name}`}\n            {...fileProps}\n          />\n        ))}\n      </>\n    )\n  }\n\n  function renderDirectoryContents() {\n    return (\n      <>\n        {directory.files.map(file => {\n          return <File key={file.filePath} depth={depth + 1} file={file} hash={hash} {...fileProps} />\n        })}\n        {directory.directories.map(dir => {\n          return <Directory key={dir.path} depth={depth + 1} directory={dir} {...fileProps} />\n        })}\n      </>\n    )\n  }\n\n  if (depth === 0) {\n    return renderDirectoryContents()\n  }\n\n  return (\n    <>\n      <GlobalCommands commands={{'pull-requests-diff-file-tree:focus-file-tree': navigateWindowPanes}} />\n      <TreeView.Item ref={listItemRef} key={directory.path} defaultExpanded id={directory.path}>\n        <TreeView.LeadingVisual>\n          <TreeView.DirectoryIcon />\n        </TreeView.LeadingVisual>\n        <span ref={rowRef}>{`${pathPrefix}${directory.name}`}</span>\n        {showTooltip && (\n          <PortalTooltip\n            data-testid={`${directory.name}-directory-item-tooltip`}\n            id={`${directory.name}-directory-item-tooltip`}\n            contentRef={listItemRef}\n            aria-label={`${pathPrefix}${directory.name}`}\n            open={true}\n            direction=\"ne\"\n          />\n        )}\n        <TreeView.SubTree>{renderDirectoryContents()}</TreeView.SubTree>\n      </TreeView.Item>\n    </>\n  )\n}\n\nexport interface DiffFileTreeProps extends Pick<FileProps, 'onSelect'> {\n  diffs: Readonly<Array<Readonly<DiffDelta>>>\n}\n\nexport const DiffFileTree = memo(function FileTree({diffs, ...fileProps}: DiffFileTreeProps) {\n  const fileTree = getFileTree<DiffDelta>(diffs)\n\n  return (\n    <TreeView aria-label=\"File Tree\">\n      <Directory directory={fileTree} {...fileProps} />\n    </TreeView>\n  )\n})\n\ntry{ File.displayName ||= 'File' } catch {}\ntry{ Directory.displayName ||= 'Directory' } catch {}\ntry{ DiffFileTree.displayName ||= 'DiffFileTree' } catch {}","import type {FocusMovementKeys} from '@primer/behaviors'\nimport {FocusKeys} from '@primer/behaviors'\n\nexport const KEY_TO_BIT = {\n  ArrowLeft: FocusKeys.ArrowHorizontal,\n  ArrowDown: FocusKeys.ArrowVertical,\n  ArrowUp: FocusKeys.ArrowVertical,\n  ArrowRight: FocusKeys.ArrowHorizontal,\n  h: FocusKeys.HL,\n  j: FocusKeys.JK,\n  k: FocusKeys.JK,\n  l: FocusKeys.HL,\n  a: FocusKeys.AD,\n  s: FocusKeys.WS,\n  w: FocusKeys.WS,\n  d: FocusKeys.AD,\n  Tab: FocusKeys.Tab,\n  Home: FocusKeys.HomeAndEnd,\n  End: FocusKeys.HomeAndEnd,\n  PageUp: FocusKeys.PageUpDown,\n  PageDown: FocusKeys.PageUpDown,\n  Backspace: FocusKeys.Backspace,\n} as {[k in FocusMovementKeys]: FocusKeys}\n\nexport const GRID_NAV_KEYS = FocusKeys.ArrowAll | FocusKeys.PageUpDown | FocusKeys.HomeAndEnd | FocusKeys.AD\n","export const VALUES = {\n  ghostUser: {\n    displayName: 'Ghost',\n    login: 'ghost',\n    avatarUrl: 'https://avatars.githubusercontent.com/ghost',\n    path: '/ghost',\n    url: '/ghost',\n  },\n}\n","import type {ThreadSummary} from '@github-ui/conversations'\nimport type {Threads, CommentAuthor} from '../types'\n\n/**\n * Returns essential metadata for showing thread info in places like\n * the thread selection menu from the ActionBar\n * @param threads The Threads object from which to retrieve thread metadata\n * @param ghostUser Universal fallback User, preferred to pass down from app payload\n * @returns An array of objects containing thread metadata, including thread ID, author, and comment count\n */\nexport function threadSummary(\n  threadsData: Threads | undefined | null,\n  ghostUser: CommentAuthor | undefined | null,\n): ThreadSummary[] {\n  const lineThreads =\n    threadsData?.threads?.flatMap(thread => {\n      const id = thread?.id\n      const firstAuthor = thread?.commentsData?.comments?.[0]?.author ?? ghostUser\n      const commentCount = thread?.commentsData.totalCount ?? 0\n      const commentsConnectionId = thread?.commentsData?.__id\n      return id && firstAuthor\n        ? [\n            {\n              id,\n              author: firstAuthor,\n              commentCount,\n              commentsConnectionId,\n              diffSide: thread.diffSide,\n              isOutdated: thread.isOutdated,\n              line: thread.line,\n              startLine: thread.startLine,\n              startDiffSide: thread.startDiffSide,\n            },\n          ]\n        : []\n    }) ?? []\n\n  return lineThreads\n}\n","import {lineOrientationFrom} from '@github-ui/diffs/diff-line-helpers'\nimport type {LineRange, ClientDiffLine, DiffLine} from '../types'\nimport {matchLine, isEmptyDiffLine} from './line-helpers'\n\ntype DiffRowSelectedCheckerReturn = {\n  isRowSelected: (line: ClientDiffLine) => boolean\n  selectedLeftLines: ClientDiffLine[]\n  selectedRightLines: ClientDiffLine[]\n}\n\n/**\n * From the line range, get the corresponding difflines from the provided left and right diffLines\n */\nexport default function DiffRowSelectedChecker({\n  selectedDiffRowRange,\n  leftLines,\n  rightLines,\n}: {\n  selectedDiffRowRange: LineRange\n  leftLines: ClientDiffLine[]\n  rightLines?: ClientDiffLine[]\n}): DiffRowSelectedCheckerReturn {\n  const isSplit = !!rightLines\n  const {startOrientation, endOrientation} = selectedDiffRowRange\n\n  // There is no reason to return selected data and run calculations if the selectedDiffRowRange is only on one cell.\n  if (\n    selectedDiffRowRange.startLineNumber === selectedDiffRowRange.endLineNumber &&\n    selectedDiffRowRange.startOrientation === selectedDiffRowRange.endOrientation\n  ) {\n    return {\n      isRowSelected: () => false,\n      selectedRightLines: [],\n      selectedLeftLines: [],\n    }\n  }\n\n  const firstLineIndex = getLines(startOrientation).findIndex(line =>\n    matchLine(line, selectedDiffRowRange.startLineNumber, selectedDiffRowRange.startOrientation),\n  )\n  const lastLineIndex = getLines(endOrientation).findIndex(line =>\n    matchLine(line, selectedDiffRowRange.endLineNumber, selectedDiffRowRange.endOrientation),\n  )\n\n  const canHighlight = firstLineIndex >= 0 && lastLineIndex >= 0\n\n  function isRowSelected(line: ClientDiffLine): boolean {\n    if (!canHighlight || isEmptyDiffLine(line)) return false\n\n    const lineIndex = getLines(lineOrientationFrom(line.type)).indexOf(line)\n\n    // check if the line falls between the start and end highlighting index\n    return lineIndex >= firstLineIndex && lineIndex <= lastLineIndex\n  }\n\n  function getLines(orientation: 'left' | 'right') {\n    return !isSplit || isLeftLine(orientation) ? leftLines : rightLines\n  }\n\n  const selectedLeftLines = getLines('left').filter(line => isRowSelected(line))\n  const selectedRightLines = getLines('right').filter(line => isRowSelected(line))\n\n  return {\n    isRowSelected,\n    selectedRightLines,\n    selectedLeftLines,\n  }\n}\n\nfunction isLeftLine(line: DiffLine): boolean\nfunction isLeftLine(line: 'left' | 'right'): boolean\nfunction isLeftLine(line: DiffLine | 'left' | 'right'): boolean {\n  const orientation = typeof line === 'string' ? line : lineOrientationFrom(line.type)\n  return orientation === 'left'\n}\n","import type {LineRange} from '../types'\n\n/**\n * Detect if location Hash matches a diff anchor with line numbers\n */\nexport function matchHash(hash: string): RegExpMatchArray | null {\n  const diffAnchorMatch = hash.match(/^#?(diff-[a-f0-9]+)(L|R)(\\d+)(?:-(L|R)(\\d+))?$/i)\n  if (diffAnchorMatch != null && diffAnchorMatch.length === 6) {\n    return diffAnchorMatch\n  }\n\n  const discussionAnchorMatch = hash.match(/^#?(discussion-diff-[0-9]+)(L|R)(\\d+)(?:-(L|R)(\\d+))?$/i)\n  if (discussionAnchorMatch != null && discussionAnchorMatch.length === 6) {\n    return discussionAnchorMatch\n  }\n\n  return null\n}\n\nfunction lineHashFragmentFrom(lineNumber: number, orientation: 'left' | 'right'): string {\n  return `${orientation === 'left' ? 'L' : 'R'}${lineNumber}`\n}\n\nexport function parseDiffHash(hash: string): string | undefined {\n  const diffMatch = hash.match(/^#?(diff-[a-f0-9]+)/)\n  return diffMatch?.[1]\n}\n\n/**\n *\n * Check if we're specifying a comment in the hash.\n * This format is defined in\n * [Platform::Models::PullRequestReviewComment#async_current_diff_path_uri](https://github.com/github/github/blob/420ce06f085acf1c9fd9d8948472b3fcca3ba467/packages/pull_requests/app/models/pull_request_review_comment.rb#L571)\n *\n * Basically `#r<database-id>`\n */\nexport function parseCommentHash(hash: string): number | undefined {\n  const resourceMatch = hash.match(/^#?(r\\d+)/)\n  // coerce the match to a number if it exists\n  const commentId = resourceMatch?.[1]\n\n  if (commentId) {\n    return parseInt(commentId.slice(1))\n  } else {\n    return undefined\n  }\n}\n\nexport function parseAnnotationHash(hash: string): number | undefined {\n  const resourceMatch = hash.match(/^#annotation_(\\d+)/)\n  const annotationId = resourceMatch?.[1]\n\n  if (annotationId) {\n    return parseInt(annotationId)\n  } else {\n    return undefined\n  }\n}\n\n/**\n * Returns the LineRange from the given hash\n *\n * @param hash e.g. #diff-146c1d65b0054fb45053c61a749f7cd421c4e62fdce49e86470aa9d7c32052ccR21-R25\n * @returns LineRange | undefined\n */\nexport function parseLineRangeHash(hash: string): LineRange | undefined {\n  const match = matchHash(hash)\n  if (match) {\n    // match[0] is the full match so start at 1\n    const diffAnchor = match[1]\n\n    // start of range\n    const startOrientation = match[2] ? (match[2] === 'L' ? 'left' : 'right') : undefined\n    const startLineNumber = match[3] ? parseInt(match[3]) : undefined\n\n    if (!diffAnchor || !startOrientation || startLineNumber === undefined) return undefined\n\n    // end of range\n    const endOrientation = match[4] ? (match[4] === 'L' ? 'left' : 'right') : undefined\n    const endLineNumber = match[5] ? parseInt(match[5]) : undefined\n\n    return {\n      diffAnchor,\n      startOrientation,\n      startLineNumber,\n      endOrientation: endOrientation ?? startOrientation,\n      endLineNumber: endLineNumber ?? startLineNumber,\n      firstSelectedLineNumber: startLineNumber,\n      firstSelectedOrientation: startOrientation,\n    }\n  }\n}\n\nexport function updateURLHashFromLineRange(lineRange: LineRange) {\n  const newHash = urlHashFromLineRange(lineRange)\n  updateURLHash(newHash)\n}\n\nexport function urlHashFromLineRange(lineRange: LineRange) {\n  const lineStartFragment = lineHashFragmentFrom(lineRange.startLineNumber, lineRange.startOrientation)\n  let newHash = `${lineRange.diffAnchor}${lineStartFragment}`\n  if (\n    lineRange.endLineNumber !== lineRange.startLineNumber ||\n    lineRange.endOrientation !== lineRange.startOrientation\n  ) {\n    const lineEndFragment = lineHashFragmentFrom(lineRange.endLineNumber, lineRange.endOrientation)\n    newHash += `-${lineEndFragment}`\n  }\n\n  return newHash\n}\n\nexport function updateURLHash(hash: string) {\n  const newHash = `#${hash}`\n  if (newHash === window.location.hash) return\n\n  const oldURL = window.location.href\n  history.replaceState({...history.state}, '', newHash)\n  window.dispatchEvent(\n    new HashChangeEvent('hashchange', {\n      newURL: window.location.href,\n      oldURL,\n    }),\n  )\n}\nexport const clearURLHash = () => updateURLHash('')\n","import type {DiffFindRequest, DiffFindResponse} from '../hooks/use-diff-search-results'\nimport type {DiffEntryData} from '../types'\n\nexport interface DiffMatchResult {\n  matchingPathDigest: string\n  diffMatchContent: DiffMatchContent[]\n}\n\nexport interface DiffMatchContent {\n  pathDigest: string\n  indexWithinPathDigest: number\n  matchContent: string\n  column: number\n  diffLineNumIndex: number\n  columnEnd: number\n  text: string\n  leftLineNumber: number\n  rightLineNumber: number\n  isHunk: boolean\n  hunkLineNumber: number\n}\n\nconst SEARCH_RESULT_LIMIT = 200\nexport function findInDiffWorkerJob({data}: {data: DiffFindRequest}): DiffFindResponse {\n  const {query, diffEntryInfo, currentDiffEntryData} = data\n  let output: Map<string, DiffMatchContent[]> = new Map<string, DiffMatchContent[]>()\n\n  // incremental search\n  if (currentDiffEntryData) {\n    output = searchInDiffIncrementally(diffEntryInfo, textMatchable(query), currentDiffEntryData)\n  } else {\n    output = searchInDiffContent(diffEntryInfo, textMatchable(query))\n  }\n\n  return {matchingDiffs: output, query}\n}\n\nexport function searchInDiffIncrementally(\n  diffs: DiffEntryData[],\n  matchable: Matchable,\n  currentDiffEntryData: Map<string, DiffMatchContent[]>,\n): Map<string, DiffMatchContent[]> {\n  if (currentDiffEntryData.size === 0) {\n    // In the incremental search we are narrowing results. If there are no results for a less specific search, there won't be any further matches.\n    return new Map<string, DiffMatchContent[]>()\n  }\n\n  const startedAtResultLimit = currentDiffEntryData.size >= SEARCH_RESULT_LIMIT\n\n  const checkedDiff: Record<number, true> = {}\n  const searchResults = diffs.reduce<Map<string, DiffMatchContent[]>>((output, ref, index) => {\n    if (checkedDiff[index]) {\n      return output\n    }\n\n    checkedDiff[index] = true\n\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    const matches = getMatchGenerator(matchable, [diffs[index]!])\n    let match = matches.next()\n    while (!match.done && output.size < SEARCH_RESULT_LIMIT) {\n      const {resultsWithinDiff} = match.value\n      output.set(diffs[index]?.pathDigest ?? '', resultsWithinDiff)\n      match = matches.next()\n    }\n\n    return output\n  }, new Map<string, DiffMatchContent[]>())\n\n  // Add new results from the raw blob. Note: this is only necessary if we dropped the number\n  // of results below the maximum in the previous phase!\n  if (searchResults.size < SEARCH_RESULT_LIMIT && startedAtResultLimit) {\n    const startFromDiff = searchResults.size\n    const matchesInRawDiff = getMatchGenerator(matchable, diffs, startFromDiff)\n    let match = matchesInRawDiff.next()\n    while (!match.done && searchResults.size < SEARCH_RESULT_LIMIT) {\n      const {resultsWithinDiff, diff} = match.value\n      searchResults.set(diffs[diff]?.pathDigest ?? '', resultsWithinDiff)\n      match = matchesInRawDiff.next()\n    }\n  }\n\n  return searchResults\n}\n\nexport function searchInDiffContent(diffs: DiffEntryData[], m: Matchable): Map<string, DiffMatchContent[]> {\n  const output = new Map<string, DiffMatchContent[]>()\n  const matches = getMatchGenerator(m, diffs)\n  let match = matches.next()\n\n  while (!match.done && output.size < SEARCH_RESULT_LIMIT) {\n    const {resultsWithinDiff, diff} = match.value\n    output.set(diffs[diff]?.pathDigest ?? '', resultsWithinDiff)\n\n    match = matches.next()\n  }\n  return output\n}\n\nenum MatchableType {\n  Text,\n  Symbol,\n}\n\ninterface Matchable {\n  kind: MatchableType\n  regexp: RegExp\n}\n\nfunction textMatchable(query: string) {\n  const escapedQuery = query.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\n  return {\n    kind: MatchableType.Text,\n    regexp: new RegExp(escapedQuery, 'gi'),\n  }\n}\n\n/**\n * Lazy iterator that returns one match at a time\n * @param regex regular expression used for the search\n * @param diffs all of the diff entries currently available\n * @param startFromDiff diff to start at indexed from 0\n */\n\nfunction* getMatchGenerator(regex: Matchable, diffs: DiffEntryData[], startFromDiff = 0) {\n  for (let diff = startFromDiff; diff < diffs.length; diff++) {\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    const currentDiff = diffs[diff]!\n    const resultsWithinDiff = []\n    let indexOfResultWithinDiff = 0\n    for (let diffLineNumIndex = 0; diffLineNumIndex < currentDiff.diffLines.length; diffLineNumIndex++) {\n      let snippet\n      if (diffs[diff]?.diffLines[diffLineNumIndex]?.type === 'HUNK') {\n        snippet = currentDiff.diffLines[diffLineNumIndex]?.text\n      } else {\n        //get rid of the plus or minus\n        snippet = currentDiff.diffLines[diffLineNumIndex]?.text?.substring(1)\n      }\n      const currentDiffLine = currentDiff.diffLines[diffLineNumIndex]\n      let match: RegExpExecArray | null\n\n      while (snippet && (match = regex.regexp.exec(snippet)) !== null) {\n        const matchContent = match[0]\n        const column = match.index\n        resultsWithinDiff.push({\n          pathDigest: currentDiff.pathDigest,\n          indexWithinPathDigest: indexOfResultWithinDiff,\n          matchContent,\n          column,\n          diffLineNumIndex,\n          isHunk: currentDiffLine?.type === 'HUNK' ?? false,\n          hunkLineNumber: currentDiffLine?.blobLineNumber ?? -1,\n          leftLineNumber: currentDiffLine?.type !== 'ADDITION' ? currentDiffLine?.left ?? -1 : -1,\n          rightLineNumber: currentDiffLine?.type !== 'DELETION' ? currentDiffLine?.right ?? -1 : -1,\n          columnEnd: column + matchContent.length,\n          text: snippet,\n        })\n        indexOfResultWithinDiff++\n      }\n    }\n\n    if (resultsWithinDiff.length !== 0) {\n      yield {\n        diff,\n        resultsWithinDiff,\n      }\n    }\n  }\n}\n","import type {ClientDiffLine} from '../types'\nimport {rowIdFrom, cellIdFrom, isEmptyDiffLine} from './line-helpers'\n\nfunction isVerticalNavigation(key: string) {\n  return key === 'ArrowDown' || key === 'ArrowUp'\n}\n\nexport interface GridCell {\n  lineNumber?: number | null\n  orientation?: 'left' | 'right'\n  isEmpty: boolean\n  isHunk: boolean\n  cellId: string\n  columnIndex: number\n}\n\n/**\n * A class that navigates a diff grid. The grid is a 2D array of ids, each of which maps to a cell in the grid.\n */\nexport class GridNavigator {\n  // 2D array that mirrors the structure of the diff grid cells\n  private grid: GridCell[][] = []\n\n  // map each cell to its row and column index in the grid\n  private cellIdToGridLocation: Map<string, [number, number]> = new Map()\n\n  // set tracking the row indexes of all hunk rows\n  private hunkRowIndexes: Set<number> = new Set()\n\n  // the currently focused grid item\n  public focusedGridCell?: GridCell\n\n  // the last grid cell selected\n  public lastSelectedGridCell?: GridCell\n\n  // used to maintain column state when navigating through a hunk row which is only one column\n  private savedColumnIndex?: number\n\n  constructor(\n    private fileAnchor: string,\n    private isSplitDiff: boolean,\n    leftLines: readonly ClientDiffLine[],\n    rightLines?: readonly ClientDiffLine[],\n    initialFocusedGridCellId?: string,\n  ) {\n    this.initializeGrid(leftLines, rightLines)\n    this.focusFirstGridCell(initialFocusedGridCellId)\n  }\n\n  /**\n   * Given a direction, determine what the next focused item's id is\n   *\n   * @param direction indicates the direction to move the focus\n   * @returns either the string id of the next cell to focus\n   */\n  public moveToNextItem(key: string, ctrlKey?: boolean): GridCell | undefined {\n    const indices = this.cellIdToGridLocation.get(this.focusedGridCell?.cellId ?? '')\n    if (!indices) return undefined\n\n    let nextFocusedItem: GridCell | undefined\n    const [currentRowIndex] = indices\n    let [, currentColumnIndex] = indices\n\n    // if we're navigating up or down out a hunk row, restore column index\n    if (isVerticalNavigation(key) && this.isHunkRow(currentRowIndex) && this.savedColumnIndex) {\n      currentColumnIndex = this.savedColumnIndex\n      this.savedColumnIndex = undefined\n    }\n\n    switch (true) {\n      case ctrlKey && key === 'Home': {\n        this.focusFirstGridCell()\n        break\n      }\n      case ctrlKey && key === 'End': {\n        const endRowIndex = this.grid.length - 1\n        const endColumnCellCount = this.grid[endRowIndex]?.length\n        if (endColumnCellCount) {\n          nextFocusedItem = this.grid[endRowIndex]?.[endColumnCellCount - 1]\n        }\n        break\n      }\n      case key === 'ArrowUp':\n        if (this.isHunkRow(currentRowIndex - 1)) {\n          this.saveColumnIndex(currentColumnIndex)\n          nextFocusedItem = this.grid[currentRowIndex - 1]?.[0]\n        } else {\n          nextFocusedItem = this.grid[currentRowIndex - 1]?.[currentColumnIndex]\n        }\n\n        break\n      case key === 'ArrowDown':\n        if (this.isHunkRow(currentRowIndex + 1)) {\n          this.saveColumnIndex(currentColumnIndex)\n          nextFocusedItem = this.grid[currentRowIndex + 1]?.[0]\n        } else {\n          nextFocusedItem = this.grid[currentRowIndex + 1]?.[currentColumnIndex]\n        }\n\n        break\n      case key === 'ArrowLeft':\n        nextFocusedItem = this.grid[currentRowIndex]?.[currentColumnIndex - 1]\n        break\n      case key === 'ArrowRight':\n        nextFocusedItem = this.grid[currentRowIndex]?.[currentColumnIndex + 1]\n        break\n      case key === 'PageUp': {\n        this.saveColumnIndex(currentColumnIndex)\n        const previousHunkRowIndex = this.getPreviousHunkRowIndex(currentRowIndex)\n        nextFocusedItem = this.grid[previousHunkRowIndex]?.[0]\n        break\n      }\n      case key === 'PageDown': {\n        this.saveColumnIndex(currentColumnIndex)\n        let nextHunkRowIndex = this.getNextHunkRowIndex(currentRowIndex)\n        let nextColumnIndex = 0\n\n        // move to the last row of the diff if we're on the last hunk row\n        if (!nextHunkRowIndex) {\n          nextHunkRowIndex = this.grid.length - 1\n          nextColumnIndex = currentColumnIndex\n        }\n\n        nextFocusedItem = this.grid[nextHunkRowIndex]?.[nextColumnIndex]\n        break\n      }\n      case key === 'Home': {\n        nextFocusedItem = this.grid[currentRowIndex]?.[0]\n        break\n      }\n      case key === 'End': {\n        const currentRow = this.grid[currentRowIndex]\n        if (currentRow && !this.isHunkRow(currentRowIndex)) {\n          const lastColumnIndex = currentRow.length - 1\n          nextFocusedItem = this.grid[currentRowIndex]?.[lastColumnIndex]\n        }\n\n        break\n      }\n    }\n\n    // leave the focus on the current item if we didn't find a next item\n    if (nextFocusedItem) this.focusedGridCell = nextFocusedItem\n    return this.focusedGridCell\n  }\n\n  public reinitializeGrid(leftLines: readonly ClientDiffLine[], rightLines?: readonly ClientDiffLine[]) {\n    this.initializeGrid(leftLines, rightLines)\n  }\n\n  public focusFirstGridCell(initialFocusedGridCellId?: string) {\n    if (initialFocusedGridCellId && !!this.cellIdToGridLocation.get(initialFocusedGridCellId)) {\n      this.focusGridCell(initialFocusedGridCellId)\n    } else {\n      this.focusedGridCell = this.grid[0]?.[0]\n    }\n  }\n\n  public focusGridCell(cellId: string) {\n    if (this.focusedGridCell?.cellId === cellId) return\n\n    const indices = this.cellIdToGridLocation.get(cellId)\n    if (!indices) return\n\n    const [rowIndex, columnIndex] = indices\n    this.focusedGridCell = this.grid[rowIndex]?.[columnIndex]\n  }\n\n  /**\n   * Find the next code row and return the code cell id depending on orientation\n   */\n  public getNextSelectableCell(key: 'ArrowUp' | 'ArrowDown'): GridCell | undefined {\n    // Creates a reference GridCell to use as a starting point to grab references to the GridCells in rows below and above it.\n    // The reference GridCell will be defined as\n    // 1. the last selected GridCell (when more than one line is already selected) or\n    // 2. the focused GridCell (when no lines are selected)\n    const referenceGridCell = this.lastSelectedGridCell || this.focusedGridCell\n    const referenceGridCellIndices = this.cellIdToGridLocation.get(referenceGridCell?.cellId ?? '')\n\n    // If unable to find the current cell in the grid, return early\n    if (!referenceGridCellIndices) return\n\n    const [currentRowIndex, currentColumnIndex] = referenceGridCellIndices\n\n    // If we are on the first non-hunk row of code return when selecting previous row\n    if (key === 'ArrowUp' && currentRowIndex <= 1) return\n    // If we are on the last non-hunk row of code return when selecting next row\n    if (key === 'ArrowDown' && currentRowIndex === this.grid.length - 1) return\n\n    let nextSelectableCell: GridCell | undefined\n\n    // look for row that is before current focused row\n    if (key === 'ArrowUp') {\n      let previousRowIndex = currentRowIndex - 1\n\n      while (!nextSelectableCell) {\n        nextSelectableCell = this.getNextSelectableCellFromRow({\n          rowIndex: previousRowIndex,\n          columnIndex: currentColumnIndex,\n        })\n        previousRowIndex--\n      }\n    }\n\n    // look for row that is after current focused row\n    if (key === 'ArrowDown') {\n      let nextRowIndex = currentRowIndex + 1\n\n      while (!nextSelectableCell) {\n        nextSelectableCell = this.getNextSelectableCellFromRow({\n          rowIndex: nextRowIndex,\n          columnIndex: currentColumnIndex,\n        })\n        nextRowIndex++\n      }\n    }\n\n    if (nextSelectableCell) this.lastSelectedGridCell = nextSelectableCell\n\n    return nextSelectableCell\n  }\n\n  /**\n   * Returns a valid selectable GridCell on a diff row if the current GridCell is empty\n   *\n   * returns GridCell from 'right' side of diff, if passed an empty GridCell on 'left' side of diff\n   * returns GridCell from 'left' side of diff, if passed an empty GridCell on 'right' side of diff\n   * returns undefined, if the GridCell passed is a hunk\n   * returns undefined, if the GridCell passed is not empty\n   */\n  public getValidSelectableRowCell(): GridCell | undefined {\n    // return undefined if GridCell is a hunk row, there is no valid selectable columns on hunk row\n    if (this.focusedGridCell?.isHunk) return\n\n    // return GridCell if it's not empty, this is a valid selectable column\n    if (!this.focusedGridCell?.isEmpty) return this.focusedGridCell\n\n    const gridRowIndex = this.cellIdToGridLocation.get(this.focusedGridCell.cellId)?.[0]\n\n    // guard if unable to find the grid row index\n    if (!gridRowIndex) return\n\n    // Check to see if this focused GridCell is on the left hand side of the diff or right hand side of the diff in split view\n    // column indexes 0 and 1 are left hand side and column index 2 and 3 are right hand side\n    return this.focusedGridCell.columnIndex < 2\n      ? this.grid[gridRowIndex]?.[this.focusedGridCell.columnIndex + 2]\n      : this.grid[gridRowIndex]?.[this.focusedGridCell.columnIndex - 2]\n  }\n\n  /**\n   * clears the last known selected cell\n   */\n  public clearLastSelectedCell() {\n    this.lastSelectedGridCell = undefined\n  }\n\n  /**\n   * Finds the first code cell in the grid that isn't empty or a hunk cell\n   *\n   * @returns GridCell\n   */\n  public getFirstCodeCell() {\n    const firstCodeRow = this.grid.find(row => row[0] && !row[0].isHunk)\n    return firstCodeRow?.find(cell => !cell.isEmpty)\n  }\n\n  /**\n   * Finds the last code cell in the grid that isn't empty or a hunk cell\n   *\n   * @returns GridCell\n   */\n  public getLastCodeCell() {\n    const lastCodeRow = this.grid\n      // Slice is used here to make a copy of the grid so that .reverse will not mutate the original grid\n      .slice()\n      .reverse()\n      .find(row => row[0] && !row[0].isHunk)\n    return (\n      lastCodeRow\n        // Slice is used here to make a copy of the grid row so that .reverse will not mutate the original grid row\n        ?.slice()\n        .reverse()\n        .find(cell => !cell.isEmpty)\n    )\n  }\n\n  /**\n   * Returns true if the given line is in the grid\n   */\n  public hasLine(leftLine: ClientDiffLine, rightLine?: ClientDiffLine, isHunk?: boolean): boolean {\n    const rowIdentifier = rowIdFrom(this.fileAnchor, leftLine, rightLine)\n    const cellId = cellIdFrom(rowIdentifier, 0)\n    const indices = this.cellIdToGridLocation.get(cellId)\n    if (!indices) return false\n\n    const [rowIndex] = indices\n    return !!isHunk === this.isHunkRow(rowIndex)\n  }\n\n  private getNextSelectableCellFromRow({rowIndex, columnIndex}: {rowIndex: number; columnIndex: number}) {\n    const nextRow = this.grid[rowIndex]\n    const nextCell = nextRow?.[columnIndex]\n\n    switch (true) {\n      case nextCell?.isHunk:\n        return\n      case nextCell?.orientation === 'left' && nextCell.isEmpty:\n        // return the same type of column type (line number or code) on the right side of the diff\n        return nextRow?.[columnIndex + 2]\n      case nextCell?.orientation === 'right' && nextCell.isEmpty:\n        // return the same type of column type (line number or code) on the left side of the diff\n        return nextRow?.[columnIndex - 2]\n      default:\n        return nextRow?.[columnIndex]\n    }\n  }\n\n  /**\n   * Find the first hunk row after the given row index\n   *\n   * @returns number\n   */\n  private getNextHunkRowIndex(currentRowIndex: number) {\n    const hunkRowIndexes = Array.from(this.hunkRowIndexes).sort((a, b) => a - b)\n    return hunkRowIndexes.find(index => index > currentRowIndex)\n  }\n\n  /**\n   * Find the first hunk row before the given row index\n   */\n  private getPreviousHunkRowIndex(currentRowIndex: number) {\n    const hunkRowIndexes = Array.from(this.hunkRowIndexes).sort((a, b) => a - b)\n    return hunkRowIndexes.reverse().find(index => index < currentRowIndex) ?? 0\n  }\n\n  private initializeGrid(leftLines: readonly ClientDiffLine[], rightLines?: readonly ClientDiffLine[]) {\n    this.grid = []\n    this.cellIdToGridLocation = new Map<string, [number, number]>()\n    this.hunkRowIndexes = new Set<number>()\n\n    for (let rowIndex = 0; rowIndex < leftLines.length; rowIndex++) {\n      // Each row represents a row in the grid.\n      // For split this will be: [number cell, code cell, number cell, code cell]\n      // For unified this will be: [number cell, number cell, code cell]\n      const row: GridCell[] = []\n      const leftLine = leftLines[rowIndex]\n      if (leftLine === undefined) continue\n\n      // the diff is in split mode\n      if (this.isSplitDiff) {\n        const rightLine = (rightLines || [])[rowIndex]\n        const rowIdentifier = rowIdFrom(this.fileAnchor, leftLine, rightLine)\n\n        !isEmptyDiffLine(leftLine) && leftLine.type === 'HUNK'\n          ? this.initializeHunkRow(row, rowIdentifier, rowIndex)\n          : this.initializeSplitDiffCodeRow({leftLine, rightLine, row, rowIdentifier, rowIndex})\n      } else {\n        const rowIdentifier = rowIdFrom(this.fileAnchor, leftLine, leftLine)\n\n        !isEmptyDiffLine(leftLine) && leftLine.type === 'HUNK'\n          ? this.initializeHunkRow(row, rowIdentifier, rowIndex)\n          : this.initializeUnifiedDiffCodeRow({diffLine: leftLine, row, rowIdentifier, rowIndex})\n      }\n\n      this.grid.push(row)\n    }\n  }\n\n  /**\n   * Initialize a diffline row and all its grid data\n   */\n  private initializeContentCell({\n    cellIndex,\n    diffLine,\n    orientation,\n    row,\n    rowIdentifier,\n    rowIndex,\n  }: {\n    cellIndex: number\n    diffLine: ClientDiffLine | undefined\n    orientation: 'left' | 'right'\n    row: GridCell[]\n    rowIdentifier: string\n    rowIndex: number\n  }) {\n    const cellId = cellIdFrom(rowIdentifier, cellIndex)\n    let lineNumber: number | null | undefined\n\n    if (!isEmptyDiffLine(diffLine) && orientation === 'left') lineNumber = diffLine?.left\n    if (!isEmptyDiffLine(diffLine) && orientation === 'right') lineNumber = diffLine?.right\n\n    row.push({\n      lineNumber,\n      orientation,\n      isHunk: false,\n      isEmpty: isEmptyDiffLine(diffLine),\n      cellId: cellIdFrom(rowIdentifier, cellIndex),\n      columnIndex: cellIndex,\n    })\n    this.cellIdToGridLocation.set(cellId, [rowIndex, cellIndex])\n  }\n\n  /**\n   * Initialize a hunk row and all its grid data\n   */\n  private initializeHunkRow(row: GridCell[], rowId: string, rowIndex: number) {\n    // hunk rows are only one cell\n    const cellId = cellIdFrom(rowId, 0)\n    row.push({\n      isHunk: true,\n      isEmpty: false,\n      cellId,\n      columnIndex: 0,\n    })\n    this.cellIdToGridLocation.set(cellId, [rowIndex, 0])\n    this.hunkRowIndexes.add(rowIndex)\n  }\n\n  private isHunkRow(index: number) {\n    return this.hunkRowIndexes.has(index)\n  }\n\n  private initializeSplitDiffCodeRow({\n    leftLine,\n    rightLine,\n    row,\n    rowIdentifier,\n    rowIndex,\n  }: {\n    leftLine: ClientDiffLine | undefined\n    rightLine: ClientDiffLine | undefined\n    row: GridCell[]\n    rowIdentifier: string\n    rowIndex: number\n  }) {\n    this.initializeContentCell({\n      cellIndex: 0,\n      diffLine: leftLine,\n      orientation: 'left',\n      row,\n      rowIdentifier,\n      rowIndex,\n    })\n    this.initializeContentCell({\n      cellIndex: 1,\n      diffLine: leftLine,\n      orientation: 'left',\n      row,\n      rowIdentifier,\n      rowIndex,\n    })\n    this.initializeContentCell({\n      cellIndex: 2,\n      diffLine: rightLine,\n      orientation: 'right',\n      row,\n      rowIdentifier,\n      rowIndex,\n    })\n    this.initializeContentCell({\n      cellIndex: 3,\n      diffLine: rightLine,\n      orientation: 'right',\n      row,\n      rowIdentifier,\n      rowIndex,\n    })\n  }\n\n  private initializeUnifiedDiffCodeRow({\n    diffLine,\n    row,\n    rowIdentifier,\n    rowIndex,\n  }: {\n    diffLine: ClientDiffLine\n    row: GridCell[]\n    rowIdentifier: string\n    rowIndex: number\n  }) {\n    const codeOrientation = !isEmptyDiffLine(diffLine) && diffLine.type === 'DELETION' ? 'left' : 'right'\n    this.initializeContentCell({\n      cellIndex: 0,\n      diffLine,\n      orientation: 'left',\n      row,\n      rowIdentifier,\n      rowIndex,\n    })\n    this.initializeContentCell({\n      cellIndex: 1,\n      diffLine,\n      orientation: 'right',\n      row,\n      rowIdentifier,\n      rowIndex,\n    })\n    this.initializeContentCell({\n      cellIndex: 2,\n      diffLine,\n      orientation: codeOrientation,\n      row,\n      rowIdentifier,\n      rowIndex,\n    })\n  }\n\n  /**\n   * Update the saved column index if we're not on a hunk row\n   */\n  private saveColumnIndex(columnIndex: number) {\n    // don't overwrite the saved column index if we're already on a hunk row.\n    if (!this.isHunkRow(columnIndex)) {\n      this.savedColumnIndex = columnIndex\n    }\n  }\n}\n","import type {DiffLine, ClientDiffLine} from '../types'\nimport {isEmptyDiffLine} from './line-helpers'\n\nexport const HunkHeaderData = {\n  finalLineId: 'final-hunk-header-line',\n}\n\nexport interface HunkData {\n  startBlobLineNumber: number\n  endBlobLineNumber: number\n}\n\n// Used with Array.prototype.sort to ensure that hunks are sorted by 0..n using their startBlobLineNumber value\nfunction orderHunksByBlobLineNumber(hunkA: HunkData, hunkB: HunkData) {\n  return hunkA.startBlobLineNumber - hunkB.startBlobLineNumber\n}\n\nexport function getLineHunkData(\n  line: DiffLine,\n  hunksData: HunkData[],\n): {\n  currentHunk?: HunkData\n  nextHunk?: HunkData\n  previousHunk?: HunkData\n} {\n  const isLastHunkLine = line.type === 'HUNK' && line.__id === HunkHeaderData.finalLineId\n  if (isLastHunkLine) {\n    return {currentHunk: hunksData[hunksData.length - 1], previousHunk: hunksData[hunksData.length - 2]}\n  }\n\n  const currentHunkIdx = hunksData\n    // Hunks data should be sorted when this is called, but this is a fast operation and will ensure that they are never out of order.\n    .sort(orderHunksByBlobLineNumber)\n    .findIndex(\n      hunkData =>\n        hunkData.startBlobLineNumber <= line.blobLineNumber && hunkData.endBlobLineNumber >= line.blobLineNumber,\n    )\n\n  return {\n    currentHunk: hunksData[currentHunkIdx],\n    nextHunk: hunksData[currentHunkIdx + 1],\n    previousHunk: hunksData[currentHunkIdx - 1],\n  }\n}\n\nexport function getDiffHunksData(lines: ClientDiffLine[]): HunkData[] {\n  const hunksData: HunkData[] = []\n  let currentHunkIdx = 0\n\n  // Skip index 1 as that will always be a hunk row\n  for (let idx = 1; idx < lines.length; idx++) {\n    const line = lines[idx]\n    const isLastLine = idx === lines.length - 1\n\n    if (!line) continue\n    if (isEmptyDiffLine(line)) continue\n\n    if (line.type === 'HUNK') {\n      const hunkHeaderLine = lines[currentHunkIdx]\n      if (!hunkHeaderLine || isEmptyDiffLine(hunkHeaderLine)) continue\n      let lastLine\n      let lastLineIdx = idx - 1\n\n      // The last line could be an empty diffline and we want to use the last diffline with a blobLineNumber value.\n      // This will work through the difflines backwards to ensure we get the first valid diffline in sequential order\n      // The guard will ensure that there is a DiffLine and it's not an EmptyDiffLine value\n      while (!lastLine || isEmptyDiffLine(lastLine)) {\n        lastLine = lines[lastLineIdx]\n        lastLineIdx--\n\n        // Break the while loop if we hit a negative index as there are no more difflines left\n        if (lastLineIdx === -1) break\n      }\n\n      if (lastLine && !isEmptyDiffLine(lastLine)) {\n        hunksData.push({\n          startBlobLineNumber: hunkHeaderLine.blobLineNumber,\n          endBlobLineNumber: lastLine.blobLineNumber,\n        })\n      }\n\n      if (line.__id === HunkHeaderData.finalLineId) {\n        hunksData.push({\n          startBlobLineNumber: line.blobLineNumber,\n          endBlobLineNumber: line.blobLineNumber + 20,\n        })\n      }\n\n      currentHunkIdx = idx\n      continue\n    }\n\n    // When we are iterating over the last line and it's not a hunk header row,\n    // we want to return our last hunk data object and use the last line .blobLineNumber as the end blobLineNumber of the hunk data.\n    if (isLastLine) {\n      const hunkHeaderLine = lines[currentHunkIdx]\n      if (hunkHeaderLine && !isEmptyDiffLine(hunkHeaderLine)) {\n        hunksData.push({\n          startBlobLineNumber: hunkHeaderLine.blobLineNumber,\n          endBlobLineNumber: line.blobLineNumber,\n        })\n      }\n    }\n  }\n\n  return hunksData\n}\n","import {lineOrientationFrom} from '@github-ui/diffs/diff-line-helpers'\nimport type {DiffAnchor, DiffLineType, SimpleDiffLine} from '@github-ui/diffs/types'\nimport {isMacOS} from '@github-ui/get-os'\n\nimport type {DiffLine, ClientDiffLine, LineRange, EmptyDiffLine} from '../types'\nimport type {SelectedDiffLines} from '../contexts/SelectedDiffRowRangeContext'\nimport {EMPTY_DIFF_LINE} from '../types'\nimport {urlHashFromLineRange} from './document-hash-helpers'\n\nexport type OutdatedDiffLine = Omit<DiffLine, 'threads' | 'blobLineNumber'>\n\nexport type DiffSide = 'LEFT' | 'RIGHT'\n\nexport function matchLine(\n  line: ClientDiffLine,\n  lineNumber: number | undefined,\n  orientation: 'left' | 'right' | undefined,\n): boolean {\n  switch (orientation) {\n    case 'left':\n      return !isEmptyDiffLine(line) && line.left === lineNumber\n    case 'right':\n    default:\n      return !isEmptyDiffLine(line) && lineOrientationFrom(line.type) === orientation && line.right === lineNumber\n  }\n}\n\n/**\n * Compare a line range to a list of lines. If the start of the range comes after the end, we'll flip it and return\n * a new range with the correct ordering.\n */\nexport function orderLineRange(\n  lineRange: LineRange | undefined,\n  lines: Array<DiffLine | null> | null,\n): LineRange | undefined {\n  if (!lineRange) return undefined\n  if (!lines) return lineRange\n\n  let outOfOrder = false\n  let foundStart = false\n  let foundEnd = false\n  for (const line of lines) {\n    if (!line) continue\n\n    foundStart ||= matchLine(line, lineRange.startLineNumber, lineRange.startOrientation)\n    foundEnd ||= matchLine(line, lineRange.endLineNumber, lineRange.endOrientation)\n    outOfOrder = foundEnd && !foundStart\n    if (outOfOrder || (foundStart && foundEnd)) break\n  }\n\n  if (outOfOrder) {\n    return {\n      ...lineRange,\n      startLineNumber: lineRange.endLineNumber,\n      startOrientation: lineRange.endOrientation,\n      endLineNumber: lineRange.startLineNumber,\n      endOrientation: lineRange.startOrientation,\n      firstSelectedLineNumber: lineRange.endLineNumber,\n    }\n  } else {\n    return lineRange\n  }\n}\n\nexport function rowIdFrom(fileAnchor: string, leftLine: ClientDiffLine, rightLine?: ClientDiffLine) {\n  const leftLinePart = `-${isEmptyDiffLine(leftLine) || typeof leftLine.left !== 'number' ? 'empty' : leftLine.left}`\n  const rightLinePart = rightLine\n    ? `-${isEmptyDiffLine(rightLine) || typeof rightLine.right !== 'number' ? 'empty' : rightLine.right}`\n    : ''\n\n  return `${fileAnchor}${leftLinePart}${rightLinePart}`\n}\n\nexport function cellIdFrom(rowId: string, columnIndex: number) {\n  return `${rowId}-${columnIndex}`\n}\n\nexport function isEmptyDiffLine(diffLine?: ClientDiffLine): diffLine is EmptyDiffLine {\n  return !!diffLine && diffLine === EMPTY_DIFF_LINE\n}\n\nexport function isDiffLine(diffLine?: ClientDiffLine): diffLine is DiffLine {\n  return !!diffLine && diffLine !== EMPTY_DIFF_LINE\n}\n\nexport function isContextDiffLine(diffLine: DiffLine): boolean {\n  return diffLine.type === 'CONTEXT'\n}\n\nexport function trimContentLine(lineHtml: string, lineType: DiffLineType): [lineHtml: string, removedChar?: string] {\n  let charToRemove: string | undefined\n\n  // the lines returned by the server get prepended by a character depending on its type\n  switch (lineType) {\n    case 'ADDITION':\n      charToRemove = '+'\n      break\n    case 'DELETION':\n      charToRemove = '-'\n      break\n    case 'CONTEXT':\n    case 'INJECTED_CONTEXT':\n      charToRemove = ' '\n      break\n  }\n\n  if (!charToRemove || !lineHtml.startsWith(charToRemove)) return [lineHtml, undefined]\n\n  const removedChar = lineHtml[0]\n  const newHtml = lineHtml.substring(1)\n  return [newHtml, removedChar]\n}\n\nexport function groupDiffLines(lines: DiffLine[]): {\n  leftLines: ClientDiffLine[]\n  rightLines: ClientDiffLine[]\n} {\n  const leftLines: ClientDiffLine[] = []\n  const rightLines: ClientDiffLine[] = []\n\n  // Keep list of lines even, filling in blanks as needed\n  const fillBlanks = () => {\n    while (leftLines.length < rightLines.length) {\n      leftLines.push(EMPTY_DIFF_LINE)\n    }\n\n    while (rightLines.length < leftLines.length) {\n      rightLines.push(EMPTY_DIFF_LINE)\n    }\n  }\n\n  for (const line of lines) {\n    switch (line.type) {\n      case 'ADDITION':\n        rightLines.push(line)\n        break\n      case 'DELETION':\n        leftLines.push(line)\n        break\n      case 'CONTEXT':\n      case 'INJECTED_CONTEXT':\n      case 'HUNK':\n        fillBlanks()\n        leftLines.push(line)\n        rightLines.push(line)\n    }\n  }\n\n  fillBlanks()\n\n  return {leftLines, rightLines}\n}\n\nexport function parseHtml(html: string) {\n  return new DOMParser().parseFromString(html, 'text/html').documentElement.textContent || ''\n}\n\nexport function isLeftLine(line: SimpleDiffLine) {\n  const leftLineTypes = ['HUNK', 'CONTEXT', 'INJECTED_CONTEXT', 'DELETION']\n\n  return leftLineTypes.includes(line.type)\n}\n\nexport function urlHashFromLine(line: SimpleDiffLine, fileAnchor: string): string | undefined {\n  const leftLine = isLeftLine(line)\n  const lineNumber = leftLine ? line.left : line.right\n  const orientation = leftLine ? 'left' : 'right'\n\n  if (lineNumber !== null) {\n    return urlHashFromLineRange({\n      diffAnchor: fileAnchor,\n      endLineNumber: lineNumber,\n      endOrientation: orientation,\n      startLineNumber: lineNumber,\n      startOrientation: orientation,\n      firstSelectedLineNumber: lineNumber,\n      firstSelectedOrientation: orientation,\n    })\n  }\n\n  return\n}\n\n// Get the link for a line or a selected range of lines\nexport function anchorLinkForSelection({\n  line,\n  range,\n  fileAnchor,\n}: {\n  line?: SimpleDiffLine\n  range?: LineRange\n  fileAnchor: DiffAnchor\n}): string | undefined {\n  const {origin, pathname} = window.location\n  let hash\n  if (range) {\n    hash = urlHashFromLineRange(range)\n  } else if (line) {\n    hash = urlHashFromLine(line, fileAnchor)\n  }\n\n  if (!hash) return\n\n  return `${origin}${pathname}#${hash}`\n}\n\nexport type KeyboardShortcutArgs = {\n  includeControlKey?: boolean\n  includeShiftKey?: boolean\n  includeOptionKey?: boolean\n  key: string\n}\n\n/**\n * Returns a string representing a keyboard shortcut, including the Control key by default. Adds formatting for specific OS (MacOS vs Windows) so it looks a little nicer.\n * @param includeControlKey Whether to include the Control key in the shortcut string. Defaults to true.\n * @param includeShiftKey Whether to include the Shift key in the shortcut string. Defaults to false.\n * @param includeOptionKey Whether to include the Option key in the shortcut string. Defaults to false.\n * @param key The key to include in the shortcut string.\n */\nexport function getKeyboardShortcutString({\n  includeControlKey = true,\n  includeShiftKey,\n  includeOptionKey,\n  key,\n}: KeyboardShortcutArgs) {\n  let str = includeControlKey ? `${isMacOS() ? '' : 'Ctrl + '}` : ''\n  if (includeOptionKey) str += `${isMacOS() ? '' : 'Alt + '}`\n  if (includeShiftKey) str += `${isMacOS() ? '' : 'Shift + '}`\n  str += key\n  return str\n}\n\n/**\n * Returns a string representing the pixel width of a gutter to account for the CommentIndicator and ActionBar components to render without overlapping over the code content.\n * This will default to 96px if there is a thread count of 1 or more.\n * This does not account for number of author avatars, but will render the necessary amount of space for 3 avatar icons stacked in the CommentIndicator and ActionBar components.\n * @param hasThreads A boolean that indicates if the diff line has any associated threads.\n */\nexport function calculateDiffLineCodeCellGutter({hasThreads}: {hasThreads: boolean}) {\n  return hasThreads ? '96px' : '30px'\n}\n\n/**\n * Returns a string representing the right positioning pixel value of the line's comment indicator.\n * @param shouldAlignRight A boolean that indicates if a diff line should show the marker to the very right\n * e.g. if it has an associated draft comment or if the user is unable to comment on that line,\n * which happens for annotations on unchanged lines\n */\nexport function calculateCommentIndicatorRightPositioning({shouldAlignRight}: {shouldAlignRight: boolean}) {\n  return shouldAlignRight ? '11px' : '40px'\n}\n\n/**\n * Returns a string representing a valid aria-keyshortcuts value, including OS specific keys.\n * @param includeControlKey Whether to include the Control key in the shortcut string. Defaults to true.\n * @param includeShiftKey Whether to include the Shift key in the shortcut string. Defaults to false.\n * @param includeOptionKey Whether to include the Option key in the shortcut string. Defaults to false.\n * @param key The key to include in the shortcut string.\n */\nexport function getAriaKeyShortcutString({\n  includeControlKey = true,\n  includeShiftKey,\n  includeOptionKey,\n  key,\n}: KeyboardShortcutArgs) {\n  let str = ''\n  if (includeControlKey) str += isMacOS() ? 'Command+' : 'Control+'\n  if (includeOptionKey) str += isMacOS() ? 'Option+' : 'Alt+'\n  if (includeShiftKey) str += 'Shift+'\n  str += key\n  return str\n}\n\nconst LINE_TYPES_SUPPORTING_COMMENTS = ['ADDITION', 'DELETION', 'CONTEXT']\n\n/**\n * Detemines if the given diff line supports commenting. If the diff line is part of the current selected\n * range then all lines must be commentable for the diff line to be displayed as commentable.\n * @param diffLine The current diff line being rendered\n * @param selectedDiffLines The left and right diff lines that are currently selected, if any\n */\nexport const lineAcceptsComments = (\n  diffLine: ClientDiffLine | undefined,\n  selectedDiffLines: SelectedDiffLines,\n): boolean => {\n  if (!diffLine) return false\n\n  const selectedLines = selectedDiffLines.leftLines.concat(selectedDiffLines.rightLines)\n  if (selectedLines.length > 0 && selectedLines.includes(diffLine)) {\n    // current line is within selected range - are all lines commentable?\n    return selectedLines.every(line => {\n      return !isEmptyDiffLine(line) && LINE_TYPES_SUPPORTING_COMMENTS.includes(line.type)\n    })\n  } else {\n    // selection not applicable - does this line alone support commenting?\n    return !isEmptyDiffLine(diffLine) && LINE_TYPES_SUPPORTING_COMMENTS.includes(diffLine.type)\n  }\n}\n\n/**\n * Returns the text content from the given diffLines as a single string\n */\nexport const getContentFromLines = (lines?: ClientDiffLine[]): string => {\n  if (!lines) return ''\n  const content = lines\n    .filter((line): line is DiffLine => !isEmptyDiffLine(line))\n    .map(line => {\n      const parsedContent = parseHtml(line.html)\n      const [trimmedContent] = trimContentLine(parsedContent, line.type)\n      return trimmedContent\n    })\n\n  return content.join('\\n')\n}\n","export function notEmpty<TValue>(value: TValue | null | undefined): value is TValue {\n  return value !== null && value !== undefined\n}\n","export function overlayContainsEventTarget(eventTarget: Node) {\n  const primerPortalRoot = document.getElementById('__primerPortalRoot__')\n  if (!primerPortalRoot || !eventTarget) return false\n\n  return primerPortalRoot.contains(eventTarget)\n}\n","import type {RefObject} from 'react'\nimport {useCallback, useMemo, useState} from 'react'\n\nimport {useMarkersDialogContext} from '../contexts/MarkersDialogContext'\nimport type {DiffSide} from '../types'\nimport type {DiffAnnotation, ThreadSummary} from '@github-ui/conversations'\nimport {useSelectedDiffRowRangeContext} from '../contexts/SelectedDiffRowRangeContext'\nimport {useDiffLineContext} from '../contexts/DiffLineContext'\nimport {useStableCallback} from './use-stable-callback'\nimport {useAnalytics} from '@github-ui/use-analytics'\n\ntype ActionBarDialogs = {\n  // New conversation\n  isNewConversationDialogOpen: boolean\n  startNewConversation: () => void\n  startNewConversationWithSuggestedChange: () => void\n  startNewConversationFromActionBarWithSuggestedChange: () => void\n  startNewConversationFromActionBar: () => void\n  closeNewConversationDialog: () => void\n  shouldStartNewConversationWithSuggestedChange: boolean | undefined\n\n  // Context menus\n  isContextMenuOpen: boolean\n  openContextMenu: () => void\n  openContextMenuFromActionBar: () => void\n  closeContextMenu: () => void\n  toggleContextMenu: () => void\n  toggleContextMenuFromActionBar: () => void\n\n  // view conversation details\n  optimizedSelectedThreadId: string | undefined\n  optimizedSelectedAnnotationId: string | undefined\n  selectThread: (threadId: string, opts?: {skipLineSelection?: boolean}) => void\n  selectAnnotation: (annotationId: string, opts?: {skipLineSelection?: boolean}) => void\n  openMarkerDetailsDialog: () => void\n  closeConversationDetailsDialog: () => void\n\n  // view conversation list\n  isMarkerListDialogOpen: boolean\n  openMarkerListDialog: () => void\n  closeMarkerListDialog: () => void\n\n  // interaction between list and details\n  openMarkerOrListDialogFromActionBar: () => void\n  openMarkerOrListDialog: (side?: DiffSide) => void\n\n  // Misc\n  annotations: DiffAnnotation[]\n  returnFocusRef: RefObject<HTMLElement>\n  threads: ThreadSummary[]\n  threadConnectionId?: string\n  anyMenuOpen: boolean\n}\n\nexport function useActionBarDialogs({\n  cellId,\n  actionBarRef,\n}: {\n  cellId?: string\n  actionBarRef: RefObject<HTMLElement>\n}): ActionBarDialogs {\n  const {replaceSelectedDiffRowRange} = useSelectedDiffRowRangeContext()\n  const {fileAnchor} = useDiffLineContext()\n\n  const [returnFocusRef, setReturnFocusRef] = useState<RefObject<HTMLElement>>(actionBarRef)\n  const {\n    annotations,\n    openDialog,\n    closeDialog,\n    selectedAnnotationId,\n    selectAnnotationId,\n    selectedThreadId,\n    selectThreadId,\n    openContextMenuCell,\n    openNewConversationCell,\n    openMarkerDetailsCell,\n    openMarkersListCell,\n    updateVisibleThreads,\n    threads,\n    threadConnectionId,\n    anyMenuOpen,\n  } = useMarkersDialogContext()\n\n  const {sendAnalyticsEvent} = useAnalytics()\n\n  const isNewConversationDialogOpen = useMemo(\n    () => openNewConversationCell?.cellId === cellId,\n    [cellId, openNewConversationCell],\n  )\n\n  const shouldStartNewConversationWithSuggestedChange = useMemo(\n    () => openNewConversationCell?.withSuggestedChange,\n    [openNewConversationCell],\n  )\n\n  // Internal\n  const openNewConversationDialog = useCallback(\n    (opts?: {withSuggestedChange?: boolean}) => {\n      openDialog('new-conversation', cellId, opts)\n    },\n    [cellId, openDialog],\n  )\n\n  const startNewConversation = useCallback(() => {\n    openNewConversationDialog()\n  }, [openNewConversationDialog])\n\n  const startNewConversationFromActionBar = useCallback(() => {\n    setReturnFocusRef(actionBarRef)\n    openNewConversationDialog()\n    sendAnalyticsEvent('diff.start_new_conversation', 'PLUS_ICON')\n  }, [actionBarRef, openNewConversationDialog, sendAnalyticsEvent])\n\n  const startNewConversationWithSuggestedChange = useCallback(() => {\n    openNewConversationDialog({withSuggestedChange: true})\n    sendAnalyticsEvent('diff.start_new_conversation_with_suggested_change', 'CELL_CONTEXT_MENU')\n  }, [openNewConversationDialog, sendAnalyticsEvent])\n\n  const startNewConversationFromActionBarWithSuggestedChange = useCallback(() => {\n    setReturnFocusRef(actionBarRef)\n    openNewConversationDialog({withSuggestedChange: true})\n    sendAnalyticsEvent('diff.start_new_conversation_with_suggested_change', 'ACTION_BAR_CONTEXT_MENU')\n  }, [actionBarRef, openNewConversationDialog, sendAnalyticsEvent])\n\n  const closeNewConversationDialog = useCallback(() => {\n    closeDialog('new-conversation')\n  }, [closeDialog])\n\n  // Context menus\n  const isContextMenuOpen = useMemo(() => openContextMenuCell === cellId, [cellId, openContextMenuCell])\n\n  const openContextMenu = useCallback(() => {\n    openDialog('context-menu', cellId)\n  }, [cellId, openDialog])\n\n  const openContextMenuFromActionBar = useCallback(() => {\n    setReturnFocusRef(actionBarRef)\n    openContextMenu()\n  }, [actionBarRef, openContextMenu])\n\n  const closeContextMenu = useCallback(() => {\n    closeDialog('context-menu')\n  }, [closeDialog])\n\n  const toggleContextMenu = useCallback(() => {\n    isContextMenuOpen ? closeContextMenu() : openContextMenu()\n  }, [closeContextMenu, isContextMenuOpen, openContextMenu])\n\n  const toggleContextMenuFromActionBar = useCallback(() => {\n    setReturnFocusRef(actionBarRef)\n    toggleContextMenu()\n  }, [actionBarRef, toggleContextMenu])\n\n  // Viewing conversation details\n\n  // Only pass the selected thread if the cell is open to prevent unnecessary re-renders\n  const optimizedSelectedThreadId = useMemo(\n    () => (openMarkerDetailsCell === cellId ? selectedThreadId : undefined),\n    [cellId, openMarkerDetailsCell, selectedThreadId],\n  )\n\n  // Only pass the selected annotation if the cell is open to prevent unnecessary re-renders\n  const optimizedSelectedAnnotationId = useMemo(\n    () => (openMarkerDetailsCell === cellId ? selectedAnnotationId : undefined),\n    [cellId, openMarkerDetailsCell, selectedAnnotationId],\n  )\n\n  const openMarkerDetailsDialog = useCallback(() => {\n    openDialog('marker-details', cellId)\n  }, [cellId, openDialog])\n\n  const closeConversationDetailsDialog = useCallback(() => {\n    closeDialog('marker-details')\n  }, [closeDialog])\n\n  const selectThread = useStableCallback(\n    (threadId: string, opts: {skipLineSelection?: boolean} = {skipLineSelection: false}) => {\n      selectThreadId(threadId)\n      openMarkerDetailsDialog()\n\n      if (opts.skipLineSelection) return\n\n      // select the line(s) the comment was made on\n      const thread = threads.find(t => t.id === threadId)\n      if (thread && thread.diffSide && thread.line) {\n        const startLine = thread.startLine ?? thread.line\n        const startDiffSide = thread.startDiffSide ?? thread.diffSide\n        replaceSelectedDiffRowRange({\n          diffAnchor: fileAnchor,\n          endLineNumber: thread.line,\n          endOrientation: thread.diffSide === 'LEFT' ? 'left' : 'right',\n          startLineNumber: startLine,\n          startOrientation: startDiffSide === 'LEFT' ? 'left' : 'right',\n          firstSelectedLineNumber: startLine,\n          firstSelectedOrientation: startDiffSide === 'LEFT' ? 'left' : 'right',\n        })\n      }\n    },\n  )\n\n  const selectAnnotation = useStableCallback(\n    (annotationId: string, opts: {skipLineSelection?: boolean} = {skipLineSelection: false}) => {\n      selectAnnotationId(annotationId)\n      openMarkerDetailsDialog()\n\n      if (opts.skipLineSelection) return\n\n      // select the line(s) the annotation was made on\n      const annotation = annotations.find(a => a.id === annotationId)\n      if (annotation) {\n        replaceSelectedDiffRowRange({\n          diffAnchor: fileAnchor,\n          endLineNumber: annotation.location.end.line,\n          endOrientation: 'right',\n          startLineNumber: annotation.location.start.line,\n          startOrientation: 'right',\n          firstSelectedLineNumber: annotation.location.start.line,\n          firstSelectedOrientation: 'right',\n        })\n      }\n    },\n  )\n\n  // Viewing the conversation list\n  const openMarkerListDialog = useCallback(() => {\n    openDialog('marker-list', cellId)\n  }, [cellId, openDialog])\n\n  const closeMarkerListDialog = useCallback(() => {\n    closeDialog('marker-list')\n  }, [closeDialog])\n\n  // Interaction between conversation list and conversation details\n  const openConversationOrList = useCallback(\n    (diffSide?: DiffSide) => {\n      const newThreads = updateVisibleThreads(diffSide)\n      if (!newThreads?.length && !annotations.length) return\n\n      const firstThread = newThreads && newThreads[0]\n      const isOnlyThread = newThreads && newThreads.length === 1 && firstThread && !annotations.length\n      const firstAnnotation = annotations[0]\n      const isOnlyAnnotation = annotations.length === 1 && firstAnnotation && !newThreads?.length\n\n      if (isOnlyThread) {\n        selectThread(firstThread.id)\n      } else if (isOnlyAnnotation) {\n        selectAnnotation(firstAnnotation.id)\n      } else {\n        openMarkerListDialog()\n      }\n    },\n    [annotations, openMarkerListDialog, selectAnnotation, selectThread, updateVisibleThreads],\n  )\n\n  const openMarkerOrListDialogFromActionBar = useCallback(\n    (diffSide?: DiffSide) => {\n      openConversationOrList(diffSide)\n      setReturnFocusRef(actionBarRef)\n    },\n    [actionBarRef, openConversationOrList],\n  )\n\n  const openMarkerOrListDialog = useCallback(\n    (diffSide?: DiffSide) => {\n      openConversationOrList(diffSide)\n    },\n    [openConversationOrList],\n  )\n\n  return {\n    // New conversation\n    isNewConversationDialogOpen,\n    startNewConversation,\n    startNewConversationFromActionBar,\n    closeNewConversationDialog,\n    startNewConversationWithSuggestedChange,\n    startNewConversationFromActionBarWithSuggestedChange,\n    shouldStartNewConversationWithSuggestedChange,\n\n    // Context menus\n    isContextMenuOpen,\n    openContextMenu,\n    openContextMenuFromActionBar,\n    closeContextMenu,\n    toggleContextMenu,\n    toggleContextMenuFromActionBar,\n\n    // view conversation details\n    optimizedSelectedThreadId,\n    optimizedSelectedAnnotationId,\n    selectThread,\n    selectAnnotation,\n    openMarkerDetailsDialog,\n    closeConversationDetailsDialog,\n\n    // view conversation list\n    isMarkerListDialogOpen: openMarkersListCell === cellId,\n    openMarkerListDialog,\n    closeMarkerListDialog,\n\n    // interaction between list and details\n    openMarkerOrListDialogFromActionBar,\n    openMarkerOrListDialog,\n\n    annotations,\n    returnFocusRef,\n    threadConnectionId,\n    threads,\n    anyMenuOpen,\n  }\n}\n","import type {RefObject} from 'react'\nimport {useCallback, useState} from 'react'\n\nimport {useMarkersDialogContext} from '../contexts/MarkersDialogContext'\nimport {isGridNavigationKey} from './use-grid-navigation'\n\ntype ActionBarFocus = {\n  isActionBarFocused: boolean\n  handleCellBlur: (event: React.FocusEvent) => void\n  handleCellFocus: () => void\n  handleCellMouseEnter: () => void\n  handleCellMouseLeave: () => void\n  handleActionBarBlur: (event: React.FocusEvent) => void\n  handleActionBarFocusCapture: (event: React.FocusEvent) => void\n  handleActionBarKeydownCapture: (event: React.KeyboardEvent) => void\n}\n\nexport function useActionBarFocus({cellRef}: {cellRef: RefObject<HTMLTableCellElement>}): ActionBarFocus {\n  const {showActionBar, hideActionBar, anyMenuOpen} = useMarkersDialogContext()\n  const [isActionBarFocused, setIsActionBarFocused] = useState(false)\n\n  const handleCellFocus = useCallback(() => {\n    showActionBar()\n  }, [showActionBar])\n\n  const handleCellBlur = useCallback(\n    (event: React.FocusEvent) => {\n      if (anyMenuOpen) return\n      if (cellRef.current && cellRef.current.contains(event.relatedTarget)) return\n      hideActionBar()\n    },\n    [anyMenuOpen, cellRef, hideActionBar],\n  )\n\n  const handleCellMouseEnter = useCallback(() => {\n    showActionBar()\n  }, [showActionBar])\n\n  const handleCellMouseLeave = useCallback(() => {\n    if (anyMenuOpen) return\n    if (cellRef.current === document.activeElement || cellRef.current?.contains(document.activeElement)) return\n    hideActionBar()\n  }, [anyMenuOpen, cellRef, hideActionBar])\n\n  const handleActionBarBlur = useCallback(\n    (e: React.FocusEvent) => {\n      if (cellRef.current) {\n        if (anyMenuOpen) return\n        if (!cellRef.current.contains(e.relatedTarget)) {\n          hideActionBar()\n          setIsActionBarFocused(false)\n        } else if (cellRef.current === e.relatedTarget) {\n          // if the user shift-tabs back into the cell, we want to keep the action bar visible\n          // but we want to `aria-hide` it again to avoid reading out its content\n          setIsActionBarFocused(false)\n        }\n      }\n    },\n    [anyMenuOpen, cellRef, hideActionBar],\n  )\n\n  const handleActionBarFocusCapture = useCallback(\n    (e: React.FocusEvent) => {\n      if (anyMenuOpen) return\n      e.stopPropagation()\n      setIsActionBarFocused(true)\n    },\n    [anyMenuOpen],\n  )\n\n  const handleActionBarKeydownCapture = useCallback(\n    (e: React.KeyboardEvent) => {\n      if (anyMenuOpen) return\n      // prevent focus zone from processing keystrokes on the button, since we want it to behave like it's not in the grid\n      // eslint-disable-next-line @github-ui/ui-commands/no-manual-shortcut-logic\n      if (isGridNavigationKey(e.key)) {\n        e.stopPropagation()\n      }\n    },\n    [anyMenuOpen],\n  )\n\n  return {\n    isActionBarFocused,\n    handleCellBlur,\n    handleCellFocus,\n    handleCellMouseEnter,\n    handleCellMouseLeave,\n    handleActionBarBlur,\n    handleActionBarFocusCapture,\n    handleActionBarKeydownCapture,\n  }\n}\n","import {WebWorker} from '@github-ui/code-view-shared/utilities/web-worker'\nimport React, {useEffect, useRef, useState} from 'react'\nimport {DebouncedWorkerManager} from '@github-ui/code-view-shared/worker-jobs/debounced-worker-manager'\n\nimport type {DiffEntryData} from '../types'\nimport {findInDiffWorkerJob, type DiffMatchContent} from '../helpers/find-in-diff'\n\nexport interface DiffFindRequest {\n  query: string\n  diffEntryInfo: DiffEntryData[]\n  currentDiffEntryData: Map<string, DiffMatchContent[]> | undefined\n}\n\nexport const emptyFocusedSearchResult = {\n  pathDigest: '',\n  indexWithinDigest: 0,\n}\nexport interface DiffFindResponse {\n  matchingDiffs: Map<string, DiffMatchContent[]>\n  query: string\n}\nexport interface FocusedSearchResult {\n  pathDigest: string\n  indexWithinDigest: number\n  isCurrentDigest?: boolean\n}\nexport type SearchInFileStatus = 'pending' | 'done'\n\nexport function useDiffSearchResults(\n  diffInfo: DiffEntryData[] | undefined,\n  searchTerm: string,\n  findInDiffWorkerPath: string,\n  redoSearchResults: object,\n) {\n  const [searchResults, setSearchResults] = useState<Map<string, DiffMatchContent[]>>(\n    new Map<string, DiffMatchContent[]>(),\n  )\n  const [focusedSearchResult, setFocusedSearchResult] = useState<FocusedSearchResult | undefined>(undefined)\n  const [currentIndex, setCurrentIndex] = useState(0)\n  const workerManagerRef = React.useRef<DebouncedWorkerManager<DiffFindRequest, DiffFindResponse>>()\n  //TODO: figure out how to detect a soft nav has happened to redo the search on the new page if necessary\n\n  if (!workerManagerRef.current && searchTerm) {\n    workerManagerRef.current = new DebouncedWorkerManager<DiffFindRequest, DiffFindResponse>(\n      new WebWorker(findInDiffWorkerPath, findInDiffWorkerJob),\n      200, // Disable debounce, since we do incremental searching anyway so it's ultra fast\n      (req: DiffFindRequest) => req.query.length !== 1,\n    )\n  }\n\n  // Search term ref is used in the worker `onResponse` callback to avoid changing callback on every search term change.\n  const searchTermRef = useRef(searchTerm)\n  searchTermRef.current = searchTerm\n  const lastSearchTerm = useRef('')\n\n  useEffect(() => {\n    return function destroy() {\n      workerManagerRef.current?.terminate()\n    }\n  }, [])\n\n  const lastDiffEntryData = useRef<DiffEntryData[] | undefined>([])\n  if (workerManagerRef.current && diffInfo !== lastDiffEntryData.current) {\n    workerManagerRef.current.onResponse = (data: DiffFindResponse) => {\n      if (data.query === searchTermRef.current) {\n        setSearchResults(data.matchingDiffs)\n        lastSearchTerm.current = searchTermRef.current\n      }\n    }\n\n    lastDiffEntryData.current = diffInfo\n  }\n\n  //this effect re-searches for the previous search term when the ref changes - it wipes out all saved progress because\n  //anything could have changed during the swap between refs\n  useEffect(() => {\n    if (!diffInfo || !workerManagerRef.current || !lastSearchTerm.current || lastSearchTerm.current === '') {\n      //reset everything because we changed refs\n      setSearchResults(new Map<string, DiffMatchContent[]>())\n      setFocusedSearchResult(undefined)\n      return\n    }\n    setSearchResults(new Map<string, DiffMatchContent[]>())\n    setFocusedSearchResult(undefined)\n    workerManagerRef.current.post({\n      query: lastSearchTerm.current,\n      diffEntryInfo: diffInfo,\n      currentDiffEntryData: undefined,\n    })\n    // We only want to trigger an update when the ref changes, aka the user is on a new branch or commit, or when\n    //they navigate to a new file (path). If they are navigating using the symbols navigation, we want to redo the\n    //search for that symbol within the new file as well\n\n    //TODO: figure out how to trigger the refreshed search on soft navs\n  }, [diffInfo?.length, diffInfo])\n\n  useEffect(() => {\n    if (!diffInfo || !workerManagerRef.current) {\n      return\n    }\n    if (searchTerm === '') {\n      setSearchResults(new Map<string, DiffMatchContent[]>())\n      setFocusedSearchResult(undefined)\n      setCurrentIndex(0)\n      lastSearchTerm.current = ''\n    } else if (!validSearchTerm(searchTerm)) {\n      return\n    } else {\n      const canDoIncrementalSearch = lastSearchTerm.current.length > 0 && searchTerm.startsWith(lastSearchTerm.current)\n      workerManagerRef.current.post({\n        query: searchTerm,\n        diffEntryInfo: diffInfo,\n        currentDiffEntryData: canDoIncrementalSearch ? searchResults : undefined,\n      })\n      setCurrentIndex(0)\n    }\n\n    // We only want to trigger an update when the search term changes or when context lines are added\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [searchTerm, redoSearchResults])\n\n  return {\n    focusedSearchResult,\n    setFocusedSearchResult,\n    searchResults,\n    currentIndex,\n    setCurrentIndex,\n  }\n}\n\nfunction validSearchTerm(searchTerm: string) {\n  return searchTerm.length > 0 && searchTerm.length <= 1000\n}\n","import {useDiffContext} from '../contexts/DiffContext'\nimport {useDiffLineContext} from '../contexts/DiffLineContext'\n\nexport default function useExpandHunk(): {\n  expandStartOfHunk: () => void\n  expandEndOfHunk: () => void\n  expandEndOfPreviousHunk: () => void\n  canExpandStartOfHunk: boolean\n  canExpandEndOfHunk: boolean\n} {\n  const {nextHunk, currentHunk, previousHunk} = useDiffLineContext()\n  const {addInjectedContextLines} = useDiffContext()\n  const MAX_REQUEST_LINE_LIMIT = 20\n  const canExpandStartOfHunk = currentHunk && currentHunk.startBlobLineNumber !== 0 ? true : false\n  const canExpandEndOfHunk = currentHunk && !!nextHunk ? true : false\n\n  const expandStartOfHunk = () => {\n    if (!canExpandStartOfHunk || !currentHunk) return\n    const range = {\n      start: Math.max(0, currentHunk.startBlobLineNumber - MAX_REQUEST_LINE_LIMIT),\n      end: currentHunk.startBlobLineNumber,\n    }\n    addInjectedContextLines(range)\n  }\n\n  const expandEndOfHunk = () => {\n    if (!canExpandEndOfHunk || !currentHunk) return\n    const range = {\n      start: currentHunk.endBlobLineNumber + 1,\n      end: currentHunk.endBlobLineNumber + 1 + MAX_REQUEST_LINE_LIMIT,\n    }\n    addInjectedContextLines(range)\n  }\n\n  const expandEndOfPreviousHunk = () => {\n    if (!previousHunk) return\n\n    const range = {\n      start: previousHunk.endBlobLineNumber + 1,\n      end: previousHunk.endBlobLineNumber + 1 + MAX_REQUEST_LINE_LIMIT,\n    }\n    addInjectedContextLines(range)\n  }\n\n  return {expandStartOfHunk, expandEndOfHunk, expandEndOfPreviousHunk, canExpandEndOfHunk, canExpandStartOfHunk}\n}\n","import {type RefObject, useEffect} from 'react'\n\nimport type {GridNavigator} from '../helpers/grid-navigator'\nimport {cellIdFrom, isEmptyDiffLine, rowIdFrom} from '../helpers/line-helpers'\nimport type {ClientDiffLine} from '../types'\n\nfunction ensureElementFocusable(element: HTMLElement | null) {\n  if (element) {\n    // We need to set the cell's tabindex to 0 in a timeout because the focuszone will set it to -1,\n    // which blocks the user from tabbing back into the grid.\n    setTimeout(() => {\n      if (element.tabIndex === 0) return\n      element.tabIndex = 0\n    })\n  }\n}\n\nfunction getNewLines(\n  prevGridNavigator: GridNavigator,\n  leftLines: readonly ClientDiffLine[],\n  rightLines?: readonly ClientDiffLine[],\n) {\n  const loadedLines: ClientDiffLine[] = []\n  for (let i = 0; i < leftLines.length; i++) {\n    const leftLine = leftLines[i]\n    const rightLine = rightLines?.[i] ?? leftLine\n    const isHunk = !isEmptyDiffLine(leftLine) && leftLine?.type === 'HUNK'\n    if (leftLine && rightLine && !prevGridNavigator.hasLine(leftLine, rightLine, isHunk)) {\n      loadedLines.push(leftLine)\n    }\n  }\n\n  return loadedLines\n}\n\n/**\n * Hook behavior that uses imperative DOM manipulation to update the focus of the grid after a hunk expansion.\n * This hooks takes in the current list of diff lines and compares them to the previous grid navigator to determine\n * which lines are new. Using the new lines, we can determine which hunk button was selected and focus the next button\n * or cell.\n *\n * Strategy:\n * If the user selected expand up, we want to focus the next \"expand up\" button or the first loaded line.\n * If the user selected expand down, we want to focus the next \"expand down\" button or the first loaded line.\n * If the user selected expand all, we want to focus the first loaded line.\n */\nexport function useFocusNextCellAfterExpand(\n  fileAnchor: string,\n  leftLines: readonly ClientDiffLine[],\n  gridNavigator: GridNavigator,\n  containerRef: RefObject<HTMLElement>,\n  prevGridNavigator?: GridNavigator,\n  rightLines?: readonly ClientDiffLine[],\n) {\n  useEffect(() => {\n    // when the lines have changed and the active element is document.body\n    // we can infer that the user activated a hunk expansion, which causes the button\n    // they selected to be removed from the DOM and focus returned to some other element in the document.\n    // In this case, we want to update the focus to the \"next\" hunk button in the grid.\n    if (prevGridNavigator && document.activeElement) {\n      const loadedLines = getNewLines(prevGridNavigator, leftLines, rightLines)\n\n      // no new lines, just bail\n      if (loadedLines.length === 0) return\n\n      if (document.activeElement === document.body) {\n        // the line that comes after the last loaded line\n        const nextLineIndex = leftLines.indexOf(loadedLines[loadedLines.length - 1] as ClientDiffLine)\n        const nextLine = leftLines[nextLineIndex + 1]\n\n        let cellId: string | undefined\n        let cell: HTMLElement | null | undefined\n        let cellButton: HTMLElement | null | undefined\n        const firstLine = loadedLines[0] as ClientDiffLine\n\n        // if the first line after the loaded lines is a hunk, the diff was expanded down.\n        const focusNextExpandDown = nextLine && !isEmptyDiffLine(nextLine) && nextLine.type === 'HUNK'\n\n        // if the diff was expanded down, focus the hunk row that comes right after the loaded lines.\n        if (focusNextExpandDown) {\n          cellId = cellIdFrom(rowIdFrom(fileAnchor, nextLine, nextLine), 0)\n          cell = document.querySelector<HTMLElement>(`[data-grid-cell-id=${cellId}]`)\n          cellButton = cell?.querySelector<HTMLElement>('button[data-direction=down], button[data-direction=all]')\n        }\n\n        // unless we have a down button to focus, focus the first loaded line.\n        if (!cellButton) {\n          cellId = cellIdFrom(rowIdFrom(fileAnchor, firstLine, firstLine), 0)\n          cell = document.querySelector<HTMLElement>(`[data-grid-cell-id=${cellId}]`)\n          cellButton = cell?.querySelector<HTMLElement>('button[data-direction=up], button[data-direction=all]')\n        }\n\n        if (cellId && cell) {\n          if (cellButton) {\n            cellButton.focus()\n          } else {\n            cell.focus()\n          }\n\n          gridNavigator.focusGridCell(cellId)\n          ensureElementFocusable(cell)\n        }\n      } else if (document.activeElement.tagName === 'BUTTON') {\n        // it's possible when expanding down that the expand down button stayed in the document and retained focus.\n        // in this case, we just need to make sure that its parent is tabbable.\n        const parentCell = document.activeElement.closest('td')\n        ensureElementFocusable(parentCell)\n      } else if (document.activeElement.tagName === 'TD') {\n        const cellId = document.activeElement.getAttribute('data-grid-cell-id')\n        const navigatorCellId = gridNavigator.focusedGridCell?.cellId\n\n        // handle case when we expanded up via context menu or keyboard shortcut\n        // and focus was incorrectly moved by the browser to a different cell\n        if (cellId !== navigatorCellId) {\n          const cellToFocus = containerRef.current?.querySelector<HTMLElement>(`[data-grid-cell-id=${navigatorCellId}]`)\n          cellToFocus?.focus()\n        }\n      }\n    }\n  }, [fileAnchor, leftLines, gridNavigator, rightLines, prevGridNavigator, containerRef])\n}\n","import type {DiffAnchor} from '@github-ui/diffs/types'\nimport type {Direction} from '@primer/behaviors'\nimport {useFocusZone} from '@primer/react'\nimport {useCallback, useEffect, useMemo, useRef} from 'react'\n\nimport type {\n  ReplaceSelectedDiffRowRangeFromGridCellsFnArgs,\n  UpdateSelectedDiffRowRangeFnArgs,\n} from '../contexts/SelectedDiffRowRangeContext'\nimport {GridNavigator} from '../helpers/grid-navigator'\nimport {useFocusNextCellAfterExpand} from './use-focus-next-cell-after-expand'\nimport {GRID_NAV_KEYS, KEY_TO_BIT} from '../constants'\nimport type {ClientDiffLine, LineRange} from '../types'\n\n/**\n * Given a container, add a focusout hook that will call the provided callback when the focus leaves the container.\n */\n// Disabling this function until we determine how to better reset a grid cell focus position when users leaves the grid.\n// function useFocusOutGridNavigationBehavior(containerRef: React.RefObject<HTMLElement>, onFocusOut: () => void) {\n//   const focusOutHandler = useCallback(\n//     (event: FocusEvent) => {\n//       // only trigger focusout behavior if the focus is leaving the container\n//       if (!containerRef.current?.contains(event.relatedTarget as Node)) onFocusOut()\n//     },\n//     [containerRef, onFocusOut],\n//   )\n\n//   useEffect(() => {\n//     const containerElement = containerRef.current\n//     containerElement?.addEventListener('focusout', focusOutHandler)\n//     return () => containerElement?.removeEventListener('focusout', focusOutHandler)\n//   }, [containerRef, focusOutHandler])\n// }\n\n/**\n * Keeps the grid navigator's focusedGridCell property in sync with the document's focused element\n */\nfunction useSyncedGridFocus(containerRef: React.RefObject<HTMLElement>, gridNavigator: GridNavigator) {\n  const handleGridFocusIn = useCallback(\n    (event: FocusEvent) => {\n      const focusedCell = event.target as HTMLElement\n      const gridCellId = focusedCell.getAttribute('data-grid-cell-id')\n      if (gridCellId) gridNavigator.focusGridCell(gridCellId)\n    },\n    [gridNavigator],\n  )\n\n  useEffect(() => {\n    const containerElement = containerRef.current\n    containerElement?.addEventListener('focusin', handleGridFocusIn)\n    return () => containerElement?.removeEventListener('focusin', handleGridFocusIn)\n  }, [containerRef, handleGridFocusIn])\n}\n\nexport function isGridNavigationKey(key: string) {\n  if (!(key in KEY_TO_BIT)) return false\n  const keyBit = KEY_TO_BIT[key as keyof typeof KEY_TO_BIT]\n  return (keyBit & GRID_NAV_KEYS) > 0\n}\n\nexport function useGridNavigation({\n  clearSelectedDiffRowRange,\n  containerRef,\n  fileAnchor,\n  isSplitDiff,\n  leftLines,\n  replaceSelectedDiffRowRangeFromGridCells,\n  rightLines,\n  selectedDiffRowRange,\n  updateSelectedDiffRowRange,\n}: {\n  clearSelectedDiffRowRange: () => void\n  containerRef: React.RefObject<HTMLElement>\n  fileAnchor: DiffAnchor\n  isSplitDiff: boolean\n  leftLines: readonly ClientDiffLine[]\n  replaceSelectedDiffRowRangeFromGridCells: ReplaceSelectedDiffRowRangeFromGridCellsFnArgs\n  rightLines?: readonly ClientDiffLine[]\n  selectedDiffRowRange: LineRange | null\n  updateSelectedDiffRowRange: UpdateSelectedDiffRowRangeFnArgs\n}) {\n  const prevGridNavigator = useRef<GridNavigator | undefined>()\n  const gridNavigator = useMemo(\n    () =>\n      new GridNavigator(\n        fileAnchor,\n        isSplitDiff,\n        leftLines,\n        rightLines,\n        prevGridNavigator.current?.focusedGridCell?.cellId,\n      ),\n    [fileAnchor, isSplitDiff, leftLines, rightLines],\n  )\n\n  useEffect(() => {\n    prevGridNavigator.current = gridNavigator\n  }, [gridNavigator])\n\n  useFocusNextCellAfterExpand(fileAnchor, leftLines, gridNavigator, containerRef, prevGridNavigator.current, rightLines)\n  useSyncedGridFocus(containerRef, gridNavigator)\n\n  const getNextFocusable = useCallback(\n    (_direction: Direction, from: Element | undefined, event: KeyboardEvent) => {\n      const currentCell = from as HTMLElement\n      const focusedGridCell = gridNavigator.getValidSelectableRowCell()\n\n      switch (true) {\n        // Handles CMD + A / CTRL + A key presses to select all difflines in a diff grid\n        // eslint-disable-next-line @github-ui/ui-commands/no-manual-shortcut-logic\n        case (event.metaKey || event.ctrlKey) && event.code === 'KeyA': {\n          const firstCodeCell = gridNavigator.getFirstCodeCell()\n          const lastCodeCell = gridNavigator.getLastCodeCell()\n\n          // Avoid setting diff row range if we do not have valid Grid Cells\n          if (!firstCodeCell || !lastCodeCell) return currentCell\n\n          replaceSelectedDiffRowRangeFromGridCells({\n            diffAnchor: fileAnchor,\n            focusedGridCell: firstCodeCell,\n            startGridCell: firstCodeCell,\n            endGridCell: lastCodeCell,\n          })\n          return currentCell\n        }\n        // Handles SHIFT + Arrow Down key presses to select focused diffline and diffline(s) below/after it.\n        // eslint-disable-next-line @github-ui/ui-commands/no-manual-shortcut-logic\n        case event.shiftKey && event.key === 'ArrowDown': {\n          const nextSelectedCell = gridNavigator.getNextSelectableCell('ArrowDown')\n\n          // Avoid setting diff row range if we do not have valid Grid Cells\n          if (!nextSelectedCell || !focusedGridCell) return currentCell\n\n          selectedDiffRowRange?.firstSelectedLineNumber\n            ? updateSelectedDiffRowRange(fileAnchor, nextSelectedCell.lineNumber, nextSelectedCell.orientation, true)\n            : replaceSelectedDiffRowRangeFromGridCells({\n                diffAnchor: fileAnchor,\n                focusedGridCell,\n                startGridCell: focusedGridCell,\n                endGridCell: nextSelectedCell,\n              })\n          return currentCell\n        }\n        // Handles SHIFT + Arrow Up key presses to select focused diffline and diffline(s) above/before it.\n        // eslint-disable-next-line @github-ui/ui-commands/no-manual-shortcut-logic\n        case event.shiftKey && event.key === 'ArrowUp': {\n          const nextSelectedCell = gridNavigator.getNextSelectableCell('ArrowUp')\n\n          // Avoid setting diff row range if we do not have valid Grid Cells\n          if (!nextSelectedCell || !focusedGridCell) return currentCell\n\n          selectedDiffRowRange?.firstSelectedLineNumber\n            ? updateSelectedDiffRowRange(fileAnchor, nextSelectedCell.lineNumber, nextSelectedCell.orientation, true)\n            : replaceSelectedDiffRowRangeFromGridCells({\n                diffAnchor: fileAnchor,\n                focusedGridCell,\n                startGridCell: nextSelectedCell,\n                endGridCell: focusedGridCell,\n              })\n          return currentCell\n        }\n        default: {\n          // eslint-disable-next-line @github-ui/ui-commands/no-manual-shortcut-logic\n          const nextItem = gridNavigator.moveToNextItem(event.key, event.ctrlKey)\n          const nextElement = nextItem && document.querySelector<HTMLElement>(`[data-grid-cell-id=${nextItem.cellId}]`)\n\n          clearSelectedDiffRowRange()\n          gridNavigator.clearLastSelectedCell()\n\n          // return undefined instead of null when `document.getElementById` can't find element\n          return nextElement ?? undefined\n        }\n      }\n    },\n    [\n      gridNavigator,\n      selectedDiffRowRange,\n      updateSelectedDiffRowRange,\n      fileAnchor,\n      replaceSelectedDiffRowRangeFromGridCells,\n      clearSelectedDiffRowRange,\n    ],\n  )\n\n  // Disabling these function calls until we determine how to better reset a grid cell focus position when users leaves the grid.\n  // reset grid navigator's current cell back to the first cell when focus leaves the grid\n  // const handleFocusOut = useCallback(() => gridNavigator.focusFirstGridCell(), [gridNavigator])\n  // useFocusOutGridNavigationBehavior(containerRef, handleFocusOut)\n\n  useFocusZone(\n    {\n      containerRef,\n      bindKeys: GRID_NAV_KEYS,\n      getNextFocusable,\n      focusableElementFilter: element => element.tagName !== 'BUTTON',\n      focusInStrategy: 'previous',\n    },\n    [getNextFocusable],\n  )\n\n  return {gridNavigator}\n}\n","import {useSelectedDiffRowRangeContext} from '../contexts/SelectedDiffRowRangeContext'\nimport {getContentFromLines} from '../helpers/line-helpers'\n\nexport function useSelectedDiffRowRangeContent(diffAnchor: string): {\n  getUnifiedDiffLineCode: () => string\n  getSplitDiffSingleLineCode: (side: 'left' | 'right' | undefined, lineNumber: number | null | undefined) => string\n  getSplitDiffMultiLineCode: (side: 'left' | 'right' | undefined) => string\n} {\n  const {selectedDiffRowRange, selectedDiffLines, getDiffLinesByDiffAnchor} = useSelectedDiffRowRangeContext()\n\n  const getUnifiedDiffLineCode = () => {\n    const diffLines = getDiffLinesByDiffAnchor(diffAnchor)\n    if (!diffLines || !selectedDiffRowRange) return ''\n\n    const {startOrientation, endOrientation, startLineNumber, endLineNumber} = selectedDiffRowRange\n\n    let firstLineIndex = 0\n    let secondLineIndex = 0\n\n    // We only need to search for new first and end indexes if there is more than one diffline.\n    if (diffLines.length > 1) {\n      firstLineIndex = diffLines.findIndex(line =>\n        startOrientation === 'left' ? line.left === startLineNumber : line.right === startLineNumber,\n      )\n      secondLineIndex = diffLines.findIndex(line =>\n        endOrientation === 'left' ? line.left === endLineNumber : line.right === endLineNumber,\n      )\n    }\n\n    return getContentFromLines(diffLines.slice(firstLineIndex, secondLineIndex + 1))\n  }\n\n  const getSplitDiffSingleLineCode = (side: 'left' | 'right' | undefined, lineNumber: number | null | undefined) => {\n    if (!side || !lineNumber) return ''\n\n    const diffLine = getDiffLinesByDiffAnchor(diffAnchor)?.find(line =>\n      side === 'left' ? line.left === lineNumber : line.right === lineNumber,\n    )\n    if (!diffLine) return ''\n\n    return getContentFromLines([diffLine])\n  }\n\n  const getSplitDiffMultiLineCode = (side: 'left' | 'right' | undefined) => {\n    if (side === undefined) return ''\n    return side === 'left'\n      ? getContentFromLines(selectedDiffLines.leftLines)\n      : getContentFromLines(selectedDiffLines.rightLines)\n  }\n\n  return {getUnifiedDiffLineCode, getSplitDiffSingleLineCode, getSplitDiffMultiLineCode}\n}\n","import {useLayoutEffect} from '@github-ui/use-layout-effect'\nimport {useCallback, useRef} from 'react'\n\n/**\n * This hooks allows us to avoid losing a callback reference on component re-renders by returning a function that is referentially constant (it can never be outdated).\n *\n * The hook will also remove the hook function reference on unmount.\n *\n * This hook is preferred over `useSafeAsyncCallback` when the callback is not async and you need the function reference to be available on first mount.\n *\n * @param fn the function to call\n */\n\nexport const useStableCallback = <A extends unknown[], R>(fn: (...args: A) => R): ((...args: A) => R | undefined) => {\n  const trackingRef = useRef<((...args: A) => R) | null>(fn)\n  useLayoutEffect((): (() => void) => {\n    trackingRef.current = fn\n    return () => (trackingRef.current = null)\n  }, [fn])\n\n  return useCallback((...args: A) => trackingRef.current?.(...args), [])\n}\n","import {useMemo} from 'react'\nimport {useSelectedDiffRowRangeContext} from '../contexts/SelectedDiffRowRangeContext'\nimport {trimContentLine, getContentFromLines} from '../helpers/line-helpers'\nimport type {SuggestedChangesConfiguration, Thread} from '@github-ui/conversations'\nimport type {DiffLine, LineRange} from '../types'\nimport {useAnalytics} from '@github-ui/use-analytics'\nimport {useStableCallback} from './use-stable-callback'\nimport {generateSuggestedChangeLineRangeFromDiffThread} from '@github-ui/conversations/suggested-changes'\n\n/**\n * Returns the configuration for applying suggested changes when the full diff is not loaded (e.g. the timeline)\n */\nexport function configureSuggestedChangesFromThreadWithDiffLines(thread: Thread): SuggestedChangesConfiguration {\n  const lineRange = generateSuggestedChangeLineRangeFromDiffThread(thread)\n  // DiffLines from a thread can include additional context lines, so exclude those\n  const suggestedChangeDiffLines = (thread.subject?.diffLines ?? []).filter(diffLine => {\n    if (!lineRange) return []\n    return (\n      (diffLine.left && diffLine.left >= lineRange.startLineNumber && diffLine.left <= lineRange.endLineNumber) ||\n      (diffLine.right && diffLine.right >= lineRange.startLineNumber && diffLine.right <= lineRange.endLineNumber)\n    )\n  })\n\n  const suggestionNotOnDeletedLine = suggestedChangeDiffLines.every(diffLine => diffLine.type !== 'DELETION')\n\n  const originalLinesContentFromDiffLines = suggestedChangeDiffLines\n    ?.map(diffLine => trimContentLine(diffLine.text, diffLine.type)[0])\n    .join('\\n')\n\n  return {\n    isValidSuggestionRange: suggestedChangeDiffLines.length > 0 && !!suggestionNotOnDeletedLine,\n    showSuggestChangesButton: false,\n    sourceContentFromDiffLines: originalLinesContentFromDiffLines,\n    onInsertSuggestedChange: () => {},\n    shouldInsertSuggestedChange: false,\n  }\n}\n\n/**\n * Returns the configuration for the Suggest Changes button within the markdown toolbar\n */\nexport function useSuggestedChanges(\n  suggestedChangesEnabled: boolean | undefined,\n  line: DiffLine,\n  shouldStartNewConversationWithSuggestedChange: boolean | undefined,\n) {\n  const {sendAnalyticsEvent} = useAnalytics()\n  const {getDiffLinesFromLineRange, selectedDiffRowRange} = useSelectedDiffRowRangeContext()\n\n  function shouldShowSuggestChangesButtonFromRowRange(rowRange?: LineRange) {\n    // Context menu triggers from single line don't have a row range, so fall back to the line\n    if (!rowRange) return line.type !== 'DELETION'\n\n    const rightSideOnly = rowRange.startOrientation === 'right' && rowRange.endOrientation === 'right'\n    if (rightSideOnly) {\n      return true\n    }\n\n    const singleLine =\n      rowRange.startLineNumber === rowRange.endLineNumber && rowRange.startOrientation === rowRange.endOrientation\n    if (singleLine) {\n      return line.type !== 'DELETION'\n    }\n\n    const diffLinesFromRange = getDiffLinesFromLineRange(rowRange)?.selectedLeftLines\n    return !!diffLinesFromRange?.every(diffLine => diffLine !== 'empty-diff-line' && diffLine.type !== 'DELETION')\n  }\n\n  /**\n   *\n   * Returns the lines that should be suggested for a comment\n   *\n   * @param diffLines - the right lines belonging to the range for the thread or the new conversation\n   * @param line - the current line the cell from which this is called belongs to\n   *\n   */\n  function getSourceContentDiffLinesFromRowRange(rowRange: LineRange | undefined): string | undefined {\n    const diffLines = getDiffLinesFromLineRange(rowRange)?.selectedRightLines\n    if (rowRange && diffLines && diffLines.length > 1) {\n      return getContentFromLines(diffLines)\n    }\n\n    if (!line) return ''\n    // Single line\n    const [lineContent] = trimContentLine(line.text, line.type)\n    return lineContent\n  }\n\n  /**\n   * Returns the configuration for the Suggest Changes button within the markdown toolbar\n   *\n   * @param rowRange - the range of lines for the thread or the new conversation\n   * @param shouldInsertSuggestedChange - boolean indicating whether to auto insert the suggested change on render\n   */\n  const configureSuggestedChangesFromLineRange = useStableCallback(function configureSuggestedChangesFromLineRange(\n    rowRange?: LineRange,\n    shouldInsertSuggestedChange?: boolean,\n  ) {\n    if (!suggestedChangesEnabled) return undefined\n\n    const showSuggestChangesButton = shouldShowSuggestChangesButtonFromRowRange(rowRange)\n\n    return {\n      isValidSuggestionRange: showSuggestChangesButton,\n      showSuggestChangesButton,\n      sourceContentFromDiffLines: showSuggestChangesButton\n        ? getSourceContentDiffLinesFromRowRange(rowRange)\n        : undefined,\n      onInsertSuggestedChange: () => {\n        sendAnalyticsEvent('diff.add_suggested_change', 'ADD_SUGGESTED_CHANGE_BUTTON')\n      },\n      shouldInsertSuggestedChange,\n    }\n  })\n\n  return useMemo(() => {\n    return {\n      selectedDiffRowRange,\n      configureSuggestedChangesFromLineRange,\n      shouldStartNewConversationWithSuggestedChange,\n    }\n  }, [selectedDiffRowRange, configureSuggestedChangesFromLineRange, shouldStartNewConversationWithSuggestedChange])\n}\n","import type {DiffAnnotation} from '@github-ui/conversations'\nimport type {PatchStatus} from '@github-ui/diff-file-helpers'\nimport type {DiffLineType} from '@github-ui/diffs/types'\n\nexport type {CopilotChatFileDiffReferenceData} from '@github-ui/copilot-code-chat/use-file-diff-reference'\n\n//can add more contexts here in the future as needed\nexport type DiffContext = 'commit' | 'pr'\n\nexport type DiffEntryData = {\n  readonly diffLines: DiffLine[]\n  readonly isBinary: boolean\n  readonly isTooBig: boolean\n  readonly linesChanged: number\n  readonly newTreeEntry:\n    | {\n        readonly isGenerated: boolean\n        readonly lineCount: number | null | undefined\n        readonly mode: number\n      }\n    | null\n    | undefined\n  readonly newCommitOid?: string\n  readonly objectId: string\n  readonly oldTreeEntry:\n    | {\n        readonly lineCount: number | null | undefined\n        readonly mode: number\n      }\n    | null\n    | undefined\n  readonly oldCommitOid?: string\n  readonly path: string\n  readonly pathDigest: string\n  readonly status: PatchStatus\n  readonly truncatedReason: string | null | undefined\n}\n\nexport type DiffLine = {\n  readonly __id?: string\n  readonly left: number | null\n  readonly right: number | null\n  readonly blobLineNumber: number\n  readonly position?: number | null\n  readonly type: DiffLineType\n  readonly html: string\n  readonly text: string\n  threadsData?: Threads\n  annotationsData?: {\n    readonly totalCount: number\n    readonly annotations: ReadonlyArray<DiffAnnotation | null> | null\n  }\n}\n\nexport type Threads = {\n  readonly __id?: string\n  readonly totalCommentsCount: number\n  readonly totalCount: number\n  readonly threads: ReadonlyArray<Thread | null> | null\n}\n\nexport type Thread = {\n  readonly id: string\n  readonly isOutdated: boolean\n  readonly commentsData: Comments\n  readonly diffSide: DiffSide | null\n  readonly line?: number | null\n  readonly startDiffSide?: DiffSide | null\n  readonly startLine?: number | null\n}\n\nexport type Comments = {\n  readonly __id?: string\n  readonly totalCount: number\n  readonly comments: ReadonlyArray<Comment | null> | null\n}\n\nexport type Comment = {\n  readonly author: CommentAuthor | null\n}\n\nexport type CommentAuthor = {\n  avatarUrl: string\n  login: string\n  url: string\n}\n\nexport const EMPTY_DIFF_LINE = 'empty-diff-line'\nexport type EmptyDiffLine = 'empty-diff-line'\n\nexport type ClientDiffLine = DiffLine | EmptyDiffLine\n\nexport type DiffSide = 'LEFT' | 'RIGHT'\n\nexport interface LineRange {\n  diffAnchor: string\n  endLineNumber: number\n  endOrientation: 'left' | 'right'\n  startLineNumber: number\n  firstSelectedLineNumber: number\n  firstSelectedOrientation: 'left' | 'right'\n  startOrientation: 'left' | 'right'\n}\n","import {useCallback, useEffect, useRef, useState} from 'react'\n\nconst HELLO_TIMEOUT = 10_000\nconst LOAD_TIMEOUT = 45_000\n\nexport const DEFAULT_RENDERER_HEIGHT = '500px'\n\ninterface RenderTiming {\n  load?: number | null\n  helloTimer?: number | null\n  hello?: number | null\n  loadTimer?: number | null\n  untimed?: boolean\n}\n\ninterface RenderCommand {\n  type: 'render:cmd'\n  body?: unknown\n}\n\nexport interface RenderMessage {\n  type: 'render'\n  body: string\n  payload:\n    | null\n    | undefined\n    | {\n        height?: number\n        error?: string | null\n      }\n}\n\nexport enum RenderState {\n  ERROR = 'ERROR',\n  LOADING = 'LOADING',\n  LOADED = 'LOADED',\n  READY = 'READY',\n}\n\ninterface FileRendererHandle {\n  renderState: RenderState\n  errorMsg: string | null\n  iFrameRef: React.RefObject<HTMLIFrameElement>\n  containerRef: React.RefObject<HTMLDivElement>\n}\n\nexport function useFileRenderer(origin: string): FileRendererHandle {\n  const [renderStateRef, setRenderState] = useStatefulRef(RenderState.LOADING)\n  const errorMsg = useRef<string | null>(null)\n\n  const iFrameRef = useRef<HTMLIFrameElement>(null)\n  const containerRef = useRef<HTMLDivElement>(null)\n\n  const renderTiming = useRef<RenderTiming>({untimed: true})\n\n  const messageListener = useCallback(\n    (event: MessageEvent) =>\n      onMessage(\n        event,\n        origin,\n        iFrameRef,\n        containerRef,\n        renderTiming,\n        setRenderState,\n        error => (errorMsg.current = error),\n      ),\n    [origin, setRenderState],\n  )\n\n  useEffect(() => {\n    // Clear the timeouts\n    resetTiming(renderTiming.current)\n\n    const timeoutWatchdog = (checkHello: boolean) => {\n      if (\n        (renderStateRef.current !== RenderState.LOADING && renderStateRef.current !== RenderState.LOADED) ||\n        (checkHello && !renderTiming.current.hello)\n      ) {\n        return\n      }\n\n      setRenderState(RenderState.ERROR)\n    }\n\n    renderTiming.current = {\n      load: Date.now(),\n      hello: null,\n      helloTimer: window.setTimeout(timeoutWatchdog, HELLO_TIMEOUT, true),\n      loadTimer: window.setTimeout(timeoutWatchdog, LOAD_TIMEOUT),\n    }\n\n    return () => {\n      resetTiming(renderTiming.current)\n    }\n  }, [renderStateRef, setRenderState])\n\n  useEffect(() => {\n    window.addEventListener('message', messageListener)\n    return () => window.removeEventListener('message', messageListener)\n  }, [messageListener])\n\n  return {renderState: renderStateRef.current, errorMsg: errorMsg.current, iFrameRef, containerRef}\n}\n\nfunction onMessage(\n  event: MessageEvent,\n  origin: string,\n  iFrameRef: React.RefObject<HTMLIFrameElement>,\n  containerRef: React.RefObject<HTMLDivElement>,\n  renderTiming: React.RefObject<RenderTiming>,\n  setRenderState: (state: RenderState) => void,\n  setError: (error: string | null) => void,\n) {\n  if (event.origin !== origin) return\n\n  const renderMessage = getRenderMessage(event)\n  if (!renderMessage) {\n    setRenderState(RenderState.ERROR)\n    return\n  }\n\n  const body = renderMessage.body\n  const payload = renderMessage.payload != null ? renderMessage.payload : undefined\n\n  const renderWindow = iFrameRef.current?.contentWindow\n\n  switch (body) {\n    case 'hello':\n      {\n        const timingData = renderTiming.current ?? {\n          untimed: true,\n        }\n\n        timingData.hello = Date.now()\n\n        const ackmsg = {\n          type: 'render:cmd',\n          body: {\n            cmd: 'ack',\n            ack: true,\n          },\n        } as const\n\n        const msg = {\n          type: 'render:cmd',\n          body: {\n            cmd: 'branding',\n            branding: false,\n          },\n        } as const\n\n        sendRenderCommand(renderWindow, ackmsg)\n        sendRenderCommand(renderWindow, msg)\n      }\n      break\n    case 'error':\n    case 'error:fatal':\n    case 'error:invalid':\n      if (payload) {\n        setError(payload.error ?? null)\n        setRenderState(RenderState.ERROR)\n      } else {\n        setRenderState(RenderState.ERROR)\n      }\n      break\n    case 'loading':\n      setRenderState(RenderState.LOADING)\n      break\n    case 'loaded':\n      setRenderState(RenderState.LOADED)\n      break\n    case 'ready':\n      // TODO: markdown success\n      //markdownEnrichmentSuccess(container)\n\n      if (payload && typeof payload.height === 'number' && containerRef.current) {\n        containerRef.current.style.height = `${payload.height}px`\n      }\n\n      setRenderState(RenderState.READY)\n\n      break\n    case 'resize':\n      if (payload && typeof payload.height === 'number' && containerRef.current) {\n        containerRef.current.style.height = `${payload.height}px`\n      }\n\n      break\n    case 'code_rendering_service:container:get_size':\n      sendRenderCommand(renderWindow, {\n        type: 'render:cmd',\n        body: {\n          cmd: 'code_rendering_service:container:size',\n          'code_rendering_service:container:size': {\n            width: containerRef.current?.getBoundingClientRect().width,\n          },\n        },\n      })\n      break\n    case 'code_rendering_service:markdown:get_data':\n      if (!iFrameRef.current || !containerRef.current) return\n      sendIFrameDataToIFrame(iFrameRef.current, containerRef.current)\n      break\n    default:\n      break\n  }\n}\n\nfunction useStatefulRef<T>(initialState: T) {\n  // Workaround because window listeners only have access to the initial state. So use refs\n  const [renderStateInt, setRenderStateInt] = useState<T>(initialState)\n  const renderStateRef = useRef<T>(renderStateInt)\n\n  const setRenderState = (state: T) => {\n    renderStateRef.current = state\n    setRenderStateInt(state)\n  }\n\n  return [renderStateRef, setRenderState] as const\n}\n\nfunction resetTiming(renderTiming: RenderTiming) {\n  if (!renderTiming) {\n    return\n  }\n  renderTiming.load = renderTiming.hello = null\n  if (renderTiming.helloTimer) {\n    clearTimeout(renderTiming.helloTimer)\n    renderTiming.helloTimer = null\n  }\n  if (renderTiming.loadTimer) {\n    clearTimeout(renderTiming.loadTimer)\n    renderTiming.loadTimer = null\n  }\n}\n\nfunction sendIFrameDataToIFrame(iframe: HTMLIFrameElement, container: HTMLDivElement) {\n  const data = iframe.getAttribute('data-content')\n  if (!data) {\n    return\n  }\n\n  const msg = {\n    type: 'render:cmd',\n    body: {\n      cmd: 'code_rendering_service:data:ready',\n      'code_rendering_service:data:ready': {\n        data: JSON.parse(data).data,\n        width: container.getBoundingClientRect().width,\n      },\n    },\n  } as const\n\n  sendRenderCommand(iframe.contentWindow, msg)\n}\n\nfunction sendRenderCommand(renderWindow: Window | null | undefined, message: RenderCommand) {\n  if (renderWindow && renderWindow.postMessage) {\n    renderWindow.postMessage(JSON.stringify(message), '*')\n  }\n}\n\nfunction getRenderMessage(event: MessageEvent): RenderMessage | null {\n  let data = event.data as unknown\n\n  if (!data) return null\n\n  if (typeof data === 'string') {\n    try {\n      data = JSON.parse(data) as unknown\n    } catch {\n      // Ignore parse errors\n      return null\n    }\n  }\n\n  if (!isRenderMessage(data)) return null\n\n  return data\n}\n\nfunction isRenderMessage(data: unknown): data is RenderMessage {\n  if (typeof data !== 'object' || !data) {\n    return false\n  }\n\n  const messageData = data as RenderMessage\n  return (\n    messageData.type === 'render' && typeof messageData.body === 'string' && typeof messageData.payload === 'object'\n  )\n}\n","import React from 'react'\n\nexport function useFileTreeTooltip({\n  focusRowRef,\n  mouseRowRef,\n}: {\n  focusRowRef: React.RefObject<HTMLElement>\n  mouseRowRef: React.RefObject<HTMLElement>\n}) {\n  const [showTooltip, setShowTooltip] = React.useState(false)\n\n  React.useEffect(() => {\n    if (focusRowRef.current && mouseRowRef.current) {\n      const showIfOverflowing = () => {\n        const contentRef: HTMLElement | null | undefined = focusRowRef.current?.querySelector(\n          '.PRIVATE_TreeView-item-content-text',\n        )\n        if (contentRef?.scrollWidth !== contentRef?.offsetWidth) {\n          setShowTooltip(true)\n        }\n      }\n      focusRowRef.current.onfocus = () => {\n        showIfOverflowing()\n      }\n      focusRowRef.current.onblur = () => {\n        setShowTooltip(false)\n      }\n      mouseRowRef.current.onmouseenter = () => {\n        showIfOverflowing()\n      }\n      mouseRowRef.current.onmouseleave = () => {\n        setShowTooltip(false)\n      }\n    }\n  }, [focusRowRef, mouseRowRef])\n\n  return showTooltip\n}\n","import {useEffect} from 'react'\n\nexport function useHideFooter(hide: boolean) {\n  useEffect(() => {\n    if (!hide) {\n      return\n    }\n\n    const footer: HTMLDivElement | null = document.querySelector('.footer')\n    if (!footer) {\n      return\n    }\n    footer.hidden = true\n    return () => {\n      footer.hidden = false\n    }\n  }, [hide])\n}\n","import {useCallback} from 'react'\nimport {useCSRFToken} from '@github-ui/use-csrf-token'\n\ninterface TypedResponse<T> extends Response {\n  json(): Promise<T>\n}\n\n/**\n * The pieces of a RequestInit which we allow to be used.\n * We do not allow a body or method to be passed since those must be specified by other means.\n */\ninterface MethodlessRequestInit extends RequestInit {\n  method?: never\n}\n\n/**\n * @deprecated use the `@github-ui/verified-fetch` package instead\n */\nexport function useVerifiedFetch<R = unknown>(\n  path: string,\n  method: 'get' | 'post' | 'delete',\n): (init?: MethodlessRequestInit) => Promise<TypedResponse<R>> {\n  const token = useCSRFToken(path, method)\n\n  return useCallback(\n    async (init?: MethodlessRequestInit) => {\n      let requestMethod = method\n\n      // TODO: eventually, in this case, we should make an additional API call to get a new token\n      if (!token) throw new Error(`No authenticity token found for method ${requestMethod} and path ${path}`)\n\n      if (!init) {\n        init = {}\n      }\n\n      // This is required for rails endpoints marked with before_action :require_xhr\n      addHeader(init, 'X-Requested-With', 'XMLHttpRequest')\n\n      // Rails expects a post request with _method=delete for DELETE requests\n      if (init.body instanceof URLSearchParams && requestMethod === 'delete') {\n        init.body.append('_method', 'delete')\n        requestMethod = 'post'\n      }\n\n      if (init.body instanceof URLSearchParams || init.body instanceof FormData) {\n        // eslint-disable-next-line github/authenticity-token\n        init.body.append('authenticity_token', token)\n      } else {\n        addHeader(init, 'Scoped-CSRF-Token', token)\n      }\n\n      return await fetch(path, {...init, method: requestMethod})\n    },\n    [path, method, token],\n  )\n}\n\nfunction addHeader(init: RequestInit, key: string, value: string) {\n  init.headers ??= new Headers()\n  const headers = init.headers\n\n  if (headers instanceof Headers) {\n    headers.set(key, value)\n  } else if (Array.isArray(headers)) {\n    const existingIndex = headers.findIndex(([k]) => k === key)\n    if (existingIndex === -1) {\n      headers.push([key, value])\n    } else {\n      headers[existingIndex] = [key, value]\n    }\n  } else {\n    headers[key] = value\n  }\n}\n","import React from 'react'\nimport type {Options} from 'react-virtual'\nimport {useVirtual} from 'react-virtual'\n\nconst defaultKeyExtractor = (index: number) => index\n\n/**\n * A hook that wraps the `useVirtual` hook and provides virtualization for lists of dynamic elements that may\n * change in size. By default, `useVirtual` assumes the size of items in the list won't change.\n */\nexport function useVirtualDynamic<T>(options: Options<T>) {\n  const measureRefCacheRef = React.useRef<Record<string, (el: HTMLElement | null) => void>>({})\n  const elCacheRef = React.useRef<Record<string, Element | null>>({})\n\n  const update = (key: number | string, el: HTMLElement) => {\n    measureRefCacheRef.current[key]!(el)\n  }\n  const updateRef = React.useRef(update)\n  updateRef.current = update\n\n  const resizeObserverRef = React.useRef(\n    new ResizeObserver(entries => {\n      for (const entry of entries) {\n        const el = entry.target\n        const attribute = 'data-key'\n        const key = el.getAttribute(attribute)\n\n        if (key === null) {\n          throw new Error(`Value not found, for '${attribute}' attribute`)\n        }\n\n        const htmlEl = el as HTMLElement\n\n        updateRef.current(key, htmlEl)\n      }\n    }),\n  )\n\n  React.useEffect(() => {\n    const ro = resizeObserverRef.current\n    return () => {\n      ro.disconnect()\n    }\n  }, [])\n\n  const {size, keyExtractor = defaultKeyExtractor} = options\n\n  const cachedMeasureRefWrappers = React.useMemo(() => {\n    // Function that returns a function that will be passed to the `measureRef` prop of virtualized items.\n    // `measureRef` is the item ref that is passed to the actual item component and used to measure the item's size.\n    // In this case, we utilize the `ResizeObserver` to subscribe to changes in each item's size, making the list\n    // responsive to layout changes without manual intervention.\n    const makeMeasureRefWrapperForItem = (key: string | number) => (el: HTMLElement | null) => {\n      if (elCacheRef.current[key]) {\n        resizeObserverRef.current.unobserve(elCacheRef.current[key])\n      }\n\n      if (el) {\n        updateRef.current(key, el)\n        resizeObserverRef.current.observe(el)\n      }\n\n      elCacheRef.current[key] = el\n    }\n\n    const measureRefsMap: Record<string, (el: HTMLElement | null) => void> = {}\n\n    for (let i = 0; i < size; i++) {\n      const key = keyExtractor(i)\n\n      measureRefsMap[key] = makeMeasureRefWrapperForItem(key)\n    }\n\n    return measureRefsMap\n  }, [size, keyExtractor])\n\n  const rowVirtualizer = useVirtual(options)\n\n  const virtualItems = rowVirtualizer.virtualItems.map(item => {\n    measureRefCacheRef.current[item.key] = item.measureRef\n\n    return {\n      ...item,\n      measureRef: cachedMeasureRefWrappers[item.key]!,\n    }\n  })\n\n  return {...rowVirtualizer, virtualItems}\n}\n","import {useLayoutEffect} from '@github-ui/use-layout-effect'\nimport type {RefObject} from 'react'\nimport {useCallback, useRef, useState} from 'react'\nimport type {Options} from 'react-virtual'\nimport {useVirtual} from 'react-virtual'\n\nexport type Virtualizer = ReturnType<typeof useVirtual>\n\n/*\nThe source of this hook is the PR below. It does not seem likely that it will be\nupstreamed into the version of react-virtual we are using, but we might be able\nto eventually get rid of this if we upgrade to the newest version of the library.\n\nAnd even if not, the code is small and simple enough that it should be a small\nmaintenance burden.\n\nhttps://github.com/TanStack/virtual/pull/210/files#diff-bfe9874d239014961b1ae4e89875a6155667db834a410aaaa2ebe3cf89820556\n */\n\ninterface VirtualWindowOptions<T extends HTMLElement> extends Options<T> {\n  /**\n   * Additional number to offset by when scrolling to items in the list. Useful to account for sticky\n   * content.\n   */\n  additionalScrollOffset?: number\n  useVirtualImpl?: typeof useVirtual\n  // measureSize is used by react-virtual but not present in the typings for Options for some reason\n  measureSize?: (element: HTMLElement) => number\n}\n\n/**\n * A hook that wraps the `useVirtual` hook and provides virtualization when the scroll container is the window. This\n * requires some additional logic since window is technically not an HTMLElement.\n */\nexport function useVirtualWindow<T extends HTMLElement = HTMLElement>({\n  additionalScrollOffset = 0,\n  scrollToFn,\n  horizontal,\n  parentRef,\n  useVirtualImpl = useVirtual,\n  ...rest\n}: VirtualWindowOptions<T>): Virtualizer {\n  const windowRef = useRef(window)\n  const scrollOffsetFn = useCallback(() => {\n    const bounds = parentRef.current?.getBoundingClientRect()\n    const top = bounds?.top ?? 0\n    const left = bounds?.left ?? 0\n    return horizontal ? left * -1 : top * -1\n  }, [horizontal, parentRef])\n\n  const defaultScrollToFn = useCallback(\n    (offset: number) => {\n      const parentOffsetTop = (parentRef.current?.getBoundingClientRect().top ?? 0) + window.scrollY\n      const scrollOffset = offset + parentOffsetTop + additionalScrollOffset\n      windowRef.current?.scroll({top: horizontal ? 0 : scrollOffset, left: horizontal ? scrollOffset : 0})\n    },\n    [additionalScrollOffset, horizontal, parentRef],\n  )\n\n  return useVirtualImpl({\n    ...rest,\n    horizontal,\n    parentRef,\n    scrollToFn: scrollToFn || defaultScrollToFn,\n    onScrollElement: windowRef as unknown as RefObject<HTMLElement>,\n    scrollOffsetFn,\n    useObserver: () => useWindowRect(windowRef),\n  })\n}\n\nfunction useWindowRect(windowRef: RefObject<Window>) {\n  const [rect, setRect] = useState({height: 0, width: 0})\n  const element = windowRef.current\n  useLayoutEffect(() => {\n    if (!element) return\n    const resizeHandler = () => {\n      const next = {\n        height: element.innerHeight,\n        width: element.innerWidth,\n      }\n      setRect(prev => (prev.height !== next.height || prev.width !== next.width ? next : prev))\n    }\n\n    resizeHandler()\n\n    // eslint-disable-next-line github/prefer-observers\n    element.addEventListener('resize', resizeHandler)\n    return () => {\n      element.removeEventListener('resize', resizeHandler)\n    }\n  }, [element])\n\n  return rect\n}\n","import {GitHubAvatar} from '@github-ui/github-avatar'\nimport {ActionList} from '@primer/react'\nimport React from 'react'\n\nimport type {User} from './user-types'\n\ninterface UserItemProps {\n  user: User\n  isCurrent: boolean\n  onSelect?: (user: User) => void\n}\n\nexport const UserItem = React.memo(function UserItemInner({user, isCurrent, onSelect}: UserItemProps) {\n  return (\n    <ActionList.Item\n      selected={isCurrent}\n      onSelect={() => {\n        if (onSelect) onSelect(user)\n      }}\n    >\n      <ActionList.LeadingVisual>\n        <GitHubAvatar src={user.primaryAvatarUrl} square={user.path.startsWith('/apps/')} />\n      </ActionList.LeadingVisual>\n      {user.login}\n      <ActionList.Description>{user.name}</ActionList.Description>\n    </ActionList.Item>\n  )\n})\n\ntry{ UserItem.displayName ||= 'UserItem' } catch {}","import {FixedSizeVirtualList} from '@github-ui/ref-selector/fixed-size-virtual-list'\nimport {Box, type BoxProps} from '@primer/react'\n\nimport type {User} from './user-types'\nimport {UserItem} from './UserItem'\n\ninterface UsersListProps {\n  users: User[]\n  currentUser?: User\n  onSelect?: (user: User) => void\n  sx?: BoxProps['sx']\n}\n\n/**\n * The virtualized list has a fixed height. If we don't have very many users,\n * don't virtualize the list so that the container can shrink.\n */\nconst virtualizationThreshold = 20\nconst maxHeight = 330\n\nexport function UsersList(props: UsersListProps) {\n  return props.users.length > virtualizationThreshold ? <VirtualUsersList {...props} /> : <FullUsersList {...props} />\n}\n\n/**\n * Non-virtual implementation\n */\nfunction FullUsersList({users, currentUser, onSelect, sx = {}}: UsersListProps) {\n  return (\n    <Box sx={{maxHeight, overflowY: 'auto', ...sx}}>\n      {users.map(user => (\n        <UserItem key={user.login} user={user} isCurrent={user.login === currentUser?.login} onSelect={onSelect} />\n      ))}\n    </Box>\n  )\n}\n\nfunction VirtualUsersList({users, currentUser, onSelect, sx = {}}: UsersListProps) {\n  return (\n    <FixedSizeVirtualList\n      items={users}\n      itemHeight={33}\n      sx={{maxHeight, overflowY: 'auto', ...sx}}\n      makeKey={user => user.login}\n      renderItem={user => (\n        <UserItem key={user.login} user={user} isCurrent={user.login === currentUser?.login} onSelect={onSelect} />\n      )}\n    />\n  )\n}\n\ntry{ UsersList.displayName ||= 'UsersList' } catch {}\ntry{ FullUsersList.displayName ||= 'FullUsersList' } catch {}\ntry{ VirtualUsersList.displayName ||= 'VirtualUsersList' } catch {}","import {GitHubAvatar} from '@github-ui/github-avatar'\nimport {PeopleIcon, SearchIcon} from '@primer/octicons-react'\nimport {\n  ActionList,\n  ActionMenu,\n  Box,\n  type ButtonProps,\n  Flash,\n  type OverlayProps,\n  Spinner,\n  TextInput,\n  Octicon,\n} from '@primer/react'\nimport type React from 'react'\nimport {useState} from 'react'\n\nimport type {User, UsersState} from './user-types'\nimport {UsersList} from './UsersList'\n\nexport interface UserSelectorProps {\n  /**\n   * Default text to display when no user is selected\n   */\n  defaultText: string\n  /**\n   * The current selected user.\n   */\n  usersState: UsersState\n  /**\n   * The current selected user.\n   */\n  currentUser?: User\n  /**\n   * Callback when a user is selected.\n   */\n  onSelect?: (user: User) => void\n  /**\n   * The name of the data-hotkey\n   */\n  hotKey?: string\n  /**\n   * A callback that is invoked on user selector menu state change.\n   */\n  onOpenChange?: (open: boolean) => void\n  /**\n   * Custom content to append to the bottom of the ref selector\n   */\n  renderCustomFooter?: () => React.ReactNode\n  /**\n   * Size of the button to render\n   * @default 'medium' if not provided\n   * Option of 'small', 'medium', or 'large'\n   */\n  size?: ButtonProps['size']\n  /**\n   * Whether or not the user selector should provide a filter on whatever the user typed in\n   * that didn't have any results in the user list provided.\n   */\n  showTypedInUser?: boolean\n  /**\n   * The width of the `ActionMenu.Overlay`.\n   * @default 'large' if not provided.\n   * Option of 'small', 'medium', 'large', 'xlarge', 'xxlarge', or 'auto'.\n   * See Primer React Overlay documentation for more information.\n   */\n  width?: OverlayProps['width']\n  /**\n   * Search bar placeholder\n   */\n  placeholder?: string\n  /**\n   * Words prepending filter\n   */\n  label?: string\n}\n\nexport function UserSelector(props: UserSelectorProps) {\n  const {\n    defaultText,\n    usersState,\n    currentUser,\n    onSelect,\n    hotKey,\n    onOpenChange,\n    renderCustomFooter,\n    size,\n    showTypedInUser = false,\n    width = 'large',\n    label = '',\n  } = props\n  const [filterText, setFilterText] = useState('')\n  const filteredUsers = filterUsersHelper(usersState.users, filterText)\n\n  return (\n    <div>\n      <ActionMenu onOpenChange={onOpenChange}>\n        <ActionMenu.Button data-hotkey={hotKey} size={size} data-testid=\"user-selector-button\">\n          <Box sx={{display: 'flex'}}>\n            <Box sx={{mr: 2}}>\n              {currentUser ? (\n                <GitHubAvatar\n                  size={16}\n                  src={currentUser.primaryAvatarUrl}\n                  square={currentUser.path.startsWith('/apps/')}\n                />\n              ) : (\n                <Octicon icon={PeopleIcon} size=\"small\" sx={{color: 'fg.muted'}} />\n              )}\n            </Box>\n            <Box sx={{maxWidth: 125, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap'}}>\n              {currentUser ? (\n                <span>\n                  {label}\n                  {currentUser.login}\n                </span>\n              ) : (\n                <span>{defaultText}</span>\n              )}\n            </Box>\n          </Box>\n        </ActionMenu.Button>\n        <ActionMenu.Overlay width={width}>\n          <ActionList showDividers selectionVariant=\"single\">\n            <UserFilter defaultText={filterText} onFilterChange={setFilterText} />\n            <ActionList.Divider />\n            {usersState.loading ? (\n              <Loading />\n            ) : usersState.error ? (\n              <LoadingFailed />\n            ) : filteredUsers.length === 0 ? (\n              <UsersZeroState showTypedInUser={showTypedInUser} filterText={filterText} onSelect={onSelect} />\n            ) : (\n              <UsersList\n                users={filteredUsers}\n                currentUser={currentUser}\n                onSelect={onSelect}\n                sx={renderCustomFooter ? {pb: '10px', pt: 1} : {pt: 1}}\n              />\n            )}\n            {renderCustomFooter && <ActionList.Divider sx={{marginTop: 0}} />}\n            {renderCustomFooter?.()}\n          </ActionList>\n        </ActionMenu.Overlay>\n      </ActionMenu>\n    </div>\n  )\n}\n\nfunction filterUsersHelper(users: User[], filterText: string): User[] {\n  if (!users) return []\n\n  const trimmedFilterText = filterText.trim().toLowerCase()\n  if (!trimmedFilterText) {\n    // Use the full list of users if there is no filterText\n    return users\n  }\n\n  return users.filter(\n    user =>\n      user.login.toLowerCase().includes(trimmedFilterText) || user.name?.toLowerCase().includes(trimmedFilterText),\n  )\n}\n\ninterface UserFilterProps {\n  onFilterChange: (filterText: string) => void\n  defaultText: string\n}\n\nfunction UserFilter({onFilterChange, defaultText}: UserFilterProps) {\n  const placeholder = 'Find a user...'\n  return (\n    <ActionList.Group sx={{px: 2}}>\n      <TextInput\n        leadingVisual={SearchIcon}\n        value={defaultText}\n        sx={{width: '100%'}}\n        placeholder={placeholder}\n        onChange={e => onFilterChange(e.target.value)}\n      />\n    </ActionList.Group>\n  )\n}\n\nfunction Loading() {\n  return (\n    <Box sx={{display: 'flex', justifyContent: 'center', p: 2}}>\n      <Spinner size=\"medium\" aria-label=\"Loading users...\" />\n    </Box>\n  )\n}\n\nfunction LoadingFailed() {\n  return <Flash variant=\"danger\">Could not load users</Flash>\n}\n\nfunction UsersZeroState({\n  showTypedInUser,\n  filterText,\n  onSelect,\n}: {\n  showTypedInUser: boolean\n  filterText: string\n  onSelect?: (user: User) => void\n}) {\n  if (showTypedInUser) {\n    return (\n      <ActionList.Item\n        sx={{display: 'flex', justifyContent: 'center', mb: 2}}\n        onSelect={() => {\n          //for this onSelect to work, you need to only care about the login property of a given User.\n          if (onSelect) {\n            onSelect({\n              login: filterText,\n              name: filterText,\n              path: '',\n              primaryAvatarUrl: '',\n            })\n          }\n        }}\n      >\n        <>\n          Filter on author&nbsp;\n          <Box as=\"span\" sx={{fontWeight: 600}}>\n            {filterText}\n          </Box>\n        </>\n      </ActionList.Item>\n    )\n  }\n\n  return <Box sx={{p: 3, display: 'flex', justifyContent: 'center'}}>Nothing to show</Box>\n}\n\ntry{ UserSelector.displayName ||= 'UserSelector' } catch {}\ntry{ UserFilter.displayName ||= 'UserFilter' } catch {}\ntry{ Loading.displayName ||= 'Loading' } catch {}\ntry{ LoadingFailed.displayName ||= 'LoadingFailed' } catch {}\ntry{ UsersZeroState.displayName ||= 'UsersZeroState' } catch {}","import {\n  MarkdownEditHistoryViewer,\n  MarkdownEditHistoryViewerQueryComponent,\n} from '@github-ui/markdown-edit-history-viewer/MarkdownEditHistoryViewer'\nimport type {SxProp} from '@primer/react'\n\nimport {ActivityHeader} from './ActivityHeader'\nimport {CommentActions, type CommentActionsProps} from './CommentActions'\n\nexport type CommentSubjectTypes = 'pull request' | 'issue' | 'commit'\n\nexport type CommentHeaderProps = Omit<CommentActionsProps, 'editHistoryComponent'> & {\n  avatarUrl: string\n  userAvatar?: JSX.Element\n  additionalHeaderMessage?: JSX.Element\n  viewerDidAuthor?: boolean\n  /**\n   * The login of the author of the subject of the comment.\n   *\n   * e.g. the login of the author of the issue, pull request, commit the comment is on.\n   */\n  commentSubjectAuthorLogin?: string\n  hideActions?: boolean\n  isReply?: boolean\n  commentAuthorType?: string\n  /**\n   * The type of the subject that the comment is associated to.\n   * Used as display text in the subject author tooltip.\n   */\n  commentSubjectType?: CommentSubjectTypes\n  headingProps?: {\n    as: 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6'\n  }\n  lazyFetchEditHistory?: boolean\n  id?: string\n} & SxProp\n\nexport function CommentHeader({hideActions, lazyFetchEditHistory = false, ...props}: CommentHeaderProps) {\n  let editHistoryComponent = null\n\n  if (lazyFetchEditHistory) {\n    editHistoryComponent = <MarkdownEditHistoryViewerQueryComponent id={props.comment.id} />\n  } else {\n    editHistoryComponent = <MarkdownEditHistoryViewer editHistory={props.comment} />\n  }\n\n  return (\n    <ActivityHeader\n      {...props}\n      actions={hideActions ? undefined : <CommentActions {...props} editHistoryComponent={editHistoryComponent} />}\n    />\n  )\n}\n\ntry{ CommentHeader.displayName ||= 'CommentHeader' } catch {}","import {Box} from '@primer/react'\n\ntype CompactCommentButtonProps = {\n  onClick: () => void\n  id?: string\n  children: React.ReactNode\n}\n\nexport const CompactCommentButton = ({onClick, id, children}: CompactCommentButtonProps) => (\n  <Box\n    as=\"button\"\n    type=\"button\"\n    id={id}\n    sx={{\n      display: 'flex',\n      flexDirection: 'row',\n      alignItems: 'center',\n      justifyContent: 'left',\n      fontWeight: 400,\n      color: 'fg.muted',\n      width: '100%',\n      backgroundColor: 'canvas.default',\n      border: '1px solid',\n      borderColor: 'border.default',\n      cursor: 'text',\n      borderRadius: 2,\n      height: 'var(--control-medium-size)',\n      lineHeight: 'var(--text-body-lineHeight-medium)',\n      px: 2,\n    }}\n    onClick={onClick}\n  >\n    {children}\n  </Box>\n)\n\ntry{ CompactCommentButton.displayName ||= 'CompactCommentButton' } catch {}","import {copyText} from '@github-ui/copy-to-clipboard'\nimport {noop} from '@github-ui/noop'\nimport {AlertIcon, CopyIcon, GitCommitIcon} from '@primer/octicons-react'\nimport {TextInput} from '@primer/react'\nimport {Blankslate} from '@primer/react/drafts'\n\nimport {Panel} from '../components/Panel'\n\nconst BLANK_STATE_DATA = {\n  timeout: {\n    description: 'Try reloading the page, or if the problem persists, view the history locally using this command:',\n    heading: 'Commit history cannot be loaded',\n    icon: <AlertIcon size=\"medium\" className=\"mb-2 fgColor-muted\" />,\n    showTextInput: true,\n  },\n  unavailable: {\n    description: \"There isn't any commit history to show here.\",\n    heading: 'No commits history',\n    icon: <GitCommitIcon size=\"medium\" />,\n    showTextInput: false,\n  },\n}\n\nexport type CommitsBlankStateProps = {\n  timeoutMessage: string\n  unavailableMessage?: string\n}\n\nexport function CommitsBlankState({timeoutMessage, unavailableMessage}: CommitsBlankStateProps) {\n  const blankStateReason = timeoutMessage !== '' ? 'timeout' : 'unavailable'\n  const data = BLANK_STATE_DATA[blankStateReason]\n  const description = unavailableMessage ?? data.description\n\n  return (\n    <Panel>\n      <div data-hpc>\n        <Blankslate border={false} spacious={true}>\n          <Blankslate.Visual>{data.icon}</Blankslate.Visual>\n          <Blankslate.Heading>{data.heading}</Blankslate.Heading>\n          <Blankslate.Description>{description}</Blankslate.Description>\n          {data.showTextInput && (\n            <TextInput\n              aria-label={'View commit history locally command'}\n              className=\"d-flex flex-justify-center mt-2\"\n              monospace={true}\n              onChange={noop}\n              readOnly\n              size=\"large\"\n              trailingAction={\n                <TextInput.Action\n                  onClick={() => copyText(timeoutMessage)}\n                  icon={CopyIcon}\n                  aria-label=\"Copy to clipboard\"\n                  className=\"fgColor-muted\"\n                />\n              }\n              value={timeoutMessage}\n            />\n          )}\n        </Blankslate>\n      </div>\n    </Panel>\n  )\n}\n\ntry{ CommitsBlankState.displayName ||= 'CommitsBlankState' } catch {}","import type {CommentBoxConfig, CommentBoxHandle} from '@github-ui/comment-box/CommentBox'\nimport {CommentBoxButton} from '@github-ui/comment-box/CommentBoxButton'\nimport {Box} from '@primer/react'\nimport type {BetterSystemStyleObject} from '@primer/react/lib-esm/sx'\nimport {useEffect, useRef, useState} from 'react'\n\nimport {usePersistedDiffCommentData} from '../hooks/use-persisted-comment-data'\nimport type {DiffSide, SuggestedChangesConfiguration} from '../types'\nimport {validateSuggestedChange} from '../util/validate-suggested-change'\nimport {ConversationCommentBox} from './ConversationCommentBox'\n\nexport interface AddCommentEditorProps {\n  batchPending: boolean\n  batchingEnabled: boolean\n  commentBoxConfig: CommentBoxConfig\n  condensed: boolean\n  fileLevelComment?: boolean\n  filePath: string\n  focusOnMount?: boolean\n  isReplying?: boolean\n  lineNumber?: number\n  onAddComment?: (args: {\n    commentText: string\n    onCompleted?: () => void\n    onError: (error: Error) => void\n    submitBatch?: boolean\n  }) => void\n  onCancelComment?: () => void\n  onPersistedCommentExists?: () => void\n  repositoryId: string\n  quotedText?: string\n  side?: DiffSide\n  subjectId: string\n  threadId?: string\n  suggestedChangesConfig?: SuggestedChangesConfiguration\n}\n\nexport function AddCommentEditor({\n  batchPending,\n  batchingEnabled,\n  commentBoxConfig,\n  condensed,\n  fileLevelComment,\n  filePath,\n  focusOnMount,\n  isReplying,\n  lineNumber,\n  onAddComment,\n  onCancelComment,\n  onPersistedCommentExists,\n  quotedText = '',\n  side,\n  subjectId,\n  threadId,\n  suggestedChangesConfig,\n}: AddCommentEditorProps) {\n  const [commentText, setCommentText] = useState(quotedText)\n  const [isSubmitting, setIsSubmitting] = useState<boolean>(false)\n  const [errorMessage, setErrorMessage] = useState<string | undefined>()\n  const editorRef = useRef<CommentBoxHandle>(null)\n\n  const {persistCommentToStorage, removePersistedCommentFromStorage} = usePersistedDiffCommentData({\n    diffSide: side,\n    filePath,\n    line: lineNumber,\n    subjectId,\n    threadId,\n    handlePersistedCommentExists: ({text}) => {\n      if (!text) return\n      setCommentText(text)\n      onPersistedCommentExists?.()\n    },\n    fileLevelComment: !!fileLevelComment,\n  })\n\n  useEffect(() => {\n    if (focusOnMount) {\n      setTimeout(() => {\n        editorRef.current?.scrollIntoView({behavior: 'smooth', block: 'end'})\n        editorRef.current?.focus()\n      }, 100)\n    }\n  }, [focusOnMount])\n\n  const handleAddComment = ({submitBatch}: {submitBatch: boolean}) => {\n    setIsSubmitting(true)\n    setErrorMessage(undefined)\n\n    const suggestedChangedEvaluation = validateSuggestedChange(\n      commentText,\n      suggestedChangesConfig?.sourceContentFromDiffLines ?? '',\n    )\n    if (!suggestedChangedEvaluation.isValid) {\n      setErrorMessage(suggestedChangedEvaluation.errorMessage)\n      setIsSubmitting(false)\n\n      return\n    }\n\n    onAddComment?.({\n      commentText,\n      onCompleted() {\n        setIsSubmitting(false)\n        closeCommentBox()\n      },\n      onError(error) {\n        setIsSubmitting(false)\n        let msg = 'Failed to save comment'\n        if (error.message) {\n          msg = `${msg}: ${error.message}`\n        }\n\n        setErrorMessage(msg)\n      },\n      submitBatch,\n    })\n  }\n\n  const handleAddReviewComment = () => handleAddComment({submitBatch: false})\n  const handleAddSingleComment = () => handleAddComment({submitBatch: true})\n\n  const closeCommentBox = () => {\n    removePersistedCommentFromStorage()\n    setCommentText('')\n    onCancelComment?.()\n  }\n\n  const handleCommentTextChange = (text: string) => {\n    setErrorMessage(undefined)\n    persistCommentToStorage({text})\n    setCommentText(text)\n  }\n\n  // Hide the MarkdownEditor's \"Markdown supported\" footer when the form is condensed\n  const markdownOptionsStyles: BetterSystemStyleObject = {\n    '> div:first-child': {\n      display: condensed || isReplying ? 'none' : 'flex',\n    },\n  }\n  // Stack the markdown actions when the form is condensed\n  const stackMarkdownActions: BetterSystemStyleObject = {\n    '> div:last-child': {display: 'flex', flexDirection: 'column', width: '100%'},\n  }\n\n  const footerStyles: BetterSystemStyleObject = {\n    footer: {\n      justifyContent: isReplying ? 'end' : 'space-between',\n      ...markdownOptionsStyles,\n      ...(condensed && stackMarkdownActions),\n    },\n  }\n\n  return (\n    <Box\n      sx={{\n        display: 'flex',\n        // this fixes the flash errors being displayed to the left of the text box in the same row\n        flexDirection: 'column',\n        // This is here to prevent this component from being rendered with overflow off screen due to the MarkdownEditor\n        // having styling issues with its use of a `<fieldset>` element and the parent `<tr>` and `<td>` elements.\n        fieldset: {\n          minWidth: 0,\n          width: ['100%'],\n        },\n      }}\n    >\n      <ConversationCommentBox\n        ref={editorRef}\n        label=\"Add diff comment\"\n        sx={footerStyles}\n        value={commentText}\n        onChange={handleCommentTextChange}\n        onPrimaryAction={batchingEnabled ? handleAddReviewComment : handleAddSingleComment}\n        userSettings={commentBoxConfig}\n        suggestedChangesConfig={suggestedChangesConfig}\n        markdownErrorMessage={errorMessage}\n      >\n        {onCancelComment && (\n          <CommentBoxButton disabled={isSubmitting} sx={{py: 1, px: 2}} variant=\"default\" onClick={closeCommentBox}>\n            Cancel\n          </CommentBoxButton>\n        )}\n        {!batchPending && (\n          <CommentBoxButton\n            disabled={isSubmitting || !commentText.length}\n            sx={{py: 1, px: 2}}\n            variant={batchingEnabled ? 'default' : 'primary'}\n            onClick={handleAddSingleComment}\n          >\n            {isReplying ? 'Reply' : 'Add comment'}\n          </CommentBoxButton>\n        )}\n        {batchingEnabled && (\n          <CommentBoxButton\n            disabled={isSubmitting || !commentText.length}\n            sx={{py: 1, px: 2}}\n            variant=\"primary\"\n            onClick={handleAddReviewComment}\n          >\n            {batchPending ? 'Add review comment' : 'Start a review'}\n          </CommentBoxButton>\n        )}\n      </ConversationCommentBox>\n    </Box>\n  )\n}\n\ntry{ AddCommentEditor.displayName ||= 'AddCommentEditor' } catch {}","import {VALUES} from '@github-ui/commenting/Values'\nimport {GitHubAvatar} from '@github-ui/github-avatar'\nimport {AlertIcon, InfoIcon, StopIcon} from '@primer/octicons-react'\nimport {Box, Button, Octicon, Text, Truncate} from '@primer/react'\n\nimport type {CommentAuthor, DiffAnnotation} from '../types'\nimport {DiffAnnotationLevels} from '../types'\nimport {AnnotationPresentationMap} from './AnnotationIcon'\n\nconst IconMap = {\n  [DiffAnnotationLevels.Failure]: <Octicon icon={StopIcon} sx={{fill: 'danger.fg'}} />,\n  [DiffAnnotationLevels.Warning]: <Octicon icon={AlertIcon} sx={{fill: 'attention.fg'}} />,\n  [DiffAnnotationLevels.Notice]: <Octicon icon={InfoIcon} sx={{fill: 'fg.muted'}} />,\n}\n\n/**\n * A check annotation\n * Preferred method is to pass in ghostUser from the app payload\n * Because this is a shared package, ghostUser is optional and will default to constants\n */\n\nexport type AnnotationProps = {\n  annotation: DiffAnnotation\n  ghostUser?: CommentAuthor\n}\n\nexport function Annotation({annotation, ghostUser = VALUES.ghostUser}: AnnotationProps) {\n  const lineClampStyles = {\n    display: '-webkit-box',\n    overflow: 'hidden',\n    '-webkit-box-orient': 'vertical',\n    '-webkit-line-clamp': '8',\n    maxWidth: 'unset',\n  }\n\n  const checkSuiteApp = annotation.checkSuite.app\n\n  return (\n    <Box\n      sx={{\n        borderLeft: '6px solid',\n        borderColor: AnnotationPresentationMap[annotation.annotationLevel].primaryColor,\n        p: 4,\n      }}\n    >\n      <Box sx={{display: 'flex', alignItems: 'center', mb: 2}}>\n        {IconMap[annotation.annotationLevel]}\n        <Text sx={{fontWeight: 600, color: 'fg.muted', fontSize: 0, pl: 2}}>\n          {AnnotationPresentationMap[annotation.annotationLevel].ariaLabel}\n        </Text>\n      </Box>\n      <Text\n        sx={{color: AnnotationPresentationMap[annotation.annotationLevel].primaryColor, fontWeight: 600, fontSize: 1}}\n      >\n        {annotation.title}\n      </Text>\n      <Box sx={{mb: 3, mt: 1}}>\n        {annotation.message && (\n          <Text sx={{fontFamily: 'var(--fontStack-monospace)', fontSize: 0, ...lineClampStyles}}>\n            {annotation.message}\n          </Text>\n        )}\n      </Box>\n      <Box sx={{display: 'flex', alignItems: 'center', justifyContent: 'space-between'}}>\n        <Box sx={{flexGrow: 2}}>\n          <GitHubAvatar\n            src={checkSuiteApp?.logoUrl ?? ghostUser.avatarUrl}\n            alt={`${checkSuiteApp?.name ?? ghostUser.login} avatar image`}\n            data-testid=\"check-suite-app-avatar\"\n          />\n          <Truncate\n            sx={{ml: 2, maxWidth: '300px'}}\n            inline={true}\n            title={`${annotation.checkSuite.name} / ${annotation.checkRun.name}`}\n          >\n            <Text sx={{fontWeight: 600, fontSize: 0}}>{annotation.checkSuite.name}</Text> /{' '}\n            <Text sx={{fontSize: 0}}>{annotation.checkRun.name}</Text>\n          </Truncate>\n        </Box>\n        {annotation.checkRun.detailsUrl && (\n          <Button as=\"a\" href={annotation.checkRun.detailsUrl} size=\"small\">\n            View details\n          </Button>\n        )}\n      </Box>\n    </Box>\n  )\n}\n\ntry{ Annotation.displayName ||= 'Annotation' } catch {}","import {XIcon} from '@primer/octicons-react'\nimport {Box, IconButton} from '@primer/react'\n\nimport type {CommentAuthor, DiffAnnotation, MarkerNavigationImplementation} from '../types'\nimport {Annotation} from './Annotation'\nimport {GlobalMarkerNavigation} from './GlobalMarkerNavigation'\n\nexport type AnnotationDialogProps = {\n  annotation: DiffAnnotation\n  markerNavigationImplementation: MarkerNavigationImplementation\n  onClose: () => void\n  ghostUser?: CommentAuthor\n}\n\n/**\n * Show annotation in a dialog\n */\nexport function AnnotationDialog({\n  annotation,\n  markerNavigationImplementation,\n  onClose,\n  ghostUser,\n}: AnnotationDialogProps) {\n  return (\n    <Box sx={{width: 'clamp(240px, 100vw, 540px)'}}>\n      <Box\n        sx={{\n          borderBottom: '1px solid',\n          borderBottomColor: 'border.default',\n          display: 'flex',\n          flexDirection: 'column',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          p: 1,\n          background: 'canvas.default',\n        }}\n      >\n        <Box sx={{display: 'flex', flexDirection: 'row', width: '100%', alignItems: 'center'}}>\n          <GlobalMarkerNavigation\n            markerId={annotation.id}\n            markerNavigationImplementation={markerNavigationImplementation}\n            onNavigate={onClose}\n          />\n          <Box\n            sx={{\n              display: 'flex',\n              flexDirection: 'row',\n              gap: 1,\n              alignItems: 'center',\n              justifyContent: 'right',\n              flexGrow: 1,\n            }}\n          >\n            {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n            <IconButton\n              unsafeDisableTooltip={true}\n              aria-label=\"Close annotation\"\n              icon={XIcon}\n              variant=\"invisible\"\n              onClick={onClose}\n            />\n          </Box>\n        </Box>\n      </Box>\n      <Annotation annotation={annotation} ghostUser={ghostUser} />\n    </Box>\n  )\n}\n\ntry{ AnnotationDialog.displayName ||= 'AnnotationDialog' } catch {}","import styled, {keyframes} from 'styled-components'\n\nimport {DiffAnnotationLevels} from '../types'\n\nexport type AnnotationIconProps = {\n  annotationLevel: DiffAnnotationLevels\n  className?: string\n}\n\n/**\n * Renders an svg corresponding to the given annotation level\n */\nexport function AnnotationIcon({annotationLevel, ...rest}: AnnotationIconProps) {\n  const {icon, ...annotationData} = AnnotationPresentationMap[annotationLevel]\n  return buildAnnotationIcon({...icon, ...annotationData, ...rest})\n}\n\nconst fadeInAnimation = keyframes`\n  0% {opacity: 0;}\n  100% {opacity: 1;}\n`\n/**\n * Renders an annotation icon that fades in\n */\nexport const AnimatedAnnotationIcon = styled(AnnotationIcon)`\n  animation: ${fadeInAnimation} 0.1s ease-in;\n`\n\nfunction buildAnnotationIcon({\n  fill,\n  stroke,\n  ariaLabel,\n  svgHtml,\n  className,\n}: {\n  fill: string\n  stroke: string\n  ariaLabel: string\n  svgHtml: JSX.Element\n  className?: string\n}): JSX.Element {\n  return (\n    <svg\n      aria-label={ariaLabel}\n      className={className}\n      fill={fill}\n      height=\"24\"\n      stroke={stroke}\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      strokeWidth=\"2\"\n      style={{boxShadow: 'none'}}\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      {svgHtml}\n    </svg>\n  )\n}\n\nexport const AnnotationPresentationMap: {\n  [key in DiffAnnotationLevels]: {\n    priority: number\n    ariaLabel: string\n    primaryColor: string\n    icon: {\n      fill: string\n      stroke: string\n      svgHtml: JSX.Element\n    }\n  }\n} = {\n  [DiffAnnotationLevels.Failure]: {\n    priority: 1,\n    ariaLabel: 'Check failure',\n    primaryColor: 'danger.fg',\n    icon: {\n      fill: 'var(--bgColor-danger-emphasis, var(--color-danger-emphasis))',\n      stroke: 'var(--fgColor-onEmphasis, var(--color-fg-on-emphasis))',\n      svgHtml: (\n        <>\n          <circle cx=\"12\" cy=\"12\" r=\"10\" />\n          <line x1=\"15\" x2=\"9\" y1=\"9\" y2=\"15\" />\n          <line x1=\"9\" x2=\"15\" y1=\"9\" y2=\"15\" />\n        </>\n      ),\n    },\n  },\n  [DiffAnnotationLevels.Warning]: {\n    priority: 2,\n    ariaLabel: 'Check warning',\n    primaryColor: 'attention.fg',\n    icon: {\n      fill: 'var(--bgColor-attention-emphasis, var(--color-attention-emphasis))',\n      stroke: 'var(--fgColor-onEmphasis, var(--color-fg-on-emphasis))',\n      svgHtml: (\n        <>\n          <circle cx=\"12\" cy=\"12\" r=\"10\" />\n          <line x1=\"12\" x2=\"12\" y1=\"8\" y2=\"12\" />\n          <line x1=\"12\" x2=\"12\" y1=\"16\" y2=\"16\" />\n        </>\n      ),\n    },\n  },\n  [DiffAnnotationLevels.Notice]: {\n    priority: 3,\n    ariaLabel: 'Check notice',\n    primaryColor: 'fg.muted',\n    icon: {\n      fill: 'var(--bgColor-neutral-emphasis, var(--color-neutral-emphasis))',\n      stroke: 'var(--fgColor-onEmphasis, var(--color-fg-on-emphasis))',\n      svgHtml: (\n        <>\n          <circle cx=\"12\" cy=\"12\" r=\"10\" />\n          <line x1=\"12\" x2=\"12\" y1=\"16\" y2=\"12\" />\n          <line x1=\"12\" x2=\"12\" y1=\"8\" y2=\"8\" />\n        </>\n      ),\n    },\n  },\n}\n\ntry{ AnnotationIcon.displayName ||= 'AnnotationIcon' } catch {}\ntry{ AnimatedAnnotationIcon.displayName ||= 'AnimatedAnnotationIcon' } catch {}","import {Box} from '@primer/react'\nimport {type RefObject, useCallback, useMemo, useRef, useState} from 'react'\n\nimport {useDialogStateContext} from '../contexts/DialogStateContext'\nimport {isSuggestedChangeInPendingBatch, validateSuggestedChangeCanBeAddedToBatch} from '../suggested-changes'\nimport type {CommentingImplementation, SuggestedChange} from '../types'\nimport {AddToExistingBatch} from './CodeSuggestionActions/AddToExistingBatch'\nimport {ApplyOrAddToBatch} from './CodeSuggestionActions/ApplyOrAddToBatch'\nimport {ApplySuggestionDialog} from './CodeSuggestionActions/ApplySuggestionDialog'\nimport {CodeSuggestionUnavailable} from './CodeSuggestionActions/CodeSuggestionUnavailable'\nimport {CommitOrRemoveFromBatch} from './CodeSuggestionActions/CommitOrRemoveFromBatch'\n\nexport function CodeSuggestionActions({\n  commentingImplementation,\n  suggestedChange,\n}: {\n  commentingImplementation: CommentingImplementation\n  suggestedChange: SuggestedChange\n}) {\n  const {setIsDialogOpen} = useDialogStateContext()\n  const [isApplySuggestionsDialogOpen, setIsApplySuggestionsDialogOpen] = useState(false)\n  const returnFocusRef = useRef<RefObject<HTMLElement>>()\n\n  const {pendingSuggestedChangesBatch, submitSuggestedChanges} = commentingImplementation\n  const isPendingInBatch = isSuggestedChangeInPendingBatch(suggestedChange, pendingSuggestedChangesBatch)\n  const batchIsEmpty = pendingSuggestedChangesBatch.length === 0\n  const {isValid, reason} = validateSuggestedChangeCanBeAddedToBatch(suggestedChange, pendingSuggestedChangesBatch)\n\n  // when a change is applied, it's either the single suggestion if it's not pending or the full batch if it is\n  const changesToApply = useMemo(\n    () => (isPendingInBatch ? pendingSuggestedChangesBatch : [suggestedChange]),\n    [isPendingInBatch, pendingSuggestedChangesBatch, suggestedChange],\n  )\n\n  const setDialogOpen = useCallback(\n    (isDialogOpen: boolean) => {\n      setIsApplySuggestionsDialogOpen(isDialogOpen)\n      setIsDialogOpen?.(isDialogOpen)\n    },\n    [setIsDialogOpen],\n  )\n\n  const closeDialog = useCallback(() => {\n    setDialogOpen(false)\n\n    // manually return focus to the button that opened the dialog\n    if (returnFocusRef.current) {\n      const ref = returnFocusRef.current.current\n      setTimeout(() => ref?.focus())\n    }\n  }, [setDialogOpen])\n\n  const openDialog = useCallback(\n    (returnFocusTo?: RefObject<HTMLElement>) => {\n      setDialogOpen(true)\n\n      // store a ref to an element we will return focus to when the dialog closes\n      returnFocusRef.current = returnFocusTo\n    },\n    [setDialogOpen, returnFocusRef],\n  )\n\n  const handleCommit = useCallback(\n    (\n      commitMessage: string,\n      onError: (error: Error, type?: string, friendlyMessage?: string) => void,\n      onCompleted: () => void,\n    ) => {\n      submitSuggestedChanges({\n        suggestedChanges: changesToApply,\n        commitMessage,\n        onCompleted: () => {\n          closeDialog()\n          onCompleted()\n        },\n        onError,\n      })\n    },\n    [closeDialog, submitSuggestedChanges, changesToApply],\n  )\n\n  return (\n    <Box\n      sx={{\n        p: 2,\n        borderTop: '1px solid',\n        borderColor: 'border.default',\n      }}\n    >\n      {isPendingInBatch && (\n        <CommitOrRemoveFromBatch\n          commentingImplementation={commentingImplementation}\n          suggestedChange={suggestedChange}\n          onOpenDialog={openDialog}\n        />\n      )}\n      {!isPendingInBatch && !isValid && reason && <CodeSuggestionUnavailable reason={reason} sx={{m: 0}} />}\n      {!isPendingInBatch && batchIsEmpty && (\n        <ApplyOrAddToBatch\n          commentingImplementation={commentingImplementation}\n          suggestedChange={suggestedChange}\n          onOpenDialog={openDialog}\n        />\n      )}\n      {!isPendingInBatch && isValid && !batchIsEmpty && (\n        <AddToExistingBatch commentingImplementation={commentingImplementation} suggestedChange={suggestedChange} />\n      )}\n      {isApplySuggestionsDialogOpen && (\n        <ApplySuggestionDialog\n          authorLogins={changesToApply.map(change => change.authorLogin)}\n          batchSize={changesToApply.length}\n          onClose={closeDialog}\n          onCommit={handleCommit}\n        />\n      )}\n    </Box>\n  )\n}\n\ntry{ CodeSuggestionActions.displayName ||= 'CodeSuggestionActions' } catch {}","import {useAnalytics} from '@github-ui/use-analytics'\nimport {Box, Button} from '@primer/react'\n\nimport type {CommentingImplementation, SuggestedChange} from '../../types'\n\nexport function AddToExistingBatch({\n  commentingImplementation,\n  suggestedChange,\n}: {\n  suggestedChange: SuggestedChange\n  commentingImplementation: CommentingImplementation\n}) {\n  const {sendAnalyticsEvent} = useAnalytics()\n  return (\n    <Box sx={{display: 'flex', flexDirection: 'row-reverse'}}>\n      <Button\n        variant=\"primary\"\n        onClick={() => {\n          sendAnalyticsEvent('comments.add_suggested_change_to_batch', 'ADD_SUGGESTED_CHANGE_TO_BATCH_BUTTON')\n          commentingImplementation.addSuggestedChangeToPendingBatch(suggestedChange)\n        }}\n      >\n        Add suggestion to batch\n      </Button>\n    </Box>\n  )\n}\n\ntry{ AddToExistingBatch.displayName ||= 'AddToExistingBatch' } catch {}","import {useAnalytics} from '@github-ui/use-analytics'\nimport {TriangleDownIcon} from '@primer/octicons-react'\nimport {ActionList, ActionMenu, Box, Button, ButtonGroup, IconButton} from '@primer/react'\nimport {type RefObject, useCallback, useRef, useState} from 'react'\n\nimport type {CommentingImplementation, SuggestedChange} from '../../types'\n\ntype ApplicationMethod = {\n  text: string\n}\ntype ApplicationMethods = {\n  addSuggestionToBatch: ApplicationMethod\n  applySuggestion: ApplicationMethod\n}\n\nconst applicationMethods: ApplicationMethods = {\n  addSuggestionToBatch: {text: 'Add suggestion to batch'},\n  applySuggestion: {text: 'Apply suggestion'},\n}\n\nexport function ApplyOrAddToBatch({\n  commentingImplementation,\n  onOpenDialog,\n  suggestedChange,\n}: {\n  commentingImplementation: CommentingImplementation\n  onOpenDialog: (returnFocusRef?: RefObject<HTMLElement>) => void\n  suggestedChange: SuggestedChange\n}) {\n  const {sendAnalyticsEvent} = useAnalytics()\n  const [selectedButtonApplicationMethod, setSelectedButtonApplicationMethod] = useState<ApplicationMethod>(\n    applicationMethods.addSuggestionToBatch,\n  )\n  const [isActionMenuOpen, setIsActionMenuOpen] = useState(false)\n  const iconButtonRef = useRef<HTMLButtonElement>(null)\n  const returnFocusRef = useRef<HTMLButtonElement>(null)\n\n  const toggleActionMenuOpen = () => setIsActionMenuOpen(!isActionMenuOpen)\n  const {addSuggestedChangeToPendingBatch} = commentingImplementation\n\n  const handlePrimaryButtonClick = useCallback(() => {\n    if (selectedButtonApplicationMethod === applicationMethods.addSuggestionToBatch) {\n      addSuggestedChangeToPendingBatch(suggestedChange)\n      sendAnalyticsEvent('comments.add_suggested_change_to_batch', 'ADD_SUGGESTED_CHANGE_TO_BATCH_BUTTON')\n    }\n\n    if (selectedButtonApplicationMethod === applicationMethods.applySuggestion) {\n      onOpenDialog(returnFocusRef)\n    }\n  }, [\n    addSuggestedChangeToPendingBatch,\n    onOpenDialog,\n    selectedButtonApplicationMethod,\n    sendAnalyticsEvent,\n    suggestedChange,\n  ])\n\n  return (\n    <Box sx={{display: 'flex', flexDirection: 'row-reverse'}}>\n      <ButtonGroup>\n        <Button variant=\"primary\" onClick={handlePrimaryButtonClick} ref={returnFocusRef}>\n          {selectedButtonApplicationMethod.text}\n        </Button>\n        {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n        <IconButton\n          unsafeDisableTooltip={true}\n          ref={iconButtonRef}\n          aria-haspopup=\"true\"\n          aria-label=\"More suggestion batching options\"\n          icon={TriangleDownIcon}\n          size=\"medium\"\n          variant=\"primary\"\n          onClick={toggleActionMenuOpen}\n        />\n        <ActionMenu anchorRef={iconButtonRef} open={isActionMenuOpen} onOpenChange={toggleActionMenuOpen}>\n          <ActionMenu.Overlay width=\"medium\">\n            <ActionList selectionVariant=\"single\">\n              {(Object.keys(applicationMethods) as [keyof ApplicationMethods]).map(key => {\n                const method = applicationMethods[key]\n                return (\n                  <ActionList.Item\n                    selected={selectedButtonApplicationMethod === method}\n                    key={key}\n                    onSelect={() => setSelectedButtonApplicationMethod(method)}\n                  >\n                    {method.text}\n                  </ActionList.Item>\n                )\n              })}\n            </ActionList>\n          </ActionMenu.Overlay>\n        </ActionMenu>\n      </ButtonGroup>\n    </Box>\n  )\n}\n\ntry{ ApplyOrAddToBatch.displayName ||= 'ApplyOrAddToBatch' } catch {}","import {useAnalytics} from '@github-ui/use-analytics'\nimport useIsMounted from '@github-ui/use-is-mounted'\nimport {FocusKeys} from '@primer/behaviors'\nimport {Box, FormControl, Spinner, Textarea, TextInput, useFocusZone} from '@primer/react'\nimport type {DialogProps} from '@primer/react/drafts'\nimport {Dialog} from '@primer/react/drafts'\nimport {type PropsWithChildren, useCallback, useReducer, useState} from 'react'\n\nfunction DialogFooter({children, footerButtons}: PropsWithChildren<Pick<DialogProps, 'footerButtons'>>) {\n  const {containerRef: footerRef} = useFocusZone({\n    bindKeys: FocusKeys.ArrowHorizontal | FocusKeys.Tab,\n    focusInStrategy: 'closest',\n  })\n  return footerButtons ? (\n    <Dialog.Footer ref={footerRef as React.RefObject<HTMLDivElement>}>\n      <Box sx={{display: 'flex', flexDirection: 'column'}}>\n        <Box sx={{display: 'flex', flexDirection: 'row', gap: 2, justifyContent: 'flex-end'}}>\n          <Dialog.Buttons buttons={footerButtons} />\n        </Box>\n        {children}\n      </Box>\n    </Dialog.Footer>\n  ) : null\n}\n\ntype FormState = {\n  commitMessage: string\n  extendedDescription: string\n}\n\ntype FormAction = {\n  type: ThisType<typeof actions.CHANGE_COMMIT_MESSAGE> | ThisType<typeof actions.CHANGE_EXTENDED_DESCRIPTION>\n  payload: string\n}\n\nconst actions = {\n  CHANGE_COMMIT_MESSAGE: 'CHANGE_COMMIT_MESSAGE',\n  CHANGE_EXTENDED_DESCRIPTION: 'CHANGE_EXTENDED_DESCRIPTION',\n}\n\nconst baseErrorMessage = 'There was an error trying to commit changes'\n\nfunction formReducer(state: FormState, action: FormAction): FormState {\n  switch (action.type) {\n    case actions.CHANGE_COMMIT_MESSAGE: {\n      return {\n        ...state,\n        commitMessage: action.payload,\n      }\n    }\n    case actions.CHANGE_EXTENDED_DESCRIPTION:\n      return {...state, extendedDescription: action.payload}\n    default:\n      // eslint-disable-next-line no-console\n      console.error('Unknown suggested change action.')\n      return state\n  }\n}\n\nfunction getCommitMessage(authorLogins: string[]) {\n  // if there's only one suggestion\n  if (authorLogins.length === 1) {\n    return `Apply suggestion from @${authorLogins[0]}`\n  }\n\n  // if multiple suggestions that all have the same login\n  if (new Set(authorLogins).size === 1) {\n    return `Apply suggestions from @${authorLogins[0]}`\n  }\n\n  // multiple suggestions with different logins\n  return `Apply suggestions from code review`\n}\n\nexport type ApplySuggestionDialogProps = {\n  authorLogins: string[]\n  batchSize: number\n  onClose: () => void\n  onCommit: (\n    commitMessage: string,\n    onError: (error: Error, type?: string, friendlyMessage?: string) => void,\n    onCompleted: () => void,\n  ) => void\n}\n\nexport function ApplySuggestionDialog({authorLogins, batchSize, onClose, onCommit}: ApplySuggestionDialogProps) {\n  const isMounted = useIsMounted()\n  const {sendAnalyticsEvent} = useAnalytics()\n  const [isSubmitting, setIsSubmitting] = useState(false)\n  const [errorMessage, setErrorMessage] = useState<string | undefined>()\n  const [formValues, setFormValues] = useReducer(formReducer, {\n    commitMessage: getCommitMessage(authorLogins),\n    extendedDescription: '',\n  })\n\n  const handleError = useCallback(\n    (_error: Error, _type?: string, friendlyMessage?: string) => {\n      if (!isMounted()) return\n\n      let serverErrorMessage = baseErrorMessage\n      if (friendlyMessage) serverErrorMessage += `: ${friendlyMessage}`\n      else serverErrorMessage += '.'\n\n      setIsSubmitting(false)\n      setErrorMessage(serverErrorMessage)\n    },\n    [isMounted],\n  )\n\n  const handleCompleted = useCallback(() => {\n    if (!isMounted()) return\n    setIsSubmitting(false)\n    if (errorMessage) setErrorMessage(undefined)\n  }, [errorMessage, isMounted])\n\n  const handleOnCommitClick = useCallback(() => {\n    if (isSubmitting) return\n\n    setIsSubmitting(true)\n    sendAnalyticsEvent('comments.commit_suggestion', 'COMMIT_SUGGESTION_DIALOG_BUTTON', {batchSize})\n    onCommit(`${formValues.commitMessage}\\n\\n${formValues.extendedDescription}`, handleError, handleCompleted)\n  }, [\n    batchSize,\n    formValues.commitMessage,\n    formValues.extendedDescription,\n    handleCompleted,\n    handleError,\n    isSubmitting,\n    onCommit,\n    sendAnalyticsEvent,\n  ])\n\n  const renderFooter = () => (\n    <DialogFooter\n      footerButtons={[\n        {content: 'Cancel', onClick: onClose},\n        {\n          content: (\n            <Box as=\"span\" sx={{display: 'flex', flexDirection: 'row', alignItems: 'center'}}>\n              Commit changes{isSubmitting && <Spinner size=\"small\" sx={{ml: 1}} />}\n            </Box>\n          ),\n          onClick: handleOnCommitClick,\n          buttonType: 'primary',\n        },\n      ]}\n    >\n      {errorMessage && (\n        <FormControl.Validation sx={{mt: 2, pt: 1, justifyContent: 'flex-end'}} variant=\"error\">\n          {errorMessage}\n        </FormControl.Validation>\n      )}\n    </DialogFooter>\n  )\n\n  return (\n    <Dialog title=\"Apply suggestion\" renderFooter={renderFooter} onClose={onClose}>\n      <FormControl sx={{mb: 2}}>\n        <FormControl.Label>Commit message</FormControl.Label>\n        <TextInput\n          block\n          name=\"commit_message\"\n          onChange={(event: React.ChangeEvent<HTMLInputElement>) =>\n            setFormValues({type: actions.CHANGE_COMMIT_MESSAGE, payload: event.target.value})\n          }\n          value={formValues.commitMessage}\n        />\n      </FormControl>\n      <FormControl>\n        <FormControl.Label>Extended description (optional)</FormControl.Label>\n        <Textarea\n          block\n          rows={3}\n          placeholder=\"Add an optional description...\"\n          onChange={(event: React.ChangeEvent<HTMLTextAreaElement>) =>\n            setFormValues({type: actions.CHANGE_EXTENDED_DESCRIPTION, payload: event.target.value})\n          }\n          value={formValues.extendedDescription}\n        />\n      </FormControl>\n    </Dialog>\n  )\n}\n\ntry{ DialogFooter.displayName ||= 'DialogFooter' } catch {}\ntry{ ApplySuggestionDialog.displayName ||= 'ApplySuggestionDialog' } catch {}","import {Box, type SxProp, Text} from '@primer/react'\n\nexport function CodeSuggestionUnavailable({reason, sx}: {reason: string} & SxProp) {\n  return (\n    <Box sx={{...{m: 2}, ...sx}}>\n      <Text as=\"small\" sx={{color: 'fg.muted'}}>\n        {reason}\n      </Text>\n    </Box>\n  )\n}\n\ntry{ CodeSuggestionUnavailable.displayName ||= 'CodeSuggestionUnavailable' } catch {}","import {useAnalytics} from '@github-ui/use-analytics'\nimport {Box, Button, Label} from '@primer/react'\nimport {type RefObject, useCallback, useRef} from 'react'\n\nimport type {CommentingImplementation, SuggestedChange} from '../../types'\n\nexport function CommitOrRemoveFromBatch({\n  commentingImplementation,\n  onOpenDialog,\n  suggestedChange,\n}: {\n  commentingImplementation: CommentingImplementation\n  onOpenDialog: (returnFocusRef?: RefObject<HTMLElement>) => void\n  suggestedChange: SuggestedChange\n}) {\n  const returnFocusRef = useRef<HTMLButtonElement>(null)\n  const handleCommitBatchClick = useCallback(() => {\n    onOpenDialog(returnFocusRef)\n  }, [onOpenDialog])\n\n  const batchCount = commentingImplementation.pendingSuggestedChangesBatch.length\n  const {sendAnalyticsEvent} = useAnalytics()\n\n  return (\n    <Box sx={{display: 'flex', justifyContent: 'space-between', flexDirection: 'row'}}>\n      <Label variant=\"attention\" sx={{my: 'auto'}}>\n        Pending in batch\n      </Label>\n      <Box sx={{display: 'flex', gap: 2}}>\n        <Button\n          size=\"medium\"\n          variant=\"danger\"\n          onClick={() => {\n            commentingImplementation.removeSuggestedChangeFromPendingBatch(suggestedChange)\n            sendAnalyticsEvent(\n              'comments.remove_suggested_change_from_batch',\n              'REMOVE_SUGGESTED_CHANGE_FROM_BATCH_BUTTON',\n            )\n          }}\n        >\n          Remove from batch\n        </Button>\n        <Button\n          ref={returnFocusRef}\n          size=\"medium\"\n          count={batchCount}\n          variant=\"primary\"\n          onClick={handleCommitBatchClick}\n        >\n          {`Apply suggestion${batchCount > 1 ? 's' : ''}`}\n        </Button>\n      </Box>\n    </Box>\n  )\n}\n\ntry{ CommitOrRemoveFromBatch.displayName ||= 'CommitOrRemoveFromBatch' } catch {}","import {CommentBox, type CommentBoxHandle, type CommentBoxProps} from '@github-ui/comment-box/CommentBox'\nimport type {SxProp} from '@primer/react'\nimport type {ForwardedRef} from 'react'\nimport type React from 'react'\nimport {forwardRef} from 'react'\n\nimport {useConversationMarkdownSubjectContext} from '../contexts/ConversationMarkdownSubjectContext'\n\ntype ConversationCommentBoxProps = Omit<CommentBoxProps, 'children' | 'body' | 'subject'> & {\n  children?: React.ReactNode\n  label: string\n  value: string\n} & SxProp\n\nexport const ConversationCommentBox = forwardRef(\n  ({children, ...rest}: ConversationCommentBoxProps, ref: ForwardedRef<CommentBoxHandle>) => {\n    const subject = useConversationMarkdownSubjectContext()\n\n    return (\n      <CommentBox\n        {...rest}\n        ref={ref}\n        placeholder=\"Leave a comment\"\n        actions={children}\n        subject={subject ?? undefined}\n        showLabel={false}\n      />\n    )\n  },\n)\n\nConversationCommentBox.displayName = 'ConversationCommentBox'\n","import {ChevronLeftIcon, ChevronRightIcon} from '@primer/octicons-react'\nimport {Box, IconButton, Text} from '@primer/react'\n\nimport type {DiffAnnotation, MarkerNavigationImplementation, NavigationThread} from '../types'\n\n/**\n * Returns the position of this marker in the list of markers for the line, ie. 1 of 4.\n */\nfunction MarkerPosition({markerId, markers}: {markerId: string; markers: Array<NavigationThread | DiffAnnotation>}) {\n  const index = markers.findIndex(marker => marker.id === markerId)\n  return (\n    <Text sx={{color: 'fg.muted'}}>\n      <Text sx={{fontWeight: 500, color: 'fg.default'}}>{index + 1}</Text> of{' '}\n      <Text sx={{fontWeight: 500, color: 'fg.default'}}>{markers.length}</Text>\n    </Text>\n  )\n}\n\nexport type GlobalMarkerNavigationProps = {\n  markerId: string\n  markerNavigationImplementation: MarkerNavigationImplementation\n  onNavigate: () => void\n}\n\n/**\n * Shows the left/right chevrons to navigate through the markers of the pull request\n */\nexport function GlobalMarkerNavigation({\n  markerId,\n  markerNavigationImplementation,\n  onNavigate,\n}: GlobalMarkerNavigationProps) {\n  const {incrementActiveMarker, decrementActiveMarker, filteredMarkers} = markerNavigationImplementation\n  const showGlobalNavigation = filteredMarkers.find(current => current.id === markerId) && filteredMarkers.length > 1\n\n  if (!showGlobalNavigation) return null\n\n  return (\n    <Box sx={{pr: 1, display: 'flex', flexDirection: 'row', alignItems: 'center'}}>\n      {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n      <IconButton\n        unsafeDisableTooltip={true}\n        aria-label=\"Load previous marker\"\n        icon={ChevronLeftIcon}\n        variant=\"invisible\"\n        onClick={() => {\n          decrementActiveMarker(markerId)\n          onNavigate()\n        }}\n      />\n      {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n      <IconButton\n        unsafeDisableTooltip={true}\n        aria-label=\"Load next marker\"\n        icon={ChevronRightIcon}\n        variant=\"invisible\"\n        onClick={() => {\n          incrementActiveMarker(markerId)\n          onNavigate()\n        }}\n      />\n      <Box sx={{ml: 1}}>\n        <MarkerPosition markerId={markerId} markers={filteredMarkers} />\n      </Box>\n    </Box>\n  )\n}\n\ntry{ MarkerPosition.displayName ||= 'MarkerPosition' } catch {}\ntry{ GlobalMarkerNavigation.displayName ||= 'GlobalMarkerNavigation' } catch {}","import type {LineRange} from '@github-ui/diff-lines'\nimport {noop} from '@github-ui/noop'\nimport {AnchoredOverlay, Box, Spinner} from '@primer/react'\nimport {type RefObject, useCallback, useEffect, useMemo, useState} from 'react'\n\nimport {DialogStateProvider, useDialogStateContext} from '../contexts/DialogStateContext'\nimport type {\n  CommentAuthor,\n  CommentingImplementation,\n  ConfigureSuggestedChangesImplementation,\n  DiffAnnotation,\n  MarkerNavigationImplementation,\n  Thread,\n  ThreadSummary,\n} from '../types'\nimport {AnnotationDialog} from './AnnotationDialog'\nimport {MarkersListActionMenu} from './MarkersListActionMenu'\nimport type {ReviewThreadDialogProps} from './ReviewThreadDialog'\nimport {ReviewThreadDialog} from './ReviewThreadDialog'\n\nexport interface MarkersProps\n  extends Pick<\n    ReviewThreadDialogProps,\n    'batchingEnabled' | 'batchPending' | 'repositoryId' | 'subjectId' | 'subject' | 'viewerData'\n  > {\n  annotations: DiffAnnotation[]\n  commentingImplementation: CommentingImplementation\n  conversationAnchorRef: RefObject<HTMLElement>\n  conversationListAnchorRef: RefObject<HTMLElement>\n  conversationListThreads: ThreadSummary[]\n  fileAnchor?: string\n  filePath: string\n  isMarkerListOpen: boolean\n  markerNavigationImplementation: MarkerNavigationImplementation\n  onCloseConversationDialog: () => void\n  onCloseConversationList: () => void\n  onThreadSelected: (threadId: string) => void\n  onAnnotationSelected: (annotationId: string) => void\n  returnFocusRef: RefObject<HTMLElement>\n  selectedThreadId?: string | null\n  selectedAnnotationId?: string | null\n  threadsConnectionId?: string\n  suggestedChangesConfig?: ConfigureSuggestedChangesImplementation\n  ghostUser?: CommentAuthor\n}\n\nexport function Markers(props: MarkersProps) {\n  return (\n    <DialogStateProvider>\n      <MarkersInternal {...props} />\n    </DialogStateProvider>\n  )\n}\n\nfunction MarkersInternal({\n  annotations,\n  commentingImplementation,\n  conversationAnchorRef,\n  conversationListAnchorRef,\n  conversationListThreads,\n  isMarkerListOpen,\n  fileAnchor,\n  filePath,\n  onAnnotationSelected,\n  onCloseConversationDialog,\n  onCloseConversationList,\n  onThreadSelected,\n  returnFocusRef,\n  selectedAnnotationId,\n  selectedThreadId,\n  threadsConnectionId,\n  markerNavigationImplementation,\n  suggestedChangesConfig,\n  ghostUser,\n  ...rest\n}: MarkersProps) {\n  const {isDialogOpen} = useDialogStateContext()\n  const [selectedThread, setSelectedThread] = useState<Thread | undefined>()\n  const {fetchThread} = commentingImplementation\n\n  // Only close the review thread dialog if no descendant dialog is currently open.\n  // AnchoredOverlay uses a click handler that closes the overlay when a click occurs outside of the overlay.\n  // Descendant dialogs are rendered via a portal, so to the handler they appear outside of the overlay.\n  // This means that if a descendant dialog is open, the overlay and the dialog will close when the user clicks on it.\n  const handleCloseConversationDialog = useCallback(\n    () => !isDialogOpen && onCloseConversationDialog(),\n    [isDialogOpen, onCloseConversationDialog],\n  )\n\n  const updateSelectedThread = async (threadId: string) => {\n    setSelectedThread(undefined)\n    const isOutdated = conversationListThreads.find(current => current.id === threadId)?.isOutdated\n    const thread = await fetchThread(threadId, isOutdated)\n    setSelectedThread(thread)\n  }\n\n  const config = useMemo(() => {\n    if (\n      fileAnchor &&\n      selectedThread &&\n      selectedThread.subject?.startDiffSide &&\n      selectedThread.subject?.endDiffSide &&\n      selectedThread.subject?.startLine &&\n      selectedThread.subject?.endLine &&\n      suggestedChangesConfig?.configureSuggestedChangesFromLineRange\n    ) {\n      const startLine = selectedThread.subject?.startLine ?? selectedThread?.subject?.endLine\n      const startDiffSide = selectedThread.subject?.startDiffSide ?? selectedThread?.subject?.endDiffSide\n\n      const threadRowRange: LineRange = {\n        diffAnchor: fileAnchor,\n        endLineNumber: selectedThread?.subject?.endLine,\n        endOrientation: selectedThread.subject?.endDiffSide === 'LEFT' ? 'left' : 'right',\n        startLineNumber: startLine,\n        firstSelectedLineNumber: startLine,\n        firstSelectedOrientation: startDiffSide === 'LEFT' ? 'left' : 'right',\n        startOrientation: startDiffSide === 'LEFT' ? 'left' : 'right',\n      }\n      return suggestedChangesConfig?.configureSuggestedChangesFromLineRange(threadRowRange)\n    }\n\n    return undefined\n  }, [fileAnchor, selectedThread, suggestedChangesConfig])\n\n  useEffect(() => {\n    if (!selectedThreadId && !!selectedThread) {\n      setSelectedThread(undefined)\n    } else if (selectedThreadId && selectedThreadId !== selectedThread?.id) {\n      updateSelectedThread(selectedThreadId)\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [fetchThread, selectedThreadId])\n\n  const hasSelectedMarker = selectedThreadId || selectedAnnotationId\n  const selectedAnnotation = selectedAnnotationId\n    ? annotations.find(annotation => annotation.id === selectedAnnotationId)\n    : undefined\n\n  return (\n    <>\n      {hasSelectedMarker ? (\n        <AnchoredOverlay\n          align=\"end\"\n          anchorRef={conversationAnchorRef}\n          focusZoneSettings={{disabled: true}}\n          open={true}\n          focusTrapSettings={{disabled: true}}\n          renderAnchor={null}\n          overlayProps={{\n            anchorSide: 'outside-right',\n            'aria-label': `${selectedThreadId ? 'Pull Request Review Thread' : 'Pull Request Check Annotation'}`,\n            id: 'conversation-dialog',\n            returnFocusRef,\n            role: 'dialog',\n            sx: {width: 'clamp(240px, 100vw, 540px)', borderRadius: 2},\n            // Prevents default behavior of clicking outside of the overlay auto-closing overlay\n            onClickOutside: noop,\n            onKeyDown: (event: React.KeyboardEvent) => {\n              // Prevent keyboard events from propagating up to the parent elements because their defined `ScopedCommands` component will override comment text area keyboard commands. Only allow \"Escape\" because this key is bound to closing overlays in Primer.\n              // eslint-disable-next-line @github-ui/ui-commands/no-manual-shortcut-logic\n              if (event.key !== 'Escape') event.stopPropagation()\n            },\n          }}\n          onClose={handleCloseConversationDialog}\n        >\n          {selectedThread ? (\n            <ReviewThreadDialog\n              commentingImplementation={commentingImplementation}\n              filePath={filePath}\n              thread={selectedThread}\n              threads={conversationListThreads}\n              threadsConnectionId={threadsConnectionId}\n              onClose={handleCloseConversationDialog}\n              onThreadSelected={onThreadSelected}\n              onRefreshThread={updateSelectedThread}\n              markerNavigationImplementation={markerNavigationImplementation}\n              suggestedChangesConfig={config}\n              ghostUser={ghostUser}\n              {...rest}\n            />\n          ) : selectedAnnotation ? (\n            <AnnotationDialog\n              annotation={selectedAnnotation}\n              markerNavigationImplementation={markerNavigationImplementation}\n              onClose={handleCloseConversationDialog}\n              ghostUser={ghostUser}\n            />\n          ) : (\n            <Box\n              sx={{\n                height: '90px',\n                alignItems: 'center',\n                display: 'flex',\n                flexDirection: 'column',\n                justifyContent: 'center',\n                color: 'fg.muted',\n                fontSize: 0,\n              }}\n            >\n              <Spinner />\n              <p>Loading comments</p>\n            </Box>\n          )}\n        </AnchoredOverlay>\n      ) : (\n        isMarkerListOpen && (\n          <MarkersListActionMenu\n            anchorRef={conversationListAnchorRef}\n            annotations={annotations}\n            handleOpenChange={onCloseConversationList}\n            threads={conversationListThreads}\n            onShowCommentThread={onThreadSelected}\n            onShowAnnotation={onAnnotationSelected}\n            ghostUser={ghostUser}\n          />\n        )\n      )}\n    </>\n  )\n}\n\ntry{ Markers.displayName ||= 'Markers' } catch {}\ntry{ MarkersInternal.displayName ||= 'MarkersInternal' } catch {}","import {VALUES} from '@github-ui/commenting/Values'\nimport {GitHubAvatar} from '@github-ui/github-avatar'\nimport {ArrowRightIcon} from '@primer/octicons-react'\nimport {ActionList, ActionMenu, Box, Octicon, Text} from '@primer/react'\nimport type {RefObject} from 'react'\n\nimport type {CommentAuthor, DiffAnnotation, ThreadSummary} from '../types'\nimport {AnnotationIcon} from './AnnotationIcon'\n\nexport function MarkersListActionMenu({\n  anchorRef,\n  annotations,\n  handleOpenChange,\n  threads,\n  onShowAnnotation,\n  onShowCommentThread,\n  ghostUser = VALUES.ghostUser,\n}: {\n  anchorRef: RefObject<HTMLElement>\n  annotations: DiffAnnotation[]\n  handleOpenChange: (isOpen: boolean) => void\n  threads: ThreadSummary[]\n  onShowAnnotation: (annotationId: string) => void\n  onShowCommentThread: (threadId: string) => void\n  ghostUser?: CommentAuthor\n}) {\n  function lineClampStyles(numberOfLines: number) {\n    return {\n      display: '-webkit-box',\n      overflow: 'hidden',\n      '-webkit-box-orient': 'vertical',\n      '-webkit-line-clamp': numberOfLines.toString(),\n      maxWidth: 'unset',\n    }\n  }\n\n  return (\n    <ActionMenu anchorRef={anchorRef} open onOpenChange={handleOpenChange}>\n      <ActionMenu.Overlay width=\"small\">\n        <div>\n          <ActionList>\n            {annotations.map(annotation => {\n              return (\n                <ActionList.Item key={annotation.id} onSelect={() => onShowAnnotation(annotation.id)}>\n                  <ActionList.LeadingVisual sx={{mr: 2}}>\n                    <AnnotationIcon key={annotation.id} annotationLevel={annotation.annotationLevel} />\n                  </ActionList.LeadingVisual>\n                  <Box sx={{...lineClampStyles(2)}}>\n                    {annotation.checkSuite.name} /{' '}\n                    <Text sx={{fontWeight: 400, color: 'fg.muted'}}>{annotation.checkRun.name}</Text>\n                  </Box>\n                  <ActionList.Description variant=\"block\">\n                    <Box sx={{...lineClampStyles(1)}}>{annotation.title}</Box>\n                  </ActionList.Description>\n                  <ActionList.TrailingVisual>\n                    <Octicon icon={ArrowRightIcon} />\n                  </ActionList.TrailingVisual>\n                </ActionList.Item>\n              )\n            })}\n            {threads.map(thread => (\n              <ActionList.Item key={thread.id} onSelect={() => onShowCommentThread(thread.id)}>\n                <ActionList.LeadingVisual sx={{mr: 2}}>\n                  <GitHubAvatar\n                    alt={thread.author.login}\n                    size={20}\n                    src={thread.author.avatarUrl ?? ghostUser.avatarUrl}\n                  />\n                </ActionList.LeadingVisual>\n                Thread by {thread.author.login}\n                <ActionList.Description variant=\"block\">\n                  {thread.commentCount} comment{thread.commentCount > 1 ? 's' : ''}\n                </ActionList.Description>\n                <ActionList.TrailingVisual>\n                  <Octicon icon={ArrowRightIcon} />\n                </ActionList.TrailingVisual>\n              </ActionList.Item>\n            ))}\n          </ActionList>\n        </div>\n      </ActionMenu.Overlay>\n    </ActionMenu>\n  )\n}\n\ntry{ MarkersListActionMenu.displayName ||= 'MarkersListActionMenu' } catch {}","import {CompactCommentButton} from '@github-ui/commenting/CompactCommentButton'\nimport {useAnalytics} from '@github-ui/use-analytics'\nimport {Box} from '@primer/react'\nimport {useState} from 'react'\n\nimport {anchorComment} from '../helpers'\nimport {generateSuggestedChangeLineRangeFromDiffThread} from '../suggested-changes'\nimport type {CommentAuthor, Thread} from '../types'\nimport type {AddCommentEditorProps} from './AddCommentEditor'\nimport {AddCommentEditor} from './AddCommentEditor'\nimport type {ReviewThreadCommentProps} from './ReviewThreadComment'\nimport {ReviewThreadComment} from './ReviewThreadComment'\nimport {StaticUnifiedDiffPreview} from './StaticUnifiedDiffPreview'\n\nexport interface ReviewThreadProps\n  extends Pick<\n      ReviewThreadCommentProps,\n      'commentingImplementation' | 'repositoryId' | 'subjectId' | 'subject' | 'viewerData'\n    >,\n    Pick<AddCommentEditorProps, 'batchingEnabled' | 'batchPending' | 'suggestedChangesConfig'> {\n  commentAnchorPrefix?: string\n  commentsConnectionId?: string\n  filePath: string\n  hideDiffPreview?: boolean\n  onRefreshThread?: (threadId: string) => void\n  tabSize?: number\n  thread: Thread\n  threadsConnectionId?: string\n  shouldLimitHeight?: boolean\n  ghostUser?: CommentAuthor\n}\n\n/**\n * Renders a given review thread's comments along with a reply comment box.\n *\n * TODO:\n * - Support paginated loading of large review threads.\n * - Better support for deleted comment authors.\n */\nexport function ReviewThread({\n  batchingEnabled,\n  batchPending,\n  commentAnchorPrefix,\n  commentingImplementation,\n  commentsConnectionId,\n  filePath,\n  hideDiffPreview,\n  onRefreshThread,\n  repositoryId,\n  subject,\n  subjectId,\n  tabSize,\n  thread,\n  threadsConnectionId,\n  shouldLimitHeight = true,\n  suggestedChangesConfig,\n  viewerData,\n  ghostUser,\n}: ReviewThreadProps) {\n  const [isReplying, setIsReplying] = useState(false)\n  const [quoteReplyText, setQuoteReplyText] = useState<string | undefined>(undefined)\n  const {sendAnalyticsEvent} = useAnalytics()\n  const {addThreadReply} = commentingImplementation\n\n  const addReplyComment = ({\n    commentText,\n    onCompleted,\n    onError,\n    submitBatch,\n  }: {\n    commentText: string\n    onCompleted?: (commentDatabaseId?: number) => void\n    onError: (error: Error) => void\n    submitBatch?: boolean\n  }) => {\n    const commentsConnectionIds = []\n    if (thread.commentsData.__id) commentsConnectionIds.push(thread.commentsData.__id)\n    if (commentsConnectionId) commentsConnectionIds.push(commentsConnectionId)\n\n    const handleCompleted = (commentDatabaseId?: number) => {\n      if (commentDatabaseId) anchorComment(commentDatabaseId.toString())\n      onCompleted?.()\n      onRefreshThread?.(thread.id)\n    }\n\n    addThreadReply({\n      commentsConnectionIds,\n      filePath,\n      thread,\n      text: commentText,\n      submitBatch,\n      onCompleted: handleCompleted,\n      onError,\n      threadsConnectionId,\n    })\n    sendAnalyticsEvent('comments.add', 'ADD_COMMENT_BUTTON')\n  }\n\n  const cancelComment = () => {\n    setIsReplying(false)\n    sendAnalyticsEvent('comments.cancel_thread_reply', 'CANCEL_REVIEW_THREAD_BUTTON')\n  }\n\n  const onQuoteReply = (text?: string) => {\n    setQuoteReplyText(text)\n    setIsReplying(true)\n  }\n\n  if (thread.commentsData.comments === null || thread.commentsData.comments.length < 1) return null\n\n  const lineRange = generateSuggestedChangeLineRangeFromDiffThread(thread)\n  const applySuggestedChangesValidationData =\n    thread.subjectType === 'LINE'\n      ? {\n          lineRange,\n        }\n      : undefined\n\n  return (\n    <div data-testid=\"review-thread\">\n      <Box sx={shouldLimitHeight ? {maxHeight: '40vh', overflowY: 'auto'} : {}}>\n        {/**\n         * We always render StaticUnifiedDiffPreview for threads in Activity View above the ReviewThread component.\n         * This additional check will prevent 2 of them being rendered on outdated review threads\n         * TODO: maybe we can move the rendering of this to be in the ReviewDialog component to avoid conditional logic in a future PR?\n         * */}\n        {!hideDiffPreview && thread.isOutdated && <StaticUnifiedDiffPreview tabSize={tabSize ?? 4} thread={thread} />}\n        {thread.commentsData.comments.map((comment, index) => {\n          return (\n            <ReviewThreadComment\n              isAnchorable\n              index={index}\n              isLastChild={index === thread.commentsData.comments.length - 1}\n              key={comment.id}\n              anchorPrefix={commentAnchorPrefix}\n              comment={comment}\n              commentConnectionId={thread.commentsData.__id}\n              commentingImplementation={commentingImplementation}\n              filePath={filePath}\n              isOutdated={thread.isOutdated}\n              repositoryId={repositoryId}\n              subject={subject}\n              subjectId={subjectId}\n              threadId={thread.id}\n              onRefreshThread={onRefreshThread}\n              onQuoteReply={onQuoteReply}\n              threadCommentCount={thread.commentsData.comments.length}\n              threadsConnectionId={threadsConnectionId}\n              isThreadResolved={!!thread.isResolved}\n              suggestedChangesConfig={suggestedChangesConfig}\n              applySuggestedChangesValidationData={applySuggestedChangesValidationData}\n              viewerData={viewerData}\n              ghostUser={ghostUser}\n            />\n          )\n        })}\n        {thread.viewerCanReply && (\n          <Box\n            sx={{\n              backgroundColor: 'canvas.inset',\n              borderBottomLeftRadius: 2,\n              borderBottomRightRadius: 2,\n              p: 2,\n            }}\n          >\n            {isReplying && (\n              <AddCommentEditor\n                batchingEnabled={batchingEnabled}\n                batchPending={batchPending}\n                commentBoxConfig={commentingImplementation.commentBoxConfig}\n                condensed={false}\n                fileLevelComment={true}\n                filePath={filePath}\n                focusOnMount={true}\n                isReplying={true}\n                onCancelComment={cancelComment}\n                repositoryId={repositoryId}\n                quotedText={quoteReplyText}\n                subjectId={subjectId}\n                threadId={thread.id}\n                onAddComment={addReplyComment}\n                suggestedChangesConfig={suggestedChangesConfig}\n              />\n            )}\n            {!isReplying && (\n              <CompactCommentButton\n                onClick={() => {\n                  sendAnalyticsEvent('comments.start_thread_reply', 'REPLY_TO_THREAD_INPUT_BUTTON')\n                  setIsReplying(true)\n                }}\n              >\n                Write a reply\n              </CompactCommentButton>\n            )}\n          </Box>\n        )}\n      </Box>\n    </div>\n  )\n}\n\ntry{ ReviewThread.displayName ||= 'ReviewThread' } catch {}","import {CommentBoxButton, type CommentBoxHandle} from '@github-ui/comment-box/CommentBox'\nimport {CommentHeader} from '@github-ui/commenting/CommentHeader'\nimport {VALUES} from '@github-ui/commenting/Values'\nimport {noop} from '@github-ui/noop'\nimport {ReactionViewer, ReactionViewerQueryComponent} from '@github-ui/reaction-viewer/ReactionViewer'\nimport {ReactionViewerLoading} from '@github-ui/reaction-viewer/ReactionViewerLoading'\nimport type {SafeHTMLString} from '@github-ui/safe-html'\nimport {SafeHTMLBox} from '@github-ui/safe-html'\nimport {ssrSafeLocation} from '@github-ui/ssr-utils'\n// eslint-disable-next-line no-restricted-imports\nimport {useToastContext} from '@github-ui/toast/ToastContext'\nimport {Box} from '@primer/react'\nimport {Suspense, useCallback, useEffect, useRef, useState} from 'react'\n\nimport {anchorComment} from '../helpers'\nimport {usePersistedDiffCommentData} from '../hooks/use-persisted-comment-data'\nimport type {\n  ApplySuggestedChangesValidationData,\n  Comment,\n  CommentAuthor,\n  CommentingImplementation,\n  Subject,\n  SuggestedChangesConfiguration,\n  ViewerData,\n} from '../types'\nimport {validateSuggestedChange} from '../util/validate-suggested-change'\nimport {ConversationCommentBox} from './ConversationCommentBox'\nimport {SuggestedChangeView} from './SuggestedChangeView'\n\ntype CommentState = 'editing' | 'hidden' | 'visible'\n\nexport interface ReviewThreadCommentProps {\n  anchorPrefix?: string\n  comment: Comment\n  commentConnectionId?: string\n  commentingImplementation: CommentingImplementation\n  filePath: string\n  hideActions?: boolean\n  index?: number\n  /**\n   * If true, the comment will scroll itself into view and show a blue border\n   * when the component renders with a hash that matches the comment.\n   */\n  isAnchorable?: boolean\n  isLastChild?: boolean\n  isOutdated?: boolean\n  isThreadResolved: boolean\n  onRefreshThread?: (threadId: string) => void\n  onQuoteReply?: (quotedText?: string) => void\n  repositoryId: string\n  subject?: Subject\n  subjectId: string\n  suggestedChangesConfig?: SuggestedChangesConfiguration\n  applySuggestedChangesValidationData?: ApplySuggestedChangesValidationData\n  threadCommentCount?: number\n  threadId: string\n  threadsConnectionId?: string\n  viewerData?: ViewerData\n  ghostUser?: CommentAuthor\n}\n\nexport function ReviewThreadComment({\n  isAnchorable = false,\n  index = 0,\n  isLastChild,\n  isOutdated,\n  isThreadResolved,\n  anchorPrefix = 'r',\n  comment,\n  commentingImplementation,\n  filePath,\n  hideActions,\n  onRefreshThread,\n  onQuoteReply = noop,\n  subjectId,\n  subject,\n  threadCommentCount,\n  threadId,\n  threadsConnectionId,\n  suggestedChangesConfig,\n  applySuggestedChangesValidationData,\n  viewerData,\n  ghostUser = VALUES.ghostUser,\n}: ReviewThreadCommentProps): JSX.Element {\n  const {addToast} = useToastContext()\n  const [isEditing, setIsEditing] = useState(false)\n  const [isMinimized, setIsMinimized] = useState(comment.isHidden)\n  const [bodyText, setBodyText] = useState(comment.body)\n  const [isSubmitting, setIsSubmitting] = useState(false)\n  const [errorMessage, setErrorMessage] = useState<string | undefined>()\n  const {persistCommentToStorage, removePersistedCommentFromStorage} = usePersistedDiffCommentData({\n    subjectId,\n    filePath,\n    fileLevelComment: comment.subjectType === 'FILE',\n    threadId: comment.id,\n    handlePersistedCommentExists: ({text}) => {\n      if (!text) return\n      setBodyText(text)\n    },\n  })\n  const {editComment, deleteComment, hideComment, unhideComment, lazyFetchReactionGroups, lazyFetchEditHistory} =\n    commentingImplementation\n  const commentBoxRef = useRef<CommentBoxHandle>(null)\n  const commentBodyRef = useRef<HTMLDivElement>(null)\n\n  const focusCommentBox = () => {\n    commentBoxRef.current?.focus()\n  }\n\n  useEffect(() => {\n    if (isEditing) {\n      setTimeout(focusCommentBox)\n    }\n  }, [isEditing])\n\n  const onDelete = () => {\n    deleteComment({\n      commentId: comment.id,\n      onCompleted: () => {\n        onRefreshThread?.(threadId)\n      },\n      onError: () => {\n        setIsSubmitting(false)\n        // eslint-disable-next-line @github-ui/dotcom-primer/toast-migration\n        addToast({\n          type: 'error',\n          message: 'Failed to delete comment',\n        })\n      },\n      threadCommentCount,\n      threadId,\n      threadsConnectionId,\n      filePath,\n    })\n  }\n\n  const onHide = (reason: string) => {\n    hideComment({\n      commentId: comment.id,\n      reason,\n      onCompleted: () => {\n        onRefreshThread?.(threadId)\n      },\n      onError: () => {\n        setIsSubmitting(false)\n        // eslint-disable-next-line @github-ui/dotcom-primer/toast-migration\n        addToast({\n          type: 'error',\n          message: 'Failed to hide comment',\n        })\n      },\n    })\n  }\n\n  const onUnhide = () => {\n    unhideComment({\n      commentId: comment.id,\n      onCompleted: () => {\n        onRefreshThread?.(threadId)\n      },\n      onError: () => {\n        setIsSubmitting(false)\n        // eslint-disable-next-line @github-ui/dotcom-primer/toast-migration\n        addToast({\n          type: 'error',\n          message: 'Failed to unhide comment',\n        })\n      },\n    })\n  }\n\n  const onEdit = () => {\n    setIsEditing(true)\n  }\n\n  const onCancel = () => {\n    setIsEditing(false)\n    removePersistedCommentFromStorage()\n    setBodyText(comment.body)\n  }\n\n  const onChange = (newBody: string) => {\n    persistCommentToStorage({text: newBody})\n    setBodyText(newBody)\n    setErrorMessage(undefined)\n  }\n\n  const onSave = useCallback(() => {\n    setIsSubmitting(true)\n\n    const suggestedChangedEvaluation = validateSuggestedChange(\n      bodyText,\n      suggestedChangesConfig?.sourceContentFromDiffLines ?? '',\n    )\n    if (!suggestedChangedEvaluation.isValid) {\n      setErrorMessage(suggestedChangedEvaluation.errorMessage)\n      setIsSubmitting(false)\n\n      return\n    }\n\n    editComment({\n      text: bodyText,\n      comment,\n      onCompleted: () => {\n        setIsEditing(false)\n        setIsSubmitting(false)\n        removePersistedCommentFromStorage()\n        onRefreshThread?.(threadId)\n      },\n      onError: () => {\n        setIsSubmitting(false)\n        // eslint-disable-next-line @github-ui/dotcom-primer/toast-migration\n        addToast({\n          type: 'error',\n          message: 'Failed to update comment',\n        })\n      },\n    })\n  }, [\n    addToast,\n    bodyText,\n    comment,\n    editComment,\n    onRefreshThread,\n    removePersistedCommentFromStorage,\n    suggestedChangesConfig,\n    threadId,\n  ])\n\n  // if the hash is `#r42`, this will be `r42`\n  const commentId = comment.currentDiffResourcePath?.split('#r').pop()\n  const commentAnchor = commentId ? `${anchorPrefix}${commentId}` : undefined\n  const commentHref =\n    commentAnchor && ssrSafeLocation\n      ? new URL(`${ssrSafeLocation.pathname}#${commentAnchor}`, ssrSafeLocation.origin).toString()\n      : undefined\n  const containerRef = useRef<HTMLDivElement>(null)\n\n  // This mirrors what we do in dotcom currently, see `progressive.ts`. By clicking\n  // the link we're able to let the browser apply the `:target` pseudo class to the\n  // container and scroll it into view.\n  useEffect(() => {\n    if (!isAnchorable) return\n\n    if (commentId && commentAnchor && window.location.hash.split('#').pop() === commentAnchor) {\n      anchorComment(commentId, anchorPrefix)\n      containerRef.current?.focus()\n    }\n  }, [anchorPrefix, commentAnchor, commentId, isAnchorable])\n\n  const blueFocusOutlineStyles = {\n    outline: `2px solid`,\n    outlineColor: 'accent.fg',\n    outlineOffset: `-2px`,\n    boxShadow: 'none',\n  }\n\n  const isReply = index > 0\n  const isNestedReply = index > 1\n  const areSuggestedChangesEnabled = commentingImplementation.suggestedChangesEnabled\n\n  const commentState: CommentState = isEditing ? 'editing' : isMinimized ? 'hidden' : 'visible'\n\n  return (\n    <Box\n      ref={containerRef}\n      id={isAnchorable ? commentAnchor : undefined}\n      tabIndex={-1}\n      sx={{\n        '&:not(:first-child)': {\n          backgroundColor: 'canvas.inset',\n        },\n        '&:first-child + div': {\n          borderTop: '1px solid',\n          borderColor: 'border.muted',\n        },\n        ':target': blueFocusOutlineStyles,\n        ':focus': blueFocusOutlineStyles,\n        pb: isReply ? 0 : 2,\n      }}\n    >\n      {isNestedReply && (\n        <Box sx={{display: 'flex', pl: isReply ? 1 : 0}}>\n          <Box\n            sx={{\n              ml: 4,\n              height: 8,\n              borderLeft: '1px solid',\n              borderColor: 'border.default',\n            }}\n          />\n        </Box>\n      )}\n      <Box sx={{px: 3, pt: isNestedReply ? 0 : 2, pb: 0}}>\n        <CommentHeader\n          headingProps={{as: 'h5'}}\n          avatarUrl={comment.author?.avatarUrl ?? ghostUser.avatarUrl}\n          comment={{\n            ...comment,\n            url: commentHref ?? '',\n            referenceText: comment.reference.text ?? `#${comment.reference.number}`,\n          }}\n          commentRef={containerRef}\n          deleteComment={onDelete}\n          editComment={onEdit}\n          hideComment={onHide}\n          onMinimize={setIsMinimized}\n          isMinimized={isMinimized}\n          commentAuthorLogin={comment.author?.login ?? ghostUser.login}\n          navigate={noop}\n          commentSubjectAuthorLogin={comment.reference?.author?.login ?? ''}\n          commentSubjectType={commentingImplementation.commentSubjectType}\n          onReplySelect={onQuoteReply}\n          unhideComment={onUnhide}\n          hideActions={hideActions}\n          lazyFetchEditHistory={lazyFetchEditHistory}\n          isReply\n        />\n      </Box>\n      <Box sx={{display: 'flex', pl: isReply ? 1 : 0}}>\n        {isReply && (\n          <Box\n            sx={{\n              ml: 4,\n              mr: 1,\n              pl: 3,\n              borderLeft: '1px solid',\n              borderColor: 'border.default',\n              ...(isLastChild && {\n                borderImage:\n                  'linear-gradient(to bottom, var(--borderColor-default, var(--color-border-default)), rgba(0, 0, 0, 0)) 1 100%',\n              }),\n            }}\n          />\n        )}\n\n        {commentState === 'editing' && (\n          <Box sx={{pr: 2, pl: isReply ? 0 : 2, pb: 2, pt: 1, flexGrow: 1}}>\n            <ConversationCommentBox\n              ref={commentBoxRef}\n              label=\"Update comment\"\n              value={bodyText}\n              onChange={onChange}\n              onPrimaryAction={onSave}\n              userSettings={commentingImplementation.commentBoxConfig}\n              suggestedChangesConfig={suggestedChangesConfig}\n              markdownErrorMessage={errorMessage}\n            >\n              <CommentBoxButton variant=\"default\" onClick={onCancel}>\n                Cancel\n              </CommentBoxButton>\n              <CommentBoxButton disabled={isSubmitting || !bodyText.length} variant=\"primary\" onClick={onSave}>\n                Update\n              </CommentBoxButton>\n            </ConversationCommentBox>\n          </Box>\n        )}\n\n        {commentState === 'visible' && (\n          <Box sx={isReply ? {pb: 2, pr: 2, overflowX: 'auto', width: '100%'} : {px: 3, pb: 2, width: '100%'}}>\n            {comment.bodyHTML && (\n              <>\n                <SafeHTMLBox\n                  ref={commentBodyRef}\n                  className=\"markdown-body\"\n                  comment-testid={`Comment body html for comment ${comment.id}`}\n                  html={comment.bodyHTML as SafeHTMLString}\n                  sx={{\n                    mt: 1,\n                    fontSize: 1,\n                  }}\n                />\n                <Box sx={{display: 'flex', flexDirection: 'column', mt: 3}}>\n                  {lazyFetchReactionGroups ? (\n                    <Suspense fallback={<ReactionViewerLoading />}>\n                      <ReactionViewerQueryComponent id={comment.id} />\n                    </Suspense>\n                  ) : (\n                    <ReactionViewer reactionGroups={comment} subjectId={comment.id} />\n                  )}\n                </Box>\n                {areSuggestedChangesEnabled && applySuggestedChangesValidationData && (\n                  <SuggestedChangeView\n                    comment={comment}\n                    commentBodyRef={commentBodyRef}\n                    commentingImplementation={commentingImplementation}\n                    filePath={filePath}\n                    isOutdated={isOutdated}\n                    isThreadResolved={isThreadResolved}\n                    threadId={threadId}\n                    suggestedChangesConfig={suggestedChangesConfig}\n                    applySuggestedChangesValidationData={applySuggestedChangesValidationData}\n                    subject={subject}\n                    viewerData={viewerData}\n                  />\n                )}\n              </>\n            )}\n          </Box>\n        )}\n      </Box>\n    </Box>\n  )\n}\n\ntry{ ReviewThreadComment.displayName ||= 'ReviewThreadComment' } catch {}","// eslint-disable-next-line no-restricted-imports\nimport {useToastContext} from '@github-ui/toast/ToastContext'\nimport {useAnalytics} from '@github-ui/use-analytics'\nimport {CheckCircleFillIcon, CheckCircleIcon, XIcon} from '@primer/octicons-react'\nimport {Box, IconButton, Label, Spinner, Text} from '@primer/react'\nimport {Tooltip} from '@primer/react/next'\nimport type {PropsWithChildren} from 'react'\nimport {Suspense} from 'react'\n\nimport type {CommentAuthor, MarkerNavigationImplementation, Thread, ThreadSummary} from '../types'\nimport {GlobalMarkerNavigation} from './GlobalMarkerNavigation'\nimport type {ReviewThreadProps} from './ReviewThread'\nimport {ReviewThread} from './ReviewThread'\n\nfunction Emphasis({children}: PropsWithChildren) {\n  return <Text sx={{fontWeight: 500, color: 'fg.default'}}>{children}</Text>\n}\n\nfunction MultineLineThreadBanner({thread}: {thread?: ThreadSummary}) {\n  if (!thread?.diffSide || !thread.line || !thread.startLine || !thread.startDiffSide) return null\n  const startSideString = thread.startDiffSide === 'LEFT' ? 'L' : 'R'\n  const endSideString = thread.diffSide === 'LEFT' ? 'L' : 'R'\n  return (\n    <Text sx={{color: 'fg.muted'}}>\n       Comment on lines{' '}\n      <Emphasis>\n        {startSideString}\n        {thread.startLine}\n      </Emphasis>{' '}\n      to{' '}\n      <Emphasis>\n        {endSideString}\n        {thread.line}\n      </Emphasis>\n    </Text>\n  )\n}\n\nexport interface ReviewThreadDialogProps\n  extends Pick<\n    ReviewThreadProps,\n    | 'batchingEnabled'\n    | 'batchPending'\n    | 'commentingImplementation'\n    | 'repositoryId'\n    | 'subjectId'\n    | 'subject'\n    | 'suggestedChangesConfig'\n    | 'viewerData'\n  > {\n  filePath: string\n  onClose: () => void\n  onRefreshThread: (threadId: string) => void\n  onThreadSelected: (threadId: string) => void\n  thread: Thread\n  threads: ThreadSummary[]\n  threadsConnectionId?: string\n  markerNavigationImplementation: MarkerNavigationImplementation\n  ghostUser?: CommentAuthor\n}\n\n/**\n * The ReviewThreadDialog opens from the ActionBar when the user selects a conversation.\n */\nexport function ReviewThreadDialog({\n  commentingImplementation,\n  filePath,\n  onClose,\n  onRefreshThread,\n  thread,\n  threads,\n  threadsConnectionId,\n  markerNavigationImplementation,\n  ghostUser,\n  ...rest\n}: ReviewThreadDialogProps) {\n  const {sendAnalyticsEvent} = useAnalytics()\n  const {resolveThread, unresolveThread, resolvingEnabled} = commentingImplementation\n  const threadSummary = threads.find(current => current.id === thread.id)\n  const hasComments = thread.commentsData.comments.length > 0\n\n  const isThreadResolved = !!thread.isResolved\n  const resolvedTokenText = 'Resolved'\n\n  const {addToast} = useToastContext()\n\n  const handleResolveThread = () => {\n    resolveThread({\n      thread,\n      onCompleted: () => onRefreshThread(thread.id),\n      onError: () => {\n        // eslint-disable-next-line @github-ui/dotcom-primer/toast-migration\n        addToast({\n          type: 'error',\n          message: 'Failed to resolve thread',\n        })\n      },\n    })\n\n    sendAnalyticsEvent('comments.resolve_thread', 'RESOLVE_CONVERSATION_BUTTON')\n  }\n\n  const handleUnresolveThread = () => {\n    unresolveThread({\n      thread,\n      onCompleted: () => onRefreshThread(thread.id),\n      onError: () => {\n        // eslint-disable-next-line @github-ui/dotcom-primer/toast-migration\n        addToast({\n          type: 'error',\n          message: 'Failed to unresolve thread',\n        })\n      },\n    })\n\n    sendAnalyticsEvent('comments.unresolve_thread', 'RESOLVE_CONVERSATION_BUTTON')\n  }\n\n  const commentsConnectionId = threadSummary?.commentsConnectionId\n\n  if (!hasComments) return null\n\n  return (\n    <Box sx={{width: 'clamp(240px, 100vw, 540px)'}}>\n      <Box\n        sx={{\n          borderBottom: '1px solid',\n          borderBottomColor: 'border.default',\n          display: 'flex',\n          flexDirection: 'column',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          p: 1,\n          background: 'canvas.default',\n        }}\n      >\n        <Box sx={{display: 'flex', flexDirection: 'row', width: '100%', alignItems: 'center'}}>\n          <>\n            <GlobalMarkerNavigation\n              markerId={thread.id}\n              markerNavigationImplementation={markerNavigationImplementation}\n              onNavigate={onClose}\n            />\n            <MultineLineThreadBanner thread={threadSummary} />\n          </>\n          <Box\n            sx={{\n              display: 'flex',\n              flexDirection: 'row',\n              gap: 1,\n              alignItems: 'center',\n              justifyContent: 'right',\n              flexGrow: 1,\n            }}\n          >\n            {isThreadResolved && (\n              <Label variant=\"done\" size=\"large\">\n                {resolvedTokenText}\n              </Label>\n            )}\n\n            {resolvingEnabled && (\n              <Tooltip\n                text={isThreadResolved ? 'Unresolve conversation' : 'Resolve conversation'}\n                type=\"label\"\n                direction=\"w\"\n                id=\"resolve-conversation\"\n              >\n                {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n                <IconButton\n                  aria-labelledby=\"resolve-conversation\"\n                  unsafeDisableTooltip={true}\n                  icon={isThreadResolved ? CheckCircleFillIcon : CheckCircleIcon}\n                  // need to be specific in order to override default IconButton color\n                  sx={{color: isThreadResolved ? 'var(--fgColor-done, var(--color-done-fg)) !important' : undefined}}\n                  variant=\"invisible\"\n                  onClick={isThreadResolved ? handleUnresolveThread : handleResolveThread}\n                />\n              </Tooltip>\n            )}\n            {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n            <IconButton\n              unsafeDisableTooltip={true}\n              aria-label=\"Close thread\"\n              icon={XIcon}\n              variant=\"invisible\"\n              onClick={onClose}\n            />\n          </Box>\n        </Box>\n      </Box>\n      <Suspense\n        fallback={\n          <Box\n            sx={{\n              height: '90px',\n              alignItems: 'center',\n              display: 'flex',\n              flexDirection: 'column',\n              justifyContent: 'center',\n              color: 'fg.muted',\n              fontSize: 0,\n            }}\n          >\n            <Spinner />\n            <p>Loading comments</p>\n          </Box>\n        }\n      >\n        <ReviewThread\n          commentingImplementation={commentingImplementation}\n          commentsConnectionId={commentsConnectionId}\n          filePath={filePath}\n          onRefreshThread={onRefreshThread}\n          thread={thread}\n          threadsConnectionId={threadsConnectionId}\n          {...rest}\n          ghostUser={ghostUser}\n        />\n      </Suspense>\n    </Box>\n  )\n}\n\ntry{ Emphasis.displayName ||= 'Emphasis' } catch {}\ntry{ MultineLineThreadBanner.displayName ||= 'MultineLineThreadBanner' } catch {}\ntry{ ReviewThreadDialog.displayName ||= 'ReviewThreadDialog' } catch {}","import {noop} from '@github-ui/noop'\nimport {useAnalytics} from '@github-ui/use-analytics'\nimport {AnchoredOverlay} from '@primer/react'\nimport {type RefObject, useMemo} from 'react'\n\nimport type {ConfigureSuggestedChangesImplementation} from '../types'\nimport type {StartThreadCommentProps} from './StartThreadComment'\nimport {StartThreadComment} from './StartThreadComment'\n\nexport interface StartConversationProps\n  extends Pick<\n    StartThreadCommentProps,\n    | 'addCommentDialogTitle'\n    | 'batchPending'\n    | 'batchingEnabled'\n    | 'commentBoxConfig'\n    | 'fileLevelComment'\n    | 'filePath'\n    | 'isLeftSide'\n    | 'lineNumber'\n    | 'onAddComment'\n    | 'repositoryId'\n    | 'subjectId'\n    | 'viewerData'\n    | 'threadsConnectionId'\n  > {\n  align?: 'start' | 'end'\n  anchorRef: RefObject<HTMLElement>\n  isOpen: boolean\n  onCloseCommentDialog: () => void\n  returnFocusRef: RefObject<HTMLElement>\n  suggestedChangesConfig?: ConfigureSuggestedChangesImplementation\n}\n\n/**\n * Renders a modal AnchoredOverlay for starting a new conversation thread\n */\nexport function StartConversation({\n  align = 'end',\n  anchorRef,\n  isOpen,\n  returnFocusRef,\n  onCloseCommentDialog,\n  suggestedChangesConfig,\n  ...rest\n}: StartConversationProps) {\n  const {sendAnalyticsEvent} = useAnalytics()\n\n  const config = useMemo(() => {\n    if (isOpen && suggestedChangesConfig?.configureSuggestedChangesFromLineRange) {\n      return suggestedChangesConfig.configureSuggestedChangesFromLineRange(\n        suggestedChangesConfig?.selectedDiffRowRange,\n        suggestedChangesConfig?.shouldStartNewConversationWithSuggestedChange,\n      )\n    }\n    return undefined\n  }, [isOpen, suggestedChangesConfig])\n\n  if (!isOpen) return null\n\n  return (\n    <AnchoredOverlay\n      align={align}\n      anchorRef={anchorRef}\n      focusZoneSettings={{disabled: true}}\n      open={isOpen}\n      renderAnchor={null}\n      focusTrapSettings={{disabled: true}}\n      overlayProps={{\n        id: 'conversation-dialog',\n        role: 'dialog',\n        width: 'xlarge',\n        returnFocusRef,\n        sx: {\n          borderRadius: 2,\n        },\n        'aria-label': 'Add a comment',\n        // Prevents default behavior of clicking outside of the overlay auto-closing overlay\n        onClickOutside: noop,\n        onKeyDown: (event: React.KeyboardEvent) => {\n          // Prevent keyboard events from propagating up to the parent elements because their defined `ScopedCommands` component will override comment text area keyboard commands. Only allow \"Escape\" because this key is bound to closing overlays in Primer.\n          // eslint-disable-next-line @github-ui/ui-commands/no-manual-shortcut-logic\n          if (event.key !== 'Escape') event.stopPropagation()\n        },\n      }}\n      onClose={onCloseCommentDialog}\n    >\n      <StartThreadComment\n        onClose={() => {\n          onCloseCommentDialog()\n          sendAnalyticsEvent('comments.cancel_thread_reply', 'CANCEL_REVIEW_THREAD_BUTTON')\n        }}\n        suggestedChangesConfig={config}\n        {...rest}\n      />\n    </AnchoredOverlay>\n  )\n}\n\ntry{ StartConversation.displayName ||= 'StartConversation' } catch {}","import {GitHubAvatar} from '@github-ui/github-avatar'\nimport {XIcon} from '@primer/octicons-react'\nimport {Box, Heading, IconButton} from '@primer/react'\n\nimport {anchorComment} from '../helpers'\nimport type {CommentingImplementation} from '../types'\nimport type {AddCommentEditorProps} from './AddCommentEditor'\nimport {AddCommentEditor} from './AddCommentEditor'\n\nexport interface StartThreadCommentProps\n  extends Pick<\n    AddCommentEditorProps,\n    | 'batchPending'\n    | 'batchingEnabled'\n    | 'commentBoxConfig'\n    | 'fileLevelComment'\n    | 'filePath'\n    | 'lineNumber'\n    | 'repositoryId'\n    | 'subjectId'\n    | 'suggestedChangesConfig'\n  > {\n  addCommentDialogTitle?: string\n  isLeftSide: boolean | undefined\n  onAddComment: CommentingImplementation['addThread'] | CommentingImplementation['addFileLevelThread']\n  onClose?: () => void\n  viewerData: {\n    avatarUrl: string\n    login: string\n  }\n  threadsConnectionId?: string\n}\n\n/**\n * The StartThreadComment component is used to render the comment editor when starting a new inline thread.\n */\nexport function StartThreadComment({\n  addCommentDialogTitle,\n  isLeftSide,\n  filePath,\n  lineNumber,\n  onAddComment,\n  onClose,\n  viewerData,\n  threadsConnectionId,\n  ...rest\n}: StartThreadCommentProps) {\n  const handleAddComment = ({\n    commentText,\n    onCompleted,\n    onError,\n    submitBatch,\n  }: {\n    commentText: string\n    onCompleted?: (threadId: string, commentDatabaseId?: number) => void\n    onError: (error: Error) => void\n    submitBatch?: boolean\n  }) => {\n    const handleCompleted = (threadId: string, commentDatabaseId?: number) => {\n      if (commentDatabaseId) anchorComment(commentDatabaseId.toString())\n      onCompleted?.(threadId, commentDatabaseId)\n    }\n\n    onAddComment({\n      text: commentText,\n      onError,\n      onCompleted: handleCompleted,\n      submitBatch,\n      filePath,\n      threadsConnectionId,\n    })\n  }\n\n  return (\n    <Box sx={{px: 2, pb: 2, pt: 1}}>\n      <Box sx={{display: 'flex', justifyContent: 'space-between', alignItems: 'center'}}>\n        <Heading as=\"h4\" sx={{fontSize: 1, ml: 2, py: 2}}>\n          <GitHubAvatar alt={viewerData.login} size={24} src={viewerData.avatarUrl || ''} sx={{mr: 2}} />\n          <span>{addCommentDialogTitle ?? 'Add a comment'}</span>\n        </Heading>\n        {onClose && (\n          // eslint-disable-next-line primer-react/a11y-remove-disable-tooltip\n          <IconButton\n            unsafeDisableTooltip={true}\n            variant=\"invisible\"\n            icon={XIcon}\n            onClick={onClose}\n            aria-label=\"Cancel\"\n          />\n        )}\n      </Box>\n      <AddCommentEditor\n        focusOnMount\n        condensed={false}\n        fileLevelComment={false}\n        filePath={filePath}\n        lineNumber={lineNumber}\n        onAddComment={handleAddComment}\n        onCancelComment={onClose}\n        side={isLeftSide ? 'LEFT' : 'RIGHT'}\n        {...rest}\n      />\n    </Box>\n  )\n}\n\ntry{ StartThreadComment.displayName ||= 'StartThreadComment' } catch {}","import {getBackgroundColor, getLineNumberWidth} from '@github-ui/diffs/diff-line-helpers'\nimport {diffLineFileWrap, HunkKebabIcon, threadLineLocation, UnifiedDiffTable} from '@github-ui/diffs/DiffParts'\nimport type {SafeHTMLString} from '@github-ui/safe-html'\nimport {SafeHTMLDiv} from '@github-ui/safe-html'\nimport {Box, type SxProp, Text} from '@primer/react'\nimport type {BetterSystemStyleObject} from '@primer/react/lib-esm/sx'\nimport {clsx} from 'clsx'\nimport {useMemo} from 'react'\n\nimport type {StaticDiffLine, Thread} from '../types'\n\n/**\n * Presentational component for a non-interactive line number cell\n */\nfunction StaticLineNumberCell({line, children}: {line: StaticDiffLine; children: React.ReactNode}) {\n  return (\n    <td\n      className=\"diff-line-number\"\n      style={{backgroundColor: getBackgroundColor(line.type, true), textAlign: 'center'}}\n    >\n      <code>{children}</code>\n    </td>\n  )\n}\n\n/**\n * Presentational component for a non-interactive hunk cell\n * Note that it spans the entire table row\n */\nfunction StaticHunkCell({line}: {line: StaticDiffLine}) {\n  return (\n    <td\n      colSpan={4}\n      style={{backgroundColor: 'var(--bgColor-accent-muted, var(--color-accent-subtle))', flexGrow: 1}}\n      valign=\"top\"\n    >\n      <Box sx={{display: 'flex', flexDirection: 'row'}}>\n        <HunkKebabIcon />\n        <code className=\"diff-text-cell hunk\">\n          {/* Explicitly mark html as safe because it is server-sanitized */}\n          <SafeHTMLDiv className=\"diff-text-inner color-fg-muted\" html={line.html as SafeHTMLString} />\n        </code>\n      </Box>\n    </td>\n  )\n}\n\n/**\n * Renders a non-interactive row of a unified diff line\n * Specifically for use in outdated threads, which return a slightly different set of difflines\n * This component was derived from the interactive version (CodeDiffLine) in DiffLineTableRow.tsx\n */\nfunction StaticUnifiedDiffRow({line, tabSize}: {line: StaticDiffLine; tabSize: number}) {\n  const isHunkRow = line.type === 'HUNK'\n  const showLeftNumber = line.type !== 'ADDITION'\n  const showRightNumber = line.type !== 'DELETION'\n\n  const {getTextIndent, getPaddingLeft} = useMemo(() => diffLineFileWrap(line.text, tabSize), [line, tabSize])\n  const lineMarker = line.type === 'ADDITION' ? '+' : line.type === 'DELETION' ? '-' : undefined\n  const showLineMarker = !!lineMarker\n\n  return (\n    <tr>\n      {isHunkRow && <StaticHunkCell line={line} />}\n      {!isHunkRow && (\n        <>\n          <StaticLineNumberCell line={line}>{showLeftNumber && line.left}</StaticLineNumberCell>\n          <StaticLineNumberCell line={line}>{showRightNumber && line.right}</StaticLineNumberCell>\n          <td className=\"diff-text-cell\" style={{backgroundColor: getBackgroundColor(line.type, false)}}>\n            <code\n              className={clsx('diff-text syntax-highlighted-line', {\n                addition: line.type === 'ADDITION',\n                deletion: line.type === 'DELETION',\n              })}\n            >\n              {showLineMarker && <span className=\"diff-text-marker\">{lineMarker}</span>}\n              {/* Explicitly mark html as safe because it is server-sanitized */}\n              <SafeHTMLDiv\n                className=\"diff-text-inner\"\n                html={line.html as SafeHTMLString}\n                style={{\n                  backgroundColor: getBackgroundColor(line.type, false),\n                  paddingLeft: getPaddingLeft(),\n                  textIndent: getTextIndent(),\n                }}\n              />\n            </code>\n          </td>\n        </>\n      )}\n    </tr>\n  )\n}\n\nfunction StaticUnifiedDiffLines({\n  sx,\n  lines,\n  lineWidth,\n  tabSize,\n}: {\n  lines: StaticDiffLine[]\n  lineWidth: string\n  tabSize: number\n} & SxProp) {\n  const diffRows = lines.map((diffline, index) => {\n    const line = diffline\n\n    return <StaticUnifiedDiffRow key={index} line={line} tabSize={tabSize} />\n  })\n\n  return (\n    <Box\n      as=\"table\"\n      className=\"tab-size\"\n      data-tab-size={tabSize}\n      sx={{\n        borderTop: 0,\n        borderBottom: 0,\n        borderLeft: 1,\n        borderRight: 1,\n        borderStyle: 'solid',\n        borderColor: 'border.muted',\n        ...sx,\n      }}\n    >\n      <UnifiedDiffTable lineWidth={lineWidth}>{diffRows}</UnifiedDiffTable>\n    </Box>\n  )\n}\n\n/**\n * Renders a static representation of a unified diff\n * Specifically for use in outdated threads, which return a slightly different set of difflines\n */\nexport function StaticUnifiedDiffPreview({\n  sx,\n  tabSize,\n  thread,\n  hideHeaderDetails,\n  diffTableSx,\n}: {tabSize: number; thread: Thread; hideHeaderDetails?: boolean; diffTableSx?: BetterSystemStyleObject} & SxProp) {\n  if (!thread.subject?.diffLines || thread.subject?.diffLines.length < 1) {\n    return null\n  }\n\n  const lineWidth = getLineNumberWidth(thread.subject.diffLines)\n\n  return (\n    <Box\n      sx={{\n        m: 3,\n        border: 0,\n        borderBottomWidth: 6,\n        borderStyle: 'solid',\n        borderColor: 'border.muted',\n        borderBottomLeftRadius: 2,\n        borderBottomRightRadius: 2,\n        ...sx,\n      }}\n    >\n      {!hideHeaderDetails && (\n        <Box\n          sx={{\n            borderWidth: 1,\n            borderStyle: 'solid',\n            borderTopLeftRadius: 2,\n            borderTopRightRadius: 2,\n            borderColor: 'border.muted',\n            color: 'fg.muted',\n            px: 2,\n            py: 1,\n          }}\n        >\n          <Text sx={{fontSize: 0, color: 'fg.muted'}}>\n            Line{' '}\n            {threadLineLocation({\n              originalStartLine: thread.subject.originalStartLine,\n              originalEndLine: thread.subject.originalEndLine,\n              startDiffSide: thread.subject.startDiffSide,\n              endDiffSide: thread.subject.endDiffSide,\n            })}\n            , commit <code>{thread.subject.pullRequestCommit?.commit.abbreviatedOid}</code>\n          </Text>\n        </Box>\n      )}\n      <StaticUnifiedDiffLines\n        lineWidth={lineWidth}\n        lines={thread.subject.diffLines}\n        tabSize={tabSize}\n        sx={diffTableSx}\n      />\n    </Box>\n  )\n}\n\ntry{ StaticLineNumberCell.displayName ||= 'StaticLineNumberCell' } catch {}\ntry{ StaticHunkCell.displayName ||= 'StaticHunkCell' } catch {}\ntry{ StaticUnifiedDiffRow.displayName ||= 'StaticUnifiedDiffRow' } catch {}\ntry{ StaticUnifiedDiffLines.displayName ||= 'StaticUnifiedDiffLines' } catch {}\ntry{ StaticUnifiedDiffPreview.displayName ||= 'StaticUnifiedDiffPreview' } catch {}","import {useLayoutEffect} from '@github-ui/use-layout-effect'\nimport {type RefObject, useState} from 'react'\nimport {createPortal} from 'react-dom'\n\nimport {validateSuggestedChangeCanBeApplied} from '../suggested-changes'\nimport type {\n  ApplySuggestedChangesValidationData,\n  Comment,\n  CommentingImplementation,\n  Subject,\n  SuggestedChange,\n  SuggestedChangesConfiguration,\n  ViewerData,\n} from '../types'\nimport {CodeSuggestionActions} from './CodeSuggestionActions'\nimport {CodeSuggestionUnavailable} from './CodeSuggestionActions/CodeSuggestionUnavailable'\n\nfunction useSuggestedChangesRefs(\n  commentBodyRef: React.RefObject<HTMLDivElement>,\n  comment: Comment,\n  filePath: string,\n  threadId: string,\n  applySuggestedChangesValidationData: ApplySuggestedChangesValidationData,\n) {\n  const [suggestedChangeRefs, setSuggestedChangeRefs] = useState<SuggestedChangeWithRef[] | undefined>()\n\n  // This useLayoutEffect will search the comment body for div.js-apply-changes elements.\n  // The apply changes nodes will be stored in an Array and used as refs with React's createPortal.\n  // The rest of the suggested change info will be stored in state to be used for batching or applying suggestions.\n  // We choose to use useLayoutEffect here because we want to run this code before the comment body is rendered so we don't\n  // flash content.\n  useLayoutEffect(() => {\n    if (!commentBodyRef.current) return\n    if (comment.subjectType !== 'LINE') return\n\n    const renderedApplyChangeElements = [...commentBodyRef.current.getElementsByClassName('js-apply-changes')]\n    if (renderedApplyChangeElements.length > 0) {\n      const suggestedChanges: SuggestedChangeWithRef[] = []\n\n      for (const ref of renderedApplyChangeElements) {\n        const changesBlobEl = ref?.closest('div.js-suggested-changes-blob')\n        if (!changesBlobEl) continue\n        const additionChangesEl = [...changesBlobEl.querySelectorAll('.js-blob-code-addition')]\n        if (!applySuggestedChangesValidationData.lineRange) continue\n\n        suggestedChanges.push({\n          authorLogin: comment.author?.login ?? 'ghost',\n          commentId: comment.id,\n          path: filePath,\n          ref,\n          suggestion: additionChangesEl.map(x => x.textContent!),\n          lineRange: applySuggestedChangesValidationData.lineRange,\n          threadId,\n        })\n      }\n      setSuggestedChangeRefs(suggestedChanges)\n    }\n  }, [\n    applySuggestedChangesValidationData.lineRange,\n    comment.author?.login,\n    comment.bodyHTML,\n    comment.id,\n    comment.subjectType,\n    commentBodyRef,\n    filePath,\n    threadId,\n  ])\n\n  return suggestedChangeRefs\n}\n\ntype SuggestedChangeWithRef = SuggestedChange & {ref: Element}\n\nexport interface SuggestedChangeViewProps {\n  applySuggestedChangesValidationData: ApplySuggestedChangesValidationData\n  comment: Comment\n  commentBodyRef: RefObject<HTMLDivElement>\n  commentingImplementation: CommentingImplementation\n  filePath: string\n  isOutdated?: boolean\n  isThreadResolved: boolean\n  subject?: Subject\n  suggestedChangesConfig?: SuggestedChangesConfiguration\n  threadId: string\n  viewerData?: ViewerData\n}\n\nexport function SuggestedChangeView({\n  applySuggestedChangesValidationData,\n  comment,\n  commentBodyRef,\n  commentingImplementation,\n  filePath,\n  isOutdated,\n  isThreadResolved,\n  subject,\n  suggestedChangesConfig,\n  threadId,\n  viewerData,\n}: SuggestedChangeViewProps): JSX.Element {\n  const suggestedChangeRefs = useSuggestedChangesRefs(\n    commentBodyRef,\n    comment,\n    filePath,\n    threadId,\n    applySuggestedChangesValidationData,\n  )\n\n  return (\n    <>\n      {/* Insert suggested change button group inside of each div.js-apply-changes element. */}\n      {suggestedChangeRefs?.length &&\n        suggestedChangeRefs.map(suggestedChange => {\n          const {isValid, reason} = validateSuggestedChangeCanBeApplied({\n            suggestedChange,\n            isOutdated,\n            isPending: comment.state === 'PENDING',\n            isResolved: isThreadResolved,\n            pullRequestIsClosed: subject?.state !== 'OPEN',\n            pullRequestIsInMergeQueue: !!subject?.isInMergeQueue,\n            userCanApplySuggestion: !!viewerData?.viewerCanApplySuggestion,\n            applySuggestedChangesValidationData,\n            suggestedChangesConfig,\n          })\n          if (!isValid && reason) {\n            return createPortal(<CodeSuggestionUnavailable reason={reason} />, suggestedChange.ref)\n          }\n          return createPortal(\n            <CodeSuggestionActions\n              commentingImplementation={commentingImplementation}\n              suggestedChange={suggestedChange}\n            />,\n            suggestedChange.ref,\n          )\n        })}\n    </>\n  )\n}\n\ntry{ SuggestedChangeView.displayName ||= 'SuggestedChangeView' } catch {}","import type {Subject} from '@github-ui/comment-box/subject'\nimport {createContext, useContext} from 'react'\n\nconst ConversationMarkdownSubjectContext = createContext<Subject | null>(null)\n\nexport const useConversationMarkdownSubjectContext = () => useContext(ConversationMarkdownSubjectContext)\n\nexport const ConversationMarkdownSubjectProvider = ConversationMarkdownSubjectContext.Provider\n\ntry{ ConversationMarkdownSubjectContext.displayName ||= 'ConversationMarkdownSubjectContext' } catch {}","import {createContext, useContext, useMemo, useState} from 'react'\n\ntype DialogStateContextData = {\n  isDialogOpen?: boolean\n  setIsDialogOpen?: (isDialogOpen: boolean) => void\n}\n\nconst DialogStateContext = createContext<DialogStateContextData>({})\n\n/**\n * Simple context that tracks whether a dialog is open or not.\n * Used internally by Conversations to work around issue with having nested Overlays + Dialogs.\n */\nexport function DialogStateProvider({children}: {children: React.ReactNode}) {\n  const [isDialogOpen, setIsDialogOpen] = useState(false)\n  const contextData = useMemo(() => ({isDialogOpen, setIsDialogOpen}), [isDialogOpen, setIsDialogOpen])\n\n  return <DialogStateContext.Provider value={contextData}>{children}</DialogStateContext.Provider>\n}\n\nexport const useDialogStateContext = () => useContext(DialogStateContext)\n\ntry{ DialogStateContext.displayName ||= 'DialogStateContext' } catch {}\ntry{ DialogStateProvider.displayName ||= 'DialogStateProvider' } catch {}","import type {FileDiffReference} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport {AlertIcon, CopilotIcon} from '@primer/octicons-react'\nimport {ActionList, Spinner} from '@primer/react'\nimport {DiffLinesDiscussMenuItem} from '../shared/DiffLinesDiscussMenuItem'\nimport {DiffChatWrapper, type DiffChatWrapperProps} from './DiffChatWrapper'\n\n// wrapper/loader\nexport type CopilotDiffChatBlobActionsMenuItemsProps = DiffChatWrapperProps\nexport const CopilotDiffChatBlobActionsMenuItems: React.FC<CopilotDiffChatBlobActionsMenuItemsProps> = props => (\n  <DiffChatWrapper\n    errorFallback={<MenuItemError />}\n    suspenseFallback={<MenuItemLoading />}\n    Component={BaseCopilotDiffChatBlobActionsMenuItems}\n    {...props}\n  />\n)\n\nconst MenuItemError: React.FC = () => (\n  <>\n    <ActionList.Divider />\n    <ActionList.Item disabled>\n      <ActionList.LeadingVisual>\n        <AlertIcon />\n      </ActionList.LeadingVisual>\n      Copilot failed to load\n    </ActionList.Item>\n  </>\n)\n\nconst MenuItemLoading: React.FC = () => (\n  <>\n    <ActionList.Divider />\n    <ActionList.Item disabled>\n      <ActionList.LeadingVisual>\n        <Spinner size=\"small\" />\n      </ActionList.LeadingVisual>\n      Copilot is loading...\n    </ActionList.Item>\n  </>\n)\n\ninterface BaseCopilotDiffChatBlobActionsMenuItemsProps {\n  fileDiffReference: FileDiffReference\n}\n\n// actual contents\nconst BaseCopilotDiffChatBlobActionsMenuItems: React.FC<BaseCopilotDiffChatBlobActionsMenuItemsProps> = props => (\n  <>\n    <ActionList.Divider />\n    <DiffLinesDiscussMenuItem\n      eventContext={{prx: true}}\n      leadingVisual={<CopilotIcon />}\n      fileDiffReference={props.fileDiffReference}\n    />\n  </>\n)\n\ntry{ CopilotDiffChatBlobActionsMenuItems.displayName ||= 'CopilotDiffChatBlobActionsMenuItems' } catch {}\ntry{ MenuItemError.displayName ||= 'MenuItemError' } catch {}\ntry{ MenuItemLoading.displayName ||= 'MenuItemLoading' } catch {}\ntry{ BaseCopilotDiffChatBlobActionsMenuItems.displayName ||= 'BaseCopilotDiffChatBlobActionsMenuItems' } catch {}","import type {FileDiffReference} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport type {LineRange} from '@github-ui/diff-lines'\nimport {AlertIcon, CopilotIcon} from '@primer/octicons-react'\nimport {ActionList, ActionMenu, Spinner} from '@primer/react'\nimport {useMemo} from 'react'\nimport {DiffLinesAttachMenuItem} from '../shared/DiffLinesAttachMenuItem'\nimport {DiffLinesDiscussMenuItem} from '../shared/DiffLinesDiscussMenuItem'\nimport {DiffLinesExplainMenuItem} from '../shared/DiffLinesExplainMenuItem'\nimport {DiffChatWrapper, type DiffChatWrapperProps} from './DiffChatWrapper'\n\ninterface ContextMenuWrapperProps {\n  selectedRange?: LineRange\n}\n\n// wrapper/loader\nexport const CopilotDiffChatContextMenu: React.FC<DiffChatWrapperProps<ContextMenuWrapperProps>> = ({\n  selectedRange,\n  ...props\n}) => (\n  <DiffChatWrapper\n    errorFallback={<MenuItemError />}\n    suspenseFallback={<MenuItemLoading />}\n    componentProps={{selectedRange}}\n    Component={BaseCopilotDiffChatContextMenu}\n    {...props}\n  />\n)\n\nconst MenuItemError: React.FC = () => (\n  <ActionList.Item disabled>\n    <ActionList.LeadingVisual>\n      <AlertIcon />\n    </ActionList.LeadingVisual>\n    Copilot failed to load\n  </ActionList.Item>\n)\n\nconst MenuItemLoading: React.FC = () => (\n  <ActionList.Item disabled>\n    <ActionList.LeadingVisual>\n      <Spinner size=\"small\" />\n    </ActionList.LeadingVisual>\n    Copilot is loading...\n  </ActionList.Item>\n)\n\ninterface BaseCopilotDiffChatContextMenuProps {\n  fileDiffReference: FileDiffReference\n  selectedRange?: LineRange\n}\n\n// actual contents\nconst BaseCopilotDiffChatContextMenu: React.FC<BaseCopilotDiffChatContextMenuProps> = ({\n  fileDiffReference,\n  selectedRange,\n}) => {\n  const referenceWithRange = useMemo(() => {\n    const ref = {...fileDiffReference}\n    if (selectedRange) {\n      ref.selectedRange = {\n        start: `${selectedRange?.startOrientation[0]?.toUpperCase() ?? ''}${selectedRange?.startLineNumber}`,\n        end: `${selectedRange?.endOrientation[0]?.toUpperCase() ?? ''}${selectedRange?.endLineNumber}`,\n      }\n    }\n    return ref\n  }, [fileDiffReference, selectedRange])\n\n  return (\n    <ActionMenu>\n      <ActionMenu.Anchor>\n        <ActionList.Item>\n          <ActionList.LeadingVisual>\n            <CopilotIcon />\n          </ActionList.LeadingVisual>\n          Copilot\n        </ActionList.Item>\n      </ActionMenu.Anchor>\n\n      <ActionMenu.Overlay>\n        <ActionList>\n          <DiffLinesDiscussMenuItem fileDiffReference={referenceWithRange} eventContext={{prx: true}} />\n          <DiffLinesExplainMenuItem fileDiffReference={referenceWithRange} eventContext={{prx: true}} />\n          <DiffLinesAttachMenuItem fileDiffReference={referenceWithRange} eventContext={{prx: true}} />\n        </ActionList>\n      </ActionMenu.Overlay>\n    </ActionMenu>\n  )\n}\n\ntry{ CopilotDiffChatContextMenu.displayName ||= 'CopilotDiffChatContextMenu' } catch {}\ntry{ MenuItemError.displayName ||= 'MenuItemError' } catch {}\ntry{ MenuItemLoading.displayName ||= 'MenuItemLoading' } catch {}\ntry{ BaseCopilotDiffChatContextMenu.displayName ||= 'BaseCopilotDiffChatContextMenu' } catch {}","import {assertDataPresent} from '@github-ui/assert-data-present'\nimport type {FileDiffReference} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport {ErrorBoundary} from '@github-ui/react-core/error-boundary'\nimport {Suspense, type PropsWithChildren} from 'react'\nimport {graphql, useLazyLoadQuery} from 'react-relay'\nimport {\n  useFileDiffReference,\n  useFileDiffReferenceWithEntryProvided,\n  type CopilotChatFileDiffReferenceData,\n} from '../../use-file-diff-reference'\nimport type {\n  DiffChatWrapper_ComparisonQuery,\n  DiffChatWrapper_ComparisonQuery$variables,\n} from './__generated__/DiffChatWrapper_ComparisonQuery.graphql'\nimport type {\n  DiffChatWrapper_DiffEntryQuery,\n  DiffChatWrapper_DiffEntryQuery$variables,\n} from './__generated__/DiffChatWrapper_DiffEntryQuery.graphql'\nimport type {DiffChatWrapper_ViewerQuery} from './__generated__/DiffChatWrapper_ViewerQuery.graphql'\n\nconst WrapperViewerQuery = graphql`\n  query DiffChatWrapper_ViewerQuery {\n    viewer {\n      isCopilotDotcomChatEnabled\n    }\n  }\n`\n\nconst WrapperComparisonQuery = graphql`\n  query DiffChatWrapper_ComparisonQuery($pullRequestId: ID!, $startOid: String!, $endOid: String!) {\n    pullRequest: node(id: $pullRequestId) {\n      ... on PullRequest {\n        comparison(startOid: $startOid, endOid: $endOid) {\n          ...useFileDiffReference_Comparison\n        }\n      }\n    }\n  }\n`\n\nconst WrapperDiffEntryQuery = graphql`\n  query DiffChatWrapper_DiffEntryQuery($diffEntryId: ID!) {\n    diffEntry: node(id: $diffEntryId) {\n      ... on PullRequestDiffEntry {\n        ...useFileDiffReference_DiffEntry\n      }\n    }\n  }\n`\n// check access first, before loading PR info\n// this is slightly waterfall-ey but once the cache is warmed it shouldn't matter\nexport const CopilotCodeChatAccessLoader: React.FC<PropsWithChildren> = ({children}) => {\n  const {viewer} = useLazyLoadQuery<DiffChatWrapper_ViewerQuery>(WrapperViewerQuery, {})\n  if (!viewer.isCopilotDotcomChatEnabled) return null\n\n  return <>{children}</>\n}\n\n// load PR info, build a FileDiffReference, and render!\nconst CopilotCodeChatReferenceLoader: React.FC<DiffChatLoaderProps<BaseDiffChatWrapperProps>> = ({\n  Component,\n  componentProps,\n  queryVariables,\n}) => {\n  const {pullRequest} = useLazyLoadQuery<DiffChatWrapper_ComparisonQuery>(WrapperComparisonQuery, queryVariables)\n  const {diffEntry} = useLazyLoadQuery<DiffChatWrapper_DiffEntryQuery>(WrapperDiffEntryQuery, queryVariables)\n  assertDataPresent(pullRequest?.comparison)\n  assertDataPresent(diffEntry)\n\n  const fileDiffReference = useFileDiffReference(pullRequest.comparison, diffEntry)\n  return fileDiffReference ? <Component fileDiffReference={fileDiffReference} {...componentProps} /> : null\n}\n\n// load PR info, build a FileDiffReference from provided data, and render!\nconst CopilotCodeChatComparisonLoader: React.FC<DiffChatComparisonLoaderProps<BaseDiffChatWrapperProps>> = ({\n  Component,\n  componentProps,\n  referenceData,\n  queryVariables,\n}) => {\n  const {pullRequest} = useLazyLoadQuery<DiffChatWrapper_ComparisonQuery>(WrapperComparisonQuery, queryVariables)\n  assertDataPresent(pullRequest?.comparison)\n\n  const fileDiffReference = useFileDiffReferenceWithEntryProvided(pullRequest?.comparison, referenceData)\n  return fileDiffReference ? <Component fileDiffReference={fileDiffReference} {...componentProps} /> : null\n}\n\n// prettier-ignore\n// it just formats this terribly and it's easier to read like this\nexport type DiffChatWrapperQueryVariables =\n  DiffChatWrapper_ComparisonQuery$variables &\n  DiffChatWrapper_DiffEntryQuery$variables\n\ninterface BaseDiffChatWrapperProps {\n  errorFallback?: React.ReactNode\n  suspenseFallback?: React.ReactNode\n  componentProps?: object // some fancy generic type would be nice here but it's Probably Fine\n  Component: React.ComponentType<{fileDiffReference: FileDiffReference}>\n}\n\n// the idea here is that the wrapper will either accept pre-loaded data or the variables needed to query for that data\nexport type DiffChatWrapperProps<T = object> = DiffChatLoaderProps<T> | DiffChatComparisonLoaderProps<T>\n\ntype DiffChatLoaderProps<T> = T & {\n  queryVariables: DiffChatWrapperQueryVariables\n  referenceData?: never\n}\n\ntype DiffChatComparisonLoaderProps<T> = T & {\n  referenceData: CopilotChatFileDiffReferenceData\n  queryVariables: DiffChatWrapper_ComparisonQuery$variables\n}\n\n// Wrapper/Loader for components needing a FileDiffReference\nexport const DiffChatWrapper: React.FC<DiffChatWrapperProps<BaseDiffChatWrapperProps>> = ({\n  Component,\n  componentProps,\n  errorFallback = null,\n  suspenseFallback = null,\n  ...props\n}) => (\n  <ErrorBoundary fallback={errorFallback}>\n    <Suspense fallback={suspenseFallback}>\n      <CopilotCodeChatAccessLoader>\n        {props.referenceData ? (\n          <CopilotCodeChatComparisonLoader\n            Component={Component}\n            componentProps={componentProps}\n            referenceData={props.referenceData}\n            queryVariables={props.queryVariables}\n          />\n        ) : (\n          <CopilotCodeChatReferenceLoader\n            Component={Component}\n            componentProps={componentProps}\n            queryVariables={props.queryVariables}\n          />\n        )}\n      </CopilotCodeChatAccessLoader>\n    </Suspense>\n  </ErrorBoundary>\n)\n\ntry{ CopilotCodeChatAccessLoader.displayName ||= 'CopilotCodeChatAccessLoader' } catch {}\ntry{ CopilotCodeChatReferenceLoader.displayName ||= 'CopilotCodeChatReferenceLoader' } catch {}\ntry{ CopilotCodeChatComparisonLoader.displayName ||= 'CopilotCodeChatComparisonLoader' } catch {}\ntry{ DiffChatWrapper.displayName ||= 'DiffChatWrapper' } catch {}","import {publishAddCopilotChatReference} from '@github-ui/copilot-chat/utils/copilot-chat-events'\nimport type {FileDiffReference} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport {sendEvent} from '@github-ui/hydro-analytics'\n// eslint-disable-next-line no-restricted-imports\nimport {useToastContext} from '@github-ui/toast/ToastContext'\nimport {ActionList} from '@primer/react'\n\nexport interface DiffLinesAttachMenuItemProps {\n  fileDiffReference: FileDiffReference\n  eventContext?: Parameters<typeof sendEvent>[1]\n  afterSelect?: () => void\n}\n\nexport const DiffLinesAttachMenuItem: React.FC<DiffLinesAttachMenuItemProps> = ({\n  fileDiffReference,\n  eventContext,\n  afterSelect,\n}) => {\n  const {addToast} = useToastContext()\n\n  const handleAttach = () => {\n    publishAddCopilotChatReference(fileDiffReference)\n    // eslint-disable-next-line @github-ui/dotcom-primer/toast-migration\n    addToast({message: 'Reference added to thread', type: 'success'})\n    sendEvent('copilot.file-diff.add', eventContext)\n    afterSelect?.()\n  }\n\n  return <ActionList.Item onSelect={handleAttach}>Attach to current thread</ActionList.Item>\n}\n\ntry{ DiffLinesAttachMenuItem.displayName ||= 'DiffLinesAttachMenuItem' } catch {}","import {publishOpenCopilotChat} from '@github-ui/copilot-chat/utils/copilot-chat-events'\nimport {CopilotChatIntents, type FileDiffReference} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport {sendEvent} from '@github-ui/hydro-analytics'\nimport {ActionList} from '@primer/react'\nimport type {ReactElement} from 'react'\n\nexport interface DiffLinesDiscussMenuItemProps {\n  fileDiffReference: FileDiffReference\n  leadingVisual?: ReactElement\n  eventContext?: Parameters<typeof sendEvent>[1]\n  afterSelect?: () => void\n}\n\nexport const DiffLinesDiscussMenuItem: React.FC<DiffLinesDiscussMenuItemProps> = ({\n  fileDiffReference,\n  leadingVisual,\n  eventContext,\n  afterSelect,\n}) => {\n  const handleDiscuss = () => {\n    publishOpenCopilotChat({\n      intent: CopilotChatIntents.conversation,\n      references: [fileDiffReference],\n    })\n    sendEvent('copilot.file-diff.discuss', eventContext)\n    afterSelect?.()\n  }\n\n  return (\n    <ActionList.Item onSelect={handleDiscuss}>\n      {leadingVisual && <ActionList.LeadingVisual>{leadingVisual}</ActionList.LeadingVisual>}\n      Ask about this diff\n    </ActionList.Item>\n  )\n}\n\ntry{ DiffLinesDiscussMenuItem.displayName ||= 'DiffLinesDiscussMenuItem' } catch {}","import {publishOpenCopilotChat} from '@github-ui/copilot-chat/utils/copilot-chat-events'\nimport {CopilotChatIntents, type FileDiffReference} from '@github-ui/copilot-chat/utils/copilot-chat-types'\nimport {sendEvent} from '@github-ui/hydro-analytics'\nimport {ActionList} from '@primer/react'\n\nexport interface DiffLinesExplainMenuItemProps {\n  fileDiffReference: FileDiffReference\n  eventContext?: Parameters<typeof sendEvent>[1]\n  afterSelect?: () => void\n}\n\nexport const DiffLinesExplainMenuItem: React.FC<DiffLinesExplainMenuItemProps> = ({\n  fileDiffReference,\n  eventContext,\n  afterSelect,\n}) => {\n  const handleExplain = () => {\n    publishOpenCopilotChat({\n      content: 'Explain',\n      intent: CopilotChatIntents.explainFileDiff,\n      references: [fileDiffReference],\n    })\n    sendEvent('copilot.file-diff.explain', eventContext)\n    afterSelect?.()\n  }\n\n  return <ActionList.Item onSelect={handleExplain}>Explain</ActionList.Item>\n}\n\ntry{ DiffLinesExplainMenuItem.displayName ||= 'DiffLinesExplainMenuItem' } catch {}","// extracted by mini-css-extract-plugin\nexport default {\"filterLoadingHeight\":\"FileFilter-module__filterLoadingHeight--cW8BP\"};","import {SearchIcon, SlidersIcon} from '@primer/octicons-react'\nimport {ActionList, ActionMenu, IconButton, Spinner, TextInput} from '@primer/react'\nimport {useState, type ReactNode} from 'react'\nimport {clsx} from 'clsx'\nimport styles from './FileFilter.module.css'\n\nexport const NO_FILE_EXTENSION = 'No extension'\n\ntype FileFilterInputProps = {\n  filterText?: string\n  onFilterTextChange?: (filterText: string) => void\n}\n\nexport function FileFilterLoading({filterText, onFilterTextChange}: FileFilterInputProps) {\n  return (\n    <div className=\"d-flex flex-nowrap gap-2\">\n      <TextInput\n        block\n        aria-label=\"Filter files\"\n        leadingVisual={SearchIcon}\n        placeholder=\"Filter files\"\n        value={filterText}\n        onChange={event => onFilterTextChange?.(event.target.value)}\n      />\n      <ActionMenu>\n        <ActionMenu.Anchor>\n          {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n          <IconButton unsafeDisableTooltip={true} aria-label=\"Filter\" icon={SlidersIcon} className=\"flex-shrink-0\" />\n        </ActionMenu.Anchor>\n        <ActionMenu.Overlay className={clsx(styles.filterLoadingHeight)}>\n          <div\n            className={clsx(\n              'd-flex',\n              'flex-column',\n              'flex-justify-center',\n              'flex-items-center',\n              styles.filterLoadingHeight,\n            )}\n          >\n            <Spinner size=\"medium\" />\n          </div>\n        </ActionMenu.Overlay>\n      </ActionMenu>\n    </div>\n  )\n}\n\nexport type FileFilterBaseProps = {\n  fileExtensions?: Set<string>\n  unselectedFileExtensions?: Set<string>\n  onFilterChange?: (type: 'selectFileExtension' | 'unselectFileExtension', payload: {extension: string}) => void\n  additionalFilterGroups?: ReactNode\n} & FileFilterInputProps\n\nexport function FileFilterShared({\n  filterText: initialFilterText,\n  onFilterTextChange,\n  fileExtensions,\n  unselectedFileExtensions,\n  onFilterChange,\n  additionalFilterGroups,\n}: FileFilterBaseProps) {\n  const [filterText, setFilterText] = useState(initialFilterText)\n\n  const setSelectedFileFilters = (select: boolean, extension: string) => {\n    const action = select ? 'selectFileExtension' : 'unselectFileExtension'\n    onFilterChange?.(action, {extension})\n  }\n\n  const extensions = Array.from(fileExtensions || [])\n    .filter(ext => ext !== NO_FILE_EXTENSION)\n    .sort()\n  const fileExtensionIsSelected = (ext: string) => !unselectedFileExtensions?.has(ext)\n  const noExtensionPresent = fileExtensions?.has(NO_FILE_EXTENSION)\n\n  return (\n    <div className=\"d-flex flex-nowrap gap-2\">\n      <TextInput\n        block\n        aria-label=\"Filter files\"\n        leadingVisual={SearchIcon}\n        placeholder=\"Filter files\"\n        value={filterText}\n        onChange={event => {\n          setFilterText(event.target.value)\n          onFilterTextChange?.(event.target.value)\n        }}\n      />\n      <ActionMenu>\n        <ActionMenu.Anchor>\n          {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n          <IconButton unsafeDisableTooltip={true} aria-label=\"Filter\" icon={SlidersIcon} className=\"flex-shrink-0\" />\n        </ActionMenu.Anchor>\n        <ActionMenu.Overlay>\n          <ActionList>\n            <ActionList.Group selectionVariant=\"multiple\">\n              <ActionList.GroupHeading>File extensions</ActionList.GroupHeading>\n              {extensions.map((ext: string) => {\n                const selected = fileExtensionIsSelected(ext)\n                return (\n                  <ActionList.Item\n                    key={ext}\n                    selected={selected}\n                    onSelect={() => setSelectedFileFilters(!selected, ext)}\n                  >\n                    {`${ext}`}\n                  </ActionList.Item>\n                )\n              })}\n              {noExtensionPresent && (\n                <ActionList.Item\n                  key={NO_FILE_EXTENSION}\n                  selected={fileExtensionIsSelected(NO_FILE_EXTENSION)}\n                  onSelect={() =>\n                    setSelectedFileFilters(!fileExtensionIsSelected(NO_FILE_EXTENSION), NO_FILE_EXTENSION)\n                  }\n                >\n                  {NO_FILE_EXTENSION}\n                </ActionList.Item>\n              )}\n            </ActionList.Group>\n            {additionalFilterGroups}\n          </ActionList>\n        </ActionMenu.Overlay>\n      </ActionMenu>\n    </div>\n  )\n}\n\ntry{ FileFilterLoading.displayName ||= 'FileFilterLoading' } catch {}\ntry{ FileFilterShared.displayName ||= 'FileFilterShared' } catch {}","import {PlusIcon, TriangleDownIcon} from '@primer/octicons-react'\nimport {ActionList, ActionMenu, Button, ButtonGroup, IconButton, useRefObjectAsForwardedRef} from '@primer/react'\nimport type {RefObject} from 'react'\nimport {forwardRef, useCallback, useRef} from 'react'\n\nimport {useDiffContext} from '../contexts/DiffContext'\nimport {useDiffLineContext} from '../contexts/DiffLineContext'\nimport {useActionBarDialogs} from '../hooks/use-action-bar-dialogs'\nimport {useActionBarFocus} from '../hooks/use-action-bar-focus'\nimport type {DiffLine, CopilotChatFileDiffReferenceData} from '../types'\nimport CommentIndicator from './CommentIndicator'\nimport {CellContextMenu} from './DiffLineTableCellContextMenus'\nimport {InProgressCommentIndicator} from './InProgressCommentIndicator'\n\nconst actionBarPosition: React.CSSProperties = {position: 'absolute', right: '-16px', top: '0px', zIndex: 2}\n/**\n * The ActionBar is a set of buttons that appears on hover or focus of a cell in the diff grid.\n * The buttons will be absolutely positioned to the right side of the diff cell.\n */\ntype ActionBarProps = {\n  authorLogin: string\n  authorAvatarUrl: string\n  cellRef: RefObject<HTMLTableCellElement>\n  showStartConversation: boolean\n  cellId?: string\n  hasDraftComment?: boolean\n  copilotChatReferenceData?: CopilotChatFileDiffReferenceData\n}\n\nconst actionBarButtonSize = '24px'\nconst startConversationButtonWidth = '30px'\n\nexport const ActionBar = forwardRef(function ActionBar(\n  {\n    authorAvatarUrl,\n    authorLogin,\n    cellId,\n    cellRef,\n    showStartConversation,\n    hasDraftComment,\n    copilotChatReferenceData,\n  }: ActionBarProps,\n  dialogReturnFocusRef: React.ForwardedRef<HTMLButtonElement>,\n) {\n  const viewConversationButtonRef = useRef<HTMLButtonElement>(null)\n  const startConversationButtonRef = useRef<HTMLButtonElement>(null)\n  const {commentingEnabled} = useDiffContext()\n  const {diffLine, isRowSelected} = useDiffLineContext()\n  const line = diffLine as DiffLine\n\n  const contextMenuRef = useRef<HTMLButtonElement>(null)\n\n  // When there are no markers, return focus back to start conversation button\n  const returnFocusToRef = viewConversationButtonRef.current ? viewConversationButtonRef : startConversationButtonRef\n\n  useRefObjectAsForwardedRef(dialogReturnFocusRef, returnFocusToRef)\n\n  const totalCommentsCount = line.threadsData?.totalCommentsCount || 0\n  const totalAnnotationsCount = line.annotationsData?.totalCount || 0\n  const totalCommentsAndAnnotationsCount = totalCommentsCount + totalAnnotationsCount\n\n  const hasThreads = totalCommentsAndAnnotationsCount > 0\n\n  const {isActionBarFocused, handleActionBarBlur, handleActionBarFocusCapture, handleActionBarKeydownCapture} =\n    useActionBarFocus({cellRef})\n\n  const {\n    annotations,\n    isContextMenuOpen,\n    openMarkerOrListDialogFromActionBar,\n    startNewConversationFromActionBar,\n    startNewConversationFromActionBarWithSuggestedChange,\n    anyMenuOpen,\n    threads,\n    toggleContextMenu,\n    toggleContextMenuFromActionBar,\n  } = useActionBarDialogs({\n    cellId,\n    actionBarRef: contextMenuRef,\n  })\n\n  const handleActionBarClick = useCallback(\n    (e: React.MouseEvent<HTMLDivElement>) => {\n      if (isRowSelected) e.preventDefault()\n    },\n    [isRowSelected],\n  )\n\n  return (\n    <div aria-hidden={!isActionBarFocused} style={{...actionBarPosition}} className=\"d-flex flex-row\">\n      <ButtonGroup\n        onBlur={handleActionBarBlur}\n        onClick={handleActionBarClick}\n        onFocusCapture={handleActionBarFocusCapture}\n        onKeyDownCapture={handleActionBarKeydownCapture}\n      >\n        {commentingEnabled && (\n          <>\n            {hasThreads && (\n              <Button\n                ref={viewConversationButtonRef}\n                aria-expanded={anyMenuOpen}\n                aria-label=\"View conversations\"\n                size=\"small\"\n                sx={{pt: 0, pb: 0, px: 1, height: actionBarButtonSize}}\n                onClick={event => {\n                  // if there's a single thread or annotation, prevent default so we don't select the cell.\n                  // we'll let the conversation selection logic handle selecting the cell(s) associated to the comment.\n                  if (threads.length === 1 || annotations.length === 1) {\n                    event.preventDefault()\n                  }\n\n                  openMarkerOrListDialogFromActionBar()\n                }}\n              >\n                <CommentIndicator />\n              </Button>\n            )}\n            {showStartConversation && (\n              <>\n                {hasDraftComment ? (\n                  <Button\n                    aria-label=\"Start conversation (comment in progress)\"\n                    size=\"small\"\n                    sx={{pt: 0, pb: 0, px: 1, width: startConversationButtonWidth, height: actionBarButtonSize}}\n                    onClick={startNewConversationFromActionBar}\n                  >\n                    <InProgressCommentIndicator authorAvatarUrl={authorAvatarUrl} authorLogin={authorLogin} />\n                  </Button>\n                ) : (\n                  // eslint-disable-next-line primer-react/a11y-remove-disable-tooltip\n                  <IconButton\n                    unsafeDisableTooltip={true}\n                    aria-label=\"Start conversation\"\n                    ref={startConversationButtonRef}\n                    icon={PlusIcon}\n                    size=\"small\"\n                    sx={{width: startConversationButtonWidth, height: actionBarButtonSize, color: 'fg.muted'}}\n                    onClick={startNewConversationFromActionBar}\n                  />\n                )}\n              </>\n            )}\n          </>\n        )}\n        {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n        <IconButton\n          unsafeDisableTooltip={true}\n          ref={contextMenuRef}\n          aria-haspopup=\"true\"\n          aria-label=\"More actions\"\n          icon={TriangleDownIcon}\n          size=\"small\"\n          sx={{width: actionBarButtonSize, height: actionBarButtonSize, color: 'fg.muted'}}\n          onClick={toggleContextMenuFromActionBar}\n        />\n        <ActionMenu anchorRef={contextMenuRef} open={isContextMenuOpen} onOpenChange={toggleContextMenu}>\n          <ActionMenu.Overlay width=\"medium\">\n            <ActionList>\n              <CellContextMenu\n                copilotChatReferenceData={copilotChatReferenceData}\n                showStartConversation={showStartConversation}\n                handleViewMarkersSelection={openMarkerOrListDialogFromActionBar}\n                startConversationCurrentLine={startNewConversationFromActionBar}\n                startConversationWithSuggestedChange={startNewConversationFromActionBarWithSuggestedChange}\n              />\n            </ActionList>\n          </ActionMenu.Overlay>\n        </ActionMenu>\n      </ButtonGroup>\n    </div>\n  )\n})\n\nActionBar.displayName = 'ActionBar'\n","import {clsx} from 'clsx'\nimport {GitHubAvatar} from '@github-ui/github-avatar'\nimport {AvatarStack, Text, type SxProp} from '@primer/react'\nimport type {CommentAuthor, DiffLine} from '../types'\nimport {\n  AnimatedAnnotationIcon,\n  AnnotationIcon,\n  AnnotationPresentationMap,\n} from '@github-ui/conversations/annotation-icon'\nimport type {DiffAnnotationLevels} from '@github-ui/conversations'\nimport {useEffect, type MutableRefObject} from 'react'\nimport styles from './CommentIndicator.module.css'\nimport {useDiffLineContext} from '../contexts/DiffLineContext'\nimport {useDiffContext} from '../contexts/DiffContext'\n\n/**\n * Indicates whether a line has annotations, threads, and comments\n * Displays at most 3 avatars/icons as well as the total comment count across threads and annotations\n *\n */\nexport default function CommentIndicator({shouldAnimateRef}: {shouldAnimateRef?: MutableRefObject<boolean>} & SxProp) {\n  const {diffLine} = useDiffLineContext()\n  const line = diffLine as DiffLine\n  const {ghostUser} = useDiffContext()\n  // Reset the animation state after the first render so that the animation doesn't play on subsequent renders\n  useEffect(() => {\n    if (shouldAnimateRef?.current) {\n      shouldAnimateRef.current = false\n    }\n  }, [shouldAnimateRef])\n\n  const totalCommentsCount = line.threadsData?.totalCommentsCount || 0\n  const totalAnnotationsCount = line.annotationsData?.totalCount || 0\n  const totalCommentsAndAnnotationsCount = totalCommentsCount + totalAnnotationsCount\n  if (totalCommentsAndAnnotationsCount === 0) {\n    return null\n  }\n\n  const commentAuthors: {[key: string]: CommentAuthor} = {}\n  const annotations: Array<{id: string; level: DiffAnnotationLevels}> = []\n\n  line.annotationsData?.annotations?.map(annotation => {\n    if (annotation?.annotationLevel) {\n      annotations.push({id: annotation.id, level: annotation.annotationLevel})\n    }\n  })\n\n  line.threadsData?.threads?.map(\n    thread =>\n      thread?.commentsData?.comments?.map(comment => {\n        if (comment?.author) {\n          commentAuthors[comment?.author.login] = comment.author\n        } else if (ghostUser?.login) {\n          commentAuthors[ghostUser.login] = ghostUser\n        }\n      }),\n  )\n\n  const annotationIcons = annotations\n    .sort((annotationA, annotationB) => {\n      const priorityA = AnnotationPresentationMap[annotationA.level]?.priority || 0\n      const priorityB = AnnotationPresentationMap[annotationB.level]?.priority || 0\n      return priorityA < priorityB ? -1 : 1\n    })\n    .map(annotation => {\n      if (shouldAnimateRef?.current) {\n        return <AnimatedAnnotationIcon key={annotation.id} annotationLevel={annotation.level} />\n      }\n      return <AnnotationIcon key={annotation.id} annotationLevel={annotation.level} />\n    })\n\n  const commentAuthorAvatars = Object.keys(commentAuthors).map(authorName => {\n    const authorLogin = commentAuthors[authorName]?.login\n    const authorAvatarUrl = commentAuthors[authorName]?.avatarUrl ?? (ghostUser?.avatarUrl || ' ')\n    return <GitHubAvatar key={authorLogin} alt={authorLogin} size={20} src={authorAvatarUrl} />\n  })\n\n  // Display max of 3 stacked avatars/icons\n  const avatarStackChildren = [...annotationIcons, ...commentAuthorAvatars].slice(0, 3)\n  const indicatorText = totalCommentsAndAnnotationsCount > 9 ? '9+' : `${totalCommentsAndAnnotationsCount}`\n\n  return (\n    <div className={clsx('d-flex', 'flex-justify-between', 'flex-items-center', styles.commentIndicatorContainer)}>\n      <AvatarStack\n        disableExpand={true}\n        sx={{\n          maxWidth: '40px',\n          // This is neccesary to override the defaults of the avatar stack to make sure that a list of 3 avatar elements doesn't render to far left of the thread count\n          '--avatar-stack-three-plus-min-width': '32px',\n        }}\n      >\n        {avatarStackChildren}\n      </AvatarStack>\n      <Text\n        sx={{\n          color: 'fg.default',\n          ml: 1,\n          fontSize: 0,\n          fontWeight: 400,\n          fontVariantNumeric: 'tabular-nums',\n          // Setting a static width here to always give the comment text element enough space for 2 characters (e.g. 1..9 or 9+)\n          width: '2ch',\n          textAlign: 'start',\n        }}\n      >\n        {indicatorText}\n      </Text>\n    </div>\n  )\n}\n\ntry{ CommentIndicator.displayName ||= 'CommentIndicator' } catch {}","import {useShortcut} from '@github-ui/code-view-shared/hooks/shortcuts'\nimport {ChevronDownIcon, ChevronUpIcon, SearchIcon, XIcon} from '@primer/octicons-react'\nimport {IconButton, Label, Octicon, TextInput} from '@primer/react'\nimport {memo, useEffect, useRef, useState, type MutableRefObject} from 'react'\nimport type {DiffMatchContent} from '../helpers/find-in-diff'\nimport type {FocusedSearchResult} from '../hooks/use-diff-search-results'\nimport {clsx} from 'clsx'\nimport styles from './DiffFindPopover.module.css'\nimport {GlobalCommands, ScopedCommands} from '@github-ui/ui-commands'\n\nexport interface DiffFindPopoverProps {\n  inputContainer: React.RefObject<HTMLInputElement>\n  currentPathDigestIndex: MutableRefObject<number>\n  stickied?: boolean\n  searchTerm: string\n  setSearchTerm: (searchTerm: string) => void\n  focusedSearchResult: FocusedSearchResult | undefined\n  currentIndex: number\n  setCurrentIndex: (idx: number) => void\n  setFocusedSearchResult: (idx: FocusedSearchResult | undefined) => void\n  searchResults: Map<string, DiffMatchContent[]>\n  onClose: () => void\n  scrollDiffCellIntoView: (diffToFocus: FocusedSearchResult | undefined) => void\n}\n\n/**\n * Using this component:\n *\n * In order to use the DiffFindPopover component, you need to pass a few things into your usage of the DiffLines\n * component. First, in DiffFindOpenContext.tsx there is DiffFindOpenProvider which you need to supply\n * searchTerm and setSearchTerm to. The provider will allow you to consume whether or not this popover should be\n * rendered at any given time, and it keeps track of the search term between open/closed states.\n *\n * To get the search results, you must pass all of your DiffEntries, the search term, the web worker path, and a\n * piece of state which will be set whenever context lines are expanded to trigger a re-search into the\n * useDiffSearchResults hook. This hook will give you the search results and the currently focused search result\n * to then pass into the DiffLines component. The DiffLines component itself expects the focusedSearchResult to be\n * the index of the currently focused search result within the current path digest, or undefined if the currently\n * focused result is not within the current path digest. This prevents unnecessary rerenders.\n */\nexport const DiffFindPopover = memo(function DiffFindPopover({\n  inputContainer,\n  currentPathDigestIndex,\n  stickied,\n  searchTerm,\n  searchResults,\n  setSearchTerm,\n  focusedSearchResult,\n  currentIndex,\n  setCurrentIndex,\n  setFocusedSearchResult,\n  onClose,\n  scrollDiffCellIntoView,\n}: DiffFindPopoverProps) {\n  const {findInFileShortcut} = useShortcut()\n  const [escapeToBrowserOnNextKeyPress, setEscapeToBrowserOnNextKeyPress] = useState(true)\n  const currentKeyArray = useRef<string[]>([])\n  const totalResultSize = useRef(0)\n  const clearSearch = () => {\n    setSearchTerm('')\n    setFocusedSearchResult(undefined)\n    currentPathDigestIndex.current = 0\n  }\n\n  const onChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    if (event.target.value) {\n      setEscapeToBrowserOnNextKeyPress(false)\n      setSearchTerm(event.target.value)\n      setCurrentIndex(0)\n    } else {\n      setEscapeToBrowserOnNextKeyPress(true)\n      clearSearch()\n    }\n  }\n\n  const jumpToResult = (direction: number) => {\n    if (focusedSearchResult === undefined || focusedSearchResult.pathDigest === '') {\n      currentPathDigestIndex.current = 0\n      const initialResult = {\n        pathDigest: currentKeyArray.current[0] ?? '',\n        indexWithinDigest: 0,\n      }\n      setFocusedSearchResult(initialResult)\n      return\n    }\n    const tempFocusedResult = focusedSearchResult\n    if (direction === 1) {\n      setCurrentIndex(currentIndex === totalResultSize.current - 1 ? 0 : currentIndex + 1)\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      if (focusedSearchResult.indexWithinDigest === searchResults.get(focusedSearchResult.pathDigest)!.length - 1) {\n        currentPathDigestIndex.current = currentPathDigestIndex.current + 1\n        if (currentPathDigestIndex.current === currentKeyArray.current.length) {\n          currentPathDigestIndex.current = 0\n        }\n        tempFocusedResult.pathDigest = currentKeyArray.current[currentPathDigestIndex.current] ?? ''\n        tempFocusedResult.indexWithinDigest = 0\n        //move on to the next path digest or wrap around if at the end\n      } else {\n        //not at the end of the current path digest\n\n        tempFocusedResult.indexWithinDigest = tempFocusedResult.indexWithinDigest + 1\n      }\n    } else {\n      setCurrentIndex(currentIndex === 0 ? totalResultSize.current - 1 : currentIndex - 1)\n      if (focusedSearchResult.indexWithinDigest === 0) {\n        currentPathDigestIndex.current = currentPathDigestIndex.current - 1\n        if (currentPathDigestIndex.current === -1) {\n          currentPathDigestIndex.current = currentKeyArray.current.length - 1\n        }\n        tempFocusedResult.pathDigest = currentKeyArray.current[currentPathDigestIndex.current] ?? ''\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        tempFocusedResult.indexWithinDigest = searchResults.get(tempFocusedResult.pathDigest)!.length - 1\n        //move on to the next path digest or wrap around if at the end\n      } else {\n        //can stay within the same current path digest\n        tempFocusedResult.indexWithinDigest = tempFocusedResult.indexWithinDigest - 1\n      }\n    }\n    setFocusedSearchResult(tempFocusedResult)\n  }\n  useEffect(() => {\n    inputContainer.current?.focus()\n    inputContainer.current?.select()\n  }, [inputContainer])\n\n  useEffect(() => {\n    currentKeyArray.current = Array.from(searchResults.keys())\n    currentPathDigestIndex.current = 0\n    const initialResult = {\n      pathDigest: currentKeyArray.current[0] ?? '',\n      indexWithinDigest: 0,\n    }\n    setFocusedSearchResult(initialResult)\n    let incSize = 0\n    for (const result of searchResults.values()) {\n      incSize += result.length\n    }\n    totalResultSize.current = incSize\n  }, [currentPathDigestIndex, searchResults, searchResults.size, setFocusedSearchResult])\n\n  useEffect(() => {\n    if (searchResults.size > 0 && focusedSearchResult !== undefined) {\n      scrollDiffCellIntoView(focusedSearchResult)\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [searchResults, focusedSearchResult, currentIndex])\n\n  return (\n    <div className={clsx(styles.defaultStyles, stickied && styles.stickyStyles, !stickied && styles.notStickyStyles)}>\n      <GlobalCommands\n        commands={{\n          'pull-requests-diff-view:jump-to-next-result-alternate': () => jumpToResult(1),\n          'pull-requests-diff-view:jump-to-previous-result-alternate': () => jumpToResult(-1),\n          'pull-requests-diff-view:close-find': onClose,\n        }}\n      />\n      <ScopedCommands\n        commands={{\n          'pull-requests-diff-view:jump-to-next-result': () => jumpToResult(1),\n          'pull-requests-diff-view:jump-to-previous-result': () => jumpToResult(-1),\n        }}\n      >\n        <div className=\"py-2 pl-3 pr-2 d-flex flex-justify-center flex-items-center flex-row f6 borderColor-default border-bottom\">\n          <div className=\"d-flex flex-row flex-items-baseline\">\n            <h5 className=\"fgColor-default pr-2 text-bold\">Find</h5>\n            <span\n              className={clsx(\n                'find-text-help-tooltip',\n                'fgColor-subtle',\n                escapeToBrowserOnNextKeyPress && styles.visibilityVisible,\n                !escapeToBrowserOnNextKeyPress && styles.visibilityHidden,\n              )}\n            >\n              Press <Label>{findInFileShortcut.text}</Label> again to open the browser&apos;s find menu\n            </span>\n          </div>\n          <div className=\"flex-1\" />\n          {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n          <IconButton\n            unsafeDisableTooltip={true}\n            variant=\"invisible\"\n            size=\"small\"\n            onClick={onClose}\n            icon={XIcon}\n            className=\"fgColor-subtle\"\n            aria-label=\"Close find in file\"\n          />\n        </div>\n        <div className=\"pl-2 pr-2 pt-2 pb-2\">\n          <TextInput\n            ref={inputContainer}\n            className=\"pl-1 border-0 box-shadow-none\"\n            validationStatus={totalResultSize.current > 1000 ? 'error' : undefined}\n            type=\"text\"\n            leadingVisual={() => <Octicon icon={SearchIcon} aria-hidden=\"true\" />}\n            autoComplete=\"off\"\n            name=\"Find in file input\"\n            placeholder=\"Search this diff\"\n            value={searchTerm}\n            block\n            onChange={onChange}\n            trailingAction={\n              <div className=\"d-flex flex-row flex-justify-center flex-items-center\">\n                <span className=\"text-small fgColor-subtle m-2 text-center\">\n                  {searchResults.size === 0 || focusedSearchResult === undefined ? 0 : currentIndex + 1}/\n                  {totalResultSize.current}\n                </span>\n                {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n                <IconButton\n                  unsafeDisableTooltip={true}\n                  size=\"small\"\n                  variant=\"invisible\"\n                  onClick={() => {\n                    jumpToResult(-1)\n                  }}\n                  icon={ChevronUpIcon}\n                  aria-label=\"Up\"\n                  data-testid=\"up-search\"\n                  className=\"fgColor-subtle\"\n                />\n                {/* eslint-disable-next-line primer-react/a11y-remove-disable-tooltip */}\n                <IconButton\n                  unsafeDisableTooltip={true}\n                  size=\"small\"\n                  variant=\"invisible\"\n                  onClick={() => {\n                    jumpToResult(1)\n                  }}\n                  icon={ChevronDownIcon}\n                  aria-label=\"Down\"\n                  data-testid=\"down-search\"\n                  className=\"fgColor-subtle\"\n                />\n              </div>\n            }\n            onKeyDown={(keyboardEvent: React.KeyboardEvent) => {\n              if (\n                (keyboardEvent.metaKey || keyboardEvent.ctrlKey) &&\n                (keyboardEvent.key === 'f' || keyboardEvent.key === 'F')\n              ) {\n                if (escapeToBrowserOnNextKeyPress) {\n                  // The user wants to use the browser's find in page functionality.\n                  // So just close this pane and get it out of their way.\n                  onClose()\n                } else {\n                  setEscapeToBrowserOnNextKeyPress(true)\n                  keyboardEvent.preventDefault()\n                  inputContainer.current?.focus()\n                  inputContainer.current?.select()\n                }\n              }\n            }}\n          />\n        </div>\n      </ScopedCommands>\n    </div>\n  )\n})\n\ntry{ DiffFindPopover.displayName ||= 'DiffFindPopover' } catch {}","import type {DiffMatchContent} from '../diff-lines'\nimport styles from './DiffHighlightedOverlay.module.css'\nimport {clsx} from 'clsx'\n\nexport function DiffHighlightedOverlay({\n  searchResults,\n  focusedSearchResult,\n  className,\n  styleObject,\n}: {\n  searchResults: DiffMatchContent[]\n  focusedSearchResult?: number\n  className: string\n  styleObject?: React.CSSProperties | undefined\n}) {\n  let startIndex = 0\n  const text = searchResults[0]?.text ?? ''\n  const lineNumber = searchResults[0]?.diffLineNumIndex ?? -1\n  const key = `overlay-${lineNumber}-${text}`\n\n  return (\n    <span\n      key={key}\n      className={clsx(\n        className,\n        'position-absolute',\n        styles.userSelectNone,\n        //taking into account the 30px of padding on the table cell for word wrapping purposes\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        !searchResults[0]!.isHunk && styles.nonHunkStyles,\n      )}\n      style={{\n        ...styleObject,\n      }}\n    >\n      {searchResults.map(result => {\n        const isFocusedResult = result.indexWithinPathDigest === focusedSearchResult\n        const line = (\n          <span key={`find-match-${result.diffLineNumIndex}-${result.column}`}>\n            <span className={clsx(styles.visibilityHidden, styles.userSelectNone)}>\n              {text.substring(startIndex, result.column)}\n            </span>\n            <span\n              className={clsx(\n                styles.userSelectNone,\n                isFocusedResult && styles.focusedResultStyles,\n                !isFocusedResult && styles.nonFocusedResultStyles,\n              )}\n            >\n              <span\n                className={clsx(!isFocusedResult && styles.visibilityHidden)}\n                id={matchElementId(result.indexWithinPathDigest, result.pathDigest)}\n              >\n                {text.substring(result.column, result.columnEnd)}\n              </span>\n            </span>\n          </span>\n        )\n\n        startIndex = result.columnEnd\n\n        return line\n      })}\n      {/** Return the rest of the line to wrap properly */}\n      <span className={clsx(styles.visibilityHidden, styles.userSelectNone)}>{text.substring(startIndex)}</span>\n    </span>\n  )\n}\n\nexport function matchElementId(line: number, digest: string) {\n  return `match-${digest}-${line}`\n}\n\ntry{ DiffHighlightedOverlay.displayName ||= 'DiffHighlightedOverlay' } catch {}","import type {DiffLine} from '../types'\n\nexport function buildDiffLineScreenReaderSummary(\n  leftLine: DiffLine,\n  rightLine: DiffLine,\n  currentSide: 'LEFT' | 'RIGHT',\n) {\n  const leftLineThreadCount = leftLine.threadsData?.totalCount || 0\n  const rightLineThreadCount = rightLine.threadsData?.totalCount || 0\n\n  if (leftLineThreadCount === 0 && rightLineThreadCount === 0) {\n    return undefined\n  }\n\n  const firstLeftCommentAuthor = leftLine.threadsData?.threads?.[0]?.commentsData.comments?.[0]?.author?.login || ''\n  const firstRightCommentAuthor = rightLine.threadsData?.threads?.[0]?.commentsData.comments?.[0]?.author?.login || ''\n\n  let leftLineSummary = ''\n  if (leftLineThreadCount === 1) {\n    leftLineSummary = `has conversation started by @${firstLeftCommentAuthor}.`\n  } else if (leftLineThreadCount > 1) {\n    leftLineSummary = `has conversations.`\n  }\n\n  let rightLineSummary = ''\n  if (rightLineThreadCount === 1) {\n    rightLineSummary = `has conversation started by @${firstRightCommentAuthor}.`\n  } else if (rightLineThreadCount > 1) {\n    rightLineSummary = `has conversations.`\n  }\n\n  let summary = ''\n  if (currentSide === 'LEFT') {\n    const capitalizedLeftSummary = `${leftLineSummary.charAt(0).toUpperCase()}${leftLineSummary.slice(1)}`\n    const rightLineSummaryWithModified = `${rightLineSummary.length > 1 ? 'Modified line' : ''} ${rightLineSummary}`\n    summary = `${capitalizedLeftSummary} ${rightLineSummaryWithModified}`\n  } else {\n    const capitalizedRightSummary = `${rightLineSummary.charAt(0).toUpperCase()}${rightLineSummary.slice(1)}`\n    const leftLineSummaryWithOriginal = `${leftLineSummary.length > 1 ? 'Original line' : ''} ${leftLineSummary}`\n    summary = `${capitalizedRightSummary} ${leftLineSummaryWithOriginal}`\n  }\n\n  return summary\n}\n/**\n * Provides a screen-reader only summary of the diff line\n * For each diff line, indicates whether there are conversations on both the original and modified lines.\n * @param summary the summary for the conversations on a given diff line\n */\nexport default function DiffLineScreenReaderSummary({summary}: {summary: string}) {\n  if (summary === '') {\n    return null\n  }\n  return (\n    <div className=\"sr-only\" data-testid=\"pr-diffline-summary\">\n      {summary.trimStart().trimEnd()}\n    </div>\n  )\n}\n\ntry{ DiffLineScreenReaderSummary.displayName ||= 'DiffLineScreenReaderSummary' } catch {}","import {CopilotDiffChatContextMenu} from '@github-ui/copilot-code-chat/CopilotDiffChatContextMenu'\nimport type {CopilotChatFileDiffReferenceData} from '@github-ui/copilot-code-chat/use-file-diff-reference'\nimport {KeyboardKey} from '@github-ui/keyboard-key'\nimport {CommandActionListItem} from '@github-ui/ui-commands'\nimport {\n  CommentDiscussionIcon,\n  CopyIcon,\n  FoldDownIcon,\n  FoldUpIcon,\n  LinkIcon,\n  MoveToBottomIcon,\n  MoveToTopIcon,\n  MultiSelectIcon,\n} from '@primer/octicons-react'\nimport {ActionList} from '@primer/react'\nimport {useMemo, type MouseEvent} from 'react'\n\nimport {useDiffContext} from '../contexts/DiffContext'\nimport {useDiffLineContext} from '../contexts/DiffLineContext'\nimport {useMarkersDialogContext} from '../contexts/MarkersDialogContext'\nimport {useSelectedDiffRowRangeContext} from '../contexts/SelectedDiffRowRangeContext'\nimport {threadSummary} from '../helpers/conversation-helpers'\nimport useExpandHunk from '../hooks/use-expand-hunk'\nimport type {DiffLine, DiffSide} from '../types'\nimport {StartConversationContextMenuItems} from './StartConversationContextMenuItems'\n\ntype CellContextMenuProps = {\n  showStartConversation: boolean\n  copilotChatReferenceData?: CopilotChatFileDiffReferenceData\n  handleViewMarkersSelection: (markerLoc?: DiffSide) => void\n  startConversationCurrentLine: () => void\n  startConversationWithSuggestedChange: () => void\n}\n\nexport function CellContextMenu({\n  showStartConversation,\n  copilotChatReferenceData,\n  handleViewMarkersSelection,\n  startConversationCurrentLine,\n  startConversationWithSuggestedChange,\n}: CellContextMenuProps) {\n  return (\n    <>\n      {showStartConversation && (\n        <StartConversationContextMenuItems\n          handleStartConversation={startConversationCurrentLine}\n          handleStartConversationWithSuggestedChange={startConversationWithSuggestedChange}\n        />\n      )}\n      <ViewMarkerListItems handleViewMarkersSelection={handleViewMarkersSelection} />\n      <CopilotListItems copilotChatReferenceData={copilotChatReferenceData} />\n      <CopyContentListItems />\n      <SelectAllListItem />\n      <CommandActionListItem commandId=\"pull-requests-diff-view:copy-anchor-link\" leadingVisual={<LinkIcon />} />\n      <ExpandHunksListItems />\n      <JumpToHunkListItems />\n    </>\n  )\n}\n\nexport function EmptyCellContextMenu() {\n  return (\n    <>\n      <ExpandHunksListItems />\n      <SelectAllListItem />\n    </>\n  )\n}\n\nconst CopilotListItems: React.FC<{copilotChatReferenceData?: CopilotChatFileDiffReferenceData}> = ({\n  copilotChatReferenceData,\n}) => {\n  const {diffEntryId} = useDiffLineContext()\n  const {subjectId: pullRequestId, oldCommitOid, newCommitOid} = useDiffContext()\n  const {selectedDiffRowRange} = useSelectedDiffRowRangeContext()\n\n  const props = useMemo(() => {\n    // semi-preloaded data\n    if (copilotChatReferenceData && pullRequestId && oldCommitOid && newCommitOid) {\n      return {\n        referenceData: copilotChatReferenceData,\n        queryVariables: {pullRequestId, startOid: oldCommitOid, endOid: newCommitOid},\n      }\n    }\n\n    // query variables for client-side loading\n    if (diffEntryId && pullRequestId && oldCommitOid && newCommitOid) {\n      return {\n        queryVariables: {diffEntryId, pullRequestId, startOid: oldCommitOid, endOid: newCommitOid},\n      }\n    }\n  }, [diffEntryId, newCommitOid, oldCommitOid, pullRequestId, copilotChatReferenceData])\n\n  if (!props) return null\n\n  return <CopilotDiffChatContextMenu selectedRange={selectedDiffRowRange} {...props} />\n}\n\nfunction SelectAllListItem() {\n  const {fileAnchor} = useDiffLineContext()\n\n  const handleSelectAllSelection = () => {\n    // We need to wait one click for the context menu to close before we allow for the event to occur inside of the table instead of context menu\n    setTimeout(() => {\n      document\n        .querySelector(`table[data-diff-anchor=\"${fileAnchor}\"]`)\n        ?.dispatchEvent(new KeyboardEvent('keydown', {key: 'a', code: 'KeyA', ctrlKey: true}))\n    })\n  }\n\n  return (\n    <ActionList.Item onSelect={handleSelectAllSelection}>\n      <ActionList.LeadingVisual>\n        <MultiSelectIcon />\n      </ActionList.LeadingVisual>\n      Select all\n      <ActionList.TrailingVisual>\n        <KeyboardKey keys=\"Mod+a\" />\n      </ActionList.TrailingVisual>\n    </ActionList.Item>\n  )\n}\n\nfunction ViewMarkerListItems({\n  handleViewMarkersSelection,\n}: {\n  handleViewMarkersSelection: (markerLoc?: DiffSide) => void\n}) {\n  const {commentingEnabled} = useDiffContext()\n  const {isSplit} = useDiffLineContext()\n  if (!commentingEnabled) return null\n\n  if (!isSplit) {\n    return <UnifiedDiffMarkerListItem onSelect={() => handleViewMarkersSelection()} />\n  }\n\n  return <SplitDiffMarkersListItems handleViewMarkersSelection={handleViewMarkersSelection} />\n}\n\nfunction SplitDiffMarkersListItems({\n  handleViewMarkersSelection,\n}: {\n  handleViewMarkersSelection: (markerLoc: DiffSide) => void\n}) {\n  const {originalLineHasThreads, modifiedLineHasThreads, isLeftSide} = useDiffLineContext()\n  const {annotations} = useMarkersDialogContext()\n  const hasAnnotations = annotations.length > 0\n  if (isLeftSide) {\n    return (\n      <>\n        {originalLineHasThreads && (\n          <MarkerListItem text=\"View markers\" onSelect={() => handleViewMarkersSelection('LEFT')} />\n        )}\n        {(modifiedLineHasThreads || hasAnnotations) && (\n          <MarkerListItem text=\"View markers, modified line\" onSelect={() => handleViewMarkersSelection('RIGHT')} />\n        )}\n      </>\n    )\n  }\n\n  return (\n    <>\n      {(modifiedLineHasThreads || hasAnnotations) && (\n        <MarkerListItem text=\"View markers\" onSelect={() => handleViewMarkersSelection('RIGHT')} />\n      )}\n      {originalLineHasThreads && (\n        <MarkerListItem text=\"View markers, original line\" onSelect={() => handleViewMarkersSelection('LEFT')} />\n      )}\n    </>\n  )\n}\n\nfunction UnifiedDiffMarkerListItem({onSelect}: {onSelect: () => void}) {\n  const {ghostUser} = useDiffContext()\n  const {diffLine} = useDiffLineContext()\n  const line = diffLine as DiffLine\n  const {annotations} = useMarkersDialogContext()\n  const hasMarkers = (line && threadSummary(line.threadsData, ghostUser).length > 0) || annotations.length > 0\n  if (!hasMarkers) return null\n  return <MarkerListItem text=\"View markers\" onSelect={() => onSelect()} />\n}\n\nfunction MarkerListItem({onSelect, text}: {onSelect: () => void; text: string}) {\n  return (\n    <ActionList.Item onSelect={onSelect}>\n      <ActionList.LeadingVisual>\n        <CommentDiscussionIcon />\n      </ActionList.LeadingVisual>\n      {text}\n    </ActionList.Item>\n  )\n}\n\nfunction CopyContentListItems() {\n  return (\n    // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n    <div\n      onMouseDown={(event: MouseEvent) => {\n        // We need to prevent the window's Selection object from being reset on mouse down if user has selected text.\n        // This is to prevent the browser from resetting the selection before onSelect event callback is called.\n        if (window.getSelection()?.toString() !== '') event.preventDefault()\n      }}\n    >\n      <CommandActionListItem commandId=\"pull-requests-diff-view:copy-code\" leadingVisual={<CopyIcon />} />\n    </div>\n  )\n}\n\nfunction ExpandHunksListItems() {\n  const {canExpandStartOfHunk, canExpandEndOfHunk} = useExpandHunk()\n  return (\n    <>\n      {canExpandStartOfHunk && (\n        <CommandActionListItem commandId=\"pull-requests-diff-view:expand-hunk-up\" leadingVisual={<FoldUpIcon />} />\n      )}\n      {canExpandEndOfHunk && (\n        <CommandActionListItem commandId=\"pull-requests-diff-view:expand-hunk-down\" leadingVisual={<FoldDownIcon />} />\n      )}\n    </>\n  )\n}\n\nexport function JumpToHunkListItems() {\n  const {previousHunk, nextHunk} = useDiffLineContext()\n  const {fileAnchor} = useDiffLineContext()\n\n  // We need to ensure these values are not undefined values\n  // simply doing a truthy call on these is not adequate as they can return 0, which is falsy in JS\n  const hasPreviousHunk = !!previousHunk\n  const hasNextHunk = !!nextHunk\n\n  const handleNextHunkSelection = () => {\n    // We need to wait one click for the context menu to close before we allow for the event to occur inside of the table instead of context menu\n    setTimeout(() => {\n      document\n        .querySelector(`table[data-diff-anchor=\"${fileAnchor}\"]`)\n        ?.dispatchEvent(new KeyboardEvent('keydown', {key: 'PageDown'}))\n    })\n  }\n\n  const handlePreviousHunkSelection = () => {\n    // We need to wait one click for the context menu to close before we allow for the event to occur inside of the table instead of context menu\n    setTimeout(() => {\n      document\n        .querySelector(`table[data-diff-anchor=\"${fileAnchor}\"]`)\n        ?.dispatchEvent(new KeyboardEvent('keydown', {key: 'PageUp'}))\n    })\n  }\n\n  return (\n    <>\n      {hasNextHunk ? (\n        <ActionList.Item aria-keyshortcuts=\"PageDown\" onSelect={handleNextHunkSelection}>\n          <ActionList.LeadingVisual>\n            <MoveToBottomIcon />\n          </ActionList.LeadingVisual>\n          Go to next hunk\n          <ActionList.TrailingVisual>Page Down</ActionList.TrailingVisual>\n        </ActionList.Item>\n      ) : null}\n      {hasPreviousHunk ? (\n        <ActionList.Item aria-keyshortcuts=\"PageUp\" onSelect={handlePreviousHunkSelection}>\n          <ActionList.LeadingVisual>\n            <MoveToTopIcon />\n          </ActionList.LeadingVisual>\n          Go to previous hunk\n          <ActionList.TrailingVisual>Page Up</ActionList.TrailingVisual>\n        </ActionList.Item>\n      ) : null}\n    </>\n  )\n}\n\ntry{ CellContextMenu.displayName ||= 'CellContextMenu' } catch {}\ntry{ EmptyCellContextMenu.displayName ||= 'EmptyCellContextMenu' } catch {}\ntry{ CopilotListItems.displayName ||= 'CopilotListItems' } catch {}\ntry{ SelectAllListItem.displayName ||= 'SelectAllListItem' } catch {}\ntry{ ViewMarkerListItems.displayName ||= 'ViewMarkerListItems' } catch {}\ntry{ SplitDiffMarkersListItems.displayName ||= 'SplitDiffMarkersListItems' } catch {}\ntry{ UnifiedDiffMarkerListItem.displayName ||= 'UnifiedDiffMarkerListItem' } catch {}\ntry{ MarkerListItem.displayName ||= 'MarkerListItem' } catch {}\ntry{ CopyContentListItems.displayName ||= 'CopyContentListItems' } catch {}\ntry{ ExpandHunksListItems.displayName ||= 'ExpandHunksListItems' } catch {}\ntry{ JumpToHunkListItems.displayName ||= 'JumpToHunkListItems' } catch {}","import {Markers, StartConversation, usePersistedDiffCommentData} from '@github-ui/conversations'\nimport {copyText} from '@github-ui/copy-to-clipboard'\nimport {diffLineFileWrap} from '@github-ui/diffs/DiffParts'\nimport type {DiffLineType} from '@github-ui/diffs/types'\nimport type {SafeHTMLString} from '@github-ui/safe-html'\nimport {SafeHTMLDiv} from '@github-ui/safe-html'\nimport {ScopedCommands} from '@github-ui/ui-commands'\nimport {useSafeAsyncCallback} from '@github-ui/use-safe-async-callback'\nimport {KebabHorizontalIcon} from '@primer/octicons-react'\nimport {clsx} from 'clsx'\nimport type React from 'react'\nimport type {ComponentPropsWithoutRef, FocusEvent, KeyboardEvent, ReactElement, ReactNode, RefObject} from 'react'\nimport {forwardRef, useCallback, useEffect, useImperativeHandle, useMemo, useRef, useState} from 'react'\n\nimport {useDiffContext} from '../contexts/DiffContext'\nimport {useDiffLineContext} from '../contexts/DiffLineContext'\nimport {useMarkersDialogContext} from '../contexts/MarkersDialogContext'\nimport type {SelectedDiffLines} from '../contexts/SelectedDiffRowRangeContext'\nimport {useSelectedDiffRowRangeContext} from '../contexts/SelectedDiffRowRangeContext'\nimport {\n  anchorLinkForSelection,\n  calculateCommentIndicatorRightPositioning,\n  calculateDiffLineCodeCellGutter,\n  cellIdFrom,\n  isContextDiffLine,\n  isDiffLine,\n  lineAcceptsComments,\n  trimContentLine,\n} from '../helpers/line-helpers'\nimport {useActionBarDialogs} from '../hooks/use-action-bar-dialogs'\nimport {useSelectedDiffRowRangeContent} from '../hooks/use-selected-diff-row-range-content'\nimport {useActionBarFocus} from '../hooks/use-action-bar-focus'\nimport useExpandHunk from '../hooks/use-expand-hunk'\nimport {isGridNavigationKey} from '../hooks/use-grid-navigation'\nimport {useSuggestedChanges} from '../hooks/use-suggested-changes'\nimport type {ClientDiffLine, CopilotChatFileDiffReferenceData, DiffLine} from '../types'\nimport {ActionBar} from './ActionBar'\nimport CommentIndicator from './CommentIndicator'\nimport {CellContextMenu, EmptyCellContextMenu} from './DiffLineTableCellContextMenus'\nimport type {PrunedIconButtonProps} from './ExpandableHunkHeaderDiffLine'\nimport {InProgressCommentIndicator} from './InProgressCommentIndicator'\nimport {ActionList, ActionMenu} from '@primer/react'\nimport type {DiffMatchContent} from '../helpers/find-in-diff'\nimport {DiffHighlightedOverlay} from './DiffHighlightedOverlay'\nimport DiffLineScreenReaderSummary from './DiffLineScreenReaderSummary'\n\nconst RIGHT_CLICK_BUTTON_CODE = 2\n\nfunction useCellId(columnIndex: number) {\n  const {rowId} = useDiffLineContext()\n  if (!rowId) return undefined\n  return cellIdFrom(rowId, columnIndex)\n}\n\nfunction useGridCellButtonProps(\n  cellRef: RefObject<HTMLTableCellElement>,\n): [cellProps: ComponentPropsWithoutRef<'td'>, buttonProps: ComponentPropsWithoutRef<'button'>] {\n  const [isFocusWithin, setIsFocusWithin] = useState(false)\n  const [isButtonFocused, setIsButtonFocused] = useState(false)\n\n  // take the button out of the tab order when focus is outside of the cell\n  // this means that it won't be tabbable until the grid cell is focused\n  const buttonTabIndex = isFocusWithin ? 0 : -1\n\n  const handleCellBlur = useCallback(\n    (e: FocusEvent) => {\n      // when the cell blurs, check if focus is transferring to a button within the cell\n      if (cellRef.current && cellRef.current.contains(e.relatedTarget)) return\n      setIsFocusWithin(false)\n    },\n    [cellRef],\n  )\n\n  const handleCellFocus = useCallback(() => {\n    if (cellRef.current !== document.activeElement) return\n    setIsFocusWithin(true)\n  }, [cellRef])\n\n  const handleButtonBlur = useCallback(\n    (e: FocusEvent) => {\n      if (cellRef.current && !cellRef.current.contains(e.relatedTarget)) {\n        setIsFocusWithin(false)\n      }\n\n      setIsButtonFocused(false)\n    },\n    [cellRef],\n  )\n  const handleButtonFocusCapture = useCallback((e: FocusEvent) => {\n    e.stopPropagation()\n    setIsButtonFocused(true)\n  }, [])\n\n  const handleButtonKeydownCapture = useCallback((e: KeyboardEvent) => {\n    // prevent focus zone from processing keystrokes on the button, since we want it to behave like it's not in the grid\n    // eslint-disable-next-line @github-ui/ui-commands/no-manual-shortcut-logic\n    if (isGridNavigationKey(e.key)) {\n      e.stopPropagation()\n    }\n  }, [])\n\n  // const baseCellProps = {onFocus: handleCellFocus, onBlur: handleCellBlur}\n  // const cellProps = isButtonFocused ? {...baseCellProps, tabIndex: 0} : baseCellProps\n  const cellProps = {onFocus: handleCellFocus, onBlur: handleCellBlur}\n\n  const buttonProps = {\n    // hide the button from the screen reader until it's focused to avoid polluting screen reader announcements\n    'aria-hidden': !isButtonFocused,\n    tabIndex: buttonTabIndex,\n    onBlur: handleButtonBlur,\n    // we use onFocusCapture instead of onFocus because we want to stop propagation before the focus zone\n    // tries to handle the event.\n    onFocusCapture: handleButtonFocusCapture,\n    onKeyDownCapture: handleButtonKeydownCapture,\n  }\n\n  return [cellProps, buttonProps]\n}\n\nfunction useCommentDialogTitle(diffLine: DiffLine, isLeftSide: boolean) {\n  const {selectedDiffRowRange} = useSelectedDiffRowRangeContext()\n  return useMemo(() => {\n    let text = 'Add a comment to'\n    const isMultiLineComment: boolean =\n      !!selectedDiffRowRange && selectedDiffRowRange.startLineNumber !== selectedDiffRowRange.endLineNumber\n\n    if (selectedDiffRowRange && isMultiLineComment) {\n      const lineSideIdentifier = {\n        left: 'L',\n        right: 'R',\n      }\n      const startSideIdentifier = lineSideIdentifier[selectedDiffRowRange.startOrientation]\n      const endSideIdentifier = lineSideIdentifier[selectedDiffRowRange.endOrientation]\n      const isMultiLineSelection = selectedDiffRowRange.startLineNumber !== selectedDiffRowRange.endLineNumber\n\n      text += isMultiLineSelection\n        ? ` lines ${startSideIdentifier}${selectedDiffRowRange.startLineNumber} to ${endSideIdentifier}${selectedDiffRowRange.endLineNumber}`\n        : ` line ${startSideIdentifier}${selectedDiffRowRange.startLineNumber}`\n    } else {\n      const sideIdentifier = isLeftSide && !isContextDiffLine(diffLine) ? 'L' : 'R'\n      text += ` line ${sideIdentifier}${diffLine.blobLineNumber}`\n    }\n\n    return text\n  }, [diffLine, isLeftSide, selectedDiffRowRange])\n}\n\nfunction viewerCanCommentOnLine(\n  commentingEnabled: boolean,\n  viewerCanComment: boolean,\n  diffLine: ClientDiffLine | undefined,\n  selectedDiffLines: SelectedDiffLines,\n) {\n  return commentingEnabled && viewerCanComment && lineAcceptsComments(diffLine, selectedDiffLines)\n}\n\ntype CellProps = Omit<ComponentPropsWithoutRef<'td'>, 'onKeyDown' | 'onCompositionStart' | 'onCompositionEnd'> & {\n  columnIndex: number\n  ContextMenu?: React.ReactElement\n  lineAnchor?: string\n  commentDialogOpen?: boolean\n  handleDiffCellClick?: (event: React.MouseEvent<HTMLTableCellElement>) => void\n  handleDiffSideCellSelectionBlocking?: (event: React.MouseEvent) => void\n  startConversation?: () => void\n}\n\nconst Cell = forwardRef<HTMLTableCellElement, CellProps>(function Cell(\n  {\n    children,\n    ContextMenu,\n    className,\n    columnIndex,\n    handleDiffCellClick,\n    handleDiffSideCellSelectionBlocking,\n    lineAnchor,\n    commentDialogOpen,\n    startConversation,\n    ...props\n  }: CellProps,\n  forwardedRef,\n) {\n  const {diffLine, isRowSelected, isLeftSide, isSplit} = useDiffLineContext()\n  const line = diffLine as DiffLine\n  const cellRef = useRef<HTMLTableCellElement>(null)\n\n  // delegate the internal ref to the forwarded one if there is one\n  useImperativeHandle<HTMLTableCellElement | null, HTMLTableCellElement | null>(forwardedRef, () => cellRef.current, [])\n\n  const [showContextMenu, setShowContextMenu] = useState(false)\n  const {clearSelectedDiffRowRange, selectedDiffRowRange} = useSelectedDiffRowRangeContext()\n  const {fileAnchor, filePath} = useDiffLineContext()\n  const {expandStartOfHunk, expandEndOfHunk, expandEndOfPreviousHunk} = useExpandHunk()\n  const {getUnifiedDiffLineCode, getSplitDiffSingleLineCode, getSplitDiffMultiLineCode} =\n    useSelectedDiffRowRangeContent(fileAnchor)\n\n  const contextMenuOverlayRef = useRef<HTMLTableCellElement>(null)\n  const handleClickOutside = useSafeAsyncCallback((e: MouseEvent) => {\n    if (!e.target) return\n    const eventTarget = e.target as Node\n    if (\n      showContextMenu &&\n      !contextMenuOverlayRef.current?.contains(eventTarget) &&\n      !cellRef.current?.contains(eventTarget) &&\n      e.button === RIGHT_CLICK_BUTTON_CODE\n    ) {\n      // handle right-click outside of the menu and anchor cell\n      setShowContextMenu(false)\n    } else if (\n      cellRef.current?.contains(eventTarget) &&\n      (e.target as HTMLElement).closest('button')?.contains(eventTarget)\n    ) {\n      // handle click on button inside the anchor cell\n      setShowContextMenu(false)\n    }\n  })\n\n  useEffect(() => {\n    if (showContextMenu) {\n      document.addEventListener('mousedown', handleClickOutside)\n    } else {\n      document.removeEventListener('mousedown', handleClickOutside)\n    }\n  }, [handleClickOutside, showContextMenu])\n\n  useEffect(() => {\n    // ensure we don't leak the event listener on unmount\n    return () => document.removeEventListener('mousedown', handleClickOutside)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  const isConversationOpen = () => !!document.getElementById('conversation-dialog')\n\n  /** Open the context menu. Returns `false` if the menu cannot be opened right now. */\n  const openContextMenu = () => {\n    if (commentDialogOpen || showContextMenu || isConversationOpen()) return false\n\n    // When triggering the context menu for a row outside of a pre-existing selection, clear the selection\n    if (!isRowSelected && !!selectedDiffRowRange) {\n      clearSelectedDiffRowRange()\n    }\n    setShowContextMenu(true)\n\n    return true\n  }\n\n  const copyCode = () => {\n    const highlightedTextSelection = window.getSelection()\n\n    // If user has selected text, through mousedown selection, we will prioritize copying that code in place of selectedDiffRowRangeContent.\n    if (highlightedTextSelection && highlightedTextSelection.toString() !== '') {\n      document.execCommand('copy')\n      return\n    }\n\n    if (isSplit) {\n      const isSingleCellSelection =\n        selectedDiffRowRange === undefined ||\n        (selectedDiffRowRange?.startOrientation === selectedDiffRowRange?.endOrientation &&\n          selectedDiffRowRange?.startLineNumber === selectedDiffRowRange?.endLineNumber)\n\n      // Copy split diff code\n      isSingleCellSelection\n        ? copyText(getSplitDiffSingleLineCode(isLeftSide ? 'left' : 'right', isLeftSide ? line?.left : line?.right))\n        : copyText(getSplitDiffMultiLineCode(isLeftSide ? 'left' : 'right'))\n\n      return\n    }\n\n    // Copy unified diff code\n    copyText(getUnifiedDiffLineCode())\n  }\n\n  const expandAllHunks = () => {\n    const expandAllHunksButton = document.querySelector(`.js-expand-all-difflines-button[data-file-path=\"${filePath}\"]`)\n    expandAllHunksButton?.dispatchEvent(new MouseEvent('click', {bubbles: true, cancelable: true}))\n  }\n\n  const expandHunkDown = () => {\n    // When a user is focused on a hunk row, \"expanding down\" means expanding the bottom of the\n    // previous hunk that directly borders this row.\n    if (line?.type === 'HUNK') {\n      expandEndOfPreviousHunk()\n      return\n    }\n\n    expandEndOfHunk()\n  }\n\n  const copyAnchorLink = () => {\n    const link = anchorLinkForSelection({line, range: selectedDiffRowRange, fileAnchor})\n    if (link) copyText(link)\n  }\n\n  const handleMouseDown = useCallback(\n    (event: React.MouseEvent) => {\n      // This will prevent unnecessary text highlighting when users are holding down shift key to select multiple lines with the mouse cursor.\n      if (event.shiftKey) {\n        event.preventDefault()\n      }\n\n      handleDiffSideCellSelectionBlocking?.(event)\n    },\n    [handleDiffSideCellSelectionBlocking],\n  )\n\n  return (\n    <ScopedCommands\n      as=\"td\"\n      commands={{\n        'github:open-context-menu': openContextMenu,\n        'pull-requests-diff-view:copy-code': copyCode,\n        'pull-requests-diff-view:expand-all-hunks': expandAllHunks,\n        'pull-requests-diff-view:expand-hunk-up': expandStartOfHunk,\n        'pull-requests-diff-view:expand-hunk-down': expandHunkDown,\n        'pull-requests-diff-view:copy-anchor-link': copyAnchorLink,\n        'pull-requests-diff-view:start-conversation-current': startConversation,\n      }}\n      ref={cellRef}\n      data-grid-cell-id={useCellId(columnIndex)}\n      data-line-anchor={lineAnchor}\n      data-selected={isRowSelected}\n      role=\"gridcell\"\n      style={{userSelect: 'none', position: 'relative'}}\n      tabIndex={-1}\n      valign=\"top\"\n      className={\n        className ? `focusable-grid-cell ${className} ${columnIndex < 3 ? 'left-side' : ''}` : 'focusable-grid-cell'\n      }\n      onBlur={e => (e.target.ariaSelected = 'false')}\n      onClick={handleDiffCellClick}\n      onContextMenu={e => {\n        if (openContextMenu()) e.preventDefault()\n      }}\n      onFocus={e => (e.target.ariaSelected = 'true')}\n      onMouseDown={handleMouseDown}\n      {...props}\n    >\n      {children}\n      {/* Only render the context menu when it's visible, because Overlay performs calculations that become expensive\n          when every cell is rendering an overlay */}\n      {ContextMenu && showContextMenu && (\n        <ActionMenu anchorRef={cellRef} open onOpenChange={setShowContextMenu}>\n          <ActionMenu.Overlay width={children ? 'medium' : 'small'}>\n            <ActionList>{ContextMenu}</ActionList>\n          </ActionMenu.Overlay>\n        </ActionMenu>\n      )}\n    </ScopedCommands>\n  )\n})\n\nexport function HunkKebabIcon() {\n  return (\n    <div className=\"hunk-kebab-icon pr-2 pb-1\">\n      <KebabHorizontalIcon />\n    </div>\n  )\n}\n\ninterface ContentCellProps extends React.ComponentProps<'td'> {\n  summary?: string\n  searchResultsForLine?: DiffMatchContent[]\n  focusedSearchResult?: number\n  columnIndex: number\n  lineAnchor?: string\n  handleDiffCellClick: (event: React.MouseEvent<HTMLTableCellElement>) => void\n  handleDiffSideCellSelectionBlocking: (event: React.MouseEvent) => void\n  tabSize: number\n  filePath: string\n  copilotChatReferenceData?: CopilotChatFileDiffReferenceData\n  commentIndicator?: JSX.Element | null\n}\n\n/**\n * Renders the diff text.\n * Optionally renders comment indicator and action menu, if commenting is enabled.\n */\nexport function ContentCell({\n  summary,\n  searchResultsForLine,\n  focusedSearchResult,\n  columnIndex,\n  lineAnchor,\n  handleDiffCellClick,\n  handleDiffSideCellSelectionBlocking,\n  filePath,\n  tabSize,\n  copilotChatReferenceData,\n}: ContentCellProps) {\n  const {diffLine, fileAnchor, isLeftSide} = useDiffLineContext()\n  const line = diffLine as DiffLine\n  const {getTextIndent, getPaddingLeft} = useMemo(() => diffLineFileWrap(line.text, tabSize), [line, tabSize])\n  const [lineHtml, trimmedChar] = trimContentLine(line.html, line.type)\n  const showTrimmedChar = trimmedChar && ['+', '-'].includes(trimmedChar)\n  const {isActionBarVisible} = useMarkersDialogContext()\n  const {selectedDiffRowRange, selectedDiffLines} = useSelectedDiffRowRangeContext()\n  const {\n    commentBatchPending,\n    commentingEnabled,\n    commentingImplementation,\n    markerNavigationImplementation,\n    repositoryId,\n    subjectId,\n    subject,\n    viewerData,\n  } = useDiffContext()\n  const {hasPersistedComment} = usePersistedDiffCommentData({\n    diffSide: isLeftSide ? 'LEFT' : 'RIGHT',\n    filePath,\n    line: line.blobLineNumber,\n    subjectId,\n    fileLevelComment: false,\n  })\n\n  const showStartConversation: boolean = useMemo(() => {\n    return viewerCanCommentOnLine(commentingEnabled, viewerData.viewerCanComment, line, selectedDiffLines)\n  }, [commentingEnabled, viewerData, line, selectedDiffLines])\n\n  // When a user closes a dialog launched from either the action bar or the context menu, we want to return focus to the\n  // element that triggered the dialog.\n  const actionBarReturnFocusRef = useRef<HTMLButtonElement | null>(null)\n  const cellRef = useRef<HTMLTableCellElement>(null)\n\n  const commentIndicatorRightPositioning = calculateCommentIndicatorRightPositioning({\n    shouldAlignRight: hasPersistedComment || !showStartConversation,\n  })\n  const hasThreads = !!line.threadsData?.threads?.length || !!line.annotationsData?.annotations?.length\n  const commentIndicatorGutterSize = calculateDiffLineCodeCellGutter({hasThreads})\n\n  const addCommentDialogTitle = useCommentDialogTitle(line, !!isLeftSide)\n\n  const cellId = useCellId(columnIndex)\n  const {handleCellBlur, handleCellFocus, handleCellMouseEnter, handleCellMouseLeave} = useActionBarFocus({\n    cellRef,\n  })\n  const {\n    annotations,\n    isNewConversationDialogOpen,\n    shouldStartNewConversationWithSuggestedChange,\n    startNewConversation,\n    startNewConversationWithSuggestedChange,\n    openMarkerOrListDialog,\n    selectAnnotation,\n    selectThread,\n    isMarkerListDialogOpen,\n    closeNewConversationDialog,\n    closeMarkerListDialog,\n    closeConversationDetailsDialog,\n    returnFocusRef,\n    optimizedSelectedAnnotationId,\n    optimizedSelectedThreadId,\n    threadConnectionId,\n    threads,\n  } = useActionBarDialogs({\n    cellId,\n    actionBarRef: actionBarReturnFocusRef,\n  })\n\n  /** Open review thread or annotation for global marker navigation */\n  useEffect(() => {\n    if (!markerNavigationImplementation) return\n\n    const {activeGlobalMarkerID, onActivateGlobalMarkerNavigation} = markerNavigationImplementation\n    if (activeGlobalMarkerID) {\n      const threadIds = threads.map(l => l.id)\n      const annotationIds = annotations.map(a => a.id)\n      if (threadIds.includes(activeGlobalMarkerID)) {\n        selectThread(activeGlobalMarkerID, {skipLineSelection: true})\n        onActivateGlobalMarkerNavigation()\n      } else if (annotationIds.includes(activeGlobalMarkerID)) {\n        selectAnnotation(activeGlobalMarkerID, {skipLineSelection: true})\n        onActivateGlobalMarkerNavigation()\n      }\n    }\n  }, [selectThread, threads, markerNavigationImplementation, annotations, selectAnnotation])\n\n  const handleAddComment = ({\n    onCompleted,\n    threadsConnectionId,\n    ...args\n  }: {\n    filePath: string\n    onCompleted?: (threadId: string, commentDatabaseId?: number) => void\n    onError: (error: Error) => void\n    side?: 'LEFT' | 'RIGHT' | undefined\n    submitBatch?: boolean | undefined\n    text: string\n    threadsConnectionId?: string | undefined\n  }) => {\n    if (!commentingImplementation || !line) return\n\n    // if there's a row selection, we want to add the thread to the last line of the selection\n    const {leftLines, rightLines} = selectedDiffLines\n    if (selectedDiffRowRange) {\n      const linesToCheck = selectedDiffRowRange.endOrientation === 'left' ? leftLines : rightLines\n      const lastSelectedLine = linesToCheck[linesToCheck.length - 1]\n      if (lastSelectedLine && isDiffLine(lastSelectedLine) && lastSelectedLine.threadsData?.__id) {\n        threadsConnectionId = lastSelectedLine.threadsData?.__id\n      }\n    }\n\n    const handleCompleted = (threadId: string, commentDatabaseId?: number) => {\n      onCompleted?.(threadId, commentDatabaseId)\n      selectThread(threadId)\n    }\n\n    commentingImplementation.addThread({\n      ...args,\n      diffLine: line,\n      isLeftSide,\n      selectedDiffRowRange,\n      threadsConnectionId,\n      onCompleted: handleCompleted,\n    })\n  }\n\n  const handleDeleteComment = ({\n    onCompleted,\n    ...args\n  }: {\n    commentConnectionId?: string\n    commentId: string\n    onCompleted?: () => void\n    onError: (error: Error) => void\n    threadCommentCount?: number\n    threadsConnectionId?: string\n    threadId: string\n  }) => {\n    if (!commentingImplementation || !line) return\n\n    const handleCompleted = () => {\n      onCompleted?.()\n      // If there are no more comments on this line, focus on the cell\n      if (threads.length <= 1) {\n        closeConversationDetailsDialog()\n        setTimeout(() => cellRef.current?.focus())\n      }\n    }\n    commentingImplementation.deleteComment({\n      ...args,\n      onCompleted: handleCompleted,\n      filePath,\n    })\n  }\n\n  const suggestedChangesConfig = useSuggestedChanges(\n    commentingImplementation?.suggestedChangesEnabled,\n    line,\n    shouldStartNewConversationWithSuggestedChange,\n  )\n\n  const shouldAnimate = useRef(true)\n  const {ghostUser} = useDiffContext()\n\n  return (\n    <Cell\n      ref={cellRef}\n      columnIndex={columnIndex}\n      commentDialogOpen={isNewConversationDialogOpen}\n      handleDiffCellClick={handleDiffCellClick}\n      handleDiffSideCellSelectionBlocking={handleDiffSideCellSelectionBlocking}\n      lineAnchor={lineAnchor}\n      startConversation={startNewConversation}\n      ContextMenu={\n        <CellContextMenu\n          copilotChatReferenceData={copilotChatReferenceData}\n          showStartConversation={showStartConversation}\n          handleViewMarkersSelection={openMarkerOrListDialog}\n          startConversationCurrentLine={startNewConversation}\n          startConversationWithSuggestedChange={startNewConversationWithSuggestedChange}\n        />\n      }\n      className={clsx(`diff-text-cell ${isLeftSide ? 'left-side-diff-cell' : 'right-side-diff-cell'}`, {\n        'border-right': isLeftSide && line.type !== 'HUNK',\n      })}\n      style={{\n        backgroundColor: getBackgroundColor(line.type, false),\n        paddingRight: commentIndicatorGutterSize,\n      }}\n      onBlur={handleCellBlur}\n      onFocus={handleCellFocus}\n      onMouseEnter={handleCellMouseEnter}\n      onMouseLeave={handleCellMouseLeave}\n    >\n      <code\n        className={clsx('diff-text syntax-highlighted-line', {\n          addition: line.type === 'ADDITION',\n          deletion: line.type === 'DELETION',\n        })}\n      >\n        {showTrimmedChar && <span className=\"diff-text-marker\">{trimmedChar}</span>}\n        {searchResultsForLine && searchResultsForLine.length > 0 && (\n          <DiffHighlightedOverlay\n            searchResults={searchResultsForLine}\n            focusedSearchResult={focusedSearchResult}\n            className={clsx('diff-text-inner', {\n              'color-fg-muted': line.type === 'HUNK',\n            })}\n            styleObject={{\n              paddingLeft: getPaddingLeft(),\n              textIndent: getTextIndent(),\n            }}\n          />\n        )}\n        {/* Explicitly mark html as safe because it is server-sanitized */}\n        <SafeHTMLDiv\n          html={lineHtml as SafeHTMLString}\n          className={clsx('diff-text-inner', {\n            'color-fg-muted': line.type === 'HUNK',\n          })}\n          style={{\n            paddingLeft: getPaddingLeft(),\n            textIndent: getTextIndent(),\n          }}\n        />\n      </code>\n      {isActionBarVisible && (\n        <ActionBar\n          copilotChatReferenceData={copilotChatReferenceData}\n          authorAvatarUrl={viewerData.avatarUrl}\n          authorLogin={viewerData.login}\n          ref={actionBarReturnFocusRef}\n          cellId={cellId}\n          cellRef={cellRef}\n          hasDraftComment={hasPersistedComment}\n          showStartConversation={showStartConversation}\n        />\n      )}\n      {commentingImplementation && markerNavigationImplementation && (\n        <>\n          <Markers\n            annotations={annotations}\n            batchPending={commentBatchPending}\n            batchingEnabled={commentingImplementation.batchingEnabled}\n            commentingImplementation={{...commentingImplementation, deleteComment: handleDeleteComment}}\n            conversationAnchorRef={cellRef}\n            conversationListAnchorRef={returnFocusRef}\n            conversationListThreads={threads}\n            fileAnchor={fileAnchor}\n            filePath={filePath}\n            isMarkerListOpen={isMarkerListDialogOpen}\n            repositoryId={repositoryId}\n            returnFocusRef={returnFocusRef}\n            selectedAnnotationId={optimizedSelectedAnnotationId}\n            selectedThreadId={optimizedSelectedThreadId}\n            subjectId={subjectId}\n            subject={subject}\n            suggestedChangesConfig={suggestedChangesConfig}\n            threadsConnectionId={threadConnectionId}\n            onCloseConversationDialog={closeConversationDetailsDialog}\n            onCloseConversationList={closeMarkerListDialog}\n            onAnnotationSelected={selectAnnotation}\n            onThreadSelected={selectThread}\n            markerNavigationImplementation={markerNavigationImplementation}\n            viewerData={viewerData}\n            ghostUser={ghostUser}\n          />\n          <StartConversation\n            addCommentDialogTitle={addCommentDialogTitle}\n            anchorRef={cellRef}\n            batchPending={commentBatchPending}\n            batchingEnabled={commentingImplementation.batchingEnabled}\n            commentBoxConfig={commentingImplementation.commentBoxConfig}\n            filePath={filePath}\n            isLeftSide={!!isLeftSide}\n            isOpen={isNewConversationDialogOpen}\n            lineNumber={line.blobLineNumber}\n            repositoryId={repositoryId}\n            returnFocusRef={returnFocusRef}\n            subjectId={subjectId}\n            suggestedChangesConfig={suggestedChangesConfig}\n            threadsConnectionId={threadConnectionId}\n            viewerData={viewerData}\n            onAddComment={handleAddComment}\n            onCloseCommentDialog={closeNewConversationDialog}\n          />\n        </>\n      )}\n      {!isActionBarVisible && (\n        <div\n          aria-hidden=\"true\"\n          style={{right: commentIndicatorRightPositioning}}\n          className=\"position-absolute top-0 d-flex user-select-none\"\n        >\n          <CommentIndicator shouldAnimateRef={shouldAnimate} />\n          {hasPersistedComment && (\n            <InProgressCommentIndicator\n              authorAvatarUrl={viewerData.avatarUrl}\n              authorLogin={viewerData.login}\n              // magic numbers for positioning align these elements with the action bar buttons that appears on hover\n              sx={{ml: '9px', mt: '2px', height: '20px'}}\n            />\n          )}\n        </div>\n      )}\n      {summary && <DiffLineScreenReaderSummary summary={summary} />}\n    </Cell>\n  )\n}\n\ntype LineNumberCellProps = React.PropsWithChildren<{\n  columnIndex: number\n  handleDiffCellClick: (event: React.MouseEvent<HTMLTableCellElement>) => void\n  handleDiffSideCellSelectionBlocking: (event: React.MouseEvent) => void\n  filePath: string\n  copilotChatReferenceData?: CopilotChatFileDiffReferenceData\n}>\n\n/**\n * Renders a line number cell\n */\nexport function LineNumberCell({\n  children,\n  columnIndex,\n  handleDiffCellClick,\n  handleDiffSideCellSelectionBlocking,\n  filePath,\n  copilotChatReferenceData,\n  ...rest\n}: LineNumberCellProps) {\n  const cellRef = useRef<HTMLTableCellElement>(null)\n  const cellId = useCellId(columnIndex)\n  const {\n    commentBatchPending,\n    commentingEnabled,\n    commentingImplementation,\n    repositoryId,\n    subject,\n    subjectId,\n    markerNavigationImplementation,\n    viewerData,\n  } = useDiffContext()\n  const {diffLine, fileAnchor, isLeftSide} = useDiffLineContext()\n  const line = diffLine as DiffLine\n  const {selectedDiffRowRange, selectedDiffLines} = useSelectedDiffRowRangeContext()\n  const addCommentDialogTitle = useCommentDialogTitle(line, !!isLeftSide)\n\n  const showStartConversation: boolean = useMemo(() => {\n    return viewerCanCommentOnLine(commentingEnabled, viewerData.viewerCanComment, line, selectedDiffLines)\n  }, [commentingEnabled, viewerData, line, selectedDiffLines])\n\n  const {handleCellBlur, handleCellFocus, handleCellMouseEnter, handleCellMouseLeave} = useActionBarFocus({\n    cellRef,\n  })\n  const {ghostUser} = useDiffContext()\n\n  const {\n    annotations,\n    isNewConversationDialogOpen,\n    shouldStartNewConversationWithSuggestedChange,\n    startNewConversation,\n    startNewConversationWithSuggestedChange,\n    openMarkerOrListDialog,\n    isMarkerListDialogOpen,\n    closeConversationDetailsDialog,\n    closeMarkerListDialog,\n    selectAnnotation,\n    selectThread,\n    closeNewConversationDialog,\n    returnFocusRef,\n    optimizedSelectedThreadId,\n    optimizedSelectedAnnotationId,\n    threadConnectionId,\n    threads,\n  } = useActionBarDialogs({\n    cellId,\n    actionBarRef: cellRef,\n  })\n\n  const handleAddComment = ({\n    onCompleted,\n    threadsConnectionId,\n    ...args\n  }: {\n    filePath: string\n    onCompleted?: (threadId: string, commentDatabaseId?: number) => void\n    onError: (error: Error) => void\n    side?: 'LEFT' | 'RIGHT' | undefined\n    submitBatch?: boolean | undefined\n    text: string\n    threadsConnectionId?: string | undefined\n  }) => {\n    if (!commentingImplementation || !line) return\n\n    const handleCompleted = (threadId: string, commentDatabaseId?: number) => {\n      onCompleted?.(threadId, commentDatabaseId)\n      selectThread(threadId)\n    }\n\n    // if there's a row selection, we want to add the thread to the last line of the selection\n    const {leftLines, rightLines} = selectedDiffLines\n    if (selectedDiffRowRange) {\n      const linesToCheck = selectedDiffRowRange.endOrientation === 'left' ? leftLines : rightLines\n      const lastSelectedLine = linesToCheck[linesToCheck.length - 1]\n      if (lastSelectedLine && isDiffLine(lastSelectedLine) && lastSelectedLine.threadsData?.__id) {\n        threadsConnectionId = lastSelectedLine.threadsData?.__id\n      }\n    }\n\n    commentingImplementation.addThread({\n      ...args,\n      diffLine: line,\n      selectedDiffRowRange,\n      threadsConnectionId,\n      onCompleted: handleCompleted,\n    })\n  }\n\n  const handleDeleteComment = ({\n    onCompleted,\n    ...args\n  }: {\n    commentConnectionId?: string\n    commentId: string\n    onCompleted?: () => void\n    onError: (error: Error) => void\n    threadCommentCount?: number\n    threadsConnectionId?: string\n    threadId: string\n  }) => {\n    if (!commentingImplementation || !line) return\n\n    const handleCompleted = () => {\n      onCompleted?.()\n\n      // If there are no more comments on this line, focus on the cell\n      if (threads.length <= 1) {\n        closeConversationDetailsDialog()\n        setTimeout(() => cellRef.current?.focus())\n      }\n    }\n    commentingImplementation.deleteComment({\n      ...args,\n      onCompleted: handleCompleted,\n      filePath,\n    })\n  }\n\n  const suggestedChangesConfig = useSuggestedChanges(\n    commentingImplementation?.suggestedChangesEnabled,\n    line,\n    shouldStartNewConversationWithSuggestedChange,\n  )\n\n  return (\n    <>\n      <Cell\n        ref={cellRef}\n        className=\"diff-line-number\"\n        columnIndex={columnIndex}\n        commentDialogOpen={isNewConversationDialogOpen}\n        handleDiffCellClick={handleDiffCellClick}\n        handleDiffSideCellSelectionBlocking={handleDiffSideCellSelectionBlocking}\n        startConversation={startNewConversation}\n        style={{backgroundColor: getBackgroundColor(line.type, true), textAlign: 'center'}}\n        ContextMenu={\n          <CellContextMenu\n            copilotChatReferenceData={copilotChatReferenceData}\n            showStartConversation={showStartConversation}\n            handleViewMarkersSelection={openMarkerOrListDialog}\n            startConversationCurrentLine={startNewConversation}\n            startConversationWithSuggestedChange={startNewConversationWithSuggestedChange}\n          />\n        }\n        onBlur={handleCellBlur}\n        onFocus={handleCellFocus}\n        onMouseEnter={handleCellMouseEnter}\n        onMouseLeave={handleCellMouseLeave}\n        {...rest}\n      >\n        <code>{children}</code>\n      </Cell>\n      {commentingImplementation && markerNavigationImplementation && (\n        <>\n          <Markers\n            annotations={annotations}\n            batchPending={commentBatchPending}\n            batchingEnabled={commentingImplementation.batchingEnabled}\n            commentingImplementation={{...commentingImplementation, deleteComment: handleDeleteComment}}\n            conversationAnchorRef={cellRef}\n            conversationListAnchorRef={returnFocusRef}\n            conversationListThreads={threads}\n            fileAnchor={fileAnchor}\n            filePath={filePath}\n            isMarkerListOpen={isMarkerListDialogOpen}\n            repositoryId={repositoryId}\n            returnFocusRef={returnFocusRef}\n            selectedAnnotationId={optimizedSelectedAnnotationId}\n            selectedThreadId={optimizedSelectedThreadId}\n            subjectId={subjectId}\n            subject={subject}\n            suggestedChangesConfig={suggestedChangesConfig}\n            threadsConnectionId={threadConnectionId}\n            markerNavigationImplementation={markerNavigationImplementation}\n            onCloseConversationDialog={closeConversationDetailsDialog}\n            onCloseConversationList={closeMarkerListDialog}\n            onThreadSelected={selectThread}\n            onAnnotationSelected={selectAnnotation}\n            viewerData={viewerData}\n            ghostUser={ghostUser}\n          />\n          <StartConversation\n            addCommentDialogTitle={addCommentDialogTitle}\n            align=\"start\"\n            anchorRef={cellRef}\n            batchPending={commentBatchPending}\n            batchingEnabled={commentingImplementation.batchingEnabled}\n            commentBoxConfig={commentingImplementation.commentBoxConfig}\n            filePath={filePath}\n            isLeftSide={!!isLeftSide}\n            isOpen={isNewConversationDialogOpen}\n            lineNumber={line.blobLineNumber}\n            repositoryId={repositoryId}\n            returnFocusRef={returnFocusRef}\n            subjectId={subjectId}\n            suggestedChangesConfig={suggestedChangesConfig}\n            threadsConnectionId={threadConnectionId}\n            viewerData={viewerData}\n            onAddComment={handleAddComment}\n            onCloseCommentDialog={closeNewConversationDialog}\n          />\n        </>\n      )}\n    </>\n  )\n}\n\n/**\n * Renders a hunk header cell\n */\nexport function HunkCell({\n  ContextMenu,\n  renderHunkButton,\n  searchResultsForLine,\n  focusedSearchResult,\n}: {\n  ContextMenu?: ReactElement\n  renderHunkButton?: (additionalProps: PrunedIconButtonProps) => ReactNode | null\n  searchResultsForLine?: DiffMatchContent[]\n  focusedSearchResult?: number\n}) {\n  const cellRef = useRef<HTMLTableCellElement>(null)\n  const [cellProps, buttonProps] = useGridCellButtonProps(cellRef)\n  const {diffLine} = useDiffLineContext()\n  const line = diffLine as DiffLine\n\n  return (\n    <Cell\n      ref={cellRef}\n      ContextMenu={ContextMenu}\n      colSpan={4}\n      columnIndex={0}\n      style={{backgroundColor: 'var(--bgColor-accent-muted, var(--color-accent-subtle))', flexGrow: 1}}\n      {...cellProps}\n    >\n      <div className=\"d-flex flex-row\">\n        {renderHunkButton?.(buttonProps) ?? <HunkKebabIcon />}\n        <code className=\"diff-text-cell hunk\">\n          {searchResultsForLine && searchResultsForLine.length > 0 && (\n            <DiffHighlightedOverlay\n              searchResults={searchResultsForLine}\n              focusedSearchResult={focusedSearchResult}\n              className={clsx('diff-text-inner', {\n                'color-fg-muted': line.type === 'HUNK',\n              })}\n            />\n          )}\n          {/* Explicitly mark html as safe because it is server-sanitized */}\n          <SafeHTMLDiv className=\"diff-text-inner color-fg-muted\" html={line.html as SafeHTMLString} />\n        </code>\n      </div>\n    </Cell>\n  )\n}\n\n/**\n * Renders an empty cell\n */\nexport function EmptyCell({columnIndex, showRightBorder}: {columnIndex: number; showRightBorder?: boolean}) {\n  return (\n    <Cell\n      ContextMenu={<EmptyCellContextMenu />}\n      className={clsx('empty-diff-line', {'border-right': showRightBorder})}\n      columnIndex={columnIndex}\n    />\n  )\n}\n\nexport function getBackgroundColor(lineType: DiffLineType, isNumber = false): string | undefined {\n  switch (lineType) {\n    case 'ADDITION':\n      return isNumber\n        ? 'var(--diffBlob-addition-bgColor-num, var(--color-diff-blob-addition-num-bg))'\n        : 'var(--diffBlob-addition-bgColor-line, var(--color-diff-blob-addition-line-bg))'\n    case 'DELETION':\n      return isNumber\n        ? 'var(--diffBlob-deletion-bgColor-num, var(--color-diff-blob-deletion-num-bg))'\n        : 'var(--diffBlob-deletion-bgColor-line, var(--color-diff-blob-deletion-line-bg))'\n    case 'HUNK':\n      return isNumber\n        ? 'var(--diffBlob-hunk-bgColor-num, var(--color-diff-blob-hunk-num-bg))'\n        : 'var(--bgColor-accent-muted, var(--color-accent-subtle))'\n    case 'EMPTY':\n      return isNumber\n        ? 'var(--diffBlob-hunk-bgColor-num, var(--color-diff-blob-hunk-num-bg))'\n        : 'var(--bgColor-accent-muted, var(--color-accent-subtle))'\n    default:\n      return undefined\n  }\n}\n\ntry{ Cell.displayName ||= 'Cell' } catch {}\ntry{ HunkKebabIcon.displayName ||= 'HunkKebabIcon' } catch {}\ntry{ ContentCell.displayName ||= 'ContentCell' } catch {}\ntry{ LineNumberCell.displayName ||= 'LineNumberCell' } catch {}\ntry{ HunkCell.displayName ||= 'HunkCell' } catch {}\ntry{ EmptyCell.displayName ||= 'EmptyCell' } catch {}","import {lineAnchorFrom, lineOrientationFrom} from '@github-ui/diffs/diff-line-helpers'\nimport type {DiffAnchor} from '@github-ui/diffs/types'\nimport type {MouseEvent} from 'react'\nimport React, {useCallback} from 'react'\n\nimport {ContentCell, EmptyCell, LineNumberCell} from './DiffLineTableCellParts'\nimport {MarkersDialogContextProvider} from '../contexts/MarkersDialogContext'\nimport {useDiffContext} from '../contexts/DiffContext'\nimport {useDiffLineContext} from '../contexts/DiffLineContext'\nimport {isEmptyDiffLine} from '../helpers/line-helpers'\nimport type {CopilotChatFileDiffReferenceData, DiffLine} from '../types'\nimport type {DiffMatchContent} from '../helpers/find-in-diff'\n\ntype HandleDiffRowClickFn = (\n  event: React.MouseEvent<HTMLTableCellElement>,\n  lineNumber: number,\n  orientation: 'left' | 'right',\n  shiftKey: boolean,\n) => void\n\nconst CodeDiffLineUnmemoized = ({\n  summary,\n  resultsForLine,\n  focusedSearchResult,\n  handleDiffSideCellSelectionBlocking,\n  handleDiffRowClick,\n  lineAnchor,\n  filePath,\n  copilotChatReferenceData,\n}: {\n  summary?: string\n  resultsForLine?: DiffMatchContent[]\n  focusedSearchResult?: number\n  filePath: string\n  lineAnchor: string\n  handleDiffSideCellSelectionBlocking?: (diffSide: 'left' | 'right') => void\n  handleDiffRowClick: HandleDiffRowClickFn\n  copilotChatReferenceData?: CopilotChatFileDiffReferenceData\n}) => {\n  const {diffLine, isLeftSide, isSplit} = useDiffLineContext()\n  const line = diffLine as DiffLine\n  const {viewerData} = useDiffContext()\n  const {tabSizePreference} = viewerData\n\n  /*\n   * display the left cell for all lines in a unified view, and left lines of a split view\n   * this cell will not contain a number in the unified view if the line is an addition\n   */\n  const showLeftNumber = line.type !== 'ADDITION'\n  const showLeftNumberCell = !isSplit || isLeftSide\n  const displayingEmptyLeftNumberCell = showLeftNumberCell && !showLeftNumber\n\n  /*\n   * display the right cell for all lines in a unified view, and right lines of a split view\n   * this cell will not contain a number in the unified view if the line is a deletion\n   */\n  const showRightNumber = line.type !== 'DELETION'\n  const showRightNumberCell = !isSplit || !isLeftSide\n  const displayingEmptyRightNumberCell = showRightNumberCell && !showRightNumber\n\n  const handleLeftDiffCellClick = useCallback(\n    (event: MouseEvent<HTMLTableCellElement>) => {\n      if (!line.left) return\n      handleDiffRowClick(event, line.left, 'left', event.shiftKey)\n    },\n    [handleDiffRowClick, line.left],\n  )\n\n  const handleRightDiffCellClick = useCallback(\n    (event: MouseEvent<HTMLTableCellElement>) => {\n      if (!line.right) return\n      handleDiffRowClick(event, line.right, 'right', event.shiftKey)\n    },\n    [handleDiffRowClick, line.right],\n  )\n\n  const handleRightDiffSideCellSelectionBlocking = useCallback(() => {\n    if (!handleDiffSideCellSelectionBlocking) return\n    const diffSideToBlock = 'left'\n    handleDiffSideCellSelectionBlocking(diffSideToBlock)\n  }, [handleDiffSideCellSelectionBlocking])\n\n  const handleLeftDiffSideCellSelectionBlocking = useCallback(() => {\n    if (!handleDiffSideCellSelectionBlocking) return\n    const diffSideToBlock = 'right'\n    handleDiffSideCellSelectionBlocking(diffSideToBlock)\n  }, [handleDiffSideCellSelectionBlocking])\n\n  return (\n    <MarkersDialogContextProvider line={line}>\n      {showLeftNumberCell && (\n        <LineNumberCell\n          copilotChatReferenceData={copilotChatReferenceData}\n          columnIndex={0}\n          filePath={filePath}\n          // If this cell is empty, select the right-side (modified) row\n          handleDiffCellClick={displayingEmptyLeftNumberCell ? handleRightDiffCellClick : handleLeftDiffCellClick}\n          handleDiffSideCellSelectionBlocking={handleLeftDiffSideCellSelectionBlocking}\n        >\n          {showLeftNumber && line.left}\n        </LineNumberCell>\n      )}\n      {showRightNumberCell && (\n        <LineNumberCell\n          copilotChatReferenceData={copilotChatReferenceData}\n          columnIndex={isSplit ? 2 : 1}\n          filePath={filePath}\n          // If this cell is empty, select the left-side (original) row\n          handleDiffCellClick={displayingEmptyRightNumberCell ? handleLeftDiffCellClick : handleRightDiffCellClick}\n          handleDiffSideCellSelectionBlocking={handleRightDiffSideCellSelectionBlocking}\n        >\n          {showRightNumber && line.right}\n        </LineNumberCell>\n      )}\n      <ContentCell\n        copilotChatReferenceData={copilotChatReferenceData}\n        columnIndex={isSplit ? (isLeftSide ? 1 : 3) : 2}\n        filePath={filePath}\n        handleDiffCellClick={isLeftSide ? handleLeftDiffCellClick : handleRightDiffCellClick}\n        lineAnchor={lineAnchor}\n        tabSize={tabSizePreference}\n        handleDiffSideCellSelectionBlocking={\n          isLeftSide ? handleLeftDiffSideCellSelectionBlocking : handleRightDiffSideCellSelectionBlocking\n        }\n        searchResultsForLine={resultsForLine}\n        focusedSearchResult={focusedSearchResult}\n        summary={summary}\n      />\n    </MarkersDialogContextProvider>\n  )\n}\n\ninterface DiffSideProps {\n  summary?: string\n  resultsForLine?: DiffMatchContent[]\n  focusedSearchResult?: number\n  fileAnchor: DiffAnchor\n  filePath: string\n  handleDiffRowClick: HandleDiffRowClickFn\n  handleDiffSideCellSelectionBlocking: (diffSide: 'left' | 'right') => void\n  copilotChatReferenceData?: CopilotChatFileDiffReferenceData\n}\n\nexport const DiffLineSideUnmemoized = ({\n  summary,\n  resultsForLine,\n  focusedSearchResult,\n  fileAnchor,\n  filePath,\n  handleDiffRowClick,\n  handleDiffSideCellSelectionBlocking,\n  copilotChatReferenceData,\n}: DiffSideProps) => {\n  const {diffLine, isLeftSide} = useDiffLineContext()\n  if (isEmptyDiffLine(diffLine)) {\n    return (\n      <>\n        <EmptyCell columnIndex={isLeftSide ? 0 : 2} />\n        <EmptyCell columnIndex={isLeftSide ? 1 : 3} showRightBorder={isLeftSide} />\n      </>\n    )\n  }\n\n  const lineOrientation = isLeftSide ? 'left' : lineOrientationFrom(diffLine.type)\n  const lineNumber = lineOrientation === 'left' ? diffLine.left : diffLine.right\n  const lineAnchor = lineAnchorFrom(fileAnchor, lineOrientation, lineNumber ?? 0)\n\n  switch (diffLine.type) {\n    case 'HUNK':\n      return null\n    case 'ADDITION':\n    case 'DELETION':\n    case 'CONTEXT':\n    case 'INJECTED_CONTEXT':\n      return (\n        <CodeDiffLine\n          copilotChatReferenceData={copilotChatReferenceData}\n          filePath={filePath}\n          handleDiffRowClick={handleDiffRowClick}\n          handleDiffSideCellSelectionBlocking={handleDiffSideCellSelectionBlocking}\n          lineAnchor={lineAnchor}\n          resultsForLine={resultsForLine}\n          focusedSearchResult={focusedSearchResult}\n          summary={summary}\n        />\n      )\n    default:\n      throw new Error(`cannot handle type ${diffLine.type}`)\n  }\n}\n\nexport const DiffLineSide = React.memo(DiffLineSideUnmemoized)\nexport const CodeDiffLine = React.memo(CodeDiffLineUnmemoized)\n\ntry{ CodeDiffLineUnmemoized.displayName ||= 'CodeDiffLineUnmemoized' } catch {}\ntry{ DiffLineSideUnmemoized.displayName ||= 'DiffLineSideUnmemoized' } catch {}\ntry{ DiffLineSide.displayName ||= 'DiffLineSide' } catch {}\ntry{ CodeDiffLine.displayName ||= 'CodeDiffLine' } catch {}","import {\n  fileCopiedOnly,\n  fileModeChangedOnly,\n  fileRenamedOnly,\n  fileTruncated,\n  fileWasDeleted,\n  fileWasGenerated,\n  truncatedReason,\n  whitespaceChangedOnly,\n} from '@github-ui/diff-file-helpers'\nimport {SplitDiffTable, UnifiedDiffTable} from '@github-ui/diffs/DiffParts'\nimport {getLineNumberWidth} from '@github-ui/diffs/diff-line-helpers'\nimport type {DiffAnchor} from '@github-ui/diffs/types'\nimport {Link} from '@primer/react'\nimport type React from 'react'\nimport {memo, type MouseEvent, useCallback, useEffect, useMemo, useRef, useState} from 'react'\n\nimport {useSelectedDiffRowRangeContext} from '../contexts/SelectedDiffRowRangeContext'\nimport {orderLineRange} from '../helpers/line-helpers'\nimport HiddenDiffPatch from './HiddenDiffPatch'\nimport {HunkHeaderData} from '../helpers/hunk-data-helpers'\nimport {SelectedDiffLinesOverlay} from './SelectedDiffLinesOverlay'\nimport SplitDiffLines from './SplitDiffLines'\nimport UnifiedDiffLines from './UnifiedDiffLines'\nimport type {CopilotChatFileDiffReferenceData, DiffContext, DiffEntryData, DiffLine} from '../types'\nimport type {DiffContextData} from '../contexts/DiffContext'\nimport {DiffContextProvider} from '../contexts/DiffContext'\nimport {overlayContainsEventTarget} from '../helpers/overlay-helpers'\nimport styles from './DiffLines.module.css'\nimport {clsx} from 'clsx'\nimport {ssrSafeWindow} from '@github-ui/ssr-utils'\nimport type {DiffMatchContent} from '../helpers/find-in-diff'\n\nfunction PlainTextStatus({diffAnchor, children}: React.PropsWithChildren<{diffAnchor: string}>) {\n  return (\n    <div className=\"fgColor-muted p-2\" data-diff-anchor={diffAnchor}>\n      {children}\n    </div>\n  )\n}\n\nexport interface DiffLinesProps extends DiffContextData {\n  searchResults?: DiffMatchContent[]\n  diffContext?: DiffContext\n  focusedSearchResult?: number\n  baseHelpUrl: string\n  diffEntryData: DiffEntryData\n  diffLinesManuallyUnhidden: boolean\n  onHandleLoadDiff: () => void\n  copilotChatReferenceData?: CopilotChatFileDiffReferenceData\n}\n\nexport const DiffLines = memo(function DiffLines({\n  searchResults,\n  diffContext = 'pr',\n  focusedSearchResult,\n  diffEntryData,\n  diffLinesManuallyUnhidden,\n  baseHelpUrl,\n  onHandleLoadDiff,\n  copilotChatReferenceData,\n  ...diffContextData\n}: DiffLinesProps) {\n  const tableRef = useRef<HTMLTableElement>(null)\n\n  const [diffSideBeingBlocked, setDiffSideBeingBlocked] = useState<'left' | 'right' | null>(null)\n  const fileLineCount = diffEntryData.newTreeEntry?.lineCount ?? diffEntryData.oldTreeEntry?.lineCount ?? 0\n\n  const diffLines: DiffLine[] = useMemo(() => {\n    const lastDiffLine = diffEntryData.diffLines[diffEntryData.diffLines.length - 1]\n\n    // We need to append a client only hunk diffline type to allow for expanding the file\n    // until EOF has been returned in diffEntryData.diffLines\n    if (lastDiffLine?.blobLineNumber && lastDiffLine.blobLineNumber < fileLineCount) {\n      return diffEntryData.diffLines.concat({\n        __id: HunkHeaderData.finalLineId,\n        blobLineNumber: lastDiffLine.blobLineNumber + 1,\n        left: null,\n        right: null,\n        type: 'HUNK',\n        html: '',\n        text: '',\n      } as DiffLine)\n    }\n\n    return diffEntryData.diffLines\n  }, [diffEntryData.diffLines, fileLineCount])\n\n  const {diffViewPreference, tabSizePreference} = diffContextData.viewerData\n  const {\n    selectedDiffRowRange,\n    replaceSelectedDiffRowRange,\n    replaceSelectedDiffRowRangeFromGridCells,\n    clearSelectedDiffRowRange,\n    updateDiffLines,\n    updateSelectedDiffRowRange,\n  } = useSelectedDiffRowRangeContext()\n  const diffAnchor: DiffAnchor = `diff-${diffEntryData.pathDigest}`\n  const isSelectedFile = diffAnchor === selectedDiffRowRange?.diffAnchor\n\n  useEffect(() => {\n    // return undefined here to keep props stable\n    if (!isSelectedFile) return\n\n    const orderedSelectedDiffRowRange = orderLineRange(selectedDiffRowRange, diffLines)\n    const selectedOrderHasNoChanges =\n      !orderedSelectedDiffRowRange || orderedSelectedDiffRowRange === selectedDiffRowRange\n\n    if (selectedOrderHasNoChanges) return\n\n    replaceSelectedDiffRowRange(orderedSelectedDiffRowRange)\n  }, [diffLines, selectedDiffRowRange, isSelectedFile, replaceSelectedDiffRowRange])\n\n  //useLocation doesn't update when the URL updates from window.history.replaceState, so the old search was\n  //never being updated if the URL wasn't being set with useNavigate\n  const search = ssrSafeWindow?.location.search\n  const isSplit = useMemo(() => {\n    const searchParams = new URLSearchParams(search)\n    const diffSearchParams = searchParams.get('diff')\n    if (diffSearchParams === 'split') return true\n\n    return diffViewPreference === 'split'\n  }, [search, diffViewPreference])\n\n  const lineNumberWidth = getLineNumberWidth(diffLines)\n\n  const handleDiffSideCellSelectionBlocking = useCallback(\n    (diffSide: 'left' | 'right') => {\n      setDiffSideBeingBlocked(diffSide)\n    },\n    [setDiffSideBeingBlocked],\n  )\n\n  const handleDiffRowClick = useCallback(\n    (\n      event: MouseEvent<HTMLTableCellElement>,\n      lineNumber: number,\n      orientation: 'left' | 'right' | undefined,\n      shiftKey: boolean,\n    ) => {\n      // don't let clicks within any of the the overlays trigger this handler\n      if (overlayContainsEventTarget(event.target as Node)) return\n      if (event.defaultPrevented) return\n\n      updateSelectedDiffRowRange(diffAnchor, lineNumber, orientation, shiftKey)\n    },\n    [diffAnchor, updateSelectedDiffRowRange],\n  )\n\n  if (diffEntryData.isBinary) return <PlainTextStatus diffAnchor={diffAnchor}>Binary file not shown.</PlainTextStatus>\n  if (fileRenamedOnly(diffEntryData))\n    return <PlainTextStatus diffAnchor={diffAnchor}>File renamed without changes.</PlainTextStatus>\n  if (fileCopiedOnly(diffEntryData))\n    return <PlainTextStatus diffAnchor={diffAnchor}>File copied without changes.</PlainTextStatus>\n  if (fileModeChangedOnly(diffEntryData.status, diffEntryData.oldTreeEntry?.mode, diffEntryData.newTreeEntry?.mode))\n    return <PlainTextStatus diffAnchor={diffAnchor}>File mode changed.</PlainTextStatus>\n  if (fileTruncated(diffEntryData))\n    // Safe, because we just validated that field exists in the predicate above.\n    return (\n      <PlainTextStatus diffAnchor={diffAnchor}>\n        {truncatedReason(diffEntryData.truncatedReason as string)}\n      </PlainTextStatus>\n    )\n  if (whitespaceChangedOnly(diffEntryData))\n    return <PlainTextStatus diffAnchor={diffAnchor}>Whitespace-only changes.</PlainTextStatus>\n  if (!diffLinesManuallyUnhidden && fileWasDeleted(diffEntryData))\n    return <HiddenDiffPatch onLoadDiff={onHandleLoadDiff}>This file was deleted.</HiddenDiffPatch>\n  if (!diffLinesManuallyUnhidden && fileWasGenerated(diffEntryData)) {\n    return (\n      <HiddenDiffPatch\n        helpText=\"customizing how changed files appear on GitHub.\"\n        helpUrl={`${baseHelpUrl}/github/administering-a-repository/customizing-how-changed-files-appear-on-github`}\n        onLoadDiff={onHandleLoadDiff}\n      >\n        Some generated files are not rendered by default. Learn more about{' '}\n      </HiddenDiffPatch>\n    )\n  }\n  if (diffLinesManuallyUnhidden && diffEntryData.isTooBig && diffEntryData.diffLines.length === 0) {\n    return (\n      <PlainTextStatus diffAnchor={diffAnchor}>\n        Diff is too big to render. To view,{' '}\n        <Link\n          inline={true}\n          href={`${baseHelpUrl}/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally`}\n        >\n          check out this pull request locally.\n        </Link>\n      </PlainTextStatus>\n    )\n  }\n  if (!diffLinesManuallyUnhidden && diffEntryData.isTooBig) {\n    if (diffEntryData.diffLines.length > 0) {\n      return <HiddenDiffPatch onLoadDiff={onHandleLoadDiff}>Large diffs are not rendered by default.</HiddenDiffPatch>\n    } else {\n      return (\n        <PlainTextStatus diffAnchor={diffAnchor}>\n          Diff is too big to render. To view,{' '}\n          <Link\n            inline={true}\n            href={`${baseHelpUrl}/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally`}\n          >\n            check out this pull request locally.\n          </Link>\n        </PlainTextStatus>\n      )\n    }\n  }\n\n  const diffLinesProps = {\n    searchResults,\n    diffContext,\n    focusedSearchResult,\n    clearSelectedDiffRowRange,\n    diffEntryId: diffEntryData.objectId,\n    diffLines,\n    fileAnchor: diffAnchor,\n    fileLineCount,\n    filePath: diffEntryData.path,\n    handleDiffRowClick,\n    handleDiffSideCellSelectionBlocking,\n    replaceSelectedDiffRowRangeFromGridCells,\n    selectedDiffRowRange: isSelectedFile ? selectedDiffRowRange : null,\n    tableRef,\n    updateDiffLines,\n    updateSelectedDiffRowRange,\n    copilotChatReferenceData,\n  }\n\n  if (!diffEntryData.diffLines) return null\n\n  return (\n    <DiffContextProvider {...diffContextData}>\n      {isSelectedFile && <SelectedDiffLinesOverlay selectedLineRange={selectedDiffRowRange} tableRef={tableRef} />}\n      <table\n        ref={tableRef}\n        className={clsx('tab-size', 'width-full', styles.tableLayoutFixed)}\n        data-block-diff-cell-selection={diffSideBeingBlocked}\n        data-diff-anchor={diffAnchor}\n        data-tab-size={tabSizePreference}\n        data-testid=\"diff-content\"\n        data-paste-markdown-skip\n        role=\"grid\"\n        style={{'--line-number-cell-width': `${lineNumberWidth}px`} as React.CSSProperties}\n      >\n        {isSplit ? (\n          <SplitDiffTable lineWidth={lineNumberWidth}>\n            <SplitDiffLines {...diffLinesProps} />\n          </SplitDiffTable>\n        ) : (\n          <UnifiedDiffTable lineWidth={lineNumberWidth}>\n            <UnifiedDiffLines {...diffLinesProps} />\n          </UnifiedDiffTable>\n        )}\n      </table>\n    </DiffContextProvider>\n  )\n})\n\ntry{ PlainTextStatus.displayName ||= 'PlainTextStatus' } catch {}\ntry{ DiffLines.displayName ||= 'DiffLines' } catch {}","import {clsx} from 'clsx'\nimport {copyText} from '@github-ui/copy-to-clipboard'\nimport {useAnalytics} from '@github-ui/use-analytics'\nimport {CopyIcon, FoldDownIcon, FoldUpIcon, UnfoldIcon} from '@primer/octicons-react'\nimport type {IconButtonProps} from '@primer/react'\nimport {ActionList, ActionMenu} from '@primer/react'\nimport {useMemo} from 'react'\n\nimport {useDiffLineContext} from '../contexts/DiffLineContext'\nimport {trimContentLine, parseHtml, getAriaKeyShortcutString, getKeyboardShortcutString} from '../helpers/line-helpers'\nimport useExpandHunk from '../hooks/use-expand-hunk'\nimport type {DiffLine} from '../types'\nimport {JumpToHunkListItems} from './DiffLineTableCellContextMenus'\nimport {HunkCell} from './DiffLineTableCellParts'\nimport type {DiffMatchContent} from '../diff-lines'\nimport styles from './ExpandableHunkHeaderDiffLine.module.css'\n\nexport type PrunedIconButtonProps = Omit<IconButtonProps, 'aria-labelledby' | 'aria-label' | 'icon' | 'sx'>\ntype ExpandButtonIcon = typeof UnfoldIcon\ntype ExpandButtonLineProps = {\n  direction: 'all' | 'down' | 'up'\n  icon: ExpandButtonIcon\n  label: string\n  ariaLabel?: string\n  onClick: () => void\n} & PrunedIconButtonProps\n\nfunction ExpandButtonLine({\n  direction,\n  icon: Icon,\n  label,\n  onClick,\n  ariaLabel,\n  className,\n  ...additionalProps\n}: ExpandButtonLineProps) {\n  const {sendAnalyticsEvent} = useAnalytics()\n\n  return (\n    <button\n      onClick={() => {\n        onClick()\n        sendAnalyticsEvent('file_entry.expand_hunk', 'FILE_EXPANDER_BUTTON')\n      }}\n      className={clsx('Button Button--iconOnly Button--invisible', styles['expand-button-line'], className)}\n      aria-label={ariaLabel ?? label}\n      data-direction={direction}\n      {...additionalProps}\n    >\n      <Icon />\n    </button>\n  )\n}\n\ntype ExpandButtonType = 'expand-all' | 'expand-up-and-down' | 'expand-down' | 'expand-up' | undefined\n\nexport interface ExpandableHunkHeaderDiffLineProps {\n  nextLine?: DiffLine | null\n  prevLine?: DiffLine | null\n  resultsForLine?: DiffMatchContent[]\n  focusedSearchResult?: number\n}\n\nexport default function ExpandableHunkHeaderDiffLine({\n  nextLine,\n  prevLine,\n  resultsForLine,\n  focusedSearchResult,\n}: ExpandableHunkHeaderDiffLineProps) {\n  const {fileLineCount, diffLine} = useDiffLineContext()\n  const currentLine = diffLine as DiffLine\n  const {expandStartOfHunk, expandEndOfPreviousHunk} = useExpandHunk()\n\n  const isStartOfDiff = !prevLine\n  const isEndOfDiff = !nextLine\n  const isStartOfFile = currentLine.blobLineNumber === 0\n  const isStartOrEndOfDiff = isStartOfDiff || isEndOfDiff\n  const isEndOfFile = isEndOfDiff && currentLine.blobLineNumber === fileLineCount\n  const maxRequestLineLimit = 20\n\n  const showExpandAll = useMemo(() => {\n    if (isStartOrEndOfDiff) return false\n    if (currentLine.blobLineNumber <= 0) return false\n    if (currentLine.blobLineNumber - prevLine.blobLineNumber <= maxRequestLineLimit) return true\n    if (nextLine.blobLineNumber - currentLine.blobLineNumber >= maxRequestLineLimit) return true\n    return false\n  }, [isStartOrEndOfDiff, currentLine, nextLine, prevLine])\n\n  const showExpandAboveAndBelow = useMemo(() => {\n    if (isStartOrEndOfDiff) return false\n    if (isEndOfFile) return false\n    if (currentLine.blobLineNumber - prevLine.blobLineNumber > maxRequestLineLimit) return true\n    return false\n  }, [isStartOrEndOfDiff, isEndOfFile, currentLine, prevLine])\n\n  const showExpandAbove = useMemo(() => {\n    if (currentLine.blobLineNumber <= 0) return false\n    if (isStartOfFile) return false\n    if (isStartOfDiff) return true\n    return false\n  }, [isStartOfDiff, isStartOfFile, currentLine])\n\n  const showExpandBelow = useMemo(() => {\n    if (isStartOfDiff) return false\n    if (isEndOfFile) return false\n    if (isEndOfDiff) return true\n    return false\n  }, [isStartOfDiff, isEndOfDiff, isEndOfFile])\n\n  const expandButtonType: ExpandButtonType = useMemo(() => {\n    switch (true) {\n      case showExpandAll:\n        return 'expand-all'\n      case showExpandAboveAndBelow:\n        return 'expand-up-and-down'\n      case showExpandAbove:\n        return 'expand-up'\n      case showExpandBelow:\n        return 'expand-down'\n    }\n  }, [showExpandAll, showExpandAboveAndBelow, showExpandAbove, showExpandBelow])\n\n  const handleExpandAboveClick = () => expandStartOfHunk()\n  const handleExpandBelowClick = () => expandEndOfPreviousHunk()\n  const handleExpandAllClick = () => expandStartOfHunk()\n\n  const handleCopyContentClick = () => {\n    const [parsedContent] = trimContentLine(parseHtml(currentLine.html), currentLine.type)\n    void copyText(parsedContent)\n  }\n\n  const renderHunkButton = (additionalProps?: PrunedIconButtonProps) => {\n    switch (expandButtonType) {\n      case 'expand-all':\n        return (\n          <ExpandButtonLine\n            {...additionalProps}\n            direction=\"all\"\n            icon={UnfoldIcon}\n            label={`Expand file from line ${prevLine?.blobLineNumber || ''} to line ${nextLine?.blobLineNumber || ''}`}\n            onClick={handleExpandAllClick}\n          />\n        )\n      case 'expand-up-and-down':\n        return (\n          <div className=\"d-flex flex-column\">\n            <ExpandButtonLine\n              {...additionalProps}\n              direction=\"down\"\n              icon={FoldDownIcon}\n              label={`Expand file down from line ${prevLine?.blobLineNumber || ''}`}\n              className={styles['expand-up-and-down']}\n              onClick={handleExpandBelowClick}\n            />\n            <ExpandButtonLine\n              {...additionalProps}\n              direction=\"up\"\n              icon={FoldUpIcon}\n              label={`Expand file up from line ${nextLine?.blobLineNumber || ''}`}\n              className={styles['expand-up-and-down']}\n              onClick={handleExpandAboveClick}\n            />\n          </div>\n        )\n      case 'expand-up':\n        return (\n          <ExpandButtonLine\n            {...additionalProps}\n            direction=\"up\"\n            icon={FoldUpIcon}\n            label={`Expand file up from line ${nextLine?.blobLineNumber || ''}`}\n            onClick={handleExpandAboveClick}\n          />\n        )\n      case 'expand-down':\n        return (\n          <ExpandButtonLine\n            {...additionalProps}\n            direction=\"down\"\n            icon={FoldDownIcon}\n            label={`Expand file down from line ${prevLine?.blobLineNumber || ''}`}\n            onClick={handleExpandBelowClick}\n          />\n        )\n      default:\n        return null\n    }\n  }\n\n  return (\n    <HunkCell\n      searchResultsForLine={resultsForLine}\n      focusedSearchResult={focusedSearchResult}\n      renderHunkButton={renderHunkButton}\n      ContextMenu={\n        <HunkContextMenu\n          handleCopyContent={handleCopyContentClick}\n          handleExpandAbove={handleExpandAboveClick}\n          handleExpandAll={handleExpandAllClick}\n          handleExpandBelow={handleExpandBelowClick}\n          shouldCopyContent={!!currentLine.html}\n          shouldExpandAbove={showExpandAboveAndBelow || showExpandAbove}\n          shouldExpandBelow={showExpandAboveAndBelow || showExpandBelow}\n        />\n      }\n    />\n  )\n}\n\nfunction HunkContextMenu({\n  shouldExpandBelow,\n  shouldExpandAbove,\n  shouldCopyContent,\n  handleExpandAll,\n  handleExpandBelow,\n  handleExpandAbove,\n  handleCopyContent,\n}: {\n  shouldExpandBelow: boolean\n  shouldExpandAbove: boolean\n  shouldCopyContent: boolean\n  handleExpandAll: () => void\n  handleExpandBelow: () => void\n  handleExpandAbove: () => void\n  handleCopyContent: () => void\n}) {\n  const expandAllShortcutArgs = {includeShiftKey: true, key: '['}\n  const expandUpShortcutArgs = {key: ']'}\n  const expandBelowShortcutArgs = {key: '['}\n  const copyContentShortcutArgs = {key: 'C'}\n\n  return (\n    <ActionMenu.Overlay width=\"medium\">\n      <ActionList>\n        <ActionList.Item aria-keyshortcuts={getAriaKeyShortcutString(expandAllShortcutArgs)} onSelect={handleExpandAll}>\n          <ActionList.LeadingVisual>\n            <UnfoldIcon />\n          </ActionList.LeadingVisual>\n          Expand all\n          <ActionList.TrailingVisual>\n            <span>{`${getKeyboardShortcutString(expandAllShortcutArgs)}`}</span>\n          </ActionList.TrailingVisual>\n        </ActionList.Item>\n        {shouldExpandAbove ? (\n          <ActionList.Item\n            aria-keyshortcuts={getAriaKeyShortcutString(expandUpShortcutArgs)}\n            onSelect={handleExpandAbove}\n          >\n            <ActionList.LeadingVisual>\n              <FoldUpIcon />\n            </ActionList.LeadingVisual>\n            Expand above\n            <ActionList.TrailingVisual>\n              <span>{`${getKeyboardShortcutString(expandUpShortcutArgs)}`}</span>\n            </ActionList.TrailingVisual>\n          </ActionList.Item>\n        ) : null}\n        {shouldExpandBelow ? (\n          <ActionList.Item\n            aria-keyshortcuts={getAriaKeyShortcutString(expandBelowShortcutArgs)}\n            onSelect={handleExpandBelow}\n          >\n            <ActionList.LeadingVisual>\n              <FoldDownIcon />\n            </ActionList.LeadingVisual>\n            Expand below\n            <ActionList.TrailingVisual>\n              <span>{`${getKeyboardShortcutString(expandBelowShortcutArgs)}`}</span>\n            </ActionList.TrailingVisual>\n          </ActionList.Item>\n        ) : null}\n        <JumpToHunkListItems />\n        {shouldCopyContent ? (\n          <ActionList.Item\n            aria-keyshortcuts={getAriaKeyShortcutString(copyContentShortcutArgs)}\n            onSelect={handleCopyContent}\n          >\n            <ActionList.LeadingVisual>\n              <CopyIcon />\n            </ActionList.LeadingVisual>\n            Copy\n            <ActionList.TrailingVisual>\n              <span>{`${getKeyboardShortcutString(copyContentShortcutArgs)}`}</span>\n            </ActionList.TrailingVisual>\n          </ActionList.Item>\n        ) : null}\n      </ActionList>\n    </ActionMenu.Overlay>\n  )\n}\n\ntry{ ExpandButtonLine.displayName ||= 'ExpandButtonLine' } catch {}\ntry{ ExpandableHunkHeaderDiffLine.displayName ||= 'ExpandableHunkHeaderDiffLine' } catch {}\ntry{ HunkContextMenu.displayName ||= 'HunkContextMenu' } catch {}","import {clsx} from 'clsx'\nimport {Button, Link} from '@primer/react'\nimport styles from './HiddenDiffPatch.module.css'\n\nfunction HiddenDiffPatch({\n  children,\n  helpText,\n  helpUrl,\n  onLoadDiff,\n}: React.PropsWithChildren<{helpText?: string; helpUrl?: string; onLoadDiff: () => void}>) {\n  const showLink = helpUrl && helpText\n  return (\n    <div className=\"px-3 py-4 fgColor-muted\">\n      <div className={clsx(styles.gridColumnTemplate)}>\n        <svg\n          aria-hidden\n          height=\"84\"\n          style={{maxWidth: '340px'}}\n          viewBox=\"0 0 340 84\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            clipPath=\"url(#diff-placeholder)\"\n            d=\"M0 0h340v84H0z\"\n            fillRule=\"evenodd\"\n            style={{fill: 'var(--bgColor-muted, var(--color-canvas-subtle))'}}\n          />\n        </svg>{' '}\n        <div className=\"d-flex flex-justify-center flex-column flex-column text-center\">\n          <Button className=\"h4 mx-auto\" variant={'invisible'} onClick={() => onLoadDiff()}>\n            Load Diff\n          </Button>\n          <span className=\"fgColor-muted mt-1\">\n            {children}\n            {showLink && (\n              <Link inline={true} href={helpUrl}>\n                {helpText}\n              </Link>\n            )}\n          </span>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default HiddenDiffPatch\n\ntry{ HiddenDiffPatch.displayName ||= 'HiddenDiffPatch' } catch {}","import {StatusAvatar} from '@github-ui/status-avatar/StatusAvatar'\nimport {DotFillIcon} from '@primer/octicons-react'\nimport type {SxProp} from '@primer/react'\n\nexport function InProgressCommentIndicator({\n  authorAvatarUrl,\n  authorLogin,\n  sx,\n}: {\n  authorAvatarUrl: string\n  authorLogin: string\n  sx?: SxProp['sx']\n}) {\n  return (\n    <StatusAvatar\n      altText={`${authorLogin}'s avatar image with pending indicator`}\n      icon={DotFillIcon}\n      iconColor=\"var(--fgColor-attention, var(--color-attention-fg))\"\n      square={false}\n      src={authorAvatarUrl}\n      backgroundSx={{\n        backgroundColor: 'var(--bgColor-default, var(--color-canvas-default))',\n        boxShadow: '0 0 0 .1px var(--bgColor-default, var(--color-canvas-default))',\n      }}\n      sx={{alignItems: 'center', display: 'flex', opacity: 0.5, ...sx}}\n    />\n  )\n}\n\ntry{ InProgressCommentIndicator.displayName ||= 'InProgressCommentIndicator' } catch {}","import FileRendererBlob, {type FileRendererBlobData} from '@github-ui/file-renderer-blob'\nimport {SafeHTMLBox, type SafeHTMLString} from '@github-ui/safe-html'\nimport {Spinner} from '@primer/react'\n\nexport function RichDiff({\n  dependencyDiffPath,\n  fileRendererInfo,\n  proseDiffHtml,\n  loading,\n}: {\n  dependencyDiffPath?: string\n  fileRendererInfo?: FileRendererBlobData\n  loading: boolean\n  proseDiffHtml?: SafeHTMLString\n}) {\n  if (loading) {\n    return (\n      <div className=\"d-flex flex-justify-center p-4\">\n        <Spinner size=\"large\" />\n      </div>\n    )\n  }\n\n  if (proseDiffHtml) {\n    return (\n      <div className=\"prose-diff position-relative\">\n        <SafeHTMLBox html={proseDiffHtml} />\n      </div>\n    )\n  } else if (fileRendererInfo) {\n    return <FileRendererBlob {...fileRendererInfo} />\n  } else if (dependencyDiffPath) {\n    return (\n      <include-fragment src={dependencyDiffPath}>\n        <div className=\"text-center py-3\">\n          <Spinner size=\"medium\" />\n          <p className=\"color-fg-muted my-2\">Loading Dependency Review...</p>\n        </div>\n      </include-fragment>\n    )\n  } else {\n    return <div className=\"d-flex flex-justify-center p-4\">This rich diff is not supported at the moment.</div>\n  }\n}\n\ntry{ RichDiff.displayName ||= 'RichDiff' } catch {}","import {clsx} from 'clsx'\nimport {useLayoutEffect} from '@github-ui/use-layout-effect'\nimport {useResizeObserver} from '@primer/react'\nimport {type RefObject, useCallback, useState} from 'react'\nimport type {LineRange} from '../types'\nimport styles from './SelectedDiffLinesOverlay.module.css'\n\n// give some space between the overlay border and the focused grid cell border\nconst OVERLAY_TOP_OFFSET = 1\nconst OVERLAY_LEFT_OFFSET = 1\nconst OVERLAY_BOTTOM_OFFSET = 2\nconst OVERLAY_RIGHT_OFFSET = 2\n\ninterface PositionData {\n  left: number\n  height: number\n  top: number\n  width: number\n}\n\n/**\n * Returns the nearest proper HTMLElement parent of `element` whose\n * position is not \"static\", or document.body, whichever is closer\n */\nfunction getPositionedParent(element: Element) {\n  let parentNode = element.parentNode\n  while (parentNode !== null) {\n    if (parentNode instanceof HTMLElement && getComputedStyle(parentNode).position !== 'static') {\n      return parentNode\n    }\n\n    parentNode = parentNode.parentNode\n  }\n\n  return document.body\n}\n\n/**\n * Blue bordered overlay that appears over selected diff lines\n */\nexport function SelectedDiffLinesOverlay({\n  selectedLineRange,\n  tableRef,\n}: {\n  selectedLineRange: LineRange\n  tableRef: RefObject<HTMLTableElement>\n}) {\n  const [positionData, setPositionData] = useState<PositionData | null>(null)\n  const updatePosition = useCallback(() => {\n    if (!tableRef.current) return\n\n    const selectedCells = tableRef.current.querySelectorAll<HTMLTableCellElement>('td[data-selected=\"true\"]')\n    if (selectedCells.length === 0) {\n      setPositionData(null)\n      return\n    }\n\n    const positionedParentBoundingRect = getPositionedParent(tableRef.current).getBoundingClientRect()\n\n    let bottom = 0\n    let left = Number.MAX_SAFE_INTEGER\n    let right = 0\n    let top = Number.MAX_SAFE_INTEGER\n    for (const cell of selectedCells) {\n      const boundingRect = cell.getBoundingClientRect()\n\n      // offset by the first positioned parent's coords to get relative distance from parent\n      bottom = Math.max(bottom, boundingRect.bottom - positionedParentBoundingRect.top)\n      left = Math.min(left, boundingRect.left - positionedParentBoundingRect.left)\n      right = Math.max(right, boundingRect.right - positionedParentBoundingRect.left)\n      top = Math.min(top, boundingRect.top - positionedParentBoundingRect.top)\n    }\n\n    setPositionData({\n      left: left - OVERLAY_LEFT_OFFSET,\n      height: bottom - top + OVERLAY_BOTTOM_OFFSET,\n      top: top - OVERLAY_TOP_OFFSET,\n      width: right - left + OVERLAY_RIGHT_OFFSET,\n    })\n  }, [tableRef])\n\n  useLayoutEffect(() => {\n    updatePosition()\n  }, [selectedLineRange, tableRef, updatePosition])\n\n  useResizeObserver(updatePosition, tableRef)\n\n  if (!positionData) return null\n\n  return (\n    <div className={clsx('position-absolute', 'borderColor-accent-emphasis', styles.overlay)} style={positionData}>\n      <div className={clsx('width-full', 'height-full', 'bgColor-accent-emphasis', styles.overlayOpacity)} />\n    </div>\n  )\n}\n\ntry{ SelectedDiffLinesOverlay.displayName ||= 'SelectedDiffLinesOverlay' } catch {}","import type {DiffAnchor} from '@github-ui/diffs/types'\nimport {Fragment, memo, type MouseEvent, type RefObject, useEffect, useMemo} from 'react'\n\nimport {DiffLineContextProvider} from '../contexts/DiffLineContext'\nimport type {\n  ReplaceSelectedDiffRowRangeFromGridCellsFnArgs,\n  UpdateSelectedDiffRowRangeFnArgs,\n} from '../contexts/SelectedDiffRowRangeContext'\nimport {threadSummary} from '../helpers/conversation-helpers'\nimport DiffRowSelectedChecker from '../helpers/diff-row-selected-checker'\nimport {getDiffHunksData, getLineHunkData} from '../helpers/hunk-data-helpers'\nimport {isEmptyDiffLine, isDiffLine, rowIdFrom} from '../helpers/line-helpers'\nimport {useGridNavigation} from '../hooks/use-grid-navigation'\nimport type {DiffLine, ClientDiffLine, LineRange, CopilotChatFileDiffReferenceData, DiffContext} from '../types'\nimport {EMPTY_DIFF_LINE} from '../types'\nimport {DiffLineSide} from './DiffLineTableRow'\nimport ExpandableHunkHeaderDiffLine from './ExpandableHunkHeaderDiffLine'\nimport {useDiffContext} from '../contexts/DiffContext'\nimport type {DiffMatchContent} from '../helpers/find-in-diff'\nimport {buildDiffLineScreenReaderSummary} from './DiffLineScreenReaderSummary'\n\n/**\n * Split a context line into two lines, one for each side of the diff. The only divergence will be the annotations and\n * threads data, which will be filtered to only include threads for the respective diff side and only include\n * annotations on the right side.\n */\nfunction splitContextLine(line: DiffLine): [DiffLine, DiffLine] {\n  const leftLineThreads = line.threadsData?.threads?.filter(thread => thread?.diffSide === 'LEFT') ?? null\n  const leftLine: DiffLine = {\n    ...line,\n    threadsData: {\n      ...line.threadsData,\n      threads: leftLineThreads,\n      totalCommentsCount:\n        leftLineThreads?.reduce((acc, thread) => acc + (thread?.commentsData?.totalCount ?? 0), 0) ?? 0,\n      totalCount: leftLineThreads?.length ?? 0,\n    },\n    annotationsData: {\n      totalCount: 0,\n      annotations: [],\n    },\n  }\n  const rightLineThreads = line.threadsData?.threads?.filter(thread => thread?.diffSide === 'RIGHT') ?? null\n  const rightLine: DiffLine = {\n    ...line,\n    threadsData: {\n      ...line.threadsData,\n      threads: rightLineThreads,\n      totalCommentsCount:\n        rightLineThreads?.reduce((acc, thread) => acc + (thread?.commentsData?.totalCount ?? 0), 0) ?? 0,\n      totalCount: rightLineThreads?.length ?? 0,\n    },\n  }\n  return [leftLine, rightLine]\n}\n\nfunction groupDiffLines(lines: DiffLine[]): {\n  leftLines: ClientDiffLine[]\n  rightLines: ClientDiffLine[]\n} {\n  const leftLines: ClientDiffLine[] = []\n  const rightLines: ClientDiffLine[] = []\n\n  // Keep list of lines even, filling in blanks as needed\n  const fillBlanks = () => {\n    while (leftLines.length < rightLines.length) {\n      leftLines.push(EMPTY_DIFF_LINE)\n    }\n\n    while (rightLines.length < leftLines.length) {\n      rightLines.push(EMPTY_DIFF_LINE)\n    }\n  }\n\n  for (const line of lines) {\n    switch (line.type) {\n      case 'ADDITION':\n        rightLines.push(line)\n        break\n      case 'DELETION':\n        leftLines.push(line)\n        break\n      case 'CONTEXT':\n      case 'INJECTED_CONTEXT':\n        fillBlanks()\n        // eslint-disable-next-line no-case-declarations\n        const [leftLine, rightLine] = splitContextLine(line)\n        leftLines.push(leftLine)\n        rightLines.push(rightLine)\n        break\n      case 'HUNK':\n        fillBlanks()\n        leftLines.push(line)\n        rightLines.push(line)\n    }\n  }\n  fillBlanks()\n\n  return {leftLines, rightLines}\n}\n\nfunction useGroupedLines(diffLines: DiffLine[]) {\n  const commentCount = diffLines.reduce((acc, line) => acc + (line.threadsData?.totalCount ?? 0), 0) ?? 0\n\n  // This useMemo prevents async loaded comments from being injected into split diff lines if you're not using GQL\n  // to get around this without losing memo, we check if the comment count has changed and use it as a dependency for the memo\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const {leftLines, rightLines} = useMemo(() => groupDiffLines(diffLines), [diffLines, commentCount])\n\n  return {leftLines, rightLines}\n}\n\nconst SplitDiffLines = memo(function SplitDiffLines({\n  searchResults,\n  diffContext = 'pr',\n  focusedSearchResult,\n  clearSelectedDiffRowRange,\n  diffEntryId,\n  diffLines,\n  fileAnchor,\n  fileLineCount,\n  filePath,\n  handleDiffRowClick,\n  handleDiffSideCellSelectionBlocking,\n  replaceSelectedDiffRowRangeFromGridCells,\n  selectedDiffRowRange,\n  tableRef,\n  updateDiffLines,\n  updateSelectedDiffRowRange,\n  copilotChatReferenceData,\n}: {\n  searchResults?: DiffMatchContent[]\n  diffContext?: DiffContext\n  focusedSearchResult?: number\n  clearSelectedDiffRowRange: () => void\n  diffEntryId: string\n  diffLines: DiffLine[]\n  fileAnchor: DiffAnchor\n  fileLineCount: number\n  filePath: string\n  handleDiffRowClick: (\n    event: MouseEvent<HTMLTableCellElement>,\n    lineNumber: number,\n    orientation: 'left' | 'right' | undefined,\n    shiftKey: boolean,\n  ) => void\n  handleDiffSideCellSelectionBlocking: (diffSide: 'left' | 'right') => void\n  replaceSelectedDiffRowRangeFromGridCells: ReplaceSelectedDiffRowRangeFromGridCellsFnArgs\n  selectedDiffRowRange: LineRange | null\n  tableRef: RefObject<HTMLTableElement>\n  updateDiffLines: (diffAnchor: string, diffLines: DiffLine[]) => void\n  updateSelectedDiffRowRange: UpdateSelectedDiffRowRangeFnArgs\n  copilotChatReferenceData?: CopilotChatFileDiffReferenceData\n}) {\n  const {leftLines, rightLines} = useGroupedLines(diffLines)\n  const {ghostUser} = useDiffContext()\n  useGridNavigation({\n    clearSelectedDiffRowRange,\n    containerRef: tableRef,\n    fileAnchor,\n    isSplitDiff: true,\n    leftLines,\n    replaceSelectedDiffRowRangeFromGridCells,\n    rightLines,\n    selectedDiffRowRange,\n    updateSelectedDiffRowRange,\n  })\n\n  const diffRowSelectedChecker = useMemo(() => {\n    if (!selectedDiffRowRange) return undefined\n    return DiffRowSelectedChecker({\n      selectedDiffRowRange,\n      leftLines,\n      rightLines,\n    })\n  }, [selectedDiffRowRange, leftLines, rightLines])\n\n  useEffect(() => {\n    updateDiffLines(fileAnchor, diffLines)\n  }, [diffLines, fileAnchor, updateDiffLines])\n\n  const hunksData = useMemo(() => getDiffHunksData(leftLines), [leftLines])\n\n  const leftLineWithSearchContentMap = new Map<number, DiffMatchContent[]>()\n  const rightLineWithSearchContentMap = new Map<number, DiffMatchContent[]>()\n  const hunkLinesWithSearchContentMap = new Map<number, DiffMatchContent[]>()\n  for (let j = 0; j < (searchResults?.length ?? 0); j++) {\n    const searchResult = searchResults?.[j]\n    if (!searchResult) continue\n\n    if (leftLineWithSearchContentMap.has(searchResult.leftLineNumber)) {\n      leftLineWithSearchContentMap.get(searchResult.leftLineNumber)?.push(searchResult)\n      //already had a match on this line, add to it\n    } else if (searchResult.leftLineNumber !== -1) {\n      leftLineWithSearchContentMap.set(searchResult.leftLineNumber, [searchResult])\n    }\n\n    if (hunkLinesWithSearchContentMap.has(searchResult.hunkLineNumber)) {\n      hunkLinesWithSearchContentMap.get(searchResult.hunkLineNumber)?.push(searchResult)\n    } else if (searchResult.isHunk) {\n      hunkLinesWithSearchContentMap.set(searchResult.hunkLineNumber, [searchResult])\n    }\n\n    if (rightLineWithSearchContentMap.has(searchResult.rightLineNumber)) {\n      rightLineWithSearchContentMap.get(searchResult.rightLineNumber)?.push(searchResult)\n      //already had a match on this line, add to it\n    } else if (searchResult.rightLineNumber !== -1) {\n      rightLineWithSearchContentMap.set(searchResult.rightLineNumber, [searchResult])\n    }\n  }\n  const lines: React.ReactNode[] = []\n  for (let i = 0; i < leftLines.length; i++) {\n    const leftLine = leftLines[i] as ClientDiffLine\n    const rightLine = rightLines[i] as ClientDiffLine\n    const prevLine = leftLines[i - 1]\n\n    // Only need to use next right line when next left line is empty\n    const nextLine = (isEmptyDiffLine(leftLines[i + 1]) ? rightLines[i + 1] : leftLines[i + 1]) as DiffLine | undefined\n    const isHunkRow = isDiffLine(leftLine) && leftLine.type === 'HUNK'\n    const rowId = rowIdFrom(fileAnchor, leftLine, rightLine)\n    const currentLine = !isEmptyDiffLine(leftLine) ? leftLine : !isEmptyDiffLine(rightLine) ? rightLine : undefined\n\n    if (!currentLine) continue\n\n    const originalLineThreads = !isEmptyDiffLine(leftLine) ? leftLine.threadsData : undefined\n    const modifiedLineThreads = !isEmptyDiffLine(rightLine) ? rightLine.threadsData : undefined\n\n    const {currentHunk, nextHunk, previousHunk} = getLineHunkData(currentLine, hunksData)\n    const leftResultsForLine = leftLineWithSearchContentMap.get(!isEmptyDiffLine(leftLine) ? leftLine.left ?? -2 : -2)\n    const rightResultsForLine = rightLineWithSearchContentMap.get(\n      !isEmptyDiffLine(rightLine) ? rightLine.right ?? -2 : -2,\n    )\n    const hunkResultsForLine = hunkLinesWithSearchContentMap.get(currentLine.blobLineNumber)\n    const hunkFocusedResult =\n      hunkResultsForLine?.[0]?.rightLineNumber === (rightLine as DiffLine)?.right ? focusedSearchResult : undefined\n    const leftFocusedResult =\n      leftResultsForLine?.[0]?.leftLineNumber === (leftLine as DiffLine)?.left ? focusedSearchResult : undefined\n    const rightFocusedResult =\n      rightResultsForLine?.[0]?.rightLineNumber === (rightLine as DiffLine)?.right ? focusedSearchResult : undefined\n    const summaryLeft = buildDiffLineScreenReaderSummary(leftLine as DiffLine, rightLine as DiffLine, 'LEFT')\n    const summaryRight = buildDiffLineScreenReaderSummary(leftLine as DiffLine, rightLine as DiffLine, 'RIGHT')\n\n    const updatedLineThreads = threadSummary(modifiedLineThreads, ghostUser)\n    const ogLineThreads = threadSummary(originalLineThreads, ghostUser)\n\n    const diffLineContextData = {\n      currentHunk,\n      diffEntryId,\n      fileAnchor,\n      fileLineCount,\n      filePath,\n      isRowSelected:\n        diffRowSelectedChecker?.isRowSelected(leftLine) || diffRowSelectedChecker?.isRowSelected(rightLine),\n      modifiedLineThreadsConnectionId: modifiedLineThreads?.__id,\n      nextHunk,\n      originalLineThreadsConnectionId: originalLineThreads?.__id,\n      previousHunk,\n      rowId,\n      isSplit: true,\n      diffContext,\n    }\n\n    lines.push(\n      <Fragment key={rowId}>\n        <tr className=\"diff-line-row\">\n          {isHunkRow ? (\n            <DiffLineContextProvider\n              {...{\n                ...diffLineContextData,\n                diffLine: currentLine,\n              }}\n              modifiedLineThreads={updatedLineThreads}\n              originalLineThreads={ogLineThreads}\n            >\n              <ExpandableHunkHeaderDiffLine\n                nextLine={nextLine}\n                prevLine={prevLine as DiffLine}\n                focusedSearchResult={hunkFocusedResult}\n                resultsForLine={hunkResultsForLine}\n              />\n            </DiffLineContextProvider>\n          ) : (\n            <>\n              <DiffLineContextProvider\n                {...{\n                  ...diffLineContextData,\n                  diffLine: leftLine,\n                  isLeftSide: true,\n                }}\n              >\n                <DiffLineSide\n                  summary={summaryLeft}\n                  copilotChatReferenceData={copilotChatReferenceData}\n                  fileAnchor={fileAnchor}\n                  filePath={filePath}\n                  handleDiffRowClick={handleDiffRowClick}\n                  handleDiffSideCellSelectionBlocking={handleDiffSideCellSelectionBlocking}\n                  resultsForLine={leftResultsForLine}\n                  focusedSearchResult={leftFocusedResult}\n                />\n              </DiffLineContextProvider>\n              <DiffLineContextProvider\n                {...{\n                  ...diffLineContextData,\n                  diffLine: rightLine,\n                }}\n              >\n                <DiffLineSide\n                  summary={summaryRight}\n                  copilotChatReferenceData={copilotChatReferenceData}\n                  fileAnchor={fileAnchor}\n                  filePath={filePath}\n                  handleDiffRowClick={handleDiffRowClick}\n                  handleDiffSideCellSelectionBlocking={handleDiffSideCellSelectionBlocking}\n                  resultsForLine={rightResultsForLine}\n                  focusedSearchResult={rightFocusedResult}\n                />\n              </DiffLineContextProvider>\n            </>\n          )}\n        </tr>\n      </Fragment>,\n    )\n  }\n\n  return <>{lines}</>\n})\n\nexport default SplitDiffLines\n\ntry{ SplitDiffLines.displayName ||= 'SplitDiffLines' } catch {}","import {PlusCircleIcon, PlusIcon} from '@primer/octicons-react'\nimport {ActionList} from '@primer/react'\nimport type React from 'react'\nimport {useCallback, useMemo} from 'react'\n\nimport {useDiffContext} from '../contexts/DiffContext'\nimport {useDiffLineContext} from '../contexts/DiffLineContext'\nimport {useSelectedDiffRowRangeContext} from '../contexts/SelectedDiffRowRangeContext'\nimport {isContextDiffLine, isEmptyDiffLine} from '../helpers/line-helpers'\nimport type {LineRange, DiffLine} from '../types'\nimport {KeyboardKey} from '@github-ui/keyboard-key'\nimport {CommandActionListItem} from '@github-ui/ui-commands'\n\nconst ORIENTATION_MAP = {\n  left: 'L',\n  right: 'R',\n}\n\nconst START_CONVERSATION = 'Start conversation'\nconst SUGGEST_CHANGE = 'Suggest change'\n\ntype ContextMenuActions = typeof START_CONVERSATION | typeof SUGGEST_CHANGE\n\nfunction generateSingleLineText(baseAction: ContextMenuActions, diffLine: DiffLine, isLeftSide?: boolean) {\n  const side = isLeftSide && !isContextDiffLine(diffLine) ? ORIENTATION_MAP.left : ORIENTATION_MAP.right\n  return `${baseAction} on line ${side}${diffLine.blobLineNumber}`\n}\n\nfunction generateModifiedRangeText(\n  firstLine: DiffLine,\n  lastLine: DiffLine,\n  originalLinesAreEmpty: boolean,\n  isSplit: boolean | undefined,\n  allLinesAreContextLines: boolean,\n) {\n  const hasOneLineOnModifiedSide = firstLine.right === lastLine.right\n  if (hasOneLineOnModifiedSide) {\n    return originalLinesAreEmpty || (isSplit && allLinesAreContextLines)\n      ? ` on line R${firstLine.right}`\n      : `, modified line R${lastLine.right}`\n  } else {\n    return originalLinesAreEmpty || (isSplit && allLinesAreContextLines)\n      ? ` on lines R${firstLine.right}-R${lastLine.right}`\n      : `, modified lines R${firstLine.right}-R${lastLine.right}`\n  }\n}\n\nfunction generateOriginalRangeText(firstLine: DiffLine, lastLine: DiffLine, modifiedLinesAreEmpty: boolean) {\n  const hasOneLineOnOriginalSide = firstLine.left === lastLine.left\n  if (hasOneLineOnOriginalSide) {\n    return modifiedLinesAreEmpty ? ` on line L${firstLine.left}` : `, original line L${firstLine.left}`\n  } else {\n    return modifiedLinesAreEmpty\n      ? ` on lines L${firstLine.left}-L${lastLine.right}`\n      : `, original lines L${firstLine.left}-L${lastLine.left}`\n  }\n}\n\n/**\n * Renders context-specific context menu conversation selection options for diffline cell(s) based on split and unified views, the number of lines selected and the orientation of those selected lines.\n *\n * @param handleStartConversationWithSuggestedChange a function invoked when starting a conversation with suggested change\n * @param handleStartConversation a function invoked when starting a conversation\n */\nexport function StartConversationContextMenuItems({\n  handleStartConversationWithSuggestedChange,\n  handleStartConversation,\n}: {\n  handleStartConversationWithSuggestedChange: () => void\n  handleStartConversation: () => void\n}) {\n  const {selectedDiffRowRange, selectedDiffLines, replaceSelectedDiffRowRange} = useSelectedDiffRowRangeContext()\n  const {commentingEnabled} = useDiffContext()\n  const {diffLine, isLeftSide, isSplit, diffContext} = useDiffLineContext()\n  const line = diffLine as DiffLine\n\n  // Get the relevant lines for the selected diff row range\n  const firstOriginalLine = useMemo(() => selectedDiffLines.leftLines[0], [selectedDiffLines.leftLines])\n  const lastOriginalLine = useMemo(\n    () => selectedDiffLines.leftLines[selectedDiffLines.leftLines.length - 1],\n    [selectedDiffLines.leftLines],\n  )\n  const allOriginalLinesNotDeletions = useMemo(\n    () => selectedDiffLines.leftLines.every(leftLine => !isEmptyDiffLine(leftLine) && leftLine.type !== 'DELETION'),\n    [selectedDiffLines.leftLines],\n  )\n  const firstModifiedLine = useMemo(() => selectedDiffLines.rightLines[0], [selectedDiffLines.rightLines])\n  const lastModifiedLine = useMemo(\n    () => selectedDiffLines.rightLines[selectedDiffLines.rightLines.length - 1],\n    [selectedDiffLines.rightLines],\n  )\n  const modifiedLinesAreEmpty = useMemo(() => selectedDiffLines.rightLines.length === 0, [selectedDiffLines.rightLines])\n  const originalLinesAreEmpty = useMemo(() => selectedDiffLines.leftLines.length === 0, [selectedDiffLines.leftLines])\n  const allLinesAreContextLines = useMemo(() => {\n    if (\n      selectedDiffLines.leftLines.find(\n        leftLine => !isEmptyDiffLine(leftLine) && !isContextDiffLine(leftLine) && leftLine.type !== 'INJECTED_CONTEXT',\n      )\n    )\n      return false\n    if (\n      selectedDiffLines.rightLines.find(\n        rightLine =>\n          !isEmptyDiffLine(rightLine) && !isContextDiffLine(rightLine) && rightLine.type !== 'INJECTED_CONTEXT',\n      )\n    )\n      return false\n\n    return true\n  }, [selectedDiffLines.leftLines, selectedDiffLines.rightLines])\n\n  // Handlers for starting conversations based on selected lines\n  const handleStartOriginalLinesConversationSelection = useCallback(\n    (e: React.KeyboardEvent | React.MouseEvent, opts?: {withSuggestedChange?: boolean}) => {\n      if (\n        !selectedDiffRowRange ||\n        !lastOriginalLine ||\n        !firstOriginalLine ||\n        isEmptyDiffLine(lastOriginalLine) ||\n        isEmptyDiffLine(firstOriginalLine) ||\n        !firstOriginalLine.left ||\n        !lastOriginalLine.left\n      ) {\n        return\n      }\n\n      const newSelectedLineRange = {\n        diffAnchor: selectedDiffRowRange.diffAnchor,\n        endLineNumber: lastOriginalLine.left,\n        endOrientation: 'left',\n        startLineNumber: firstOriginalLine.left,\n        startOrientation: 'left',\n        firstSelectedLineNumber: firstOriginalLine.left,\n        firstSelectedOrientation: 'left',\n      } as LineRange\n\n      replaceSelectedDiffRowRange(newSelectedLineRange)\n      if (opts?.withSuggestedChange) {\n        handleStartConversationWithSuggestedChange()\n      } else {\n        handleStartConversation()\n      }\n    },\n    [\n      selectedDiffRowRange,\n      lastOriginalLine,\n      firstOriginalLine,\n      replaceSelectedDiffRowRange,\n      handleStartConversationWithSuggestedChange,\n      handleStartConversation,\n    ],\n  )\n\n  const handleStartModifiedLinesConversationSelection = useCallback(\n    (e: React.KeyboardEvent | React.MouseEvent, opts?: {withSuggestedChange?: boolean}) => {\n      if (\n        !selectedDiffRowRange ||\n        !lastModifiedLine ||\n        !firstModifiedLine ||\n        isEmptyDiffLine(lastModifiedLine) ||\n        isEmptyDiffLine(firstModifiedLine) ||\n        !firstModifiedLine.right ||\n        !lastModifiedLine.right\n      ) {\n        return\n      }\n\n      const newSelectedLineRange = {\n        diffAnchor: selectedDiffRowRange.diffAnchor,\n        endLineNumber: lastModifiedLine.right,\n        endOrientation: 'right',\n        startLineNumber: firstModifiedLine.right,\n        startOrientation: 'right',\n        firstSelectedLineNumber: firstModifiedLine.right,\n        firstSelectedOrientation: 'right',\n      } as LineRange\n\n      replaceSelectedDiffRowRange(newSelectedLineRange)\n      if (opts?.withSuggestedChange) {\n        handleStartConversationWithSuggestedChange()\n      } else {\n        handleStartConversation()\n      }\n    },\n    [\n      selectedDiffRowRange,\n      lastModifiedLine,\n      firstModifiedLine,\n      replaceSelectedDiffRowRange,\n      handleStartConversationWithSuggestedChange,\n      handleStartConversation,\n    ],\n  )\n  const canSuggestChanges = line.type !== 'DELETION' && (diffContext === 'pr' || diffContext === undefined)\n  const hasMultipleLinesSelected: boolean = useMemo(() => {\n    if (!selectedDiffRowRange) return false\n    if (selectedDiffRowRange.startOrientation !== selectedDiffRowRange.endOrientation) return true\n    if (selectedDiffRowRange.startLineNumber !== selectedDiffRowRange.endLineNumber) return true\n    return false\n  }, [selectedDiffRowRange])\n\n  // Fail safe in case this is called without correctly setting showStartConversation in Context menu\n  if (!commentingEnabled) return null\n\n  let originalRangeText\n  let modifiedRangeText\n  let unifiedRangeText\n  let showOriginalLineOption: boolean = false\n  let showModifiedLineOption: boolean = false\n\n  // multi-line selection\n  if (selectedDiffRowRange && hasMultipleLinesSelected) {\n    const selectedDiffRowRangeStartOrientation = ORIENTATION_MAP[selectedDiffRowRange.startOrientation]\n    const selectedDiffRowRangeEndOrientation = ORIENTATION_MAP[selectedDiffRowRange.endOrientation]\n\n    unifiedRangeText = ` on lines ${selectedDiffRowRangeStartOrientation}${selectedDiffRowRange.startLineNumber}-${selectedDiffRowRangeEndOrientation}${selectedDiffRowRange.endLineNumber}`\n\n    if (\n      !isEmptyDiffLine(firstOriginalLine) &&\n      !isEmptyDiffLine(lastOriginalLine) &&\n      firstOriginalLine &&\n      lastOriginalLine\n    ) {\n      showOriginalLineOption = true\n      originalRangeText = generateOriginalRangeText(firstOriginalLine, lastOriginalLine, modifiedLinesAreEmpty)\n    }\n\n    if (\n      !isEmptyDiffLine(firstModifiedLine) &&\n      !isEmptyDiffLine(lastModifiedLine) &&\n      firstModifiedLine &&\n      lastModifiedLine\n    ) {\n      showModifiedLineOption = true\n      modifiedRangeText = generateModifiedRangeText(\n        firstModifiedLine,\n        lastModifiedLine,\n        originalLinesAreEmpty,\n        isSplit,\n        allLinesAreContextLines,\n      )\n    }\n\n    return (\n      <>\n        {isSplit ? (\n          <>\n            {allLinesAreContextLines ? (\n              <>\n                <ActionList.Item onSelect={handleStartModifiedLinesConversationSelection}>\n                  <ActionList.LeadingVisual>\n                    <PlusIcon />\n                  </ActionList.LeadingVisual>\n                  {START_CONVERSATION + modifiedRangeText}\n                  <ActionList.TrailingVisual>\n                    <KeyboardKey keys=\"Alt+n\" />\n                  </ActionList.TrailingVisual>\n                </ActionList.Item>\n                <ActionList.Item\n                  onSelect={e => handleStartModifiedLinesConversationSelection(e, {withSuggestedChange: true})}\n                >\n                  <ActionList.LeadingVisual>\n                    <PlusCircleIcon />\n                  </ActionList.LeadingVisual>\n                  {SUGGEST_CHANGE + modifiedRangeText}\n                </ActionList.Item>\n              </>\n            ) : (\n              <>\n                {showOriginalLineOption ? (\n                  <>\n                    <ActionList.Item onSelect={handleStartOriginalLinesConversationSelection}>\n                      <ActionList.LeadingVisual>\n                        <PlusIcon />\n                      </ActionList.LeadingVisual>\n                      {START_CONVERSATION + originalRangeText}\n                      <ActionList.TrailingVisual>\n                        <KeyboardKey keys={modifiedLinesAreEmpty ? 'Alt+n' : 'Alt+Shift+N'} />\n                      </ActionList.TrailingVisual>\n                    </ActionList.Item>\n                    {allOriginalLinesNotDeletions && (\n                      <ActionList.Item\n                        onSelect={e => handleStartOriginalLinesConversationSelection(e, {withSuggestedChange: true})}\n                      >\n                        <ActionList.LeadingVisual>\n                          <PlusCircleIcon />\n                        </ActionList.LeadingVisual>\n                        {SUGGEST_CHANGE + originalRangeText}\n                      </ActionList.Item>\n                    )}\n                  </>\n                ) : null}\n                {showModifiedLineOption ? (\n                  <>\n                    <ActionList.Item onSelect={handleStartModifiedLinesConversationSelection}>\n                      <ActionList.LeadingVisual>\n                        <PlusIcon />\n                      </ActionList.LeadingVisual>\n                      {START_CONVERSATION + modifiedRangeText}\n                      <ActionList.TrailingVisual>\n                        <KeyboardKey keys=\"Alt+n\" />\n                      </ActionList.TrailingVisual>\n                    </ActionList.Item>\n                    <ActionList.Item\n                      onSelect={e => handleStartModifiedLinesConversationSelection(e, {withSuggestedChange: true})}\n                    >\n                      <ActionList.LeadingVisual>\n                        <PlusCircleIcon />\n                      </ActionList.LeadingVisual>\n                      {SUGGEST_CHANGE + modifiedRangeText}\n                    </ActionList.Item>\n                  </>\n                ) : null}\n              </>\n            )}\n          </>\n        ) : (\n          <>\n            <CommandActionListItem\n              commandId=\"pull-requests-diff-view:start-conversation-current\"\n              leadingVisual={<PlusIcon />}\n            >\n              {START_CONVERSATION + unifiedRangeText}\n            </CommandActionListItem>\n            {canSuggestChanges && allOriginalLinesNotDeletions && (\n              <ActionList.Item onSelect={handleStartConversationWithSuggestedChange}>\n                <ActionList.LeadingVisual>\n                  <PlusCircleIcon />\n                </ActionList.LeadingVisual>\n                {SUGGEST_CHANGE + unifiedRangeText}\n              </ActionList.Item>\n            )}\n          </>\n        )}\n      </>\n    )\n  }\n\n  // Single Line selection\n  return (\n    <>\n      <CommandActionListItem\n        commandId=\"pull-requests-diff-view:start-conversation-current\"\n        leadingVisual={<PlusIcon />}\n      >\n        {generateSingleLineText(START_CONVERSATION, line, isLeftSide)}\n      </CommandActionListItem>\n      {canSuggestChanges && (\n        <ActionList.Item onSelect={handleStartConversationWithSuggestedChange}>\n          <ActionList.LeadingVisual>\n            <PlusCircleIcon />\n          </ActionList.LeadingVisual>\n          {generateSingleLineText(SUGGEST_CHANGE, line, isLeftSide)}\n        </ActionList.Item>\n      )}\n    </>\n  )\n}\n\ntry{ StartConversationContextMenuItems.displayName ||= 'StartConversationContextMenuItems' } catch {}","import {lineAnchorFrom, lineOrientationFrom} from '@github-ui/diffs/diff-line-helpers'\nimport type {DiffAnchor} from '@github-ui/diffs/types'\nimport {Fragment, memo, type MouseEvent, type RefObject, useEffect, useMemo} from 'react'\n\nimport {DiffLineContextProvider} from '../contexts/DiffLineContext'\nimport type {\n  UpdateSelectedDiffRowRangeFnArgs,\n  ReplaceSelectedDiffRowRangeFromGridCellsFnArgs,\n} from '../contexts/SelectedDiffRowRangeContext'\nimport DiffRowSelectedChecker from '../helpers/diff-row-selected-checker'\nimport {getDiffHunksData, getLineHunkData} from '../helpers/hunk-data-helpers'\nimport {rowIdFrom} from '../helpers/line-helpers'\nimport {useGridNavigation} from '../hooks/use-grid-navigation'\nimport type {DiffLine, LineRange, ClientDiffLine, CopilotChatFileDiffReferenceData, DiffContext} from '../types'\nimport {CodeDiffLine} from './DiffLineTableRow'\nimport ExpandableHunkHeaderDiffLine from './ExpandableHunkHeaderDiffLine'\nimport type {DiffMatchContent} from '../helpers/find-in-diff'\nimport {buildDiffLineScreenReaderSummary} from './DiffLineScreenReaderSummary'\n\nconst UnifiedDiffLines = memo(function UnifiedDiffLines({\n  searchResults,\n  diffContext = 'pr',\n  focusedSearchResult,\n  clearSelectedDiffRowRange,\n  diffEntryId,\n  diffLines,\n  fileLineCount,\n  fileAnchor,\n  filePath,\n  tableRef,\n  selectedDiffRowRange,\n  handleDiffRowClick,\n  updateDiffLines,\n  updateSelectedDiffRowRange,\n  replaceSelectedDiffRowRangeFromGridCells,\n  copilotChatReferenceData,\n}: {\n  searchResults?: DiffMatchContent[]\n  diffContext?: DiffContext\n  focusedSearchResult?: number\n  clearSelectedDiffRowRange: () => void\n  diffEntryId: string\n  diffLines: DiffLine[]\n  fileLineCount: number\n  fileAnchor: DiffAnchor\n  filePath: string\n  tableRef: RefObject<HTMLTableElement>\n  selectedDiffRowRange: LineRange | null\n  handleDiffRowClick: (\n    event: MouseEvent<HTMLTableCellElement>,\n    lineNumber: number,\n    orientation: 'left' | 'right' | undefined,\n    shiftKey: boolean,\n  ) => void\n  updateDiffLines: (diffAnchor: string, diffLines: DiffLine[]) => void\n  updateSelectedDiffRowRange: UpdateSelectedDiffRowRangeFnArgs\n  replaceSelectedDiffRowRangeFromGridCells: ReplaceSelectedDiffRowRangeFromGridCellsFnArgs\n  copilotChatReferenceData?: CopilotChatFileDiffReferenceData\n}) {\n  useGridNavigation({\n    clearSelectedDiffRowRange,\n    containerRef: tableRef,\n    fileAnchor,\n    isSplitDiff: false,\n    leftLines: diffLines as unknown as ClientDiffLine[],\n    replaceSelectedDiffRowRangeFromGridCells,\n    selectedDiffRowRange,\n    updateSelectedDiffRowRange,\n  })\n\n  const diffRowSelectedChecker = useMemo(() => {\n    if (!selectedDiffRowRange) return undefined\n    return DiffRowSelectedChecker({\n      selectedDiffRowRange,\n      leftLines: diffLines,\n    })\n  }, [selectedDiffRowRange, diffLines])\n\n  const hunksData = useMemo(() => getDiffHunksData(diffLines.map(diffLine => diffLine)), [diffLines])\n\n  useEffect(() => {\n    updateDiffLines(fileAnchor, diffLines)\n  }, [diffLines, fileAnchor, updateDiffLines])\n\n  const lineWithSearchContentMap = new Map<number, DiffMatchContent[]>()\n  for (let i = 0; i < (searchResults?.length ?? 0); i++) {\n    const searchResult = searchResults?.[i]\n\n    if (!searchResult) continue\n    if (searchResults && lineWithSearchContentMap.has(searchResult.diffLineNumIndex)) {\n      lineWithSearchContentMap.get(searchResult.diffLineNumIndex)?.push(searchResult)\n      //already had a match on this line, add to it\n    } else if (searchResults) {\n      lineWithSearchContentMap.set(searchResult.diffLineNumIndex, [searchResult])\n    }\n  }\n\n  const lines = diffLines.map((line, i) => {\n    const currentLine = line\n    const nextLine = diffLines[i + 1] as DiffLine | undefined\n    const prevLine = diffLines[i - 1] as DiffLine | undefined\n    const isHunkRow = line.type === 'HUNK'\n    const lineAnchor = lineAnchorFrom(fileAnchor, lineOrientationFrom(currentLine.type), currentLine.blobLineNumber)\n    const {currentHunk, nextHunk, previousHunk} = getLineHunkData(currentLine, hunksData)\n    const resultsForLine = lineWithSearchContentMap.get(i)\n    const focusedResult = i === resultsForLine?.[0]?.diffLineNumIndex ? focusedSearchResult : undefined\n    const summary = buildDiffLineScreenReaderSummary(line, line, 'RIGHT')\n\n    const isRowSelected = diffRowSelectedChecker?.isRowSelected(currentLine)\n    const rowId = rowIdFrom(fileAnchor, currentLine, currentLine)\n\n    const diffLineContextData = {\n      diffEntryId,\n      diffLine: currentLine,\n      currentHunk,\n      fileAnchor,\n      fileLineCount,\n      filePath,\n      isLeftSide: currentLine.type === 'DELETION',\n      isSplit: false,\n      nextHunk,\n      previousHunk,\n      diffContext,\n    }\n\n    return (\n      <Fragment key={i}>\n        <tr className=\"diff-line-row\">\n          <DiffLineContextProvider {...diffLineContextData} isRowSelected={isRowSelected} rowId={rowId}>\n            {isHunkRow ? (\n              <ExpandableHunkHeaderDiffLine\n                key={i}\n                nextLine={nextLine}\n                prevLine={prevLine}\n                focusedSearchResult={focusedResult}\n                resultsForLine={resultsForLine}\n              />\n            ) : (\n              <CodeDiffLine\n                key={i}\n                filePath={filePath}\n                copilotChatReferenceData={copilotChatReferenceData}\n                handleDiffRowClick={handleDiffRowClick}\n                lineAnchor={lineAnchor}\n                resultsForLine={resultsForLine}\n                focusedSearchResult={focusedResult}\n                summary={summary}\n              />\n            )}\n          </DiffLineContextProvider>\n        </tr>\n      </Fragment>\n    )\n  })\n\n  return <>{lines}</>\n})\n\nexport default UnifiedDiffLines\n\ntry{ UnifiedDiffLines.displayName ||= 'UnifiedDiffLines' } catch {}","import type {\n  CommentingImplementation,\n  Subject,\n  MarkerNavigationImplementation,\n  ViewerData,\n} from '@github-ui/conversations'\nimport {VALUES} from '../constants'\nimport type {PropsWithChildren} from 'react'\nimport {createContext, useContext, useMemo} from 'react'\nimport type {CommentAuthor} from '../types'\n\nexport type Range = {\n  start: number\n  end: number\n}\n\nexport type DiffContextData = {\n  /**\n   * Callback that should add the specified range of lines to the diff\n   */\n  addInjectedContextLines: (range: Range) => void\n  /**\n   * True if comment batching is enabled and a batch is currently active\n   */\n  commentBatchPending: boolean\n  /**\n   * True if commenting is enabled for the current diff; requires that a commenting implementation be passed as well.\n   */\n  commentingEnabled: boolean\n  /**\n   * Optional commenting backend implementation to use for the current diff.\n   */\n  commentingImplementation?: CommentingImplementation\n  /**\n   * Optional thread navigation (used for pull request typically)\n   */\n  markerNavigationImplementation?: MarkerNavigationImplementation\n  /**\n   * Id of the repository containing the diff\n   */\n  repositoryId: string\n  /**\n   * Id of the subject of the diff (e.g. a pull request id)\n   */\n  subjectId: string\n  /**\n   * Subject metadata (e.g. pull request data that @github-ui/conversations package, lower in hierarchy, requires)\n   */\n  subject: Subject\n  /**\n   * Old/start commit oid for the pull request comparison for the current diff\n   */\n  oldCommitOid?: string\n  /**\n   * New/end commit oid for the pull request comparison for the current diff\n   */\n  newCommitOid?: string\n  /**\n   * Information about the current user required for rendering diffs.\n   */\n  viewerData: ViewerData\n  /**\n   * Default Fallback User if GraphQL author is null or undefined.\n   * Optional because fallback relies on hardcoded constants\n   * Preferred for Apps to pass in value from App Payload\n   */\n  ghostUser?: CommentAuthor\n}\n\nconst DiffContext = createContext<DiffContextData | null>(null)\n\nexport function DiffContextProvider({children, ...props}: PropsWithChildren<DiffContextData>) {\n  const hasCommentingImplementation = !!props.commentingImplementation\n  const hasMarkerNavigationImplementation = !!props.markerNavigationImplementation\n  if (\n    props.commentingEnabled !== hasCommentingImplementation &&\n    props.commentingEnabled !== hasMarkerNavigationImplementation\n  ) {\n    throw new Error(\n      'commentingEnabled, commentingImplementation, and markerNavigationImplementation must be passed together',\n    )\n  }\n  const ghost = props?.ghostUser ?? VALUES.ghostUser\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const contextData = useMemo(() => ({ghostUser: ghost, ...props}), [...Object.values(props), ghost])\n\n  return <DiffContext.Provider value={contextData}>{children}</DiffContext.Provider>\n}\n\nexport function useDiffContext(): DiffContextData {\n  const contextData = useContext(DiffContext)\n  if (!contextData) {\n    throw new Error('useDiffContext must be used within a DiffContextProvider')\n  }\n\n  return contextData\n}\n\ntry{ DiffContext.displayName ||= 'DiffContext' } catch {}\ntry{ DiffContextProvider.displayName ||= 'DiffContextProvider' } catch {}","import type React from 'react'\nimport {createContext, useCallback, useContext, useMemo, useRef, useState} from 'react'\n\ntype DiffFindOpenContextType = {\n  diffFindOpen: boolean\n  setDiffFindOpen: (open: boolean) => void\n}\n\nconst DiffFindOpenContext = createContext<DiffFindOpenContextType>({\n  diffFindOpen: false,\n  setDiffFindOpen: () => undefined,\n})\n\n/**\n * This is equivalent to a simple setState, except we save the search state of the find in file panel when it's closed\n * so we can reopen with the last used value\n */\nexport function DiffFindOpenProvider({\n  children,\n  searchTerm,\n  setSearchTerm,\n}: {\n  children: React.ReactNode\n  searchTerm: string\n  setSearchTerm: (term: string) => void\n}) {\n  const lastSearchTerm = useRef<string>('')\n  const [diffFindOpen, setRawDiffFindOpen] = useState<boolean>(false)\n  const setDiffFindOpen = useCallback(\n    (open: boolean) => {\n      if (open && searchTerm === '' && lastSearchTerm.current !== '') {\n        setSearchTerm(lastSearchTerm.current)\n      } else if (!open && searchTerm !== '') {\n        lastSearchTerm.current = searchTerm\n        setSearchTerm('')\n      }\n\n      setRawDiffFindOpen(open)\n    },\n    [searchTerm, setSearchTerm],\n  )\n\n  const contextValue: DiffFindOpenContextType = useMemo(() => {\n    return {\n      diffFindOpen,\n      setDiffFindOpen,\n    }\n  }, [diffFindOpen, setDiffFindOpen])\n\n  return <DiffFindOpenContext.Provider value={contextValue}>{children}</DiffFindOpenContext.Provider>\n}\n\nexport function useDiffFindOpen() {\n  return useContext(DiffFindOpenContext)\n}\n\ntry{ DiffFindOpenContext.displayName ||= 'DiffFindOpenContext' } catch {}\ntry{ DiffFindOpenProvider.displayName ||= 'DiffFindOpenProvider' } catch {}","import type {DiffAnchor} from '@github-ui/diffs/types'\nimport type {PropsWithChildren} from 'react'\nimport {createContext, useContext, useMemo} from 'react'\n\nimport type {HunkData} from '../helpers/hunk-data-helpers'\nimport type {ClientDiffLine, DiffContext} from '../types'\nimport type {ThreadSummary} from '@github-ui/conversations'\n\nexport type DiffLineContextData = {\n  currentHunk?: HunkData\n  diffEntryId: string\n  diffLine: ClientDiffLine\n  fileAnchor: DiffAnchor\n  fileLineCount: number\n  filePath: string\n  isLeftSide?: boolean\n  isRowSelected?: boolean\n  isSplit: boolean\n  modifiedLineThreads?: ThreadSummary[]\n  modifiedLineHasThreads?: boolean\n  modifiedLineThreadsConnectionId?: string\n  nextHunk?: HunkData\n  originalLineThreads?: ThreadSummary[]\n  originalLineHasThreads?: boolean\n  originalLineThreadsConnectionId?: string\n  previousHunk?: HunkData\n  rowId: string\n  diffContext?: DiffContext\n}\n\nconst DiffLineContext = createContext<DiffLineContextData | null>(null)\n\nexport function DiffLineContextProvider({\n  children,\n  currentHunk,\n  diffEntryId,\n  diffLine,\n  fileAnchor,\n  fileLineCount,\n  filePath,\n  isLeftSide,\n  isRowSelected,\n  isSplit,\n  modifiedLineThreads,\n  modifiedLineThreadsConnectionId,\n  nextHunk,\n  originalLineThreads,\n  originalLineThreadsConnectionId,\n  previousHunk,\n  rowId,\n  diffContext,\n}: PropsWithChildren<DiffLineContextData>) {\n  const contextData = useMemo(\n    () => ({\n      currentHunk,\n      diffEntryId,\n      diffLine,\n      fileAnchor,\n      fileLineCount,\n      filePath,\n      isLeftSide,\n      isRowSelected,\n      isSplit,\n      modifiedLineThreads,\n      modifiedLineHasThreads: modifiedLineThreads && modifiedLineThreads.length > 0,\n      modifiedLineThreadsConnectionId,\n      nextHunk,\n      originalLineThreads,\n      originalLineHasThreads: originalLineThreads && originalLineThreads.length > 0,\n      originalLineThreadsConnectionId,\n      previousHunk,\n      rowId,\n      diffContext,\n    }),\n    [\n      currentHunk,\n      diffEntryId,\n      diffLine,\n      fileAnchor,\n      fileLineCount,\n      filePath,\n      isLeftSide,\n      isRowSelected,\n      isSplit,\n      modifiedLineThreads,\n      modifiedLineThreadsConnectionId,\n      nextHunk,\n      originalLineThreads,\n      originalLineThreadsConnectionId,\n      previousHunk,\n      rowId,\n      diffContext,\n    ],\n  )\n\n  return <DiffLineContext.Provider value={contextData}>{children}</DiffLineContext.Provider>\n}\n\nexport function useDiffLineContext(): DiffLineContextData {\n  const contextData = useContext(DiffLineContext)\n  if (!contextData) {\n    throw new Error('useDiffLineContext must be used within a DiffLineContextProvider')\n  }\n\n  return contextData\n}\n\ntry{ DiffLineContext.displayName ||= 'DiffLineContext' } catch {}\ntry{ DiffLineContextProvider.displayName ||= 'DiffLineContextProvider' } catch {}","import type {DiffAnnotation, ThreadSummary} from '@github-ui/conversations'\nimport type {PropsWithChildren} from 'react'\nimport {createContext, useCallback, useContext, useMemo, useState} from 'react'\nimport {ensurePreviousActiveDialogIsClosed} from '@github-ui/conversations/ensure-previous-active-dialog-is-closed'\n\nimport {threadSummary} from '../helpers/conversation-helpers'\nimport {useDiffLineContext} from './DiffLineContext'\nimport {useDiffContext} from './DiffContext'\nimport type {DiffSide, DiffLine, CommentAuthor} from '../types'\nimport {notEmpty} from '../helpers/not-empty'\n\ntype MarkersDialogContextData = {\n  annotations: DiffAnnotation[]\n  isActionBarVisible: boolean\n  showActionBar: () => void\n  hideActionBar: () => void\n  openDialog: (dialog: DialogType, cellId?: string | undefined, opts?: {withSuggestedChange?: boolean}) => void\n  closeDialog: (dialog: DialogType) => void\n  selectedThreadId?: string\n  selectThreadId: (threadId?: string) => void\n  selectedAnnotationId?: string\n  selectAnnotationId: (annotationId?: string) => void\n  threads: ThreadSummary[]\n  threadConnectionId?: string\n  updateVisibleThreads: (diffSide?: DiffSide) => ThreadSummary[] | undefined\n  anyMenuOpen: boolean\n  openContextMenuCell?: string\n  openMarkersListCell?: string\n  openMarkerDetailsCell?: string\n  openNewConversationCell?: {cellId: string | undefined; withSuggestedChange?: boolean}\n}\n\nconst THREAD = 'thread'\nconst ANNOTATION = 'annotation'\ntype SelectedMarker = {\n  id: string\n  kind: typeof THREAD | typeof ANNOTATION\n}\n\nconst MarkersDialogContext = createContext<MarkersDialogContextData | null>(null)\ntype DialogType = 'new-conversation' | 'marker-details' | 'marker-list' | 'context-menu'\ntype ThreadInfo = {\n  threads: ThreadSummary[]\n  threadConnectionId?: string\n}\n\n/**\n * Manages the state of thread, comment, and annotation dialogs for a line in a diff\n */\nexport function MarkersDialogContextProvider({children, line}: PropsWithChildren<{line: DiffLine}>) {\n  // Tracks the state of the action bar visibility for this row\n  const [isActionBarVisible, setIsActionBarVisible] = useState(false)\n  // Tracks which dialogs are open\n  const [openContextMenuCell, setOpenContextMenuCell] = useState<string | undefined>()\n  const [openMarkersListCell, setOpenMarkersListCell] = useState<string | undefined>()\n  const [openMarkerDetailsCell, seOpenMarkerDetailsCell] = useState<string | undefined>()\n  const [openNewConversationCell, setOpenNewConversationCell] = useState<\n    {cellId: string | undefined; withSuggestedChange?: boolean} | undefined\n  >()\n\n  // The selected \"marker\" that represents what entity is open in a dialog on a line\n  const [selectedMarker, setSelectedMarker] = useState<SelectedMarker>()\n\n  const {ghostUser} = useDiffContext()\n  // Information about what other threads exist on that line\n  const {originalLineThreads, modifiedLineThreads, originalLineThreadsConnectionId, modifiedLineThreadsConnectionId} =\n    useDiffLineContext()\n  const [sideWithOpenThreads, setSideWithOpenThreads] = useState<DiffSide>()\n  const {threads, threadConnectionId} = getThreadsForSide({\n    line,\n    side: sideWithOpenThreads,\n    originalLineThreads,\n    modifiedLineThreads,\n    originalLineThreadsConnectionId,\n    modifiedLineThreadsConnectionId,\n    ghostUser,\n  })\n\n  const anyMenuOpen = useMemo(\n    () => !!openContextMenuCell || !!openMarkersListCell || !!openMarkerDetailsCell || !!openNewConversationCell,\n    [openContextMenuCell, openMarkerDetailsCell, openMarkersListCell, openNewConversationCell],\n  )\n\n  const showActionBar = useCallback(() => {\n    setIsActionBarVisible(true)\n  }, [])\n\n  const hideActionBar = useCallback(() => {\n    setIsActionBarVisible(false)\n  }, [])\n\n  const selectThreadId = useCallback((threadId?: string) => {\n    if (threadId) {\n      setSelectedMarker({id: threadId, kind: THREAD})\n    } else {\n      setSelectedMarker(undefined)\n    }\n  }, [])\n\n  const selectedThreadId = selectedMarker?.kind === THREAD ? selectedMarker.id : undefined\n\n  const selectedAnnotationId = selectedMarker?.kind === ANNOTATION ? selectedMarker.id : undefined\n  const selectAnnotationId = useCallback((annotationId?: string) => {\n    if (annotationId) {\n      setSelectedMarker({id: annotationId, kind: ANNOTATION})\n    } else {\n      setSelectedMarker(undefined)\n    }\n  }, [])\n\n  const openDialog = useCallback((dialog: DialogType, cellId?: string, opts?: {withSuggestedChange?: boolean}) => {\n    // We currently allow for Dialogs to be open while a user moves and clicks around the diff now.\n    // This ensures we close active dialogs before opening up a new dialog\n    ensurePreviousActiveDialogIsClosed()\n    switch (dialog) {\n      case 'context-menu':\n        setOpenContextMenuCell(cellId)\n        setOpenNewConversationCell(undefined)\n        seOpenMarkerDetailsCell(undefined)\n        setOpenMarkersListCell(undefined)\n        break\n      case 'new-conversation':\n        setOpenNewConversationCell({cellId, withSuggestedChange: opts?.withSuggestedChange})\n        setOpenContextMenuCell(undefined)\n        seOpenMarkerDetailsCell(undefined)\n        setOpenMarkersListCell(undefined)\n        break\n      case 'marker-details':\n        seOpenMarkerDetailsCell(cellId)\n        setOpenContextMenuCell(undefined)\n        setOpenMarkersListCell(undefined)\n        setOpenNewConversationCell(undefined)\n        break\n      case 'marker-list':\n        setOpenMarkersListCell(cellId)\n        setOpenContextMenuCell(undefined)\n        setOpenNewConversationCell(undefined)\n        seOpenMarkerDetailsCell(undefined)\n        break\n      default:\n        break\n    }\n  }, [])\n\n  const closeDialog = useCallback((dialog: DialogType) => {\n    switch (dialog) {\n      case 'context-menu':\n        setOpenContextMenuCell(undefined)\n        break\n      case 'new-conversation':\n        setOpenNewConversationCell(undefined)\n        break\n      case 'marker-details':\n        seOpenMarkerDetailsCell(undefined)\n        break\n      case 'marker-list':\n        setOpenMarkersListCell(undefined)\n        break\n      default:\n        break\n    }\n  }, [])\n\n  const updateVisibleThreads = useCallback(\n    (diffSide?: DiffSide) => {\n      setSideWithOpenThreads(diffSide)\n      return getThreadsForSide({\n        line,\n        side: diffSide,\n        modifiedLineThreads,\n        modifiedLineThreadsConnectionId,\n        originalLineThreads,\n        originalLineThreadsConnectionId,\n        ghostUser,\n      }).threads\n    },\n    [\n      line,\n      modifiedLineThreads,\n      modifiedLineThreadsConnectionId,\n      originalLineThreads,\n      originalLineThreadsConnectionId,\n      ghostUser,\n    ],\n  )\n\n  const annotations = useMemo(\n    () => line.annotationsData?.annotations?.filter(notEmpty) ?? [],\n    [line.annotationsData?.annotations],\n  )\n\n  const contextData = useMemo(\n    () => ({\n      annotations,\n      isActionBarVisible,\n      showActionBar,\n      hideActionBar,\n      selectThreadId,\n      selectAnnotationId,\n      closeDialog,\n      openDialog,\n      anyMenuOpen,\n      selectedThreadId,\n      selectedAnnotationId,\n      openContextMenuCell,\n      openMarkersListCell,\n      openMarkerDetailsCell,\n      openNewConversationCell,\n      threads,\n      updateVisibleThreads,\n      threadConnectionId,\n    }),\n    [\n      annotations,\n      isActionBarVisible,\n      showActionBar,\n      hideActionBar,\n      selectThreadId,\n      selectAnnotationId,\n      closeDialog,\n      openDialog,\n      anyMenuOpen,\n      selectedThreadId,\n      selectedAnnotationId,\n      openContextMenuCell,\n      openMarkersListCell,\n      openMarkerDetailsCell,\n      openNewConversationCell,\n      threads,\n      threadConnectionId,\n      updateVisibleThreads,\n    ],\n  )\n\n  return <MarkersDialogContext.Provider value={contextData}>{children}</MarkersDialogContext.Provider>\n}\n\n/**\n * Get data related to managing the dialog states for a line in a diff\n */\nexport function useMarkersDialogContext(): MarkersDialogContextData {\n  const contextData = useContext(MarkersDialogContext)\n  if (!contextData) {\n    throw new Error('useMarkersDialogContext must be used within a MarkersDialogContextProvider')\n  }\n\n  return contextData\n}\n\nfunction getThreadsForSide({\n  line,\n  side,\n  originalLineThreads,\n  modifiedLineThreads,\n  originalLineThreadsConnectionId,\n  modifiedLineThreadsConnectionId,\n  ghostUser,\n}: {\n  line: DiffLine\n  side?: DiffSide\n  originalLineThreads?: ThreadSummary[]\n  modifiedLineThreads?: ThreadSummary[]\n  originalLineThreadsConnectionId?: string\n  modifiedLineThreadsConnectionId?: string\n  ghostUser?: CommentAuthor\n}): ThreadInfo {\n  switch (side) {\n    case 'LEFT': {\n      return {\n        threads: originalLineThreads || [],\n        threadConnectionId: originalLineThreadsConnectionId,\n      }\n    }\n    case 'RIGHT': {\n      return {\n        threads: modifiedLineThreads || [],\n        threadConnectionId: modifiedLineThreadsConnectionId,\n      }\n    }\n    case undefined: {\n      return {\n        threads: threadSummary(line.threadsData, ghostUser),\n        threadConnectionId: line.threadsData?.__id,\n      }\n    }\n    default: {\n      return {threads: [], threadConnectionId: undefined}\n    }\n  }\n}\n\ntry{ MarkersDialogContext.displayName ||= 'MarkersDialogContext' } catch {}\ntry{ MarkersDialogContextProvider.displayName ||= 'MarkersDialogContextProvider' } catch {}","import {announce} from '@github-ui/aria-live'\nimport type {DiffAnchor} from '@github-ui/diffs/types'\nimport {ssrSafeLocation} from '@github-ui/ssr-utils'\nimport type {PropsWithChildren} from 'react'\nimport {createContext, useContext, useMemo, useRef, useState} from 'react'\n\nimport DiffRowSelectedChecker from '../helpers/diff-row-selected-checker'\nimport type {GridCell} from '../helpers/grid-navigator'\nimport {parseLineRangeHash, updateURLHashFromLineRange} from '../helpers/document-hash-helpers'\nimport type {ClientDiffLine, LineRange, DiffLine} from '../types'\nimport {useStableCallback} from '../hooks/use-stable-callback'\nimport {groupDiffLines} from '../helpers/line-helpers'\n\nexport type UpdateSelectedDiffRowRangeFnArgs = (\n  diffAnchor: DiffAnchor,\n  lineNumber: number | null | undefined,\n  orientation: 'left' | 'right' | undefined,\n  shiftKey?: boolean | undefined,\n) => void\n\nexport type ReplaceSelectedDiffRowRangeFromGridCellsFnArgs = ({\n  diffAnchor,\n  startGridCell,\n  endGridCell,\n  focusedGridCell,\n}: {\n  diffAnchor: DiffAnchor\n  startGridCell: GridCell\n  endGridCell: GridCell\n  focusedGridCell: GridCell\n}) => void\n\nexport type SelectedDiffLines = {\n  leftLines: ClientDiffLine[]\n  rightLines: ClientDiffLine[]\n}\n\n/**\n * Context data for the SelectedDiffRowRangeContext\n *\n * When a user selects a range of lines in a diff, we store the selected range and associated diffLines in this context. Selected lines will be highlighted visually in the diff with a different background color.\n */\nexport interface SelectedDiffRowRangeContextData {\n  /**\n   *  The diffLines (grouped by left and right) that correspond to the selectedDiffRowRange\n   */\n  selectedDiffLines: SelectedDiffLines\n  /**\n   * The selected diff row range\n   */\n  selectedDiffRowRange: LineRange | undefined\n  /**\n   * A function to update the selectedDiffRowRange\n   */\n  updateSelectedDiffRowRange: UpdateSelectedDiffRowRangeFnArgs\n  /**\n   * A function to clear the selectedDiffRowRange\n   */\n  clearSelectedDiffRowRange: () => void\n  /**\n   * A function to replace the selectedDiffRowRange from a LineRange\n   */\n  replaceSelectedDiffRowRange: (newLineRange: LineRange) => void\n  /**\n   * A function to replace the selectedDiffRowRange by selecting grid cells\n   */\n  replaceSelectedDiffRowRangeFromGridCells: ReplaceSelectedDiffRowRangeFromGridCellsFnArgs\n  /**\n   * A function to update the map of diffLines we store for navigation and potentially update the selected diffLines\n   */\n  updateDiffLines: (diffAnchor: string, diffLines: DiffLine[]) => void\n  /**\n   * Get the diff lines from the line range\n   */\n  getDiffLinesFromLineRange: (lineRange?: LineRange) =>\n    | {\n        selectedLeftLines: ClientDiffLine[]\n        selectedRightLines?: ClientDiffLine[]\n      }\n    | undefined\n  /**\n   * Get the diff lines for a diff using the diff's diff anchor\n   */\n  getDiffLinesByDiffAnchor: (diffAnchor: string) => DiffLine[] | undefined\n}\n\nconst SelectedDiffRowRange = createContext<SelectedDiffRowRangeContextData | null>(null)\n\nexport function useSelectedDiffRowRangeContext(): SelectedDiffRowRangeContextData {\n  const contextData = useContext(SelectedDiffRowRange)\n  if (!contextData) {\n    throw new Error('useSelectedDiffRowRange must be used within a SelectedDiffRowRangeContext')\n  }\n\n  return contextData\n}\n\n/**\n * Announce the selected line range to screen readers\n */\nfunction ariaAnnounceForLineRange(lineRange: LineRange) {\n  const oneRowSelected =\n    lineRange.startLineNumber === lineRange.endLineNumber && lineRange.startOrientation === lineRange.endOrientation\n      ? true\n      : false\n\n  if (oneRowSelected) {\n    announce(`${lineRange.startOrientation === 'left' ? 'L' : 'R'}${lineRange.startLineNumber} selected.`)\n  } else {\n    announce(\n      `${lineRange.startOrientation === 'left' ? 'L' : 'R'}${lineRange.startLineNumber} to ${\n        lineRange.endOrientation === 'left' ? 'L' : 'R'\n      }${lineRange.endLineNumber} selected.`,\n    )\n  }\n}\n\n/**\n * Announce the selected range has been cleared\n */\nfunction ariaAnnounceClearedSelection() {\n  announce('Selection Cleared')\n}\n\n/**\n * Merge the line range with a new line.\n */\nfunction getUpdatedLineRange(\n  currentRange: LineRange | undefined,\n  diffAnchor: DiffAnchor,\n  lineNumber: number,\n  orientation: 'left' | 'right',\n  shiftKey?: boolean,\n): LineRange {\n  if (!shiftKey || !currentRange || currentRange.diffAnchor !== diffAnchor) {\n    return {\n      diffAnchor,\n      endLineNumber: lineNumber,\n      endOrientation: orientation,\n      startLineNumber: lineNumber,\n      startOrientation: orientation,\n      firstSelectedLineNumber: lineNumber,\n      firstSelectedOrientation: orientation,\n    }\n  }\n\n  // new line in range is before first selected diff line in range\n  if (lineNumber <= currentRange.firstSelectedLineNumber) {\n    return {\n      ...currentRange,\n      startLineNumber: lineNumber,\n      startOrientation: orientation,\n      endLineNumber: currentRange.firstSelectedLineNumber,\n      endOrientation: currentRange.firstSelectedOrientation,\n    }\n  }\n\n  // new line in range is after first selected diff line in range\n  return {\n    ...currentRange,\n    startLineNumber: currentRange.firstSelectedLineNumber,\n    startOrientation: currentRange.firstSelectedOrientation,\n    endLineNumber: lineNumber,\n    endOrientation: orientation,\n  }\n}\n\nexport function SelectedDiffRowRangeContextProvider({children}: PropsWithChildren) {\n  /**\n   * Keep a map of diffAnchor => diffLines\n   * Contains all of the diffs that include diffLines, updated when the diffLines are rendered\n   */\n  const diffLinesMap = useRef(new Map<string, DiffLine[]>())\n\n  const getDiffLinesFromLineRange = useStableCallback(\n    (\n      diffRowRange?: LineRange,\n    ): {selectedLeftLines: ClientDiffLine[]; selectedRightLines?: ClientDiffLine[]} | undefined => {\n      if (!diffRowRange) return\n      const selectedAnchor = diffRowRange.diffAnchor\n      const linesToCheck = diffLinesMap.current.get(selectedAnchor)\n      if (!linesToCheck) return\n\n      const {leftLines, rightLines} = groupDiffLines(linesToCheck)\n\n      return DiffRowSelectedChecker({selectedDiffRowRange: diffRowRange, leftLines, rightLines})\n    },\n  )\n\n  const [selectedDiffRowRange, setSelectedDiffRowRange] = useState<LineRange | undefined>(() => {\n    return parseLineRangeHash(ssrSafeLocation.hash)\n  })\n\n  const [selectedDiffLines, setSelectedDiffLines] = useState<{\n    leftLines: ClientDiffLine[]\n    rightLines: ClientDiffLine[]\n  }>(() => {\n    if (selectedDiffRowRange) {\n      const diffLines = getDiffLinesFromLineRange(selectedDiffRowRange)\n      if (diffLines) {\n        return {leftLines: diffLines.selectedLeftLines, rightLines: diffLines.selectedRightLines || []}\n      }\n    }\n    return {leftLines: [], rightLines: []}\n  })\n\n  const updateSelectedContextLines = useStableCallback((newLineRange?: LineRange) => {\n    const newSelection = getDiffLinesFromLineRange(newLineRange)\n    const newDiffLines = newSelection\n      ? {leftLines: newSelection.selectedLeftLines, rightLines: newSelection.selectedRightLines || []}\n      : {leftLines: [], rightLines: []}\n    setSelectedDiffLines(newDiffLines)\n  })\n\n  const updateSelectedDiffRowRange = useStableCallback(\n    (\n      diffAnchor: DiffAnchor,\n      lineNumber: number | null | undefined,\n      orientation: 'left' | 'right' | undefined,\n      shiftKey?: boolean,\n    ) => {\n      if (!lineNumber) return\n      if (!orientation) return\n      const newLineRange = getUpdatedLineRange(selectedDiffRowRange, diffAnchor, lineNumber, orientation, shiftKey)\n\n      ariaAnnounceForLineRange(newLineRange)\n      setSelectedDiffRowRange(newLineRange)\n      updateSelectedContextLines(newLineRange)\n      updateURLHashFromLineRange(newLineRange)\n    },\n  )\n\n  const replaceSelectedDiffRowRange = useStableCallback((newLineRange: LineRange) => {\n    ariaAnnounceForLineRange(newLineRange)\n    setSelectedDiffRowRange(newLineRange)\n    updateSelectedContextLines(newLineRange)\n    updateURLHashFromLineRange(newLineRange)\n  })\n\n  const replaceSelectedDiffRowRangeFromGridCells = useStableCallback(\n    ({\n      diffAnchor,\n      startGridCell,\n      endGridCell,\n      focusedGridCell,\n    }: {\n      diffAnchor: DiffAnchor\n      startGridCell: GridCell\n      endGridCell: GridCell\n      focusedGridCell: GridCell\n    }) => {\n      replaceSelectedDiffRowRange({\n        diffAnchor,\n        endLineNumber: endGridCell.lineNumber as number,\n        endOrientation: endGridCell.orientation as 'left' | 'right',\n        firstSelectedLineNumber: focusedGridCell.lineNumber as number,\n        firstSelectedOrientation: focusedGridCell.orientation as 'left' | 'right',\n        startLineNumber: startGridCell.lineNumber as number,\n        startOrientation: startGridCell.orientation as 'left' | 'right',\n      })\n    },\n  )\n\n  const clearSelectedDiffRowRange = useStableCallback(() => {\n    if (!selectedDiffRowRange) return\n    setSelectedDiffRowRange(undefined)\n    updateSelectedContextLines(undefined)\n    ariaAnnounceClearedSelection()\n\n    // clear hash without causing scroll to jump to the top of the page\n    history.replaceState({}, '', window.location.pathname + window.location.search)\n  })\n\n  const updateDiffLines = useStableCallback((diffAnchor: string, diffLines: DiffLine[]) => {\n    diffLinesMap.current.set(diffAnchor, diffLines)\n    if (selectedDiffRowRange?.diffAnchor === diffAnchor) {\n      updateSelectedContextLines(selectedDiffRowRange)\n    }\n  })\n\n  const getDiffLinesByDiffAnchor = useStableCallback((diffAnchor: string) => diffLinesMap.current.get(diffAnchor))\n\n  const value = useMemo(\n    () => ({\n      selectedDiffRowRange,\n      updateSelectedDiffRowRange,\n      clearSelectedDiffRowRange,\n      replaceSelectedDiffRowRange,\n      replaceSelectedDiffRowRangeFromGridCells,\n      updateDiffLines,\n      selectedDiffLines,\n      getDiffLinesFromLineRange,\n      getDiffLinesByDiffAnchor,\n    }),\n    [\n      selectedDiffRowRange,\n      updateSelectedDiffRowRange,\n      clearSelectedDiffRowRange,\n      replaceSelectedDiffRowRange,\n      replaceSelectedDiffRowRangeFromGridCells,\n      selectedDiffLines,\n      updateDiffLines,\n      getDiffLinesFromLineRange,\n      getDiffLinesByDiffAnchor,\n    ],\n  )\n\n  return <SelectedDiffRowRange.Provider value={value}>{children}</SelectedDiffRowRange.Provider>\n}\n\ntry{ SelectedDiffRowRange.displayName ||= 'SelectedDiffRowRange' } catch {}\ntry{ SelectedDiffRowRangeContextProvider.displayName ||= 'SelectedDiffRowRangeContextProvider' } catch {}","import {useClientValue} from '@github-ui/use-client-value'\nimport {Box, Flash, Spinner, Text} from '@primer/react'\nimport type {BetterSystemStyleObject} from '@primer/react/lib-esm/sx'\nimport React from 'react'\n\nimport {DEFAULT_RENDERER_HEIGHT, RenderState, useFileRenderer} from './use-file-renderer'\n\nconst MAX_BLOB_SIZE = 200_000_000 // 200MB\nconst MAX_NOTEBOOK_SIZE = 30_000_000 // 30MB\n\nexport interface FileRendererBlobData {\n  identityUuid: string\n  size: number\n  type: string\n  url: string\n}\n\nexport default function FileRendererBlob({identityUuid, size, type, url}: FileRendererBlobData) {\n  const [tempOrigin] = useClientValue(() => window.location.origin, 'https://www.github.com', [])\n  const origin = new URL(url, tempOrigin).origin\n  const {renderState, errorMsg, iFrameRef, containerRef} = useFileRenderer(origin)\n\n  const isNotebook = type === 'ipynb'\n  if ((isNotebook && size > MAX_NOTEBOOK_SIZE) || size > MAX_BLOB_SIZE) {\n    return <Flash variant=\"danger\">Sorry, this is too big to display.</Flash>\n  }\n\n  // Setting display: none or visibility: hidden on the iframe prevents it from loading.\n  // Instead, while the content is not ready, make it tiny and hide it in the lower right corner.\n  const iframeStateSX: BetterSystemStyleObject =\n    renderState !== RenderState.READY\n      ? {height: '1px', width: '1px', position: 'fixed', bottom: 0, right: 0}\n      : {height: '100%', width: '100%'}\n\n  const rendererReadySx = {height: DEFAULT_RENDERER_HEIGHT, padding: 0, background: 'none'} as const\n  const nonErrorSx = {\n    borderBottomLeftRadius: '6px',\n    borderBottomRightRadius: '6px',\n    lineHeight: '0',\n    padding: 5,\n    textAlign: 'center',\n  } as const\n\n  return (\n    <Box sx={{width: '100%', display: 'flex', justifyContent: 'center'}}>\n      <Box\n        data-hpc\n        data-host={origin}\n        data-type={type}\n        ref={containerRef}\n        sx={{\n          width: 1024,\n          ...(renderState !== RenderState.ERROR ? nonErrorSx : {}),\n          ...(renderState === RenderState.READY ? rendererReadySx : {}),\n        }}\n      >\n        {renderState === RenderState.ERROR ? (\n          <FileRendererErrorMessage error={errorMsg} />\n        ) : renderState !== RenderState.READY ? (\n          <Spinner size=\"large\" sx={{mx: 'auto'}} />\n        ) : null}\n\n        {renderState !== RenderState.ERROR && (\n          <Box\n            as=\"iframe\"\n            ref={iFrameRef}\n            src={`${url}#${identityUuid}`}\n            sandbox=\"allow-scripts allow-same-origin allow-top-navigation\"\n            sx={{\n              border: 0,\n              display: 'block',\n              ...iframeStateSX,\n            }}\n            name={identityUuid}\n            title=\"File display\"\n          >\n            Viewer requires iframe.\n          </Box>\n        )}\n      </Box>\n    </Box>\n  )\n}\n\nfunction FileRendererErrorMessage({error}: {error: string | null}) {\n  if (!error) {\n    return <Flash variant=\"danger\">Unable to render code block</Flash>\n  }\n\n  const msgLines = error.split('\\n')\n  return (\n    <Flash variant=\"danger\">\n      <Text as=\"p\" sx={{fontWeight: 'bold'}}>\n        Error rendering embedded code\n      </Text>\n      <p>\n        {msgLines.map((line, index) => (\n          <React.Fragment key={`error-line-${index}`}>\n            {line}\n            <br />\n          </React.Fragment>\n        ))}\n      </p>\n    </Flash>\n  )\n}\n\ntry{ FileRendererBlob.displayName ||= 'FileRendererBlob' } catch {}\ntry{ FileRendererErrorMessage.displayName ||= 'FileRendererErrorMessage' } catch {}","import type {ChildRoute, LoaderResult, RouteRegistration, TransitionType} from './app-routing-types'\nimport type React from 'react'\nimport type {Location} from '@remix-run/router'\n\nexport interface JsonRouteProps {\n  path: string\n  Component: React.ComponentType\n  transitionType?: TransitionType\n  shouldNavigateOnError?: boolean\n  children?: ChildRoute[]\n}\n/**\n * A utility for building a route registration for a route that consumes a JSON object (either via embedding in a\n * script tag or via a JSON fetch on React soft navigations).\n */\nexport function jsonRoute<TRouteData, TEmbeddedData>({\n  path,\n  Component,\n  /**\n   * Some routes want to handle their own errors and not just show a generic error page. In this case,\n   * the error is just handled like any other payload for the route.\n   * NOTE: We might consider replacing the shouldNavigateOnError flag with a parallel implementation to jsonRoute.\n   */\n  shouldNavigateOnError,\n  transitionType,\n  children,\n}: JsonRouteProps): RouteRegistration<TRouteData, TEmbeddedData> {\n  async function coreLoader({location}: {location: Location}): Promise<LoaderResult<TRouteData>> {\n    let response: Response\n    try {\n      const fetchPath = `${location.pathname}${location.search}`\n      response = await window.fetch(fetchPath, {\n        headers: {\n          Accept: 'application/json',\n          'X-Requested-With': 'XMLHttpRequest',\n          'X-GitHub-Target': 'dotcom',\n          'X-React-Router': 'json',\n        },\n      })\n    } catch (error) {\n      return {\n        type: shouldNavigateOnError ? 'route-handled-error' : 'error',\n        error: {type: 'fetchError'},\n      }\n    }\n    if (response.redirected) {\n      return {\n        type: 'redirect',\n        url: response.url,\n      }\n    } else if (!response.ok) {\n      return {\n        type: shouldNavigateOnError ? 'route-handled-error' : 'error',\n        error: {type: 'httpError', httpStatus: response.status},\n      }\n    } else {\n      try {\n        const responseJson = await response.json()\n        return {\n          type: 'loaded',\n          data: responseJson,\n          title: responseJson.title,\n        }\n      } catch (error) {\n        return {\n          type: shouldNavigateOnError ? 'route-handled-error' : 'error',\n          error: {type: 'badResponseError'},\n        }\n      }\n    }\n  }\n\n  function loadFromEmbeddedData({embeddedData}: {embeddedData: TEmbeddedData}): {data: TRouteData; title: string} {\n    const data = embeddedData as unknown as TRouteData & {title: string}\n    return {data, title: data.title}\n  }\n\n  return {\n    path,\n    // TODO: consider wrapping Component with a component that passes payload as a prop  ideally as part of migrating\n    // away from useRoutePayload.\n    Component,\n    coreLoader,\n    loadFromEmbeddedData,\n    transitionType,\n    children,\n  }\n}\n","import {debounce} from '@github/mini-throttle'\nimport React, {useCallback, useEffect, useMemo, useRef, useState, useSyncExternalStore} from 'react'\n\nexport const enum ScreenSize {\n  small = 1,\n  medium = 544,\n  large = 768,\n  xlarge = 1012,\n  xxlarge = 1280,\n  xxxlarge = 1350,\n  xxxxlarge = 1440,\n}\n\nconst screenBreakpoints = [\n  ScreenSize.xxxxlarge,\n  ScreenSize.xxxlarge,\n  ScreenSize.xxlarge,\n  ScreenSize.xlarge,\n  ScreenSize.large,\n  ScreenSize.medium,\n  ScreenSize.small,\n]\n\ninterface ScreenContextData {\n  /**\n   * Specifies the size of the current window\n   */\n  screenSize: ScreenSize\n}\n\nconst ScreenContext = React.createContext<ScreenContextData>({screenSize: ScreenSize.small})\n\nexport function useScreenSize() {\n  return React.useContext(ScreenContext)\n}\n\ninterface Props {\n  /**\n   * @property {ScreenSize} [initialValue=ScreenSize.small] Initial value is useful to test react components that rely on ScreenContext.\n   */\n  initialValue?: ScreenSize\n}\n\nexport function ScreenSizeProvider({children, initialValue}: React.PropsWithChildren<Props>) {\n  const initial = useSyncExternalStore(\n    () => () => {},\n    () => initialValue ?? getCurrentSize(window.innerWidth),\n    () => initialValue ?? ScreenSize.small,\n  )\n  const currentSizeRef = useRef(initial)\n  const [screenSize, setScreenSize] = useState(initial)\n\n  const onResize = useCallback(() => {\n    const updatedSize = getCurrentSize(window.innerWidth)\n    if (currentSizeRef.current !== updatedSize) {\n      currentSizeRef.current = updatedSize\n      setScreenSize(updatedSize)\n    }\n  }, [])\n\n  useEffect(() => {\n    const resizeObserver = new ResizeObserver(debounce(onResize))\n    resizeObserver.observe(document.documentElement)\n\n    return () => resizeObserver.disconnect()\n  }, [onResize])\n\n  const contextValue = useMemo(() => {\n    return {screenSize}\n  }, [screenSize])\n\n  return <ScreenContext.Provider value={contextValue}>{children}</ScreenContext.Provider>\n}\n\nexport function getCurrentSize(elementWidth: number) {\n  for (const breakpoint of screenBreakpoints) {\n    if (elementWidth >= breakpoint) {\n      return breakpoint\n    }\n  }\n  return ScreenSize.small\n}\n\ntry{ ScreenContext.displayName ||= 'ScreenContext' } catch {}\ntry{ ScreenSizeProvider.displayName ||= 'ScreenSizeProvider' } catch {}","import {GitHubAvatar} from '@github-ui/github-avatar'\nimport type {SxProp} from '@primer/react'\nimport {Box} from '@primer/react'\nimport {StatusIcon} from './StatusIcon'\n\nexport type StatusAvatarProps = {\n  zIndex?: {zIndex?: number}\n  altText: string\n  hovercardUrl?: string\n  src: string\n  square: boolean\n  icon: React.ElementType\n  iconColor: string\n  backgroundColor?: string\n  backgroundSx?: SxProp['sx']\n  size?: 20 | 24\n}\n/**\n * This component renders an avatar (either square or round) with a related status emoji in the bottom right corner\n */\nexport function StatusAvatar({\n  zIndex,\n  altText,\n  hovercardUrl,\n  src,\n  square,\n  icon,\n  iconColor,\n  backgroundColor,\n  backgroundSx,\n  sx,\n  size = 20,\n}: StatusAvatarProps & SxProp) {\n  return (\n    <Box\n      sx={{\n        position: 'relative',\n        display: 'flex',\n        gap: 2,\n        alignItems: 'center',\n        ...zIndex,\n        ...sx,\n      }}\n    >\n      <GitHubAvatar alt={altText} data-hovercard-url={hovercardUrl} size={size} square={square} src={src} />\n      <StatusIcon\n        icon={icon}\n        iconColor={iconColor}\n        size={12}\n        backgroundColor={backgroundColor}\n        backgroundSx={backgroundSx}\n      />\n    </Box>\n  )\n}\n\ntry{ StatusAvatar.displayName ||= 'StatusAvatar' } catch {}","import {Box, Octicon} from '@primer/react'\nimport type {SxProp} from '@primer/react'\n\nexport type StatusIconProps = {\n  iconColor: string\n  backgroundColor?: string\n  icon: React.ElementType\n  size: 12 | 20 | 24\n  backgroundSx?: SxProp['sx']\n  absolute?: boolean\n}\n\nexport function StatusIcon({\n  iconColor,\n  icon,\n  size = 12,\n  backgroundColor = 'fg.onEmphasis',\n  absolute = true,\n  backgroundSx,\n}: StatusIconProps) {\n  let innerSize\n  let margin\n  if (size === 12) {\n    innerSize = '10px'\n    margin = '1px'\n  } else if (size === 20) {\n    innerSize = '16px'\n    margin = '2px'\n  } else {\n    innerSize = '16px'\n    margin = '4px'\n  }\n\n  return (\n    <Box\n      sx={{\n        display: 'flex',\n        borderRadius: '100px',\n        ...(absolute\n          ? {\n              position: 'absolute',\n              bottom: -1,\n              right: -1,\n              boxShadow: '0 0 0 2px var(--bgColor-default, var(--color-canvas-default))',\n              backgroundColor: 'var(--bgColor-default, var(--color-canvas-default))',\n            }\n          : {position: 'relative'}),\n        ...backgroundSx,\n      }}\n    >\n      <Box\n        sx={{\n          display: 'flex',\n          position: 'absolute',\n          borderRadius: '100px',\n          width: innerSize,\n          height: innerSize,\n          left: margin,\n          top: margin,\n          backgroundColor,\n        }}\n      />\n      <Octicon\n        icon={icon}\n        size={size}\n        sx={{\n          color: iconColor,\n          position: 'relative',\n        }}\n      />\n    </Box>\n  )\n}\n\ntry{ StatusIcon.displayName ||= 'StatusIcon' } catch {}"],"names":["assertDataPresent","data","macShortcuts","cursorNavigationHopWordLeft","hotkey","useWhileBlobFocused","noModifierHotkey","modifierRequired","cursorNavigationHopWordRight","cursorNavigationTopOfPage","cursorNavigationBottomOfPage","cursorNavigationEnd","cursorNavigationHome","cursorNavigationPageUp","cursorNavigationPageDown","cursorNavigationArrowDown","cursorNavigationArrowUp","cursorNavigationArrowLeft","cursorNavigationArrowRight","cursorNavigationShiftHopWordLeft","cursorNavigationShiftHopWordRight","cursorNavigationShiftTopOfPage","cursorNavigationShiftBottomOfPage","cursorNavigationShiftEnd","cursorNavigationShiftHome","cursorNavigationShiftPageUp","cursorNavigationShiftPageDown","cursorNavigationShiftArrowDown","cursorNavigationShiftArrowUp","cursorNavigationShiftArrowLeft","cursorNavigationShiftArrowRight","cursorNavigationHighlightLine","text","cursorNavigationGoLineUp","cursorNavigationOpenHelpDialog","cursorNavigationGoLineDown","cursorNavigationEnter","cursorNavigationSpace","cursorNavigationShiftSpace","expandAndFocusLineContextMenu","copyFilePathShortcut","copyPermalinkShortcut","copyRawContentShortcut","downloadRawContentShortcut","editFileShortcut","goToLineShortcut","ariaKeyShortcuts","alternativeGoToLineShortcut","findInFileShortcut","findFilesShortcut","findSelectionShortcut","findNextShortcut","findPrevShortcut","openWithGitHubDevShortcut","openWithGitHubDevInNewWindowShortcut","permalinkShortcut","searchShortcut","selectAllShortcut","selectEditTabShortcut","submitCommitDialogShortcut","refSelectorShortcut","escapeRightClickMenu","toggleFocusedPaneShortcut","toggleSymbolsShortcut","toggleTreeShortcut","viewBlameShortcut","viewCodeShortcut","viewPreviewShortcut","viewRawContentShortcut","findSymbolShortcut","shortcutMemo","Map","useShortcut","isMac","useIsPlatform","isSSR","useClientValue","key","has","shortcuts","Object","keys","reduce","acc","shortcut","replace","undefined","set","get","useBlobFocusedModifierShortcuts","alphaNumericHotkey","includes","push","useBlobFocusedShortcuts","WebWorker","onmessage","listener","worker","postMessage","request","terminate","constructor","path","job","Worker","e","console","warn","MainThreadWorker","terminated","response","DebouncedWorkerManager","post","debounceOverrideCondition","delayId","clearTimeout","postNow","idle","setTimeout","delayMs","nextRequest","currentRequest","onResponse","DiffsHeader","App","props","payload","useRoutePayload","repo","useState","user","currentUser","CurrentUserProvider","CurrentRepositoryProvider","repository","children","displayName","CommitBranchInfo","useCurrentRepository","loading","branches","length","div","className","Octicon","icon","GitBranchIcon","LoadingSkeleton","width","variant","height","map","branch","branchIndex","BranchFragment","span","BranchName","href","branchPath","owner","ownerLogin","name","prs","pr","index","React","PullRequestLink","pullRequest","number","showPrefix","prefix","Link","pullRequestPath","data-hovercard-url","issueLinkedPullRequestHovercardPath","pullRequestNumber","CommitTagInfo","tags","renderTagsInLine","renderTagsInDialog","TagIcon","tagPath","tag","ExpandedTags","CommitTagsDialog","tagsExpanded","setTagsExpanded","firstExpandedTagRef","useRef","onExpand","useCallback","requestAnimationFrame","current","focus","slice","ref","IconButton","aria-label","unsafeDisableTooltip","KebabHorizontalIcon","size","onClick","dialogOpen","setDialogOpen","returnFocusRef","Dialog","title","onClose","renderBody","ActionList","data-testid","LinkItem","SpoofedCommitWarningBanner","Flash","AlertIcon","WeirichCommitBanner","oid","isWeirichCommit","id","Box","as","src","alt","sx","h2","p","alphaFeedback","badgeLabel","feedbackLink","betaFeedback","CommitInfo","commit","commitInfo","diffUXRefreshBeta","useFeatureFlag","helpUrl","useCommitsAppPayload","deferredData","useLoadSingleDeferredCommitData","commitPath","commitish","checkStatusCount","statusCheckStatus","short_text","split","trim","Panel","SafeHTMLText","html","shortMessageMarkdown","AsyncChecksStatusBadge","status","state","descriptionString","Label","PrimerLink","target","rel","Tooltip","Button","repositoryTreePath","action","leadingVisual","FileCodeIcon","bodyMessageHtml","CommitAttribution","settings","fontColor","avatarSize","fontWeight","signatureInformation","SignedCommitBadge","commitOid","hasSignature","verificationStatus","verifiedStatus","signature","verifiedBadgeWidth","pre","parents","parent","Fragment","to","urlObject","URL","ssrSafeLocation","origin","pathname","search","commitHovercardPath","shortSha","CopySHA","sha","direction","CommitUnavailable","unavailableReason","unavailableReasonMetadata","unavailableReasonsMap","Stack","data-hpc","padding","narrow","regular","h1","shortMessage","Blankslate","Visual","visual","Heading","heading","Description","description","secondaryAction","corrupt","SecondaryAction","contactPath","timeout","HourglassIcon","UPDATE_SPLIT_PREFERENCES_URL","DiffViewSettingsContext","createContext","hideWhitespace","splitPreference","updateHideWhitespace","updateSplitPreference","DiffViewSettingsProvider","viewSettings","navigate","useNavigate","userSplitPreference","useSplitViewPreference","defaultPreference","searchParams","useSearchParams","splitPreferenceParam","userWhitespaceParam","useWhitespacePreference","whitespaceParam","setSplitPreference","setHideWhitespace","updateUserSplitPreference","useUpdateUserSplitPreference","updateToSplit","useVerifiedFetch","updateToUnified","updateQueryParam","paramName","value","url","window","location","encodedValue","encodeURIComponent","delete","history","replaceState","toString","newPreference","diffViewSettings","useMemo","Provider","useDiffViewSettings","useContext","baseEmptyStateLoading","extraDiffEntries","error","getFileExtension","lastPeriodIndex","lastIndexOf","NO_FILE_EXTENSION","substring","fileStickyHeaderMargin","filesChangedHeaderHeight","offset","stickyDiffHeaderSx","position","zIndex","backgroundColor","bg","content","display","ml","mr","fetchInjectedContextLines","contextLineRanges","pathDigest","reactFetchJSON","getRangesAsSeparateURLParams","returnString","i","JSON","stringify","ok","json","fetchDiffLines","sha1","sha2","entry","getInsightsUrl","diffLinesPath","reportTraceData","diffLines","BlobActionsMenu","isViewable","copilotDiffChatProps","ActionMenu","Anchor","button","Overlay","blobPath","filePath","inactiveText","LeadingVisual","EyeIcon","Item","PencilIcon","TrashIcon","CopilotDiffChatBlobActionsMenuItems","CommitRichDiff","memo","proseDiffHtml","fileRendererInfo","dependencyDiffPath","loaded","richDiffData","useLoadRichDiffData","initialState","initiallyLoaded","setLoaded","setRichDiffData","loadDiffData","verifiedFetchJSON","useEffect","RichDiff","subject","isInMergeQueue","Diff","DiffUnmemoized","prId","diffMatches","focusedSearchResult","diffEntryData","contextLinePathURL","recalcTotalHeightOfVirtualWindow","headerStickyOffset","ignoreWhitespace","virtualizerScrollTo","useCurrentUser","commentingImplementation","useDiffInlineCommenting","commentInfo","fetchThread","useFetchThread","viewerCanReply","canComment","addComment","deleteComment","editComment","hideComment","unhideComment","useCommenting","findInlineComment","useInlineComments","addThreadReply","onCompleted","onError","thread","then","result","comment","addThread","diffLine","commentId","threadId","editThreadComment","existingComment","bodyVersion","updatedFields","deleteThreadComment","hideThreadComment","reason","unhideThreadComment","batchingEnabled","commentSubjectType","multilineEnabled","resolvingEnabled","suggestedChangesEnabled","lazyFetchReactionGroups","lazyFetchEditHistory","pendingSuggestedChangesBatch","submitSuggestedChanges","noop","addSuggestedChangeToPendingBatch","removeSuggestedChangeFromPendingBatch","addFileLevelThread","resolveThread","unresolveThread","commentBoxConfig","pasteUrlsAsPlainText","useMonospaceFont","markerNavigationImplementation","filteredMarkers","activeGlobalMarkerID","decrementActiveMarker","incrementActiveMarker","onActivateGlobalMarkerNavigation","getThreadDataByPathAndPosition","diffEntryToUse","_setDiffEntryToUse","mapThreadDataIntoDiffEntry","setDiffEntryToUse","newDiffEntry","isCollapsed","setIsCollapsed","collapsed","showRichDiff","setShowRichDiff","defaultToRichDiff","linesManuallyUnhidden","setLinesManuallyUnhidden","diffManuallyExpanded","hasExpandedAllRanges","getContextLines","expandedRangesArray","dealWithInjectedLines","range","prevDiffData","diffEntryWithContext","expandAllContextLines","newTreeEntry","lineCount","start","end","Math","max","oldTreeEntry","getRangesOutOfDiffLines","currentLines","fileLineCount","currentRanges","currentLine","type","previousLine","nextLine","previousLineNumber","blobLineNumber","nextLineNumber","lastLineNumber","onLoadDiff","oldOid","newOid","diffNumber","align","canExpandOrCollapseLines","firstDiffLineNumber","initialDiffLineCount","lastDiffLineNumber","viewerData","avatarUrl","avatarURL","diffViewPreference","isSiteAdmin","login","tabSizePreference","tabSize","viewerCanComment","viewerCanApplySuggestion","copilotChatReferenceData","referenceData","queryVariables","pullRequestId","startOid","endOid","top","DiffFileHeader","areLinesExpanded","fileLinkHref","canToggleRichDiff","linesAdded","linesDeleted","newMode","mode","newPath","oldMode","oldPath","patchStatus","onToggleExpandAllLines","onToggleFileCollapsed","onToggleDiffDisplay","rich","rightSideContent","deletedSha","isSubmodule","proseDifffHtml","renderInfo","DiffLines","diffContext","searchResults","baseHelpUrl","commentingEnabled","commentBatchPending","repositoryId","subjectId","newCommitOid","oldCommitOid","addInjectedContextLines","diffLinesManuallyUnhidden","onHandleLoadDiff","diffEntry","threadDataFetcher","threadData","threadsData","totalCommentsCount","count","totalCount","threads","diffSide","commentsData","line","isOutdated","LoadingContentBlock","LoadingContentBlockUnmemoized","Diffs","selectedPathDigest","unselectedFileExtensions","searchTerm","setSearchTerm","isStickied","resetVirtualizerHeight","recalculateWhichDiffsShouldBeShown","usedToRecalculateWhichDiffsAreShown","diffEntriesToUse","findInDiffWorkerPath","allDiffEntriesWithNoFiltering","shouldVirtualize","errorFlashRef","shouldIgnoreWhitespace","setShouldIgnoreWhitespace","currentPathDigestIndex","oidToUse","setOidToUse","diffFindOpen","setDiffFindOpen","useDiffFindOpen","inputContainer","setFocusedSearchResult","currentIndex","setCurrentIndex","useDiffSearchResults","onHotkeyPressed","selection","getSelection","filter","appPayload","useAppPayload","commitDiffEntriesPath","extraDiffs","useLoadDeferredDiffs","byteCount","lineShownCount","startIndex","shouldSendRequest","setState","cumulativeDiffEntries","previousStartingIndex","cancelled","update","startingIndex","bytesCount","linesShownCount","loadMore","concat","asyncDiffLoadInfo","oldState","moreDiffsToLoad","concatenatedDiffEntries","diffsParentRef","virtualizer","useVirtualWindow","parentRef","estimateSize","diff","isGenerated","isTooBig","right","useVirtualImpl","useVirtualDynamic","rangeExtractor","hash","fileDigest","parseDiffHash","focusedPathDigest","document","querySelector","getAttribute","focusedDiffIndex","findIndex","patch","anchoredDiffIndex","endsWith","defaultRangeExtractor","Array","from","Set","sort","a","b","isHighlightingRightRow","isHighlightingLeftRow","isHighlightingRow","indexOfDiff","getDiffWithPathDigest","flashComponent","childNodes","scrollIntoView","block","scrollToIndex","focusRowElement","collapseButton","querySelectorAll","collapseButtonToFocus","allDiffLinesElements","yOffset","elementToScrollTo","getBoundingClientRect","ssrSafeWindow","scrollY","scrollTo","style","paddingTop","left","globalRelayId","GlobalCommands","commands","hidden","data-hotkey","DiffFindPopover","stickied","scrollDiffCellIntoView","focusedResult","scrollToSearchElement","indexToScrollTo","lineToHighlight","ssrSafeDocument","getElementById","indexWithinDigest","totalSize","virtualItems","virtualRow","currentlyFocusedResult","measureRef","data-key","transform","justifyContent","tabIndex","diffEntries","DiffViewPreferenceToggle","Group","selectionVariant","GroupHeading","selected","onSelect","DiffWhitespaceToggle","DiffViewSettings","GearIcon","Divider","treeToggleElement","headerInfo","diffHeaderRef","useStickyObserver","elementRef","setIsStickied","stickyCallback","isIntersecting","entries","intersectionRatio","element","observer","IntersectionObserver","threshold","rootMargin","observe","unobserve","hideLinesChangedSx","filesChangedString","filesChanged","LinesChangedCounterLabel","isAddition","additions","deletions","Text","fontSize","color","whiteSpace","GoToTopButton","ArrowUpIcon","event","preventDefault","behavior","DIFF_FILE_TREE_ID","FileTree","diffs","onFileSelected","diffsHeader","onFileExtensionsChange","filterText","setFilterText","getCommentCountByPath","narrowDiffHeader","fileExtensions","tempDiffs","filteredDiffs","toLowerCase","commentCount","FileFilter","onFilterTextChange","DiffFileTree","file","isNarrowBreakpoint","getCurrentSize","innerWidth","ScreenSize","medium","debouncedOnSearch","debounce","newQuery","FileFilterShared","onFilterChange","extension","SSRDiffs","commitPayload","currentDiffData","fetchDeferredCommentData","commitCommentDeferredCommentDataPath","ExpandButton","expanded","testid","ariaLabel","ariaControls","onToggleExpanded","alignment","dataHotkey","tooltipDirection","aria-labelledby","aria-expanded","aria-controls","SidebarExpandIcon","SidebarCollapseIcon","clsx","relayEnvironment","relayEnvironmentWithMissingFieldHandlerForNode","Commit","useHideFooter","splitPagePaneHiddenSx","splitPageContentHidden","collapseTree","useTreePane","fileTreeId","userPrefTreeExpanded","updateExpandPreferences","treeValue","formData","FormData","verifiedFetch","userPRFileTreeVisibilitySettingPath","method","body","headers","Accept","treeToggleRef","mobileTreeToggleRef","isTreeExpanded","setIsTreeExpanded","isMobileTreeExpanded","setIsMobileTreeExpanded","expandTree","currentSize","regularTreeToggleElement","mobileTreeToggleElement","flexDirection","mt","maxHeight","fileTreeExpanded","setUnselectedFileExtensions","setSelectedPathDigest","handleFileSelected","postSelectAction","updateURLHash","useLoadBranchCommits","branchCommmitsPath","commitContextLinesPath","handleFileExtensionsChange","unselectedExtensions","add","indexOf","hashArray","splitViewPreference","deferredCommentData","useDeferredCommentData","setDeferredData","fetchDeferredData","threadMarkers","DiffsHeaderComponent","completeDiffData","fileTreeData","splitDiffEntryData","lastIndexOfCompleteDiffData","changeType","RelayEnvironmentProvider","environment","InlineCommentsProvider","initialFiles","permalink","pushState","SplitPageLayout","Header","Pane","sticky","divider","widthStorageKey","resizable","Content","pt","SelectedDiffRowRangeContextProvider","DiffFindOpenProvider","DiscussionCommentsProvider","comments","discussionComments","canLoadMore","subscribed","providerState","DiscussionComments","DiffPlaceholder","CommitHelpMessage","inline","FilterContext","since","until","author","currentBlobPath","pagination","hasNextPage","hasPreviousPage","endCursor","startCursor","originalBranch","FilterProvider","filters","useFilters","useHasRenamedToHistory","RenamedToHistory","TimelineRow","pb","commitsPath","RenamedFromHistory","renameHistory","useRenameHistoryData","hasRenameCommits","oldName","historyUrl","EndOfFileHistory","clipTimeline","EndOfFile","isLoading","useIsDeferredDataLoading","Spinner","CommitList","commitGroups","deferredDataUrl","softNavToCommit","deferredCommitData","useLoadDeferredCommitData","Commits","leadingContent","trailingContent","shouldClipTimeline","useShouldClipTimeline","hasRenamedToHistory","fetchJSON","memoizeCache","memoizeFetchJSON","memoize","cache","addOrModifyUrlParameters","parameters","parametersToRemove","DatePicker","lazy","m","default","StyledCalendarIcon","CalendarIcon","my","ListHeader","refInfo","contributorsUrl","refNameOrCommit","currentOid","actorsState","useLoadAuthorData","usersState","setUsersState","users","actorsResponse","authors","parseISO","isValid","pathSplit","gap","Breadcrumbs","part","parts","join","isLastElement","RefSelector","cacheKey","listCacheKey","canCreate","hotKey","currentCommitish","getHref","refName","selectedRefType","refType","defaultBranch","idEnding","UserSelector","defaultText","showTypedInUser","onOpenChange","open","selectedUser","renderCustomFooter","Suspense","fallback","trailingVisual","TriangleDownIcon","maxDate","Date","showTodayButton","showClearButton","compressedHeader","onChange","extractedRange","extractRange","startDate","formatISO","representation","endDate","placeholder","anchor","Pagination","paginationInfo","getDisabledProps","disabled","border","cursor","ButtonGroup","generateCommitPaginationUrl","ChevronLeftIcon","ChevronRightIcon","isNext","after","before","Layout","PageLayout","rowGap","mb","metadata","unavailableMessage","header","deferredContributorUrl","CommitsBlankState","timeoutMessage","timedOutMessage","showProfileHelp","registerReactAppFactory","routes","jsonRoute","Component","updatedAt","baseEmptyStateNotLoading","useLoadDeferredCommitDataPaginated","commitCount","dataUpdatedAt","cumulativeDeferredCommitInfo","nextIndex","deferredCommits","anchorComment","commentDatabaseId","anchorPrefix","getItem","removeItem","setItem","jsonSafeStorage","buildKey","fileLevelComment","usePersistedDiffCommentData","handlePersistedCommentExists","persistedComment","hasPersistedComment","persistedCommentLocalStorageKey","removePersistedCommentFromStorage","persistCommentToStorage","args","startLine","startSide","isSuggestedChangeInPendingBatch","suggestedChange","pendingBatch","some","isSuggestedChangeEqual","batchedChange","suggestion","suggestionsAreEqual","batchedSuggestion","newSuggestion","sug","idx","SUGGESTED_CHANGES_ERRORS","USER_CANNOT_APPLY_SUGGESTION","PULL_REQUEST_IS_CLOSED","PULL_REQUEST_IS_IN_MERGE_QUEUE","IS_OUTDATED","IS_PENDING","IS_RESOLVED","UNCHANGED_CODE","INVALID_RANGE","BATCH_TOO_BIG","DELETED_LINES","RANGE_NOT_PROVIDED","UNABLE_TO_DETERMINE_VALIDITY","validateSuggestedChangeCanBeApplied","isPending","isResolved","pullRequestIsClosed","pullRequestIsInMergeQueue","userCanApplySuggestion","applySuggestedChangesValidationData","suggestedChangesConfig","lineRange","isValidSuggestionRange","originalLinesContentFromSuggestedChangeConfig","sourceContentFromDiffLines","suggestedChangeText","validateSuggestedChangeCanBeAddedToBatch","invalidRangeResult","invalidBatchSizeResult","find","pendingChange","suggestedChangeLineRangesIntersect","range1","range2","endLineNumber","startLineNumber","generateSuggestedChangeLineRangeFromDiffThread","subjectType","startDiffSide","endDiffSide","originalStartLine","originalEndLine","endOrientation","startOrientation","endLine","DiffAnnotationLevels","ensurePreviousActiveDialogIsClosed","dispatchEvent","KeyboardEvent","code","ctrlKey","validateSuggestedChange","markdown","diffLineContent","suggestedChangesFromText","fenceMatch","match","suggestionFenceRegExp","fence","groups","fenceChar","suggestionMatch","suggestionRegexp","fixed","openFence","source","indentSize","indent","errorMessage","fenceChars","fenceLength","fenceConstraints","char","OpenCopilotChatEvent","Event","bubbles","cancelable","AddCopilotChatReferenceEvent","reference","openPanel","SymbolChangedEvent","context","publishOpenCopilotChat","publishAddCopilotChatReference","subscribeOpenCopilotChat","addEventListener","removeEventListener","subscribeAddCopilotChatReference","subscribeSearchCopilot","subscribeSymbolChanged","TREE_COMPARISON_REFERENCE_TYPE","CopilotChatIntents","explain","conversation","suggest","askDocs","discussFileDiff","explainFileDiff","reviewPr","MESSAGE_STREAMING_ERROR_TYPES","SUPPORTED_FUNCTIONS","node","v0","v1","v2","v3","v4","v5","v6","v7","ComparisonFragment","DiffEntryFragment","buildFileDiffReference","oldCommit","newCommit","latestCommitOid","isBinary","isLfsPointer","headFileCommitOid","rawUrl","baseFile","repoID","databaseId","repoName","repoOwner","commitOID","headFile","head","base","useFileDiffReference","comparisonKey","diffEntryKey","comparison","useFragment","useFileDiffReferenceWithEntryProvided","FileName","newPathStartsWithDot","startsWith","oldPathStartsWithDot","newPathElement","oldPathElement","ArrowRightIcon","additionalLeftSideContent","fileLinkRef","onCopyPath","onHeaderClick","styles","ChevronDownIcon","h3","CopyToClipboardButton","textToCopy","tooltipProps","anchorSide","onCopy","avoidStyledComponent","hasPortalTooltip","fileModeChangedOnly","mx","data-file-path","FoldIcon","UnfoldIcon","SegmentedControl","defaultSelected","CodeIcon","FileIcon","hasChanges","patchData","linesChanged","fileCopiedOnly","fileRenamedOnly","fileWasDeleted","fileTruncated","truncatedReason","truncationReasonLiterals","maxFilesRexExp","output","test","fileWasGenerated","whitespaceChangedOnly","compareDirectoryNames","localeCompare","compareFileNames","fileName","getFileDiff","FileNode","pathParts","directoryParts","DirectoryNode","getOrCreateDirectory","directory","directoriesByName","pathPrefix","directories","subDirectory","files","getOrderedDiffs","getFileTree","summaryDeltas","baseNode","directoryPath","sortDiffEntries","patches","fileTree","FileStatusIcon","FileAddedIcon","FileRemovedIcon","FileMovedIcon","File","depth","rowRef","showTooltip","useFileTreeTooltip","focusRowRef","mouseRowRef","totalCommentsAndAnnotationsCount","totalAnnotationsCount","navigateWindowPanes","TreeView","defaultExpanded","aria-level","PortalTooltip","contentRef","TrailingVisual","CommentIcon","Directory","leadingPath","fileProps","setHash","onHashChange","windowHash","listItemRef","renderDirectoryContents","dir","DirectoryIcon","SubTree","KEY_TO_BIT","ArrowLeft","FocusKeys","ArrowHorizontal","ArrowDown","ArrowVertical","ArrowUp","ArrowRight","h","HL","j","JK","k","l","AD","s","WS","w","d","Tab","Home","HomeAndEnd","End","PageUp","PageUpDown","PageDown","Backspace","GRID_NAV_KEYS","ArrowAll","VALUES","ghostUser","threadSummary","flatMap","firstAuthor","commentsConnectionId","__id","DiffRowSelectedChecker","selectedDiffRowRange","leftLines","rightLines","isSplit","isRowSelected","selectedRightLines","selectedLeftLines","firstLineIndex","getLines","matchLine","lastLineIndex","canHighlight","isEmptyDiffLine","lineIndex","lineOrientationFrom","orientation","lineHashFragmentFrom","lineNumber","diffMatch","parseCommentHash","resourceMatch","parseInt","parseAnnotationHash","annotationId","parseLineRangeHash","matchHash","diffAnchorMatch","discussionAnchorMatch","diffAnchor","firstSelectedLineNumber","firstSelectedOrientation","updateURLHashFromLineRange","urlHashFromLineRange","lineStartFragment","newHash","lineEndFragment","oldURL","HashChangeEvent","newURL","findInDiffWorkerJob","query","diffEntryInfo","currentDiffEntryData","matchingDiffs","searchInDiffIncrementally","matchable","startedAtResultLimit","checkedDiff","matches","getMatchGenerator","next","done","resultsWithinDiff","matchesInRawDiff","textMatchable","searchInDiffContent","kind","regexp","regex","startFromDiff","currentDiff","indexOfResultWithinDiff","diffLineNumIndex","snippet","currentDiffLine","exec","matchContent","column","indexWithinPathDigest","isHunk","hunkLineNumber","leftLineNumber","rightLineNumber","columnEnd","MatchableType","GridNavigator","nextFocusedItem","indices","cellIdToGridLocation","focusedGridCell","cellId","currentRowIndex","currentColumnIndex","isHunkRow","savedColumnIndex","focusFirstGridCell","endRowIndex","grid","endColumnCellCount","saveColumnIndex","previousHunkRowIndex","getPreviousHunkRowIndex","nextHunkRowIndex","getNextHunkRowIndex","nextColumnIndex","currentRow","lastColumnIndex","reinitializeGrid","initializeGrid","initialFocusedGridCellId","focusGridCell","rowIndex","columnIndex","nextSelectableCell","referenceGridCell","lastSelectedGridCell","referenceGridCellIndices","previousRowIndex","getNextSelectableCellFromRow","nextRowIndex","isEmpty","gridRowIndex","firstCodeRow","row","cell","lastCodeRow","reverse","leftLine","rightLine","rowIdentifier","rowIdFrom","fileAnchor","cellIdFrom","nextRow","nextCell","hunkRowIndexes","isSplitDiff","initializeSplitDiffCodeRow","initializeHunkRow","initializeUnifiedDiffCodeRow","cellIndex","rowId","initializeContentCell","codeOrientation","HunkHeaderData","finalLineId","orderHunksByBlobLineNumber","hunkA","hunkB","startBlobLineNumber","getLineHunkData","hunksData","currentHunk","previousHunk","currentHunkIdx","hunkData","endBlobLineNumber","nextHunk","getDiffHunksData","lines","isLastLine","lastLine","hunkHeaderLine","lastLineIdx","orderLineRange","outOfOrder","foundStart","foundEnd","leftLinePart","rightLinePart","EMPTY_DIFF_LINE","isDiffLine","isContextDiffLine","trimContentLine","lineHtml","lineType","charToRemove","removedChar","groupDiffLines","fillBlanks","parseHtml","DOMParser","parseFromString","documentElement","textContent","anchorLinkForSelection","urlHashFromLine","leftLineTypes","getKeyboardShortcutString","includeControlKey","includeShiftKey","includeOptionKey","str","isMacOS","calculateDiffLineCodeCellGutter","hasThreads","calculateCommentIndicatorRightPositioning","shouldAlignRight","getAriaKeyShortcutString","LINE_TYPES_SUPPORTING_COMMENTS","lineAcceptsComments","selectedDiffLines","selectedLines","every","getContentFromLines","trimmedContent","notEmpty","overlayContainsEventTarget","eventTarget","primerPortalRoot","contains","useActionBarDialogs","actionBarRef","replaceSelectedDiffRowRange","useSelectedDiffRowRangeContext","useDiffLineContext","setReturnFocusRef","annotations","openDialog","closeDialog","selectedAnnotationId","selectAnnotationId","selectedThreadId","selectThreadId","openContextMenuCell","openNewConversationCell","openMarkerDetailsCell","openMarkersListCell","updateVisibleThreads","threadConnectionId","anyMenuOpen","useMarkersDialogContext","sendAnalyticsEvent","useAnalytics","isNewConversationDialogOpen","shouldStartNewConversationWithSuggestedChange","withSuggestedChange","openNewConversationDialog","opts","startNewConversation","startNewConversationFromActionBar","startNewConversationWithSuggestedChange","startNewConversationFromActionBarWithSuggestedChange","closeNewConversationDialog","isContextMenuOpen","openContextMenu","openContextMenuFromActionBar","closeContextMenu","toggleContextMenu","toggleContextMenuFromActionBar","optimizedSelectedThreadId","optimizedSelectedAnnotationId","openMarkerDetailsDialog","closeConversationDetailsDialog","selectThread","useStableCallback","skipLineSelection","t","selectAnnotation","annotation","openMarkerListDialog","closeMarkerListDialog","openConversationOrList","newThreads","firstThread","isOnlyThread","firstAnnotation","isOnlyAnnotation","isMarkerListDialogOpen","openMarkerOrListDialogFromActionBar","openMarkerOrListDialog","useActionBarFocus","cellRef","showActionBar","hideActionBar","isActionBarFocused","setIsActionBarFocused","handleCellFocus","handleCellBlur","relatedTarget","handleCellMouseEnter","handleCellMouseLeave","activeElement","handleActionBarBlur","handleActionBarFocusCapture","stopPropagation","handleActionBarKeydownCapture","isGridNavigationKey","diffInfo","redoSearchResults","setSearchResults","workerManagerRef","req","searchTermRef","lastSearchTerm","lastDiffEntryData","canDoIncrementalSearch","useExpandHunk","useDiffContext","canExpandStartOfHunk","canExpandEndOfHunk","expandStartOfHunk","expandEndOfHunk","expandEndOfPreviousHunk","ensureElementFocusable","useFocusNextCellAfterExpand","gridNavigator","containerRef","prevGridNavigator","loadedLines","getNewLines","hasLine","cellButton","nextLineIndex","firstLine","tagName","closest","navigatorCellId","cellToFocus","keyBit","useGridNavigation","clearSelectedDiffRowRange","replaceSelectedDiffRowRangeFromGridCells","updateSelectedDiffRowRange","useSyncedGridFocus","handleGridFocusIn","gridCellId","focusedCell","containerElement","getNextFocusable","_direction","getValidSelectableRowCell","metaKey","firstCodeCell","getFirstCodeCell","lastCodeCell","getLastCodeCell","startGridCell","endGridCell","shiftKey","nextSelectedCell","getNextSelectableCell","nextItem","moveToNextItem","nextElement","clearLastSelectedCell","useFocusZone","bindKeys","focusableElementFilter","focusInStrategy","useSelectedDiffRowRangeContent","getDiffLinesByDiffAnchor","getUnifiedDiffLineCode","secondLineIndex","getSplitDiffSingleLineCode","side","getSplitDiffMultiLineCode","trackingRef","fn","useLayoutEffect","configureSuggestedChangesFromThreadWithDiffLines","suggestedChangeDiffLines","suggestionNotOnDeletedLine","originalLinesContentFromDiffLines","showSuggestChangesButton","onInsertSuggestedChange","shouldInsertSuggestedChange","useSuggestedChanges","getDiffLinesFromLineRange","configureSuggestedChangesFromLineRange","rowRange","shouldShowSuggestChangesButtonFromRowRange","diffLinesFromRange","getSourceContentDiffLinesFromRowRange","lineContent","DEFAULT_RENDERER_HEIGHT","useFileRenderer","renderStateRef","setRenderState","useStatefulRef","renderStateInt","setRenderStateInt","errorMsg","iFrameRef","renderTiming","untimed","messageListener","onMessage","setError","renderMessage","getRenderMessage","parse","messageData","renderWindow","contentWindow","timingData","hello","now","sendRenderCommand","cmd","ack","branding","sendIFrameDataToIFrame","iframe","container","msg","resetTiming","timeoutWatchdog","checkHello","load","helloTimer","loadTimer","renderState","message","RenderState","setShowTooltip","showIfOverflowing","scrollWidth","offsetWidth","onfocus","onblur","onmouseenter","onmouseleave","hide","footer","token","useCSRFToken","init","requestMethod","addHeader","URLSearchParams","append","fetch","Headers","isArray","existingIndex","defaultKeyExtractor","options","measureRefCacheRef","elCacheRef","el","updateRef","resizeObserverRef","ResizeObserver","attribute","ro","disconnect","keyExtractor","cachedMeasureRefWrappers","makeMeasureRefWrapperForItem","measureRefsMap","rowVirtualizer","useVirtual","item","additionalScrollOffset","scrollToFn","horizontal","rest","windowRef","scrollOffsetFn","bounds","defaultScrollToFn","scrollOffset","scroll","onScrollElement","useObserver","useWindowRect","rect","setRect","resizeHandler","innerHeight","prev","UserItem","isCurrent","GitHubAvatar","primaryAvatarUrl","square","UsersList","VirtualUsersList","FullUsersList","overflowY","FixedSizeVirtualList","items","itemHeight","makeKey","renderItem","label","filteredUsers","filterUsersHelper","trimmedFilterText","PeopleIcon","maxWidth","overflow","textOverflow","showDividers","UserFilter","Loading","LoadingFailed","UsersZeroState","marginTop","px","TextInput","SearchIcon","CommentHeader","hideActions","editHistoryComponent","MarkdownEditHistoryViewerQueryComponent","MarkdownEditHistoryViewer","editHistory","ActivityHeader","actions","CommentActions","CompactCommentButton","alignItems","borderColor","borderRadius","lineHeight","BLANK_STATE_DATA","showTextInput","unavailable","GitCommitIcon","spacious","monospace","readOnly","trailingAction","Action","copyText","CopyIcon","AddCommentEditor","batchPending","condensed","focusOnMount","isReplying","onAddComment","onCancelComment","onPersistedCommentExists","quotedText","commentText","setCommentText","isSubmitting","setIsSubmitting","setErrorMessage","editorRef","handleAddComment","submitBatch","suggestedChangedEvaluation","closeCommentBox","handleAddReviewComment","handleAddSingleComment","footerStyles","fieldset","minWidth","ConversationCommentBox","onPrimaryAction","userSettings","markdownErrorMessage","CommentBoxButton","py","IconMap","Failure","StopIcon","fill","Warning","Notice","InfoIcon","Annotation","checkSuiteApp","checkSuite","app","borderLeft","AnnotationPresentationMap","annotationLevel","primaryColor","pl","fontFamily","flexGrow","logoUrl","Truncate","checkRun","detailsUrl","AnnotationDialog","borderBottom","borderBottomColor","background","GlobalMarkerNavigation","markerId","onNavigate","XIcon","AnnotationIcon","annotationData","buildAnnotationIcon","stroke","svgHtml","svg","strokeLinecap","strokeLinejoin","strokeWidth","boxShadow","viewBox","xmlns","fadeInAnimation","keyframes","AnimatedAnnotationIcon","styled","priority","circle","cx","cy","r","x1","x2","y1","y2","CodeSuggestionActions","setIsDialogOpen","useDialogStateContext","isApplySuggestionsDialogOpen","setIsApplySuggestionsDialogOpen","isPendingInBatch","batchIsEmpty","changesToApply","isDialogOpen","returnFocusTo","handleCommit","commitMessage","suggestedChanges","borderTop","CommitOrRemoveFromBatch","onOpenDialog","CodeSuggestionUnavailable","ApplyOrAddToBatch","AddToExistingBatch","ApplySuggestionDialog","authorLogins","change","authorLogin","batchSize","onCommit","applicationMethods","addSuggestionToBatch","applySuggestion","selectedButtonApplicationMethod","setSelectedButtonApplicationMethod","isActionMenuOpen","setIsActionMenuOpen","iconButtonRef","toggleActionMenuOpen","handlePrimaryButtonClick","aria-haspopup","anchorRef","DialogFooter","footerButtons","footerRef","Footer","Buttons","buttons","CHANGE_COMMIT_MESSAGE","CHANGE_EXTENDED_DESCRIPTION","formReducer","extendedDescription","isMounted","useIsMounted","formValues","setFormValues","useReducer","handleError","_error","_type","friendlyMessage","serverErrorMessage","handleCompleted","handleOnCommitClick","renderFooter","buttonType","FormControl","Validation","Textarea","rows","handleCommitBatchClick","batchCount","forwardRef","useConversationMarkdownSubjectContext","CommentBox","showLabel","MarkerPosition","markers","marker","Markers","DialogStateProvider","MarkersInternal","conversationAnchorRef","conversationListAnchorRef","conversationListThreads","isMarkerListOpen","onAnnotationSelected","onCloseConversationDialog","onCloseConversationList","onThreadSelected","threadsConnectionId","selectedThread","setSelectedThread","handleCloseConversationDialog","updateSelectedThread","config","threadRowRange","hasSelectedMarker","selectedAnnotation","AnchoredOverlay","focusZoneSettings","focusTrapSettings","renderAnchor","overlayProps","role","onClickOutside","onKeyDown","ReviewThreadDialog","onRefreshThread","MarkersListActionMenu","handleOpenChange","onShowCommentThread","onShowAnnotation","lineClampStyles","numberOfLines","ReviewThread","commentAnchorPrefix","hideDiffPreview","shouldLimitHeight","setIsReplying","quoteReplyText","setQuoteReplyText","onQuoteReply","StaticUnifiedDiffPreview","ReviewThreadComment","isAnchorable","isLastChild","commentConnectionId","threadCommentCount","isThreadResolved","borderBottomLeftRadius","borderBottomRightRadius","commentsConnectionIds","addToast","useToastContext","isEditing","setIsEditing","isMinimized","setIsMinimized","isHidden","bodyText","setBodyText","commentBoxRef","commentBodyRef","focusCommentBox","onSave","currentDiffResourcePath","pop","commentAnchor","commentHref","blueFocusOutlineStyles","outline","outlineColor","outlineOffset","isReply","isNestedReply","areSuggestedChangesEnabled","commentState","headingProps","referenceText","commentRef","onMinimize","commentAuthorLogin","commentSubjectAuthorLogin","onReplySelect","borderImage","newBody","overflowX","bodyHTML","SafeHTMLBox","comment-testid","ReactionViewerLoading","ReactionViewerQueryComponent","ReactionViewer","reactionGroups","SuggestedChangeView","Emphasis","MultineLineThreadBanner","startSideString","endSideString","hasComments","CheckCircleFillIcon","CheckCircleIcon","StartConversation","isOpen","onCloseCommentDialog","StartThreadComment","addCommentDialogTitle","isLeftSide","StaticLineNumberCell","td","getBackgroundColor","textAlign","StaticHunkCell","colSpan","valign","HunkKebabIcon","SafeHTMLDiv","StaticUnifiedDiffRow","showLeftNumber","showRightNumber","getTextIndent","getPaddingLeft","diffLineFileWrap","lineMarker","tr","addition","deletion","showLineMarker","paddingLeft","textIndent","StaticUnifiedDiffLines","lineWidth","diffRows","diffline","data-tab-size","borderRight","borderStyle","UnifiedDiffTable","hideHeaderDetails","diffTableSx","getLineNumberWidth","borderBottomWidth","borderWidth","borderTopLeftRadius","borderTopRightRadius","threadLineLocation","pullRequestCommit","abbreviatedOid","suggestedChangeRefs","useSuggestedChangesRefs","setSuggestedChangeRefs","renderedApplyChangeElements","getElementsByClassName","changesBlobEl","additionChangesEl","x","createPortal","ConversationMarkdownSubjectContext","ConversationMarkdownSubjectProvider","DialogStateContext","contextData","DiffChatWrapper","errorFallback","MenuItemError","suspenseFallback","MenuItemLoading","BaseCopilotDiffChatBlobActionsMenuItems","DiffLinesDiscussMenuItem","eventContext","prx","CopilotIcon","fileDiffReference","CopilotDiffChatContextMenu","selectedRange","componentProps","BaseCopilotDiffChatContextMenu","referenceWithRange","toUpperCase","DiffLinesExplainMenuItem","DiffLinesAttachMenuItem","WrapperViewerQuery","WrapperComparisonQuery","WrapperDiffEntryQuery","CopilotCodeChatAccessLoader","viewer","useLazyLoadQuery","isCopilotDotcomChatEnabled","CopilotCodeChatReferenceLoader","CopilotCodeChatComparisonLoader","ErrorBoundary","afterSelect","sendEvent","intent","references","FileFilterLoading","SlidersIcon","filterLoadingHeight","initialFilterText","additionalFilterGroups","setSelectedFileFilters","select","extensions","ext","fileExtensionIsSelected","noExtensionPresent","actionBarPosition","actionBarButtonSize","startConversationButtonWidth","ActionBar","authorAvatarUrl","showStartConversation","hasDraftComment","dialogReturnFocusRef","viewConversationButtonRef","startConversationButtonRef","contextMenuRef","returnFocusToRef","useRefObjectAsForwardedRef","annotationsData","handleActionBarClick","aria-hidden","onBlur","onFocusCapture","onKeyDownCapture","CommentIndicator","InProgressCommentIndicator","PlusIcon","CellContextMenu","handleViewMarkersSelection","startConversationCurrentLine","startConversationWithSuggestedChange","shouldAnimateRef","commentAuthors","level","avatarStackChildren","annotationA","annotationB","priorityA","authorName","indicatorText","commentIndicatorContainer","AvatarStack","disableExpand","fontVariantNumeric","escapeToBrowserOnNextKeyPress","setEscapeToBrowserOnNextKeyPress","currentKeyArray","totalResultSize","clearSearch","jumpToResult","tempFocusedResult","incSize","values","defaultStyles","stickyStyles","notStickyStyles","ScopedCommands","h5","visibilityVisible","visibilityHidden","validationStatus","autoComplete","ChevronUpIcon","keyboardEvent","DiffHighlightedOverlay","styleObject","userSelectNone","nonHunkStyles","digest","isFocusedResult","focusedResultStyles","nonFocusedResultStyles","buildDiffLineScreenReaderSummary","currentSide","leftLineThreadCount","rightLineThreadCount","firstLeftCommentAuthor","firstRightCommentAuthor","leftLineSummary","rightLineSummary","summary","capitalizedLeftSummary","charAt","rightLineSummaryWithModified","capitalizedRightSummary","leftLineSummaryWithOriginal","DiffLineScreenReaderSummary","trimStart","trimEnd","StartConversationContextMenuItems","handleStartConversation","handleStartConversationWithSuggestedChange","ViewMarkerListItems","CopilotListItems","CopyContentListItems","SelectAllListItem","CommandActionListItem","commandId","LinkIcon","ExpandHunksListItems","JumpToHunkListItems","EmptyCellContextMenu","diffEntryId","MultiSelectIcon","KeyboardKey","SplitDiffMarkersListItems","UnifiedDiffMarkerListItem","originalLineHasThreads","modifiedLineHasThreads","hasAnnotations","MarkerListItem","CommentDiscussionIcon","onMouseDown","FoldUpIcon","FoldDownIcon","hasNextHunk","aria-keyshortcuts","MoveToBottomIcon","hasPreviousHunk","MoveToTopIcon","useCellId","useCommentDialogTitle","isMultiLineComment","lineSideIdentifier","startSideIdentifier","endSideIdentifier","isMultiLineSelection","sideIdentifier","Cell","ContextMenu","handleDiffCellClick","handleDiffSideCellSelectionBlocking","lineAnchor","commentDialogOpen","startConversation","forwardedRef","useImperativeHandle","showContextMenu","setShowContextMenu","contextMenuOverlayRef","handleClickOutside","useSafeAsyncCallback","isConversationOpen","handleMouseDown","highlightedTextSelection","execCommand","isSingleCellSelection","expandAllHunksButton","MouseEvent","link","data-grid-cell-id","data-line-anchor","data-selected","userSelect","ariaSelected","onContextMenu","onFocus","ContentCell","searchResultsForLine","trimmedChar","showTrimmedChar","isActionBarVisible","actionBarReturnFocusRef","commentIndicatorRightPositioning","commentIndicatorGutterSize","threadIds","annotationIds","shouldAnimate","paddingRight","onMouseEnter","onMouseLeave","linesToCheck","lastSelectedLine","LineNumberCell","HunkCell","renderHunkButton","cellProps","buttonProps","useGridCellButtonProps","isFocusWithin","setIsFocusWithin","isButtonFocused","setIsButtonFocused","handleButtonBlur","EmptyCell","showRightBorder","isNumber","CodeDiffLineUnmemoized","resultsForLine","handleDiffRowClick","showLeftNumberCell","displayingEmptyLeftNumberCell","showRightNumberCell","displayingEmptyRightNumberCell","handleLeftDiffCellClick","handleRightDiffCellClick","handleRightDiffSideCellSelectionBlocking","handleLeftDiffSideCellSelectionBlocking","MarkersDialogContextProvider","DiffLineSideUnmemoized","lineOrientation","lineAnchorFrom","CodeDiffLine","DiffLineSide","PlainTextStatus","data-diff-anchor","diffContextData","tableRef","diffSideBeingBlocked","setDiffSideBeingBlocked","lastDiffLine","updateDiffLines","isSelectedFile","orderedSelectedDiffRowRange","lineNumberWidth","defaultPrevented","HiddenDiffPatch","helpText","diffLinesProps","objectId","DiffContextProvider","SelectedDiffLinesOverlay","selectedLineRange","table","tableLayoutFixed","data-block-diff-cell-selection","data-paste-markdown-skip","SplitDiffTable","SplitDiffLines","UnifiedDiffLines","ExpandButtonLine","Icon","additionalProps","data-direction","ExpandableHunkHeaderDiffLine","prevLine","isStartOfDiff","isEndOfDiff","isStartOfFile","isStartOrEndOfDiff","isEndOfFile","showExpandAll","showExpandAboveAndBelow","showExpandAbove","showExpandBelow","expandButtonType","handleExpandAboveClick","handleExpandBelowClick","handleExpandAllClick","HunkContextMenu","handleCopyContent","parsedContent","handleExpandAbove","handleExpandAll","handleExpandBelow","shouldCopyContent","shouldExpandAbove","shouldExpandBelow","expandAllShortcutArgs","expandUpShortcutArgs","expandBelowShortcutArgs","copyContentShortcutArgs","showLink","gridColumnTemplate","clipPath","fillRule","StatusAvatar","altText","DotFillIcon","iconColor","backgroundSx","opacity","FileRendererBlob","include-fragment","positionData","setPositionData","updatePosition","selectedCells","positionedParentBoundingRect","getPositionedParent","parentNode","HTMLElement","getComputedStyle","bottom","Number","MAX_SAFE_INTEGER","boundingRect","min","useResizeObserver","overlay","overlayOpacity","useGroupedLines","splitContextLine","leftLineThreads","rightLineThreads","diffRowSelectedChecker","leftLineWithSearchContentMap","rightLineWithSearchContentMap","hunkLinesWithSearchContentMap","searchResult","originalLineThreads","modifiedLineThreads","leftResultsForLine","rightResultsForLine","hunkResultsForLine","hunkFocusedResult","leftFocusedResult","rightFocusedResult","summaryLeft","summaryRight","updatedLineThreads","ogLineThreads","diffLineContextData","modifiedLineThreadsConnectionId","originalLineThreadsConnectionId","DiffLineContextProvider","ORIENTATION_MAP","START_CONVERSATION","SUGGEST_CHANGE","generateSingleLineText","baseAction","originalRangeText","modifiedRangeText","unifiedRangeText","firstOriginalLine","lastOriginalLine","allOriginalLinesNotDeletions","firstModifiedLine","lastModifiedLine","modifiedLinesAreEmpty","originalLinesAreEmpty","allLinesAreContextLines","handleStartOriginalLinesConversationSelection","handleStartModifiedLinesConversationSelection","canSuggestChanges","hasMultipleLinesSelected","showOriginalLineOption","showModifiedLineOption","selectedDiffRowRangeStartOrientation","selectedDiffRowRangeEndOrientation","PlusCircleIcon","lineWithSearchContentMap","DiffContext","hasCommentingImplementation","hasMarkerNavigationImplementation","ghost","DiffFindOpenContext","setRawDiffFindOpen","contextValue","DiffLineContext","THREAD","ANNOTATION","MarkersDialogContext","setIsActionBarVisible","setOpenContextMenuCell","setOpenMarkersListCell","seOpenMarkerDetailsCell","setOpenNewConversationCell","selectedMarker","setSelectedMarker","sideWithOpenThreads","setSideWithOpenThreads","getThreadsForSide","dialog","SelectedDiffRowRange","ariaAnnounceForLineRange","announce","diffLinesMap","diffRowRange","selectedAnchor","setSelectedDiffRowRange","setSelectedDiffLines","updateSelectedContextLines","newSelection","newLineRange","currentRange","identityUuid","tempOrigin","iframeStateSX","READY","rendererReadySx","data-host","data-type","ERROR","FileRendererErrorMessage","sandbox","msgLines","br","shouldNavigateOnError","transitionType","coreLoader","fetchPath","redirected","httpStatus","responseJson","loadFromEmbeddedData","embeddedData","screenBreakpoints","ScreenContext","screenSize","useScreenSize","ScreenSizeProvider","initialValue","initial","useSyncExternalStore","currentSizeRef","setScreenSize","onResize","updatedSize","resizeObserver","elementWidth","breakpoint","hovercardUrl","StatusIcon","absolute","innerSize","margin"],"sourceRoot":""}