# generated by turbocassette ts/cassettes/sessions/codescanningseed_test.go
---
http_interactions:
  - request:
      method: post
      uri: http://localhost:8888/twirp/github.turboscan.Results/GetAlert
      body:
        encoding: UTF-8
        string: |-
          {
            "number": "2",
            "repositoryId": "351"
          }
      headers:
        Content-Type:
          - application/json
    response:
      status:
        code: 200
        message: null
      headers:
        Content-Length:
          - "2692"
        Content-Type:
          - application/json
      body:
        encoding: UTF-8
        string: |-
          {
            "hasCodePaths": true,
            "queryUri": "",
            "refNameBytes": "cmVmcy9oZWFkcy9tYXN0ZXI=",
            "relatedLocations": [
              {
                "createdAt": "0001-01-01T00:00:00Z",
                "id": "1",
                "location": {
                  "endColumn": 36,
                  "endLine": 22,
                  "filePath": "path_query/LogoutRoute.ts",
                  "startColumn": 29,
                  "startLine": 22
                },
                "message": "user-provided value",
                "physicalAlertId": "2",
                "replacementIndex": 1,
                "updatedAt": "0001-01-01T00:00:00Z"
              }
            ],
            "result": {
              "createdAt": "0001-01-01T00:00:00Z",
              "fixedAt": null,
              "guid": "11111111-2222-3333-4444-000000000000",
              "isFixed": false,
              "messageMarkdown": "",
              "messageText": "Untrusted URL redirection due to [user-provided value](1).",
              "mostRecentInstance": {
                "analysisKey": {
                  "analysisKey": ".github/workflows/w1.yml:job1",
                  "category": ".github/workflows/w1.yml:job1",
                  "commitOid": "b000000000000000000000000000000000000000",
                  "environment": "{}",
                  "id": "1",
                  "tool": "CodeQL"
                },
                "classification": [],
                "commitOid": "b000000000000000000000000000000000000000",
                "createdAt": "0001-01-01T00:00:00Z",
                "hasFileClassification": false,
                "isFixed": false,
                "isOutdated": false,
                "location": {
                  "endColumn": 34,
                  "endLine": 104,
                  "filePath": "path_query/ResponseUtil.ts",
                  "startColumn": 31,
                  "startLine": 104
                },
                "messageText": "Untrusted URL redirection due to [user-provided value](1).",
                "refNameBytes": "cmVmcy9oZWFkcy9tYXN0ZXI="
              },
              "number": 2,
              "resolution": "USED_IN_TESTS",
              "resolutionNote": "This is only used in non-production test code where we can trust the input.",
              "resolvedAt": "0001-01-01T00:00:00Z",
              "resolverId": 2,
              "rule": {
                "fullDescription": "Server-side URL redirection based on unvalidated user input may cause redirection to malicious web sites.",
                "help": "",
                "helpUri": "",
                "name": "js/server-side-unvalidated-url-redirection",
                "queryUri": "",
                "sarifIdentifier": "js/server-side-unvalidated-url-redirection",
                "severity": "WARNING",
                "shortDescription": "Server-side URL redirect",
                "tags": [
                  "external/cwe/cwe-601",
                  "security"
                ]
              },
              "ruleSeverity": "WARNING",
              "securitySeverity": "NO_SECURITY_SEVERITY",
              "tool": {
                "alertCount": "0",
                "guid": "7c61abe3-312b-1652-9c03-78f678a96a5f",
                "name": "CodeQL",
                "version": "2.0.1"
              },
              "updatedAt": "0001-01-01T00:00:00Z"
            },
            "ruleHelp": "",
            "ruleTags": [
              "external/cwe/cwe-601",
              "security"
            ]
          }
      http_version: null
    recorded_at: Wed, 18 Jan 2023 14:11:12 GMT
  - request:
      method: post
      uri: http://localhost:8888/twirp/github.turboscan.Results/GetAlertInstances
      body:
        encoding: UTF-8
        string: |-
          {
            "alertNumber": 2,
            "limit": 30,
            "numericPage": 1,
            "repositoryId": "351"
          }
      headers:
        Content-Type:
          - application/json
    response:
      status:
        code: 200
        message: null
      headers:
        Content-Length:
          - "871"
        Content-Type:
          - application/json
      body:
        encoding: UTF-8
        string: |-
          {
            "instances": [
              {
                "analysisKey": {
                  "analysisKey": ".github/workflows/w1.yml:job1",
                  "category": ".github/workflows/w1.yml:job1",
                  "commitOid": "b000000000000000000000000000000000000000",
                  "environment": "{}",
                  "id": "1",
                  "tool": "CodeQL"
                },
                "classification": [],
                "commitOid": "b000000000000000000000000000000000000000",
                "createdAt": "0001-01-01T00:00:00Z",
                "hasFileClassification": false,
                "isFixed": false,
                "isOutdated": false,
                "location": {
                  "endColumn": 34,
                  "endLine": 104,
                  "filePath": "path_query/ResponseUtil.ts",
                  "startColumn": 31,
                  "startLine": 104
                },
                "messageText": "Untrusted URL redirection due to [user-provided value](1).",
                "refNameBytes": "cmVmcy9oZWFkcy9tYXN0ZXI="
              }
            ],
            "totalCount": "1"
          }
      http_version: null
    recorded_at: Wed, 18 Jan 2023 14:11:12 GMT
recorded_with: VCR 5.1.0
