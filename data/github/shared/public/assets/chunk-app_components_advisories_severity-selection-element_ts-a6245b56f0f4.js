"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_advisories_severity-selection-element_ts"],{45062:(e,t,r)=>{r.d(t,{s:()=>n});var i=r(70170);function n(e=0,t={}){return(r,n,o)=>{if(!o||"function"!=typeof o.value)throw Error("debounce can only decorate functions");let s=o.value;o.value=(0,i.s)(s,e,t),Object.defineProperty(r,n,o)}}},70170:(e,t,r)=>{function i(e,t=0,{start:r=!0,middle:i=!0,once:n=!1}={}){let o,s=r,a=0,l=!1;function u(...c){if(l)return;let d=Date.now()-a;a=Date.now(),r&&i&&d>=t&&(s=!0),s?(s=!1,e.apply(this,c),n&&u.cancel()):(i&&d<t||!i)&&(clearTimeout(o),o=setTimeout(()=>{a=Date.now(),e.apply(this,c),n&&u.cancel()},i?t-d:t))}return u.cancel=()=>{clearTimeout(o),l=!0},u}function n(e,t=0,{start:r=!1,middle:n=!1,once:o=!1}={}){return i(e,t,{start:r,middle:n,once:o})}r.d(t,{n:()=>i,s:()=>n})},97797:(e,t,r)=>{function i(){if(!(this instanceof i))return new i;this.size=0,this.uid=0,this.selectors=[],this.selectorObjects={},this.indexes=Object.create(this.indexes),this.activeIndexes=[]}r.d(t,{h:()=>x,A:()=>L,on:()=>w});var n,o=window.document.documentElement,s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector;i.prototype.matchesSelector=function(e,t){return s.call(e,t)},i.prototype.querySelectorAll=function(e,t){return t.querySelectorAll(e)},i.prototype.indexes=[];var a=/^#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;i.prototype.indexes.push({name:"ID",selector:function(e){var t;if(t=e.match(a))return t[0].slice(1)},element:function(e){if(e.id)return[e.id]}});var l=/^\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;i.prototype.indexes.push({name:"CLASS",selector:function(e){var t;if(t=e.match(l))return t[0].slice(1)},element:function(e){var t=e.className;if(t){if("string"==typeof t)return t.split(/\s/);if("object"==typeof t&&"baseVal"in t)return t.baseVal.split(/\s/)}}});var u=/^((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;i.prototype.indexes.push({name:"TAG",selector:function(e){var t;if(t=e.match(u))return t[0].toUpperCase()},element:function(e){return[e.nodeName.toUpperCase()]}}),i.prototype.indexes.default={name:"UNIVERSAL",selector:function(){return!0},element:function(){return[!0]}},n="function"==typeof window.Map?window.Map:function(){function e(){this.map={}}return e.prototype.get=function(e){return this.map[e+" "]},e.prototype.set=function(e,t){this.map[e+" "]=t},e}();var c=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g;function d(e,t){var r,i,n,o,s,a,l=(e=e.slice(0).concat(e.default)).length,u=t,d=[];do if(c.exec(""),(n=c.exec(u))&&(u=n[3],n[2]||!u)){for(r=0;r<l;r++)if(s=(a=e[r]).selector(n[1])){for(i=d.length,o=!1;i--;)if(d[i].index===a&&d[i].key===s){o=!0;break}o||d.push({index:a,key:s});break}}while(n)return d}function v(e,t){return e.id-t.id}i.prototype.logDefaultIndexUsed=function(){},i.prototype.add=function(e,t){var r,i,o,s,a,l,u,c,v=this.activeIndexes,h=this.selectors,p=this.selectorObjects;if("string"==typeof e){for(i=0,p[(r={id:this.uid++,selector:e,data:t}).id]=r,u=d(this.indexes,e);i<u.length;i++)s=(c=u[i]).key,(a=function(e,t){var r,i,n;for(r=0,i=e.length;r<i;r++)if(n=e[r],t.isPrototypeOf(n))return n}(v,o=c.index))||((a=Object.create(o)).map=new n,v.push(a)),o===this.indexes.default&&this.logDefaultIndexUsed(r),(l=a.map.get(s))||(l=[],a.map.set(s,l)),l.push(r);this.size++,h.push(e)}},i.prototype.remove=function(e,t){if("string"==typeof e){var r,i,n,o,s,a,l,u,c=this.activeIndexes,v=this.selectors=[],h=this.selectorObjects,p={},f=1==arguments.length;for(n=0,r=d(this.indexes,e);n<r.length;n++)for(i=r[n],o=c.length;o--;)if(a=c[o],i.index.isPrototypeOf(a)){if(l=a.map.get(i.key))for(s=l.length;s--;)(u=l[s]).selector===e&&(f||u.data===t)&&(l.splice(s,1),p[u.id]=!0);break}for(n in p)delete h[n],this.size--;for(n in h)v.push(h[n].selector)}},i.prototype.queryAll=function(e){if(!this.selectors.length)return[];var t,r,i,n,o,s,a,l,u={},c=[],d=this.querySelectorAll(this.selectors.join(", "),e);for(t=0,i=d.length;t<i;t++)for(r=0,o=d[t],n=(s=this.matches(o)).length;r<n;r++)u[(l=s[r]).id]?a=u[l.id]:(a={id:l.id,selector:l.selector,data:l.data,elements:[]},u[l.id]=a,c.push(a)),a.elements.push(o);return c.sort(v)},i.prototype.matches=function(e){if(!e)return[];var t,r,i,n,o,s,a,l,u,c,d,h=this.activeIndexes,p={},f=[];for(t=0,n=h.length;t<n;t++)if(l=(a=h[t]).element(e)){for(r=0,o=l.length;r<o;r++)if(u=a.map.get(l[r]))for(i=0,s=u.length;i<s;i++)!p[d=(c=u[i]).id]&&this.matchesSelector(e,c.selector)&&(p[d]=!0,f.push(c))}return f.sort(v)};var h={},p={},f=new WeakMap,m=new WeakMap,g=new WeakMap,S=Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget");function y(e,t,r){var i=e[t];return e[t]=function(){return r.apply(e,arguments),i.apply(e,arguments)},e}function E(){f.set(this,!0)}function b(){f.set(this,!0),m.set(this,!0)}function C(){return g.get(this)||null}function I(e,t){S&&Object.defineProperty(e,"currentTarget",{configurable:!0,enumerable:!0,get:t||S.get})}function V(e){if(function(e){try{return e.eventPhase,!0}catch(e){return!1}}(e)){var t=(1===e.eventPhase?p:h)[e.type];if(t){var r=function(e,t,r){var i=[],n=t;do{if(1!==n.nodeType)break;var o=e.matches(n);if(o.length){var s={node:n,observers:o};r?i.unshift(s):i.push(s)}}while(n=n.parentElement)return i}(t,e.target,1===e.eventPhase);if(r.length){y(e,"stopPropagation",E),y(e,"stopImmediatePropagation",b),I(e,C);for(var i=0,n=r.length;i<n&&!f.get(e);i++){var o=r[i];g.set(e,o.node);for(var s=0,a=o.observers.length;s<a&&!m.get(e);s++)o.observers[s].data.call(o.node,e)}g.delete(e),I(e)}}}}function w(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=!!n.capture,s=o?p:h,a=s[e];a||(a=new i,s[e]=a,document.addEventListener(e,V,o)),a.add(t,r)}function L(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=!!i.capture,o=n?p:h,s=o[e];s&&(s.remove(t,r),s.size||(delete o[e],document.removeEventListener(e,V,n)))}function x(e,t,r){return e.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:r}))}},72177:(e,t,r)=>{r.d(t,{t:()=>l});var i=r(21232),n=r(21403),o=r(97797);function s(e){let t=e.getAttribute("data-required-value"),r=e.getAttribute("data-required-value-prefix");if(e.value===t)e.setCustomValidity("");else{let i=t;r&&(i=r+i),e.setCustomValidity(i)}}(0,i.eC)("[data-required-value]",function(e){s(e.currentTarget)}),(0,o.on)("change","[data-required-value]",function(e){let t=e.currentTarget;s(t),l(t.form)}),(0,i.eC)("[data-required-trimmed]",function(e){let t=e.currentTarget;""===t.value.trim()?t.setCustomValidity(t.getAttribute("data-required-trimmed")):t.setCustomValidity("")}),(0,o.on)("change","[data-required-trimmed]",function(e){let t=e.currentTarget;""===t.value.trim()?t.setCustomValidity(t.getAttribute("data-required-trimmed")):t.setCustomValidity(""),l(t.form)}),(0,i.uE)("input[pattern],input[required],textarea[required],input[data-required-change],textarea[data-required-change],input[data-required-value],textarea[data-required-value]",e=>{let t=e.checkValidity();function r(){let r=e.checkValidity();r!==t&&e.form&&l(e.form),t=r}e.addEventListener("input",r),e.addEventListener("blur",function t(){e.removeEventListener("input",r),e.removeEventListener("blur",t)})});let a=new WeakMap;function l(e){let t=e.checkValidity();for(let r of e.querySelectorAll("button[data-disable-invalid]"))r.disabled=!t}(0,n.lB)("button[data-disable-invalid]",{constructor:HTMLButtonElement,initialize(e){let t=e.form;t&&(a.get(t)||(t.addEventListener("change",()=>l(t)),a.set(t,!0)),e.disabled=!t.checkValidity())}}),(0,n.lB)("input[data-required-change], textarea[data-required-change]",function(e){let t="radio"===e.type&&e.form?e.form.elements.namedItem(e.name).value:null;function r(r){let i=e.form;if(r&&"radio"===e.type&&i&&t)for(let r of i.elements.namedItem(e.name))r instanceof HTMLInputElement&&r.setCustomValidity(e.value===t?"unchanged":"");else e.setCustomValidity(e.value===(t||e.defaultValue)?"unchanged":"")}e.addEventListener("input",r),e.addEventListener("change",r),r(),e.form&&l(e.form)}),document.addEventListener("reset",function(e){if(e.target instanceof HTMLFormElement){let t=e.target;setTimeout(()=>l(t))}})},96386:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var i=r(39595),n=r(45062),o=r(72177);function s(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}let a={AV:{N:!0,A:!0,L:!0,P:!0},AC:{L:!0,H:!0},PR:{N:!0,L:!0,H:!0},UI:{N:!0,R:!0},S:{U:!0,C:!0},C:{N:!0,L:!0,H:!0},I:{N:!0,L:!0,H:!0},A:{N:!0,L:!0,H:!0}},l=class SeveritySelectionElement extends HTMLElement{buildCVSS3ErrorMessage(e){if(""===e)return this.vectorStringError.getAttribute("data-empty-cvss-error-message")||"";if(!/^CVSS:3\.\d+(\/[^:]+:[^:]+){8}$/.test(e))return this.vectorStringError.getAttribute("data-error-message")||"";for(let t of e.split("/").slice(1)){let[e,r]=t.split(":");if(!a[e])return(this.vectorStringError.getAttribute("data-invalid-metric-error-message")||"").replace("{}",e);if(!a[e][r])return(this.vectorStringError.getAttribute("data-invalid-metric-value-error-message")||"").replace("{}",r).replace("{}",e)}return""}connectedCallback(){setTimeout(()=>{"cvss"===this.severitySelectElement.value?this.showSeverityCalculator():this.severitySelectElement.value&&(this.severityScoreElement.severity=this.severitySelectElement.value)},0),this.handleVectorStringInput()}toggleSeverityCalculator(e){"cvss"===e?(this.vectorStringInput.hasAttribute("data-previous-value")?(this.vectorStringInput.value=this.vectorStringInput.getAttribute("data-previous-value"),this.handleVectorStringInput(),this.handleVectorStringBlur()):this.severityScoreElement.setPending(),this.showSeverityCalculator()):(""!==this.vectorStringInput.value&&(this.vectorStringInput.setAttribute("data-previous-value",this.vectorStringInput.value),this.vectorStringInput.value=""),""===e?this.severityScoreElement.setPending():this.severityScoreElement.severity=e,this.hideSeverityCalculator(),this.severityCalculatorElement.deselectAll())}async handleMetricSelectionChange(){this.selectSeverityCvss(),this.vectorStringInput.removeAttribute("data-previous-value"),this.regenerateVectorString(),this.hideFormGroupError(this.vectorStringFieldElement),this.isValidCVSS3(this.vectorStringInput.value)?(this.vectorStringInput.setCustomValidity(""),await this.severityScoreElement.calculateScore(this.vectorStringInput.value)):(this.vectorStringInput.setCustomValidity(this.vectorStringErrorMessage),this.severityScoreElement.setPending()),(0,o.t)(this.vectorStringInput.form)}handleSeveritySelectChange(e){let{value:t}=e.target;this.toggleSeverityCalculator(t)}async handleVectorStringBlur(){("cvss"===this.severitySelectElement.value||""!==this.vectorStringInput.value)&&(this.selectSeverityCvss(),this.vectorStringInput.removeAttribute("data-previous-value"),this.validateVectorStringInput()?await this.severityScoreElement.calculateScore(this.vectorStringInput.value):this.severityScoreElement.setPending())}handleVectorStringInput(){let e=this.vectorStringInput.value.split("/").slice(1).reduce((e,t)=>{let[r,i]=t.split(":");return{...e,[r]:i}},{});for(let t of this.severityCalculatorElement.metricSelectionElements){let r=e[t.metricCode];t.selectFromCode(r)}}hideFormGroupError(e){e.classList.contains("errored")&&e.classList.remove("errored")}hideSeverityCalculator(){this.severityCalculatorElement.collapse(),this.vectorStringInput.required=!1,this.hideFormGroupError(this.vectorStringFieldElement),this.vectorStringInput.setCustomValidity(""),(0,o.t)(this.vectorStringInput.form)}isValidCVSS3(e){return""===this.buildCVSS3ErrorMessage(e)}regenerateVectorString(){let e="CVSS:3.1";for(let t of this.severityCalculatorElement.metricSelectionElements){let r=t.metricCode,i=t.selectedValue||"_";e+=`/${r}:${i}`}this.vectorStringInput.value=e}resetSeveritySelectElement(){for(let e=0;e<this.severitySelectElement.options.length;e++)if(this.severitySelectElement.options[e].defaultSelected){this.severitySelectElement.selectedIndex=e;break}}selectSeverityCvss(){"cvss"!==this.severitySelectElement.value&&(this.severitySelectElement.value="cvss")}showFormGroupError(e){e.classList.contains("errored")||e.classList.add("errored")}showSeverityCalculator(){this.severityCalculatorElement.expand(),this.vectorStringInput.required=!0,""!==this.vectorStringInput.value&&this.validateVectorStringInput()}validateVectorStringInput(){let e=this.buildCVSS3ErrorMessage(this.vectorStringInput.value);return e?(this.vectorStringError.textContent=e,this.showFormGroupError(this.vectorStringFieldElement),this.vectorStringInput.setCustomValidity(this.vectorStringErrorMessage)):(this.hideFormGroupError(this.vectorStringFieldElement),this.vectorStringInput.setCustomValidity("")),(0,o.t)(this.vectorStringInput.form),!e}get vectorStringErrorMessage(){return this.vectorStringError.getAttribute("data-error-message")||"Please fill out this field with a valid vector string"}};s([i.aC],l.prototype,"severityCalculatorElement",void 0),s([i.aC],l.prototype,"severityScoreElement",void 0),s([i.aC],l.prototype,"severitySelectElement",void 0),s([i.aC],l.prototype,"vectorStringError",void 0),s([i.aC],l.prototype,"vectorStringFieldElement",void 0),s([i.aC],l.prototype,"vectorStringInput",void 0),s([(0,n.s)(100)],l.prototype,"handleVectorStringInput",null),l=s([i.p_],l)},21232:(e,t,r)=>{r.d(t,{Ff:()=>l,eC:()=>u,uE:()=>a});var i=r(6986);let n=!1,o=new i.A;function s(e){let t=e.target;if(t instanceof HTMLElement&&t.nodeType!==Node.DOCUMENT_NODE)for(let e of o.matches(t))e.data.call(null,t)}function a(e,t){n||(n=!0,document.addEventListener("focus",s,!0)),o.add(e,t),document.activeElement instanceof HTMLElement&&document.activeElement.matches(e)&&t(document.activeElement)}function l(e,t,r){function i(t){let n=t.currentTarget;n&&(n.removeEventListener(e,r),n.removeEventListener("blur",i))}a(t,function(t){t.addEventListener(e,r),t.addEventListener("blur",i)})}function u(e,t){function r(e){let{currentTarget:i}=e;i&&(i.removeEventListener("input",t),i.removeEventListener("blur",r))}a(e,function(e){e.addEventListener("input",t),e.addEventListener("blur",r)})}}}]);
//# sourceMappingURL=app_components_advisories_severity-selection-element_ts-acc7b437031c.js.map