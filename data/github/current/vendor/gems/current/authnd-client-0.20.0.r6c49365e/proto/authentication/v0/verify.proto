syntax = "proto3";
package github.authentication.v0;

option go_package = "client/proto/authentication/v0";
option ruby_package = "Authnd::Proto";

import "authentication/v0/credentials.proto";
import "google/protobuf/timestamp.proto";

// VerifyRequest captures the parameters needed to verify a credential.
message VerifyRequest {
	repeated Credentials candidates = 1;
}

message VerifyResponse {
	// Result is a high level result of the verification attempt.
	enum Result {
		// RESULT_UNKNOWN
		// Should never be used because it is the zero value for this
		// field and will be invisible when encoded into JSON.
		RESULT_UNKNOWN = 0;
		// The token was verified as a valid, working credential.
		RESULT_SUCCESS = 1;
		// The token was could not be found and verified.
		RESULT_NOT_FOUND = 2;
		// The token was identified as being expired.
		RESULT_EXPIRED = 3;
		// The token was identified as being revoked.
		RESULT_REVOKED = 4;
		// Indicates that the requested operation is not supported.
		RESULT_FAILED_NOT_SUPPORTED = 5;
		// The provided credential is malformed.
		RESULT_FAILED_CREDENTIAL_INVALID = 6;
		// validation failed for unknown reason. Look at the message field for more details.
		RESULT_FAILED_GENERIC = -1;
	}

	// is_verified is true if the credential is a valid, working credential.
	bool is_verified = 1;
	// actor_id is the id (user_id) of the user that owns the credential.
	int64 actor_id = 2;
	// credential_id is the id (credential_id) of the credential.
	int64 credential_id = 3;
  	// An additional message that corresponds to the result.
	string message = 4;
	// VerificationResult is the overall result of verifying the credential.
	Result result = 5;
	// access_id is the id of the access model in dotcom associated with this token.
	int64 access_id = 6;
	// The time when the credential expires.
	google.protobuf.Timestamp expires_at = 7;
}

message BatchVerifyResponse {
	// results of all the individual verify requests.
	repeated VerifyResponse responses = 1;
}