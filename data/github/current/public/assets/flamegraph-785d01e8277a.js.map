{"version":3,"file":"flamegraph-xxxxxxxxxxxx.js","mappings":"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","sources":["app/assets/modules/github/graphs/flamegraph.ts","app/assets/modules/flamegraph.ts"],"sourcesContent":["// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-nocheck\n/* eslint eslint-comments/no-use: off */\n/* eslint @typescript-eslint/no-shadow: off */\n\nclass EventSource {\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  eventListeners: {[key: string]: Function[]}\n\n  constructor() {\n    this.eventListeners = {}\n  }\n\n  on(name, callback) {\n    let listeners = this.eventListeners[name]\n    if (!listeners) listeners = this.eventListeners[name] = []\n    listeners.push(callback)\n  }\n\n  dispatch(name, data) {\n    const listeners = this.eventListeners[name] || []\n    for (const c of listeners) {\n      requestAnimationFrame(() => c(data))\n    }\n  }\n}\n\nclass CanvasView extends EventSource {\n  canvas: HTMLCanvasElement\n  resizeRequestID?: AnimationFrameID\n  repaintRequestID?: AnimationFrameID\n  width: number\n  height: number\n\n  constructor(canvas: HTMLCanvasElement) {\n    super()\n    this.canvas = canvas\n    this.width = 0\n    this.height = 0\n  }\n\n  setDimensions(width, height) {\n    if (this.resizeRequestID != null) cancelAnimationFrame(this.resizeRequestID)\n\n    this.resizeRequestID = requestAnimationFrame(() => {\n      this.setDimensionsNow(width, height)\n    })\n  }\n\n  setDimensionsNow(width, height) {\n    if (width === this.width && height === this.height) return\n\n    this.width = width\n    this.height = height\n\n    this.canvas.style.width = `${width}px`\n    this.canvas.style.height = `${height}px`\n\n    const ratio = window.devicePixelRatio || 1\n    this.canvas.width = width * ratio\n    this.canvas.height = height * ratio\n\n    const ctx = this.canvas.getContext('2d')\n    ctx.setTransform(1, 0, 0, 1, 0, 0)\n    ctx.scale(ratio, ratio)\n\n    this.repaintNow()\n  }\n\n  paint() {\n    // noop\n  }\n\n  scheduleRepaint() {\n    if (this.repaintRequestID != null) return\n\n    this.repaintRequestID = requestAnimationFrame(() => {\n      this.repaintRequestID = null\n      this.repaintNow()\n    })\n  }\n\n  repaintNow() {\n    const ctx = this.canvas.getContext('2d')\n    ctx.clearRect(0, 0, this.width, this.height)\n    this.paint()\n\n    if (this.repaintRequestID != null) {\n      cancelAnimationFrame(this.repaintRequestID)\n      this.repaintRequestID = null\n    }\n  }\n}\n\ninterface Frame {\n  file: string\n  frame: string\n  frame_id: number\n  gemName: string\n  topFrame: {\n    exclusiveCount: number\n  }\n  width: number\n  x: number\n  y: number\n}\n\ninterface Data {\n  frames: string[]\n  samples: string[]\n  color: [number, number, number]\n}\n\nclass Flamechart extends CanvasView {\n  showLabels: boolean\n  data: Frame[]\n  dataRange: {\n    maxX: number\n    maxY: number\n    minX: number\n    minY: number\n  }\n  info: Record<string, Data>\n  viewport: {\n    x: number\n    y: number\n    width: number\n    height: number\n  }\n\n  constructor(canvas, data, dataRange, info) {\n    super(canvas)\n\n    this.data = data\n    this.dataRange = dataRange\n    this.info = info\n\n    this.viewport = {\n      x: dataRange.minX,\n      y: dataRange.minY,\n      width: dataRange.maxX - dataRange.minX,\n      height: dataRange.maxY - dataRange.minY,\n    }\n  }\n\n  xScale(x) {\n    return this.widthScale(x - this.viewport.x)\n  }\n\n  yScale(y) {\n    return this.heightScale(y - this.viewport.y)\n  }\n\n  widthScale(width) {\n    return (width * this.width) / this.viewport.width\n  }\n\n  heightScale(height) {\n    return (height * this.height) / this.viewport.height\n  }\n\n  frameRect(f) {\n    return {\n      x: f.x,\n      y: f.y,\n      width: f.width,\n      height: 1,\n    }\n  }\n\n  dataToCanvas(r) {\n    return {\n      x: this.xScale(r.x),\n      y: this.yScale(r.y),\n      width: this.widthScale(r.width),\n      height: this.heightScale(r.height),\n    }\n  }\n\n  setViewport(viewport) {\n    if (\n      this.viewport.x === viewport.x &&\n      this.viewport.y === viewport.y &&\n      this.viewport.width === viewport.width &&\n      this.viewport.height === viewport.height\n    )\n      return\n\n    this.viewport = viewport\n\n    this.scheduleRepaint()\n\n    this.dispatch('viewportchanged', {current: viewport})\n  }\n\n  paint(opacity?: number, frames?: $Iterable<unknown, unknown, unknown>, gemName) {\n    const ctx = this.canvas.getContext('2d')\n\n    ctx.strokeStyle = 'rgba(0, 0, 0, 0.2)'\n\n    let characterWidth = 0\n    if (this.showLabels) {\n      ctx.textBaseline = 'middle'\n      ctx.font = `11px ${getComputedStyle(this.canvas).fontFamily}`\n      // W tends to be one of the widest characters (and if the font is truly\n      // fixed-width then any character will do).\n      characterWidth = ctx.measureText('WWWW').width / 4\n    }\n\n    if (opacity == null) opacity = 1\n\n    frames = frames || this.data\n\n    const blocksByColor = {}\n\n    for (const f of frames || []) {\n      if (gemName && f.gemName !== gemName) continue\n\n      const r = this.dataToCanvas(this.frameRect(f))\n\n      if (r.x >= this.width || r.y >= this.height || r.x + r.width <= 0 || r.y + r.height <= 0) {\n        continue\n      }\n\n      const i = this.info[f.frame_id]\n      const color = colorString(i.color, opacity)\n      let colorBlocks = blocksByColor[color]\n      if (!colorBlocks) colorBlocks = blocksByColor[color] = []\n      colorBlocks.push({rect: r, text: f.frame})\n    }\n\n    const textBlocks = []\n\n    for (const color of Object.keys(blocksByColor)) {\n      ctx.fillStyle = color\n\n      for (const block of blocksByColor[color]) {\n        if (opacity < 1) ctx.clearRect(block.rect.x, block.rect.y, block.rect.width, block.rect.height)\n\n        ctx.fillRect(block.rect.x, block.rect.y, block.rect.width, block.rect.height)\n\n        if (block.rect.width > 4 && block.rect.height > 4)\n          ctx.strokeRect(block.rect.x, block.rect.y, block.rect.width, block.rect.height)\n\n        if (!this.showLabels || block.rect.width / characterWidth < 4) continue\n\n        textBlocks.push(block)\n      }\n    }\n\n    ctx.fillStyle = '#000'\n    for (const block of textBlocks) {\n      let text = block.text\n      const textRect = Object.assign({}, block.rect)\n      textRect.x += 1\n      textRect.width -= 2\n      if (textRect.width < text.length * characterWidth * 0.75)\n        text = centerTruncate(block.text, Math.floor(textRect.width / characterWidth))\n      ctx.fillText(text, textRect.x, textRect.y + textRect.height / 2, textRect.width)\n    }\n  }\n\n  frameAtPoint(x, y) {\n    return this.data.find(d => {\n      const r = this.dataToCanvas(this.frameRect(d))\n\n      return r.x <= x && r.x + r.width >= x && r.y <= y && r.y + r.height >= y\n    })\n  }\n}\n\nclass MainFlamechart extends Flamechart {\n  dragging: boolean\n  dragInfo: {\n    mouse: {x: number; y: number}\n    viewport: {x: number; y: number}\n  }\n  hoveredFrame?: Frame\n\n  constructor(canvas, data, dataRange, info) {\n    super(canvas, data, dataRange, info)\n\n    this.showLabels = true\n\n    canvas.addEventListener('mousedown', (event: MouseEvent) => this.onMouseDown(event))\n    canvas.addEventListener('mousemove', (event: MouseEvent) => this.onMouseMove(event))\n    canvas.addEventListener('mouseout', () => this.onMouseOut())\n    // eslint-disable-next-line github/require-passive-events\n    canvas.addEventListener('wheel', (event: WheelEvent) => this.onWheel(event), {passive: false})\n  }\n\n  setDimensionsNow(width, height) {\n    const viewport = Object.assign({}, this.viewport)\n    viewport.height = height / 16\n    this.setViewport(viewport)\n\n    super.setDimensionsNow(width, height)\n  }\n\n  onMouseDown(e) {\n    if (e.button !== 0) return\n\n    captureMouse({\n      mouseup: this.onMouseUp.bind(this),\n      mousemove: this.onMouseMove.bind(this),\n    })\n\n    const clientRect = this.canvas.getBoundingClientRect()\n    const currentX = e.clientX - clientRect.left\n    const currentY = e.clientY - clientRect.top\n\n    this.dragging = true\n    this.dragInfo = {\n      mouse: {x: currentX, y: currentY},\n      viewport: {x: this.viewport.x, y: this.viewport.y},\n    }\n\n    e.preventDefault()\n  }\n\n  onMouseUp(e) {\n    if (!this.dragging) return\n\n    releaseCapture()\n\n    this.dragging = false\n    e.preventDefault()\n  }\n\n  onMouseMove(e) {\n    const clientRect = this.canvas.getBoundingClientRect()\n    const currentX = e.clientX - clientRect.left\n    const currentY = e.clientY - clientRect.top\n\n    if (this.dragging) {\n      const viewport = Object.assign({}, this.viewport)\n      viewport.x = this.dragInfo.viewport.x - ((currentX - this.dragInfo.mouse.x) * viewport.width) / this.width\n      viewport.y = this.dragInfo.viewport.y - ((currentY - this.dragInfo.mouse.y) * viewport.height) / this.height\n      viewport.x = Math.min(this.dataRange.maxX - viewport.width, Math.max(this.dataRange.minX, viewport.x))\n      viewport.y = Math.min(this.dataRange.maxY - viewport.height, Math.max(this.dataRange.minY, viewport.y))\n      this.setViewport(viewport)\n      return\n    }\n\n    const frame = this.frameAtPoint(currentX, currentY)\n    this.setHoveredFrame(frame)\n  }\n\n  onMouseOut() {\n    if (this.dragging) return\n\n    this.setHoveredFrame(null)\n  }\n\n  onWheel(e) {\n    const deltaX = e.deltaX\n    let deltaY = e.deltaY\n\n    if (e.shiftKey) {\n      if (/Macintosh/.test(navigator.userAgent)) {\n        // Assume that most Mac users have \"Scroll direction: Natural\" enabled.\n        deltaY *= -1\n      }\n\n      const mouseWheelZoomSpeed = 1 / 120\n      this.handleZoomGesture(Math.pow(1.2, -(deltaY || deltaX) * mouseWheelZoomSpeed), e.offsetX)\n      e.preventDefault()\n      return\n    }\n\n    const viewport = Object.assign({}, this.viewport)\n    viewport.x += (deltaX * viewport.width) / (this.dataRange.maxX - this.dataRange.minX)\n    viewport.x = Math.min(this.dataRange.maxX - viewport.width, Math.max(this.dataRange.minX, viewport.x))\n    viewport.y += ((deltaY / 8) * viewport.height) / (this.dataRange.maxY - this.dataRange.minY)\n    viewport.y = Math.min(this.dataRange.maxY - viewport.height, Math.max(this.dataRange.minY, viewport.y))\n    this.setViewport(viewport)\n    e.preventDefault()\n  }\n\n  handleZoomGesture(zoom, originX) {\n    const viewport = Object.assign({}, this.viewport)\n    const ratioX = originX / this.width\n\n    const newWidth = Math.min(viewport.width / zoom, this.dataRange.maxX - this.dataRange.minX)\n    viewport.x = Math.max(this.dataRange.minX, viewport.x + (viewport.width - newWidth) * ratioX)\n    viewport.width = Math.min(newWidth, this.dataRange.maxX - viewport.x)\n\n    this.setViewport(viewport)\n  }\n\n  setHoveredFrame(frame) {\n    if (frame === this.hoveredFrame) return\n\n    const previous = this.hoveredFrame\n    this.hoveredFrame = frame\n\n    this.dispatch('hoveredframechanged', {previous, current: this.hoveredFrame})\n  }\n}\n\ninterface Rect {\n  x: number\n  y: number\n  width: number\n  height: number\n}\n\nclass OverviewFlamechart extends Flamechart {\n  container: HTMLElement\n  viewportOverlay: HTMLElement\n  viewportOverlayRect: Rect\n  dragging: unknown\n  dragStartX: number\n  dragCurrentX: number\n  overlayDragging: boolean\n  overlayDragInfo: unknown\n\n  constructor(container, viewportOverlay, data, dataRange, info) {\n    const canvas = container.querySelector<HTMLCanvasElement>('canvas.overview')!\n    super(canvas, data, dataRange, info)\n\n    this.container = container\n    this.showLabels = false\n    this.viewportOverlay = viewportOverlay\n\n    canvas.addEventListener('mousedown', (event: MouseEvent) => this.onMouseDown(event))\n\n    this.viewportOverlay.addEventListener('mousedown', (event: MouseEvent) => this.onOverlayMouseDown(event))\n  }\n\n  setViewportOverlayRect(r) {\n    this.viewportOverlayRect = r\n\n    r = this.dataToCanvas(r)\n    r.width = Math.max(2, r.width)\n    r.height = Math.max(2, r.height)\n\n    if ('transform' in this.viewportOverlay.style) {\n      this.viewportOverlay.style.transform = `translate(${r.x}px, ${r.y}px) scale(${r.width}, ${r.height})`\n    } else {\n      this.viewportOverlay.style.left = `${r.x}px`\n      this.viewportOverlay.style.top = `${r.y}px`\n      this.viewportOverlay.style.width = `${r.width}px`\n      this.viewportOverlay.style.height = `${r.height}px`\n    }\n  }\n\n  onMouseDown(e) {\n    captureMouse({\n      mouseup: this.onMouseUp.bind(this),\n      mousemove: this.onMouseMove.bind(this),\n    })\n\n    this.dragging = true\n    this.dragStartX = e.clientX - this.canvas.getBoundingClientRect().left\n\n    this.handleDragGesture(e)\n\n    e.preventDefault()\n  }\n\n  onMouseUp(e) {\n    if (!this.dragging) return\n\n    releaseCapture()\n\n    this.dragging = false\n\n    this.handleDragGesture(e)\n\n    e.preventDefault()\n  }\n\n  onMouseMove(e) {\n    if (!this.dragging) return\n\n    this.handleDragGesture(e)\n\n    e.preventDefault()\n  }\n\n  handleDragGesture(e) {\n    const clientRect = this.canvas.getBoundingClientRect()\n    const currentX = e.clientX - clientRect.left\n    const currentY = e.clientY - clientRect.top\n\n    if (this.dragCurrentX === currentX) return\n\n    this.dragCurrentX = currentX\n\n    const minX = Math.min(this.dragStartX, this.dragCurrentX)\n    const maxX = Math.max(this.dragStartX, this.dragCurrentX)\n\n    const rect = Object.assign({}, this.viewportOverlayRect)\n    rect.x = (minX / this.width) * this.viewport.width + this.viewport.x\n    rect.width = Math.max(this.viewport.width / 1000, ((maxX - minX) / this.width) * this.viewport.width)\n\n    rect.y = Math.max(\n      this.viewport.y,\n      Math.min(\n        this.viewport.height - this.viewport.y,\n        (currentY / this.height) * this.viewport.height + this.viewport.y - rect.height / 2,\n      ),\n    )\n\n    this.setViewportOverlayRect(rect)\n    this.dispatch('overlaychanged', {current: this.viewportOverlayRect})\n  }\n\n  onOverlayMouseDown(e) {\n    captureMouse({\n      mouseup: this.onOverlayMouseUp.bind(this),\n      mousemove: this.onOverlayMouseMove.bind(this),\n    })\n\n    this.overlayDragging = true\n    this.overlayDragInfo = {\n      mouse: {x: e.clientX, y: e.clientY},\n      rect: Object.assign({}, this.viewportOverlayRect),\n    }\n    this.viewportOverlay.classList.add('moving')\n\n    this.handleOverlayDragGesture(e)\n\n    e.preventDefault()\n  }\n\n  onOverlayMouseUp(e) {\n    if (!this.overlayDragging) return\n\n    releaseCapture()\n\n    this.overlayDragging = false\n    this.viewportOverlay.classList.remove('moving')\n\n    this.handleOverlayDragGesture(e)\n\n    e.preventDefault()\n  }\n\n  onOverlayMouseMove(e) {\n    if (!this.overlayDragging) return\n\n    this.handleOverlayDragGesture(e)\n\n    e.preventDefault()\n  }\n\n  handleOverlayDragGesture(e) {\n    const deltaX = ((e.clientX - this.overlayDragInfo.mouse.x) / this.width) * this.viewport.width\n    const deltaY = ((e.clientY - this.overlayDragInfo.mouse.y) / this.height) * this.viewport.height\n\n    const rect = Object.assign({}, this.overlayDragInfo.rect)\n    rect.x += deltaX\n    rect.y += deltaY\n    rect.x = Math.max(this.viewport.x, Math.min(this.viewport.x + this.viewport.width - rect.width, rect.x))\n    rect.y = Math.max(this.viewport.y, Math.min(this.viewport.y + this.viewport.height - rect.height, rect.y))\n\n    this.setViewportOverlayRect(rect)\n    this.dispatch('overlaychanged', {current: this.viewportOverlayRect})\n  }\n}\n\nclass FlamegraphView {\n  data: unknown\n  info: unknown\n  dataRange: unknown\n  mainChart: MainFlamechart\n  overview: OverviewFlamechart\n  infoElement: HTMLElement\n  hoveredGemName: unknown\n\n  constructor(data, info, sortedGems) {\n    this.data = data\n    this.info = info\n    this.dataRange = this.computeDataRange()\n    const mainCanvas = document.querySelector<HTMLCanvasElement>('canvas.flamegraph')!\n    this.mainChart = new MainFlamechart(mainCanvas, data, this.dataRange, info)\n    this.overview = new OverviewFlamechart(\n      document.querySelector('.overview-container'),\n      document.querySelector('.overview-viewport-overlay'),\n      data,\n      this.dataRange,\n      info,\n    )\n    this.infoElement = document.querySelector<HTMLElement>('.info')!\n\n    this.mainChart.on('hoveredframechanged', this.onHoveredFrameChanged.bind(this))\n    this.mainChart.on('viewportchanged', this.onViewportChanged.bind(this))\n    this.overview.on('overlaychanged', this.onOverlayChanged.bind(this))\n\n    const legend = document.querySelector<Element>('.legend')!\n    this.renderLegend(legend, sortedGems)\n\n    legend.addEventListener('mousemove', (event: MouseEvent) => this.onLegendMouseMove(event))\n    legend.addEventListener('mouseout', () => this.onLegendMouseOut())\n\n    /* eslint-disable-next-line github/prefer-observers */\n    window.addEventListener('resize', () => this.updateDimensions())\n\n    this.updateDimensions()\n  }\n\n  updateDimensions() {\n    const margin = {top: 10, right: 10, bottom: 10, left: 10}\n    const width = window.innerWidth - 200 - margin.left - margin.right\n    const mainChartHeight = Math.ceil(window.innerHeight * 0.8) - margin.top - margin.bottom\n    const overviewHeight = Math.floor(window.innerHeight * 0.2) - 60 - margin.top - margin.bottom\n\n    this.mainChart.setDimensions(width + margin.left + margin.right, mainChartHeight + margin.top + margin.bottom)\n    this.overview.setDimensions(width + margin.left + margin.right, overviewHeight + margin.top + margin.bottom)\n    this.overview.setViewportOverlayRect(this.mainChart.viewport)\n  }\n\n  computeDataRange() {\n    const range = {minX: Infinity, minY: Infinity, maxX: -Infinity, maxY: -Infinity}\n    for (const d of this.data) {\n      range.minX = Math.min(range.minX, d.x)\n      range.minY = Math.min(range.minY, d.y)\n      range.maxX = Math.max(range.maxX, d.x + d.width)\n      range.maxY = Math.max(range.maxY, d.y + 1)\n    }\n\n    return range\n  }\n\n  onHoveredFrameChanged(data) {\n    this.updateInfo(data.current)\n\n    if (data.previous) this.repaintFrames(1, this.info[data.previous.frame_id].frames)\n\n    if (data.current) this.repaintFrames(0.5, this.info[data.current.frame_id].frames)\n  }\n\n  repaintFrames(opacity, frames) {\n    this.mainChart.paint(opacity, frames)\n    this.overview.paint(opacity, frames)\n  }\n\n  updateInfo(frame) {\n    if (!frame) {\n      this.infoElement.style.backgroundColor = ''\n      this.infoElement.querySelector<HTMLElement>('.frame')!.textContent = ''\n      this.infoElement.querySelector<HTMLElement>('.file')!.textContent = ''\n      this.infoElement.querySelector<HTMLElement>('.samples')!.textContent = ''\n      this.infoElement.querySelector<HTMLElement>('.exclusive')!.textContent = ''\n      return\n    }\n\n    const i = this.info[frame.frame_id]\n    const shortFile = frame.file.replace(/^.+\\/(gems|app|lib|config|jobs)/, '$1')\n    const sData = this.samplePercentRaw(i.samples.length, frame.topFrame ? frame.topFrame.exclusiveCount : 0)\n\n    this.infoElement.style.backgroundColor = colorString(i.color, 1)\n    this.infoElement.querySelector<HTMLElement>('.frame')!.textContent = frame.frame\n    this.infoElement.querySelector<HTMLElement>('.file')!.textContent = shortFile\n    this.infoElement.querySelector<HTMLElement>('.samples')!.textContent =\n      `${sData[0].toString()} samples (${sData[1].toString()}%)`\n    if (sData[3]) {\n      this.infoElement.querySelector<HTMLElement>('.exclusive')!.textContent =\n        `${sData[2].toString()} exclusive (${sData[3].toString()}%)`\n    } else {\n      this.infoElement.querySelector<HTMLElement>('.exclusive')!.textContent = ''\n    }\n  }\n\n  samplePercentRaw(samples, exclusive) {\n    let ret = [samples, ((samples / this.dataRange.maxX) * 100).toFixed(2)]\n    if (exclusive != null) ret = ret.concat([exclusive, ((exclusive / this.dataRange.maxX) * 100).toFixed(2)])\n    return ret\n  }\n\n  onViewportChanged(data) {\n    this.overview.setViewportOverlayRect(data.current)\n  }\n\n  onOverlayChanged(data) {\n    this.mainChart.setViewport(data.current)\n  }\n\n  renderLegend(element, sortedGems) {\n    const fragment = document.createDocumentFragment()\n\n    for (const gem of sortedGems) {\n      const sData = this.samplePercentRaw(gem.samples.length)\n      const node = document.createElement('div')\n      node.className = 'legend-gem'\n      node.setAttribute('data-gem-name', gem.name)\n      node.style.backgroundColor = colorString(gem.color, 1)\n\n      const span = document.createElement('span')\n      span.style.float = 'right'\n      span.textContent = `${sData[0].toString()}x`\n      span.appendChild(document.createElement('br'))\n      span.appendChild(document.createTextNode(`${sData[1].toString()}%`))\n      node.appendChild(span)\n\n      const name = document.createElement('div')\n      name.className = 'name'\n      name.textContent = gem.name\n      name.appendChild(document.createElement('br'))\n      name.appendChild(document.createTextNode('\\u00a0'))\n      node.appendChild(name)\n\n      fragment.appendChild(node)\n    }\n\n    element.appendChild(fragment)\n  }\n\n  onLegendMouseMove(event) {\n    const gemElement = event.target.closest('.legend-gem')\n    const gemName = gemElement.getAttribute('data-gem-name')\n\n    if (this.hoveredGemName === gemName) return\n\n    if (this.hoveredGemName) {\n      this.mainChart.paint(1, null, this.hoveredGemName)\n      this.overview.paint(1, null, this.hoveredGemName)\n    }\n\n    this.hoveredGemName = gemName\n\n    this.mainChart.paint(0.5, null, this.hoveredGemName)\n    this.overview.paint(0.5, null, this.hoveredGemName)\n  }\n\n  onLegendMouseOut() {\n    if (!this.hoveredGemName) return\n\n    this.mainChart.paint(1, null, this.hoveredGemName)\n    this.overview.paint(1, null, this.hoveredGemName)\n    this.hoveredGemName = null\n  }\n}\n\nlet capturingListeners = null\nfunction captureMouse(listeners) {\n  if (capturingListeners) releaseCapture()\n\n  for (const name in listeners) document.addEventListener(name, listeners[name], true)\n  capturingListeners = listeners\n}\n\nfunction releaseCapture() {\n  if (!capturingListeners) return\n\n  for (const name in capturingListeners) document.removeEventListener(name, capturingListeners[name], true)\n  capturingListeners = null\n}\n\nfunction guessGem(frame) {\n  let split = frame.split('/gems/')\n  if (split.length === 1) {\n    split = frame.split('/app/')\n    if (split.length === 1) {\n      split = frame.split('/lib/')\n    } else {\n      return split[split.length - 1].split('/')[0]\n    }\n\n    split = split[Math.max(split.length - 2, 0)].split('/')\n    return split[split.length - 1].split(':')[0]\n  } else {\n    return split[split.length - 1].split('/')[0].split('-', 2)[0]\n  }\n}\n\nfunction color() {\n  const r = parseInt(205 + Math.random() * 50)\n  const g = parseInt(Math.random() * 230)\n  const b = parseInt(Math.random() * 55)\n  return [r, g, b]\n}\n\n// http://stackoverflow.com/a/7419630\nfunction rainbow(numOfSteps, step) {\n  // This function generates vibrant, \"evenly spaced\" colours (i.e. no clustering). This is ideal for creating easily distiguishable vibrant markers in Google Maps and other apps.\n  // Adam Cole, 2011-Sept-14\n  // HSV to RBG adapted from: http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript\n\n  // Unfortunately flow's definite assignment doesn't handle the switch statement properly.\n  let r = 0\n  let g = 0\n  let b = 0\n  const h = step / numOfSteps\n  const i = ~~(h * 6)\n  const f = h * 6 - i\n  const q = 1 - f\n  switch (i % 6) {\n    case 0:\n      r = 1\n      g = f\n      b = 0\n      break\n    case 1:\n      r = q\n      g = 1\n      b = 0\n      break\n    case 2:\n      r = 0\n      g = 1\n      b = f\n      break\n    case 3:\n      r = 0\n      g = q\n      b = 1\n      break\n    case 4:\n      r = f\n      g = 0\n      b = 1\n      break\n    case 5:\n      r = 1\n      g = 0\n      b = q\n      break\n  }\n  return [Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255)]\n}\n\nfunction colorString(color, opacity) {\n  if (opacity == null) opacity = 1\n  return `rgba(${color.join(',')},${opacity})`\n}\n\n// http://stackoverflow.com/questions/1960473/unique-values-in-an-array\nfunction getUnique(orig) {\n  const o = {}\n  for (let i = 0; i < orig.length; i++) o[orig[i]] = 1\n  return Object.keys(o)\n}\n\nfunction centerTruncate(text, maxLength) {\n  const charactersToKeep = maxLength - 1\n  if (charactersToKeep <= 0) return ''\n  if (text.length <= charactersToKeep) return text\n\n  const prefixLength = Math.ceil(charactersToKeep / 2)\n  const suffixLength = charactersToKeep - prefixLength\n  const prefix = text.substr(0, prefixLength)\n  const suffix = suffixLength > 0 ? text.substr(-suffixLength) : ''\n\n  return [prefix, '\\u2026', suffix].join('')\n}\n\nexport default function flamegraph(data: unknown): void {\n  const info = {}\n  for (const d of data) {\n    let i = info[d.frame_id]\n    if (!i) info[d.frame_id] = i = {frames: [], samples: [], color: color()}\n    i.frames.push(d)\n    for (let j = 0; j < d.width; j++) {\n      i.samples.push(d.x + j)\n    }\n  }\n\n  // Samples may overlap on the same line\n  for (const r in info) {\n    if (info[r].samples) {\n      info[r].samples = getUnique(info[r].samples)\n    }\n  }\n\n  // assign some colors, analyze samples per gem\n  const gemStats = {}\n  const topFrames = {}\n  let lastFrame = {frame: 'd52e04d-df28-41ed-a215-b6ec840a8ea5', x: -1, frame_id: -1, topFrame: {}}\n\n  for (const d of data) {\n    const gem = guessGem(d.file)\n    let stat = gemStats[gem]\n    d.gemName = gem\n\n    if (!stat) {\n      gemStats[gem] = stat = {name: gem, samples: [], frames: []}\n    }\n\n    stat.frames.push(d.frame_id)\n    for (let j = 0; j < d.width; j++) {\n      stat.samples.push(d.x + j)\n    }\n    // This assumes the traversal is in order\n    if (lastFrame.x !== d.x) {\n      let topFrame = topFrames[lastFrame.frame_id]\n      if (!topFrame) {\n        topFrames[lastFrame.frame_id] = topFrame = {exclusiveCount: 0}\n      }\n      topFrame.exclusiveCount += 1\n      lastFrame.topFrame = topFrame\n    }\n    lastFrame = d\n  }\n\n  let topFrame = topFrames[lastFrame.frame_id]\n  if (!topFrame) {\n    topFrames[lastFrame.frame_id] = topFrame = {exclusiveCount: 0}\n  }\n  topFrame.exclusiveCount += 1\n  lastFrame.topFrame = topFrame\n\n  let totalGems = 0\n  for (const k in gemStats) {\n    totalGems++\n    gemStats[k].samples = getUnique(gemStats[k].samples)\n  }\n\n  const gemsSorted = Object.keys(gemStats).map(k => gemStats[k])\n  gemsSorted.sort((a, b) => b.samples.length - a.samples.length)\n\n  let currentIndex = 0\n  for (const stat of gemsSorted) {\n    stat.color = rainbow(totalGems, currentIndex)\n    currentIndex += 1\n\n    for (let x = 0; x < stat.frames.length; x++) {\n      info[stat.frames[x]].color = stat.color\n    }\n  }\n\n  document.querySelector<HTMLElement>('.spinner-container')!.remove()\n  new FlamegraphView(data, info, gemsSorted)\n}\n","import flamegraph from './github/graphs/flamegraph'\n\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n\nasync function render(graph: Element) {\n  const url = graph.getAttribute('data-url')!\n\n  const response = await fetch(url.replace(/&amp;/g, '&'), {\n    headers: {\n      'X-Requested-With': 'XMLHttpRequest',\n    },\n  })\n  if (!response.ok) {\n    return\n  }\n\n  flamegraph(await response.json())\n}\n\nobserve('.flamegraph', graph => {\n  render(graph)\n})\n"],"names":["EventSource","on","name","callback","listeners","eventListeners","push","dispatch","data","c","requestAnimationFrame","constructor","CanvasView","setDimensions","width","height","resizeRequestID","cancelAnimationFrame","setDimensionsNow","canvas","style","ratio","window","devicePixelRatio","ctx","getContext","setTransform","scale","repaintNow","paint","scheduleRepaint","repaintRequestID","clearRect","Flamechart","xScale","x","widthScale","viewport","yScale","y","heightScale","frameRect","f","dataToCanvas","r","setViewport","current","opacity","frames","gemName","strokeStyle","characterWidth","showLabels","textBaseline","font","getComputedStyle","fontFamily","measureText","blocksByColor","color","colorString","i","info","frame_id","colorBlocks","rect","text","frame","textBlocks","Object","keys","block","fillStyle","fillRect","strokeRect","textRect","assign","length","centerTruncate","maxLength","charactersToKeep","prefixLength","Math","ceil","suffixLength","substr","join","floor","fillText","frameAtPoint","find","d","dataRange","minX","minY","maxX","maxY","MainFlamechart","onMouseDown","e","button","captureMouse","mouseup","onMouseUp","bind","mousemove","onMouseMove","clientRect","getBoundingClientRect","currentX","clientX","left","currentY","clientY","top","dragging","dragInfo","mouse","preventDefault","releaseCapture","min","max","setHoveredFrame","onMouseOut","onWheel","deltaX","deltaY","shiftKey","test","navigator","userAgent","handleZoomGesture","pow","offsetX","zoom","originX","ratioX","newWidth","hoveredFrame","previous","addEventListener","event","passive","OverviewFlamechart","setViewportOverlayRect","viewportOverlayRect","viewportOverlay","transform","dragStartX","handleDragGesture","dragCurrentX","onOverlayMouseDown","onOverlayMouseUp","onOverlayMouseMove","overlayDragging","overlayDragInfo","classList","add","handleOverlayDragGesture","remove","container","querySelector","FlamegraphView","updateDimensions","innerWidth","mainChartHeight","innerHeight","overviewHeight","mainChart","overview","computeDataRange","range","Infinity","onHoveredFrameChanged","updateInfo","repaintFrames","infoElement","backgroundColor","textContent","shortFile","file","replace","sData","samplePercentRaw","samples","topFrame","exclusiveCount","toString","exclusive","ret","toFixed","concat","onViewportChanged","onOverlayChanged","renderLegend","element","sortedGems","fragment","document","createDocumentFragment","gem","node","createElement","className","setAttribute","span","float","appendChild","createTextNode","onLegendMouseMove","gemElement","target","closest","getAttribute","hoveredGemName","onLegendMouseOut","mainCanvas","legend","capturingListeners","removeEventListener","getUnique","orig","o","render","graph","url","response","fetch","headers","ok","flamegraph","parseInt","random","j","gemStats","topFrames","lastFrame","guessGem","split","stat","totalGems","k","gemsSorted","map","sort","a","b","currentIndex","rainbow","numOfSteps","step","g","h","q","json","observe"],"sourceRoot":""}