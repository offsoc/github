{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "id": "https://schema.github.com/v3/credential-authorization.json",
  "title": "Credential Authorization",
  "type": "object",
  "definitions": {
    "login": {
      "type": "string",
      "example": "monalisa",
      "description": "User login that owns the underlying whitelisted credential."
    },
    "credential_id": {
      "type": "integer",
      "example": 1,
      "description": "Unique identifier for the whitelisted credential."
    },
    "credential_type": {
      "type": "string",
      "example": "SSH Key",
      "description": "Human-readable description of the whitelisted credential type."
    },
    "fingerprint": {
      "type": "string",
      "example": "jklmnop12345678",
      "description": "Unique string to distinguish the whitelisted credential. Only included in responses with credential_type of SSH Key."
    },
    "token_last_eight": {
      "type": "string",
      "example": "12345678",
      "description": "Last eight characters of the whitelisted credential. Only included in responses with credential_type of personal access token."
    },
    "credential_authorized_at": {
      "type": "string",
      "format": "date-time",
      "example": "2011-01-26T19:06:43Z",
      "description": "Date when the credential was authorized for use."
    },
    "credential_accessed_at": {
      "type": [
        "string",
        "null"
      ],
      "format": "date-time",
      "example": "2011-01-26T19:06:43Z",
      "description": "Date when the credential was last accessed. May be null if it was never accessed"
    },
    "scopes": {
      "type": "array",
      "example": [
        "user",
        "repo"
      ],
      "description": "List of oauth scopes the token has been granted."
    },
    "authorized_credential_id": {
      "type": [
        "integer",
        "null"
      ],
      "example": 12345678,
      "description": "The unique identifier of the credential that is authorized for the organization."
    },
    "authorized_credential_title": {
      "type": [
        "string",
        "null"
      ],
      "example": "my ssh key",
      "description": "The title given to the ssh key by the owning developer. This will only be present when the credential is an ssh key."
    },
    "authorized_credential_note": {
      "type": [
        "string",
        "null"
      ],
      "example": "my access token",
      "description": "The note given to the token by the owning developer. This will only be present when the credential is a token."
    }
  },
  "links": [
    {
      "title": "Remove a credential authorization for an organization that uses SAML SSO.",
      "method": "DELETE",
      "rel": "delete",
      "href": "/organizations/{organization_id}/credential-authorizations/{credential_id}",
      "schema": {
        "additionalProperties": false,
        "type": [
          "object",
          "null"
        ]
      }
    }
  ],
  "properties": {
    "login": {
      "$ref": "#/definitions/login"
    },
    "credential_id": {
      "$ref": "#/definitions/credential_id"
    },
    "credential_type": {
      "$ref": "#/definitions/credential_type"
    },
    "fingerprint": {
      "$ref": "#/definitions/fingerprint"
    },
    "token_last_eight": {
      "$ref": "#/definitions/token_last_eight"
    },
    "credential_authorized_at": {
      "$ref": "#/definitions/credential_authorized_at"
    },
    "credential_accessed_at": {
      "$ref": "#/definitions/credential_accessed_at"
    },
    "scopes": {
      "$ref": "#/definitions/scopes"
    },
    "authorized_credential_id": {
      "$ref": "#/definitions/authorized_credential_id"
    },
    "authorized_credential_title": {
      "$ref": "#/definitions/authorized_credential_title"
    },
    "authorized_credential_note": {
      "$ref": "#/definitions/authorized_credential_note"
    }
  },
  "additionalProperties": false,
  "required": [
    "login",
    "credential_id",
    "credential_type",
    "credential_authorized_at"
  ]
}
