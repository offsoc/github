# This file was generated with Kustomize. Please do not edit manually.
apiVersion: apps/v1
kind: Deployment
metadata:
    annotations:
        heaven.githubapp.com/allow-cluster-preferences-configmap: "true"
        heaven.githubapp.com/image-placeholder: github
        heaven.githubapp.com/inject-heaven-env-vars-into-containers: achievements-public-sponsor-processor
    name: achievements-public-sponsor-processor
spec:
    replicas: 1
    selector:
        matchLabels:
            service: achievements-public-sponsor-processor
    template:
        metadata:
            annotations:
                fluentbit.io/parser: logfmt_sloppy
                observability.github.com/kafka_topic: rails
                observability.github.com/splunk_index: rails
            labels:
                service: achievements-public-sponsor-processor
        spec:
            containers:
                - args:
                    - bin/achievements-public-sponsor-processor
                  env:
                    - name: RAILS_ENV
                      value: production
                    - name: FAILBOT_CONTEXT_KUBE_POD_NAME
                      valueFrom:
                        fieldRef:
                            fieldPath: metadata.name
                    - name: FAILBOT_CONTEXT_KUBE_POD_IP
                      valueFrom:
                        fieldRef:
                            fieldPath: status.podIP
                    - name: FAILBOT_CONTEXT_KUBE_CLUSTER
                      valueFrom:
                        configMapKeyRef:
                            key: kubernetes_cluster_name
                            name: kube-cluster-metadata
                    - name: GH_HOSTNAME
                      value: github.com
                    - name: DOGSTATSD_HOST
                      valueFrom:
                        fieldRef:
                            fieldPath: spec.nodeName
                    - name: KUBE_NAMESPACE
                      valueFrom:
                        fieldRef:
                            fieldPath: metadata.namespace
                  envFrom:
                    - configMapRef:
                        name: observability-config
                    - secretRef:
                        name: vault-secrets
                  image: github
                  imagePullPolicy: IfNotPresent
                  name: achievements-public-sponsor-processor
                  resources:
                    limits:
                        cpu: 1
                        memory: 4G
                    requests:
                        cpu: 50m
                        memory: 2G
                  volumeMounts:
                    - mountPath: /etc/github/metadata.json
                      name: github-metadata
                      readOnly: true
                    - mountPath: /etc/ssl/certs
                      name: ca-certificates
                      readOnly: true
            restartPolicy: Always
            volumes:
                - hostPath:
                    path: /etc/github/metadata.json
                  name: github-metadata
                - hostPath:
                    path: /etc/ssl/certs
                  name: ca-certificates
                - hostPath:
                    path: /dev/log
                  name: syslog
