{"version":3,"file":"chunk-app_components_discussions_edit-history-element_ts-xxxxxxxxxxxx.js","mappings":"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","sources":["app/components/discussions/edit-history-element.ts","node_modules/@github/template-parts/lib/template-string-parser.js","node_modules/@github/template-parts/lib/attribute-template-part.js","node_modules/@github/template-parts/lib/node-template-part.js","node_modules/@github/template-parts/lib/template-instance.js","node_modules/@github/template-parts/lib/processors.js"],"sourcesContent":["import {controller, target} from '@github/catalyst'\nimport {TemplateInstance} from '@github/template-parts'\nimport type {ModalDialogElement} from '@primer/view-components/app/components/primer/alpha/modal_dialog'\n\n@controller\nclass EditHistoryElement extends HTMLElement {\n  @target menuTrigger: HTMLButtonElement\n  @target diffDialogTemplate: HTMLTemplateElement\n  @target deletedDialogTemplate: HTMLTemplateElement\n\n  displayDiffDialog(event: Event) {\n    const button = event.currentTarget as HTMLButtonElement\n    const dialogId = button.getAttribute('data-dialog-id')!\n    const editor = button.getAttribute('data-editor')!\n    const src = button.getAttribute('data-src')!\n\n    const diffTemplate = new TemplateInstance(this.diffDialogTemplate, {dialogId, editor, src})\n    this.appendChild(diffTemplate)\n    this.showDialog(dialogId)\n  }\n\n  displayDeletedDialog(event: Event) {\n    const button = event.currentTarget as HTMLButtonElement\n    const dialogId = button.getAttribute('data-dialog-id')!\n    const editor = button.getAttribute('data-editor')!\n    const actor = button.getAttribute('data-actor')!\n    const datetime = button.getAttribute('data-datetime')!\n\n    const deletedTemplate = new TemplateInstance(this.deletedDialogTemplate, {\n      dialogId,\n      editor,\n      actor,\n      datetime,\n    })\n    this.appendChild(deletedTemplate)\n    this.showDialog(dialogId)\n  }\n\n  removeDialog(event: Event) {\n    const dialog = event.currentTarget as ModalDialogElement\n    const dialogContainer = dialog.closest('[data-modal-dialog-overlay]')\n\n    if (dialogContainer) {\n      dialogContainer.remove()\n\n      // Refocus the history dropdown button after the dialog is closed\n      this.menuTrigger.tabIndex = 0\n      this.menuTrigger.focus()\n    }\n  }\n\n  private showDialog(dialogId: string) {\n    const dialog = this.querySelector<ModalDialogElement | HTMLDialogElement>(`#${dialogId}`)\n\n    if (dialog instanceof HTMLDialogElement) {\n      dialog.showModal()\n    } else if (dialog) {\n      dialog.show()\n    }\n  }\n}\n","export function* parse(text) {\n    let value = '';\n    let tokenStart = 0;\n    let open = false;\n    for (let i = 0; i < text.length; i += 1) {\n        if (text[i] === '{' && text[i + 1] === '{' && text[i - 1] !== '\\\\' && !open) {\n            open = true;\n            if (value)\n                yield { type: 'string', start: tokenStart, end: i, value };\n            value = '{{';\n            tokenStart = i;\n            i += 2;\n        }\n        else if (text[i] === '}' && text[i + 1] === '}' && text[i - 1] !== '\\\\' && open) {\n            open = false;\n            yield { type: 'part', start: tokenStart, end: i + 2, value: value.slice(2).trim() };\n            value = '';\n            i += 2;\n            tokenStart = i;\n        }\n        value += text[i] || '';\n    }\n    if (value)\n        yield { type: 'string', start: tokenStart, end: text.length, value };\n}\n//# sourceMappingURL=template-string-parser.js.map","var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to set private field on non-instance\");\n    }\n    privateMap.set(receiver, value);\n    return value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to get private field on non-instance\");\n    }\n    return privateMap.get(receiver);\n};\nvar _setter, _value;\nexport class AttributeTemplatePart {\n    constructor(setter, expression) {\n        this.expression = expression;\n        _setter.set(this, void 0);\n        _value.set(this, '');\n        __classPrivateFieldSet(this, _setter, setter);\n        __classPrivateFieldGet(this, _setter).updateParent('');\n    }\n    get attributeName() {\n        return __classPrivateFieldGet(this, _setter).attr.name;\n    }\n    get attributeNamespace() {\n        return __classPrivateFieldGet(this, _setter).attr.namespaceURI;\n    }\n    get value() {\n        return __classPrivateFieldGet(this, _value);\n    }\n    set value(value) {\n        __classPrivateFieldSet(this, _value, value || '');\n        __classPrivateFieldGet(this, _setter).updateParent(value);\n    }\n    get element() {\n        return __classPrivateFieldGet(this, _setter).element;\n    }\n    get booleanValue() {\n        return __classPrivateFieldGet(this, _setter).booleanValue;\n    }\n    set booleanValue(value) {\n        __classPrivateFieldGet(this, _setter).booleanValue = value;\n    }\n}\n_setter = new WeakMap(), _value = new WeakMap();\nexport class AttributeValueSetter {\n    constructor(element, attr) {\n        this.element = element;\n        this.attr = attr;\n        this.partList = [];\n    }\n    get booleanValue() {\n        return this.element.hasAttributeNS(this.attr.namespaceURI, this.attr.name);\n    }\n    set booleanValue(value) {\n        if (this.partList.length !== 1) {\n            throw new DOMException('Operation not supported', 'NotSupportedError');\n        }\n        ;\n        this.partList[0].value = value ? '' : null;\n    }\n    append(part) {\n        this.partList.push(part);\n    }\n    updateParent(partValue) {\n        if (this.partList.length === 1 && partValue === null) {\n            this.element.removeAttributeNS(this.attr.namespaceURI, this.attr.name);\n        }\n        else {\n            const str = this.partList.map(s => (typeof s === 'string' ? s : s.value)).join('');\n            this.element.setAttributeNS(this.attr.namespaceURI, this.attr.name, str);\n        }\n    }\n}\n//# sourceMappingURL=attribute-template-part.js.map","var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to set private field on non-instance\");\n    }\n    privateMap.set(receiver, value);\n    return value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to get private field on non-instance\");\n    }\n    return privateMap.get(receiver);\n};\nvar _parts;\nexport class NodeTemplatePart {\n    constructor(node, expression) {\n        this.expression = expression;\n        _parts.set(this, void 0);\n        __classPrivateFieldSet(this, _parts, [node]);\n        node.textContent = '';\n    }\n    get value() {\n        return __classPrivateFieldGet(this, _parts).map(node => node.textContent).join('');\n    }\n    set value(string) {\n        this.replace(string);\n    }\n    get previousSibling() {\n        return __classPrivateFieldGet(this, _parts)[0].previousSibling;\n    }\n    get nextSibling() {\n        return __classPrivateFieldGet(this, _parts)[__classPrivateFieldGet(this, _parts).length - 1].nextSibling;\n    }\n    replace(...nodes) {\n        const parts = nodes.map(node => {\n            if (typeof node === 'string')\n                return new Text(node);\n            return node;\n        });\n        if (!parts.length)\n            parts.push(new Text(''));\n        __classPrivateFieldGet(this, _parts)[0].before(...parts);\n        for (const part of __classPrivateFieldGet(this, _parts))\n            part.remove();\n        __classPrivateFieldSet(this, _parts, parts);\n    }\n}\n_parts = new WeakMap();\n//# sourceMappingURL=node-template-part.js.map","var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to set private field on non-instance\");\n    }\n    privateMap.set(receiver, value);\n    return value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to get private field on non-instance\");\n    }\n    return privateMap.get(receiver);\n};\nvar _processor, _parts;\nimport { parse } from './template-string-parser.js';\nimport { AttributeValueSetter, AttributeTemplatePart } from './attribute-template-part.js';\nimport { NodeTemplatePart } from './node-template-part.js';\nimport { propertyIdentity } from './processors.js';\nfunction* collectParts(el) {\n    const walker = el.ownerDocument.createTreeWalker(el, NodeFilter.SHOW_TEXT | NodeFilter.SHOW_ELEMENT, null, false);\n    let node;\n    while ((node = walker.nextNode())) {\n        if (node instanceof Element && node.hasAttributes()) {\n            for (let i = 0; i < node.attributes.length; i += 1) {\n                const attr = node.attributes.item(i);\n                if (attr && attr.value.includes('{{')) {\n                    const valueSetter = new AttributeValueSetter(node, attr);\n                    for (const token of parse(attr.value)) {\n                        if (token.type === 'string') {\n                            valueSetter.append(token.value);\n                        }\n                        else {\n                            const part = new AttributeTemplatePart(valueSetter, token.value);\n                            valueSetter.append(part);\n                            yield part;\n                        }\n                    }\n                }\n            }\n        }\n        else if (node instanceof Text && node.textContent && node.textContent.includes('{{')) {\n            for (const token of parse(node.textContent)) {\n                if (token.end < node.textContent.length)\n                    node.splitText(token.end);\n                if (token.type === 'part')\n                    yield new NodeTemplatePart(node, token.value);\n                break;\n            }\n        }\n    }\n}\nexport class TemplateInstance extends DocumentFragment {\n    constructor(template, params, processor = propertyIdentity) {\n        var _a, _b;\n        super();\n        _processor.set(this, void 0);\n        _parts.set(this, void 0);\n        // This is to fix an inconsistency in Safari which prevents us from\n        // correctly sub-classing DocumentFragment.\n        // https://bugs.webkit.org/show_bug.cgi?id=195556\n        if (Object.getPrototypeOf(this !== TemplateInstance.prototype)) {\n            Object.setPrototypeOf(this, TemplateInstance.prototype);\n        }\n        this.appendChild(template.content.cloneNode(true));\n        __classPrivateFieldSet(this, _parts, Array.from(collectParts(this)));\n        __classPrivateFieldSet(this, _processor, processor);\n        (_b = (_a = __classPrivateFieldGet(this, _processor)).createCallback) === null || _b === void 0 ? void 0 : _b.call(_a, this, __classPrivateFieldGet(this, _parts), params);\n    }\n    update(params) {\n        __classPrivateFieldGet(this, _processor).processCallback(this, __classPrivateFieldGet(this, _parts), params);\n    }\n}\n_processor = new WeakMap(), _parts = new WeakMap();\n//# sourceMappingURL=template-instance.js.map","import { AttributeTemplatePart } from './attribute-template-part.js';\nexport function createProcessor(processPart) {\n    return {\n        createCallback(instance, parts, params) {\n            this.processCallback(instance, parts, params);\n        },\n        processCallback(_, parts, params) {\n            var _a;\n            if (typeof params !== 'object' || !params)\n                return;\n            for (const part of parts) {\n                if (part.expression in params) {\n                    const value = (_a = params[part.expression]) !== null && _a !== void 0 ? _a : '';\n                    processPart(part, value);\n                }\n            }\n        }\n    };\n}\nexport function processPropertyIdentity(part, value) {\n    part.value = String(value);\n}\nexport function processBooleanAttribute(part, value) {\n    if (typeof value === 'boolean' &&\n        part instanceof AttributeTemplatePart &&\n        typeof part.element[part.attributeName] === 'boolean') {\n        part.booleanValue = value;\n        return true;\n    }\n    return false;\n}\nexport const propertyIdentity = createProcessor(processPropertyIdentity);\nexport const propertyIdentityOrBooleanAttribute = createProcessor((part, value) => {\n    processBooleanAttribute(part, value) || processPropertyIdentity(part, value);\n});\n//# sourceMappingURL=processors.js.map"],"names":["EditHistoryElement","HTMLElement","displayDiffDialog","event","button","currentTarget","dialogId","getAttribute","editor","src","diffTemplate","TemplateInstance","diffDialogTemplate","appendChild","showDialog","displayDeletedDialog","actor","datetime","deletedTemplate","deletedDialogTemplate","removeDialog","dialogContainer","dialog","closest","remove","menuTrigger","tabIndex","focus","querySelector","HTMLDialogElement","showModal","show","target","controller","parse","text","value","tokenStart","open","i","length","type","start","end","slice","trim","_setter","_value","_parts","_processor","__classPrivateFieldSet","receiver","privateMap","has","set","__classPrivateFieldGet","get","AttributeTemplatePart","constructor","setter","expression","updateParent","attributeName","attr","name","attributeNamespace","namespaceURI","element","booleanValue","WeakMap","AttributeValueSetter","partList","hasAttributeNS","DOMException","append","part","push","partValue","removeAttributeNS","str","map","s","join","setAttributeNS","NodeTemplatePart","node","textContent","string","replace","previousSibling","nextSibling","nodes","parts","Text","before","createProcessor","processPart","createCallback","instance","params","processCallback","_","_a","processPropertyIdentity","String","propertyIdentity","propertyIdentityOrBooleanAttribute","processBooleanAttribute","DocumentFragment","template","processor","_b","Object","getPrototypeOf","prototype","setPrototypeOf","content","cloneNode","Array","from","collectParts","el","walker","ownerDocument","createTreeWalker","NodeFilter","SHOW_TEXT","SHOW_ELEMENT","nextNode","Element","hasAttributes","attributes","item","includes","valueSetter","token","splitText","call","update"],"sourceRoot":""}