<%# erblint:counter DeprecatedInPrimerCounter 1 %>
<%# erblint:counter GoogleAnalyticsDeprecation 4 %>
<% if trending_developers.any? %>
  <% instrument_explore_page_view(
    user: current_user,
    visitor: current_visitor,
    view_context: :TRENDING_DEVELOPERS_CARD,
    visible_record_ids: { visible_trending_developer_ids: trending_developers.map(&:id) },
  ) %>

  <!--// Trending developers //-->
  <div class="Box color-shadow-small mb-4">
    <div class="Box-header d-flex">
      <span class="color-fg-muted tooltipped tooltipped-ne mr-2" aria-label="These results are generated by GitHub computers"><%# erblint:disable GitHub::Accessibility::NoAriaLabelMisuse, Primer::Accessibility::TooltippedMigration %>
        <%= primer_octicon(:telescope) %>
      </span>
      <h3 class="Box-title">
        <%= render(Primer::Beta::Link.new(
          href: trending_developers_path,
          color: :default,
          data: explore_click_tracking_attributes(
            actor: current_user,
            click_context: :TRENDING_CARD,
            click_target: :TRENDING_DEVELOPERS,
            click_visual_representation: :TRENDING_DEVELOPERS_HEADING,
            ga_click_text: "Explore, go to Trending Developers, location:trending box",
          ),
        )) do %>
          Trending developers
        <% end %>
      </h3>
    </div>
    <div>
      <% trending_developers.each do |user| %>
        <article class="Box-row">
          <div class="d-flex gutter-condensed">
            <div class="col-3">
              <%= avatar_for(user, "100%", class: :avatar, style: "height: auto") %>
            </div>
            <div class="col-9">
              <h4 class="f4 text-bold lh-condensed mb-2">
                <%= render(Primer::Beta::Link.new(
                  href: user_path(user),
                  data: explore_click_tracking_attributes(
                    actor: current_user,
                    click_context: :TRENDING_CARD,
                    click_target: :OWNER,
                    click_visual_representation: :TRENDING_DEVELOPER,
                    record_id: user.id,
                    ga_click_text: "Explore, go to user, location:trending developers box",
                  ),
                )) do %>
                  <%= user.profile_name || user.name %>
                <% end %>
                <span class="d-block text-normal color-fg-muted" <%= test_selector("user-login") %>><%= user.display_login %></span>
              </h4>

              <% if user.most_popular_repository.present? %>
                <p class="f6 mb-0">
                  <%= render(Primer::Beta::Link.new(
                    href: repository_path(user.most_popular_repository),
                    color: :muted,
                    data: explore_click_tracking_attributes(
                      actor: current_user,
                      click_context: :TRENDING_CARD,
                      click_target: :REPOSITORY,
                      click_visual_representation: :TRENDING_DEVELOPER_POPULAR_REPOSITORY,
                      record_id: user.most_popular_repository.id,
                      ga_click_text: "Explore, go to user, location:trending developers box",
                    ),
                  )) do %>
                    <%= primer_octicon(:repo, color: :muted, vertical_align: :middle, mr: 1) %>
                    <%= user.most_popular_repository.name %>
                  <% end %>
                </p>
              <% end %>
            </div>
          </div>
        </article>
      <% end %>
    </div>
    <div class="Box-footer">
      <%= render(Primer::Beta::Link.new(
        href: trending_developers_path,
        font_size: 6,
        data: explore_click_tracking_attributes(
          actor: current_user,
          click_context: :TRENDING_CARD,
          click_target: :TRENDING_DEVELOPERS,
          click_visual_representation: :SEE_MORE_TRENDING_DEVELOPERS,
          ga_click_text: "Explore, go to Trending Developers, location:trending box",
        ),
      )) do %>
        See more trending developers<%= primer_octicon(:"chevron-right", ml: 1) %>
      <% end %>
    </div>
  </div>
<% end %>
