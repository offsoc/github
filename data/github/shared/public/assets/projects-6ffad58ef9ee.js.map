{"version":3,"file":"projects-xxxxxxxxxxxx.js","mappings":"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","sources":["app/assets/modules/github/perform-transition.ts","app/assets/modules/github/behaviors/details.ts","app/assets/modules/github/behaviors/hash-change.ts","app/assets/modules/github/throttled-input.ts","app/assets/modules/github/project-updater.ts","app/assets/modules/github/project-cards-filter.ts","app/assets/modules/projects.ts","app/assets/modules/github/projects/edit.ts","app/assets/modules/github/magic-move.ts","app/assets/modules/github/projects/keyboard-mover.ts","ui/packages/eventloop-tasks/eventloop-tasks.ts"],"sourcesContent":["// performTransition\n//\n// CSS3 transitions have some major pitfalls. First trying to transition\n// elements from `display:none` to `display:block.` And also dealing with\n// computed properties like `height:auto`.\n//\n// This helper attempts to deal with those issues while still defining\n// the transitions in pure css.\n//\n// Behaviors that intend to support these special case transitions\n// should call `performTransition` when they add or remove their state\n// classes.\n//\n// Any element that is performing a transition needs to be annotated\n// with the `js-transitionable` class name.\n//\n// @example\n//\n// <div class=\"js-transitionable collapse\">\n//   Slide down\n// </div>\n//\n// .collapse {\n//   display: none;\n//   position: relative;\n//   height: 0;\n//   overflow: hidden;\n//   @include transition(0.35s, height, ease);\n// }\n// .collapse.open {\n//   display: block;\n//   height: auto;\n// }\n//\n// performTransition document.querySelector('.collapse', () => {\n//   this.classList.add('open')\n// })\n\nconst supportsTransitions = 'ontransitionend' in window\n\n// DEPRECATED: PerformTransition is deprecated.\nexport default function performTransition(container: HTMLElement, cb: () => void) {\n  if (!supportsTransitions) {\n    cb()\n    return\n  }\n\n  const els = Array.from(container.querySelectorAll('.js-transitionable'))\n  if (container.classList.contains('js-transitionable')) els.push(container)\n\n  for (const el of els) {\n    const transitionHeight = isTransitioningHeight(el)\n    if (!(el instanceof HTMLElement)) continue\n\n    el.addEventListener(\n      'transitionend',\n      () => {\n        el.style.display = ''\n        el.style.visibility = ''\n\n        if (transitionHeight) {\n          withoutTransition(el, function () {\n            el.style.height = ''\n          })\n        }\n      },\n      {once: true},\n    )\n\n    el.style.boxSizing = 'content-box'\n    el.style.display = 'block'\n    el.style.visibility = 'visible'\n\n    if (transitionHeight) {\n      withoutTransition(el, function () {\n        el.style.height = getComputedStyle(el).height\n      })\n    }\n\n    // force reflow\n    el.offsetHeight\n  }\n\n  cb()\n\n  for (const el of els) {\n    if (!(el instanceof HTMLElement)) continue\n    if (isTransitioningHeight(el)) {\n      const currentHeight = getComputedStyle(el).height\n      el.style.boxSizing = ''\n      if (currentHeight === '0px') {\n        el.style.height = `${el.scrollHeight}px`\n      } else {\n        el.style.height = '0px'\n      }\n    }\n  }\n}\n\n// Detect if element is transitioning its height property.\nfunction isTransitioningHeight(el: Element) {\n  return getComputedStyle(el).transitionProperty === 'height'\n}\n\n// Apply style change callback w/o triggering a transition.\nfunction withoutTransition(el: HTMLElement, cb: () => void) {\n  el.style.transition = 'none'\n  cb()\n  el.offsetHeight\n  el.style.transition = ''\n}\n","/* eslint eslint-comments/no-use: off */\n/* eslint-disable github/no-then */\n\n/**\n * Details toggle.\n *\n * Use the details toggle to toggle content on the page. Similar to the\n * [HTML5 details element](https://www.w3.org/wiki/HTML/Elements/details).\n *\n * There are minimum two classes you will need to trigger the JS behavior.\n *\n * Apply the `.js-details-target` class to the element that will trigger\n * the toggle through a mouse click. For accessibility reasons, we recommend using a\n * `<button>` tag for this, but it can be applied to any element.\n *\n * A single `.js-details-container` class will be applied to a parent element that is wrapping\n * all the details components. The behavior will toggle an `Details--on` class on this element\n * which the CSS will use to show and hide the appropriate objects.\n *\n * There are default styling classes that will show and hide content for you. `.Details`\n * is a component that is built to show hidden content on open, and hide shown content\n * on close.\n *\n * The default state of the component is closed. Wrap the content and target with the `Details`\n * class. And apply `Details-content--hidden` to any element that you want *hidden* when closed\n * and *shown* when open.\n *\n * @example\n * ```html\n * <div class=\"Details js-details-container\">\n *   <button type=\"button\" class=\"js-details-target\" aria-expanded=\"false\">See more info</button>\n *   <div class=\"Details-content--hidden\">Hidden details</div>\n * </div>\n * ```\n *\n * Shown content\n *\n * If you have some content that you would like to be *shown* by default and\n * *hidden* when the details is `Details--on`. Then you can use the `Details-content--shown`\n * class.\n *\n * @example\n * ```html\n * <div class=\"Details js-details-container\">\n *   <button type=\"button\" class=\"js-details-target\" aria-expanded=\"false\" aria-label=\"Expand and collapse\">\n *     <%= octicon(\"chevron-down\", :class => \"Details-content--shown\") %>\n *     <%= octicon(\"chevron-up\", :class => \"Details-content--hidden\") %>\n *   </button>\n *   <div class=\"Details-content--shown\">Shown details</div>\n * </div>\n * ```\n *\n * For a11y reasons you can use the `data-label-open` and `data-label-closed` attributes\n * to set the aria-label of the button when the details is open or closed.\n *\n * @example\n * ```html\n * <div class=\"Details js-details-container\">\n *  <button type=\"button\" class=\"js-details-target\" aria-expanded=\"false\" aria-label=\"Expand\"\n *    data-aria-label-open=\"Collapse\" data-aria-label-closed=\"Expand\">\n *   <%= octicon(\"chevron-down\", :class => \"Details-content--shown\") %>\n *   <%= octicon(\"chevron-up\", :class => \"Details-content--hidden\") %>\n *  </button>\n *  <div class=\"Details-content--hidden\">Hidden details</div>\n * </div>\n */\n\nimport hashChange from './hash-change'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport performTransition from '../perform-transition'\nimport {preservePosition} from 'scroll-anchoring'\n\nfunction findAndFocusByQuerySelector(container: HTMLElement, elements: string[]) {\n  elements.find(selector => {\n    const elementsFromSelector = Array.from(container.querySelectorAll<HTMLElement>(selector))\n    const lastVisibleElement = elementsFromSelector.findLast(el => {\n      return window.getComputedStyle(el).display !== 'none'\n    })\n\n    if (lastVisibleElement && document.activeElement !== lastVisibleElement) {\n      lastVisibleElement.focus()\n      return true // found\n    }\n  })\n}\n\nfunction restoreAutofocus(container: HTMLElement) {\n  findAndFocusByQuerySelector(container, ['.js-focus-on-dismiss', 'input[autofocus], textarea[autofocus]'])\n}\n\nfunction hideTooltip(target: HTMLElement) {\n  if (!target.classList.contains('tooltipped')) return\n  target.classList.remove('tooltipped')\n  target.addEventListener(\n    'mouseleave',\n    () => {\n      target.classList.add('tooltipped')\n      // eslint-disable-next-line github/no-blur\n      target.blur()\n    },\n    {once: true},\n  )\n}\n\nfunction groupMembers(group: string): Element[] {\n  return [...document.querySelectorAll('.js-details-container')].filter(\n    el => el.getAttribute('data-details-container-group') === group,\n  )\n}\n\nfunction containerTargets(container: Element): Element[] {\n  return [...container.querySelectorAll('.js-details-target')].filter(\n    target => target.closest('.js-details-container') === container,\n  )\n}\n\nfunction toggleGroup(container: Element, open: boolean): string | null {\n  const group = container.getAttribute('data-details-container-group')\n  if (!group) return null\n  preservePosition(container, () => {\n    for (const otherContainer of groupMembers(group)) {\n      if (otherContainer !== container) {\n        updateOpenState(otherContainer, open)\n      }\n    }\n  })\n  return group\n}\n\nfunction updateOpenState(container: Element, open: boolean) {\n  container.classList.toggle('open', open)\n  container.classList.toggle('Details--on', open)\n  if (open) {\n    const initialFocus = container.querySelector<HTMLElement>('.js-details-initial-focus')\n    if (initialFocus) {\n      setTimeout(() => {\n        initialFocus.focus()\n      }, 0)\n    }\n  }\n  for (const target of containerTargets(container)) {\n    target.setAttribute('aria-expanded', open.toString())\n    if (!target.hasAttribute('data-aria-label-open') || !target.hasAttribute('data-aria-label-closed')) continue\n    target.setAttribute(\n      'aria-label',\n      open ? target.getAttribute('data-aria-label-open')! : target.getAttribute('data-aria-label-closed')!,\n    )\n  }\n}\n\nexport function toggleDetailsTarget(target: HTMLElement, opts?: {withGroup?: boolean; force?: boolean}) {\n  const containerSelector = target.getAttribute('data-details-container') || '.js-details-container'\n  const container = target.closest<HTMLElement>(containerSelector)!\n  const open = opts?.force ?? !container.classList.contains('open')\n  const withGroup = opts?.withGroup ?? false\n  performTransition(container, () => {\n    updateOpenState(container, open)\n    const group = withGroup ? toggleGroup(container, open) : null\n    Promise.resolve().then(() => {\n      restoreAutofocus(container)\n      hideTooltip(target)\n      container.dispatchEvent(\n        new CustomEvent('details:toggled', {\n          bubbles: true,\n          cancelable: false,\n          detail: {open},\n        }),\n      )\n      if (group) {\n        container.dispatchEvent(\n          new CustomEvent('details:toggled-group', {\n            bubbles: true,\n            cancelable: false,\n            detail: {open, group},\n          }),\n        )\n      }\n    })\n  })\n}\n\nexport function isDetailsTargetExpanded(target: HTMLElement): boolean {\n  const containerSelector = target.getAttribute('data-details-container') || '.js-details-container'\n  const container = target.closest<HTMLElement>(containerSelector)!\n  const classList = container.classList\n  return classList.contains('Details--on') || classList.contains('open')\n}\n\nfunction handleDetailsTargetClick(event: Event) {\n  const withGroup = (event as MouseEvent).altKey\n  const target = event.currentTarget as HTMLElement\n  toggleDetailsTarget(target, {withGroup})\n  event.preventDefault()\n}\non('click', '.js-details-target', handleDetailsTargetClick)\n\n// Expand collapsed outdated diff if anchor points to it\n//   /github/github/pull/123#discussion-diff-456\n//   /github/github/pull/123#discussion-r345\nhashChange(function ({target}) {\n  if (target) ensureExpanded(target)\n})\n\nexport function ensureExpanded(target: Element) {\n  let toCollapse = false\n  let node = target.parentElement\n  while (node) {\n    if (node.classList.contains('Details-content--shown')) {\n      toCollapse = true\n    }\n    if (node.classList.contains('js-details-container')) {\n      node.classList.toggle('open', !toCollapse)\n      node.classList.toggle('Details--on', !toCollapse)\n      toCollapse = false\n    }\n    node = node.parentElement\n  }\n}\n","// Variant on the native `hashchange` event with extra features:\n//\n// * Guarantees that handlers run on DOMContentLoaded, or immediately if page has\n//   already loaded;\n// * If the anchor references an element by id, the `data.target` property of the\n//   argument passed to handlers will be a reference to that DOM element.\n//\n// Each handler will be invoked with a `data` object containing properties:\n//\n// * `oldURL` - String URL prior to the hash change, or `null` on initial page load;\n// * `newURL` - String URL after hash change, or current page URL;\n// * `target` - DOM element whose id matches the anchor value, or `null`.\n//\n// Examples\n//\n// ```js\n// // Redirect old anchor issue urls\n// hashChange((data) => {\n//   const m = data.newURL.match(/\\/issues#issue\\/(\\d+)$/)\n//   if (m) window.location = data.newURL.replace(/\\/?#issue\\/.+/, \"/#{m[1]}\")\n// })\n//\n// // Ensure that the referenced comment's parent container is visible\n// hashChange((data) => {\n//   const container = data.target && data.target.closest('.js-comments-container')\n//   if (container) container.classList.remove('d-none')\n// })\n// ```\n\nimport {ready} from '@github-ui/document-ready'\nimport {SOFT_NAV_STATE} from '@github-ui/soft-nav/states'\n\nconst handlers: HashChangeListener[] = []\nlet ran = 0\n\ntype HashChangeListener = (opts: {oldURL: string | null; newURL: string; target?: Element | null}) => unknown\n\nexport default function hashChange(handler: HashChangeListener) {\n  ;(async function () {\n    handlers.push(handler)\n    await ready\n    runRemainingHandlers()\n  })()\n}\n\nhashChange.clear = () => {\n  handlers.length = ran = 0\n}\n\nfunction runRemainingHandlers() {\n  const index = ran\n  ran = handlers.length\n  runHandlers(handlers.slice(index), null, window.location.href)\n}\n\nfunction runHandlers(handlersToRun: HashChangeListener[], oldURL: string | null, newURL: string) {\n  const id = window.location.hash.slice(1)\n  const target = id ? document.getElementById(id) : null\n  const data = {oldURL, newURL, target}\n\n  for (const fn of handlersToRun) {\n    fn.call(null, data)\n  }\n}\n\n// Track ieOldURL manually to work around an open IE bug where the hashchange\n// event does not have oldURL or newURL attributes. See\n// https://connect.microsoft.com/IE/feedback/details/828283/implement-hashchangeevent-oldurl-and-newurl\nlet ieOldURL = window.location.href\nwindow.addEventListener('popstate', function () {\n  ieOldURL = window.location.href\n})\n\nwindow.addEventListener('hashchange', function (event) {\n  const newURL = window.location.href\n  try {\n    runHandlers(handlers, event.oldURL || ieOldURL, newURL)\n  } finally {\n    ieOldURL = newURL\n  }\n})\n\nlet softNavOldURL: string | null = null\n\ndocument.addEventListener(SOFT_NAV_STATE.START, function () {\n  softNavOldURL = window.location.href\n})\n\ndocument.addEventListener(SOFT_NAV_STATE.SUCCESS, function () {\n  runHandlers(handlers, softNavOldURL, window.location.href)\n})\n","type TextField = HTMLInputElement | HTMLTextAreaElement\n\n/**\n * Throttled Input event.\n *\n * Delays firing `input` event until user is done typing.\n *\n * Details.\n *\n * Never fires while a key is down, waits for the next keyup.\n *   NOTE: Native OSX text fields won't repeat keys. FF will repeat key while held down.\n *\n * Never fires for selection changes (pressing left or right keys to move the cursor).\n */\n\nconst throttledInputEvents: WeakMap<\n  HTMLElement,\n  {\n    keypressed: boolean\n    inputed: boolean\n    timer: number | null | undefined\n    listener: ThrottledHandler\n    wait: number\n  }\n> = new WeakMap()\n\nfunction schedule(element: TextField) {\n  const events = throttledInputEvents.get(element)\n  if (!events) return\n  if (events.timer != null) clearTimeout(events.timer)\n\n  events.timer = window.setTimeout(() => {\n    if (events.timer != null) events.timer = null\n    events.inputed = false\n    events.listener.call(null, element)\n  }, events.wait)\n}\n\nfunction onKeydownInput(event: Event) {\n  const currentTarget = event.currentTarget as TextField\n  const events = throttledInputEvents.get(currentTarget)\n  if (!events) return\n  events.keypressed = true\n  if (events.timer != null) {\n    clearTimeout(events.timer)\n  }\n}\n\nfunction onKeyupInput(event: Event) {\n  const currentTarget = event.currentTarget as TextField\n  const events = throttledInputEvents.get(currentTarget)\n  if (!events) return\n  events.keypressed = false\n  if (events.inputed) {\n    schedule(currentTarget)\n  }\n}\n\nfunction onInputInput(event: Event) {\n  const currentTarget = event.currentTarget as TextField\n  const events = throttledInputEvents.get(currentTarget)\n  if (!events) return\n  events.inputed = true\n  if (!events.keypressed) {\n    schedule(currentTarget)\n  }\n}\n\ntype ThrottledHandler = (arg0: TextField) => unknown\n\nexport function addThrottledInputEventListener(\n  target: TextField,\n  listener: ThrottledHandler,\n  options: {wait: number | null} = {wait: null},\n) {\n  throttledInputEvents.set(target, {\n    keypressed: false,\n    inputed: false,\n    timer: undefined,\n    listener,\n    wait: options.wait != null ? options.wait : 100,\n  })\n\n  target.addEventListener('keydown', onKeydownInput)\n  target.addEventListener('keyup', onKeyupInput)\n  target.addEventListener('input', onInputInput)\n}\n\nexport function removeThrottledInputEventListener(target: TextField, listener: ThrottledHandler) {\n  target.removeEventListener('keydown', onKeydownInput)\n  target.removeEventListener('keyup', onKeyupInput)\n  target.removeEventListener('input', onInputInput)\n\n  const events = throttledInputEvents.get(target)\n  if (events) {\n    if (events.timer != null && events.listener === listener) {\n      clearTimeout(events.timer)\n    }\n    throttledInputEvents.delete(target)\n  }\n}\n\nexport function dispatchThrottledInputEvent(target: TextField) {\n  const events = throttledInputEvents.get(target)\n  if (events) events.listener.call(null, target)\n}\n","import {animate, recordPositions} from './magic-move'\n\nimport {IncludeFragmentElement} from '@github/include-fragment-element'\nimport {debounce} from '@github/mini-throttle'\n// eslint-disable-next-line no-restricted-imports\nimport {fire} from 'delegated-events'\n\nlet updateMessageTimer: number | undefined\n\nexport function displayUpdateMessage(message: string) {\n  if (!message) {\n    return\n  }\n\n  if (updateMessageTimer) {\n    clearTimeout(updateMessageTimer)\n  }\n\n  const messageContainer = document.querySelector<HTMLElement>('.js-project-updated-message')!\n  messageContainer.textContent = message\n  /* eslint-disable-next-line github/no-d-none */\n  messageContainer.classList.remove('d-none')\n  updateMessageTimer = window.setTimeout(function () {\n    messageContainer.textContent = ''\n    /* eslint-disable-next-line github/no-d-none */\n    messageContainer.classList.add('d-none')\n  }, 3000)\n}\n\n// Either grabs the existing column element for this Column, or creates\n// an <include-fragment> element that will load the Column's HTML from the server\nfunction getColumn(column: Column, urlBase: string): HTMLElement {\n  const columnIDAttribute = `column-${column.id}`\n  const columnElem = document.getElementById(columnIDAttribute)\n  if (columnElem) {\n    return columnElem\n  } else {\n    const columnPlaceholder = new IncludeFragmentElement()\n    columnPlaceholder.id = columnIDAttribute\n    columnPlaceholder.src = encodeURI(`${urlBase}/${column.id}`)\n    return columnPlaceholder\n  }\n}\n\n// Either grabs the existing card element for this Card, or creates\n// an <include-fragment> element that will load the Card's HTML from the server\nfunction getCard(cardID: string, urlBase: string): HTMLElement {\n  const cardIDAttribute = `card-${cardID}`\n  const cardElem = document.getElementById(cardIDAttribute)\n  if (cardElem) {\n    return cardElem\n  } else {\n    const cardPlaceholder = new IncludeFragmentElement()\n    cardPlaceholder.id = cardIDAttribute\n    cardPlaceholder.src = encodeURI(`${urlBase}/${cardID}`)\n    cardPlaceholder.onerror = function () {\n      cardPlaceholder.remove()\n    }\n\n    return cardPlaceholder\n  }\n}\n\nfunction shouldUpdateColumns(projectContainer: HTMLElement, projectJSON: {columns: Column[]}): boolean {\n  const columns = Array.from(projectContainer.querySelectorAll('.js-project-column'))\n  const columnIDsFromContainer = columns.map(column => {\n    return column.getAttribute('data-id')\n  })\n  const columnIDsFromJSON = projectJSON.columns.map(column => {\n    return String(column.id)\n  })\n\n  return columnIDsFromJSON.join(',') !== columnIDsFromContainer.join(',')\n}\n\ninterface Column {\n  id: number\n  name: string\n  card_ids: number[]\n  purpose: string\n  automation_summary: string\n}\n\nfunction updateColumnAutomation(column: Column, columnElement: HTMLElement) {\n  const automationFooter = columnElement.querySelector('.js-project-column-automation-footer')\n  if (!automationFooter) return\n\n  const automationSummary = automationFooter.querySelector<HTMLElement>('.js-project-column-automation-summary')!\n  if (column.automation_summary && column.purpose) {\n    automationSummary.textContent = column.purpose\n    automationSummary.setAttribute('aria-label', column.automation_summary)\n    /* eslint-disable-next-line github/no-d-none */\n    automationFooter.classList.remove('d-none')\n  } else {\n    /* eslint-disable-next-line github/no-d-none */\n    automationFooter.classList.add('d-none')\n  }\n}\n\n// Populate a column nav element with the column id, name, and card count\nfunction populateColumnNav(navItem: HTMLAnchorElement, columnID: string, columnName: string, cardCount: string) {\n  navItem.setAttribute('data-column-id', columnID)\n  navItem.setAttribute('data-column-name', columnName)\n  navItem.href = encodeURI(`#column-${columnID}`)\n  navItem.querySelector<HTMLElement>('.js-column-nav-name')!.textContent = columnName\n\n  const cardCounter = navItem.querySelector<HTMLElement>('.js-column-nav-card-count')!\n  if (cardCounter) {\n    cardCounter.textContent = cardCount\n\n    // eslint-disable-next-line i18n-text/no-en\n    cardCounter.setAttribute('aria-label', `Contains ${cardCount} ${Number(cardCount) === 1 ? 'item' : 'items'}`)\n  }\n}\n\n// Create and append a new column nav element to the column nav header shown\n// on small screens\nfunction createColumnNav(\n  template: HTMLTemplateElement,\n  columnNav: HTMLElement,\n  columnID: string,\n  columnName: string,\n  cardCount: string,\n  selected: boolean,\n) {\n  const navLink = template.content.cloneNode(true) as DocumentFragment\n\n  const navItem = navLink.querySelector<HTMLAnchorElement>('.js-project-column-navigation-item')!\n  navItem.classList.toggle('selected', selected)\n  populateColumnNav(navItem, columnID, columnName, cardCount)\n\n  const nextIndex = columnNav.querySelectorAll('.js-project-column-navigation-item').length + 1\n  navLink.querySelector<HTMLElement>('.js-column-nav-index')!.textContent = nextIndex.toString()\n\n  columnNav.appendChild(navLink)\n}\n\n// Remove the column nav element with the given column ID from the column nav\n// header shown on small screens\nexport function deleteColumnNav(columnID: string) {\n  for (const column of document.querySelectorAll('.js-project-column-navigation-item')) {\n    if (columnID === column.getAttribute('data-column-id')) {\n      column.remove()\n      return\n    }\n  }\n}\n\n// Add a column nav element to the column nav header shown on small screens\n// representing the given column element\nexport function addColumnNav(column: HTMLElement) {\n  const columnNav = document.querySelector<HTMLElement>('.js-project-column-nav')\n  if (!columnNav) return\n\n  const template = columnNav.querySelector<HTMLTemplateElement>('.js-column-nav-template')!\n  const columnID = column.getAttribute('data-id') || ''\n  const columnName = column.querySelector<HTMLElement>('.js-project-column-name')!.textContent!\n  const cardCount = column.querySelector<HTMLElement>('.js-column-card-count')!.textContent!\n  createColumnNav(template, columnNav, columnID, columnName, cardCount, true)\n}\n\n// Update a column nav element shown on small screens for the given column\n// element\nexport function updateColumnNav(column: HTMLElement) {\n  const columnID = column.getAttribute('data-id')\n  if (!columnID) return\n\n  const navItem = document.querySelector(`.js-project-column-navigation-item[data-column-id=\"${columnID}\"]`)\n  if (navItem instanceof HTMLAnchorElement) {\n    const columnName = column.querySelector<HTMLElement>('.js-project-column-name')!.textContent!\n    const cardCount = column.querySelector<HTMLElement>('.js-column-card-count')!.textContent!\n    populateColumnNav(navItem, columnID, columnName, cardCount)\n  }\n}\n\n// Rebuild the column nav shown on small screens for the current columns present\n// in the data model\nfunction rebuildColumnNav(columns: Column[]) {\n  const columnNav = document.querySelector<HTMLElement>('.js-project-column-nav')\n  if (!columnNav) return\n\n  const template = columnNav.querySelector<HTMLTemplateElement>('.js-column-nav-template')!\n\n  const scrollLeft = columnNav.scrollLeft\n\n  let activeColumnID\n  for (const column of document.querySelectorAll('.js-project-column-navigation-item')) {\n    column.remove()\n    if (column.classList.contains('selected')) {\n      activeColumnID = column.getAttribute('data-column-id')\n    }\n  }\n\n  for (const column of columns) {\n    createColumnNav(\n      template,\n      columnNav,\n      column.id.toString(),\n      column.name,\n      column.card_ids.length.toString(),\n      activeColumnID === column.id.toString(),\n    )\n  }\n\n  columnNav.scrollLeft = scrollLeft\n}\n\nfunction replaceCardsInContainer(\n  cardContainer: HTMLElement,\n  cardIDs: number[],\n  cardElements: {[index: number]: HTMLElement},\n) {\n  // Build updated card list for this container\n  const cardsFragment = document.createDocumentFragment()\n  for (const cardID of cardIDs) {\n    cardsFragment.appendChild(cardElements[cardID]!)\n  }\n\n  // Swap updated card list into the page\n  cardContainer.textContent = ''\n  cardContainer.appendChild(cardsFragment)\n}\n\n// Updates a project when an event comes in from the project's channel\ntype ProjectUpdateData = {state: {columns: Column[]}; message: string}\nasync function _updateProject(projectContainer: HTMLElement, data: ProjectUpdateData) {\n  displayUpdateMessage(data.message)\n\n  const columns = projectContainer.querySelectorAll<HTMLElement>('.js-project-column')\n  const columnPositions = recordPositions(columns)\n\n  const projectURL = projectContainer.getAttribute('data-url') || ''\n  const columnsURL = projectContainer.getAttribute('data-columns-url') || ''\n  const cardsURL = projectContainer.getAttribute('data-cards-url') || ''\n\n  // Loads a representation of the project's columns and ordered card IDs\n  let projectJSON = data.state\n  if (!projectJSON) {\n    const response = await fetch(projectURL, {\n      headers: {Accept: 'application/json', 'X-Requested-With': 'XMLHttpRequest'},\n    })\n    if (!response.ok) {\n      return\n    }\n    projectJSON = await response.json()\n  }\n\n  fire(projectContainer, 'will-update-project', projectJSON)\n\n  const oldActiveElement = document.activeElement as HTMLElement\n\n  if (shouldUpdateColumns(projectContainer, projectJSON)) {\n    fire(projectContainer, 'will-update-project-columns')\n\n    // Save scroll position\n    const scrollPositions: {[key: string]: number} = {}\n\n    // Build updated column list\n    const columnsFragment = document.createDocumentFragment()\n    for (const columnID of projectJSON.columns) {\n      const column = getColumn(columnID, columnsURL)\n      const cardContainer = column.querySelector('.js-project-column-cards')\n      if (cardContainer) {\n        scrollPositions[cardContainer.id] = cardContainer.scrollTop\n      }\n      columnsFragment.appendChild(column)\n    }\n\n    // Grab the \"Add column\" button because we're going to be swapping\n    // out the contents of its parent\n    const newColumnButton = projectContainer.querySelector('.js-new-project-column-container')\n    if (newColumnButton) {\n      newColumnButton.remove()\n    }\n\n    const blankSlate = projectContainer.querySelector<HTMLElement>('.js-new-column-blankslate')!\n    blankSlate.remove()\n\n    // Swap updated column list into the page\n    projectContainer.textContent = ''\n    projectContainer.appendChild(columnsFragment)\n\n    // Put the \"Add column\" button back\n    if (newColumnButton) {\n      projectContainer.appendChild(newColumnButton)\n      // make it visible if there are any columns\n      const button = newColumnButton.querySelector<HTMLElement>('.js-new-column-button')!\n      /* eslint-disable-next-line github/no-d-none */\n      button.classList.toggle('d-none', projectJSON.columns.length === 0)\n    }\n\n    projectContainer.appendChild(blankSlate)\n    /* eslint-disable-next-line github/no-d-none */\n    blankSlate.classList.toggle('d-none', projectJSON.columns.length > 0)\n\n    rebuildColumnNav(projectJSON.columns)\n\n    // Restore scroll positions for columns\n    for (const cardContainerID in scrollPositions) {\n      const cardContainer = document.getElementById(cardContainerID)!\n      cardContainer.scrollTop = scrollPositions[cardContainerID]!\n    }\n\n    await animate(columns, columnPositions)\n  }\n\n  const cards = projectContainer.querySelectorAll<HTMLElement>('.js-project-column-card')\n  const cardPositions = recordPositions(cards)\n\n  const cardElements: {[index: number]: HTMLElement} = {}\n\n  // Store all existing card elements from columns before updating them so\n  // cards get re-used when moving between columns.\n  for (const column of projectJSON.columns) {\n    for (const cardID of column.card_ids) {\n      cardElements[cardID] = getCard(cardID.toString(), cardsURL)\n    }\n  }\n\n  for (const column of projectJSON.columns) {\n    const columnElem = document.getElementById(`column-${column.id}`)\n\n    // Column is loading, but it will come in with the cards\n    if (!columnElem || columnElem.tagName === 'INCLUDE-FRAGMENT') {\n      return\n    }\n\n    // Update the name\n    const columnNameElem = columnElem.querySelector('.js-project-column-name')\n\n    if (columnNameElem) {\n      columnNameElem.textContent = column.name\n\n      const columnNameField = columnElem.querySelector('.js-project-column-name-field')\n\n      // There won't be a column form for read only viewers\n      if (columnNameField instanceof HTMLInputElement) {\n        columnNameField.value = column.name\n        // Facebox copies a serialized version of the element instead of cloning the node,\n        // so we need to set the attribute directly\n        columnNameField.setAttribute('value', column.name)\n      }\n    }\n\n    const columnCountElem = columnElem.querySelector('.js-column-card-count')\n    if (columnCountElem) {\n      columnCountElem.textContent = column.card_ids.length.toString()\n    }\n\n    updateColumnAutomation(column, columnElem)\n\n    const cardContainer = columnElem.querySelector<HTMLElement>('.js-project-column-cards')!\n    replaceCardsInContainer(cardContainer, column.card_ids, cardElements)\n  }\n\n  fire(projectContainer, 'update-project')\n\n  await animate(cards, cardPositions)\n\n  // Restore active element (like if a user is typing a Note)\n  if (oldActiveElement && document.activeElement !== oldActiveElement) {\n    oldActiveElement.focus()\n  }\n}\n\nexport const updateProject: (el: HTMLElement, data: ProjectUpdateData) => void = debounce(_updateProject, 100)\n\nexport function updateProjectColumnAutomation(projectJSON: {columns: Column[]}) {\n  for (const column of projectJSON.columns) {\n    const columnElement = document.getElementById(`column-${column.id}`)\n    if (columnElement) {\n      updateColumnAutomation(column, columnElement)\n    }\n  }\n}\n","import {getState, replaceState} from '@github-ui/browser-history-state'\n\nconst isQualifier = 'is'\nconst linkedQualifier = 'linked'\nconst titleQualifier = 'title'\n\nconst qualifiers = [\n  'assignee',\n  'author',\n  isQualifier,\n  'label',\n  'milestone',\n  'repo',\n  'review',\n  'state',\n  'status',\n  'type',\n  linkedQualifier,\n]\n\n// Mapping from linked qualifier value to applicable type\n// e.g. linked:pr should map to issue\nconst linkedQualifierValueTypeMapping: {[index: string]: string} = {\n  pr: 'issue',\n}\n\nconst typeQualifierValues = ['issue', 'pr', 'note']\n\n// Qualifiers that can be specified with a 'no:'' prefix such as 'no:assignee'\nconst noQualifiers = ['assignee', 'label', 'milestone']\n\nconst queryTokenizerRegex = /[^\\s:]+:(\"(?:\\\\\"|.)*?\"|[^\\s]*)|[^\\s]+/g\n\ninterface TokenFilter {\n  token: string\n  negated: boolean\n}\n\ninterface QualifierFilter {\n  tokenFilters: TokenFilter[]\n  matchIfMissing: boolean\n}\n\ninterface ProjectCardFilter {\n  [index: string]: QualifierFilter | undefined\n  assignee?: QualifierFilter\n  author?: QualifierFilter\n  is?: QualifierFilter\n  label?: QualifierFilter\n  milestone?: QualifierFilter\n  repo?: QualifierFilter\n  state?: QualifierFilter\n  title?: QualifierFilter\n  type?: QualifierFilter\n}\n\nfunction getOrCreateQualifierFilter(filter: ProjectCardFilter, qualifier: string): QualifierFilter {\n  let qualifierFilter = filter[qualifier]\n  if (!qualifierFilter) {\n    qualifierFilter = {tokenFilters: [], matchIfMissing: false}\n    filter[qualifier] = qualifierFilter\n  }\n  return qualifierFilter\n}\n\nfunction addToken(filter: QualifierFilter, token: string, negated: boolean) {\n  const tokenFilter = filter.tokenFilters.find(tf => tf.token === token)\n  if (tokenFilter) {\n    tokenFilter.negated = negated\n  } else {\n    filter.tokenFilters.push({token, negated})\n  }\n  // Reset matchIfMissing since last qualifier token wins\n  filter.matchIfMissing = false\n}\n\nexport function queryContainsQualifier(queryString: string, qualifier: string): boolean {\n  return parseCardFilterQuery(queryString)[qualifier] != null\n}\n\nfunction getQueryTokenValue(queryToken: string, qualifier: string): string {\n  // If the token starts with a valid qualifier (i.e. 'author:'), add it to\n  // the filter, replacing any escaped characters for matching\n  const regexPattern = `^-?${qualifier}:\\\\s*\"?(.*?)\"?\\\\s*$`\n  return queryToken.replace(new RegExp(regexPattern), '$1').replace(/\\\\(\")/g, '$1').toLowerCase()\n}\n\nfunction parseCardFilterQuery(queryString: string): ProjectCardFilter {\n  // Split the query up into tokens.\n  const queryTokens: string[] = queryString.match(queryTokenizerRegex) || []\n  const filter: ProjectCardFilter = {}\n\n  for (const queryToken of queryTokens) {\n    // See if the token matches any qualifiers. Here are some examples of what\n    // matches and what doesn't:\n    //\n    // Matches:\n    // --------\n    // label:bug\n    // label:b\n    // label:\"multiword label\"\n    // -label:question\n    //\n    // Does not match:\n    // ---------------\n    // label: bug (this will be split into two tokens, neither of which match any qualifiers)\n    // label:\n    // label\n    // invalidqualifier:bug\n    // someothertoken\n    const matchingQualifier = qualifiers.find(qualifier => queryToken.match(new RegExp(`^-?${qualifier}:.*`)))\n\n    if (matchingQualifier) {\n      const newQualifierValue = getQueryTokenValue(queryToken, matchingQualifier)\n\n      if (newQualifierValue.length > 0) {\n        // Only add the filter if it has a value. Otherwise, ignore it.\n        const qualifierFilter = getOrCreateQualifierFilter(filter, matchingQualifier)\n        const negated = queryToken.startsWith('-')\n        addToken(qualifierFilter, newQualifierValue, negated)\n\n        // if linked filter is used and no type filter is present,\n        // add type filter to scope the result to proper type for linked filter\n        if (matchingQualifier !== linkedQualifier) {\n          continue\n        }\n\n        const targetTypeValue = linkedQualifierValueTypeMapping[newQualifierValue]\n        const hasTypeFilter = (tokens: string[]) =>\n          tokens.some(token => {\n            const tokenValue = getQueryTokenValue(token, isQualifier)\n            return token !== tokenValue && typeQualifierValues.includes(tokenValue)\n          })\n        if (targetTypeValue && !hasTypeFilter(queryTokens)) {\n          const isQualifierFilter = getOrCreateQualifierFilter(filter, isQualifier)\n          addToken(isQualifierFilter, targetTypeValue, false)\n        }\n      }\n    } else {\n      const missingQualifier = noQualifiers.find(qualifier => queryToken === `no:${qualifier}`)\n      if (missingQualifier) {\n        getOrCreateQualifierFilter(filter, missingQualifier).matchIfMissing = true\n      } else if (queryToken.length > 0) {\n        // If the token doesn't start with a valid qualifier, make it part of the\n        // card title qualifier.\n        const qualifierFilter = getOrCreateQualifierFilter(filter, titleQualifier)\n        addToken(qualifierFilter, queryToken, false)\n      }\n    }\n  }\n\n  // After all this parsing, a query string that looked like:\n  //\n  // 'one two three author:jakeboxer label:bug -label:wontfix no:assignee'\n  //\n  // will result in an object that looks like:\n  //\n  // {\n  //   author: {\n  //     tokens: [\n  //       {token: 'jakeboxer', negated: false}\n  //     ],\n  //     matchIfMissing: false\n  //   },\n  //   assignee: {\n  //     tokens: [],\n  //     matchIfMissing: true\n  //   },\n  //   label: {\n  //     tokens: [\n  //       {token: 'bug', negated: false},\n  //       {token: 'wontfix', negated: true}\n  //     ],\n  //     matchIfMissing: true\n  //   },\n  //   title: {\n  //     tokens: [\n  //       {token: 'one', negated: false},\n  //       {token: 'two' negated: false},\n  //       {token: 'three', negated: false}\n  //     ],\n  //     matchIfMissing: false\n  //   }\n  // }\n  return filter\n}\n\nlet parsedFilter: ProjectCardFilter\nlet lastQueryText: string\n\nfunction getQueryText() {\n  return document.querySelector<HTMLInputElement>('.js-card-filter-input')?.value.trim().toLowerCase() || ''\n}\n\nfunction getFilterQuery(): ProjectCardFilter {\n  const queryText = getQueryText()\n  if (lastQueryText !== queryText) {\n    lastQueryText = queryText\n    parsedFilter = parseCardFilterQuery(queryText)\n  }\n  return parsedFilter\n}\n\nfunction cardMatchesFilter(card: HTMLElement, filter: ProjectCardFilter): boolean {\n  for (const qualifier in filter) {\n    // Split the card's attribute value into tokens.\n    const cardAttrValue = card.getAttribute(`data-card-${qualifier}`) || ''\n    let cardAttrTokens = []\n\n    if (cardAttrValue.trim() !== '') {\n      cardAttrTokens = JSON.parse(cardAttrValue)\n    }\n\n    const qualifierFilter = filter[qualifier]!\n    if (qualifierFilter.matchIfMissing) {\n      // If the tokens are not empty and no:qualifier was specified, exit\n      // early.\n      if (cardAttrTokens.length > 0) {\n        return false\n      }\n    } else {\n      // Iterate over each token in the qualifier and see if it's matched by one\n      // of the card's tokens.\n      for (const qualifierToken of qualifierFilter.tokenFilters) {\n        if (qualifier === titleQualifier) {\n          if (!isPartiallyMatched(qualifierToken.token, cardAttrTokens)) {\n            // If one of the tokens in the title qualifier isn't partially\n            // matched, exit early.\n            return false\n          }\n        } else {\n          if (qualifier === linkedQualifier && !linkedQualifierValueTypeMapping[qualifierToken.token]) {\n            // Exit early if the 'linked' qualifier is not supported\n            return false\n          }\n\n          const fullyMatched = isFullyMatched(qualifierToken.token, cardAttrTokens)\n          if (qualifierToken.negated) {\n            if (fullyMatched && cardAttrTokens.length > 0) {\n              // If one of the tokens in another qualifier is matched but was\n              // negated, exit early\n              return false\n            }\n          } else if (!fullyMatched) {\n            // If one of the tokens in another qualifier isn't fully matched, exit\n            // early.\n            return false\n          }\n        }\n      }\n    }\n  }\n\n  // If all the tokens in all the qualifiers were matched, this card matches.\n  return true\n}\n\nfunction isPartiallyMatched(needle: string, haystack: string[]): boolean {\n  return haystack.some(item => {\n    return item.startsWith(needle)\n  })\n}\n\nfunction isFullyMatched(needle: string, haystack: string[]): boolean {\n  return haystack.indexOf(needle) !== -1\n}\n\nfunction setQueryParam(name: string, value: string): void {\n  const newUrl = new URL(window.location.href, window.location.origin)\n  const params = new URLSearchParams(newUrl.search.slice(1))\n\n  if (value === '') {\n    params.delete(name)\n  } else {\n    params.set(name, value)\n  }\n\n  newUrl.search = params.toString()\n  replaceState(getState(), document.title, newUrl.toString())\n}\n\nfunction updateFullscreenLinks(name: string, value: string): void {\n  for (const link of document.querySelectorAll('.js-project-fullscreen-link')) {\n    const newUrl = new URL(link.getAttribute('href') || '', window.location.origin)\n    const params = new URLSearchParams(newUrl.search.slice(1))\n\n    if (value === '') {\n      params.delete(name)\n    } else {\n      params.set(name, value)\n    }\n\n    newUrl.search = params.toString()\n    link.setAttribute('href', newUrl.toString())\n  }\n}\n\nexport function updateFilteredCardCounts() {\n  const queryText = getQueryText()\n\n  for (const column of document.querySelectorAll('.js-project-columns-container .js-project-column')) {\n    const filteredCountLabel = column.querySelector<HTMLElement>('.js-filtered-column-card-count')\n    if (!filteredCountLabel) continue\n\n    if (queryText.length > 0) {\n      // Update and show the filtered count if there's a query\n      const filteredCount = column.querySelectorAll('.js-project-column-card:not(.d-none)').length\n      filteredCountLabel.textContent = `${filteredCount.toString()} result${filteredCount !== 1 ? 's' : ''}`\n    }\n\n    // Hide the filtered count if there's no query\n    /* eslint-disable-next-line github/no-d-none */\n    filteredCountLabel.classList.toggle('d-none', queryText.length === 0)\n  }\n}\n\nexport function filterCard(card: HTMLElement) {\n  const filter = getFilterQuery()\n  let cardMatches = cardMatchesFilter(card, filter)\n\n  if (!cardMatches) {\n    for (const cardReference of card.querySelectorAll<HTMLElement>('.js-issue-note, .js-issue-note-reference')) {\n      cardMatches = cardMatchesFilter(cardReference, filter)\n      if (cardMatches) {\n        break\n      }\n    }\n  }\n\n  /* eslint-disable-next-line github/no-d-none */\n  card.classList.toggle('d-none', !cardMatches)\n}\n\nexport function updateFilterState() {\n  const input = document.querySelector<HTMLInputElement>('.js-card-filter-input')\n  if (!input) return\n\n  const queryText = getQueryText()\n\n  // Hide the \"Clear filters\" button if there's no query\n  const cardFilterClearButton = document.querySelector<HTMLElement>('.js-card-filter-clear')\n  /* eslint-disable-next-line github/no-d-none */\n  cardFilterClearButton?.classList.toggle('d-none', queryText.length === 0)\n\n  setQueryParam(input.name, queryText)\n  updateFullscreenLinks(input.name, queryText)\n}\n\nexport function filterCards(): void {\n  for (const card of document.querySelectorAll<HTMLElement>('.js-project-columns-container .js-project-column-card')) {\n    filterCard(card)\n  }\n\n  updateFilteredCardCounts()\n  updateFilterState()\n}\n\n// The text before the cursor should NOT have quotes after a colon.\nconst badTextBeforeCursorRegex = /:\"[^\"]*\"?$/\n\n// The text before the cursor should be one of these two things:\n//\n// 1. The beginning of the string (for the first token)\n// 2. 1 or more whitespace characters (for any token after the first)\n//\n// followed by any number of characters that are not whitespace or \":\" (i.e.\n// alphanumeric characters, puncuation, and some other obscure things).\nconst goodTextBeforeCursorRegex = /(^|\\s+)[^\\s:]+$/\n\n// The text after the cursor should be one of these two things:\n//\n// 1. Whitespace only (to support adding new tokens in between existing ones)\n// 2. The end of the string (i.e. there's no text after the cursor)\nconst goodTextAfterCursorRegex = /^(\\s|$)/\n\nfunction shouldShowSuggestions(inputField: HTMLInputElement): boolean {\n  // Only show suggestions when input field is focused\n  if (document.activeElement !== inputField) {\n    return false\n  }\n\n  const textBeforeCursor = inputField.value.slice(0, inputField.selectionEnd!)\n  const textAfterCursor = inputField.value.slice(inputField.selectionEnd!)\n  const isEmpty = inputField.value.trim().length === 0\n\n  if (badTextBeforeCursorRegex.test(textBeforeCursor)) {\n    return false\n  }\n\n  const isCursorAtSuggestionLocation =\n    goodTextBeforeCursorRegex.test(textBeforeCursor) && goodTextAfterCursorRegex.test(textAfterCursor)\n\n  return isEmpty || isCursorAtSuggestionLocation\n}\n\nexport function updateSuggestionsDisplay(inputField: HTMLInputElement): void {\n  shouldShowSuggestions(inputField) ? showSuggestions(inputField) : hideSuggestions()\n}\n\nconst showSuggestionHelperRegex = /(^|\\s)[^\\s:]+$/\nconst currentTokenRegex = /\\S*$/\n\nfunction showSuggestions(inputField: HTMLInputElement): void {\n  const suggestionsContainer = document.querySelector('.js-card-filter-suggester')\n\n  if (suggestionsContainer instanceof HTMLElement) {\n    suggestionsContainer.classList.add('js-active-navigation-container')\n    /* eslint-disable-next-line github/no-d-none */\n    suggestionsContainer.classList.remove('d-none')\n\n    const textBeforeCursor = inputField.value.slice(0, inputField.selectionEnd!)\n    const currentToken = (textBeforeCursor.match(currentTokenRegex) || [])[0]!\n    const suggestionHelperContainer = suggestionsContainer.querySelector<HTMLElement>(\n      '.js-card-filter-suggester-helper-container',\n    )!\n    const suggestionHelper = suggestionHelperContainer.querySelector<HTMLElement>('.js-card-filter-suggester-helper')!\n\n    if (showSuggestionHelperRegex.test(inputField.value)) {\n      suggestionHelper.textContent = inputField.value\n      /* eslint-disable-next-line github/no-d-none */\n      suggestionHelperContainer.classList.remove('d-none')\n    } else {\n      /* eslint-disable-next-line github/no-d-none */\n      suggestionHelperContainer.classList.add('d-none')\n    }\n\n    const suggestionsHeader = suggestionsContainer.querySelector<HTMLElement>('.js-card-filter-suggestions-header')!\n    let showSuggestionsHeader = false\n\n    for (const suggestion of suggestionsContainer.querySelectorAll('.js-card-filter-suggestion')) {\n      const suggestionValue = suggestion.getAttribute('data-value')\n\n      if (suggestionValue && suggestionValue.startsWith(currentToken)) {\n        /* eslint-disable-next-line github/no-d-none */\n        suggestion.classList.remove('d-none')\n\n        // If we're showing at least one suggestion, also show the suggestions header.\n        showSuggestionsHeader = true\n      } else {\n        /* eslint-disable-next-line github/no-d-none */\n        suggestion.classList.add('d-none')\n      }\n    }\n\n    /* eslint-disable-next-line github/no-d-none */\n    suggestionsHeader.classList.toggle('d-none', !showSuggestionsHeader)\n  }\n}\n\nexport function hideSuggestions(): void {\n  const suggestionsContainer = document.querySelector('.js-card-filter-suggester')\n\n  if (suggestionsContainer instanceof HTMLElement) {\n    suggestionsContainer.classList.remove('js-active-navigation-container')\n    /* eslint-disable-next-line github/no-d-none */\n    suggestionsContainer.classList.add('d-none')\n  }\n}\n\nfunction clickFilterA11y(pressed: boolean, filterBy: string): void {\n  // To prevent elements from getting out of sync with the current filter state,\n  // we have to apply the changes to *all* of them.\n  for (const el of document.querySelectorAll('.js-card-filter[data-card-filter]')) {\n    if (el.getAttribute('data-card-filter') === filterBy) {\n      el.setAttribute('aria-pressed', pressed.toString())\n    }\n  }\n}\n\nexport function applyFilter(filterBy: string): void {\n  const inputField = document.querySelector<HTMLInputElement>('.js-card-filter-input')!\n  const currentFilter = inputField.value\n  let queryString = filterBy\n  let buttonPressed = true\n\n  if (currentFilter.indexOf(queryString) >= 0) {\n    // remove from existing filter\n    buttonPressed = false\n    queryString = currentFilter.replace(queryString, '')\n  } else if (currentFilter.length) {\n    // add to an existing filter\n    queryString = `${currentFilter.trim()} ${queryString}`\n  }\n\n  inputField.value = queryString\n  clickFilterA11y(buttonPressed, filterBy)\n  filterCards()\n}\n","import './github/projects/edit'\n\nimport type {MoveEvent, SortableEvent} from '@github/sortablejs'\nimport {\n  addColumnNav,\n  deleteColumnNav,\n  displayUpdateMessage,\n  updateColumnNav,\n  updateProject,\n  updateProjectColumnAutomation,\n} from './github/project-updater'\nimport {addThrottledInputEventListener, removeThrottledInputEventListener} from './github/throttled-input'\nimport {afterRemote, remoteForm} from '@github/remote-form'\nimport {\n  applyFilter,\n  filterCard,\n  filterCards,\n  hideSuggestions,\n  queryContainsQualifier,\n  updateFilterState,\n  updateFilteredCardCounts,\n  updateSuggestionsDisplay,\n} from './github/project-cards-filter'\nimport {changeValue, requestSubmit} from '@github-ui/form-utils'\nimport {fetchPoll, fetchSafeDocumentFragment} from '@github-ui/fetch-utils'\n// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport {onFocus, onKey} from '@github-ui/onfocus'\n\nimport type AutocompleteElement from '@github/auto-complete-element'\nimport type DetailsDialogElement from '@github/details-dialog-element'\nimport type {IncludeFragmentElement} from '@github/include-fragment-element'\nimport type {ModalDialogElement} from '@primer/view-components/app/components/primer/alpha/modal_dialog'\nimport type {RemoteFormHandler} from '@github/remote-form'\nimport type RemoteInputElement from '@github/remote-input-element'\nimport {debounce} from '@github/mini-throttle'\nimport {dialog} from '@github-ui/details-dialog'\nimport {enableKeyboardMovements} from './github/projects/keyboard-mover'\nimport {enableTaskList} from './github/behaviors/task-list'\nimport {eventToHotkeyString} from '@github-ui/hotkey'\nimport {fromEvent} from '@github-ui/subscription'\nimport hashChange from './github/behaviors/hash-change'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\nimport {parseHTML} from '@github-ui/parse-html'\nimport {replaceState} from '@github-ui/browser-history-state'\nimport {sendStats} from '@github-ui/stats'\nimport {toggleDetailsTarget} from './github/behaviors/details'\nimport {updateContent} from '@github-ui/updatable-content'\nimport verifySsoSession from './github/sso'\nimport {loaded} from '@github-ui/document-ready'\n\n// ****************************************************************************\n// Helpers\nlet clientUID: string\n\nconst clientUIDElem = document.querySelector('.js-client-uid')\nif (clientUIDElem) {\n  clientUID = clientUIDElem.getAttribute('data-uid')!\n}\n\n// This is a wrapper around remoteForm that lets us show an informative dialog\n// when a projects-related AJAX request returns an error.\nfunction remoteProjectForm(selector: string, fn: RemoteFormHandler) {\n  remoteForm(selector, async function (form, kicker, req) {\n    try {\n      await fn(form, kicker, req)\n    } catch (error) {\n      // If we get an error response from one of our project forms, show a\n      // dialog prompting the user to reload.\n      // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n      if (error.response) {\n        await openDialog('project-update-error')\n      }\n\n      throw error\n    }\n  })\n}\n\n// Wrapper for remoteForm that hides form actions after the form is submitted\n// This is primary used for waiting for a job status to indicate the job is done\n// Arguments:\n// - selector: form selector, your form should have:\n//   1. `.form-actions` containing your submit/cancel buttons\n//   2. `.js-project-loader` with a loading UI\n// - errorModal: error modal selector if your form submission fails\n// - fn: your callback function\nfunction remoteFormDisabledOnSubmit(selector: string, errorModal: string, fn: RemoteFormHandler) {\n  remoteForm(selector, async function (form, kicker, req) {\n    const buttons = form.querySelector<HTMLElement>('.form-actions')!\n    const loader = form.querySelector<HTMLElement>('.js-project-loader')!\n\n    /* eslint-disable-next-line github/no-d-none */\n    buttons.classList.add('d-none')\n    /* eslint-disable-next-line github/no-d-none */\n    loader.classList.remove('d-none')\n\n    try {\n      await fn(form, kicker, req)\n    } catch (error) {\n      // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n      if (error.response) {\n        await openDialog(errorModal)\n      }\n\n      /* eslint-disable-next-line github/no-d-none */\n      buttons.classList.remove('d-none')\n      /* eslint-disable-next-line github/no-d-none */\n      loader.classList.add('d-none')\n      throw error\n    }\n  })\n}\n\nfunction closeDialog(element: Element) {\n  element.closest<DetailsDialogElement>('details-dialog')!.toggle(false)\n}\n\nasync function openDialog(dialogID: string, opener?: Element): Promise<HTMLElement> {\n  const dialogTemplate = document.querySelector<HTMLTemplateElement>(`#${dialogID}`)!\n  const openedDialog = await dialog({\n    content: dialogTemplate.content.cloneNode(true) as DocumentFragment,\n    dialogClass: 'project-dialog',\n  })\n\n  if (opener) {\n    opener.setAttribute('aria-expanded', 'true')\n  }\n\n  openedDialog.addEventListener(\n    'dialog:remove',\n    function () {\n      if (opener) {\n        opener.setAttribute('aria-expanded', 'false')\n      }\n    },\n    {once: true},\n  )\n\n  return openedDialog\n}\n\nfunction populateFormFromCard(form: HTMLFormElement, card: Element | null) {\n  const cardIDInput = form.elements.namedItem('card_id') as HTMLInputElement\n  const contentIDInput = form.elements.namedItem('content_id') as HTMLInputElement\n  const contentTypeInput = form.elements.namedItem('content_type') as HTMLInputElement\n\n  if (!card) {\n    cardIDInput.value = ''\n    contentIDInput.value = ''\n    contentTypeInput.value = ''\n    return\n  }\n\n  const cardID = card.getAttribute('data-card-id')\n  if (cardID) {\n    cardIDInput.value = cardID\n    contentIDInput.value = ''\n    contentTypeInput.value = ''\n  } else {\n    cardIDInput.value = ''\n    contentIDInput.value = card.getAttribute('data-content-id')!\n    contentTypeInput.value = card.getAttribute('data-content-type')!\n  }\n\n  ;(form.elements.namedItem('client_uid') as HTMLInputElement).value = clientUID\n}\n\nfunction updateColumnCount(column: Element, change: number) {\n  const counter = column.querySelector<HTMLElement>('.js-column-card-count')!\n  const counterValue = parseInt(counter.textContent!.trim())\n  const columnID = column.getAttribute('data-id')\n\n  // Increment/decrement unless change is 0, then just set it to 0!\n  let newCounterValue = counterValue + change\n  if (change === 0) newCounterValue = 0\n\n  // Update column header count\n  counter.textContent = newCounterValue.toString()\n\n  let responsiveCounter\n  // The triage area for pending cards does not have an id\n  if (columnID) {\n    // Update responsive column header count\n    responsiveCounter = document.querySelector<HTMLElement>(\n      `.js-project-column-navigation-item[data-column-id=\"${columnID}\"] .js-column-nav-card-count`,\n    )!\n    if (responsiveCounter) {\n      responsiveCounter.textContent = newCounterValue.toString()\n    }\n  }\n\n  // eslint-disable-next-line i18n-text/no-en\n  const label = `Contains ${newCounterValue} ${newCounterValue === 1 ? 'item' : 'items'}`\n  counter.setAttribute('aria-label', label)\n\n  if (responsiveCounter) {\n    responsiveCounter.setAttribute('aria-label', label)\n  }\n}\n\n// Track if move was done using the keyboard\nfunction trackKeyboardMove(form: HTMLFormElement, options?: {keyboardMove?: boolean}) {\n  const keyboardInput = form.elements.namedItem('keyboard_move') as HTMLInputElement\n  if (options && options.keyboardMove === true) {\n    keyboardInput.value = 'true'\n  } else {\n    keyboardInput.value = ''\n  }\n}\n\nfunction moveCard(card: Element, fromColumn?: Element | null, options?: {keyboardMove?: boolean}) {\n  if (fromColumn) {\n    cleanupPendingCards(fromColumn)\n    updateColumnCount(fromColumn, -1)\n  }\n\n  const column = card.closest('.js-project-column')\n  if (!column) return\n\n  const columnID = column.getAttribute('data-id')!\n  card.setAttribute('data-column-id', columnID)\n  updateColumnCount(column, 1)\n  cleanupSearchResults()\n\n  const form = column.querySelector<HTMLFormElement>('.js-project-content-form')!\n  form.reset()\n  populateFormFromCard(form, card)\n\n  const prevCard = card.previousElementSibling\n  const prevCardInput = form.elements.namedItem('previous_card_id') as HTMLInputElement\n  if (prevCard) {\n    prevCardInput.value = prevCard.getAttribute('data-card-id')!\n  } else {\n    prevCardInput.value = ''\n  }\n\n  trackKeyboardMove(form, options)\n\n  requestSubmit(form)\n}\n\nfunction handleCardDrag(event: SortableEvent) {\n  const card = event.item\n\n  // Ignore drops on the triage pane. This will happen when a card is dragged\n  // from the triage pane, onto a column, and then back to triage before a drop.\n  if (card.closest('.js-project-triage-pane')) return\n\n  const from = event.from\n  const fromColumn = from && from.closest('.js-project-column')\n  moveCard(card, fromColumn)\n  card.focus()\n}\n\n// Remove a single card from a column and update the column card count\nfunction removeCard(card: Element) {\n  const column = card.closest('.js-project-column')\n\n  if (column) {\n    updateColumnCount(column, -1)\n  }\n\n  card.remove()\n}\n\n// For bulk card archival, we empty the card container of *all* cards\n// instead of removing individually because users could potentially be archiving\n// 100s of cards, and there's no added benefit or UX for doing this\n// Bonus: also resets the column card count to 0\nfunction removeAllCardsFromColumn(column: Element) {\n  const columnCards = column.querySelector<HTMLElement>('.js-project-column-cards')!\n  columnCards.textContent = ''\n\n  updateColumnCount(column, 0)\n}\n\nconst cardIdHashRegex = /^#card-(\\d+)$/\n\nfunction getCardIdFromHash(): string | undefined | null {\n  const captures = document.location.hash.match(cardIdHashRegex)\n\n  if (captures) {\n    // If there's a match, captures[0] contains the entire string, while\n    // captures[1] contains the first sub-group.\n    return captures[1]\n  } else {\n    return null\n  }\n}\n\nfunction moveColumn(column: Element, options?: {keyboardMove?: boolean}) {\n  const form = document.querySelector<HTMLFormElement>('.js-reorder-columns-form')!\n\n  ;(form.elements.namedItem('column_id') as HTMLInputElement).value = column.getAttribute('data-id')!\n\n  const previousColumn = column.previousElementSibling\n  const previousColumnId = form.elements.namedItem('previous_column_id') as HTMLInputElement\n  if (previousColumn) {\n    previousColumnId.value = previousColumn.getAttribute('data-id')!\n  } else {\n    previousColumnId.value = ''\n  }\n\n  trackKeyboardMove(form, options)\n\n  requestSubmit(form)\n}\n\nfunction handleColumnMove(event: MoveEvent): boolean | undefined {\n  // Only allow dropping around other columns\n  if (event.related && !event.related.matches('.js-project-column')) {\n    return false\n  }\n  return undefined\n}\n\nfunction handleColumnUpdate(event: SortableEvent) {\n  const column = event.item\n  moveColumn(column)\n  column.focus()\n}\n\nfunction cleanupPendingCards(fromColumn: Element) {\n  if (fromColumn.classList.contains('js-project-pending-cards-container')) {\n    if (fromColumn.querySelectorAll('.js-project-column-card').length === 0) {\n      fromColumn.remove()\n    }\n  }\n}\n\n// Reset the search page to 1 when all cards are dragged out of a search area\nfunction cleanupSearchResults() {\n  for (const searchableCards of document.querySelectorAll('.js-project-search-cards')) {\n    const pageValue = searchableCards.querySelector('.js-search-cards-next-page')\n    if (pageValue instanceof HTMLInputElement) {\n      const noSearchCards = searchableCards.querySelector('.js-project-column-card') == null\n      if (noSearchCards) {\n        pageValue.value = '1'\n      }\n    }\n  }\n}\n\nfunction refreshAddCardsSearchResults() {\n  const addCardsSearchForm = document.querySelector('.js-project-search-form')\n  if (addCardsSearchForm instanceof HTMLFormElement) {\n    requestSubmit(addCardsSearchForm)\n  }\n}\n\n// Update the search query when the add cards linked repo scope is toggled\non('change', '.js-toggle-linked-repo-scope', function (event) {\n  const checkbox = event.currentTarget as HTMLInputElement\n  const form = checkbox.form!\n  const search = form.querySelector<HTMLInputElement>('.js-project-triage-search-text')!\n\n  const originalQuery = search.value || ''\n  let newQuery: string\n\n  // Remove all instances of 'repo:' queries, or expand scope by adding 'repo:*'\n  if (checkbox.checked) {\n    newQuery = originalQuery.replace(/(\\s|^)repo:[^\\s]*\\s*/gi, '$1').trim()\n  } else {\n    newQuery = `${originalQuery.trim()} repo:*`\n  }\n\n  // Only send the search request of the query has changed\n  // Triggers the listener and validations for the search query form\n  if (newQuery !== originalQuery) {\n    search.value = newQuery\n    requestSubmit(form)\n  }\n})\n\nfunction refreshArchivedCardsSearchResults() {\n  const archivedCardsSearchForm = document.querySelector('.js-project-archived-cards-search-form')\n  if (archivedCardsSearchForm instanceof HTMLFormElement) {\n    requestSubmit(archivedCardsSearchForm)\n  }\n}\n\non('click', '.js-project-show-all-archived-cards', refreshArchivedCardsSearchResults)\n\n// Find a card by either card id or content id+type\nfunction findCard(cardID?: string, contentID?: string, contentType?: string): HTMLElement | undefined | null {\n  let card\n  if (cardID) {\n    card = document.querySelector<HTMLElement>(`.js-project-column-card[data-card-id=\"${cardID}\"]`)\n  }\n\n  if (!card && contentID && contentType) {\n    card = document.querySelector<HTMLElement>(\n      `.js-project-column-card[data-content-type=\"${contentType}\"][data-content-id=\"${contentID}\"]`,\n    )\n  }\n\n  return card\n}\n\n// Swap out updated card info. Any forms with this class name will take their response\n// and attempt to update any cards on the page that match it.\nremoteProjectForm('.js-project-update-card', async function (form, send) {\n  const response = await send.html()\n\n  const card = response.html.querySelector<HTMLElement>('*')!\n  const cardToUpdate = findCard(\n    card.getAttribute('data-card-id')!,\n    card.getAttribute('data-content-id')!,\n    card.getAttribute('data-content-type')!,\n  )\n  const focusUpdatedCard = cardToUpdate && cardToUpdate === cardToUpdate.ownerDocument.activeElement ? true : false\n\n  if (cardToUpdate) {\n    cardToUpdate.replaceWith(card)\n  }\n  if (focusUpdatedCard) {\n    card.focus()\n  }\n})\n\n// Clone the project and redirect when the job is finished\n// If the request to clone fails: generic error modal to try again\n// If the background job fails: modal with link to new, empty board\n// If successful: redirect!\nremoteFormDisabledOnSubmit('.js-project-clone-form', 'project-clone-error', async function (form, send) {\n  const response = await send.json()\n  const projectUrl = response.json.project_url\n  const jobUrl = response.json.job_status_url\n\n  try {\n    await fetchPoll(jobUrl)\n    window.location = projectUrl\n  } catch (error) {\n    if (projectUrl) {\n      // Failed background job\n      const openedDialog = await openDialog('project-clone-partial-error')\n      const link = openedDialog.querySelector<HTMLElement>('.js-cloned-board-link')!\n      link.setAttribute('href', projectUrl)\n    } else {\n      // Failed creation (pretty unlikely someone would hit this)\n      await openDialog('project-clone-error')\n    }\n  }\n})\n\n// Error when trying to convert an already converted note\nfunction isNoteAlreadyConvertedToIssue(response: Response) {\n  try {\n    // @ts-expect-error `error_code` is not a property on the json method?\n    return response && response.json && response.json.error_code === 'note_already_converted_to_issue'\n  } catch (error) {\n    return false\n  }\n}\n\nremoteProjectForm('.js-convert-note-to-issue-form', async function (form, send) {\n  try {\n    await send.text()\n    closeDialog(form)\n  } catch (error) {\n    // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n    if (isNoteAlreadyConvertedToIssue(error.response)) {\n      const errorContainer = form.querySelector<HTMLElement>('.js-convert-note-error-container')!\n      errorContainer.textContent = ''\n      // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n      errorContainer.append(parseHTML(document, error.response.json.error_html))\n    } else {\n      throw error\n    }\n  }\n})\n\nremoteProjectForm('.js-change-project-state-form', async function (form, send) {\n  // if there is an active element, blur so live updates work\n  const activeElement = document.activeElement\n  if (activeElement instanceof HTMLElement && form.contains(activeElement)) {\n    // details-dialog is managing focus to a place we are trying live update\n    // we can't remove the manual `blur` here until that is resolved\n    // see https://github.com/github/details-dialog-element/issues/24\n    // eslint-disable-next-line github/no-blur\n    activeElement.blur()\n  }\n\n  await send.text()\n  closeDialog(form)\n})\n\n// Open edit project modal with description field focused\non('click', '.js-add-project-description', async function () {\n  const modal = await openDialog('edit-project')\n  modal.querySelector<HTMLElement>('#edit-project-name')!.removeAttribute('autofocus')\n  modal.querySelector<HTMLElement>('#edit-project-body')!.setAttribute('autofocus', '')\n})\n\n// Project cloning modal\n// Toggle the publc/private options based on repo or org owner\n// Ensure repo projects are never set to private\non('click', '.js-project-target-owner', function (event) {\n  const ownerType = event.currentTarget.getAttribute('data-owner-type')!\n  const repoOwner = ownerType === 'repository'\n  const projectCloneDialog = event.currentTarget.closest<HTMLElement>('.js-project-clone-dialog')!\n\n  const visibilityOptions = projectCloneDialog.querySelector<HTMLElement>('.js-project-clone-visibility')!\n  /* eslint-disable-next-line github/no-d-none */\n  visibilityOptions.classList.toggle('d-none', repoOwner)\n\n  if (repoOwner) {\n    const privateInput = projectCloneDialog.querySelector<HTMLInputElement>('.js-project-clone-private')!\n    privateInput.checked = true\n  }\n})\n\n// Refresh the project\non('click', '.js-refresh-project', function () {\n  window.location.reload()\n})\n\n// ****************************************************************************\n// Column interactions\n\nremoteProjectForm('.js-create-project-column', async function (form, send) {\n  const response = await send.html()\n  const html = response.html.querySelector<HTMLElement>('*')!\n  const isForm = html.classList.contains('js-column-form-container')\n\n  if (isForm) {\n    const container = form.closest<HTMLElement>('.js-column-form-container')!\n    container.replaceWith(html)\n    loadAutomationOptions()\n  } else {\n    const newColumnContainer = document.querySelector<HTMLElement>('.js-new-project-column-container')!\n    newColumnContainer.before(response.html)\n    closeDialog(form)\n\n    addColumnNav(html)\n    const columnID = html.getAttribute('data-id')\n    if (columnID) {\n      setActiveColumn(columnID)\n      setColumnHash(columnID)\n      scrollActiveColumnNavIntoViewIfNeeded()\n    }\n\n    // if this is the first column they've created,\n    // remove the large blank slate prompt and replace with the \"Add column\" widget\n    const blankSlate = document.querySelector<HTMLElement>('.js-new-column-blankslate')!\n    /* eslint-disable-next-line github/no-d-none */\n    if (!blankSlate.classList.contains('d-none')) {\n      toggleBlankSlate(false)\n    }\n  }\n})\n\nremoteProjectForm('.js-update-project-column', async function (form, send) {\n  const response = await send.html()\n  const html = response.html.querySelector<HTMLElement>('*')!\n  const isForm = html.classList.contains('js-column-form-container')\n\n  if (isForm) {\n    const container = form.closest<HTMLElement>('.js-column-form-container')!\n    container.replaceWith(html)\n    loadAutomationOptions()\n  } else {\n    const columnID = form.getAttribute('data-column-id')!\n    const column = document.querySelector<HTMLElement>(`.js-project-column[data-id=\"${columnID}\"]`)!\n    column.replaceWith(html)\n    updateColumnNav(html)\n    closeDialog(form)\n  }\n})\n\nremoteProjectForm('.js-delete-project-column', async function (form, send) {\n  await send.text()\n  const columnID = form.getAttribute('data-column-id')!\n\n  // before we delete potentially the last column, find them all\n  const columns = document.querySelectorAll<HTMLElement>('.js-project-column')\n  document.querySelector<HTMLElement>(`.js-project-column[data-id=\"${columnID}\"]`)!.remove()\n\n  closeDialog(form)\n  deleteColumnNav(columnID)\n\n  // replace the \"add column\" prompt with the blank slate state\n  // if this was the last column deleted\n  if (columns.length === 1) {\n    toggleBlankSlate(true)\n  }\n})\n\n// Archive all cards in a column\nremoteProjectForm('.js-archive-project-column', async function (form, send) {\n  await send.text()\n\n  const columnID = form.getAttribute('data-column-id')!\n  const column = document.querySelector<HTMLElement>(`.js-project-column[data-id=\"${columnID}\"]`)!\n  removeAllCardsFromColumn(column)\n  closeDialog(form)\n})\n\n// Focus cards and columns on page load and match the\n// id in the URL hash except when on mobile.\nobserve('.js-project-column-card, .js-project-column', {\n  constructor: HTMLElement,\n  initialize(el) {\n    if (el.id === document.location.hash.substr(1)) {\n      setTimeout(() => {\n        if (!document.querySelector('.js-project-page-mobile')) {\n          el.focus()\n        }\n      }, 1)\n    }\n  },\n})\n\nfunction closeMigrationOverlay() {\n  const modal = document.querySelector<ModalDialogElement | HTMLDialogElement>('.js-migrate-project-dialog')\n  if (modal) {\n    modal.close()\n  }\n}\n\nfunction showConfirmationDialog() {\n  const detailsElement = document.querySelector<HTMLDetailsElement>('.js-project-migration-override')\n  if (detailsElement) {\n    detailsElement.open = true\n  }\n}\n\non('click', '.js-show-migration-override-button', function () {\n  // because the confirmation dialog needs to be visible when the migration modal is hidden\n  // we need to handle these events manually and perform the transition\n  closeMigrationOverlay()\n  showConfirmationDialog()\n})\n\nfunction toggleBlankSlate(visible: boolean) {\n  const newColumnContainer = document.querySelector<HTMLElement>('.js-new-project-column-container')!\n  const blankSlate = document.querySelector<HTMLElement>('.js-new-column-blankslate')!\n  const addButton = newColumnContainer.querySelector<HTMLElement>('.js-new-column-button')!\n\n  /* eslint-disable-next-line github/no-d-none */\n  blankSlate.classList.toggle('d-none', !visible)\n  /* eslint-disable-next-line github/no-d-none */\n  addButton.classList.toggle('d-none', visible)\n\n  // hide the add cards menu in case it is open\n  if (visible) {\n    togglePaneVisibility('.js-project-triage-pane', false)\n  }\n}\n\n// ****************************************************************************\n// Card interaction\nremoteProjectForm('.js-remove-card-after-request', async function (form, send) {\n  await send.text()\n\n  removeCard(form.closest<HTMLElement>('.js-project-column-card')!)\n  refreshAddCardsSearchResults()\n})\n\nremoteProjectForm('.js-archive-project-card', async function (form, send) {\n  removeCard(form.closest<HTMLElement>('.js-project-column-card')!)\n\n  await send.text()\n\n  refreshArchivedCardsSearchResults()\n})\n\nremoteProjectForm('.js-unarchive-project-card', async function (form, send) {\n  const card = form.closest<HTMLElement>('.js-project-column-card')!\n  const columnID = card.getAttribute('data-column-id')!\n  const columnCards = document.querySelector(`.js-project-column[data-id=\"${columnID}\"] .js-project-column-cards`)\n\n  if (columnCards) {\n    columnCards.append(card)\n    moveCard(card)\n    card.focus()\n  }\n\n  send.text()\n})\n\nremoteProjectForm('.js-project-archived-cards-search-form', async function (form, send) {\n  const container = form.closest<HTMLElement>('.js-project-archived-cards-pane')!\n  const searchResults = container.querySelector<HTMLElement>('.js-project-column-cards')!\n  searchResults.textContent = 'Loading…'\n  form.classList.add('loading')\n\n  let response\n  try {\n    response = await send.html()\n  } catch (fetchError) {\n    // TODO show error\n  }\n\n  searchResults.textContent = ''\n\n  if (response) {\n    searchResults.append(response.html)\n  }\n\n  form.classList.remove('loading')\n})\n\nhashChange(async function ({target}) {\n  if (target instanceof HTMLElement) {\n    // There's an element in the DOM whose id matches the current hash. Let's\n    // focus on it.\n    if (target.matches('.js-project-column-card')) {\n      target.focus()\n    } else if (target.matches('.js-project-column')) {\n      setActiveColumn(target.getAttribute('data-id')!)\n      scrollActiveColumnNavIntoViewIfNeeded()\n    }\n  } else if (document.location.hash.length > 0) {\n    // There's no element in the DOM whose id matches the current hash.\n\n    const cardID = getCardIdFromHash()\n\n    if (cardID != null) {\n      // It's pointing to a card, so let's see if it's in the archive.\n      const archivedCardsPane = document.querySelector('.js-project-archived-cards-pane')\n\n      if (archivedCardsPane) {\n        const urlTemplate = archivedCardsPane.getAttribute('data-project-archived-card-url')!\n\n        const response = await fetch(urlTemplate.replace('{card_id}', cardID), {\n          headers: {\n            'X-Requested-With': 'XMLHttpRequest',\n          },\n        })\n\n        if (response.ok) {\n          const results = await response.text()\n          if (results != null) {\n            // The card is in the archive, so load it up.\n            loadArchivedCardsPane(cardID)\n            togglePaneVisibility('.js-project-archived-cards-pane', true)\n          }\n        }\n      }\n    }\n  }\n})\n\n// ****************************************************************************\n// Project search pane\n\nfunction togglePaneVisibility(paneClass: string, visible: boolean) {\n  for (const element of document.querySelectorAll(\n    '.js-project-header, .js-project-columns, .js-project-pane, .js-project-small-footer',\n  )) {\n    element.classList.toggle('hide-sm', visible)\n  }\n\n  for (const element of document.querySelectorAll('.js-project-columns')) {\n    element.classList.toggle('push-board-over', visible)\n  }\n\n  for (const pane of document.querySelectorAll(paneClass)) {\n    /* eslint-disable-next-line github/no-d-none */\n    pane.classList.toggle('d-none', !visible)\n    pane.classList.toggle('hide-sm', !visible)\n  }\n}\n\nfunction loadActivityPane() {\n  const fragment = document.querySelector('.js-project-activity-results')\n  if (fragment) {\n    const dataFragmentUrl = fragment.getAttribute('data-project-activity-url')!\n    const url = new URL(dataFragmentUrl, window.location.origin)\n    fragment.setAttribute('src', url.toString())\n  }\n}\n\nfunction loadArchivedCardsPane(cardID?: string) {\n  const fragment = document.querySelector('.js-project-archived-cards-results')\n\n  if (fragment) {\n    const dataFragmentUrl = fragment.getAttribute('data-project-archived-cards-url')!\n    const url = new URL(dataFragmentUrl, window.location.origin)\n    const searchParams = new URLSearchParams(url.search.slice(1))\n\n    if (cardID) {\n      searchParams.append('card_id', cardID)\n    }\n    url.search = searchParams.toString()\n\n    fragment.setAttribute('src', url.toString())\n  }\n}\n\non('click', '.js-show-project-triage', function () {\n  togglePaneVisibility('.js-project-pane', false)\n  togglePaneVisibility('.js-project-menu-pane', true)\n  togglePaneVisibility('.js-project-triage-pane', true)\n\n  const triagePane = document.querySelector<HTMLElement>('.js-project-triage-pane')!\n  triagePane.addEventListener(\n    'animationend',\n    function () {\n      triagePane.querySelector<HTMLInputElement>('.js-project-triage-search-text')!.focus()\n    },\n    {once: true},\n  )\n})\n\non('click', '.js-show-archived-cards', function () {\n  loadArchivedCardsPane()\n  togglePaneVisibility('.js-project-pane', false)\n  togglePaneVisibility('.js-project-menu-pane', true)\n  togglePaneVisibility('.js-project-archived-cards-pane', true)\n})\n\non('click', '.js-show-project-menu', function () {\n  loadActivityPane()\n  togglePaneVisibility('.js-project-pane', false)\n  togglePaneVisibility('.js-project-menu-pane', true)\n})\n\non('click', '.js-hide-project-menu', function () {\n  togglePaneVisibility('.js-project-pane', false)\n})\n\nfunction toggleShowAwaitingTriageIssues(event: Event, show: boolean) {\n  document.querySelector<HTMLInputElement>('.js-show-triage-field')!.value = show ? 'show' : ''\n  refreshAddCardsSearchResults()\n}\n\non('click', '.js-show-triage', function (event) {\n  toggleShowAwaitingTriageIssues(event, true)\n})\n\non('click', '.js-hide-triage', function (event) {\n  toggleShowAwaitingTriageIssues(event, false)\n})\n\nremoteProjectForm('.js-project-search-form', async function (form, send) {\n  if (queryContainsInvalidParam(form)) {\n    const checkbox = form.querySelector<HTMLInputElement>('.js-toggle-linked-repo-scope')!\n    checkbox.checked = false\n  }\n\n  form.classList.add('loading')\n  const response = await send.html()\n  const container = form.closest<HTMLElement>('.js-project-triage-pane')!\n  const searchResults = container.querySelector<HTMLElement>('.js-project-search-results')!\n  searchResults.textContent = ''\n  searchResults.append(response.html)\n  form.classList.remove('loading')\n})\n\nfunction queryContainsInvalidParam(form: Element) {\n  const checkbox = form.querySelector('.js-toggle-linked-repo-scope')\n  const input = form.querySelector<HTMLInputElement>('.js-project-triage-search-text')!\n\n  // If the search is limited to linked repos *AND*\n  // they have entered a `repo:` query\n  // it is an invalid search query\n  if (checkbox instanceof HTMLInputElement && checkbox.checked) {\n    return queryContainsQualifier(input.value, 'repo')\n  } else {\n    return false\n  }\n}\n\nremoteProjectForm('.js-project-activity-form', async function (form, send) {\n  const response = await send.html()\n  const activityPane = form.closest<HTMLElement>('.js-project-activity-pane')!\n  const activityResults = activityPane.querySelector('.js-project-activity-container')\n\n  if (activityResults) {\n    activityResults.textContent = ''\n    activityResults.append(response.html)\n  }\n\n  if (activityPane) {\n    activityPane.classList.remove('Details--on')\n  }\n})\n\n// Remove cards from search pane when they get added to a column\nobserve('.js-project-column-card', function (el: Element) {\n  if (el.getAttribute('data-card-id')) {\n    const contentType = el.getAttribute('data-content-type')!\n    const contentID = el.getAttribute('data-content-id')!\n    const searchPaneCard = document.getElementById(`card-${contentType}-${contentID}`)\n    if (searchPaneCard) {\n      searchPaneCard.remove()\n    }\n  }\n})\n\n// Clean up any cards that may have moved across pages when paginating\n// over card search results so duplicate cards are never displayed.\nfunction cleanupDuplicateSearchCards() {\n  for (const container of document.querySelectorAll('.js-project-search-cards')) {\n    const searchCards = container.querySelectorAll('.js-project-column-card')\n    const cardIDs: {[key: string]: boolean} = {}\n    for (const card of searchCards) {\n      const cardID = card.getAttribute('id')\n      if (cardID) {\n        if (cardIDs.hasOwnProperty(cardID)) {\n          card.remove()\n        }\n        cardIDs[cardID] = true\n      }\n    }\n  }\n}\n\nobserve('.js-more-search-cards-form', {\n  subscribe: form => fromEvent(form, 'page:loaded', cleanupDuplicateSearchCards),\n})\n\n// ****************************************************************************\n// Note interactions\n\nfunction closeNoteForm(target: Element) {\n  const noteFormDetails = target.closest('.js-details-container')\n  if (noteFormDetails) {\n    noteFormDetails.classList.remove('open', 'Details--on')\n  }\n}\n\nfunction onNoteFormKeydown(event: Event) {\n  if (eventToHotkeyString(event as KeyboardEvent) === 'Escape') {\n    closeNoteForm(event.currentTarget as Element)\n  }\n}\n\non('click', '.js-dismiss-note-form-button', function (event) {\n  closeNoteForm(event.currentTarget)\n})\n\nfunction previewNote(noteInput: HTMLInputElement | HTMLTextAreaElement) {\n  const column = noteInput.closest('.js-project-column')\n  if (!column) return\n\n  const previewText = noteInput.value\n  noteInput.setAttribute('data-preview-text', previewText)\n\n  // Only preview note if it looks like it contains a possible reference\n  if (/(gh-|issues\\/|pull\\/|projects\\/|discussions\\/|#)\\d+/.test(previewText)) {\n    const previewForm = column.querySelector<HTMLFormElement>('.js-preview-note-form')!\n\n    ;(previewForm.elements.namedItem('note') as HTMLInputElement).value = previewText\n    requestSubmit(previewForm)\n  } else {\n    column.querySelector<HTMLElement>('.js-note-preview')!.textContent = ''\n  }\n}\n\nonFocus('.js-note-text', function (el: HTMLElement) {\n  const input = el as HTMLTextAreaElement\n  addThrottledInputEventListener(input, previewNote)\n  input.addEventListener(\n    'blur',\n    function onBlur() {\n      removeThrottledInputEventListener(input, previewNote)\n    },\n    {once: true},\n  )\n})\n\nobserve('.js-project-note-form', {\n  subscribe: el => fromEvent(el, 'keyup', onNoteFormKeydown),\n})\n\nremoteProjectForm('.js-preview-note-form', async function (form, wants) {\n  const column = form.closest<HTMLElement>('.js-project-column')!\n  const noteTextArea = column.querySelector<HTMLTextAreaElement>('.js-note-text')!\n  const previewArea = column.querySelector<HTMLElement>('.js-note-preview')!\n\n  let notePreview\n  try {\n    const response = await wants.html()\n    notePreview = response.html\n  } catch (responseError) {\n    // Ignore and clear preview area\n  }\n\n  previewArea.textContent = ''\n  if (notePreview && noteTextArea.getAttribute('data-preview-text') === noteTextArea.value) {\n    previewArea.appendChild(notePreview)\n  }\n})\n\non('tab-container-changed', '.js-project-picker-tabs', async function (event) {\n  const container = event.currentTarget\n  const tab = event.detail.relatedTarget\n  if (!tab) return\n\n  const remoteInput = container.querySelector<RemoteInputElement>('remote-input')!\n  remoteInput.setAttribute('aria-owns', tab.id)\n  remoteInput.src = tab.getAttribute('data-filter-url')!\n})\n\nremoteProjectForm('.js-project-note-form', async function (form, wants) {\n  const textarea = form.querySelector<HTMLTextAreaElement>('textarea')!\n  textarea.disabled = true\n\n  const button = form.querySelector<HTMLButtonElement>('button')!\n  button.disabled = true\n\n  const column = form.closest('.js-project-column')\n\n  if (column) {\n    const noteTextArea = column.querySelector<HTMLElement>('.js-note-text')!\n    noteTextArea.removeAttribute('data-preview-text')\n  }\n\n  let response\n  try {\n    response = await wants.html()\n  } catch (responseError) {\n    // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n    response = responseError.response\n    if (column && response && response.status === 409 && response.html) {\n      const previewArea = column.querySelector<HTMLElement>('.js-note-preview')!\n      previewArea.textContent = ''\n      previewArea.appendChild(response.html)\n    }\n\n    // The response is not html when the status is 422 and the remoteProjectForm\n    // catches a different error and as a result does not show the error message.\n    // So, doing it here instead.\n    if (response && response.status === 422) {\n      await openDialog('project-update-error')\n    }\n\n    button.disabled = false\n    // look, i know you want to remove this, but you really can't! context:\n    // https://github.com/github/github/pull/81537\n    // eslint-disable-next-line github/no-blur\n    textarea.blur()\n    textarea.disabled = false\n    textarea.focus()\n    return\n  }\n\n  if (column) {\n    const previewArea = column.querySelector<HTMLElement>('.js-note-preview')!\n    previewArea.textContent = ''\n    handleCreateNote(column, response.html)\n  } else {\n    handleUpdateNote(form, response.html)\n  }\n\n  // look, i know you want to remove this, but you really can't! context:\n  // https://github.com/github/github/pull/81537\n  // eslint-disable-next-line github/no-blur\n  textarea.blur()\n  textarea.disabled = false\n  changeValue(textarea, '')\n  textarea.focus()\n})\n\nfunction handleCreateNote(column: Element, fragment: DocumentFragment) {\n  const cards = column.querySelector<HTMLElement>('.js-project-column-cards')!\n  cards.prepend(fragment)\n  updateColumnCount(column, 1)\n}\n\nfunction handleUpdateNote(form: HTMLFormElement, fragment: DocumentFragment) {\n  const html = fragment.querySelector('*')\n  const isForm = html && html.classList.contains('js-note-form-container') ? true : false\n\n  if (isForm) {\n    form.closest<HTMLElement>('.js-note-form-container')!.replaceWith(fragment)\n  } else {\n    const id = form.getAttribute('data-card-id')!\n    const card = document.getElementById(`card-${id}`)\n    if (card) card.replaceWith(fragment)\n    form.reset()\n    closeDialog(form)\n  }\n}\n\n//\n// Project note card task list updating\n\n// Enable task list and reset input and checkbox default values so they are no\n// longer marked as dirty and the card can still live update.\nfunction resetTaskList(taskListContainer: HTMLElement) {\n  enableTaskList(taskListContainer)\n\n  const input = taskListContainer.querySelector<HTMLTextAreaElement>('.js-task-list-field')!\n  input.defaultValue = input.value\n\n  for (const checkbox of taskListContainer.querySelectorAll<HTMLInputElement>('.task-list-item-checkbox')) {\n    checkbox.defaultChecked = checkbox.checked\n  }\n}\n\nremoteProjectForm('.js-project-column-card .js-comment-update', async function (form, wants, request) {\n  const container = form.closest<HTMLElement>('.js-task-list-container')!\n  const card = form.closest<HTMLElement>('.js-project-column-card')!\n  const noteVersion = form.getAttribute('data-note-version')!\n  request.headers.set('X-Note-Version', noteVersion)\n\n  let response\n  try {\n    response = await wants.json()\n  } catch (responseError) {\n    // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n    response = responseError.response\n    if (response && response.status === 422 && response.json.stale) {\n      displayUpdateMessage(response.json.message)\n      resetTaskList(container)\n      updateContent(card)\n      return\n    } else {\n      throw responseError\n    }\n  }\n\n  form.setAttribute('data-note-version', response.json.note_version)\n  const note = response.json.note\n  const taskListField = container.querySelector<HTMLTextAreaElement>('.js-task-list-field')!\n  taskListField.value = note\n  const editNoteTemplate = card.querySelector<HTMLTemplateElement>('.js-edit-note-template')!\n  const editFormInput = editNoteTemplate.content.querySelector<HTMLTextAreaElement>('.js-edit-note-input')!\n  editFormInput.textContent = note\n  resetTaskList(container)\n})\n\n//\n// Project card filtering\n\n// Debounce by 1ms to avoid filtering a bunch of times on the initial card load.\nconst debouncedUpdateCardFiltering = debounce(function () {\n  updateFilteredCardCounts()\n  updateFilterState()\n}, 1)\n\non('click', '.js-card-filter-clear', function () {\n  const input = document.querySelector<HTMLInputElement>('.js-card-filter-input')!\n  input.value = ''\n  fire(input, 'input')\n})\n\non('change', '.js-column-purpose-value', function (event) {\n  loadAutomationOptions((event.currentTarget as HTMLInputElement).getAttribute('data-preset-url')!)\n})\n\nasync function loadAutomationOptions(url?: string) {\n  const container = document.querySelector('.js-project-column-automation')\n  if (!container) return\n\n  const form = container.closest<HTMLElement>('.js-column-settings-form')!\n  const optionsContainer = container.querySelector<IncludeFragmentElement>('.js-project-automation-options')!\n  const loader = form.querySelector<HTMLElement>('.js-project-autmoation-loader')!\n  const purposeDetails = form.querySelector<HTMLElement>('.js-column-purpose-details')!\n  const src = url || container.getAttribute('data-src')!\n\n  // Clear existing options before fetching new ones\n  optionsContainer.src = encodeURI(src)\n  optionsContainer.addEventListener('loadstart', () => setOptionsLoading(true))\n  optionsContainer.addEventListener('loadend', () => setOptionsLoading(false))\n\n  function setOptionsLoading(loading: boolean) {\n    purposeDetails.hidden = loading\n    loader.hidden = !loading\n  }\n}\n\n// Load the automation options when the dialog opens\nobserve('.project-dialog .js-project-column-automation', function () {\n  loadAutomationOptions()\n})\n\nobserve('.js-project-column-card', {\n  constructor: HTMLElement,\n  add(card) {\n    filterCard(card)\n    debouncedUpdateCardFiltering()\n  },\n  remove: debouncedUpdateCardFiltering,\n})\n\nobserve('.js-card-filter-input', {\n  constructor: HTMLInputElement,\n  add(el) {\n    el.addEventListener('input', debounce(filterCards, 500))\n\n    addThrottledInputEventListener(el, function () {\n      updateSuggestionsDisplay(el)\n    })\n  },\n})\n\non('focusin', '.js-card-filter-input', function (event) {\n  if (event.currentTarget instanceof HTMLInputElement) {\n    updateSuggestionsDisplay(event.currentTarget)\n  }\n})\n\n// We do this in a delayed focusout to avoid conflicting with a mouse click on\n// an item in the suggestions menu.\non('focusout:delay', '.js-card-filter-input', function () {\n  hideSuggestions()\n})\n\non('click', '.js-card-filter-suggestion', function () {\n  // Restore focus\n  const input = document.querySelector<HTMLInputElement>('.js-card-filter-input')!\n  input.focus()\n})\n\non('click', '.js-card-filter', function (event) {\n  const filter = event.currentTarget.getAttribute('data-card-filter')\n  if (filter) {\n    applyFilter(filter)\n  }\n})\n\non('navigation:keydown', '.js-card-filter-suggester', function (event) {\n  switch (eventToHotkeyString(event.detail.originalEvent)) {\n    case 'Escape':\n      // The default behavior when hitting esc in an input is to clear the\n      // input field. We prevent that behavior so they can hide the menu with\n      // esc.\n      event.preventDefault()\n      hideSuggestions()\n      break\n    case 'ArrowLeft':\n    case 'ArrowRight':\n    case 'Enter':\n      hideSuggestions()\n      break\n  }\n})\n\non('navigation:open', '.js-card-filter-suggester', function (event) {\n  const inputField = document.querySelector('.js-card-filter-input')\n\n  if (inputField instanceof HTMLInputElement) {\n    const suggestionsContainer = document.querySelector<HTMLElement>('.js-card-filter-suggester')!\n    const suggestedText = (event.target as Element).getAttribute('data-value')!\n    const textBeforeCursor = inputField.value.slice(0, inputField.selectionEnd!).replace(/\\S+$/, '')\n    const textAfterCursor = inputField.value.slice(inputField.selectionEnd!)\n\n    /* eslint-disable-next-line github/no-d-none */\n    if (!suggestionsContainer.classList.contains('d-none')) {\n      event.preventDefault()\n      inputField.value = textBeforeCursor + suggestedText + textAfterCursor\n      fire(inputField, 'input')\n      updateSuggestionsDisplay(inputField)\n    }\n\n    hideSuggestions()\n  }\n})\n\nobserve('.js-project-columns-container', {\n  subscribe: el =>\n    fromEvent(el, 'socket:message', async function (event: Event) {\n      const data = (event as CustomEvent).detail.data\n      if (clientUID !== data.client_uid) {\n        const container = event.currentTarget as HTMLElement\n        refreshAddCardsSearchResults()\n        refreshArchivedCardsSearchResults()\n        await verifySsoSession()\n        updateProject(container, data)\n      } else if (data.action === 'column_automation_updated' && data.state != null) {\n        // Update just the footers on these events even from the current user\n        // since adding automation to one column may involve removing it from\n        // another column\n        updateProjectColumnAutomation(data.state)\n      }\n    }),\n})\n\ndocument.addEventListener(\n  'socket:message',\n  function (event: Event) {\n    const {data, name} = (event as CustomEvent).detail\n\n    if (data.locked) {\n      closeLockContainer()\n    }\n\n    if (data.is_project_activity) {\n      const activityPane = document.querySelector('.js-project-activity-pane')\n      activityPane?.classList.add('Details--on')\n    }\n\n    if (name.startsWith('projects:metadata:')) {\n      document.title = data.name\n\n      if (data.project_migration) {\n        const migrateMenuItem = document.querySelector<HTMLButtonElement>('.js-migrate-menu-item')\n        if (migrateMenuItem) {\n          // set the received text content of the menu item to the value returned from the backend\n          migrateMenuItem.textContent = data.project_migration.message\n          migrateMenuItem.setAttribute('disabled', 'disabled')\n        }\n      }\n    }\n  },\n  {capture: true},\n)\n\n// ****************************************************************************\n// Drag and drop setup\n\nfunction fallbackClassForElement(el: HTMLElement): string | undefined {\n  // Set position fixed on mobile so drag element shows up in correct location.\n  // sortablejs sets this value as well but not with !important and this element\n  // is already position-relative which is !important\n  return el.matches('.js-drag-by-handle') ? 'position-fixed' : undefined\n}\n\nfunction handleForElement(el: HTMLElement): string | undefined {\n  // Only allow dragging from the drag handle on mobile so scrolling vs.\n  // dragging can be differentiated when the cards and columns are touched\n  return el.matches('.js-drag-by-handle') ? '.js-project-dragger' : undefined\n}\n\nobserve('.js-project-columns-drag-container', {\n  constructor: HTMLElement,\n  async add(el) {\n    const {Sortable} = await import('./github/sortable-behavior')\n    Sortable.create(el, {\n      animation: 150,\n      draggable: '.js-project-column',\n      filter: '.js-note-text, .js-redacted-project-column-card',\n      preventOnFilter: false,\n      fallbackClass: fallbackClassForElement(el),\n      handle: handleForElement(el),\n      handleReplacedDragElement: true,\n      group: {\n        name: 'project-column',\n        put: false,\n        pull: false,\n      },\n      onMove: handleColumnMove,\n      onUpdate: handleColumnUpdate,\n    })\n  },\n})\n\nobserve('.js-card-drag-container', {\n  constructor: HTMLElement,\n  async add(el) {\n    const {Sortable} = await import('./github/sortable-behavior')\n    Sortable.create(el, {\n      animation: 150,\n      draggable: '.js-project-column-card',\n      filter: '.js-redacted-project-column-card',\n      preventOnFilter: false,\n      fallbackClass: fallbackClassForElement(el),\n      fallbackOnBody: el.matches('.js-drag-by-handle'),\n      handle: handleForElement(el),\n      handleReplacedDragElement: true,\n      group: 'project-card',\n      onAdd: handleCardDrag,\n      onUpdate: handleCardDrag,\n    })\n  },\n})\n\nobserve('.js-project-search-results-drag-container', {\n  constructor: HTMLElement,\n  async add(el) {\n    const {Sortable} = await import('./github/sortable-behavior')\n    Sortable.create(el, {\n      sort: false,\n      animation: 150,\n      draggable: '.js-project-column-card',\n      fallbackClass: fallbackClassForElement(el),\n      fallbackOnBody: el.matches('.js-drag-by-handle'),\n      handle: handleForElement(el),\n      group: {\n        name: 'project-card',\n        put: false,\n        pull: true,\n      },\n      onAdd: handleCardDrag,\n      onUpdate: handleCardDrag,\n    })\n  },\n})\n\n// Remove cards from search pane when they get added to a column\nobserve('.js-project-column-card', function (el: Element) {\n  if (el.getAttribute('data-card-id')) {\n    const contentType = el.getAttribute('data-content-type')!\n    const contentID = el.getAttribute('data-content-id')!\n    const searchPaneCard = document.getElementById(`card-${contentType}-${contentID}`)\n    if (searchPaneCard) {\n      searchPaneCard.remove()\n    }\n  }\n})\n\nobserve('.js-client-uid-field', {\n  constructor: HTMLInputElement,\n  add(el) {\n    el.value = clientUID\n  },\n})\n\n// Set the initial active column to display using the column ID in the URL hash\n// falling back to the first column on the board\nfunction setInitialActiveColumn() {\n  let column\n  if (document.location.hash.startsWith('#column-')) {\n    column = document.getElementById(document.location.hash.substr(1))\n  }\n  // Default to first column when no column id in hash\n  if (!column) {\n    column = document.querySelector('.js-project-column')\n  }\n  if (column) {\n    const columnID = column.getAttribute('data-id')\n    if (columnID) {\n      setActiveColumn(columnID)\n      scrollActiveColumnNavIntoViewIfNeeded()\n    }\n  }\n}\n\n// Ensure there is always an active column by listening for the active column\n// being removed and selecting a new one.\nobserve('.js-project-column[data-active-column]', {\n  remove() {\n    if (!document.querySelector('.js-project-column[data-active-column]')) {\n      setInitialActiveColumn()\n    }\n  },\n})\n\n// Set the column hash in the URL to the given column ID\nfunction setColumnHash(columnID: string) {\n  // Only put column in hash on mobile devices\n  if (!document.querySelector('.js-project-page-mobile')) return\n\n  const anchor = document.createElement('a')\n  anchor.href = encodeURI(`#column-${columnID}`)\n  replaceState(null, '', anchor.href)\n}\n\n// Set the active column displayed to the given column ID\nfunction setActiveColumn(columnID: string) {\n  for (const column of document.querySelectorAll('.js-project-column')) {\n    column.classList.toggle('hide-sm', columnID !== column.getAttribute('data-id'))\n    if (columnID === column.getAttribute('data-id')) {\n      column.setAttribute('data-active-column', '')\n    } else {\n      column.removeAttribute('data-active-column')\n    }\n  }\n\n  for (const nav of document.querySelectorAll('.js-project-column-navigation-item')) {\n    nav.classList.toggle('selected', columnID === nav.getAttribute('data-column-id'))\n  }\n}\n\n// Scroll the nav for the active column into view\nfunction scrollActiveColumnNavIntoViewIfNeeded() {\n  const activeColumn = document.querySelector<HTMLElement>('.js-project-column-navigation-item.selected')\n  if (!activeColumn) return\n\n  const nav = activeColumn.closest<HTMLElement>('.js-project-column-nav')!\n  const activeColumnLeft = activeColumn.offsetLeft\n  const activeColumnWidth = activeColumn.offsetWidth\n  const activeColumnRight = activeColumnLeft + activeColumnWidth\n  const windowWidth = window.innerWidth\n  // Check if active column is offscreen either on the left or the right\n  if (activeColumnRight - nav.scrollLeft > windowWidth || activeColumnRight < nav.scrollLeft) {\n    // Center column nav on screen\n    nav.scrollLeft = activeColumnLeft - windowWidth / 2 + activeColumnWidth / 2\n  }\n}\n\n// Change the active column when the column navigation is clicked\non('click', '.js-project-column-navigation-item', function (event) {\n  event.preventDefault()\n  const columnID = event.currentTarget.getAttribute('data-column-id')!\n  setActiveColumn(columnID)\n  setColumnHash(columnID)\n})\n\n// Open a dialog for the active column\non('click', '.js-open-active-column-dialog', function (event) {\n  const column = document.querySelector('.js-project-column[data-active-column]')\n  if (column) {\n    const columnID = column.getAttribute('data-id')!\n    const prefix = event.currentTarget.getAttribute('data-dialog-prefix')!\n    openDialog(`${prefix}-${columnID}`)\n  }\n})\n\n// Toggle card/column edit mode that enables reordering and moving cards and\n// columns on phones and tablets.\non('click', '.js-toggle-project-edit-mode', function (event) {\n  event.currentTarget.classList.toggle('selected')\n  document.body.classList.toggle('project-edit-mode')\n})\n\n// Build a dialog to display all the columns that the selected card can be\n// moved too\nfunction populateMoveCardDialog(moveCardDialog: Element, button: Element): void {\n  const container = moveCardDialog.querySelector<HTMLElement>('.js-move-card-to-column-dialog-body')!\n  const card = button.closest<HTMLElement>('.js-project-column-card')!\n  const currentColumn = card.closest('.js-project-column')\n  const currentColumnID = currentColumn && currentColumn.getAttribute('data-id')\n  const template = document.querySelector<HTMLTemplateElement>('#move-card-to-column-button-template')!\n  const title = moveCardDialog.querySelector<HTMLElement>('.js-move-card-to-column-title')!\n\n  title.textContent = card.closest('.js-project-archived-cards-pane')\n    ? title.getAttribute('data-restore-title')!\n    : title.getAttribute('data-move-title')!\n\n  container.textContent = ''\n  for (const column of document.querySelectorAll('.js-project-column-navigation-item')) {\n    const columnID = column.getAttribute('data-column-id')!\n    const columnButton = (template.content.cloneNode(true) as DocumentFragment).querySelector<HTMLButtonElement>(\n      '.js-move-card-to-column-button',\n    )!\n    columnButton.setAttribute('data-card-id', card.getAttribute('data-card-id')!)\n    columnButton.setAttribute('data-content-id', card.getAttribute('data-content-id')!)\n    columnButton.setAttribute('data-content-type', card.getAttribute('data-content-type')!)\n    columnButton.setAttribute('data-column-id', columnID)\n    if (button.hasAttribute('data-change-active-column')) {\n      columnButton.setAttribute('data-change-active-column', '')\n    }\n    columnButton.textContent = column.getAttribute('data-column-name')!\n    columnButton.disabled = currentColumnID != null && columnID === currentColumnID\n    container.appendChild(columnButton)\n  }\n}\n\n// Move a card to the column selected from the dialog\non('click', '.js-move-card-to-column-button', function (event) {\n  const cardID = event.currentTarget.getAttribute('data-card-id')!\n  const contentID = event.currentTarget.getAttribute('data-content-id')!\n  const contentType = event.currentTarget.getAttribute('data-content-type')!\n  const columnID = event.currentTarget.getAttribute('data-column-id')!\n\n  const card = findCard(cardID, contentID, contentType)\n  const column = document.querySelector(`.js-project-column[data-id=\"${columnID}\"] .js-project-column-cards`)\n  if (card && column) {\n    if (event.currentTarget.hasAttribute('data-change-active-column')) {\n      setActiveColumn(columnID)\n      setColumnHash(columnID)\n      scrollActiveColumnNavIntoViewIfNeeded()\n    }\n    const fromColumn = card.closest('.js-project-column')\n    column.prepend(card)\n    moveCard(card, fromColumn)\n  }\n})\n\n// Toggle add note form in active column when clicked from the small menu\non('click', '.js-add-note-button', function (event) {\n  event.preventDefault()\n  const addNoteTarget = document.querySelector<HTMLElement>(\n    '.js-project-column[data-active-column] .js-add-note-container .js-details-target',\n  )\n  if (addNoteTarget) {\n    toggleDetailsTarget(addNoteTarget)\n  }\n})\n\non('click', '.js-project-lock-info-button, .js-close-project-lock-popover', toggleLockPopover)\n\nfunction closeLockContainer() {\n  const container = document.querySelector('.js-project-lock-container')\n  if (!container) return\n  const popover = container.querySelector<HTMLElement>('.Popover')!\n  /* eslint-disable-next-line github/no-d-none */\n  const hidden = popover.classList.contains('d-none')\n  /* eslint-disable-next-line github/no-d-none */\n  popover.classList.toggle('d-none', true)\n  if (!hidden) {\n    const activeElement = document.activeElement\n    if (container.contains(activeElement)) {\n      const header = document.querySelector<HTMLElement>('.js-project-header')\n      if (header) {\n        header.focus()\n      }\n    }\n  }\n}\n\nfunction toggleLockPopover() {\n  const popover = document.querySelector<HTMLElement>('.js-project-lock-container .Popover')!\n  /* eslint-disable-next-line github/no-d-none */\n  const hidden = popover.classList.contains('d-none')\n  /* eslint-disable-next-line github/no-d-none */\n  popover.classList.toggle('d-none', !hidden)\n}\n\n// Update the back to link shown in the header of the content details sidebar\nfunction updateContentDetailsBackToLink(cardDetailsPane: Element, fromPane: Element) {\n  const template = cardDetailsPane.querySelector<HTMLTemplateElement>('.js-project-card-details-back-template')!\n  const header = template.content.cloneNode(true) as DocumentFragment\n  const title = fromPane.getAttribute('data-back-to-label')!\n  const backClass = fromPane.getAttribute('data-back-to-class')!\n\n  header.querySelector<HTMLElement>('.js-project-card-details-back-to-title')!.textContent = title\n  header.querySelector<HTMLElement>('.js-project-card-details-back-link')!.classList.add(backClass)\n\n  const container = cardDetailsPane.querySelector<HTMLElement>('.js-project-card-details-back-container')!\n  container.textContent = ''\n  container.appendChild(header)\n}\n\n// Collapse the issue body section of card details if it is too long\nfunction truncateCardDetails() {\n  const wrapper = document.querySelector<HTMLElement>('.js-project-issue-body-wrapper')!\n  const container = document.querySelector<HTMLElement>('.js-project-issue-body-container')!\n\n  const wrapperHeight = wrapper.getBoundingClientRect().height\n  const containerHeight = container.getBoundingClientRect().height\n  const needsTruncation = containerHeight > wrapperHeight\n\n  /* eslint-disable-next-line github/no-d-none */\n  document.querySelector<HTMLElement>('.js-project-issue-body-blur')!.classList.toggle('d-none', !needsTruncation)\n  /* eslint-disable-next-line github/no-d-none */\n  document\n    .querySelector<HTMLElement>('.js-project-issue-body-details-target')!\n    .classList.toggle('d-none', !needsTruncation)\n}\n\n// Show error UI when issue details fails to load\nfunction handleIssueDetailsLoadError(cardDetailsContainer: Element, issueLink: Element) {\n  /* eslint-disable-next-line github/no-d-none */\n  cardDetailsContainer.querySelector<HTMLElement>('.js-project-card-details-error')!.classList.remove('d-none')\n  /* eslint-disable-next-line github/no-d-none */\n  cardDetailsContainer.querySelector<HTMLElement>('.js-project-card-details-loader')!.classList.add('d-none')\n  cardDetailsContainer.querySelector<HTMLElement>('.js-project-card-details-retry')!.addEventListener(\n    'click',\n    function () {\n      // Clear cached URL and reload\n      cardDetailsContainer.removeAttribute('data-issue-url')\n      showIssueDetails(issueLink, false)\n    },\n    {once: true},\n  )\n}\n\n// Create the loading UI shown when loading the details for an issue\nfunction createContentDetailsLoader(issueLink: Element, openedFromOtherPane: boolean) {\n  const issueDetailsContainer = issueLink.closest<HTMLElement>('.js-project-issue-details-container')!\n  const loaderTemplate = document.querySelector<HTMLTemplateElement>('.js-project-card-details-loader-template')!\n  const loader = loaderTemplate.content.cloneNode(true) as DocumentFragment\n\n  const isOpen = issueDetailsContainer.querySelector<SVGElement>('.js-issue-octicon')!.classList.contains('open')\n  loader.querySelector<HTMLElement>('.js-issue-title')!.textContent = issueLink.textContent\n  loader.querySelector<HTMLElement>('.js-issue-number')!.textContent =\n    issueDetailsContainer.querySelector<HTMLElement>('.js-issue-number')!.textContent\n  loader.querySelector<HTMLElement>('.js-issue-state')!.textContent = isOpen ? 'Close' : 'Reopen'\n  const contentLabel = issueLink.getAttribute('data-content-label')!\n  for (const issueType of loader.querySelectorAll('.js-issue-type')) {\n    issueType.textContent = contentLabel\n  }\n\n  for (const externalLink of loader.querySelectorAll('.js-project-card-details-external-link')) {\n    externalLink.setAttribute('href', issueLink.getAttribute('href') || '#')\n    // eslint-disable-next-line i18n-text/no-en\n    externalLink.setAttribute('data-ga-click', `Project board, go to ${contentLabel}, location:sidebar`)\n  }\n\n  /* eslint-disable-next-line github/no-d-none */\n  loader.querySelector<HTMLElement>('.js-hide-project-menu')!.classList.toggle('d-none', openedFromOtherPane)\n  const repoLink = loader.querySelector<HTMLElement>('.js-issue-repository')!\n  repoLink.textContent = issueLink.getAttribute('data-content-repo-label')!\n  const repoEncodedUrl = encodeURI(issueLink.getAttribute('data-content-repo-url') || '#')\n  repoLink.setAttribute('href', repoEncodedUrl)\n  const octicon = loader.querySelector<HTMLElement>('.js-project-card-details-loader-octicon')!\n  octicon.textContent = ''\n  octicon.appendChild(issueDetailsContainer.querySelector<Element>('.js-issue-octicon')!.cloneNode(true))\n\n  return loader\n}\n\n// Show the details for the given issue link in the sidebar pane.\nasync function showIssueDetails(issueLink: Element, shiftFocus: boolean) {\n  // TODO Replace with query once this element is always rendered\n  const cardDetailsPane = document.querySelector('.js-project-card-details-pane')\n  if (!cardDetailsPane) {\n    return false\n  }\n\n  const issueURL = issueLink.getAttribute('href')!\n  const cardDetailsContainer = cardDetailsPane.querySelector<HTMLElement>('.js-project-card-details')!\n  const fromPane = issueLink.closest('.js-project-pane')\n  const openedFromOtherPane = fromPane != null\n\n  togglePaneVisibility('.js-project-card-details-pane', true)\n  /* eslint-disable-next-line github/no-d-none */\n  cardDetailsPane\n    .querySelector<HTMLElement>('.js-project-card-details-header')!\n    .classList.toggle('d-none', !openedFromOtherPane)\n  if (fromPane) {\n    updateContentDetailsBackToLink(cardDetailsPane, fromPane)\n  }\n\n  // Don't reload if the details for this content are already showing\n  if (issueURL === cardDetailsContainer.getAttribute('data-issue-url')) {\n    if (shiftFocus) {\n      focusCardDetailsTitle()\n    }\n    return\n  }\n\n  const loader = createContentDetailsLoader(issueLink, openedFromOtherPane)\n  cardDetailsContainer.textContent = ''\n  cardDetailsContainer.appendChild(loader)\n  cardDetailsContainer.setAttribute('data-issue-url', issueURL)\n\n  let html\n  try {\n    html = await fetchSafeDocumentFragment(document, `${issueURL}/show_from_project`)\n  } catch (fetchError) {\n    handleIssueDetailsLoadError(cardDetailsContainer, issueLink)\n    return\n  }\n\n  if (cardDetailsContainer.getAttribute('data-issue-url') === issueURL) {\n    // Hide close menu in details if shown in header that links back to previous pane\n    const hideMenu = html.querySelector('.js-hide-project-menu')\n    if (hideMenu) {\n      /* eslint-disable-next-line github/no-d-none */\n      hideMenu.classList.toggle('d-none', openedFromOtherPane)\n    }\n\n    cardDetailsContainer.textContent = ''\n    cardDetailsContainer.appendChild(html)\n    truncateCardDetails()\n\n    if (shiftFocus) {\n      focusCardDetailsTitle()\n    }\n  }\n}\n\nfunction focusCardDetailsTitle() {\n  const cardDetailsPane = document.querySelector('.js-project-card-details-pane')\n  if (!cardDetailsPane) {\n    return\n  }\n\n  const externalLink = cardDetailsPane.querySelector<HTMLElement>('.js-project-card-details-external-link')!\n  externalLink.focus()\n}\n\n// Truncate card details whenever the issue description is updated in the sidebar\nafterRemote(function (form) {\n  if (form.matches('.js-project-card-details-pane .js-comment .js-comment-update')) {\n    truncateCardDetails()\n  }\n})\n\non('click', '.js-hide-project-card-details', function () {\n  // Clear cached content id so pane reloads on next open\n  const cardDetailsContainer = document.querySelector<HTMLElement>('.js-project-card-details')!\n  cardDetailsContainer.removeAttribute('data-issue-url')\n  cardDetailsContainer.textContent = ''\n})\n\nfunction onCardKeydown(event: KeyboardEvent) {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable @github-ui/ui-commands/no-manual-shortcut-logic */\n  if (event.key !== 'd') {\n    return\n  }\n  /* eslint-enable @github-ui/ui-commands/no-manual-shortcut-logic */\n\n  const card = event.currentTarget as Element\n  const links = card.querySelectorAll('.js-project-card-issue-link')\n  // Only handle pressing d key with card selected if card only contains\n  // a single issue link since cards may contain multiple issue references.\n  if (links.length === 1) {\n    showIssueDetails(links[0]!, true)\n    event.preventDefault()\n  }\n}\n\nonFocus('.js-project-column-card', function (card) {\n  card.addEventListener('keydown', onCardKeydown)\n  card.addEventListener(\n    'blur',\n    function () {\n      card.removeEventListener('keydown', onCardKeydown)\n    },\n    {once: true},\n  )\n})\n\n// Should issue link clicks be overridden to open in the sidebar instead?\nfunction overrideCardLinkClick(event: MouseEvent): boolean {\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable @github-ui/ui-commands/no-manual-shortcut-logic */\n  // Don't override clicks with special buttons also pressed\n  if (event.metaKey) return false\n  if (event.ctrlKey) return false\n  if (event.altKey) return false\n  if (event.shiftKey) return false\n  /* eslint-enable @github-ui/ui-commands/no-manual-shortcut-logic */\n\n  // Only handle left button clicks\n  if (event.button !== 0) return false\n  return true\n}\n\non('click', '.js-project-card-issue-link', function (event) {\n  if (overrideCardLinkClick(event)) {\n    showIssueDetails(event.currentTarget, false)\n    event.preventDefault()\n  }\n})\n\nremoteProjectForm('.js-project-card-issue-details-title', async function (form, send) {\n  const container = form.closest<HTMLElement>('.js-details-container')!\n  const response = await send.json()\n\n  // Close the edit title UI\n  toggleDetailsTarget(container)\n\n  // Update the issue title displayed to the new value\n  if (response.json.issue_title != null) {\n    container.querySelector<HTMLElement>('.js-issue-title')!.textContent = response.json.issue_title\n  }\n\n  // Reset the default values on all form elements to their updated values\n  for (const field of form.elements) {\n    if (field instanceof HTMLInputElement || field instanceof HTMLTextAreaElement) {\n      field.defaultValue = field.value\n    }\n  }\n})\n\n// ****************************************************************************\n// Project create\n\nfunction checkLinkedReposCount() {\n  const repoList = document.querySelector<HTMLElement>('.js-project-create-linked-repo-list')!\n  const repoListBlankslate = repoList.querySelector<HTMLElement>('.js-blankslate')!\n  const linkRepoSearchInputGroup = document.querySelector<HTMLElement>(\n    '.js-project-create-linked-repo-search-input-group',\n  )!\n  const linkedReposMaxMessage = document.querySelector<HTMLElement>('.js-project-create-linked-repo-max')!\n  const linkedReposCount = repoList.querySelectorAll('.js-project-repo-link-badge').length\n  const maxLinkedReposCount = parseInt(linkedReposMaxMessage.getAttribute('data-max')!, 10)\n  const maxLinkedReposReached = linkedReposCount >= maxLinkedReposCount\n\n  /* eslint-disable-next-line github/no-d-none */\n  linkRepoSearchInputGroup.classList.toggle('d-none', maxLinkedReposReached)\n  /* eslint-disable-next-line github/no-d-none */\n  linkedReposMaxMessage.classList.toggle('d-none', !maxLinkedReposReached)\n  /* eslint-disable-next-line github/no-d-none */\n  repoListBlankslate.classList.toggle('d-none', linkedReposCount > 0)\n}\n\n// Add a selected repo to the list and clear the search box\non('auto-complete-change', '.js-project-create-repo-link-auto-complete', function (event) {\n  const autoComplete = event.target as AutocompleteElement\n  const linkedRepoBadge = autoComplete.querySelector(\n    `.js-project-repo-link-badge[data-repo-name=\"${autoComplete.value}\"]`,\n  )\n  if (!linkedRepoBadge) {\n    return\n  }\n\n  const repoList = document.querySelector<HTMLElement>('.js-project-create-linked-repo-list')!\n  const repoIdInput = linkedRepoBadge.querySelector<HTMLInputElement>('.js-repo-id')!\n  let repoAlreadyLinked = false\n\n  // Check for duplicate repos\n  for (const input of repoList.querySelectorAll<HTMLInputElement>('.js-repo-id')) {\n    if (input.value === repoIdInput.value) {\n      repoAlreadyLinked = true\n      break\n    }\n  }\n\n  if (!repoAlreadyLinked) {\n    repoIdInput.disabled = false\n    repoList.append(linkedRepoBadge)\n    /* eslint-disable-next-line github/no-d-none */\n    linkedRepoBadge.classList.remove('d-none')\n  }\n\n  autoComplete.value = ''\n\n  checkLinkedReposCount()\n})\n\n// Remove a selected repo from the list\non('click', '.js-remove-project-repo-link', function (event) {\n  const badge = (event.target as Element).closest<HTMLElement>('.js-project-repo-link-badge')!\n  badge.remove()\n  checkLinkedReposCount()\n})\n\n// Don't let users accidentally submit the form when you hit enter\nonKey('keydown', '.js-project-create-linked-repo-search', function (event: KeyboardEvent) {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable @github-ui/ui-commands/no-manual-shortcut-logic */\n  if (event.key === 'Enter') {\n    event.preventDefault()\n  }\n  /* eslint-enable @github-ui/ui-commands/no-manual-shortcut-logic */\n})\n\n// Display the project migration dialog to the user\n//\n// This is necessary because classic projects have their own dialog infrastructure that\n// we cannot reimplement in Primer components, so we need to intercept and manually\n// display this new dialog\nfunction openMigrateDialog() {\n  const modal = document.querySelector<ModalDialogElement | HTMLDialogElement>('.js-migrate-project-dialog')\n  if (modal instanceof HTMLDialogElement) {\n    modal.showModal()\n  } else if (modal) {\n    modal.show()\n  }\n}\n\nasync function openMigrateDialogOnLoad() {\n  await loaded\n\n  const params = new URLSearchParams(location.search)\n  if (params.get('migrate')?.toLowerCase() !== 'confirm') {\n    return\n  }\n\n  params.delete('migrate')\n  history.replaceState(null, '', location.pathname)\n\n  openMigrateDialog()\n}\n\n// Open the dialog associated with the clicked button\non('click', '.js-project-dialog-button', function ({currentTarget}) {\n  const dialogID = currentTarget.getAttribute('data-dialog-id')!\n\n  if (dialogID === 'migrate-project') {\n    // handle the new menu item separate from others, as this dialog\n    // is not implemented in the same way\n    openMigrateDialog()\n    return\n  }\n\n  openDialog(dialogID, currentTarget)\n})\n\n// Handle the click event for the \"Start migration\" button and\n// open the new migration dialog\non('click', '.js-project-migrate-banner-button', function ({currentTarget}) {\n  const dialogID = currentTarget.getAttribute('data-dialog-id')!\n\n  if (dialogID === 'migrate-project') {\n    openMigrateDialog()\n  }\n})\n\non('click', '.js-project-card-closing-issue-summary', function ({currentTarget}) {\n  const card = currentTarget.closest<HTMLElement>('.js-project-column-card')!\n  card.focus()\n})\n\n// Open the dialog scoped to the active column\non('click', '.js-project-active-column-dialog-button', async function ({currentTarget}) {\n  const dialogID = currentTarget.getAttribute('data-dialog-id')!\n  const moveCardDialog = await openDialog(dialogID, currentTarget)\n  populateMoveCardDialog(moveCardDialog, currentTarget)\n})\n\n// TODO: details-menu selected text outside of menu sync\non(\n  'details-menu-select',\n  '.js-project-change-state-sync-menu',\n  function (event) {\n    const target = event.detail.relatedTarget as Element\n    const container = target.closest<HTMLElement>('.js-project-change-state-sync-menu-parent')!\n    const selectedItem = target.querySelector<HTMLElement>('[data-menu-button-text]')!.textContent!.trim()\n    container.querySelector<HTMLElement>('.js-project-change-state-sync-menu-button')!.textContent = selectedItem\n  },\n  {capture: true},\n)\n\non('click', '.js-project-card-closing-issue-summary', function ({currentTarget}) {\n  const parent = currentTarget.closest<HTMLElement>('.Details-element')!\n  const expand = parent.hasAttribute('open') === false\n\n  const hmacAttribute = expand ? 'data-linked-pr-hmac-expanded' : 'data-linked-pr-hmac-collapsed'\n  const hydroEventHmac = currentTarget.getAttribute(hmacAttribute) || ''\n\n  const payloadAttribute = expand ? 'data-linked-pr-expanded' : 'data-linked-pr-collapsed'\n  const hydroEventPayload = currentTarget.getAttribute(payloadAttribute) || ''\n\n  const stat = {hydroEventPayload, hydroEventHmac, hydroClientContext: ''}\n  sendStats(stat, true)\n})\n\nenableKeyboardMovements(moveCard, moveColumn)\nsetInitialActiveColumn()\nopenMigrateDialogOnLoad()\n","// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport {toggleDetailsTarget} from '../behaviors/details'\n\non('submit', '.js-project-name-update', async function (event) {\n  const form = event.currentTarget as HTMLFormElement\n  const container = form.closest<HTMLElement>('.js-details-container')!\n\n  event.preventDefault()\n  let response\n  let json\n\n  try {\n    response = await fetch(form.action, {\n      method: form.method,\n      body: new FormData(form),\n      headers: {\n        Accept: 'application/json',\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    })\n    json = await response.json()\n  } catch {\n    // Ignore network errors\n  }\n\n  if (response && !response.ok) {\n    const formGroup = form.querySelector<HTMLElement>('.js-project-form-group')\n    const errorContainer = container.querySelector<HTMLElement>('.js-project-form-error')\n    const fallbackErrorMessage = form.getAttribute('data-fallback-error-message')\n\n    if (errorContainer) {\n      errorContainer.textContent = json.errors?.[0] || fallbackErrorMessage\n    }\n\n    if (formGroup) {\n      formGroup.classList.add('errored')\n    }\n  } else if (json) {\n    container.querySelector<HTMLElement>('.js-project-name-label')!.textContent = json.project_name\n    toggleDetailsTarget(container, {force: false})\n\n    // bust the hovercard cache by updating the `ts` querystring value\n    const hoverCard = container.querySelector<HTMLElement>('.js-project-hovercard')\n    if (hoverCard) {\n      const path = hoverCard.getAttribute('data-hovercard-url')\n      const timestampRegex = /\\?ts=(.+)$/\n\n      if (path?.match(timestampRegex)) {\n        hoverCard.setAttribute('data-hovercard-url', path.replace(timestampRegex, `?ts=${Date.now()}`))\n      }\n    }\n  }\n\n  // prevent `Failed to update content with interactions` warnings\n  resetDefaultFormValues(form)\n\n  // reset the disable-with on the submit button\n  fire(form, 'deprecatedAjaxComplete')\n})\n\nfunction resetDefaultFormValues(form: HTMLFormElement) {\n  // Here, we reset the form's input fields' `defaultValue`s.\n  // We have to take this step because of the .js-updatable-content\n  // handler, which we rely on to \"live-update\" the form.\n  //\n  // If the form's input fields are in a \"dirty\" state, the handler\n  // will refuse to replace the div with our data-url show_partial's\n  // content. Consequently, we reset the fields' state.\n\n  for (const field of form.elements) {\n    if (field instanceof HTMLInputElement || field instanceof HTMLTextAreaElement) {\n      field.defaultValue = field.value\n    }\n  }\n}\n","import {animationFrame} from '@github-ui/eventloop-tasks'\n\n// Based on FLIP animation technique.\n//   https://aerotwist.com/blog/flip-your-animations/\n\ninterface PositionMap<K, V> {\n  get(key: K): V | undefined\n}\n\nexport function recordPositions(nodeList: NodeListOf<HTMLElement>): PositionMap<HTMLElement, DOMRect> {\n  const positions = new WeakMap()\n  for (const card of nodeList) {\n    positions.set(card, card.getBoundingClientRect())\n  }\n  return positions\n}\n\nasync function invertPosition(\n  el: HTMLElement,\n  oldPositions: PositionMap<HTMLElement, DOMRect>,\n  newPositions: PositionMap<HTMLElement, DOMRect>,\n  transformTime = 500,\n) {\n  const oldPosition = oldPositions.get(el)!\n  const newPosition = newPositions.get(el)!\n\n  const deltaX = oldPosition.left - newPosition.left\n  const deltaY = oldPosition.top - newPosition.top\n\n  if (deltaX === 0 && deltaY === 0) {\n    return\n  }\n\n  await animationFrame()\n\n  el.style.transform = `translateZ(0) translate(${deltaX}px, ${deltaY}px)`\n  el.style.transition = 'transform 0s'\n\n  await animationFrame()\n\n  el.style.transform = ''\n  el.style.transition = `transform ${transformTime}ms`\n\n  await new Promise(resolve => el.addEventListener('transitionend', resolve, {once: true}))\n\n  el.style.transition = ''\n}\n\nexport function animate(\n  nodeList: NodeListOf<HTMLElement>,\n  originalPositions: PositionMap<HTMLElement, DOMRect>,\n  transformTime = 500,\n): Promise<unknown> {\n  const newPositions = recordPositions(nodeList)\n  const animations = []\n  for (const el of nodeList) {\n    animations.push(invertPosition(el, originalPositions, newPositions, transformTime))\n  }\n  return Promise.all(animations)\n}\n","import {isShortcutAllowed} from '@github-ui/hotkey/keyboard-shortcuts-helper'\nimport {onFocus} from '@github-ui/onfocus'\n\n// TODO: Refactor to use data-hotkey\n/* eslint eslint-comments/no-use: off */\n/* eslint-disable @github-ui/ui-commands/no-manual-shortcut-logic */\n\ntype KeyboardMoveOptions = {keyboardMove?: boolean}\ntype State = {columns: Array<{id: number; card_ids: number[]}>}\n\nconst useCtrlKeyAsMeta = !navigator.userAgent.match(/Macintosh/)\n\n// Return action to perform or original key\nfunction getAction(key: string): string {\n  switch (key) {\n    case ' ':\n      return 'Space'\n    case 'ArrowUp':\n    case 'k':\n    case 'K':\n      return 'up'\n    case 'ArrowDown':\n    case 'j':\n    case 'J':\n      return 'down'\n    case 'ArrowLeft':\n    case 'h':\n    case 'H':\n      return 'left'\n    case 'ArrowRight':\n    case 'l':\n    case 'L':\n      return 'right'\n    case 'Enter':\n      return 'confirm'\n    case 'Escape':\n      return 'cancel'\n    default:\n      return key\n  }\n}\n\n// Base class for column and card moves\nclass ItemMove {\n  item: HTMLElement\n  onDone: () => void\n  blurListener: (event: FocusEvent) => void\n  moved: boolean\n  moveInProgress: boolean\n  blurring: boolean\n\n  constructor(item: HTMLElement, onDone: () => void) {\n    this.item = item\n    this.onDone = onDone\n    this.moved = false\n    this.moveInProgress = false\n    this.blurring = false\n\n    this.blurListener = this.handleBlur.bind(this)\n    this.item.addEventListener('blur', this.blurListener)\n\n    this.item.classList.add('moving')\n  }\n\n  handleBlur(event: FocusEvent) {\n    if (!this.moveInProgress && event.relatedTarget) {\n      this.blurring = true\n      this.cancel()\n    }\n  }\n\n  isMetaKeyPressed(event: KeyboardEvent) {\n    return useCtrlKeyAsMeta ? event.ctrlKey : event.metaKey\n  }\n\n  // Is this item in the pending column?\n  inPendingColumn(): boolean {\n    return this.item.closest('.js-project-pending-cards') != null\n  }\n\n  // Find a column by its ID\n  findColumn(columnID: string): HTMLElement | null {\n    return columnID ? document.querySelector<HTMLElement>(`.js-project-column[data-id=\"${columnID}\"]`) : null\n  }\n\n  // Find a card by its ID\n  findCard(cardID: string): HTMLElement | null {\n    if (!cardID) return null\n    let card = document.querySelector<HTMLElement>(`.js-project-column-card[data-card-id=\"${cardID}\"]`)\n    if (!card) {\n      card = document.querySelector<HTMLElement>(`.js-project-column-card[data-content-id=\"${cardID}\"]`)\n    }\n    return card\n  }\n\n  // Is the given element a column?\n  isColumn(column: Element | null): boolean {\n    return column != null ? column.classList.contains('js-project-column') : false\n  }\n\n  // Get the column the item is in\n  getColumn(): Element | null {\n    return this.item.closest('.js-project-column')\n  }\n\n  // Get the pane the item is in\n  getPane(): Element | null {\n    return this.item.closest('.js-project-pane')\n  }\n\n  // Ge the name of the column the item is in\n  getColumnName(): string {\n    const column = this.getColumn()\n    const label = column && column.querySelector('.js-project-column-name')\n    return label ? label.textContent! : ''\n  }\n\n  // Get the project columns container\n  getColumnsContainer(): HTMLElement {\n    return document.querySelector<HTMLElement>('.js-project-columns-container')!\n  }\n\n  // Get the column to the right of the current column\n  getNextColumn(): Element | null {\n    const column = this.getColumn()\n    if (column) {\n      const nextColumn = column.nextElementSibling\n      if (this.isColumn(nextColumn)) {\n        return nextColumn\n      }\n    }\n    return null\n  }\n\n  // Get the column to the left of the current column\n  getPreviousColumn(): Element | null {\n    const column = this.getColumn()\n    if (column) {\n      const previousColumn = column.previousElementSibling\n      if (this.isColumn(previousColumn)) {\n        return previousColumn\n      }\n    }\n    return null\n  }\n\n  // Get the first column\n  getFirstColumn(): HTMLElement | null {\n    return this.getColumnsContainer().querySelector('.js-project-column')\n  }\n\n  // Get the last column\n  getLastColumn(): HTMLElement | undefined {\n    const columns = this.getColumnsContainer().querySelectorAll<HTMLElement>('.js-project-column')\n    return columns[columns.length - 1]\n  }\n\n  // Get the ID for the given card\n  getCardID(card?: Element | null): string {\n    if (!card) return ''\n    return card.getAttribute('data-card-id') || card.getAttribute('data-content-id') || ''\n  }\n\n  // Get the ID for the given column\n  getColumnID(column?: Element | null): string {\n    if (!column) return ''\n    return column.getAttribute('data-id') || ''\n  }\n\n  // Is the specified item actively being moved?\n  isMoving(item?: HTMLElement) {\n    return item === this.item\n  }\n\n  // Update the aria-label for this item\n  updateAriaLabel() {\n    // This needs to be implemented as a empty function so a sub class can run a cancel callback in the constructor.\n  }\n\n  // Move the item using the given function, does state tracking and\n  // re-focusing\n  moveTransaction(mover: (el: HTMLElement) => void) {\n    try {\n      this.moveInProgress = true\n      mover(this.item)\n      if (!this.blurring) {\n        this.updateAriaLabel()\n        this.item.focus()\n      }\n    } finally {\n      this.moved = true\n      this.moveInProgress = false\n    }\n  }\n\n  // The move has either completed or was canceled\n  done() {\n    this.item.removeEventListener('blur', this.blurListener)\n    this.item.classList.remove('moving')\n    this.item.removeAttribute('aria-label')\n    this.onDone()\n  }\n\n  cancel() {\n    // This needs to be implemented as a empty function so a sub class can run a cancel callback in the constructor.\n  }\n}\n\n// Re-order or move a card between columns using the keyboard\nclass CardMove extends ItemMove {\n  columnID: string\n  previousCardID: string\n  moveCard: (el: HTMLElement, el2?: HTMLElement | null, opts?: KeyboardMoveOptions) => void\n  keydownListener: (event: KeyboardEvent) => void\n  updateStartListener: (event: Event) => void\n  updateEndListener: () => void\n  pendingCard: boolean\n  paneColumnCards?: Element | null\n  updateSnapshot?: {columnID: string; indexInColumn: number} | null\n\n  constructor(\n    card: HTMLElement,\n    moveCard: (el: HTMLElement, el2?: HTMLElement | null, opts?: KeyboardMoveOptions) => void,\n    onDone: () => void,\n  ) {\n    super(card, onDone)\n    this.moveCard = moveCard\n    this.pendingCard = this.inPendingColumn()\n    if (this.getPane()) {\n      this.paneColumnCards = card.closest('.js-project-column-cards')\n    }\n    this.columnID = this.getColumnID(this.getColumn())\n    this.previousCardID = this.getCardID(card.previousElementSibling)\n\n    this.keydownListener = this.handleKeydown.bind(this)\n    this.item.addEventListener('keydown', this.keydownListener)\n\n    this.updateStartListener = this.handleUpdateStart.bind(this)\n    this.getColumnsContainer().addEventListener('will-update-project', this.updateStartListener)\n    this.updateEndListener = this.handleUpdateEnd.bind(this)\n    this.getColumnsContainer().addEventListener('update-project', this.updateEndListener)\n  }\n\n  override updateAriaLabel() {\n    const index = this.getCardIndex()\n    const indexLabel = index >= 0 ? `to position ${index + 1} of ${this.getCardCount()}` : ''\n    const columnLabel = `in ${this.getColumnName()} column`\n    this.item.setAttribute('aria-label', `Moved card ${indexLabel} ${columnLabel}`.trim())\n  }\n\n  handleUpdateStart(event: Event) {\n    const column = this.getColumn()\n    // Card is no longer on the DOM\n    if (!column) {\n      this.done()\n      return\n    }\n\n    // Card is no longer on the board\n    if (!this.paneColumnCards && !this.updatePreviousPosition((event as CustomEvent).detail)) {\n      this.done()\n      return\n    }\n\n    // Column is no longer in the project so abort the move\n    const columnID = this.getColumnID(column)\n    if (!this.isColumnInState((event as CustomEvent).detail, columnID)) {\n      this.done()\n      return\n    }\n\n    // Store current index and column to move card back to after update\n    this.updateSnapshot = {\n      columnID,\n      indexInColumn: this.getCardIndex(),\n    }\n  }\n\n  handleUpdateEnd() {\n    const snapshot = this.updateSnapshot\n    this.updateSnapshot = null\n\n    if (!snapshot || !this.getColumn()) {\n      this.done()\n      return\n    }\n\n    const card = this.findCard(this.getCardID(this.item))\n    const column = this.getColumnCards(this.findColumn(snapshot.columnID))\n    if (card && column) {\n      // Move card back to pending location\n      this.moveToColumn(column)\n      const afterCard = column.children[snapshot.indexInColumn]!\n      if (card !== afterCard) {\n        this.moveToBeforeCard(column, afterCard)\n      }\n    }\n  }\n\n  handleKeydown(event: KeyboardEvent) {\n    const metaKey = this.isMetaKeyPressed(event)\n    if (!isShortcutAllowed(event)) return\n\n    switch (getAction(event.key)) {\n      case 'up':\n        if (metaKey) {\n          this.moveToTop()\n        } else {\n          this.moveUp()\n        }\n        event.preventDefault()\n        break\n      case 'down':\n        if (metaKey) {\n          this.moveToBottom()\n        } else {\n          this.moveDown()\n        }\n        event.preventDefault()\n        break\n      case 'left':\n        if (metaKey) {\n          this.moveToFirstColumn(event.shiftKey)\n        } else {\n          this.moveLeft(event.shiftKey)\n        }\n        event.preventDefault()\n        break\n      case 'right':\n        if (metaKey) {\n          this.moveToLastColumn(event.shiftKey)\n        } else {\n          this.moveRight(event.shiftKey)\n        }\n        event.preventDefault()\n        break\n      case 'confirm':\n        this.confirm()\n        event.preventDefault()\n        break\n      case 'cancel':\n        this.cancel()\n        event.preventDefault()\n        break\n    }\n  }\n\n  // Update the previous position this card was in from the project model\n  updatePreviousPosition(state: State): boolean {\n    if (!state || !state.columns) return false\n\n    const cardID = this.getCardID(this.item)\n    for (const column of state.columns) {\n      for (let index = 0; index < column.card_ids.length; index++) {\n        if (cardID === column.card_ids[index]!.toString()) {\n          this.previousCardID = column.card_ids[index - 1]!.toString()\n          this.columnID = column.id.toString()\n          return true\n        }\n      }\n    }\n    return false\n  }\n\n  isColumnInState(state: State, columnID: string): boolean {\n    if (!state || !state.columns) return false\n\n    for (const column of state.columns) {\n      if (columnID === column.id.toString()) {\n        return true\n      }\n    }\n    return false\n  }\n\n  getCardIndex(): number {\n    const column = this.getColumnCards(this.getColumn())\n    return column ? Array.from(column.children).indexOf(this.item) : -1\n  }\n\n  getCardCount(): number {\n    const column = this.getColumnCards(this.getColumn())\n    return column ? column.querySelectorAll('.js-project-column-card').length : 0\n  }\n\n  getColumnCards(column?: Element | null): Element | null {\n    return column != null ? column.querySelector('.js-project-column-cards') : null\n  }\n\n  moveToBeforeCard(column: Element, afterCard: Element) {\n    this.moveTransaction(function (card) {\n      column.insertBefore(card, afterCard)\n    })\n  }\n\n  moveToColumn(column: Element) {\n    this.moveTransaction(function (card) {\n      column.appendChild(card)\n    })\n  }\n\n  // Move the card up one position\n  moveUp() {\n    const previousCard = this.item.previousElementSibling\n    const column = this.getColumnCards(this.getColumn())\n    if (previousCard && column) {\n      this.moveToBeforeCard(column, previousCard)\n    }\n  }\n\n  // Move the card to the top of the column\n  moveToTop() {\n    const column = this.getColumnCards(this.getColumn())\n    if (column) {\n      this.moveTransaction(function (card) {\n        column.prepend(card)\n      })\n    }\n  }\n\n  // Move the card down one position\n  moveDown() {\n    const nextCard = this.item.nextElementSibling\n    const column = this.getColumnCards(this.getColumn())\n    if (nextCard && column) {\n      const afterCard = nextCard.nextElementSibling\n      if (afterCard) {\n        this.moveToBeforeCard(column, afterCard)\n      } else {\n        this.moveToBottom()\n      }\n    } else {\n      this.moveToBottom()\n    }\n  }\n\n  // Move the card to the bottom of the column\n  moveToBottom() {\n    const column = this.getColumnCards(this.getColumn())\n    if (column) {\n      this.moveToColumn(column)\n    }\n  }\n\n  // Move the card to the leftmost column\n  moveToFirstColumn(topOfColumn: boolean) {\n    const firstColumn = this.getColumnCards(this.getFirstColumn())\n    if (firstColumn) {\n      this.moveToColumn(firstColumn)\n      if (topOfColumn) this.moveToTop()\n    }\n  }\n\n  // Move the card to the rightmost column\n  moveToLastColumn(topOfColumn: boolean) {\n    const lastColumn = this.getColumnCards(this.getLastColumn())\n    if (lastColumn) {\n      this.moveToColumn(lastColumn)\n      if (topOfColumn) this.moveToTop()\n    }\n  }\n\n  // Move the card to the column on the left\n  moveLeft(topOfColumn: boolean) {\n    const targetColumn = this.getColumnCards(this.getPane() ? this.getLastColumn() : this.getPreviousColumn())\n    if (targetColumn) {\n      this.moveToColumn(targetColumn)\n      if (topOfColumn) this.moveToTop()\n    }\n  }\n\n  // Move the card to the column on the right\n  moveRight(topOfColumn: boolean) {\n    const nextColumn = this.getColumnCards(this.getNextColumn())\n    if (nextColumn) {\n      this.moveToColumn(nextColumn)\n      if (topOfColumn) this.moveToTop()\n    }\n  }\n\n  override done() {\n    super.done()\n    this.item.removeEventListener('keydown', this.keydownListener)\n    this.getColumnsContainer().removeEventListener('will-update-project', this.updateStartListener)\n    this.getColumnsContainer().removeEventListener('update-project', this.updateEndListener)\n  }\n\n  // Move card to new position\n  confirm() {\n    if (this.moved) {\n      let fromColumn = this.findColumn(this.columnID)\n      if (this.pendingCard && !fromColumn) {\n        fromColumn = document.querySelector('.js-project-pending-cards-container.js-project-column')\n      }\n      this.moveCard(this.item, fromColumn, {keyboardMove: true})\n    }\n    this.done()\n  }\n\n  // Restore card to original position\n  override cancel() {\n    let column\n    let afterCard\n    if (this.moved) {\n      if (this.previousCardID) {\n        const previousCard = this.findCard(this.previousCardID)\n        if (previousCard) {\n          column = previousCard.closest('.js-project-column-cards')\n          afterCard = previousCard.nextElementSibling\n        }\n      } else if (this.columnID) {\n        column = this.getColumnCards(this.findColumn(this.columnID))\n        if (column) {\n          afterCard = column.firstElementChild\n        }\n      } else if (this.paneColumnCards) {\n        column = this.paneColumnCards\n        afterCard = column.firstElementChild\n      }\n    }\n\n    if (column) {\n      if (afterCard) {\n        this.moveToBeforeCard(column, afterCard)\n      } else {\n        this.moveToColumn(column)\n      }\n    }\n    this.done()\n  }\n}\n\n// Re-order a column using the keyboard\nclass ColumnMove extends ItemMove {\n  nextColumnID: string\n  moveColumn: (el: Element, opts?: KeyboardMoveOptions) => void\n  keydownListener: (event: KeyboardEvent) => void\n  updateListener: (event: Event) => void\n\n  constructor(column: HTMLElement, moveColumn: (el: Element, opts?: KeyboardMoveOptions) => void, onDone: () => void) {\n    super(column, onDone)\n    this.moveColumn = moveColumn\n    this.nextColumnID = this.getColumnID(column.nextElementSibling)\n\n    this.keydownListener = this.handleKeydown.bind(this)\n    this.item.addEventListener('keydown', this.keydownListener)\n\n    // Abort move if columns were updated by someone else\n    this.updateListener = this.done.bind(this)\n    this.getColumnsContainer().addEventListener('will-update-project-columns', this.updateListener)\n  }\n\n  override updateAriaLabel() {\n    const index = this.getColumnIndex()\n    const indexLabel = index >= 0 ? `to position ${index + 1} of ${this.getColumnCount()}` : ''\n    this.item.setAttribute('aria-label', `Moved ${this.getColumnName()} column ${indexLabel}`.trim())\n  }\n\n  getColumnIndex(): number {\n    const columns = this.getColumnsContainer().querySelectorAll('.js-project-column')\n    return Array.from(columns).indexOf(this.item)\n  }\n\n  getColumnCount(): number {\n    return this.getColumnsContainer().querySelectorAll('.js-project-column').length\n  }\n\n  handleKeydown(event: KeyboardEvent) {\n    if (!isShortcutAllowed(event)) return\n\n    const metaKey = this.isMetaKeyPressed(event)\n    switch (getAction(event.key)) {\n      case 'left':\n        if (metaKey) {\n          this.moveToFirstColumn()\n        } else {\n          this.moveLeft()\n        }\n        event.preventDefault()\n        break\n      case 'right':\n        if (metaKey) {\n          this.moveToLastColumn()\n        } else {\n          this.moveRight()\n        }\n        event.preventDefault()\n        break\n      case 'confirm':\n        this.confirm()\n        event.preventDefault()\n        break\n      case 'cancel':\n        this.cancel()\n        event.preventDefault()\n        break\n    }\n  }\n\n  insertBefore(afterColumn: Element) {\n    const container = this.getColumnsContainer()\n    this.moveTransaction(function (column) {\n      container.insertBefore(column, afterColumn)\n    })\n  }\n\n  // Move the column to the left by one column\n  moveLeft() {\n    const previousColumn = this.getPreviousColumn()\n    if (previousColumn) {\n      this.insertBefore(previousColumn)\n    }\n  }\n\n  // Move the columm to the right by one column\n  moveRight() {\n    const nextColumn = this.getNextColumn()\n    if (nextColumn) {\n      const nextSibling = nextColumn.nextElementSibling\n      if (nextSibling && this.isColumn(nextSibling)) {\n        this.insertBefore(nextSibling)\n      } else {\n        this.moveToLastColumn()\n      }\n    } else {\n      this.moveToLastColumn()\n    }\n  }\n\n  // Move this column to be the leftmost column\n  moveToFirstColumn() {\n    const firstColumn = this.getFirstColumn()\n    if (firstColumn) {\n      this.insertBefore(firstColumn)\n    }\n  }\n\n  // Move this column to be the rightmost column\n  moveToLastColumn() {\n    const lastColumn = this.getLastColumn()\n    if (lastColumn) {\n      const nextSibling = lastColumn.nextElementSibling\n      if (nextSibling) {\n        this.insertBefore(nextSibling)\n      }\n    }\n  }\n\n  override done() {\n    super.done()\n    this.item.removeEventListener('keydown', this.keydownListener)\n    this.getColumnsContainer().removeEventListener('will-update-project-columns', this.updateListener)\n  }\n\n  // Move column to new position\n  confirm() {\n    if (this.moved) {\n      this.moveColumn(this.item, {keyboardMove: true})\n    }\n    this.done()\n  }\n\n  // Restore column to original position\n  override cancel() {\n    if (this.moved) {\n      const nextColumn = this.findColumn(this.nextColumnID)\n      if (nextColumn) {\n        this.insertBefore(nextColumn)\n      } else {\n        this.moveToLastColumn()\n      }\n    }\n    this.done()\n  }\n}\n\nexport function enableKeyboardMovements(\n  moveCardFn: (el: Element, el2?: Element | null, opts?: KeyboardMoveOptions) => void,\n  moveColumnFn: (el: Element, options?: KeyboardMoveOptions) => void,\n) {\n  let cardMove: CardMove | null\n  let columnMove: ColumnMove | null\n\n  function onCardKeypress(event: KeyboardEvent) {\n    if (cardMove) return\n\n    const card = event.currentTarget as HTMLElement\n    if (!isShortcutAllowed(event)) return\n\n    switch (getAction(event.key)) {\n      case 'confirm':\n      case 'Space':\n        // Prevent redacted cards from being moved\n        if (card.classList.contains('js-redacted-project-column-card')) return\n\n        // Prevent people without write access from moving cards\n        if (!card.classList.contains('js-keyboard-movable')) return\n\n        cardMove = new CardMove(card, moveCardFn, function onDone() {\n          cardMove = null\n        })\n        event.preventDefault()\n        break\n      case 'up': {\n        const previousCard = card.previousElementSibling as HTMLElement\n        if (previousCard && previousCard.classList.contains('js-project-column-card')) {\n          previousCard.focus()\n          event.preventDefault()\n        } else {\n          const column = card.closest('.js-project-column')\n          if (column instanceof HTMLElement) {\n            column.focus()\n            event.preventDefault()\n          }\n        }\n        break\n      }\n      case 'down': {\n        const nextCard = card.nextElementSibling as HTMLElement\n        if (nextCard && nextCard.classList.contains('js-project-column-card')) {\n          nextCard.focus()\n          event.preventDefault()\n        }\n        break\n      }\n    }\n  }\n\n  function onColumnKeypress(event: KeyboardEvent) {\n    if (columnMove) return\n\n    // Columns contain the Add Note input field so ignore the event if  the\n    // keypress was generated by it since it denotes typing into the note box\n    if (event.target instanceof HTMLInputElement || event.target instanceof HTMLTextAreaElement) return\n\n    const column = event.currentTarget as HTMLElement\n\n    switch (getAction(event.key)) {\n      case 'confirm':\n      case 'Space':\n        // Prevent people without write access from moving columns\n        if (!column.classList.contains('js-keyboard-movable')) return\n\n        columnMove = new ColumnMove(column, moveColumnFn, function onDone() {\n          columnMove = null\n        })\n        event.preventDefault()\n        break\n      case 'down': {\n        const firstCard = column.querySelector<HTMLElement>('.js-project-column-card')\n        if (firstCard) {\n          firstCard.focus()\n          event.preventDefault()\n        }\n        break\n      }\n      case 'left': {\n        const previousColumn = column.previousElementSibling as HTMLElement\n        if (previousColumn && previousColumn.classList.contains('js-project-column')) {\n          previousColumn.focus()\n          event.preventDefault()\n        }\n        break\n      }\n      case 'right': {\n        const nextColumn = column.nextElementSibling as HTMLElement\n        if (nextColumn && nextColumn.classList.contains('js-project-column')) {\n          nextColumn.focus()\n          event.preventDefault()\n        }\n        break\n      }\n    }\n  }\n\n  onFocus('.js-project-column-card', function (card) {\n    if (cardMove) {\n      if (cardMove.isMoving(card)) {\n        return\n      } else {\n        cardMove.cancel()\n      }\n    }\n\n    card.addEventListener('keydown', onCardKeypress)\n    card.addEventListener('blur', function onBlur() {\n      if (cardMove && cardMove.isMoving(card)) return\n      card.removeEventListener('blur', onBlur)\n      card.removeEventListener('keydown', onCardKeypress)\n    })\n  })\n\n  onFocus('.js-project-column', function (column) {\n    if (columnMove) {\n      if (columnMove.isMoving(column)) {\n        return\n      } else {\n        columnMove.cancel()\n      }\n    }\n\n    column.addEventListener('keydown', onColumnKeypress)\n    column.addEventListener('blur', function onBlur() {\n      if (columnMove && columnMove.isMoving(column)) return\n      column.removeEventListener('blur', onBlur)\n      column.removeEventListener('keydown', onColumnKeypress)\n    })\n  })\n}\n","// This is a simple function that just returns Promise.resolve() It is used in instances when we want to queue a\n// microtask before moving onto the next operation, but want to do so in a very explicit manner: `await microtask`\n// looks a lot clearer in intent than `await void 0` or `await Promise.resolve()`.\n//\n// You would want to use `await microtask()` if you have something that needs to be done very urgently, but still\n// needs to be done asynchronously. This will _not_ yield to the browser for any UI updates or wait for idle, instead\n// it queues a task in the \"microtask\" which is run immediately after the current stack. Use this sparingly. This\n// will likely delay subsequent code for 0-10ms.\nexport function microtask(): Promise<void> {\n  return Promise.resolve()\n}\n\n// This function simply Promisifies requestAnimationFrame so it is awaitable.\n//\n// You would want to use `await animationFrame()` if you're happy to yield to the browser to complete any UI updates\n// before calling your next piece of code. This is useful if - for example - you need to wait for scroll events,\n// or CSS transitions or something. This will likely delay subsequent code for 16ms or so - much longer (30-60ms)\n// if the tab is not focussed.\nexport function animationFrame(): Promise<number> {\n  return new Promise(window.requestAnimationFrame)\n}\n\n// Rejects a promise after a timeout has elapsed. The promise is never\n// successfully fulfilled.\n//\n// Examples\n//\n//   try {\n//     const value = await Promise.race([timeout(100), somethingSlow()])\n//     console.log('Slow operation finished within the timeout', value)\n//   } catch (e) {\n//     console.log('Slow operation did not finish', e)\n//   }\n//\n// Returns a rejected Promise rejected after a timeout.\nexport async function timeout(ms: number, signal?: AbortSignal): Promise<void> {\n  let id\n  const done = new Promise<void>((resolve, reject) => {\n    id = self.setTimeout(() => reject(new Error('timeout')), ms)\n  })\n  if (!signal) return done\n  try {\n    await Promise.race([done, whenAborted(signal)])\n  } catch (e) {\n    self.clearTimeout(id)\n    throw e\n  }\n}\n\n// Fulfills a promise after a timeout has elapsed. The promise is never rejected.\n//\n// Examples\n//\n//   step1()\n//   await wait(100)\n//   step2()\n//\n// Returns a Promise fulfilled after a timeout.\nexport async function wait(ms: number, signal?: AbortSignal): Promise<void> {\n  let id\n  const done = new Promise<void>(resolve => {\n    id = self.setTimeout(resolve, ms)\n  })\n  if (!signal) return done\n  try {\n    await Promise.race([done, whenAborted(signal)])\n  } catch (e) {\n    self.clearTimeout(id)\n    throw e\n  }\n}\n\nfunction whenAborted(signal: AbortSignal): Promise<never> {\n  return new Promise((resolve, reject) => {\n    const error = new Error('aborted')\n    error.name = 'AbortError'\n    if (signal.aborted) {\n      reject(error)\n    } else {\n      signal.addEventListener('abort', () => reject(error))\n    }\n  })\n}\n\nexport function taskQueue<T>(fn: (values: T[]) => unknown): (value: T) => void {\n  const queue: T[] = []\n  return function (value: T) {\n    queue.push(value)\n    if (queue.length === 1) {\n      queueMicrotask(() => {\n        const values = queue.slice(0)\n        queue.length = 0\n        fn(values)\n      })\n    }\n  }\n}\n"],"names":["supportsTransitions","window","isTransitioningHeight","el","getComputedStyle","transitionProperty","withoutTransition","cb","style","transition","offsetHeight","updateOpenState","container","open","classList","toggle","initialFocus","querySelector","setTimeout","focus","target","querySelectorAll","filter","closest","setAttribute","toString","hasAttribute","getAttribute","toggleDetailsTarget","opts","containerSelector","force","contains","withGroup","performTransition","els","Array","from","push","transitionHeight","HTMLElement","addEventListener","display","visibility","height","once","boxSizing","currentHeight","scrollHeight","group","toggleGroup","preservePosition","otherContainer","document","Promise","resolve","then","findAndFocusByQuerySelector","elements","find","selector","lastVisibleElement","elementsFromSelector","findLast","activeElement","remove","add","blur","dispatchEvent","CustomEvent","bubbles","cancelable","detail","isDetailsTargetExpanded","ensureExpanded","toCollapse","node","parentElement","on","event","altKey","currentTarget","preventDefault","hashChange","handlers","ran","handler","ready","runRemainingHandlers","index","length","runHandlers","slice","location","href","handlersToRun","oldURL","newURL","id","hash","data","getElementById","fn","call","clear","ieOldURL","softNavOldURL","SOFT_NAV_STATE","START","SUCCESS","throttledInputEvents","WeakMap","schedule","element","events","get","timer","clearTimeout","inputed","listener","wait","onKeydownInput","keypressed","onKeyupInput","onInputInput","addThrottledInputEventListener","options","set","undefined","removeThrottledInputEventListener","removeEventListener","delete","dispatchThrottledInputEvent","updateMessageTimer","parsedFilter","lastQueryText","clientUID","errorModal","response","json","form","fetch","action","method","body","FormData","headers","Accept","ok","formGroup","errorContainer","fallbackErrorMessage","textContent","errors","project_name","hoverCard","path","timestampRegex","match","replace","Date","now","resetDefaultFormValues","field","HTMLInputElement","HTMLTextAreaElement","defaultValue","value","fire","recordPositions","nodeList","positions","card","getBoundingClientRect","invertPosition","oldPositions","newPositions","transformTime","oldPosition","newPosition","deltaX","left","deltaY","top","animationFrame","transform","animate","originalPositions","animations","all","displayUpdateMessage","message","messageContainer","updateColumnAutomation","column","columnElement","automationFooter","automationSummary","automation_summary","purpose","populateColumnNav","navItem","columnID","columnName","cardCount","encodeURI","cardCounter","Number","createColumnNav","template","columnNav","selected","navLink","content","cloneNode","nextIndex","appendChild","_updateProject","projectContainer","columns","columnPositions","projectURL","columnsURL","cardsURL","projectJSON","state","oldActiveElement","shouldUpdateColumns","columnIDsFromContainer","map","columnIDsFromJSON","String","join","scrollPositions","columnsFragment","createDocumentFragment","getColumn","urlBase","columnIDAttribute","columnElem","columnPlaceholder","IncludeFragmentElement","src","cardContainer","scrollTop","newColumnButton","blankSlate","cardContainerID","button","rebuildColumnNav","activeColumnID","scrollLeft","name","card_ids","cards","cardPositions","cardElements","cardID","getCard","cardIDAttribute","cardElem","cardPlaceholder","onerror","tagName","columnNameElem","columnNameField","columnCountElem","replaceCardsInContainer","cardIDs","cardsFragment","updateProject","debounce","linkedQualifier","titleQualifier","qualifiers","linkedQualifierValueTypeMapping","pr","typeQualifierValues","noQualifiers","queryTokenizerRegex","getOrCreateQualifierFilter","qualifier","qualifierFilter","tokenFilters","matchIfMissing","addToken","token","negated","tokenFilter","tf","getQueryTokenValue","queryToken","regexPattern","RegExp","toLowerCase","parseCardFilterQuery","queryString","queryTokens","matchingQualifier","newQualifierValue","startsWith","targetTypeValue","hasTypeFilter","tokens","some","tokenValue","includes","missingQualifier","getQueryText","trim","cardMatchesFilter","cardAttrValue","cardAttrTokens","JSON","parse","qualifierToken","isPartiallyMatched","needle","haystack","item","fullyMatched","indexOf","updateFilteredCardCounts","queryText","filteredCountLabel","filteredCount","filterCard","getFilterQuery","cardMatches","cardReference","updateFilterState","input","cardFilterClearButton","setQueryParam","newUrl","URL","origin","params","URLSearchParams","search","replaceState","getState","title","updateFullscreenLinks","link","filterCards","badTextBeforeCursorRegex","goodTextBeforeCursorRegex","goodTextAfterCursorRegex","updateSuggestionsDisplay","inputField","shouldShowSuggestions","textBeforeCursor","selectionEnd","textAfterCursor","isEmpty","test","isCursorAtSuggestionLocation","hideSuggestions","showSuggestions","suggestionsContainer","currentToken","currentTokenRegex","suggestionHelperContainer","suggestionHelper","showSuggestionHelperRegex","suggestionsHeader","showSuggestionsHeader","suggestion","suggestionValue","useCtrlKeyAsMeta","navigator","userAgent","getAction","key","ItemMove","handleBlur","moveInProgress","relatedTarget","blurring","cancel","isMetaKeyPressed","ctrlKey","metaKey","inPendingColumn","findColumn","findCard","isColumn","getPane","getColumnName","label","getColumnsContainer","getNextColumn","nextColumn","nextElementSibling","getPreviousColumn","previousColumn","previousElementSibling","getFirstColumn","getLastColumn","getCardID","getColumnID","isMoving","updateAriaLabel","moveTransaction","mover","moved","done","blurListener","removeAttribute","onDone","constructor","bind","CardMove","getCardIndex","indexLabel","getCardCount","columnLabel","handleUpdateStart","paneColumnCards","updatePreviousPosition","isColumnInState","updateSnapshot","indexInColumn","handleUpdateEnd","snapshot","getColumnCards","moveToColumn","afterCard","children","moveToBeforeCard","handleKeydown","isShortcutAllowed","moveToTop","moveUp","moveToBottom","moveDown","moveToFirstColumn","shiftKey","moveLeft","moveToLastColumn","moveRight","confirm","previousCardID","insertBefore","previousCard","prepend","nextCard","topOfColumn","firstColumn","lastColumn","targetColumn","keydownListener","updateStartListener","updateEndListener","fromColumn","pendingCard","moveCard","keyboardMove","firstElementChild","ColumnMove","getColumnIndex","getColumnCount","afterColumn","nextSibling","updateListener","moveColumn","nextColumnID","clientUIDElem","remoteProjectForm","remoteForm","kicker","req","error","openDialog","closeDialog","dialogID","opener","dialogTemplate","openedDialog","dialog","dialogClass","updateColumnCount","change","responsiveCounter","counter","counterValue","parseInt","newCounterValue","trackKeyboardMove","keyboardInput","namedItem","cleanupSearchResults","searchableCards","pageValue","reset","populateFormFromCard","cardIDInput","contentIDInput","contentTypeInput","prevCard","prevCardInput","requestSubmit","handleCardDrag","removeCard","cardIdHashRegex","previousColumnId","handleColumnMove","related","matches","handleColumnUpdate","refreshAddCardsSearchResults","addCardsSearchForm","HTMLFormElement","refreshArchivedCardsSearchResults","archivedCardsSearchForm","contentID","contentType","toggleBlankSlate","visible","newColumnContainer","addButton","togglePaneVisibility","paneClass","pane","loadArchivedCardsPane","fragment","url","searchParams","append","toggleShowAwaitingTriageIssues","show","cleanupDuplicateSearchCards","searchCards","hasOwnProperty","closeNoteForm","noteFormDetails","onNoteFormKeydown","eventToHotkeyString","previewNote","noteInput","previewText","previewForm","resetTaskList","taskListContainer","enableTaskList","checkbox","defaultChecked","checked","newQuery","originalQuery","send","html","cardToUpdate","focusUpdatedCard","ownerDocument","replaceWith","projectUrl","project_url","jobUrl","job_status_url","fetchPoll","buttons","loader","text","isNoteAlreadyConvertedToIssue","error_code","parseHTML","error_html","modal","repoOwner","ownerType","projectCloneDialog","visibilityOptions","privateInput","reload","loadAutomationOptions","before","addColumnNav","setActiveColumn","setColumnHash","scrollActiveColumnNavIntoViewIfNeeded","updateColumnNav","HTMLAnchorElement","deleteColumnNav","columnCards","observe","initialize","substr","closeMigrationOverlay","close","showConfirmationDialog","detailsElement","searchResults","fetchError","getCardIdFromHash","captures","archivedCardsPane","urlTemplate","results","triagePane","loadActivityPane","queryContainsInvalidParam","activityPane","activityResults","searchPaneCard","subscribe","fromEvent","onFocus","wants","notePreview","noteTextArea","previewArea","responseError","tab","remoteInput","textarea","disabled","status","handleUpdateNote","changeValue","request","noteVersion","stale","updateContent","note_version","note","editFormInput","debouncedUpdateCardFiltering","optionsContainer","purposeDetails","setOptionsLoading","loading","hidden","fallbackClassForElement","handleForElement","setInitialActiveColumn","anchor","createElement","nav","activeColumn","activeColumnLeft","offsetLeft","activeColumnWidth","offsetWidth","activeColumnRight","windowWidth","innerWidth","truncateCardDetails","wrapper","wrapperHeight","needsTruncation","containerHeight","showIssueDetails","issueLink","shiftFocus","cardDetailsPane","issueURL","cardDetailsContainer","fromPane","openedFromOtherPane","updateContentDetailsBackToLink","header","backClass","focusCardDetailsTitle","createContentDetailsLoader","issueDetailsContainer","loaderTemplate","isOpen","contentLabel","issueType","externalLink","repoLink","repoEncodedUrl","octicon","fetchSafeDocumentFragment","hideMenu","onCardKeydown","links","checkLinkedReposCount","repoList","repoListBlankslate","linkRepoSearchInputGroup","linkedReposMaxMessage","linkedReposCount","maxLinkedReposReached","openMigrateDialog","HTMLDialogElement","showModal","openMigrateDialogOnLoad","loaded","history","pathname","applyFilter","filterBy","currentFilter","buttonPressed","clickFilterA11y","pressed","originalEvent","suggestedText","client_uid","verifySsoSession","updateProjectColumnAutomation","locked","closeLockContainer","popover","is_project_activity","project_migration","migrateMenuItem","capture","Sortable","create","animation","draggable","preventOnFilter","fallbackClass","handle","handleReplacedDragElement","put","pull","onMove","onUpdate","fallbackOnBody","onAdd","sort","prefix","addNoteTarget","afterRemote","issue_title","autoComplete","linkedRepoBadge","repoIdInput","repoAlreadyLinked","badge","onKey","populateMoveCardDialog","moveCardDialog","currentColumn","currentColumnID","columnButton","selectedItem","expand","parent","hydroEventHmac","hydroEventPayload","sendStats","hydroClientContext","enableKeyboardMovements","moveCardFn","moveColumnFn","cardMove","columnMove","onCardKeypress","onColumnKeypress","firstCard","onBlur","microtask","requestAnimationFrame","ms","signal","self","race","reject","aborted","e","taskQueue","queue","queueMicrotask","values"],"sourceRoot":""}