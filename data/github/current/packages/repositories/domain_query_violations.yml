# This file is used to track queries that violate package boundaries. There are two reasons for violations:
#
# - Cross domain: A query uses tables from multiple domains.
# - Domain access: A query bypassed a domain's interface and accessed its private tables directly.
#
# The format of this file is as follows:
#
# <query_digest>:
#   query: <query>
#   violations:
#     - [location: <file:line>] # never committed but only generated with the --locations flag
#       reason: <cross_domain|domain_access>
#
# To add a new violation, you can run the test causing the violation with the following environment variables:
#
#   TEST_ALL_FEATURES=1 PERFORM_STATEMENT_CHECKING=1 DOMAIN_QUERY_VIOLATIONS=1 bin/rails test <path_to_test_file>:<line_number>
#
# This will update the query violation file(s) with the new violation(s). To remove a violation, you can simply
# remove the entry from the file.
#
# If there are many violations to add or update, or you'd like to refresh all recorded violations, you can
# run the following command to pull all violations from the latest completed CI build on your branch:
#
#     script/domain-isolation-query-violations [--locations] [--audit] [--reason <cross_domain|domain_access>]
#
# This will replace all query violation files with the latest violations. Use the `--locations` flag to
# include file locations in the output, don't commit that though! Use the `--audit` flag to include
# violations from tables with visibility level `audit`. Use the `--reason` flag to filter violations
# by reason in case you're only interested in locations for a specific reason.

---
79b2ebe9dc3597f68817fde593b9ee98bfd3c016cc5eaa5448d0345e3e47a6dc:
  query: SELECT key_links.* FROM key_links WHERE key_links.id = ?
  tables:
  - key_links
  violations:
  - reason: domain_access
93645e97d31c83469116c2480c3f29fc504c143de9de43c94fe4795bc62f2d16:
  query: SELECT COUNT(*) FROM key_links WHERE key_links.id = ?
  tables:
  - key_links
  violations:
  - reason: domain_access
a3073f97a94d3a0fb6ac8f0a4ed108ded58a87007251a8e53013c3bee8885e1a:
  query: DELETE FROM key_links WHERE key_links.id = ?
  tables:
  - key_links
  violations:
  - reason: domain_access
d16a8e4a201f9cbd21f31579160df06ce63868613b97e579daddcbbdd5dd211e:
  query: SELECT id FROM key_links WHERE owner_id = ? AND id > ? AND owner_type = ?
    ORDER BY id LIMIT ?
  tables:
  - key_links
  violations:
  - reason: domain_access
