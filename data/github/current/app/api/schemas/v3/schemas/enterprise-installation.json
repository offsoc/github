{
  "$schema": "http://json-schema.org/draft-04/hyper-schema",
  "id": "https://schema.github.com/v3/enterprise-installation.json",
  "title": "Enterprise Installation",
  "description": "Generate a token used to connect enterprise to dotcom",
  "type": "object",
  "definitions": {
    "ecosystem_stats": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the ecosystem (e.g. \"nuget\")",
          "example": "rubygems"
        },
        "enabled": {
          "type": "string",
          "enum": [
            "false",
            "true",
            "readonly"
          ],
          "description": "The enabled status of the ecosystem (e.g. \"true\", \"false\", \"readonly\")"
        },
        "published_packages_count": {
          "type": "integer",
          "description": "The total number of published packages in the ecosystem"
        },
        "private_packages_count": {
          "type": "integer",
          "description": "The total number of private scoped packages in the ecosystem"
        },
        "public_packages_count": {
          "type": "integer",
          "description": "The total number of public scoped packages in the ecosystem"
        },
        "internal_packages_count": {
          "type": "integer",
          "description": "The total number of internal scoped packages in the ecosystem"
        },
        "user_packages_count": {
          "type": "integer",
          "description": "The total number of user-owned packages in the ecosystem"
        },
        "organization_packages_count": {
          "type": "integer",
          "description": "The total number of organization-owned packages in the ecosystem"
        },
        "daily_download_count": {
          "type": "integer",
          "description": "The total number of package downloads from the ecosystem in the last day"
        },
        "daily_update_count": {
          "type": "integer",
          "description": "The total number of package updates published to the ecosystem in the last day"
        },
        "daily_delete_count": {
          "type": "integer",
          "description": "The total number of packages deleted from the ecosystem in the last day"
        },
        "daily_create_count": {
          "type": "integer",
          "description": "The total number of packages published to the ecosystem in the last day"
        }
      }
    },
    "feature": {
      "description": "A feature to be enabled or disabled",
      "type": "string"
    },
    "host_name": {
      "description": "Host name of the enterprise instance",
      "example": "enterprise.customerdomain.com",
      "type": "string"
    },
    "http_only": {
      "example": false,
      "type": "boolean"
    },
    "license": {
      "description": "Binary license data encoded in Base64",
      "type": "string"
    },
    "public_key": {
      "description": "Binary public key data in PEM format encoded in Base64",
      "type": "string"
    },
    "version": {
      "description": "Version number of the Enterprise instance",
      "example": "2.11.0",
      "type": "string"
    },
    "server_id": {
      "description": "Unique identifier of the Enterprise instance",
      "example": "12345678-1234-1234-1234-123456789012",
      "type": "string"
    },
    "collected_at": {
      "description": "The date and time at which the metrics were gathered",
      "type": "string",
      "format": "date-time",
      "example": "2021-06-14T14:25:41.818Z"
    },
    "schema_version": {
      "description": "defines server statistics coming from GHES appliances",
      "type": "string",
      "example": "20210823"
    },
    "features": {
      "description": "GitHub Connect features enabled on the instance",
      "type": "array",
      "minItems": 1,
      "example": [
        "usage_metrics",
        "license_usage_sync"
      ],
      "items": {
        "properties": {
          "value": {
            "type": "string"
          }
        }
      }
    },
    "mec": {
      "description": "Monthly Engaged Contributors",
      "type": "object",
      "properties": {
        "start_date": {
          "type": "string",
          "format": "date-time",
          "example": "2021-06-14T14:25:41.818Z"
        },
        "end_date": {
          "type": "string",
          "format": "date-time",
          "example": "2021-06-14T14:25:41.818Z"
        },
        "value": {
          "type": "integer",
          "example": 123
        }
      }
    },
    "advisory_db_stats": {
      "description": "Advisory database statistics",
      "type": "object",
      "properties": {
        "vulnerability_sync_enabled": {
          "type": "boolean",
          "example": false
        },
        "synced_vulnerability_count": {
          "type": "integer",
          "example": 2324
        },
        "latest_updated_at": {
          "type": "string",
          "format": "date-time",
          "example": "2021-06-14T14:25:41.818Z"
        }
      }
    },
    "admin_stats": {
      "description": "Admin statistics",
      "type": "object",
      "properties": {
        "repos": {
          "type": "object",
          "properties": {
            "total_repos": {
              "type": "integer",
              "example": 123
            },
            "root_repos": {
              "type": "integer",
              "example": 123
            },
            "fork_repos": {
              "type": "integer",
              "example": 123
            },
            "org_repos": {
              "type": "integer",
              "example": 123
            },
            "total_pushes": {
              "type": "integer",
              "example": 123
            },
            "total_wikis": {
              "type": "integer",
              "example": 123
            }
          }
        },
        "hooks": {
          "type": "object",
          "properties": {
            "total_hooks": {
              "type": "integer",
              "example": 123
            },
            "active_hooks": {
              "type": "integer",
              "example": 123
            },
            "inactive_hooks": {
              "type": "integer",
              "example": 123
            }
          }
        },
        "pages": {
          "type": "object",
          "properties": {
            "total_pages": {
              "type": "integer",
              "example": 123
            }
          }
        },
        "orgs": {
          "type": "object",
          "properties": {
            "total_orgs": {
              "type": "integer",
              "example": 123
            },
            "disabled_orgs": {
              "type": "integer",
              "example": 123
            },
            "total_teams": {
              "type": "integer",
              "example": 123
            },
            "total_team_members": {
              "type": "integer",
              "example": 123
            }
          }
        },
        "users": {
          "type": "object",
          "properties": {
            "total_users": {
              "type": "integer",
              "example": 123
            },
            "admin_users": {
              "type": "integer",
              "example": 123
            },
            "suspended_users": {
              "type": "integer",
              "example": 123
            }
          }
        },
        "pulls": {
          "type": "object",
          "properties": {
            "total_pulls": {
              "type": "integer",
              "example": 123
            },
            "merged_pulls": {
              "type": "integer",
              "example": 123
            },
            "mergeable_pulls": {
              "type": "integer",
              "example": 123
            },
            "unmergeable_pulls": {
              "type": "integer",
              "example": 123
            }
          }
        },
        "issues": {
          "type": "object",
          "properties": {
            "total_issues": {
              "type": "integer",
              "example": 123
            },
            "open_issues": {
              "type": "integer",
              "example": 123
            },
            "closed_issues": {
              "type": "integer",
              "example": 123
            }
          }
        },
        "milestones": {
          "type": "object",
          "properties": {
            "total_milestones": {
              "type": "integer",
              "example": 123
            },
            "open_milestones": {
              "type": "integer",
              "example": 123
            },
            "closed_milestones": {
              "type": "integer",
              "example": 123
            }
          }
        },
        "gists": {
          "type": "object",
          "properties": {
            "total_gists": {
              "type": "integer",
              "example": 123
            },
            "private_gists": {
              "type": "integer",
              "example": 123
            },
            "public_gists": {
              "type": "integer",
              "example": 123
            }
          }
        },
        "comments": {
          "type": "object",
          "properties": {
            "total_commit_comments": {
              "type": "integer",
              "example": 123
            },
            "total_gist_comments": {
              "type": "integer",
              "example": 123
            },
            "total_issue_comments": {
              "type": "integer",
              "example": 123
            },
            "total_pull_request_comments": {
              "type": "integer",
              "example": 123
            }
          }
        }
      }
    },
    "dormant_users": {
      "description": "The number of dormant users and the configured threshold period",
      "type": "object",
      "properties": {
        "total_dormant_users": {
          "type": "integer",
          "example": 123
        },
        "dormancy_threshold": {
          "type": "string",
          "example": "90 days"
        }
      }
    },
    "packages_stats": {
      "description": "Packages statistics",
      "type": "object",
      "properties": {
        "registry_enabled": {
          "description": "Whether the Packages registry feature is enabled on the GHES instance",
          "type": "boolean",
          "example": false
        },
        "registry_v2_enabled": {
          "description": "Whether a Packages V2 registry is enabled on the GHES instance",
          "type": "boolean",
          "example": false
        },
        "ecosystems": {
          "description": "Additional statistics about individual package ecosystems.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/ecosystem_stats"
          }
        }
      }
    },
    "actions_stats": {
      "description": "Actions stats",
      "type": "object",
      "properties": {
        "number_of_repos_using_actions": {
          "type": "integer",
          "example": 123
        },
        "percentage_of_repos_using_actions": {
          "type": "number",
          "example": 98.15
        }
      }
    },
    "actions_job_execution": {
      "description": "Actions job execution event from a GHES instance",
      "type": "object",
      "rel": "actions_job_execution",
      "properties": {
        "invoking_event_type": {
          "type": "string",
          "example": "pull_request"
        },
        "workflow_repository_id": {
          "type": "integer",
          "example": 123
        },
        "workflow_repository_global_id": {
          "type": "string",
          "example": "MDEwOlJlcG9zaXRvcnkxMjM="
        },
        "workflow_repository_visibility": {
          "type": "string",
          "example": "PUBLIC"
        },
        "workflow_build_id": {
          "type": "integer",
          "example": 123
        },
        "check_suite_id": {
          "type": "integer",
          "example": 123
        },
        "organization_id": {
          "type": "integer",
          "example": 123
        },
        "job_check_run_conclusion": {
          "type": "string",
          "example": "success"
        },
        "job_id": {
          "type": "string",
          "example": "123"
        },
        "job_runtime": {
          "type": "string",
          "example": "UBUNTU"
        },
        "job_runtime_version": {
          "type": "string",
          "example": "1.0.0"
        },
        "check_run_id": {
          "type": "integer",
          "example": 123
        },
        "start_time": {
          "type": "string",
          "example": "2020-01-01T00:00:00Z"
        },
        "end_time": {
          "type": "string",
          "example": "2020-01-01T00:00:00Z"
        },
        "job_execution_billable_ms": {
          "type": "integer",
          "example": 123
        },
        "runner_properties": {
          "type": "object",
          "example": {
            "MachineLabel": "Ubuntu20",
            "RequestedLabel": "ubuntu-latest"
          }
        }
      }
    }
  },
  "links": [
    {
      "href": "/enterprise-installation",
      "method": "POST",
      "rel": "create-legacy",
      "schema": {
        "properties": {
          "host_name": {
            "$ref": "#/definitions/host_name"
          },
          "http_only": {
            "$ref": "#/definitions/http_only"
          },
          "license": {
            "$ref": "#/definitions/license"
          },
          "public_key": {
            "$ref": "#/definitions/public_key"
          },
          "version": {
            "$ref": "#/definitions/version"
          },
          "server_id": {
            "$ref": "#/definitions/server_id"
          }
        },
        "required": [
          "host_name",
          "http_only",
          "license",
          "version"
        ],
        "type": "object"
      },
      "title": "Create a new enterprise installation"
    },
    {
      "href": "/enterprise-installation",
      "method": "PUT",
      "rel": "update-legacy",
      "schema": {
        "properties": {
          "host_name": {
            "$ref": "#/definitions/host_name"
          },
          "http_only": {
            "$ref": "#/definitions/http_only"
          },
          "license": {
            "$ref": "#/definitions/license"
          },
          "version": {
            "$ref": "#/definitions/version"
          }
        },
        "required": [
          "host_name",
          "http_only",
          "license",
          "version"
        ],
        "type": "object"
      },
      "title": "Update an enterprise installation"
    },
    {
      "href": "/enterprise-installation/permissions",
      "method": "POST",
      "rel": "permissions-legacy",
      "schema": {
        "properties": {
          "features": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/feature"
            }
          }
        },
        "required": [
          "features"
        ],
        "type": "object"
      },
      "title": "Permissions"
    },
    {
      "title": "Create a new enterprise installation",
      "method": "POST",
      "href": "/enterprise-installation",
      "rel": "create",
      "schema": {
        "properties": {
          "host_name": {
            "$ref": "#/definitions/host_name"
          },
          "http_only": {
            "$ref": "#/definitions/http_only"
          },
          "license": {
            "$ref": "#/definitions/license"
          },
          "public_key": {
            "$ref": "#/definitions/public_key"
          },
          "version": {
            "$ref": "#/definitions/version"
          }
        },
        "required": [
          "host_name",
          "http_only",
          "license",
          "version"
        ],
        "type": "object",
        "additionalProperties": false
      }
    },
    {
      "title": "Update an enterprise installation",
      "method": "PUT",
      "href": "/enterprise-installation",
      "rel": "update",
      "schema": {
        "properties": {
          "host_name": {
            "$ref": "#/definitions/host_name"
          },
          "http_only": {
            "$ref": "#/definitions/http_only"
          },
          "license": {
            "$ref": "#/definitions/license"
          },
          "version": {
            "$ref": "#/definitions/version"
          }
        },
        "required": [
          "host_name",
          "http_only",
          "license",
          "version"
        ],
        "type": "object",
        "additionalProperties": false
      }
    },
    {
      "title": "Request GitHub app permissions",
      "method": "POST",
      "href": "/enterprise-installation/permissions",
      "rel": "permissions",
      "schema": {
        "properties": {
          "features": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/feature"
            }
          }
        },
        "required": [
          "features"
        ],
        "type": "object",
        "additionalProperties": false
      }
    },
    {
      "title": "Create a new enterprise installation usage metric",
      "href": "/enterprise-installation/usage-metrics",
      "method": "POST",
      "rel": "create-usage-metrics",
      "schema": {
        "properties": {
          "server_id": {
            "$ref": "#/definitions/server_id"
          },
          "version": {
            "$ref": "#/definitions/version"
          },
          "mec": {
            "$ref": "#/definitions/mec"
          },
          "features": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/feature"
            }
          },
          "collected_at": {
            "$ref": "#/definitions/collected_at"
          },
          "admin_stats": {
            "$ref": "#/definitions/admin_stats"
          },
          "packages_stats": {
            "$ref": "#/definitions/packages_stats"
          },
          "actions_stats": {
            "$ref": "#/definitions/actions_stats"
          },
          "advisory_db_stats": {
            "$ref": "#/definitions/advisory_db_stats"
          }
        },
        "required": [
          "collected_at",
          "server_id",
          "version",
          "features"
        ],
        "type": "object"
      }
    },
    {
      "title": "Create a new enterprise installation actions job executions usage metric",
      "href": "/enterprise-installation/usage-metrics/actions-job-executions",
      "method": "POST",
      "rel": "create-actions-job-executions-usage-metrics",
      "schema": {
        "properties": {
          "server_id": {
            "$ref": "#/definitions/server_id"
          },
          "collected_at:": {
            "$ref": "#/definitions/collected_at"
          },
          "job_executions": {
            "type": "array",
            "$ref": "#/definitions/actions_job_execution"
          }
        },
        "required": [
          "collected_at",
          "server_id",
          "job_executions"
        ],
        "type": "object"
      }
    },
    {
      "title": "Create a new enterprise installation usage metric",
      "href": "/enterprise-installation/usage_metrics",
      "method": "POST",
      "rel": "create-usage-metrics-legacy",
      "schema": {
        "properties": {
          "server_id": {
            "$ref": "#/definitions/server_id"
          },
          "version": {
            "$ref": "#/definitions/version"
          },
          "mec": {
            "$ref": "#/definitions/mec"
          },
          "features": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/feature"
            }
          },
          "collected_at": {
            "$ref": "#/definitions/collected_at"
          },
          "admin_stats": {
            "$ref": "#/definitions/admin_stats"
          },
          "packages_stats": {
            "$ref": "#/definitions/packages_stats"
          },
          "actions_stats": {
            "$ref": "#/definitions/actions_stats"
          },
          "advisory_db_stats": {
            "$ref": "#/definitions/advisory_db_stats"
          }
        },
        "required": [
          "collected_at",
          "server_id",
          "version",
          "features"
        ],
        "type": "object"
      }
    }
  ]
}
