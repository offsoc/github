syntax = "proto3";
package github.authentication.v0;

option go_package = "client/proto/authentication/v0";
option ruby_package = "Authnd::Proto";

import "authentication/v0/attributes.proto";
import "authentication/v0/credentials.proto";

// RevokeRequest captures the parameters needed to revoke a credential.
message RevokeRequest {
	oneof kind {
		RevokeByCredential byCredential = 1;
		RevokeById byId = 3;
	}

	// The reason the credential must be revoked.
	string reason = 2;
}

// RevokeByCredential captures the parameters needed to revoke a credential using the credential itself.
message RevokeByCredential {
	// The credential to revoke
	repeated Credentials credentials = 1;
}

// RevokeById captures the parameters needed to revoke a credential using the credential ID.
message RevokeById {
	// The credential type associated with all the provided IDs.
	string credential_type = 1;

	// The IDs of the credentials to revoke.
	repeated int64 credential_ids = 2;
}

message RevokeResponse {
	// Result is a high level result of the revoke attempt.
	enum Result {
		// RESULT_UNKNOWN
		// Should never be used because it is the zero value for this
		// field and will be invisible when encoded into JSON.
		RESULT_UNKNOWN = 0;
		// The token was revoked successfully.
		RESULT_SUCCESS = 1;
		// The token was not revoked because the request was missing a reason.
		RESULT_FAILED_MISSING_REASON = 2;
		// The token was not revoked because it was not found.
		RESULT_NOT_FOUND = 3;
		// The token was not revoked because it was already revoked.
		RESULT_ALREADY_REVOKED = 4;
		// RESULT_FAILED_NOT_SUPPORTED indicates that the requested operation is not supported.
		RESULT_FAILED_NOT_SUPPORTED = 5;
		// The provided credential is malformed.
		RESULT_FAILED_CREDENTIAL_INVALID = 6;
		// The request contains more credentials than is supported by the server.
		RESULT_FAILED_MAX_BATCH_SIZE_EXCEEDED = 7;
		// RESULT_FAILED_GENERIC indicates the revoking failed.
		// If possible a more descriptive result code should be used.
		RESULT_FAILED_GENERIC = -1;
	}

	// Result is the overall result of revoking the credential.
	Result result = 1;
  // An additional message that corresponds to the result.
	string message = 2;
}

message BatchRevokeResponse {
	// Responses of all the individual revoke requests.
	repeated RevokeResponse responses = 1;
}