{"version":3,"file":"chunk-ui_packages_test-id-props_test-id-props_ts-ui_packages_repos-contributors-chart_components_Re-f60d39-xxxxxxxxxxxx.js","mappings":"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","sources":["ui/packages/test-id-props/test-id-props.ts","ui/packages/github-avatar/GitHubAvatar.tsx","ui/packages/repos-contributors-chart/components/ReposContributorsChart.module.css","ui/packages/repos-contributors-chart/components/ReposContributorsChart.tsx"],"sourcesContent":["export interface TestIdProps {\n  /** Test ID to be queried by automated testing suites */\n  'data-testid'?: string\n}\n\nexport const testIdProps = (value: string): TestIdProps => {\n  return {'data-testid': value}\n}\n","import {ssrSafeLocation} from '@github-ui/ssr-utils'\nimport {\n  // eslint-disable-next-line no-restricted-imports\n  Avatar,\n  type AvatarProps,\n} from '@primer/react'\nimport {forwardRef, useMemo} from 'react'\n\nexport type GitHubAvatarProps = AvatarProps\n\nexport const GitHubAvatar = forwardRef<HTMLImageElement, GitHubAvatarProps>(function GitHubAvatar(\n  {src, size = 20, ...otherProps}: GitHubAvatarProps,\n  ref,\n) {\n  const avatarUrl = useMemo(() => {\n    // src maybe be relative, e.g. `/mona.png`, in which case the instances main origin should be used,\n    // e.g. \"https://github.com\" for dotcom. If src is a fully quallified URL then the origin argument is ignored.\n    const url = new URL(src, ssrSafeLocation.origin)\n\n    // do not override size if it's already set as query parameter\n    if (!url.searchParams.has('size') && !url.searchParams.has('s')) {\n      // we double size for better rendering on high density pixel screens\n      url.searchParams.set('size', String(Number(size) * 2))\n    }\n\n    return url.toString()\n  }, [src, size])\n\n  return <Avatar ref={ref} src={avatarUrl} size={size} data-testid=\"github-avatar\" {...otherProps} />\n})\n\ntry{ GitHubAvatar.displayName ||= 'GitHubAvatar' } catch {}","// extracted by mini-css-extract-plugin\nexport default {\"authorDescriptionWrapper\":\"ReposContributorsChart-module__authorDescriptionWrapper--g8Pxh\",\"additionsDeletionsWrapper\":\"ReposContributorsChart-module__additionsDeletionsWrapper--B_egn\"};","import {useCallback, useEffect, useRef, useState} from 'react'\nimport {Label, Link} from '@primer/react'\nimport {useParams} from 'react-router-dom'\nimport {ChartCard} from '@github-ui/chart-card'\nimport {GitHubAvatar} from '@github-ui/github-avatar'\nimport type {Author, Axis, Metric, SummarizedCommitMetrics, Totals, Week} from '../repos-contributors-chart-types'\nimport styles from './ReposContributorsChart.module.css'\n\nconst chartHeights: {[size: string]: string} = {\n  medium: '256px',\n  small: '128px',\n}\n\nexport interface ReposContributorsChartProps {\n  author?: Author\n  weeks: Week[]\n  totals: Totals\n  metrics: SummarizedCommitMetrics\n  selectedMetric: Metric\n  onlyCommits?: boolean\n  place?: number\n  axis?: Axis\n  setAxis?(axis: Axis): void\n}\n\nconst DATE_FORMAT_OPTIONS: Intl.DateTimeFormatOptions = {\n  month: 'short',\n  day: 'numeric',\n  year: 'numeric',\n}\nconst intersectionObserverOptions = {\n  root: null,\n  rootMargin: '20px',\n  threshold: 0,\n}\n\nexport default function ReposContributorsChart({\n  author,\n  weeks,\n  totals,\n  metrics,\n  selectedMetric,\n  onlyCommits = false,\n  place,\n  axis,\n  setAxis,\n}: ReposContributorsChartProps) {\n  const metricDisplayName = `${selectedMetric.slice(0, 1).toUpperCase()}${selectedMetric.slice(1)}`\n  const firstDate = weeks[0]?.date\n  const lastDate = weeks.at(-1)?.date\n\n  const isAcrossMultipleYears = firstDate?.getFullYear() !== lastDate?.getFullYear()\n\n  const screenReaderTitleSuffix = `'s ${metricDisplayName}`\n  const firstDateDisplay = firstDate?.toLocaleDateString(undefined, DATE_FORMAT_OPTIONS)\n  const lastDateDisplay = lastDate?.toLocaleDateString(undefined, DATE_FORMAT_OPTIONS)\n\n  const size = author ? 'small' : 'medium'\n\n  const containerRef = useRef(null)\n  const [isVisible, setIsVisible] = useState(!author)\n\n  const onObserverUpdate: IntersectionObserverCallback = useCallback(\n    entries => {\n      const [entry] = entries\n      setIsVisible(!!entry?.isIntersecting)\n    },\n    [setIsVisible],\n  )\n\n  useEffect(() => {\n    const observer = new IntersectionObserver(onObserverUpdate, intersectionObserverOptions)\n    const containerRefCurrent = containerRef.current\n    if (containerRefCurrent) {\n      if (isVisible) {\n        observer.unobserve(containerRefCurrent)\n      } else {\n        observer.observe(containerRefCurrent)\n      }\n    }\n\n    return () => {\n      if (containerRefCurrent) observer.unobserve(containerRefCurrent)\n    }\n  }, [containerRef, isVisible, onObserverUpdate])\n\n  return (\n    <div ref={containerRef} style={{minHeight: chartHeights[size]}}>\n      {isVisible ? (\n        <ChartCard size={size}>\n          <ChartCard.Title as=\"h2\">\n            {author ? (\n              <span className=\"d-flex flex-items-center flex-justify-start\">\n                <Link href={author.path}>{author.login}</Link>\n                <span className=\"sr-only\">{screenReaderTitleSuffix}</span>\n              </span>\n            ) : (\n              <span>{metricDisplayName} over time</span>\n            )}\n          </ChartCard.Title>\n          <ChartCard.Description>\n            {author ? (\n              <AuthorDescription author={author} totals={totals} onlyCommits={onlyCommits} />\n            ) : (\n              <span>\n                From {firstDateDisplay} to {lastDateDisplay}\n              </span>\n            )}\n          </ChartCard.Description>\n          {author ? (\n            <ChartCard.LeadingVisual>\n              <Link href={author.path} data-hovercard-url={author.hovercard_url}>\n                <GitHubAvatar src={author.avatar} size={40} />\n                <span className=\"sr-only\">{author.login}</span>\n              </Link>\n            </ChartCard.LeadingVisual>\n          ) : null}\n          {place ? (\n            <ChartCard.TrailingVisual>\n              <Label>#{place}</Label>\n            </ChartCard.TrailingVisual>\n          ) : null}\n          <ChartCard.Chart\n            type=\"areaspline\"\n            series={[\n              {\n                type: 'areaspline',\n                name: metricDisplayName,\n                data: metrics[selectedMetric],\n              },\n            ]}\n            xAxisTitle=\"\"\n            yAxisTitle=\"Contributions\"\n            plotOptions={{\n              series: {\n                marker: {\n                  enabled: false,\n                },\n              },\n            }}\n            xAxisOptions={{\n              type: 'datetime',\n              labels: {\n                format: `{value:%b %e${isAcrossMultipleYears ? ', %Y' : ''}}`,\n              },\n            }}\n            yAxisOptions={{\n              ...(axis\n                ? {\n                    min: axis?.min,\n                    max: axis?.ceiling,\n                  }\n                : {}),\n              endOnTick: false,\n              tickAmount: author ? 1 : undefined,\n              maxPadding: 0.2,\n              events: {\n                afterSetExtremes({min, max, dataMin, dataMax}) {\n                  setAxis?.({floor: min, ceiling: max, min: dataMin, max: dataMax})\n                },\n              },\n            }}\n            tooltipOptions={{\n              xDateFormat: '%e %b %Y',\n            }}\n          />\n        </ChartCard>\n      ) : null}\n    </div>\n  )\n}\n\ntype AuthorDescriptionProps = {\n  author: Author\n  onlyCommits?: boolean\n  totals: {\n    additions: number\n    deletions: number\n    commits: number\n  }\n}\nfunction AuthorDescription({\n  author,\n  onlyCommits = false,\n  totals: {additions, deletions, commits},\n}: AuthorDescriptionProps) {\n  const {owner, repo} = useParams()\n  const [prettyCommits, prettyAdditions, prettyDeletions] = [commits, additions, deletions].map(value =>\n    value.toLocaleString(),\n  )\n  return (\n    <div className={styles.authorDescriptionWrapper}>\n      <Link href={`/${owner}/${repo}/commits?author=${encodeURIComponent(author.login)}`} muted>\n        {prettyCommits} commit{commits > 1 ? 's' : ''}\n      </Link>\n      {!onlyCommits ? (\n        <span className={styles.additionsDeletionsWrapper}>\n          <span className=\"color-fg-success\">{prettyAdditions} ++</span>\n          <span className=\"color-fg-danger\">{prettyDeletions} --</span>\n        </span>\n      ) : null}\n    </div>\n  )\n}\n\ntry{ ReposContributorsChart.displayName ||= 'ReposContributorsChart' } catch {}\ntry{ AuthorDescription.displayName ||= 'AuthorDescription' } catch {}"],"names":["testIdProps","value","GitHubAvatar","forwardRef","src","size","otherProps","ref","avatarUrl","useMemo","url","URL","ssrSafeLocation","origin","searchParams","has","set","String","Number","toString","Avatar","data-testid","displayName","chartHeights","medium","small","DATE_FORMAT_OPTIONS","month","day","year","intersectionObserverOptions","root","rootMargin","threshold","ReposContributorsChart","author","weeks","totals","metrics","selectedMetric","onlyCommits","place","axis","setAxis","metricDisplayName","slice","toUpperCase","firstDate","date","lastDate","at","isAcrossMultipleYears","getFullYear","screenReaderTitleSuffix","firstDateDisplay","toLocaleDateString","undefined","lastDateDisplay","containerRef","useRef","isVisible","setIsVisible","useState","onObserverUpdate","useCallback","entries","entry","isIntersecting","useEffect","observer","IntersectionObserver","containerRefCurrent","current","unobserve","observe","div","style","minHeight","ChartCard","Title","as","span","className","Link","href","path","login","Description","AuthorDescription","LeadingVisual","data-hovercard-url","hovercard_url","avatar","TrailingVisual","Label","Chart","type","series","name","data","xAxisTitle","yAxisTitle","plotOptions","marker","enabled","xAxisOptions","labels","format","yAxisOptions","min","max","ceiling","endOnTick","tickAmount","maxPadding","events","afterSetExtremes","dataMin","dataMax","floor","tooltipOptions","xDateFormat","additions","deletions","commits","owner","repo","useParams","prettyCommits","prettyAdditions","prettyDeletions","map","toLocaleString","styles","authorDescriptionWrapper","encodeURIComponent","muted","additionsDeletionsWrapper"],"sourceRoot":""}