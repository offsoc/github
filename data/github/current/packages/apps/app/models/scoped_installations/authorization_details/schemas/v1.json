{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "description": "A schema for defining authorization details on scoped installations",
  "definitions": {
    "version": {
      "description": "The version of the schema",
      "enum": [1]
    },
    "selections": {
      "description": "Type of access on a resource",
      "type": "object",
      "properties": {
        "repository": {
          "enum": [
            "subset",
            "parent",
            "all"
          ]
        },
        "organization": {
          "enum": [
            "subset"
          ]
        },
        "codespace": {
          "enum": [
            "subset"
          ]
        }
      },
      "additionalProperties": false,
      "minProperties": 1
    },
    "subject_ids": {
      "description": "The primary IDs of subjects that are allowed to be accessed.",
      "type": "object",
      "properties": {
        "repository": {
          "type": "array",
          "items": {
            "type": "integer"
          },
          "minItems": 1,
          "maxItems": 500,
          "uniqueItems": true
        },
        "organization": {
          "type": "array",
          "items": {
            "type": "integer"
          },
          "minItems": 1,
          "maxItems": 1,
          "uniqueItems": true
        },
        "codespace": {
          "type": "array",
          "items": {
            "type": "integer"
          },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "additionalProperties": false,
      "minProperties": 1
    },
    "action": {
      "enum": [
        0,
        1,
        2
      ]
    },
    "resources_and_actions": {
      "type": "object",
      "patternProperties": {
        "^[a-z]+(?:_[a-z]+)*$": {
          "$ref": "#/definitions/action"
        }
      },
      "additionalProperties": false,
      "minProperties": 1
    },
    "asymmetric_resources_and_actions": {
      "type": "object",
      "patternProperties": {
        "^[a-z]+(?:_[a-z]+)*$": {
          "type": "object",
          "patternProperties": {
            "^(read|write|admin)$": {
              "type": "array",
              "items": {
                "type": "integer"
              },
              "minItems": 1,
              "uniqueItems": true
            }
          },
          "additionalProperties": false,
          "minProperties": 1
        }
      },
      "additionalProperties": false,
      "minProperties": 1
    },
    "subject_types_and_actions": {
      "type": "object",
      "properties": {
        "repository": {
          "$ref": "#/definitions/resources_and_actions"
        },
        "organization": {
          "$ref": "#/definitions/resources_and_actions"
        },
        "codespace": {
          "$ref": "#/definitions/resources_and_actions"
        }
      },
      "additionalProperties": false,
      "minProperties": 1
    },
    "asymmetric": {
      "properties": {
        "repository": {
          "$ref": "#/definitions/asymmetric_resources_and_actions"
        },
        "pull_request": {
          "$ref": "#/definitions/asymmetric_resources_and_actions"
        },
        "package": {
          "$ref": "#/definitions/asymmetric_resources_and_actions"
        },
        "workflow_run": {
          "$ref": "#/definitions/asymmetric_resources_and_actions"
        }
      },
      "additionalProperties": false,
      "minProperties": 1
    }
  },
  "type": "object",
  "properties": {
    "version": {
      "$ref": "#/definitions/version"
    },
    "selections": {
      "$ref": "#/definitions/selections"
    },
    "subject_ids": {
      "$ref": "#/definitions/subject_ids"
    },
    "subject_types_and_actions": {
      "$ref": "#/definitions/subject_types_and_actions"
    },
    "asymmetric": {
      "$ref": "#/definitions/asymmetric"
    }
  },
  "required": ["version"],
  "additionalProperties": false
}
