<% num_fixes = 3 %>
Dependabot alerts on GitHub

Dependabot alerts <%= @view.span =%> <%= @view.start_date.strftime("%b %e") %> - <%= @view.end_date.strftime("%b %e") %>
-------------------

<% if @view.repositories.any? %>
<% @view.repositories.group_by(&:owner).each do |owner, repositories| %>
<% if owner.organization? %>
<%= owner.safe_profile_name %> organization
<% else %>
<%= owner.display_login %>â€™s personal account
<% end %>
---------------------------------------------------
<% repositories.each_with_index do |repo, index| %>
<%= "%d. %s" % [
    index + 1,
    "#{GitHub.url}/#{repo.name_with_display_owner}",
  ] %>

<% @view.alerts_by_package_name(repo).each do |affects, alerts| %>
<% alert = alerts.first %>
<% alerts_with_fixes = alerts_with_fixes = alerts.sort_by { |a| a.vulnerability.severity }.select { |a| a.vulnerable_version_range.fixed_in } %>
  <%= alert.vulnerable_version_range.affects %> dependency
  ------------------------------------------------
<% if alert.vulnerable_version_range.requirements %>
  Vulnerable versions: <%= alert.vulnerable_version_range.requirements %>
<% end %>
<% if alert.vulnerable_version_range.fixed_in.present? %>
  Upgrade to: <%= alert.vulnerable_version_range.fixed_in %>
<% end %>
  Defined in: <%= alert.filename %>
  Vulnerabilities: <% alerts_with_fixes.first(num_fixes).each do |alert_with_fix| %> <%= alert_with_fix.vulnerability.identifier %> (<%= alert_with_fix.vulnerability.severity.titleize %> severity) <% end %><% if alerts_with_fixes.count > num_fixes %>View <%= alerts_with_fixes.count - num_fixes %> more: <%= @view.alert_permalink(alert)%><% end %>
<% if pull_request = @view.pull_request_for_alert(alert: alert, repository: repo) %>
  Suggested update: <%= pull_request_url(pull_request) %>
<% end %>


<% end %>
  View all vulnerable dependencies:
  <%= @view.alerts_permalink(repo) %>

<% end %>
<% end %>
<% end %>

Change how you receive security alert emails in your notification preferences: <%= settings_notification_preferences_url %>#vulnerability-alerts-heading

Change your email preferences: <%= settings_email_preferences_url %>
Unsubscribe from this email: <%= @view.unsubscribe_link %>

<%= GitHub.physical_address %>
