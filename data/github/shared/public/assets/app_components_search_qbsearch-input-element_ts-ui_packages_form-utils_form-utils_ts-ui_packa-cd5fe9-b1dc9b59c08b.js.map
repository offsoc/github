{"version":3,"file":"chunk-app_components_search_qbsearch-input-element_ts-ui_packages_form-utils_form-utils_ts-ui_packa-cd5fe9-xxxxxxxxxxxx.js","mappings":"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,IACN,SAAM,IACN,OAAM,IACN,OAAM,IACN,SAAM,IACN,SAAM,IACN,SAAM,IACN,SAAM,IACN,SAAM,IACN,SAAM,IACN,OAAM,IACN,OAAM,IACN,SAAM,IACN,OAAM,IACN,OAAM,IACN,SAAM,IACN,SAAM,IACN,OAAM,IACN,OAAM,IACN,SAAM,IACN,OAAM,IACN,SAAM,IACN,OAAM,IACN,OAAM,IACN,OAAM,IACN,SAAM,IACN,SAAM,IACN,OAAM,KACN,OAAM,IACN,SAAM,IACN,OAAM,IACN,SAAM,IACN,OAAM,IACN,OAAM,IACN,OAAM,IACN,OAAM,IACN,OAAM,IACN,SAAM,IACN,SAAM,IACN,SAAM,IACN,OAAM,IACN,OAAM,IACN,OAAM,IACN,SAAM,IACN,OAAM,IACN,OAAM,IACN,SAAM,IACN,SAAM,IACN,SAAM,IACN,OAAM,IACN,SAAM,IACN,OAAM,IACN,OAAM,IACN,OAAM,IACN,OAAM,IACN,OAAM,IACN,SAAM,IACN,OAAM,IACN,OAAM,IACN,SAAM,IACN,OAAM,IACN,OAAM,IACN,OAAM,IACN,OAAM,IACN,SAAM,IACN,OAAM,IACN,SAAM,IACN,SAAM,IACN,OAAM,IACN,SAAM,IACN,SAAM,IACN,OAAM,IACN,OAAM,IACN,SAAM,IACN,OAAM,IACN,SAAM,IACN,OAAM,IACN,SAAM,IACN,OAAM,IACN,OAAM,IACN,SAAM,IACN,OAAM,GACX,EAEMC,EAA0B,CAC3B,IAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,KAAO,IACP,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,IACN,EAAM,I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","sources":["app/components/search/experiments.ts","app/components/search/parsing/common.ts","app/components/search/providers/history.ts","app/components/search/suggestions/languages.ts","app/components/search/providers/languages.ts","app/components/search/providers/repos.ts","app/components/search/providers/saved.ts","app/components/search/providers/owners.ts","app/components/search/providers/fixed.ts","app/components/search/providers/teams.ts","app/components/search/providers/projects.ts","app/components/search/providers/blackbird.ts","app/components/search/providers/input.ts","app/components/search/suggestions/explore-pages.ts","app/components/search/providers/explore.ts","app/components/search/providers/copilot.ts","app/components/search/qbsearch-input-element.ts","ui/packages/code-nav/code-navigation-info.ts","ui/packages/code-nav/code-symbol.ts","ui/packages/code-nav/get-match.ts","ui/packages/code-nav/symbol-result-converter.ts","ui/packages/copilot-auth-token/auth-token.ts","ui/packages/copilot-auth-token/copilot-auth-token.ts","ui/packages/form-utils/form-utils.ts","ui/packages/form-utils/remote-submit.ts","ui/packages/hotkey/hotkey.ts","ui/packages/hotkey/keyboard-shortcuts-helper.ts","ui/packages/soft-nav/events.ts","ui/packages/soft-nav/state.ts","ui/packages/soft-nav/states.ts","ui/packages/soft-nav/stats.ts","ui/packages/soft-navigate/soft-navigate.ts","ui/packages/subscription/subscription.ts","ui/packages/verified-fetch/verified-fetch.ts","node_modules/@github/combobox-nav/dist/index.js","node_modules/@github/hotkey/dist/index.js"],"sourcesContent":["import safeStorage from '@github-ui/safe-storage'\n\nconst experimentsLocalStorageKey = 'blackbird_experiments'\nconst experimentsDebugScoringKey = 'blackbird_debug_scoring'\n\nexport function getBlackbirdExperiments(): string[] {\n  const experiments = safeStorage('localStorage').getItem(experimentsLocalStorageKey)\n  if (!experiments) return []\n\n  return experiments.split(',')\n}\n\nexport function setBlackbirdExperiments(experiments: string[]): void {\n  safeStorage('localStorage').setItem(experimentsLocalStorageKey, experiments.join(','))\n}\n\nexport function debugScoringInfoEnabled(): boolean {\n  const enabled = safeStorage('localStorage').getItem(experimentsDebugScoringKey)\n  return enabled !== null\n}\n\nexport function setDebugScoringInfoEnabled(enabled: boolean): void {\n  if (enabled) {\n    safeStorage('localStorage').setItem(experimentsDebugScoringKey, '1')\n  } else {\n    safeStorage('localStorage').removeItem(experimentsDebugScoringKey)\n  }\n}\n","// important to import type so we don't bring in all the code\nimport type {BaseNode, ContentNode, QualifierNode, NodeWithChildren} from '@github/blackbird-parser'\n\nexport const enum CaretPositionKind {\n  Is,\n  Repository,\n  Owner,\n  Language,\n  Path,\n  Regex,\n  Text,\n  Saved,\n  OtherQualifier,\n}\n\nexport function isQualifier(node: BaseNode): node is QualifierNode {\n  return !!(node as QualifierNode).qualifier\n}\n\nexport function isSavedQualifier(node: BaseNode): node is QualifierNode {\n  return !!isQualifier(node) && node.qualifier === 'Saved'\n}\n\nconst slashRegex = new RegExp('\\\\/', 'g')\n\nexport function shouldRedirectInsteadOfSearch(node: BaseNode, path: string): string | null {\n  // If the entire user's query is `repo:a/b`, it doesn't make sense to search\n  // within the repository with no actual query. They probably want to navigate to\n  // the repository itself, so let's just direct them there instead.\n  if (isQualifier(node) && isContentNode(node.content)) {\n    if (node.qualifier === 'Repo') {\n      // Only redirect if it looks like a repository, i.e. contains exactly one slash\n      if ([...node.content.value.toString().matchAll(slashRegex)].length !== 1) {\n        return null\n      }\n    } else if (node.qualifier === 'Org') {\n      // Only redirect if it looks like an organization, i.e. contains exactly zero slashes\n      if ([...node.content.value.toString().matchAll(slashRegex)].length !== 0) {\n        return null\n      }\n    } else {\n      // Don't do this redirect behaviour for any other qualifier type\n      return null\n    }\n\n    // Disallow redirects to repositories or organizations that begin with a /, since\n    // that would form an absolute URL!\n    if (node.content.value.toString().startsWith('/')) {\n      return null\n    }\n\n    const redirectURL = `/${node.content.value.toString().split('/').map(encodeURIComponent).join('/')}`\n\n    // If the redirect would take them to the path they're already on, then it's pointless, so\n    // just do a search instead.\n    if (redirectURL === path) {\n      return null\n    }\n\n    return redirectURL\n  }\n\n  return null\n}\n\n// this function is unfortunately duplicated from @github/blackbird-parser so that the code that\n// uses it doesn't import that whole huge module\nexport function isContentNode(node: BaseNode): node is ContentNode {\n  return (node as ContentNode).value !== undefined\n}\n\nexport function hasChildren(node: BaseNode): node is NodeWithChildren {\n  return !!(node as NodeWithChildren).children\n}\n\nexport function containsQualifier(node: BaseNode, qualifierKind: string): boolean {\n  if (isQualifier(node) && node.qualifier === qualifierKind) {\n    return true\n  }\n\n  if (hasChildren(node)) {\n    for (const child of node.children) {\n      if (containsQualifier(child, qualifierKind)) {\n        return true\n      }\n    }\n  }\n  return false\n}\n\n// Extract all of the text nodes from the AST, ignoring qualifiers. For example,\n// the query `lang:typescript repo:github/atom asdf` would return `['asdf']`.\nexport function extractTextQuery(node: BaseNode): string {\n  if (hasChildren(node)) {\n    return node.children\n      .map(extractTextQuery)\n      .filter(x => x.length > 0)\n      .join(' ')\n  }\n\n  if (isQualifier(node) || node.kind === 'Regex') {\n    return ''\n  }\n\n  if (isContentNode(node)) {\n    return node.value.toString()\n  }\n\n  return ''\n}\n\ninterface RepoOrgScope {\n  kind: 'repo' | 'org' | 'saved'\n  value: string\n}\n\n// Extract all repo and orgs mentioned in the query\nexport function extractRepoOrgScopes(node: BaseNode): RepoOrgScope[] {\n  if (node.kind === 'Not') {\n    return []\n  }\n\n  if (hasChildren(node)) {\n    return node.children.map(extractRepoOrgScopes).flat()\n  }\n\n  if (isQualifier(node)) {\n    if (node.qualifier === 'Repo' && isContentNode(node.content)) {\n      return [{kind: 'repo', value: node.content.value.toString()}]\n    } else if (node.qualifier === 'Org' && isContentNode(node.content)) {\n      return [{kind: 'org', value: node.content.value.toString()}]\n    } else if (isSavedQualifier(node) && isContentNode(node.content)) {\n      return [{kind: 'saved', value: node.content.value.toString()}]\n    }\n  }\n  return []\n}\n\nexport function restrictToScopedOrgs(node: BaseNode, orgs: string[]): string[] {\n  const repoOrgScopes = new Set(\n    extractRepoOrgScopes(node)\n      .map(scope => {\n        if (scope.kind === 'org') {\n          return scope.value\n        } else if (scope.kind === 'repo' && scope.value.includes('/')) {\n          return scope.value.split('/')[0]\n        } else {\n          return null\n        }\n      })\n      .filter(s => s !== null)\n      .map(s => s?.toLowerCase()),\n  )\n\n  if (repoOrgScopes.size === 0) {\n    return orgs\n  }\n\n  return orgs.filter(org => repoOrgScopes.has(org.toLowerCase()))\n}\n","import type {SearchProvider, QueryEvent} from '@github-ui/query-builder-element/query-builder-api'\nimport {SearchItem, Octicon} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport safeStorage from '@github-ui/safe-storage'\nimport {CaretPositionKind} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\n\nconst safeLocalStorage = safeStorage('localStorage')\n\nexport class HistoryProvider extends EventTarget implements SearchProvider {\n  priority = 5\n  name = 'History'\n  singularItemName = 'history'\n  value = 'history'\n  type = 'search' as const\n\n  constructor(public queryBuilder: QueryBuilderElement) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    if (!state || state.caretPositionKind !== CaretPositionKind.Text) {\n      return []\n    }\n\n    const query = event.toString()\n    let suggestions: string[] = JSON.parse(safeLocalStorage.getItem('github-search-history') ?? '[]')\n\n    const trimmedQuery = state.query.trim()\n    if (trimmedQuery.length !== 0) {\n      return []\n    }\n\n    // Deduplicate suggestions\n    const seen: Record<string, boolean> = {}\n    suggestions = suggestions.filter(item => {\n      if (!seen[item]) {\n        seen[item] = true\n        return true\n      }\n      return false\n    })\n\n    let suggestionCount = 0\n    for (const suggestion of suggestions) {\n      if (suggestionCount >= 5) break\n\n      const historyQuery = suggestion.trim()\n      if (historyQuery.startsWith(query)) {\n        suggestionCount += 1\n        this.dispatchEvent(\n          new SearchItem({\n            value: historyQuery,\n            icon: Octicon.Search,\n            scope: 'GENERAL',\n            priority: historyQuery.length,\n            action: {url: `/search?q=${historyQuery}`},\n          }),\n        )\n      }\n    }\n  }\n}\n","export interface Language {\n  name: string\n  color: string\n}\n\n// NOTE: this is not intended to be an exhaustive list of supported languages,\n// but just a list suitable to be rendered as suggestions. The list is copied\n// from Enry's data (which is what is used within Blackbird's backend), see\n// https://github.com/src-d/enry/blob/master/data/colors.go\nexport const PopularLanguages: Language[] = [\n  {name: 'C++', color: '#f34b7d'},\n  {name: 'Go', color: '#00ADD8'},\n  {name: 'Java', color: '#b07219'},\n  {name: 'JavaScript', color: '#f1e05a'},\n  {name: 'PHP', color: '#4F5D95'},\n  {name: 'Python', color: '#3572A5'},\n  {name: 'Ruby', color: '#701516'},\n  {name: 'TypeScript', color: '#2b7489'},\n  {name: 'ABAP', color: '#E8274B'},\n  {name: 'AGS Script', color: '#B9D9FF'},\n  {name: 'AMPL', color: '#E6EFBB'},\n  {name: 'ANTLR', color: '#9DC3FF'},\n  {name: 'API Blueprint', color: '#2ACCA8'},\n  {name: 'APL', color: '#5A8164'},\n  {name: 'ASP', color: '#6a40fd'},\n  {name: 'ATS', color: '#1ac620'},\n  {name: 'ActionScript', color: '#882B0F'},\n  {name: 'Ada', color: '#02f88c'},\n  {name: 'Agda', color: '#315665'},\n  {name: 'Alloy', color: '#64C800'},\n  {name: 'AngelScript', color: '#C7D7DC'},\n  {name: 'AppleScript', color: '#101F1F'},\n  {name: 'Arc', color: '#aa2afe'},\n  {name: 'AspectJ', color: '#a957b0'},\n  {name: 'Assembly', color: '#6E4C13'},\n  {name: 'Asymptote', color: '#4a0c0c'},\n  {name: 'AutoHotkey', color: '#6594b9'},\n  {name: 'AutoIt', color: '#1C3552'},\n  {name: 'Ballerina', color: '#FF5000'},\n  {name: 'Batchfile', color: '#C1F12E'},\n  {name: 'BlitzMax', color: '#cd6400'},\n  {name: 'Boo', color: '#d4bec1'},\n  {name: 'C', color: '#555555'},\n  {name: 'C#', color: '#178600'},\n  {name: 'CSS', color: '#563d7c'},\n  {name: 'Ceylon', color: '#dfa535'},\n  {name: 'Chapel', color: '#8dc63f'},\n  {name: 'Cirru', color: '#ccccff'},\n  {name: 'Clarion', color: '#db901e'},\n  {name: 'Clean', color: '#3F85AF'},\n  {name: 'Click', color: '#E4E6F3'},\n  {name: 'Clojure', color: '#db5855'},\n  {name: 'CoffeeScript', color: '#244776'},\n  {name: 'ColdFusion', color: '#ed2cd6'},\n  {name: 'Common Lisp', color: '#3fb68b'},\n  {name: 'Common Workflow Language', color: '#B5314C'},\n  {name: 'Component Pascal', color: '#B0CE4E'},\n  {name: 'Crystal', color: '#000100'},\n  {name: 'Cuda', color: '#3A4E3A'},\n  {name: 'D', color: '#ba595e'},\n  {name: 'DM', color: '#447265'},\n  {name: 'Dart', color: '#00B4AB'},\n  {name: 'DataWeave', color: '#003a52'},\n  {name: 'Dhall', color: '#dfafff'},\n  {name: 'Dockerfile', color: '#384d54'},\n  {name: 'Dogescript', color: '#cca760'},\n  {name: 'Dylan', color: '#6c616e'},\n  {name: 'E', color: '#ccce35'},\n  {name: 'ECL', color: '#8a1267'},\n  {name: 'EQ', color: '#a78649'},\n  {name: 'Eiffel', color: '#946d57'},\n  {name: 'Elixir', color: '#6e4a7e'},\n  {name: 'Elm', color: '#60B5CC'},\n  {name: 'Emacs Lisp', color: '#c065db'},\n  {name: 'EmberScript', color: '#FFF4F3'},\n  {name: 'Erlang', color: '#B83998'},\n  {name: 'F#', color: '#b845fc'},\n  {name: 'F*', color: '#572e30'},\n  {name: 'FLUX', color: '#88ccff'},\n  {name: 'Factor', color: '#636746'},\n  {name: 'Fancy', color: '#7b9db4'},\n  {name: 'Fantom', color: '#14253c'},\n  {name: 'Forth', color: '#341708'},\n  {name: 'Fortran', color: '#4d41b1'},\n  {name: 'FreeMarker', color: '#0050b2'},\n  {name: 'Frege', color: '#00cafe'},\n  {name: 'G-code', color: '#D08CF2'},\n  {name: 'GDScript', color: '#355570'},\n  {name: 'Game Maker Language', color: '#71b417'},\n  {name: 'Genie', color: '#fb855d'},\n  {name: 'Gherkin', color: '#5B2063'},\n  {name: 'Glyph', color: '#c1ac7f'},\n  {name: 'Gnuplot', color: '#f0a9f0'},\n  {name: 'Groovy', color: '#e69f56'},\n  {name: 'HTML', color: '#e34c26'},\n  {name: 'Hack', color: '#878787'},\n  {name: 'Harbour', color: '#0e60e3'},\n  {name: 'Haskell', color: '#5e5086'},\n  {name: 'Haxe', color: '#df7900'},\n  {name: 'HCL', color: '#844fba'},\n  {name: 'HiveQL', color: '#dce200'},\n  {name: 'HolyC', color: '#ffefaf'},\n  {name: 'Hy', color: '#7790B2'},\n  {name: 'IDL', color: '#a3522f'},\n  {name: 'Idris', color: '#b30000'},\n  {name: 'Io', color: '#a9188d'},\n  {name: 'Ioke', color: '#078193'},\n  {name: 'Isabelle', color: '#FEFE00'},\n  {name: 'J', color: '#9EEDFF'},\n  {name: 'JSONiq', color: '#40d47e'},\n  {name: 'Jolie', color: '#843179'},\n  {name: 'Jsonnet', color: '#0064bd'},\n  {name: 'Julia', color: '#a270ba'},\n  {name: 'Jupyter Notebook', color: '#DA5B0B'},\n  {name: 'KRL', color: '#28430A'},\n  {name: 'Kotlin', color: '#F18E33'},\n  {name: 'LFE', color: '#4C3023'},\n  {name: 'LLVM', color: '#185619'},\n  {name: 'LSL', color: '#3d9970'},\n  {name: 'Lasso', color: '#999999'},\n  {name: 'Lex', color: '#DBCA00'},\n  {name: 'LiveScript', color: '#499886'},\n  {name: 'LookML', color: '#652B81'},\n  {name: 'Lua', color: '#000080'},\n  {name: 'MATLAB', color: '#e16737'},\n  {name: 'MAXScript', color: '#00a6a6'},\n  {name: 'MQL4', color: '#62A8D6'},\n  {name: 'MQL5', color: '#4A76B8'},\n  {name: 'MTML', color: '#b7e1f4'},\n  {name: 'Makefile', color: '#427819'},\n  {name: 'Markdown', color: '#083fa1'},\n  {name: 'Mask', color: '#f97732'},\n  {name: 'Max', color: '#c4a79c'},\n  {name: 'Mercury', color: '#ff2b2b'},\n  {name: 'Meson', color: '#007800'},\n  {name: 'Metal', color: '#8f14e9'},\n  {name: 'Mirah', color: '#c7a938'},\n  {name: 'Modula-3', color: '#223388'},\n  {name: 'NCL', color: '#28431f'},\n  {name: 'Nearley', color: '#990000'},\n  {name: 'Nemerle', color: '#3d3c6e'},\n  {name: 'NetLinx', color: '#0aa0ff'},\n  {name: 'NetLinx+ERB', color: '#747faa'},\n  {name: 'NetLogo', color: '#ff6375'},\n  {name: 'NewLisp', color: '#87AED7'},\n  {name: 'Nextflow', color: '#3ac486'},\n  {name: 'Nim', color: '#37775b'},\n  {name: 'Nit', color: '#009917'},\n  {name: 'Nix', color: '#7e7eff'},\n  {name: 'Nu', color: '#c9df40'},\n  {name: 'OCaml', color: '#3be133'},\n  {name: 'ObjectScript', color: '#424893'},\n  {name: 'Objective-C', color: '#438eff'},\n  {name: 'Objective-C++', color: '#6866fb'},\n  {name: 'Objective-J', color: '#ff0c5a'},\n  {name: 'Omgrofl', color: '#cabbff'},\n  {name: 'Opal', color: '#f7ede0'},\n  {name: 'Oxygene', color: '#cdd0e3'},\n  {name: 'Oz', color: '#fab738'},\n  {name: 'P4', color: '#7055b5'},\n  {name: 'PLSQL', color: '#dad8d8'},\n  {name: 'Pan', color: '#cc0000'},\n  {name: 'Papyrus', color: '#6600cc'},\n  {name: 'Parrot', color: '#f3ca0a'},\n  {name: 'Pascal', color: '#E3F171'},\n  {name: 'Pawn', color: '#dbb284'},\n  {name: 'Pep8', color: '#C76F5B'},\n  {name: 'Perl', color: '#0298c3'},\n  {name: 'Perl 6', color: '#0000fb'},\n  {name: 'PigLatin', color: '#fcd7de'},\n  {name: 'Pike', color: '#005390'},\n  {name: 'PogoScript', color: '#d80074'},\n  {name: 'PostScript', color: '#da291c'},\n  {name: 'PowerBuilder', color: '#8f0f8d'},\n  {name: 'PowerShell', color: '#012456'},\n  {name: 'Processing', color: '#0096D8'},\n  {name: 'Prolog', color: '#74283c'},\n  {name: 'Propeller Spin', color: '#7fa2a7'},\n  {name: 'Puppet', color: '#302B6D'},\n  {name: 'PureBasic', color: '#5a6986'},\n  {name: 'PureScript', color: '#1D222D'},\n  {name: 'Protocol Buffers', color: '#CCCCCC'},\n  {name: 'QML', color: '#44a51c'},\n  {name: 'Quake', color: '#882233'},\n  {name: 'R', color: '#198CE7'},\n  {name: 'RAML', color: '#77d9fb'},\n  {name: 'Racket', color: '#3c5caa'},\n  {name: 'Ragel', color: '#9d5200'},\n  {name: 'Rascal', color: '#fffaa0'},\n  {name: 'Rebol', color: '#358a5b'},\n  {name: 'Red', color: '#f50000'},\n  {name: \"Ren'Py\", color: '#ff7f7f'},\n  {name: 'Ring', color: '#2D54CB'},\n  {name: 'Roff', color: '#ecdebe'},\n  {name: 'Rouge', color: '#cc0088'},\n  {name: 'Rust', color: '#dea584'},\n  {name: 'SAS', color: '#B34936'},\n  {name: 'SQF', color: '#3F3F3F'},\n  {name: 'SQL', color: '#e38c00'},\n  {name: 'SRecode Template', color: '#348a34'},\n  {name: 'SaltStack', color: '#646464'},\n  {name: 'Scala', color: '#c22d40'},\n  {name: 'Scheme', color: '#1e4aec'},\n  {name: 'Self', color: '#0579aa'},\n  {name: 'Shell', color: '#89e051'},\n  {name: 'Shen', color: '#120F14'},\n  {name: 'Slash', color: '#007eff'},\n  {name: 'Slice', color: '#003fa2'},\n  {name: 'Smalltalk', color: '#596706'},\n  {name: 'Solidity', color: '#AA6746'},\n  {name: 'SourcePawn', color: '#5c7611'},\n  {name: 'Squirrel', color: '#800000'},\n  {name: 'Stan', color: '#b2011d'},\n  {name: 'Standard ML', color: '#dc566d'},\n  {name: 'SuperCollider', color: '#46390b'},\n  {name: 'Swift', color: '#ffac45'},\n  {name: 'SystemVerilog', color: '#DAE1C2'},\n  {name: 'TI Program', color: '#A0AA87'},\n  {name: 'Tcl', color: '#e4cc98'},\n  {name: 'TeX', color: '#3D6117'},\n  {name: 'Terra', color: '#00004c'},\n  {name: 'Turing', color: '#cf142b'},\n  {name: 'UnrealScript', color: '#a54c4d'},\n  {name: 'VCL', color: '#148AA8'},\n  {name: 'VHDL', color: '#adb2cb'},\n  {name: 'Vala', color: '#fbe5cd'},\n  {name: 'Verilog', color: '#b2b7f8'},\n  {name: 'Vim script', color: '#199f4b'},\n  {name: 'Visual Basic', color: '#945db7'},\n  {name: 'Volt', color: '#1F1F1F'},\n  {name: 'Vue', color: '#2c3e50'},\n  {name: 'WebAssembly', color: '#04133b'},\n  {name: 'Wollok', color: '#a23738'},\n  {name: 'X10', color: '#4B6BEF'},\n  {name: 'XC', color: '#99DA07'},\n  {name: 'XQuery', color: '#5232e7'},\n  {name: 'XSLT', color: '#EB8CEB'},\n  {name: 'YARA', color: '#220000'},\n  {name: 'YASnippet', color: '#32AB90'},\n  {name: 'Yacc', color: '#4B6C4B'},\n  {name: 'ZAP', color: '#0d665e'},\n  {name: 'ZIL', color: '#dc75e5'},\n  {name: 'ZenScript', color: '#00BCD1'},\n  {name: 'Zephir', color: '#118f9e'},\n  {name: 'Zig', color: '#ec915c'},\n  {name: 'eC', color: '#913960'},\n  {name: 'mcfunction', color: '#E22837'},\n  {name: 'nesC', color: '#94B0C7'},\n  {name: 'ooc', color: '#b0b77e'},\n  {name: 'sed', color: '#64b970'},\n  {name: 'wdl', color: '#42f1f4'},\n  {name: 'wisp', color: '#7582D1'},\n  {name: 'xBase', color: '#403a40'},\n]\n","import {filterSort} from '@github-ui/filter-sort'\nimport {html} from '@github-ui/jtml-shimmed'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {QueryEvent, CustomIcon, FilterProvider} from '@github-ui/query-builder-element/query-builder-api'\nimport {FilterItem} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport type {Language} from '../suggestions/languages'\nimport {PopularLanguages} from '../suggestions/languages'\nimport {CaretPositionKind, isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport type {SafeHTMLString} from '@github-ui/safe-html'\n\nexport class LanguagesProvider extends EventTarget implements FilterProvider {\n  priority = 10\n  name = 'Languages'\n  singularItemName = 'language'\n  value = 'language'\n  type = 'filter' as const\n  manuallyDetermineFilterEligibility = true\n\n  constructor(public queryBuilder: QueryBuilderElement) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  #icon(color: string): CustomIcon {\n    const node = document.createElement('div')\n    const tmpl = html`<div\n      style=\"border-radius: 8px; display: inline-block; height: 10px; width: 10px; background-color: ${color}\"\n    ></div>`\n\n    tmpl.renderInto(node)\n\n    return {\n      html: node.innerHTML as SafeHTMLString,\n    }\n  }\n\n  handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n\n    if (!state || state.caretPositionKind !== CaretPositionKind.Language) {\n      return []\n    }\n\n    let term = ''\n\n    if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      }\n    } else {\n      return []\n    }\n\n    let suggestions: Language[] = PopularLanguages.slice(0, 7)\n    if (term.length === 1) {\n      suggestions = PopularLanguages.filter(r => r.name.startsWith(term.toUpperCase())).slice(0, 7)\n    } else if (term.length > 1) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (r: {name: string; color: string}) => {\n        const score = fuzzyScore(r.name, fuzzyQuery)\n        return score > 0 ? {score, text: r.name} : null\n      }\n      suggestions = filterSort(PopularLanguages, key, compare)\n    }\n\n    const suggestionCount = 0\n    for (const suggestion of suggestions) {\n      if (suggestionCount >= 8) break\n\n      let rewriteStart = state.caretSelectedNode.location.end\n      let rewriteEnd = state.caretSelectedNode.location.end\n      if (isContentNode(state.caretSelectedNode.content)) {\n        rewriteStart = state.caretSelectedNode.content.location.start\n        rewriteEnd = state.caretSelectedNode.content.location.end\n      }\n\n      const quotedName = suggestion.name.includes(' ') ? `\"${suggestion.name}\"` : suggestion.name\n      const newQuery = `${state.query.slice(0, rewriteStart) + quotedName} ${state.query.slice(rewriteEnd)}`\n\n      this.dispatchEvent(\n        new FilterItem({\n          filter: 'lang',\n          value: suggestion.name,\n          icon: this.#icon(suggestion.color),\n          priority: 0,\n          action: {\n            query: newQuery,\n            replaceQueryWith: newQuery,\n            moveCaretTo: rewriteStart + quotedName.length + 1,\n          },\n        }),\n      )\n    }\n  }\n}\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {\n  QueryEvent,\n  FilterProvider,\n  QueryBuilderAction,\n  SearchProvider,\n} from '@github-ui/query-builder-element/query-builder-api'\nimport {FilterItem, Octicon, SearchItem} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {getSuggestions} from '../../../assets/modules/github/jump-to'\nimport {CaretPositionKind, extractRepoOrgScopes, extractTextQuery, isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\n\nclass ReposProviderBase extends EventTarget {\n  #input: HTMLElement\n  #suggestedRepos: string[] | null = null\n\n  constructor(input: HTMLElement) {\n    super()\n    this.#input = input\n  }\n\n  protected async getMatchingRepositories({state}: {state: ParsedIntermediateRepresentation}) {\n    let term = ''\n    const scopedOrgs: string[] = []\n    if (state.ast) {\n      const scopes = extractRepoOrgScopes(state.ast)\n      let isScopedToRepository = false\n      for (const scope of scopes) {\n        if (scope.kind === 'repo' || scope.kind === 'saved') {\n          isScopedToRepository = true\n        } else if (scope.kind === 'org') {\n          scopedOrgs.push(scope.value.toLowerCase())\n        }\n      }\n\n      // Don't suggest repositories if we are scoped to a repo and aren't currently\n      // editing that qualifier\n      if (isScopedToRepository && state.caretPositionKind !== CaretPositionKind.Repository) {\n        return []\n      }\n\n      term = extractTextQuery(state.ast)\n    }\n\n    if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      } else {\n        term = ''\n      }\n    }\n\n    if (this.#suggestedRepos === null) {\n      this.#suggestedRepos = (await getSuggestions(this.#input)).filter(r => r.type === 'Repository').map(r => r.name)\n    }\n\n    let matches = this.#suggestedRepos\n    if (term.length > 0) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (r: string) => {\n        const score = fuzzyScore(r, fuzzyQuery)\n        return score > 0 ? {score, text: r} : null\n      }\n      matches = filterSort(this.#suggestedRepos, key, compare)\n    }\n\n    // Filter matches match orgs specified in the query\n    if (scopedOrgs.length > 0) {\n      matches = matches.filter(r => {\n        const org = r.split('/')[0]!.toLowerCase()\n        return scopedOrgs.find(o => org.startsWith(o))\n      })\n    }\n\n    return matches\n  }\n}\n\nexport class ReposFilterProvider extends ReposProviderBase implements FilterProvider {\n  priority = 6\n  name = 'Repositories'\n  singularItemName = 'repository'\n  value = 'repository-filter'\n  type = 'filter' as const\n  manuallyDetermineFilterEligibility = true\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super(input)\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    const hasFocus = this.queryBuilder.hasFocus()\n    if (!state || !hasFocus) {\n      return []\n    }\n\n    if (\n      state.caretPositionKind !== CaretPositionKind.Repository &&\n      state.caretPositionKind !== CaretPositionKind.Owner\n    ) {\n      return []\n    }\n\n    const matches = await this.getMatchingRepositories({state})\n\n    for (const suggestion of matches.slice(0, 5)) {\n      let action: QueryBuilderAction = {\n        url: `/${suggestion}`,\n      }\n\n      if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n        let rewriteStart = state.caretSelectedNode.location.end\n        let rewriteEnd = state.caretSelectedNode.location.end\n        if (isContentNode(state.caretSelectedNode.content)) {\n          rewriteStart = state.caretSelectedNode.content.location.start\n          rewriteEnd = state.caretSelectedNode.content.location.end\n        }\n\n        const newQuery = `${state.query.slice(0, rewriteStart) + suggestion} ${state.query.slice(rewriteEnd)}`\n        action = {\n          replaceQueryWith: newQuery,\n          moveCaretTo: rewriteStart + suggestion.length + 1,\n        }\n      }\n\n      this.dispatchEvent(\n        new FilterItem({\n          filter: 'repo',\n          value: suggestion,\n          icon: Octicon.Repo,\n          priority: 0,\n          action,\n        }),\n      )\n    }\n  }\n}\n\nexport class ReposSearchProvider extends ReposProviderBase implements SearchProvider {\n  priority = 6\n  name = 'Repositories'\n  singularItemName = 'repository'\n  value = 'repository-search'\n  type = 'search' as const\n  manuallyDetermineFilterEligibility = true\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super(input)\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    const hasFocus = this.queryBuilder.hasFocus()\n    if (!state || !hasFocus || state.caretPositionKind !== CaretPositionKind.Text) {\n      return []\n    }\n\n    const matches = await this.getMatchingRepositories({\n      state,\n    })\n\n    for (const suggestion of matches.slice(0, 5)) {\n      this.dispatchEvent(\n        new SearchItem({\n          value: suggestion,\n          icon: Octicon.Repo,\n          priority: 0,\n          action: {\n            url: `/${suggestion}`,\n          },\n        }),\n      )\n    }\n  }\n}\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {QueryEvent, SearchProvider} from '@github-ui/query-builder-element/query-builder-api'\nimport {Octicon, SearchItem} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {CaretPositionKind, containsQualifier, isQualifier, isSavedQualifier, isContentNode} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport type {CustomScope} from '../suggestions/types'\n\nexport class CustomScopeCache {\n  #cache: CustomScope[] = []\n  #filled: boolean\n\n  set(scopes: CustomScope[]) {\n    this.#cache = scopes\n    this.#filled = true\n  }\n\n  get() {\n    if (this.#filled) return this.#cache\n    return undefined\n  }\n\n  len() {\n    return this.#cache.length\n  }\n\n  clear() {\n    this.#filled = false\n    this.#cache = []\n  }\n}\n\nexport class SavedScopeProvider extends EventTarget implements SearchProvider {\n  priority = 4\n  name = 'Saved queries'\n  singularItemName = 'saved query'\n  value = 'saved query'\n  type = 'search' as const\n  #customScopesUrl: string | null\n  customScopesCache = new CustomScopeCache()\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    customScopesUrl: string,\n  ) {\n    super()\n    this.#customScopesUrl = customScopesUrl\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  async fetchSuggestions(): Promise<CustomScope[]> {\n    let data = []\n    if (this.#customScopesUrl) {\n      const response = await fetch(this.#customScopesUrl, {\n        method: 'GET',\n        mode: 'same-origin',\n        headers: {\n          Accept: 'application/json',\n        },\n      })\n      if (!response.ok) {\n        return []\n      }\n      data = await response.json()\n      this.#replaceCustomScopesCache(data)\n    }\n    return data\n  }\n\n  #replaceCustomScopesCache(data: CustomScope[]): void {\n    this.customScopesCache.set(data)\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n\n    if (\n      !state ||\n      (state.caretPositionKind !== CaretPositionKind.Text && state.caretPositionKind !== CaretPositionKind.Saved)\n    ) {\n      return []\n    }\n\n    // If the query already contains a saved search, and the caret isn't over it, don't suggest any more\n    if (state.caretPositionKind !== CaretPositionKind.Saved && state.ast && containsQualifier(state.ast, 'Saved')) {\n      return []\n    }\n\n    // If the query already contains an org or repo term, don't suggest saved searches\n    if (state.ast && (containsQualifier(state.ast, 'Repo') || containsQualifier(state.ast, 'Org'))) {\n      return []\n    }\n\n    let term = ''\n    if (state.caretSelectedNode) {\n      if (isSavedQualifier(state.caretSelectedNode)) {\n        if (isContentNode(state.caretSelectedNode.content)) {\n          term = String(state.caretSelectedNode.content.value)\n        }\n      } else if (isContentNode(state.caretSelectedNode)) {\n        term = String(state.caretSelectedNode.value)\n      }\n    }\n\n    let suggestions = this.customScopesCache.get()\n    if (suggestions === undefined) {\n      suggestions = await this.fetchSuggestions()\n    }\n\n    if (term.trim().length > 0) {\n      // Remove whitespace and quotes (which can surround saved searches)\n      const fuzzyQuery = term.replace(/[\\s\"]/g, '')\n      const key = (s: CustomScope) => {\n        const score = fuzzyScore(s.name, fuzzyQuery)\n        return score > 0 ? {score, text: s.name} : null\n      }\n      suggestions = filterSort(suggestions, key, compare)\n    }\n\n    for (const suggestion of suggestions) {\n      const qualifier = 'saved:'\n\n      let quotedName = suggestion.name.includes(' ') ? `\"${suggestion.name}\"` : suggestion.name\n\n      let replaceQueryWith = ''\n      if (state.query.endsWith(' ') || state.query === '') {\n        replaceQueryWith = `${state.query}${qualifier + quotedName} `\n      } else {\n        replaceQueryWith = `${state.query} ${qualifier + quotedName} `\n      }\n      let moveCaretTo = replaceQueryWith.length\n\n      if (state.caretSelectedNode && (isContentNode(state.caretSelectedNode) || isQualifier(state.caretSelectedNode))) {\n        const rewriteStart = state.caretSelectedNode.location.start\n        let rewriteEnd = state.caretSelectedNode.location.end\n        if (isQualifier(state.caretSelectedNode) && isContentNode(state.caretSelectedNode.content)) {\n          rewriteEnd = state.caretSelectedNode.content.location.end\n        }\n\n        const queryStart = state.query.slice(0, rewriteStart)\n        const queryEnd = state.query.slice(rewriteEnd).trimEnd()\n        if (queryEnd === '') {\n          quotedName += ' ' // Add a space if the insertion is at the end\n        }\n\n        const newQuery = queryStart + qualifier + quotedName + queryEnd\n        replaceQueryWith = newQuery\n        moveCaretTo = rewriteStart + qualifier.length + quotedName.length\n      }\n\n      this.dispatchEvent(\n        new SearchItem({\n          value: `saved:${suggestion.name}`,\n          icon: Octicon.Bookmark,\n          priority: 0,\n          action: {\n            replaceQueryWith,\n            moveCaretTo,\n          },\n        }),\n      )\n    }\n\n    if (state.caretPositionKind === CaretPositionKind.Saved) {\n      this.dispatchEvent(\n        new SearchItem({\n          value: `Manage saved searches`,\n          icon: Octicon.PlusCircle,\n          scope: 'COMMAND',\n          priority: 0,\n          action: {\n            commandName: 'blackbird-monolith.manageCustomScopes',\n            data: {},\n          },\n        }),\n      )\n    }\n  }\n}\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {QueryEvent, SearchProvider, QueryBuilderAction} from '@github-ui/query-builder-element/query-builder-api'\nimport {SearchItem, Octicon} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {getSuggestions} from '../../../assets/modules/github/jump-to'\nimport {CaretPositionKind, extractRepoOrgScopes, extractTextQuery, isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\n\nexport class OwnersProvider extends EventTarget implements SearchProvider {\n  priority = 5\n  name = 'Owners'\n  singularItemName = 'owner'\n  value = 'owner'\n  type = 'search' as const\n  manuallyDetermineFilterEligibility = true\n\n  #suggestedOwners: string[] | null = null\n  #input: HTMLElement\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n    this.#input = input\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    const hasFocus = this.queryBuilder.hasFocus()\n    if (!state || !hasFocus) {\n      return []\n    }\n\n    if (state.caretPositionKind === CaretPositionKind.Text && state.ast) {\n      // If the query is already scoped, don't suggest any more orgs\n      if (extractRepoOrgScopes(state.ast).length) {\n        return []\n      }\n      // Check that there are no existing scopes already applied\n    } else if (state.caretPositionKind !== CaretPositionKind.Owner) {\n      return []\n    }\n\n    let term = ''\n    const scopedOrgs: string[] = []\n    if (state.ast) {\n      term = extractTextQuery(state.ast)\n    }\n\n    if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      } else {\n        term = ''\n      }\n    }\n\n    if (this.#suggestedOwners === null) {\n      const owners = (await getSuggestions(this.#input))\n        .filter(r => r.type === 'Repository')\n        .map(r => r.name.split('/')[0]!)\n      this.#suggestedOwners = [...new Set(owners)]\n    }\n\n    let matches = this.#suggestedOwners\n    if (term.length > 0) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (r: string) => {\n        const score = fuzzyScore(r, fuzzyQuery)\n        return score > 0 ? {score, text: r} : null\n      }\n      matches = filterSort(this.#suggestedOwners, key, compare)\n    }\n\n    // Filter matches match orgs specified in the query\n    if (scopedOrgs.length > 0) {\n      matches = matches.filter(r => {\n        const org = r.split('/')[0]!.toLowerCase()\n        return scopedOrgs.find(o => org.startsWith(o))\n      })\n    }\n\n    for (const suggestion of matches.slice(0, 5)) {\n      let action: QueryBuilderAction = {\n        url: `/${suggestion}`,\n      }\n\n      if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n        let rewriteStart = state.caretSelectedNode.location.end\n        let rewriteEnd = state.caretSelectedNode.location.end\n        if (isContentNode(state.caretSelectedNode.content)) {\n          rewriteStart = state.caretSelectedNode.content.location.start\n          rewriteEnd = state.caretSelectedNode.content.location.end\n        }\n\n        const newQuery = `${state.query.slice(0, rewriteStart) + suggestion} ${state.query.slice(rewriteEnd)}`\n        action = {\n          replaceQueryWith: newQuery,\n          moveCaretTo: rewriteStart + suggestion.length + 1,\n        }\n      }\n\n      this.dispatchEvent(\n        new SearchItem({\n          value: suggestion,\n          icon: Octicon.Repo,\n          priority: 0,\n          action,\n        }),\n      )\n    }\n  }\n}\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {QueryEvent, FilterProvider} from '@github-ui/query-builder-element/query-builder-api'\nimport {FilterItem, Octicon} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {CaretPositionKind, isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport type {BaseNode} from '@github/blackbird-parser'\n// eslint-disable-next-line import/no-namespace\nimport type * as Parsing from '../parsing/parsing'\n\nexport class FixedValuesProvider extends EventTarget implements FilterProvider {\n  priority = 3\n  name = 'Values'\n  singularItemName = 'value'\n  value = 'value'\n  type = 'filter' as const\n  manuallyDetermineFilterEligibility = true\n\n  #parsing: typeof Parsing | undefined\n\n  constructor(public queryBuilder: QueryBuilderElement) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n\n    if (!state) {\n      return []\n    }\n\n    if (\n      state.caretPositionKind !== CaretPositionKind.OtherQualifier &&\n      state.caretPositionKind !== CaretPositionKind.Is\n    ) {\n      return []\n    }\n\n    if (!state.caretSelectedNode || !isQualifier(state.caretSelectedNode)) {\n      return []\n    }\n\n    if (!this.#parsing) {\n      this.#parsing = await import('../parsing/parsing')\n    }\n\n    let matches = []\n\n    const isLicense = state.caretSelectedNode.qualifier === 'License'\n    const isLanguage = state.caretSelectedNode.qualifier === 'Language'\n\n    if (isLicense) {\n      matches = [\n        ['BSD Zero Clause License', '0bsd'],\n        ['MIT License', 'mit'],\n        ['Apache License 2.0', 'apache-2.0'],\n        ['Creative Commons', 'cc'],\n        ['GNU General Public License', 'gpl'],\n        ['GNU Lesser General Public License', 'lgpl'],\n      ]\n    } else {\n      matches = this.#parsing\n        .getPossibleQualifierValues(\n          this.#parsing.chooseSearchType(state.ast as BaseNode, true),\n          state.caretSelectedNode.qualifier,\n        )\n        .map(r => [r, r])\n    }\n\n    let term = state.query\n    if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      } else {\n        term = ''\n      }\n    }\n\n    if (term.length > 0) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (r: string[]) => {\n        const t = r[0] === r[1] ? r[0]! : `${r[0]} ${r[1]}`\n        const score = fuzzyScore(t, fuzzyQuery)\n        return score > 0 ? {score, text: t} : undefined\n      }\n      matches = filterSort(matches, key, compare)\n    }\n\n    for (const suggestion of matches.slice(0, 5)) {\n      if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n        let rewriteStart = state.caretSelectedNode.location.end\n        let rewriteEnd = state.caretSelectedNode.location.end\n        if (isContentNode(state.caretSelectedNode.content)) {\n          rewriteStart = state.caretSelectedNode.content.location.start\n          rewriteEnd = state.caretSelectedNode.content.location.end\n        }\n\n        const quotedValue = suggestion[1]!.includes(' ') ? `\"${suggestion[1]}\"` : suggestion[1]!\n\n        const newQuery = `${state.query.slice(0, rewriteStart) + quotedValue} ${state.query.slice(rewriteEnd)}`\n        const action = {\n          replaceQueryWith: newQuery,\n          moveCaretTo: rewriteStart + quotedValue.length + 1,\n        }\n        this.dispatchEvent(\n          new FilterItem({\n            filter: 'owner',\n            value: suggestion[0]!,\n            icon: isLanguage ? Octicon.Circle : undefined,\n            priority: 0,\n            action,\n          }),\n        )\n      }\n    }\n  }\n}\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {QueryEvent, SearchProvider} from '@github-ui/query-builder-element/query-builder-api'\nimport {SearchItem, Octicon} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {CaretPositionKind, isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport {getSuggestions} from '../../../assets/modules/github/jump-to'\n\ninterface Team {\n  name: string\n  path: string\n}\n\nexport class TeamsProvider extends EventTarget implements SearchProvider {\n  priority = 7\n  name = 'Teams'\n  singularItemName = 'team'\n  value = 'team'\n  type = 'search' as const\n  manuallyDetermineFilterEligibility = true\n\n  #suggestedTeams: Team[] | null = null\n  #input: HTMLElement\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n    this.#input = input\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    const hasFocus = this.queryBuilder.hasFocus()\n    if (!state || !hasFocus || state.caretPositionKind !== CaretPositionKind.Text) {\n      return []\n    }\n\n    let term = state.query\n    if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      } else {\n        term = ''\n      }\n    }\n\n    if (this.#suggestedTeams === null) {\n      this.#suggestedTeams = (await getSuggestions(this.#input))\n        .filter(r => r.type === 'Team')\n        .map(r => {\n          return {\n            name: r.name,\n            path: r.path,\n          }\n        })\n    }\n\n    let matches = this.#suggestedTeams.slice(0, 4)\n    if (term.length > 0) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (team: Team) => {\n        const score = fuzzyScore(team.name, fuzzyQuery)\n        return score > 0 ? {score, text: team.name} : null\n      }\n      matches = filterSort(this.#suggestedTeams, key, compare)\n    }\n\n    for (const suggestion of matches.slice(0, 5)) {\n      this.dispatchEvent(\n        new SearchItem({\n          value: suggestion.name,\n          icon: Octicon.Team,\n          priority: 0,\n          action: {\n            url: suggestion.path,\n          },\n        }),\n      )\n    }\n  }\n}\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport {\n  type QueryEvent,\n  FilterItem,\n  type FilterProvider,\n  Octicon,\n} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {CaretPositionKind, isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport {getSuggestions} from '../../../assets/modules/github/jump-to'\n\ninterface Project {\n  name: string\n  path: string\n}\n\nexport class ProjectsProvider extends EventTarget implements FilterProvider {\n  priority = 8\n  name = 'Projects'\n  singularItemName = 'project'\n  value = 'project'\n  type = 'filter' as const\n  manuallyDetermineFilterEligibility = true\n\n  #suggestedProjects: Project[] | null = null\n  #input: HTMLElement\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n    this.#input = input\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    const hasFocus = this.queryBuilder.hasFocus()\n    if (!state || !hasFocus || state.caretPositionKind !== CaretPositionKind.Text) {\n      return []\n    }\n\n    let term = state.query\n    if (state.caretSelectedNode && isQualifier(state.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      } else {\n        term = ''\n      }\n    }\n\n    if (this.#suggestedProjects === null) {\n      this.#suggestedProjects = (await getSuggestions(this.#input))\n        .filter(r => r.type === 'Project')\n        .map(r => {\n          return {\n            name: r.name,\n            path: r.path,\n          }\n        })\n    }\n\n    let matches = this.#suggestedProjects.slice(0, 4)\n    if (term.length > 0) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (p: Project) => {\n        const score = fuzzyScore(p.name, fuzzyQuery)\n        return score > 0 ? {score, text: p.name} : null\n      }\n      matches = filterSort(this.#suggestedProjects, key, compare)\n    }\n\n    for (const suggestion of matches.slice(0, 5)) {\n      this.dispatchEvent(\n        new FilterItem({\n          filter: 'project',\n          value: suggestion.name,\n          icon: Octicon.Project,\n          priority: 0,\n          action: {\n            url: suggestion.path,\n          },\n        }),\n      )\n    }\n  }\n}\n","import type {QueryEvent, SearchProvider} from '@github-ui/query-builder-element/query-builder-api'\nimport {Octicon, SearchItem, PrefixColor, FetchDataEvent} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {CaretPositionKind} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport {SymbolKind} from '@github-ui/code-nav'\n\ninterface BlackbirdSymbol {\n  fully_qualified_name: string\n  kind: string\n}\n\ninterface BlackbirdSuggestion {\n  kind: string\n  query: string\n  repository_nwo: string\n  language: string\n  path: string\n  repository_id: number\n  commit_sha: string\n  line_number: number\n  symbol: BlackbirdSymbol | null\n}\n\ntype SuggestionsResponse = {\n  suggestions: BlackbirdSuggestion[]\n  queryErrors: []\n  failed: boolean\n}\n\nexport class BlackbirdProvider extends EventTarget implements SearchProvider {\n  priority = 9\n  name = 'Code'\n  singularItemName = 'code'\n  value = 'code'\n  type = 'search' as const\n  manuallyDetermineFilterEligibility = true\n\n  #cache: Record<string, BlackbirdSuggestion[]> = {}\n  #input: HTMLElement\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n    this.#input = input\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const result = this.fetchData(event)\n    this.dispatchEvent(new FetchDataEvent(result))\n    const suggestions = (await result)!\n\n    let suggestionsEmitted = 0\n    for (const suggestion of suggestions) {\n      if (suggestionsEmitted >= 5) return\n\n      if (suggestion.kind === 'SUGGESTION_KIND_PATH') {\n        if (!suggestion.path) continue\n\n        const trailingSlashPos = suggestion.path.lastIndexOf('/')\n        const filename = suggestion.path.substring(trailingSlashPos + 1)\n        const path = truncatePath(suggestion.path.substring(0, trailingSlashPos + 1))\n\n        // TODO: omit this if the query is scoped to a repo already\n        const repoPrefix = suggestion.repository_nwo\n        const separator = repoPrefix.length > 0 && path.length > 0 ? '  ' : ''\n        const encodedPath = suggestion.path.split('/').map(encodeURIComponent).join('/')\n\n        this.dispatchEvent(\n          new SearchItem({\n            value: filename,\n            icon: Octicon.FileCode,\n            description: `${repoPrefix}${separator}${path}`,\n            priority: 0,\n            action: {\n              url: `/${suggestion.repository_nwo}/blob/${suggestion.commit_sha}/${encodedPath}#L${suggestion.line_number}`,\n            },\n          }),\n        )\n      } else if (suggestion.kind === 'SUGGESTION_KIND_SYMBOL') {\n        const path = truncatePath(suggestion.path)\n\n        // TODO: omit this if the query is scoped to a repo already\n        const repoPrefix = suggestion.repository_nwo\n        const separator = repoPrefix.length > 0 && path.length > 0 ? '  ' : ''\n        const encodedPath = suggestion.path.split('/').map(encodeURIComponent).join('/')\n        const kind = new SymbolKind({kind: suggestion.symbol?.kind ?? ''})\n\n        this.dispatchEvent(\n          new SearchItem({\n            value: suggestion.symbol?.fully_qualified_name ?? '',\n            prefixText: kind.fullName,\n            prefixColor: prefixColorForSymbolKind(kind),\n            icon: Octicon.FileCode,\n            description: `${repoPrefix}${separator}${path}`,\n            priority: 0,\n            action: {\n              url: `/${suggestion.repository_nwo}/blob/${suggestion.commit_sha}/${encodedPath}#L${suggestion.line_number}`,\n            },\n          }),\n        )\n      } else {\n        // Unsupported suggestion type, skip\n        continue\n      }\n      suggestionsEmitted++\n    }\n  }\n\n  async fetchData(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n\n    if (!state || !state.query) {\n      return []\n    }\n\n    if (state.caretPositionKind !== CaretPositionKind.Text && state.caretPositionKind !== CaretPositionKind.Path) {\n      return []\n    }\n\n    if (this.#cache[state.query]) {\n      return this.#cache[state.query]\n    }\n\n    if (this.#input.getAttribute('data-logged-in') === 'false') {\n      return []\n    }\n\n    const urlParams = new URLSearchParams({query: state.query, saved_searches: JSON.stringify(state.customScopes)})\n    const url = this.#input.getAttribute('data-blackbird-suggestions-path')\n    if (!url) throw new Error('could not get blackbird suggestions path')\n    const response = (await (\n      await fetch(`${url}?${urlParams}`, {\n        method: 'GET',\n        mode: 'same-origin',\n        headers: {\n          Accept: 'application/json',\n        },\n      })\n    ).json()) as SuggestionsResponse\n\n    if (response.failed) {\n      return []\n    }\n\n    // Store the cached response\n    this.#cache[state.query] = response.suggestions\n\n    return response.suggestions\n  }\n}\n\nfunction prefixColorForSymbolKind(kind: SymbolKind): PrefixColor {\n  switch (kind.plColor) {\n    case 'prettylights.syntax.entity':\n      return PrefixColor.Entity\n    case 'prettylights.syntax.constant':\n      return PrefixColor.Constant\n    case 'prettylights.syntax.keyword':\n      return PrefixColor.Keyword\n    case 'prettylights.syntax.variable':\n      return PrefixColor.Variable\n    case 'prettylights.syntax.string':\n      return PrefixColor.String\n    default:\n      return PrefixColor.Entity\n  }\n}\n\nfunction truncatePath(path: string) {\n  if (path.length > 60) {\n    return `...${path.substring(path.length - 60 + 3)}`\n  }\n\n  return path\n}\n","import type {QueryEvent, SearchProvider, SearchScopeText} from '@github-ui/query-builder-element/query-builder-api'\nimport {Octicon, SearchItem} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport type {QualifierNode, NodeWithChildren, ContentNode} from '@github/blackbird-parser'\nimport {CaretPositionKind, extractRepoOrgScopes, hasChildren, isQualifier} from '../parsing/common'\n// eslint-disable-next-line import/no-namespace\nimport type * as Parsing from '../parsing/parsing'\n\nexport class InputProvider extends EventTarget implements SearchProvider {\n  priority = 0\n  name = ''\n  singularItemName = 'search'\n  value = 'search'\n  type = 'search' as const\n  copilotChatEnabled: boolean = false\n  #input: HTMLElement\n  #parser: typeof Parsing | undefined\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: HTMLElement,\n  ) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n    this.#input = input\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n\n    if (event.rawQuery) {\n      // Always emit a fallback suggestion, if no other suggestions exist\n      this.dispatchEvent(\n        new SearchItem({\n          value: event.rawQuery,\n          scope: 'GITHUB',\n          icon: Octicon.Search,\n          priority: 0,\n          action: {\n            query: event.rawQuery,\n          },\n          isFallbackSuggestion: true,\n        }),\n      )\n    }\n\n    if (!state || state.caretPositionKind !== CaretPositionKind.Text) {\n      return []\n    }\n\n    let trimmedQuery = state.query.trim()\n\n    let repo = this.#input.getAttribute('data-current-repository')\n    let org = this.#input.getAttribute('data-current-org')\n    let orgNode: QualifierNode | undefined = undefined\n    let user = this.#input.getAttribute('data-current-owner')\n\n    if (!this.#parser) {\n      this.#parser = await import('../parsing/parsing')\n    }\n\n    // Use query to extract the current qualifier for suggestions\n    const astNode: NodeWithChildren = this.#parser.parseString(trimmedQuery || '') as NodeWithChildren\n\n    // No qualifiers found\n    if (astNode.children) {\n      const qualifierNodes = astNode.children.filter(node => node.kind === 'Qualifier')\n      repo = (qualifierNodes.find(node => node.qualifier === 'Repo')?.content as ContentNode)?.value?.toString() || repo\n      orgNode = qualifierNodes.find(node => node.qualifier === 'Org')\n      org = (orgNode?.content as ContentNode)?.value?.toString() || org\n      user =\n        (\n          qualifierNodes.find(node => node.qualifier === 'Org' && node.raw === 'user:')?.content as ContentNode\n        )?.value?.toString() || user\n      // Get owner from nwo\n      if (repo && !orgNode) {\n        org = repo.split('/')[0]!\n      }\n    }\n\n    interface Suggestion {\n      query: string\n      scope?: keyof typeof SearchScopeText\n    }\n    const suggestions: Suggestion[] = []\n    let containsScopes = false\n\n    if (state.ast) {\n      const node = state.ast\n\n      // check if node has query text attached to it (not just qualifier)\n      if (hasChildren(node)) {\n        trimmedQuery = node.children\n          .filter(item => item.kind === 'Text')\n          .map(item => item.value)\n          .join(' ')\n\n        const scopes = extractRepoOrgScopes(node)\n        // If the scopes contains a saved scope, don't generate input suggestions,\n        // since we can't generate sensible parent scopes.\n        if (scopes.find(s => s.kind === 'saved')) {\n          return []\n        }\n\n        // If text has a repo or org qualifier within it, show just query text at the bottom of input\n        if (scopes.length) {\n          containsScopes = true\n        }\n      } else if (isQualifier(node)) {\n        // if node is only a qualifier, don't include it as part of query text\n        trimmedQuery = ''\n      }\n\n      if (repo && repo.length > 0) {\n        suggestions.push({\n          query: `repo:${repo} ${trimmedQuery}`,\n          scope: 'REPO',\n        })\n      }\n      if (orgNode) {\n        suggestions.push({\n          query: `${orgNode.raw}${org} ${trimmedQuery}`,\n          scope: 'ORG',\n        })\n      } else {\n        if (org && org.length > 0) {\n          suggestions.push({\n            query: `org:${org} ${trimmedQuery}`,\n            scope: 'ORG',\n          })\n        }\n        if (user && user.length > 0) {\n          suggestions.push({\n            query: `user:${user} ${trimmedQuery}`,\n            scope: 'OWNER',\n          })\n        }\n      }\n    }\n\n    if (trimmedQuery.length > 0) {\n      !containsScopes\n        ? suggestions.unshift({\n            query: trimmedQuery,\n            scope: 'GITHUB',\n          })\n        : suggestions.push({query: trimmedQuery, scope: 'GITHUB'})\n    }\n\n    // If we are currently on a non-root tree view page, offer to search within\n    // the current directory.\n    const path = getPathQualifier(window.location.pathname)\n    if (path) {\n      const query = `repo:${repo} path:${path} ${trimmedQuery}`\n      this.dispatchEvent(\n        new SearchItem({\n          value: query,\n          scope: 'DIRECTORY',\n          icon: Octicon.Search,\n          priority: 0,\n          action: {\n            commandName: 'blackbird-monolith.search',\n            data: {\n              query,\n            },\n          },\n        }),\n      )\n    }\n\n    for (const suggestion of suggestions.slice(0, 3)) {\n      this.dispatchEvent(\n        new SearchItem({\n          value: suggestion.query,\n          scope: suggestion.scope,\n          icon: Octicon.Search,\n          priority: 0,\n          action: {\n            commandName: 'blackbird-monolith.search',\n            data: {\n              query: suggestion.query,\n            },\n          },\n        }),\n      )\n    }\n  }\n\n  getQualifierType(input: string): string {\n    if (input.includes('repo')) {\n      // eslint-disable-next-line i18n-text/no-en\n      return 'In this repository'\n    } else if (input.includes('org')) {\n      // eslint-disable-next-line i18n-text/no-en\n      return 'In this organization'\n    } else if (input.includes('user')) {\n      // eslint-disable-next-line i18n-text/no-en\n      return 'In this user'\n    } else if (input.includes('owner')) {\n      // eslint-disable-next-line i18n-text/no-en\n      return 'In this owner'\n    } else {\n      // eslint-disable-next-line i18n-text/no-en\n      return 'All of GitHub'\n    }\n  }\n}\n\nfunction buildRegexQuery(path: string): string {\n  // Decode any URL characters\n  path = decodeURIComponent(path)\n\n  // Strip trailing slash\n  if (path.endsWith('/')) {\n    path = path.substring(0, path.length - 1)\n  }\n\n  // Escape regex chars\n  const escaped = path.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\n\n  // Build path regex query\n  return `/^${escaped.replaceAll('/', '\\\\/')}\\\\//`\n}\n\nexport function getPathQualifier(pathname: string): string | undefined {\n  const treeRegex = /^\\/[^/]+\\/[^/]+\\/tree\\/[^/]+\\/(.*)/\n\n  const m = treeRegex.exec(pathname)\n  if (m) {\n    for (let i = 1; i < m.length; i++) {\n      if (m[i]) {\n        return buildRegexQuery(m[i]!)\n      }\n    }\n  }\n\n  return undefined\n}\n","// Temporary file to hold the ExplorePage type and the initial and full list of ExplorePages.\n// The list is hardcoded for now as we experiment with the Explore search provider.\n\nexport interface ExplorePage {\n  title: string\n  url: string\n  octicon: string\n}\n\n// Initial suggestions are: Enterprise, Security, Copilot, and Pricing - before the user types anything.\nexport const InitialExplorePages: ExplorePage[] = [\n  {title: 'Enterprise', url: '/enterprise', octicon: 'organization'},\n  {title: 'Security', url: '/security', octicon: 'shield-check'},\n  {title: 'Copilot', url: '/features/copilot', octicon: 'copilot'},\n  {title: 'Pricing', url: '/pricing', octicon: 'credit-card'},\n]\n\nexport const ExplorePages: ExplorePage[] = [\n  {title: 'GitHub Actions', url: '/features/actions', octicon: 'workflow'},\n  {title: 'Blog', url: 'https://github.blog', octicon: 'book'},\n  {title: 'CI/CD', url: '/solutions/ci-cd/', octicon: 'workflow'},\n  {title: 'Code review', url: '/features/code-review', octicon: 'code-review'},\n  {title: 'Codespaces', url: '/features/codespaces', octicon: 'codespaces'},\n  {title: 'Copilot', url: '/features/copilot', octicon: 'copilot'},\n  {title: 'Customer stories', url: '/customer-stories', octicon: 'comment'},\n  {title: 'Discussions', url: '/features/discussions', octicon: 'comment-discussion'},\n  {title: 'Documentation', url: 'https://docs.github.com', octicon: 'book'},\n  {title: 'Enterprise', url: '/enterprise', octicon: 'organization'},\n  {title: 'Features', url: '/features', octicon: 'rocket'},\n  {title: 'GitHub Security', url: '/security', octicon: 'shield-check'},\n  {title: 'GitHub Sponsors', url: '/sponsors', octicon: 'heart'},\n  {title: 'GitHub Pages', url: 'https://pages.github.com', octicon: 'server'},\n  {title: 'Integrations', url: '/features/integrations', octicon: 'globe'},\n  {title: 'Issues', url: '/features/issues', octicon: 'issue-opened'},\n  {title: 'GitHub Mobile', url: '/mobile', octicon: 'device-mobile'},\n  {title: 'GitHub Packages', url: '/features/packages', octicon: 'package'},\n  {title: 'Pricing', url: '/pricing', octicon: 'credit-card'},\n  {title: 'Resources', url: 'https://resources.github.com', octicon: 'book'},\n  {title: 'Secure your code', url: '/features/security/code-scanning', octicon: 'shield-check'},\n  {title: 'Security features', url: '/features/security', octicon: 'shield-check'},\n  {title: 'Software supply chain', url: '/features/security/software-supply-chain', octicon: 'shield-check'},\n  {title: 'Startups', url: '/enterprise/startups', octicon: 'rocket'},\n  {title: 'Team', url: '/team', octicon: 'organization'},\n  {title: 'The ReadME Project', url: '/readme', octicon: 'book'},\n  {title: 'The ReadME Podcast', url: '/readme/podcast', octicon: 'play'},\n  {title: 'Feature Previews', url: '/features/preview', octicon: 'gift'},\n  {title: 'Code Search', url: '/features/code-search', octicon: 'code-square'},\n  {title: 'GitHub Changelog', url: 'https://github.blog/changelog', octicon: 'book'},\n  {title: 'GitHub Shop', url: 'https://www.thegithubshop.com/', octicon: 'gift'},\n  {title: 'GitHub Desktop', url: 'https://desktop.github.com', octicon: 'device-desktop'},\n]\n","import {filterSort} from '@github-ui/filter-sort'\nimport {compare, fuzzyScore} from '@github-ui/fuzzy-filter'\nimport type {QueryEvent, SearchProvider, Octicon} from '@github-ui/query-builder-element/query-builder-api'\nimport {FetchDataEvent, SearchItem} from '@github-ui/query-builder-element/query-builder-api'\nimport type {QueryBuilderElement} from '@github-ui/query-builder-element'\nimport {isContentNode, isQualifier} from '../parsing/common'\nimport type {ParsedIntermediateRepresentation} from '../qbsearch-input-element'\nimport {ExplorePages, InitialExplorePages} from '../suggestions/explore-pages'\n\ninterface ExplorePage {\n  title: string\n  url: string\n  octicon: Octicon | string\n}\n\nconst resultsPriority = 11 // The priority of the explore search provider, higher numbers appear at the bottom of the results\n\nexport class ExploreProvider extends EventTarget implements SearchProvider {\n  priority = resultsPriority\n  name = 'Explore'\n  singularItemName = 'explore page'\n  value = 'explore'\n  type = 'search' as const\n  manuallyDetermineFilterEligibility = true\n\n  #querySuggestions: ExplorePage[] | null = null\n  #defaultSuggestions: ExplorePage[] | null = null\n\n  constructor(public queryBuilder: QueryBuilderElement) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n  }\n\n  // For experimental / testing, we will get the explore pages from a hardcoded list from now.\n  #fetchQuerySuggestions() {\n    const data = Promise.resolve(ExplorePages)\n    this.dispatchEvent(new FetchDataEvent(data))\n    return data\n  }\n\n  #fetchDefaultSuggestions() {\n    const data = Promise.resolve(InitialExplorePages)\n    this.dispatchEvent(new FetchDataEvent(data))\n    return data\n  }\n\n  async #addDefaultSuggestions() {\n    this.#defaultSuggestions = await this.#fetchDefaultSuggestions()\n    for (const page of this.#defaultSuggestions) {\n      this.dispatchEvent(\n        new SearchItem({\n          value: page.title,\n          icon: page.octicon as Octicon,\n          priority: resultsPriority,\n          scope: 'EXPLORE',\n          action: {\n            url: `${page.url}?ref_loc=search`,\n          },\n        }),\n      )\n    }\n  }\n\n  async handleEvent(event: QueryEvent) {\n    const path = window.location.pathname\n    const isHomePagePath = path === '/' || path === '/home'\n    const isMarketingPagePath = ExplorePages.some(page => page.url.startsWith('/') && path.startsWith(page.url))\n\n    if (!isHomePagePath && !isMarketingPagePath) {\n      // We only want to show suggestions on the homepage and marketing pages\n      return []\n    }\n\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    if (!state?.query) {\n      await this.#addDefaultSuggestions()\n      return []\n    }\n\n    if (this.#querySuggestions === null) {\n      this.#querySuggestions = await this.#fetchQuerySuggestions()\n    }\n\n    // make sure we only suggest for terms that are user typed content (number, text etc.)\n    let term = state?.query\n    if (state?.caretSelectedNode && isQualifier(state?.caretSelectedNode)) {\n      if (isContentNode(state.caretSelectedNode.content)) {\n        term = state.caretSelectedNode.content.value as string\n      } else {\n        term = ''\n      }\n    }\n\n    let matches = this.#querySuggestions\n    if (term && term.length > 0) {\n      const fuzzyQuery = term.replace(/\\s/g, '')\n      const key = (page: ExplorePage) => {\n        const score = fuzzyScore(page.title, fuzzyQuery)\n        return score > 0 ? {score, text: page.title} : null\n      }\n      matches = filterSort(this.#querySuggestions, key, compare)\n    }\n\n    for (const page of matches.slice(0, 5)) {\n      this.dispatchEvent(\n        new SearchItem({\n          value: page.title,\n          icon: page.octicon as Octicon,\n          priority: resultsPriority,\n          scope: 'EXPLORE',\n          action: {\n            url: `${page.url}?q=${term}&ref_loc=search`,\n          },\n        }),\n      )\n    }\n  }\n}\n","import {\n  Octicon,\n  SearchItem,\n  type QueryBuilderElement,\n  type QueryEvent,\n  type SearchProvider,\n} from '@github-ui/query-builder-element'\nimport type {ParsedIntermediateRepresentation, QbsearchInputElement} from '../qbsearch-input-element'\nimport type {SafeHTMLString} from '@github-ui/safe-html'\nimport {debounce} from '@github/mini-throttle'\nimport {verifiedFetchJSON} from '@github-ui/verified-fetch'\nimport {CopilotAuthTokenProvider} from '@github-ui/copilot-auth-token'\nimport {CaretPositionKind} from '../parsing/common'\n\nconst DEFAULT_NL_SEARCH_QUERY = 'is:issue is:open assignee:@me'\n\nexport class CopilotProvider extends EventTarget implements SearchProvider {\n  priority = 10\n  name = 'Copilot'\n  singularItemName = 'copilot'\n  value = 'copilot'\n  type = 'search' as const\n  #copilotChatEnabled: boolean = false\n  #naturalLanugageSearchEnabled: boolean = false\n  #input: QbsearchInputElement\n  #repo: string | null\n  #nlSearchToken: string | null\n  #abortController: AbortController = new AbortController()\n  #copilotAuthTokenProvider: CopilotAuthTokenProvider\n\n  constructor(\n    public queryBuilder: QueryBuilderElement,\n    input: QbsearchInputElement,\n  ) {\n    super()\n    this.queryBuilder.addEventListener('query', this)\n    this.#input = input\n    this.#repo = this.#input.getAttribute('data-current-repository')\n    this.#copilotChatEnabled = this.#input.getAttribute('data-copilot-chat-enabled') === 'true'\n    this.#naturalLanugageSearchEnabled = this.#input.getAttribute('data-nl-search-enabled') === 'true'\n    this.#nlSearchToken = this.#input.getAttribute('data-nl-search-csrf')\n    this.#copilotAuthTokenProvider = new CopilotAuthTokenProvider([])\n  }\n\n  fetchIndexStatusPromise(repo: string, token: string) {\n    const fetchUrl = new URL(`/search/check_indexing_status?nwo=${encodeURIComponent(repo)}`, window.location.origin)\n    const indexedResponse = fetch(fetchUrl.href, {\n      method: 'GET',\n      mode: 'same-origin',\n      headers: {\n        Accept: 'application/json',\n        'Scoped-CSRF-Token': token,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    })\n\n    return indexedResponse\n  }\n\n  primerSpinner() {\n    return {\n      // eslint-disable-next-line github/unescaped-html-literal\n      html: `<svg style=\"box-sizing: content-box; color: var(--color-icon-primary); fill: none\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" class=\"anim-rotate\">\n  <circle cx=\"8\" cy=\"8\" r=\"7\" stroke=\"currentColor\" stroke-opacity=\"0.25\" stroke-width=\"2\" vector-effect=\"non-scaling-stroke\" fill=\"none\"></circle>\n  <path d=\"M15 8a7.002 7.002 0 00-7-7\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" vector-effect=\"non-scaling-stroke\"></path>\n</svg>` as SafeHTMLString,\n    }\n  }\n\n  async handleEvent(event: QueryEvent) {\n    if (!this.#copilotChatEnabled) return\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    if (!state || state.caretPositionKind !== CaretPositionKind.Text) return\n\n    const trimmedQuery = state?.query.trim() ?? ''\n\n    this.dispatchEvent(\n      new SearchItem({\n        value: `Ask Copilot`,\n        scope: 'COPILOT_CHAT',\n        icon: Octicon.Copilot,\n        priority: 0,\n        action: {\n          commandName: 'search-copilot-chat',\n          data: {\n            content: trimmedQuery,\n            repoNwo: this.#repo,\n          },\n        },\n      }),\n    )\n\n    if (!this.#naturalLanugageSearchEnabled) return\n    if (!trimmedQuery) {\n      this.dispatchEvent(\n        new SearchItem({\n          id: 'copilot-nl-search',\n          value: DEFAULT_NL_SEARCH_QUERY,\n          scope: 'COPILOT_SEARCH',\n          icon: Octicon.Copilot,\n          priority: 0,\n          action: {\n            commandName: 'convert-to-query-syntax',\n            data: {\n              content: DEFAULT_NL_SEARCH_QUERY,\n            },\n          },\n        }),\n      )\n    } else {\n      this.dispatchEvent(\n        new SearchItem({\n          id: 'copilot-nl-search',\n          value: trimmedQuery,\n          scope: 'COPILOT_SEARCH',\n          icon: trimmedQuery === DEFAULT_NL_SEARCH_QUERY ? Octicon.Copilot : this.primerSpinner(),\n          priority: 0,\n          action: {\n            commandName: 'no-op',\n            data: {},\n          },\n        }),\n      )\n    }\n    this.queryCopilotSearchDebounced(event)\n  }\n\n  queryCopilotSearch = async (event: QueryEvent) => {\n    const state = event.parsedMetadata as ParsedIntermediateRepresentation | undefined\n    const trimmedQuery = state?.query.trim() ?? ''\n\n    if (!this.#nlSearchToken || !trimmedQuery || trimmedQuery === DEFAULT_NL_SEARCH_QUERY) return\n\n    try {\n      const token = await this.#copilotAuthTokenProvider.getAuthToken()\n      this.#abortController.abort()\n      this.#abortController = new AbortController()\n\n      const response = await verifiedFetchJSON('/copilot/completions/nl-search', {\n        method: 'POST',\n        body: {query: trimmedQuery},\n        headers: {\n          'Scoped-CSRF-Token': this.#nlSearchToken,\n          'X-Copilot-Api-Token': token.value,\n        },\n        signal: this.#abortController.signal,\n      })\n\n      if (!response.ok) {\n        return this.dispatchEvent(\n          new SearchItem({\n            isUpdate: true,\n            id: 'copilot-nl-search',\n            value: 'There was an error parsing your query',\n            scope: 'COPILOT_SEARCH',\n            icon: Octicon.CopilotError,\n            priority: 0,\n            action: {\n              commandName: 'no-op',\n              data: {},\n            },\n          }),\n        )\n      }\n\n      const result: {query: string} = await response.json()\n      if (trimmedQuery.length > 0 && this.#naturalLanugageSearchEnabled) {\n        this.dispatchEvent(\n          new SearchItem({\n            isUpdate: true,\n            id: 'copilot-nl-search',\n            value: result.query || trimmedQuery,\n            scope: 'COPILOT_SEARCH',\n            icon: Octicon.Copilot,\n            priority: 0,\n            action: {\n              commandName: 'convert-to-query-syntax',\n              data: {\n                content: result.query || trimmedQuery,\n              },\n            },\n          }),\n        )\n      }\n    } catch (e) {\n      if (e instanceof Error && e.name === 'AbortError') return\n      this.dispatchEvent(\n        new SearchItem({\n          isUpdate: true,\n          id: 'copilot-nl-search',\n          value: 'There was an error parsing your query',\n          scope: 'COPILOT_SEARCH',\n          icon: Octicon.CopilotError,\n          priority: 0,\n          action: {\n            commandName: 'no-op',\n            data: {},\n          },\n        }),\n      )\n      return\n    }\n  }\n  readonly queryCopilotSearchDebounced = debounce(this.queryCopilotSearch, 1000)\n}\n","import '@github/details-menu-element'\nimport {attr, controller, target} from '@github/catalyst'\nimport {CaretPositionKind, shouldRedirectInsteadOfSearch} from './parsing/common'\n// `import type` so that we don't bring the parser code in on every page load\nimport type {BaseNode, FinalNode, NothingNode} from '@github/blackbird-parser'\nimport type {SuggestionInputState, CustomScope} from './suggestions/types'\nimport {logPageView} from '../../assets/modules/github/jump-to/page-views'\nimport type {ModalDialogElement} from '@primer/view-components/app/components/primer/alpha/modal_dialog'\nimport {sendEvent} from '@github-ui/hydro-analytics'\nimport {softNavigate} from '@github-ui/soft-navigate'\nimport {getBlackbirdExperiments} from './experiments'\nimport type {QueryBuilderElement, Provider} from '@github-ui/query-builder-element'\nimport {parseFileAnchor} from '../../assets/modules/github/blob-anchor'\nimport {\n  type QueryElement,\n  type QueryTextElement,\n  type Parser,\n  TextElementStyle,\n} from '@github-ui/query-builder-element/query-builder-api'\n\nimport {HistoryProvider} from './providers/history'\nimport {LanguagesProvider} from './providers/languages'\nimport {ReposFilterProvider, ReposSearchProvider} from './providers/repos'\nimport {SavedScopeProvider} from './providers/saved'\nimport {OwnersProvider} from './providers/owners'\nimport {FixedValuesProvider} from './providers/fixed'\nimport {TeamsProvider} from './providers/teams'\nimport {ProjectsProvider} from './providers/projects'\nimport {BlackbirdProvider} from './providers/blackbird'\nimport {InputProvider} from './providers/input'\nimport {isFeatureEnabled} from '@github-ui/feature-flags'\nimport type {CustomScopesElement} from './custom-scopes-element'\n// eslint-disable-next-line import/no-namespace\nimport type * as Parsing from './parsing/parsing'\nimport {ExploreProvider} from './providers/explore'\nimport {CopilotProvider} from './providers/copilot'\n/** minimum number of milliseconds between parsing input */\nconst parseDelay = 15\nconst nonBreakingSpace = String.fromCharCode(160)\n\nconst MAX_LOCAL_HISTORY = 50\n\n// eslint-disable-next-line i18n-text/no-en\nconst PLACEHOLDER_SAFE_HTML = 'Type <kbd class=\"AppHeader-search-kbd\">/</kbd> to search'\n\nconst marketing_pages_search_explore_provider_enabled = isFeatureEnabled('marketing_pages_search_explore_provider')\n\nexport interface ParsedIntermediateRepresentation {\n  ast?: FinalNode\n  query: string\n  caretPositionKind?: CaretPositionKind\n  caretSelectedNode?: BaseNode\n  customScopes?: CustomScope[]\n}\n\n@controller\nexport class QbsearchInputElement extends HTMLElement {\n  @target inputButton: HTMLButtonElement\n  @target inputButtonText: HTMLSpanElement\n  @target queryBuilder: QueryBuilderElement\n  @target queryBuilderContainer: HTMLDivElement\n\n  @target clearInputButton: HTMLButtonElement\n  @target clearInputButtonSeparator: HTMLDivElement\n\n  @target searchSuggestionsDialog: ModalDialogElement\n  @target suggestionHeadingTemplate: HTMLTemplateElement\n  @target suggestionTemplate: HTMLTemplateElement\n  @target darkBackdrop: HTMLDivElement\n\n  @target customScopesManager: CustomScopesElement\n\n  @target feedbackDialog: ModalDialogElement\n\n  @attr headerRedesignEnabled = false\n\n  #isReactContext: boolean\n  #eventAbortController: AbortController | undefined\n  #cachesHaveBeenWarmed = false\n  #globalNavAlwaysHidden = false\n  private lastParsedQuery: string | null\n  private ast: FinalNode | undefined\n  #caretPositionKind: CaretPositionKind = CaretPositionKind.Text\n  #caretSelectedNode: BaseNode | undefined\n  // the parsing module is loaded asynchronously\n  private parsing: typeof Parsing | undefined\n  private parsingPromise: Promise<typeof Parsing> | undefined\n  #customScopesSuggestionProvider: SavedScopeProvider\n  #dialogFocusReturn: HTMLElement | undefined\n  #returnFocusElement: HTMLElement | null = null\n  #customScopesUrlPath: string\n  #customScopeManagerInitialized = false\n\n  parser: Parser<ParsedIntermediateRepresentation> = {\n    parse: (query: string, caretPosition: number | undefined) => {\n      if (!this.parsing) {\n        // if there is no query, we don't need to load the parser and parse\n        // but if we are expanded we should go ahead and get it ready\n        if (query || this.classList.contains('expanded')) {\n          ;(async () => {\n            await this.loadParser()\n            // Trigger re-parse when parser is available\n            this.queryBuilder.parseQuery()\n          })()\n        }\n        return {\n          query,\n        }\n      }\n      const [ast] = this.parsing.parseSearchInput(query)\n      const customScopes = this.#findCustomScopesNeededForSearch(ast)\n\n      // If a caret position is specified, calculate caret position metadata\n      let caretPositionKind = undefined\n      let caretSelectedNode = undefined\n      if (caretPosition !== undefined) {\n        const caretData = this.parsing.getCaretPositionKindFromIndex(ast, caretPosition)\n        caretPositionKind = caretData.kind\n        caretSelectedNode = caretData.node\n      }\n\n      return {\n        ast,\n        query,\n        caretPositionKind,\n        caretSelectedNode,\n        customScopes,\n      }\n    },\n    flatten: this.flattenASTForQueryBuilder.bind(this),\n  }\n\n  get placeholderText() {\n    if (!this.copilotChatEnabled()) return PLACEHOLDER_SAFE_HTML\n\n    return `${PLACEHOLDER_SAFE_HTML} or ask Copilot`\n  }\n\n  get query() {\n    return this.queryBuilder.input?.value || ''\n  }\n\n  set query(v: string) {\n    // input can be undefined if the query builder has not been upgraded.\n    // it's ok to ignore this because we will update query in the whenDefined handler\n    if (this.queryBuilder.input) {\n      this.queryBuilder.input.value = v\n      this.queryBuilder.parseQuery()\n      this.setButtonText(v)\n      ;(async () => {\n        await this.parseSearchInputRaw()\n        this.syncRichButtonText()\n      })()\n    }\n  }\n\n  flattenASTForQueryBuilder(ir: ParsedIntermediateRepresentation): QueryElement[] {\n    const highlights = this.parsing?.getHighlights(ir.ast as BaseNode) || []\n    highlights.sort((a, b) => a.location.start - b.location.start)\n    let pos = 0\n    const output: QueryTextElement[] = []\n    for (const highlight of highlights) {\n      if (highlight.location.start > pos) {\n        output.push({\n          type: 'text',\n          value: ir.query.substring(pos, highlight.location.start),\n        })\n      }\n\n      if (pos > highlight.location.start) {\n        continue\n      }\n\n      let style = TextElementStyle.Normal\n      if (highlight.className === 'pl-en') {\n        style = TextElementStyle.Entity\n      } else if (highlight.className === 'pl-c1') {\n        style = TextElementStyle.Constant\n      } else if (highlight.className === 'input-parsed-symbol') {\n        style = TextElementStyle.FilterValue\n      }\n\n      output.push({\n        type: 'text',\n        value: ir.query.substring(highlight.location.start, highlight.location.end),\n        style,\n      })\n\n      pos = highlight.location.end\n    }\n\n    if (pos < ir.query.length) {\n      output.push({\n        type: 'text',\n        value: ir.query.substring(pos),\n      })\n    }\n\n    return output\n  }\n\n  isRetainScrollPosition(): boolean {\n    return this.getAttribute('data-retain-scroll-position') === 'true'\n  }\n\n  isLoggedIn(): boolean {\n    return this.getAttribute('data-logged-in') === 'true'\n  }\n\n  copilotChatEnabled(): boolean {\n    return this.getAttribute('data-copilot-chat-enabled') === 'true'\n  }\n\n  connectedCallback(): void {\n    this.#isReactContext = false\n    if (this.isLoggedIn()) {\n      this.#customScopesUrlPath = this.getAttribute('data-custom-scopes-path') || ''\n      this.#customScopesSuggestionProvider = new SavedScopeProvider(this.queryBuilder, this.#customScopesUrlPath)\n      // Initialize custom scopes manager when it is loaded\n      ;(async () => {\n        await window.customElements.whenDefined('custom-scopes')\n        this.customScopesManager.initialize(\n          this.#customScopesSuggestionProvider.customScopesCache,\n          () => {\n            return this.#customScopesSuggestionProvider.fetchSuggestions()\n          },\n          this.#customScopesUrlPath,\n          this.getAttribute('data-delete-custom-scopes-csrf') || '',\n        )\n\n        this.#customScopeManagerInitialized = true\n      })()\n    }\n    // listen for react startup\n    const {signal} = (this.#eventAbortController = new AbortController())\n    window.addEventListener(\n      'blackbird_monolith_react_connected',\n      () => {\n        this.#isReactContext = true\n      },\n      {signal},\n    )\n\n    // Listen for when react disconnects. This can happen e.g. during a Turbo page navigation,\n    // where React is lost, but the search input isn't refreshed!\n    window.addEventListener(\n      'blackbird_monolith_react_disconnected',\n      () => {\n        this.#isReactContext = false\n      },\n      {signal},\n    )\n\n    window.addEventListener(\n      'blackbird_provide_feedback',\n      () => {\n        if (this.feedbackDialog instanceof HTMLDialogElement) {\n          this.feedbackDialog.showModal()\n        } else {\n          this.feedbackDialog.show()\n        }\n      },\n      {signal},\n    )\n\n    window.addEventListener(\n      'blackbird_monolith_set_global_nav_visibility',\n      event => {\n        const globalNavVisibility = (event as CustomEvent).detail\n        this.setGlobalNavVisibility(globalNavVisibility)\n        this.setGlobalBarAlwaysExpanded(!globalNavVisibility)\n\n        this.#globalNavAlwaysHidden = !globalNavVisibility\n\n        if (this.#globalNavAlwaysHidden) {\n          this.classList.add('flex-1')\n        } else {\n          this.classList.remove('flex-1')\n        }\n\n        this.setButtonText(this.query)\n      },\n      {signal},\n    )\n\n    // In case react loaded before we did, emit request to re-transmit react startup\n    window.dispatchEvent(new CustomEvent('blackbird_monolith_retransmit_react'))\n\n    window.addEventListener(\n      'blackbird_monolith_update_input',\n      event => {\n        this.query = (event as CustomEvent).detail\n      },\n      {signal},\n    )\n\n    window.addEventListener(\n      'blackbird_monolith_append_and_focus_input',\n      async event => {\n        const {\n          appendQuery,\n          retainScrollPosition,\n          returnTarget,\n        }: {appendQuery?: string; retainScrollPosition?: boolean; returnTarget?: HTMLElement} = (event as CustomEvent)\n          .detail\n\n        if (returnTarget && retainScrollPosition) {\n          this.expandAndRetainScrollPosition(returnTarget)\n        } else {\n          await this.expand(this.isRetainScrollPosition())\n          if (returnTarget) {\n            this.#returnFocusElement = returnTarget\n          }\n        }\n\n        if (appendQuery && !this.query.trim().endsWith(appendQuery)) {\n          this.query += ` ${appendQuery}`\n        }\n        if (!this.parsing) {\n          await this.loadParser()\n        }\n        this.moveCaretToEndOfInput()\n        await this.parseSearchInputRaw()\n      },\n      {signal},\n    )\n\n    window.addEventListener(\n      'blackbird_monolith_save_query_as_custom_scope',\n      event => {\n        this.saveQueryAsCustomScope(event as CustomEvent<HTMLElement>)\n      },\n      {signal},\n    )\n    ;(async () => {\n      await window.customElements.whenDefined('query-builder')\n\n      const loggedInProviders: Provider[] = [\n        new HistoryProvider(this.queryBuilder),\n        new SavedScopeProvider(this.queryBuilder, this.#customScopesUrlPath),\n        new BlackbirdProvider(this.queryBuilder, this),\n        new CopilotProvider(this.queryBuilder, this),\n      ]\n\n      const loggedOutProviders: Provider[] = marketing_pages_search_explore_provider_enabled\n        ? [new ExploreProvider(this.queryBuilder)]\n        : []\n\n      const providers: Provider[] = [\n        new LanguagesProvider(this.queryBuilder),\n        new ReposFilterProvider(this.queryBuilder, this),\n        new ReposSearchProvider(this.queryBuilder, this),\n        new OwnersProvider(this.queryBuilder, this),\n        new FixedValuesProvider(this.queryBuilder),\n        new TeamsProvider(this.queryBuilder, this),\n        new ProjectsProvider(this.queryBuilder, this),\n        new InputProvider(this.queryBuilder, this),\n      ]\n\n      if (this.isLoggedIn()) {\n        providers.push(...loggedInProviders)\n      } else {\n        providers.push(...loggedOutProviders)\n      }\n\n      this.queryBuilder.initialize(this.parser, providers)\n      // Sync the initial state with querybuilder\n      this.query = this.getAttribute('data-initial-value') || ''\n    })()\n\n    this.queryBuilder.parentElement?.addEventListener('submit', (event: Event) => {\n      this.search(this.queryBuilder.query)\n      this.retract()\n      this.queryBuilder.inputSubmit()\n      event.preventDefault()\n    })\n\n    this.queryBuilder.addEventListener('blackbird-monolith.manageCustomScopes', e => {\n      if (this.#customScopeManagerInitialized) {\n        this.#openManageCustomScopesDialog(e)\n      }\n    })\n\n    this.queryBuilder.addEventListener('query-builder:navigate', e => {\n      // If the navigation is a hash navigation, emit the scrollLineIntoView event\n      const href = (e as CustomEvent).detail?.url\n      if (href) {\n        const url = new URL(href, window.location.origin)\n        if (url.origin === window.location.origin && url.pathname === window.location.pathname) {\n          const anchInfo = parseFileAnchor(url.hash)\n          if (anchInfo.blobRange?.start?.line) {\n            window.dispatchEvent(\n              new CustomEvent('react_blob_view_scroll_line_into_view', {\n                detail: {line: anchInfo.blobRange.start.line},\n              }),\n            )\n          }\n        }\n      }\n      this.retract()\n    })\n\n    this.queryBuilder.addEventListener('blackbird-monolith.search', e => {\n      this.search((e as CustomEvent).detail?.query ?? '')\n    })\n\n    this.queryBuilder.addEventListener('search-copilot-chat', e => {\n      window.dispatchEvent(\n        new SearchCopilotEvent((e as CustomEvent).detail?.content, (e as CustomEvent).detail?.repoNwo),\n      )\n      this.retract()\n    })\n\n    this.queryBuilder.addEventListener('convert-to-query-syntax', async e => {\n      sendEvent('copilot_natural_language_github_search')\n\n      this.search((e as CustomEvent).detail.content)\n      this.retract()\n    })\n\n    // add current page to recently visited list for jump-to\n    logPageView(window.location.pathname)\n  }\n\n  syncRichButtonText() {\n    if (!this.#globalNavAlwaysHidden) {\n      return\n    }\n\n    if (this.query === '') {\n      const placeholder = this.inputButton.getAttribute('placeholder')\n      placeholder\n        ? (this.inputButtonText.textContent = this.inputButton.getAttribute('placeholder'))\n        : (this.inputButtonText.innerHTML = this.placeholderText)\n      this.inputButton.classList.add('placeholder')\n    } else {\n      // TODO: get styled content from query builder\n      const flat = this.parser.flatten(this.parser.parse(this.query, undefined))\n\n      const segments = []\n      for (const el of flat) {\n        const span = document.createElement('span')\n        span.textContent = el.value\n        if (el.style === TextElementStyle.FilterValue) {\n          span.classList.add('input-parsed-symbol')\n        } else if (el.style === TextElementStyle.Constant) {\n          span.classList.add('pl-c1')\n        } else if (el.style === TextElementStyle.Entity) {\n          span.classList.add('pl-en')\n        }\n\n        segments.push(span)\n      }\n\n      this.inputButtonText.replaceChildren(...segments)\n    }\n  }\n\n  setButtonText(newText: string) {\n    // Only overwrite the button text if we're on a page with a wide search bar.\n    if (!this.#globalNavAlwaysHidden || newText.trim() === '') {\n      const placeholder = this.inputButton.getAttribute('placeholder')\n      if (placeholder) {\n        this.inputButtonText.textContent = this.inputButton.getAttribute('placeholder')\n      } else if (this.inputButtonText.innerHTML.trim() !== this.placeholderText) {\n        this.inputButtonText.innerHTML = this.placeholderText\n      }\n      this.inputButton.classList.add('placeholder')\n    } else {\n      this.inputButtonText.textContent = newText\n      this.inputButton.classList.remove('placeholder')\n    }\n  }\n\n  async moveCaretToEndOfInput() {\n    await window.customElements.whenDefined('query-builder')\n    this.queryBuilder.moveCaretToEndOfInput()\n  }\n\n  disconnectedCallback() {\n    this.#eventAbortController?.abort()\n  }\n\n  // todo: remove?\n  getSuggestionInputState(): SuggestionInputState {\n    let customScopes: CustomScope[] = []\n    if (this.ast) {\n      customScopes = this.#findCustomScopesNeededForSearch(this.ast)\n    }\n    return {\n      query: this.query.replaceAll(nonBreakingSpace, ' '),\n      ast: this.ast,\n      selectedNode: this.#caretSelectedNode,\n      mode: this.#caretPositionKind,\n      customScopes,\n      type: this.ast ? this.chooseSearchType(this.ast) : ('' as Parsing.SearchType),\n    }\n  }\n\n  setGlobalNavVisibility(visible: boolean) {\n    const globalNav = document.querySelector('#global-nav') as HTMLElement\n    const mediaQuery = window.matchMedia('(min-width: 768px)')\n    if (globalNav && mediaQuery.matches) {\n      globalNav.hidden = !visible\n    }\n  }\n\n  setGlobalBarAlwaysExpanded(alwaysExpanded: boolean) {\n    if (!this.headerRedesignEnabled) return\n\n    const globalBar = document.querySelector('.js-global-bar') as HTMLElement\n    if (globalBar) {\n      if (alwaysExpanded) {\n        globalBar.classList.add('always-expanded')\n      } else {\n        globalBar.classList.remove('always-expanded')\n      }\n    }\n  }\n\n  setGlobalBarModalOpen(modalOpen: boolean) {\n    if (!this.headerRedesignEnabled) return\n\n    const globalBar = document.querySelector('.js-global-bar') as HTMLElement\n    if (globalBar) {\n      if (modalOpen) {\n        globalBar.classList.add('search-expanded')\n      } else {\n        globalBar.classList.remove('search-expanded')\n      }\n    }\n  }\n\n  // NOTE: when the search input container is clicked directly, we should expand\n  // the search input. But pretty much everything inside it will bubble up click\n  // events here, so we should ignore clicks on any INNER element that bubbles\n  // up to the container.\n  searchInputContainerClicked(event: MouseEvent) {\n    if ((event.target as HTMLDivElement).classList.contains('search-input-container')) {\n      this.expand(this.isRetainScrollPosition())\n    }\n    sendEvent('blackbird.click', {target: 'SEARCH_BOX'})\n  }\n\n  async updateQueryBuilderVisibility() {\n    await window.customElements.whenDefined('query-builder')\n    this.queryBuilderContainer.hidden = !this.classList.contains('expanded')\n    this.darkBackdrop.hidden = this.queryBuilderContainer.hidden\n  }\n\n  expandAndRetainScrollPosition(trigger: HTMLElement | null) {\n    if (this.isRetainScrollPosition()) return this.expand(true)\n    if (window.scrollY > 200) {\n      this.classList.add('search-input-absolute')\n      this.style.top = `${window.scrollY + 25}px`\n      this.expand(true)\n      this.#returnFocusElement = trigger\n    } else {\n      this.expand()\n    }\n  }\n\n  handleExpand() {\n    this.expand(this.isRetainScrollPosition())\n  }\n\n  async expand(retainScrollPosition?: boolean) {\n    this.possiblyWarmCaches()\n\n    if (this.classList.contains('expanded')) return\n\n    if (!retainScrollPosition) {\n      window.scrollTo(0, 0)\n    }\n\n    this.#returnFocusElement = this.inputButton\n    if (this.searchSuggestionsDialog instanceof HTMLDialogElement) {\n      this.searchSuggestionsDialog.showModal()\n    } else {\n      this.searchSuggestionsDialog.show()\n    }\n\n    this.classList.add('expanded')\n    this.setGlobalNavVisibility(false)\n    this.setGlobalBarModalOpen(true)\n    this.updateQueryBuilderVisibility()\n\n    // Ensure that querybuilder is connected\n    await window.customElements.whenDefined('query-builder')\n\n    if (this.query === '' && this.getAttribute('data-scope')) {\n      this.query = `${this.getAttribute('data-scope')} `\n    }\n\n    this.queryBuilder.inputFocus()\n    this.moveCaretToEndOfInput()\n    this.queryBuilder.inputChange()\n\n    this.parseSearchInputRaw()\n\n    document.dispatchEvent(new CustomEvent('qbsearch-input:expand', {detail: {element: this}}))\n  }\n\n  handleClose = (e: Event) => {\n    this.syncRichButtonText()\n    this.classList.remove('expanded')\n    if (!this.#globalNavAlwaysHidden) {\n      this.setGlobalNavVisibility(true)\n    }\n    this.setGlobalBarModalOpen(false)\n    this.updateQueryBuilderVisibility()\n\n    e.preventDefault()\n\n    if (this.classList.contains('search-input-absolute')) {\n      this.classList.remove('search-input-absolute')\n    }\n\n    // When the dialog is closed, the focus gets moved to the search element by default\n    // We need to guarantee that this is called after that happens, so set a timeout for 0ms\n    // which will cause this to run on the next cycle.\n    setTimeout(() => {\n      this.#returnFocusElement?.focus()\n\n      document.dispatchEvent(new CustomEvent('qbsearch-input:close', {detail: {element: this}}))\n    }, 0)\n  }\n\n  retract = () => {\n    this.searchSuggestionsDialog.close()\n    this.#returnFocusElement?.focus()\n  }\n\n  possiblyWarmCaches() {\n    if (!this.#cachesHaveBeenWarmed && this.isLoggedIn()) {\n      this.#cachesHaveBeenWarmed = true\n      // This request warms the blackbird caches, making searches faster. It's\n      // OK to call repeatedly since it's a noop if the caches are already warm.\n      // We don't need to check for a valid response.\n      fetch('/search/warm_blackbird_caches', {\n        headers: {Accept: 'application/json', 'X-Requested-With': 'XMLHttpRequest'},\n      })\n    }\n  }\n\n  chooseSearchType(ast: BaseNode): Parsing.SearchType {\n    const type = new URLSearchParams(window.location.search).get('type') as Parsing.SearchTypeURLParameter\n    if (type) return this.parsing!.mapURLParamToSearchType(type)\n    return this.parsing!.chooseSearchType(ast, this.isLoggedIn())\n  }\n\n  async search(query: string, openInNewWindow = false) {\n    const parser = await this.loadParser()\n    const ast = parser.parseString(query)\n    const customScopes = this.#findCustomScopesNeededForSearch(ast)\n    const searchType = parser.mapSearchTypeToURLParam(this.chooseSearchType(ast))\n\n    const redirectURL = shouldRedirectInsteadOfSearch(ast, window.location.pathname)\n    if (redirectURL) {\n      softNavigate(redirectURL)\n      return\n    }\n\n    if (this.#isReactContext && !openInNewWindow) {\n      const searchParams: {\n        type: Parsing.SearchTypeURLParameter\n        saved_searches?: string\n        p: null\n        l: null\n        expanded_query?: string\n      } = {\n        type: searchType,\n        // Set page to null so that the search jumps us back to page zero\n        p: null,\n        l: null,\n      }\n\n      if (customScopes.length > 0) {\n        searchParams['saved_searches'] = JSON.stringify(customScopes)\n        searchParams['expanded_query'] = parser.getExpandedQuery(query, customScopes, ast)\n      } else {\n        // Set to undefined to clear them from the URL when there are no saved searches in query\n        searchParams['saved_searches'] = undefined\n        searchParams['expanded_query'] = undefined\n      }\n\n      // If we're in a react context, then allow react to do the searching for us\n      window.dispatchEvent(\n        new CustomEvent('blackbird_monolith_search', {\n          detail: {\n            search: query,\n            searchParams,\n          },\n        }),\n      )\n    } else {\n      // If we're not in a react context, then we need to do the search ourselves\n      let typeParam = ''\n      if (searchType !== '') {\n        typeParam = `&type=${encodeURIComponent(searchType)}`\n      }\n\n      let href = `/search?q=${encodeURIComponent(query)}${typeParam}`\n\n      // Only add the saved_searches param if it's not empty\n      if (customScopes.length > 0) {\n        href += `&saved_searches=${encodeURIComponent(JSON.stringify(customScopes))}`\n        const expandedQuery = encodeURIComponent(parser.getExpandedQuery(query, customScopes, ast))\n        href += `&expanded_query=${expandedQuery}`\n      }\n\n      const experimentsParam = getBlackbirdExperiments().join(',')\n      if (experimentsParam !== '') {\n        href += `&experiments=${experimentsParam}`\n      }\n\n      if (openInNewWindow) {\n        // this actually usually goes to a new tab, except in Chrome and Safari where if you use shift+enter, it opens in a new window for magical reasons\n        window.open(href, '_blank')\n      } else {\n        softNavigate(href)\n      }\n    }\n  }\n\n  #findCustomScopesNeededForSearch(ast: BaseNode): CustomScope[] {\n    // It shouldn't be possible for parsing not to be loaded here, since we are\n    // being passed a parsed AST.\n    if (!this.parsing) {\n      return []\n    }\n\n    const customScopeNames = this.parsing.getCustomScopeNames(ast)\n\n    let customScopesFromUrl: CustomScope[]\n    try {\n      customScopesFromUrl = JSON.parse(new URLSearchParams(window.location.search).get('saved_searches') || '[]')\n      if (!Array.isArray(customScopesFromUrl)) {\n        customScopesFromUrl = []\n      }\n    } catch (e) {\n      customScopesFromUrl = []\n    }\n\n    const customScopesNeededForSearch: CustomScope[] = []\n    for (const customScopeName of customScopeNames) {\n      const customScope =\n        customScopesFromUrl.find(scope => scope.name === customScopeName) ||\n        this.#customScopesSuggestionProvider.customScopesCache.get()?.find(scope => scope.name === customScopeName)\n      if (customScope) {\n        customScopesNeededForSearch.push({name: customScope.name, query: customScope.query} as CustomScope)\n      }\n    }\n    return customScopesNeededForSearch\n  }\n\n  setLocalHistory(query: string) {\n    // Don't save empty queries\n    if (query.trim() === '') return\n\n    let localStorage: string[] = JSON.parse(window.localStorage.getItem('github-search-history') ?? '[]')\n    if (localStorage.length >= MAX_LOCAL_HISTORY) {\n      // keep the last 50 items\n      localStorage = localStorage.slice(0, MAX_LOCAL_HISTORY - 1)\n    }\n\n    if (!localStorage.find(item => item.toLowerCase() === query.toLowerCase())) {\n      localStorage.unshift(query)\n    }\n\n    window.localStorage.setItem('github-search-history', JSON.stringify(localStorage))\n  }\n\n  handleChange() {\n    this.parseSearchInput()\n  }\n\n  async loadParser() {\n    if (!this.parsingPromise) {\n      this.parsingPromise = import('./parsing/parsing')\n      this.parsing = await this.parsingPromise\n    }\n    return this.parsingPromise\n  }\n\n  #waitingToParse = false\n  #lastParseTime = 0\n  parseSearchInput() {\n    // the throttle() function in @github/mini-throttle is broken (although debounce() works), so\n    // implement our own throttling here until that gets fixed\n    const now = Date.now()\n    if (now - this.#lastParseTime > parseDelay && !this.#waitingToParse) {\n      this.parseSearchInputRaw()\n    } else if (!this.#waitingToParse) {\n      this.#waitingToParse = true\n      setTimeout(\n        () => {\n          this.#waitingToParse = false\n          this.parseSearchInputRaw()\n        },\n        parseDelay - (now - this.#lastParseTime),\n      )\n    }\n  }\n\n  // NOTE: this is the non-debounced version of parseSearchInput\n  async parseSearchInputRaw() {\n    if (!this.query) {\n      // if the query is blank we don't need to parse or load the parser\n      this.lastParsedQuery = this.query\n      this.ast = {kind: 'Nothing'} as NothingNode\n      this.#caretPositionKind = CaretPositionKind.Text\n      this.#caretSelectedNode = undefined\n      return\n    }\n\n    if (!this.parsing) {\n      await this.loadParser()\n    }\n\n    this.#lastParseTime = Date.now()\n    if (!this.ast || this.query !== this.lastParsedQuery) {\n      this.lastParsedQuery = this.query\n      const [ast /*, nodes */] = this.parsing!.parseSearchInput(this.lastParsedQuery)\n      this.ast = ast\n    }\n\n    // TODO: get caret position properly\n    const caretData = this.parsing!.getCaretPositionKindFromIndex(this.ast, 0)\n    this.#caretPositionKind = caretData.kind\n    this.#caretSelectedNode = caretData.node\n  }\n\n  handleSubmit(openInNewWindow = false) {\n    // If the query is totally empty, just do nothing and ignore it\n    if (this.query.trim().length === 0) {\n      return\n    }\n\n    this.setLocalHistory(this.query)\n    this.search(this.query, openInNewWindow)\n    this.retract()\n  }\n\n  editCustomScope(event: Event) {\n    this.customScopesManager.editCustomScope(event)\n  }\n\n  async #openManageCustomScopesDialog(event: Event) {\n    this.retract()\n    this.customScopesManager.show()\n\n    // Stop propagation so that the scope isn't also selected\n    event.stopPropagation()\n  }\n\n  newCustomScope(event: Event) {\n    this.customScopesManager.create('')\n    event.stopPropagation()\n  }\n\n  saveQueryAsCustomScope(event: CustomEvent<HTMLElement>) {\n    this.customScopesManager.create(this.query)\n    this.#dialogFocusReturn = event.detail\n  }\n\n  handleDialogClose() {\n    // after the dialog closes, attempt to return the focus to the element that opened it\n    setTimeout(() => {\n      if (this.#dialogFocusReturn) {\n        this.#dialogFocusReturn?.focus()\n        this.#dialogFocusReturn = undefined\n      } else {\n        this.inputButton.focus()\n      }\n    })\n  }\n\n  showFeedbackDialog(event: Event) {\n    this.feedbackDialog.show()\n    this.retract()\n    // Stop propagation so that the modal will stay open\n    event.stopPropagation()\n    event.preventDefault()\n  }\n\n  async submitFeedback(event: Event) {\n    event.preventDefault()\n\n    const form = (event.target as HTMLButtonElement).form!\n    await fetch(form.action, {\n      method: 'POST',\n      body: new FormData(form),\n    })\n    this.feedbackDialog.close()\n  }\n}\n\nclass SearchCopilotEvent extends Event {\n  declare content: string\n  declare repoNwo: string\n  constructor(content: string, repoNwo: string) {\n    super('search-copilot-chat', {\n      bubbles: false,\n      cancelable: true,\n    })\n\n    this.content = content\n    this.repoNwo = repoNwo\n  }\n}\n","import type {Repository} from '@github-ui/current-repository'\nimport {codeNavigationPath} from '@github-ui/paths'\nimport {verifiedFetchJSON} from '@github-ui/verified-fetch'\n\nimport type {RefInfo} from '@github-ui/repos-types'\nimport type {BlackbirdSymbol, StylingDirectivesDocument} from '@github-ui/code-view-types'\nimport type {\n  CodeNavBackendType,\n  CodeNavPromise,\n  CodeNavResultDetails,\n  SymbolTreeBuildingData,\n  TreeNode,\n} from './code-nav-types'\nimport {\n  CodeReference,\n  type CodeSymbol,\n  type DefinitionOrReference,\n  type Range,\n  SymbolKind,\n  SymbolSource,\n} from './code-symbol'\nimport {getMatchGenerator, type Matchable, symbolMatchable, textMatchable} from './get-match'\nimport {alephSymbolToCodeReference, alephSymbolToCodeSymbol, outlineSymbolToCodeSymbol} from './symbol-result-converter'\n\nconst SEARCH_RESULT_LIMIT = 200\n\nexport interface CodeSection {\n  startLine: number\n  endLine: number\n  collapsed: boolean\n  index: number\n  level: number\n}\n\nexport class CodeNavigationInfo {\n  repo: Repository\n  refInfo: RefInfo\n  language: string\n  path: string\n  loggedIn: boolean\n  blobLines: string[]\n  symbols: CodeSymbol[]\n  lineIndexedSymbols: {[line: number]: CodeSymbol} = {}\n  isPlain: boolean\n\n  symbolTree: TreeNode[]\n  stylingDirectives: StylingDirectivesDocument | undefined\n  setLoading: (loading: boolean) => void\n  codeSections: Map<number, CodeSection[]>\n  lineToSectionMap: Map<number, CodeSection[]>\n\n  constructor(\n    repo: Repository,\n    refInfo: RefInfo,\n    path: string,\n    loggedIn: boolean,\n    rawLines: string[],\n    symbols: BlackbirdSymbol[],\n    stylingDirectives: StylingDirectivesDocument | undefined,\n    language: string,\n    isPlain: boolean,\n    setLoading: (loading: boolean) => void,\n  ) {\n    this.setLoading = setLoading\n    this.setLoading(true)\n    this.repo = repo\n    this.refInfo = refInfo\n    this.path = path\n    this.loggedIn = loggedIn\n    this.language = language\n\n    this.blobLines = rawLines\n    this.stylingDirectives = stylingDirectives\n    this.isPlain = isPlain\n    this.symbols = this.initSymbols(symbols)\n\n    this.initSymbolTree()\n    this.initCodeSections()\n    this.setLoading(false)\n  }\n\n  initCodeSections() {\n    const m = new Map()\n    const lineToSectionMap = new Map()\n    for (let i = 0; i < this.symbols.length; i++) {\n      //we don't want to deal with applying sticky if it is going to be a 2 line long sticky section\n      if (this.symbols[i]!.lineNumber < this.symbols[i]!.extent.end.line - 2) {\n        const section = {\n          startLine: this.symbols[i]!.lineNumber,\n          endLine: this.symbols[i]!.extent.end.line,\n          index: i,\n          collapsed: false,\n          level: this.symbols[i]!.depth,\n        }\n        if (m.has(section.startLine)) {\n          const tempArray = m.get(section.startLine)\n          tempArray.push(section)\n          m.set(section.startLine, tempArray)\n        } else {\n          m.set(section.startLine, [section])\n        }\n        if (m.has(section.endLine)) {\n          const tempArray = m.get(section.endLine)\n          tempArray.push(section)\n          m.set(section.endLine, tempArray)\n        } else {\n          m.set(section.endLine, [section])\n        }\n\n        //don't include the start lines or end lines because they're in the other map\n        for (let j = section.startLine + 1; j < section.endLine; j++) {\n          if (lineToSectionMap.has(j)) {\n            const tempArray = lineToSectionMap.get(j)\n            tempArray.push(section)\n            lineToSectionMap.set(j, tempArray)\n          } else {\n            lineToSectionMap.set(j, [section])\n          }\n        }\n      }\n    }\n\n    this.lineToSectionMap = lineToSectionMap\n    this.codeSections = m\n  }\n\n  initSymbols(symbols: BlackbirdSymbol[]) {\n    return symbols.map(outlineSymbol => {\n      const snippet = this.blobLines[outlineSymbol.ident_utf16.start.line_number] || ''\n      const codeSymbol = outlineSymbolToCodeSymbol(outlineSymbol, snippet, {\n        stylingDirectives: this.stylingDirectives,\n        repo: this.repo,\n        refInfo: this.refInfo,\n        path: this.path,\n      })\n\n      this.lineIndexedSymbols[codeSymbol.lineNumber] = codeSymbol\n\n      return codeSymbol\n    })\n  }\n\n  getBlobLine(line: number) {\n    return this.blobLines[line] || ''\n  }\n\n  getSymbolOnLine(lineNumber: number): CodeSymbol | undefined {\n    return this.lineIndexedSymbols[lineNumber]\n  }\n\n  initSymbolTree() {\n    if (this.symbols) {\n      const tempParents: CodeSymbol[] = []\n      const symbolTree: SymbolTreeBuildingData[] = this.symbols\n        .filter(s => s.kind.fullName !== 'field')\n        .map(symbol => {\n          let depth = 0\n          for (let i = tempParents.length - 1; i >= 0; i--) {\n            const parentSymbol = tempParents[i]!\n            if (isAfterSymbol(symbol, parentSymbol)) {\n              tempParents.pop()\n            } else {\n              depth = tempParents.length\n              break\n            }\n          }\n          tempParents.push(symbol)\n          symbol.setSymbolDepth(depth)\n          return {symbol, depth}\n        })\n      this.symbolTree = []\n\n      for (let index = 0; index < symbolTree.length; index++) {\n        const symbol = symbolTree[index]!\n        if (index + 1 < symbolTree.length) {\n          const nextSymbol = symbolTree[index + 1]!\n          if (nextSymbol.depth > symbol.depth) {\n            const symbolChildren = buildSymbolTreeChildren(symbolTree, index)\n            index += determineTotalNumberOfChildren(symbolChildren)\n            this.symbolTree.push({symbol: symbol.symbol, isParent: true, children: symbolChildren})\n            continue\n          }\n        }\n        this.symbolTree.push({symbol: symbol.symbol, isParent: false, children: []})\n      }\n    }\n  }\n\n  createReferences(matches: Range[]): CodeReference[] {\n    return matches.map(match => {\n      const reference = new CodeReference({\n        ident: match,\n        repo: this.repo,\n        refInfo: this.refInfo,\n        path: this.path,\n        isPlain: this.isPlain,\n        source: SymbolSource.BLOB_CONTENT,\n      })\n      reference.setSnippet(\n        undefined,\n        this.stylingDirectives?.[match.start.line],\n        this.blobLines[match.start.line]!,\n        undefined,\n      )\n      return reference\n    })\n  }\n\n  getReferencesToSymbol(symbolName: string): CodeReference[] {\n    //TODO: figure out loading once this is async\n    const ranges = searchInBlobContent(this.blobLines, symbolMatchable(symbolName))\n    return this.createReferences(ranges)\n  }\n\n  getReferencesToSearch(term: string): CodeReference[] {\n    //TODO: figure out loading once this is async\n    const ranges = searchInBlobContent(this.blobLines, textMatchable(term))\n    return this.createReferences(ranges)\n  }\n\n  getDefinitionsAndReferences(text: string, row: number, column: number): CodeNavPromise {\n    this.setLoading(true)\n\n    const defs = (async () => {\n      const selectedSymbol = this.getSymbolOnLine(row + 1) // row is 0-indexed, line numbers are 1-indexed\n      if (selectedSymbol && selectedSymbol.name === text) {\n        return {\n          definitions: [selectedSymbol],\n          backend: 'search' as CodeNavBackendType,\n        }\n      }\n\n      let [definitions, backend] = await this.getAlephDefinitions(text, row, column, this.loggedIn)\n\n      // Prefer locally-defined symbols over search-based definitions, unless precise results are available.\n      if (backend === 'search') {\n        const localDefinitions = this.getLocalDefinitions(text)\n        if (localDefinitions.length > 0) {\n          definitions = localDefinitions\n        }\n\n        // If we get a definition from the current file, suppress all the others\n        const localDefinition = definitions.find(d => d.path === this.path && d.repo === this.repo)\n        if (localDefinition) {\n          definitions = [localDefinition]\n        }\n        backend = 'search'\n      } else {\n        const localDefinitionsForKindFallback = this.getLocalDefinitions(text, true)\n        for (const definition of definitions) {\n          if (definition.kind.fullName === '' && definition.name === text) {\n            //local definitions always returns an array with a single item if it returns anything\n            //instead of empty string we can choose a default kind to display here when aleph and local have nothing,\n            //but for now keeping as empty string\n            definition.kind = localDefinitionsForKindFallback[0]\n              ? localDefinitionsForKindFallback[0].kind\n              : new SymbolKind({kind: ''})\n          }\n        }\n      }\n      return {\n        definitions,\n        backend,\n      }\n    })()\n\n    const localRefs = (async () => {\n      const {definitions} = await defs\n      const definitionLines = definitions.map(d => d.lineNumber)\n      const references = this.getReferencesToSymbol(text).filter(r => !definitionLines.includes(r.lineNumber))\n\n      return {\n        references,\n        backend: 'search' as CodeNavBackendType,\n      }\n    })()\n\n    const alephRefs = (async () => {\n      let symbolKind = 'SYMBOL_KIND_UNKNOWN'\n      const sym = this.getSymbolOnLine(row + 1) // row is 0-indexed, line numbers are 1-indexed\n      if (sym) {\n        // If we have this in the symbol outline (from blackbird analysis): use it.\n        symbolKind = sym.kind.enumStringVal\n      } else {\n        // Otherwise, try to use the first def\n        const {definitions} = await defs\n        symbolKind = definitions[0]?.kind?.enumStringVal || symbolKind\n      }\n      return this.getAlephReferences(text, row, column, this.loggedIn, symbolKind)\n    })()\n\n    const crossRefs = (async () => {\n      const [references, backend] = await alephRefs\n      return {\n        references,\n        backend,\n      }\n    })()\n\n    // Exclude definitions from references\n    return {\n      definitions: defs,\n      localReferences: localRefs,\n      crossReferences: crossRefs,\n      setLoading: this.setLoading,\n    }\n  }\n\n  getLocalDefinitions(text: string, getSymbolKind = false): CodeSymbol[] {\n    let bestRank = 9\n    let definitions: CodeSymbol[] = []\n    for (const sym of this.symbols) {\n      if (sym.name === text && (sym.kind.rank < bestRank || getSymbolKind)) {\n        bestRank = sym.kind.rank\n        definitions = [sym]\n      }\n    }\n\n    return definitions\n  }\n\n  async getAlephDefinitions(\n    text: string,\n    row: number,\n    column: number,\n    loggedIn: boolean,\n  ): Promise<[CodeSymbol[], CodeNavBackendType]> {\n    let backend: CodeNavBackendType = 'search'\n    if ((text === '' && row === -1 && column === -1) || !loggedIn) {\n      return [[], backend]\n    }\n\n    const definitionsUrl = codeNavigationPath({\n      repo: this.repo,\n      type: 'definition',\n      q: text,\n      language: this.language,\n      row,\n      column,\n      ref: this.refInfo.name,\n      path: this.path,\n      codeNavContext: 'BLOB_VIEW',\n      symbolKind: null,\n    })\n\n    let response: Response\n    try {\n      response = await verifiedFetchJSON(definitionsUrl)\n    } catch (e) {\n      return [[], backend]\n    }\n\n    if (!response.ok) {\n      return [[], backend]\n    }\n\n    let resultDetails: CodeNavResultDetails\n    try {\n      resultDetails = await response.json()\n    } catch (e) {\n      return [[], backend]\n    }\n\n    backend = parseAlephBackendType(resultDetails.backend) ?? 'search'\n\n    const definitions = resultDetails.payload\n      .flatMap(refs => refs)\n      .map(alephSymbol => {\n        return alephSymbolToCodeSymbol(alephSymbol, {\n          stylingDirectives: this.stylingDirectives,\n          repo: this.repo,\n          refInfo: this.refInfo,\n          path: this.path,\n          symbol: text,\n          backend,\n        })\n      })\n\n    return [definitions, backend]\n  }\n\n  async getAlephReferences(\n    text: string,\n    row: number,\n    column: number,\n    loggedIn: boolean,\n    symbolKind: string,\n  ): Promise<[CodeReference[], CodeNavBackendType]> {\n    let backend: CodeNavBackendType = 'search'\n    if ((text === '' && row === -1 && column === -1) || !loggedIn) {\n      return [[], backend]\n    }\n\n    const referencesUrl = codeNavigationPath({\n      repo: this.repo,\n      type: 'references',\n      q: text,\n      language: this.language,\n      row,\n      column,\n      ref: this.refInfo.name,\n      path: this.path,\n      codeNavContext: 'BLOB_VIEW',\n      symbolKind,\n    })\n\n    const partialResponse = await verifiedFetchJSON(referencesUrl)\n    if (!partialResponse.ok) {\n      return [[], backend]\n    }\n\n    let response: CodeNavResultDetails\n    try {\n      response = await partialResponse.json()\n    } catch (e) {\n      return [[], backend]\n    }\n\n    backend = parseAlephBackendType(response.backend) ?? 'search'\n\n    const observedLines = new Set<number>()\n    const isCheckedLine = (line: number) => {\n      if (observedLines.has(line)) {\n        return true\n      } else {\n        observedLines.add(line)\n        return false\n      }\n    }\n\n    const references = response.payload\n      .flatMap(refs => refs)\n      .reduce<CodeReference[]>((results, alephSymbol) => {\n        if (alephSymbol.path === this.path) {\n          return results\n        }\n        const reference = alephSymbolToCodeReference(alephSymbol, {\n          stylingDirectives: this.stylingDirectives,\n          repo: this.repo,\n          refInfo: this.refInfo,\n          path: this.path,\n          backend,\n        })\n\n        if (isCheckedLine(reference.lineNumber)) {\n          return results\n        }\n\n        results.push(reference)\n        return results\n      }, [])\n      // For some reason, aleph returns references out of order, so we need to sort\n      // them by line number.\n      .sort((a, b) => a.lineNumber - b.lineNumber)\n\n    return [references, backend]\n  }\n}\n\nexport function parseAlephBackendType(fromAleph: string): CodeNavBackendType | null {\n  switch (fromAleph) {\n    case 'ALEPH_PRECISE':\n    case 'ALEPH_PRECISE_PREVIEW':\n    case 'ALEPH_PRECISE_DEVELOPMENT':\n      return 'precise'\n    case 'BLACKBIRD':\n      return 'search'\n    default:\n      return null\n  }\n}\n\nexport function isAfterSymbol(symbolA: CodeSymbol, symbolB: CodeSymbol): boolean {\n  return symbolA.extent.start.line === symbolB.extent.end.line\n    ? symbolA.extent.start.column > symbolB.extent.end.column\n    : symbolA.extent.start.line > symbolB.extent.end.line\n}\n\nfunction buildSymbolTreeChildren(symbolTree: SymbolTreeBuildingData[], currentIndex: number) {\n  const symbolChildren: TreeNode[] = []\n  const symbol = symbolTree[currentIndex]!\n  for (let i = currentIndex + 1; i < symbolTree.length; i++) {\n    const tempSymbol = symbolTree[i]!\n    if (tempSymbol.depth > symbol.depth) {\n      const tempChildren = buildSymbolTreeChildren(symbolTree, i)\n      i += determineTotalNumberOfChildren(tempChildren)\n      symbolChildren.push({\n        symbol: tempSymbol.symbol,\n        children: tempChildren,\n        isParent: tempChildren.length > 0,\n      })\n    } else {\n      break\n    }\n  }\n  return symbolChildren\n}\n\nfunction determineTotalNumberOfChildren(node: TreeNode[]) {\n  let total = node.length\n  for (let i = 0; i < node.length; i++) {\n    const currNode = node[i]!\n    if (currNode.isParent) {\n      total += determineTotalNumberOfChildren(currNode.children)\n    }\n  }\n\n  return total\n}\n\nexport function searchInBlobContent(lines: string[], m: Matchable): Range[] {\n  const output: Range[] = []\n  const matches = getMatchGenerator(m, lines)\n  let match = matches.next()\n\n  while (!match.done && output.length < SEARCH_RESULT_LIMIT) {\n    const {column, columnEnd, line} = match.value\n    output.push({\n      start: {\n        line,\n        column,\n      },\n      end: {\n        line,\n        column: columnEnd,\n      },\n    })\n\n    match = matches.next()\n  }\n  return output\n}\n\nexport function searchInBlobIncrementally(\n  codeRefs: DefinitionOrReference[],\n  lines: string[],\n  matchable: Matchable,\n): Range[] {\n  if (codeRefs.length === 0) {\n    // In the incremental search we are narrowing results. If there are no results for a less specific search, there won't be any further matches.\n    return []\n  }\n\n  const startedAtResultLimit = codeRefs.length >= SEARCH_RESULT_LIMIT\n\n  const checkedLine: Record<number, true> = {}\n  const searchResults = codeRefs.reduce<Range[]>((output, ref) => {\n    if (checkedLine[ref.ident.start.line]) {\n      return output\n    }\n\n    checkedLine[ref.ident.start.line] = true\n    const matches = getMatchGenerator(matchable, [lines[ref.ident.start.line]!])\n    let match = matches.next()\n    while (!match.done && output.length < SEARCH_RESULT_LIMIT) {\n      const {column, columnEnd} = match.value\n      output.push({\n        start: {\n          line: ref.ident.start.line,\n          column,\n        },\n        end: {\n          line: ref.ident.start.line,\n          column: columnEnd,\n        },\n      })\n      match = matches.next()\n    }\n\n    return output\n  }, [])\n\n  // Add new results from the raw blob. Note: this is only necessary if we dropped the number\n  // of results below the maximum in the previous phase!\n  if (searchResults.length < SEARCH_RESULT_LIMIT && startedAtResultLimit) {\n    const startFromLine = codeRefs[codeRefs.length - 1]!.ident.start.line\n    const matchesInRawBlob = getMatchGenerator(matchable, lines, startFromLine)\n    let match = matchesInRawBlob.next()\n    while (!match.done && searchResults.length < SEARCH_RESULT_LIMIT) {\n      const {line, column, columnEnd} = match.value\n      searchResults.push({\n        start: {\n          line,\n          column,\n        },\n        end: {\n          line,\n          column: columnEnd,\n        },\n      })\n      match = matchesInRawBlob.next()\n    }\n  }\n\n  return searchResults\n}\n","import type {Repository} from '@github-ui/current-repository'\nimport type {StylingDirectivesLine} from '@github-ui/code-view-types'\nimport {blamePath, blobPath} from '@github-ui/paths'\nimport type {RefInfo} from '@github-ui/repos-types'\nimport type {SafeHTMLString} from '@github-ui/safe-html'\n\ninterface Position {\n  line: number\n  column: number\n}\n\nexport interface Range {\n  start: Position\n  end: Position\n}\n\nexport enum SymbolSource {\n  BLACKBIRD_SEARCH = 'blackbird-search',\n  BLACKBIRD_ANALYSIS = 'blackbird-analysis',\n  ALEPH_PRECISE = 'aleph-precise',\n  BLOB_CONTENT = 'blob-content-search',\n}\n\nexport class SymbolKind {\n  enumStringVal: string\n  fullName: string\n  shortName: string\n  plColor: string\n  rank: number\n\n  constructor({kind}: {kind: string | number}) {\n    const [fullName, enumStringVal] = convertBlackbirdSymbolKind(kind)\n\n    this.enumStringVal = enumStringVal\n    this.fullName = fullName\n    this.shortName = symbolKindShortName(fullName)\n    this.plColor = symbolKindColor(fullName)\n    this.rank = symbolKindRank(fullName)\n  }\n}\n\n// Convert a blackbird SymbolKind enum value to a display friendly string.\n// Source of truth: https://github.com/github/hydro-schemas/blob/main/proto/hydro/schemas/blackbird/v0/entities/symbol_kind.proto\nfunction convertBlackbirdSymbolKind(kind: string | number): [string, string] {\n  if (typeof kind === 'string') {\n    const name = kind.toString().replace('SYMBOL_KIND_', '').replace(/_DEF$/, '').replace(/_REF$/, '').toLowerCase()\n    if (kind.startsWith('SYMBOL_KIND_')) {\n      return [name, kind.toString()]\n    } else if (kind !== '' && kind !== 'unknown') {\n      let enumVal = `SYMBOL_KIND_${kind.toUpperCase()}`\n      if (kind === 'call') {\n        enumVal += '_REF'\n      } else {\n        enumVal += '_DEF'\n      }\n      return [kind, enumVal]\n    }\n  }\n\n  return ['unknown', 'SYMBOL_KIND_UNKNOWN']\n}\n\nexport function symbolKindShortName(fullName: string) {\n  switch (fullName) {\n    case 'function':\n    case 'method':\n      return 'func'\n    case 'interface':\n      return 'intf'\n    case 'implementation':\n      return 'impl'\n    case 'constant':\n      return 'const'\n    case 'module':\n      return 'mod'\n\n    case 'h1':\n    case 'h2':\n    case 'h3':\n    case 'h4':\n    case 'h5':\n    case 'h6':\n    case 'class':\n    case 'call':\n    case 'enum':\n    case 'field':\n    case 'macro':\n    case 'struct':\n    case 'trait':\n    case 'type':\n    case 'union':\n      return fullName\n\n    default:\n      return fullName.substring(0, 1)\n  }\n}\n\nfunction symbolKindColor(fullName: string) {\n  switch (fullName) {\n    case 'function':\n    case 'method':\n      return 'prettylights.syntax.entity'\n    case 'class':\n    case 'enum':\n    case 'struct':\n    case 'union':\n      return 'prettylights.syntax.constant'\n    case 'interface':\n    case 'trait':\n      return 'prettylights.syntax.keyword'\n    case 'constant':\n    case 'field':\n    case 'enum member':\n      return 'prettylights.syntax.variable'\n    case 'implementation':\n      return 'prettylights.syntax.string'\n\n    default:\n      return 'prettylights.syntax.entity'\n  }\n}\n\n// Relative rank of symbol kinds. Lower is higher relevance.\nfunction symbolKindRank(kind: string): number {\n  return (\n    {\n      class: 1,\n      struct: 1,\n      enum: 1,\n      type: 2,\n      interface: 3,\n      trait: 3,\n      module: 4,\n      implementation: 5,\n      function: 6,\n      method: 7,\n      call: 8,\n      field: 9,\n    }[kind] || 9\n  )\n}\n\nexport class CodeSymbol {\n  ident: Range\n  extent: Range\n\n  kind: SymbolKind\n  name: string\n  fullyQualifiedName: string\n  depth: number\n\n  repo: Repository\n  refInfo: RefInfo\n  path: string\n\n  // Snippet for the line the symbol is defined on\n  highlightedText: SafeHTMLString | undefined\n  stylingDirectives: StylingDirectivesLine | undefined\n  bodyText: string\n  leadingWhitespace: number | undefined\n\n  source: SymbolSource\n\n  constructor({\n    ident,\n    extent,\n    kind,\n    name,\n    fullyQualifiedName,\n    source,\n  }: {\n    ident: Range\n    extent: Range\n    kind: string | number\n    name: string\n    fullyQualifiedName: string\n    source: SymbolSource\n  }) {\n    this.ident = ident\n    this.extent = extent\n    this.kind = new SymbolKind({kind})\n    this.name = name\n    this.fullyQualifiedName = fullyQualifiedName\n    this.source = source\n  }\n\n  setSymbolDepth(depth: number) {\n    this.depth = depth\n  }\n  setFileInfo(repo: Repository, refInfo: RefInfo, path: string) {\n    this.repo = repo\n    this.refInfo = refInfo\n    this.path = path\n  }\n\n  get lineNumber() {\n    return this.ident.start.line + 1\n  }\n\n  setSnippet(\n    highlightedText: SafeHTMLString | undefined,\n    stylingDirectives: StylingDirectivesLine | undefined,\n    bodyText: string,\n    leadingWhitespace: number | undefined,\n  ) {\n    this.highlightedText = highlightedText\n    this.stylingDirectives = stylingDirectives\n    this.bodyText = bodyText\n    this.leadingWhitespace = leadingWhitespace\n  }\n\n  href(): string {\n    if (!this.repo || !this.refInfo || !this.path) {\n      return `/${window.location.pathname}#L${this.lineNumber}`\n    }\n\n    const commitish =\n      this.source === SymbolSource.BLACKBIRD_SEARCH\n        ? this.repo.defaultBranch\n        : this.refInfo.name || this.refInfo.currentOid\n\n    return blobPath({\n      owner: this.repo.ownerLogin,\n      repo: this.repo.name,\n      commitish,\n      filePath: this.path,\n      lineNumber: this.lineNumber,\n    })\n  }\n\n  // Generates a string which uniquely identifies the file this reference comes from\n  pathKey(): string {\n    return `${this.repo.ownerLogin}/${this.repo.name}/${this.refInfo.currentOid}/${this.path}`\n  }\n}\n\nexport class CodeReference {\n  ident: Range\n  repo: Repository\n  refInfo: RefInfo\n  path: string\n  isPlain: boolean\n\n  // Snippet information for the line the reference is from\n  highlightedText: SafeHTMLString | undefined\n  stylingDirectives: StylingDirectivesLine | undefined\n  bodyText: string\n  source: SymbolSource\n  leadingWhitespace: number | undefined\n\n  constructor({\n    ident,\n    repo,\n    refInfo,\n    path,\n    isPlain,\n    source,\n  }: {\n    ident: Range\n    repo: Repository\n    refInfo: RefInfo\n    path: string\n    isPlain?: boolean\n    source: SymbolSource\n  }) {\n    this.ident = ident\n    this.repo = repo\n    this.refInfo = refInfo\n    this.path = path\n    this.isPlain = isPlain ?? false\n    this.source = source\n  }\n\n  get lineNumber() {\n    return this.ident.start.line + 1\n  }\n\n  href(blame: boolean): string {\n    if (!this.repo || !this.refInfo || !this.path) {\n      return `/${window.location.pathname}#L${this.lineNumber}`\n    }\n\n    const commitish =\n      this.source === SymbolSource.BLACKBIRD_SEARCH\n        ? this.repo.defaultBranch\n        : this.refInfo.name || this.refInfo.currentOid\n\n    const params = {\n      owner: this.repo.ownerLogin,\n      repo: this.repo.name,\n      commitish,\n      filePath: this.path,\n      lineNumber: this.lineNumber,\n      plain: this.isPlain ? 1 : undefined,\n    }\n\n    return blame ? blamePath(params) : blobPath(params)\n  }\n\n  setSnippet(\n    highlightedText: SafeHTMLString | undefined,\n    stylingDirectives: StylingDirectivesLine | undefined,\n    bodyText: string,\n    leadingWhitespace: number | undefined,\n  ) {\n    this.highlightedText = highlightedText\n    this.stylingDirectives = stylingDirectives\n    this.bodyText = bodyText\n    this.leadingWhitespace = leadingWhitespace\n  }\n\n  // Generates a string which uniquely identifies the file this reference comes from\n  pathKey(): string {\n    return `${this.repo.ownerLogin}/${this.repo.name}/${this.refInfo.currentOid}/${this.path}`\n  }\n}\n\nexport type DefinitionOrReference = CodeSymbol | CodeReference\n","/**\n * Lazy iterator that returns one match at a time\n * @param regex regular expression used for the search\n * @param text raw text blob\n * @param startFromLine line in the text blob indexed from 0\n */\n\nenum MatchableType {\n  Text,\n  Symbol,\n}\n\nexport interface Matchable {\n  kind: MatchableType\n  regexp: RegExp\n}\n\nexport function symbolMatchable(symbol: string) {\n  const escapedRegex = `(\\\\W|^)${symbol.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}(\\\\W|$)`\n  return {\n    kind: MatchableType.Symbol,\n    regexp: new RegExp(escapedRegex, 'g'),\n  }\n}\n\nexport function textMatchable(query: string) {\n  const escapedQuery = query.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\n  return {\n    kind: MatchableType.Text,\n    regexp: new RegExp(escapedQuery, 'gi'),\n  }\n}\n\nexport function* getMatchGenerator(regex: Matchable, lines: string[], startFromLine = 0) {\n  for (let line = startFromLine; line < lines.length; line++) {\n    const snippet = lines[line]!\n\n    let match: RegExpExecArray | null\n\n    while ((match = regex.regexp.exec(snippet)) !== null) {\n      let matchContent = match[0]\n      let column = match.index\n\n      // Symbol matcher regex match leading whitespace, but don't actually include\n      // that in the match positions! This is necessary because regex\n      // lookbehinds aren't widely supported in browsers...\n      if (regex.kind === MatchableType.Symbol) {\n        if (matchContent.length > 0 && /\\W/.test(matchContent[0]!)) {\n          matchContent = matchContent.substring(1)\n          column += match[0].length - matchContent.length\n        }\n        if (matchContent.length > 0 && /\\W/.test(matchContent[matchContent.length - 1]!)) {\n          matchContent = matchContent.substring(0, matchContent.length - 1)\n        }\n      }\n\n      yield {\n        line,\n        column,\n        columnEnd: column + matchContent.length,\n        text: snippet,\n      }\n    }\n  }\n}\n","import type {Repository} from '@github-ui/current-repository'\n\nimport type {RefInfo} from '@github-ui/repos-types'\nimport type {BlackbirdSymbol, StylingDirectivesDocument} from '@github-ui/code-view-types'\nimport {CodeReference, CodeSymbol, SymbolSource} from './code-symbol'\nimport type {AlephSymbol, CodeNavBackendType} from './code-nav-types'\n\ninterface Options {\n  stylingDirectives: StylingDirectivesDocument | undefined\n  path: string\n  repo: Repository\n  refInfo: RefInfo\n}\n\ninterface AlephSymbolOptions extends Options {\n  backend: CodeNavBackendType\n}\n\nexport function outlineSymbolToCodeSymbol(\n  outlineSymbol: BlackbirdSymbol,\n  snippet: string,\n  {stylingDirectives, repo, refInfo, path}: Options,\n): CodeSymbol {\n  const {extent_utf16: extentUtf16, ident_utf16: identUtf16} = outlineSymbol\n\n  const codeSymbol = new CodeSymbol({\n    kind: outlineSymbol.kind,\n    fullyQualifiedName: outlineSymbol.fully_qualified_name,\n    name: outlineSymbol.name,\n    extent: {\n      start: {line: extentUtf16.start.line_number, column: extentUtf16.start.utf16_col},\n      end: {line: extentUtf16.end.line_number, column: extentUtf16.end.utf16_col},\n    },\n    ident: {\n      start: {line: identUtf16.start.line_number, column: identUtf16.start.utf16_col},\n      end: {line: identUtf16.end.line_number, column: identUtf16.end.utf16_col},\n    },\n    source: SymbolSource.BLACKBIRD_ANALYSIS,\n  })\n\n  codeSymbol.setSnippet(undefined, stylingDirectives?.[identUtf16.start.line_number], snippet, undefined)\n  codeSymbol.setFileInfo(repo, refInfo, path)\n\n  return codeSymbol\n}\n\nexport function alephSymbolToCodeSymbol(\n  alephSymbol: AlephSymbol,\n  {symbol, refInfo, repo, path, backend}: AlephSymbolOptions & {symbol: string},\n): CodeSymbol {\n  const symbolStartIdx = alephSymbol.ident?.start?.character\n  const symbolEndIdx = alephSymbol.ident?.end?.character ?? alephSymbol.ident?.start?.character\n  const ident = {\n    start: {\n      line: alephSymbol.ident.start.line,\n      column: symbolStartIdx ? symbolStartIdx - alephSymbol.leadingWhitespace : 0,\n    },\n    end: {\n      line: alephSymbol.ident?.end?.line ?? alephSymbol.ident.start.line,\n      column: symbolEndIdx ? symbolEndIdx - alephSymbol.leadingWhitespace : 0,\n    },\n  }\n\n  const extentStartIdx = alephSymbol.extent?.start?.character\n  const extentEndIdx = alephSymbol.extent?.end?.character ?? alephSymbol.extent?.start?.character\n  const extent = {\n    start: {\n      line: alephSymbol.extent.start.line,\n      column: extentStartIdx ? extentStartIdx : 0,\n    },\n    end: {\n      line: alephSymbol.extent.end?.line ?? alephSymbol.extent.start.line,\n      column: extentEndIdx ? extentEndIdx : 0,\n    },\n  }\n\n  const codeSymbol = new CodeSymbol({\n    ident,\n    extent,\n    kind: alephSymbol.symbolKind,\n    name: symbol,\n    // I guess aleph doesn't support fully qualified names? Just use the name\n    fullyQualifiedName: symbol,\n    source: backend === 'search' ? SymbolSource.BLACKBIRD_SEARCH : SymbolSource.ALEPH_PRECISE,\n  })\n\n  if (alephSymbol.local) {\n    codeSymbol.setFileInfo(repo, refInfo, path)\n  } else if (alephSymbol.commitOid && alephSymbol.path) {\n    let symbolRefInfo = refInfo\n\n    if (alephSymbol.commitOid !== refInfo.currentOid) {\n      symbolRefInfo = {\n        name: '',\n        listCacheKey: alephSymbol.commitOid,\n        currentOid: alephSymbol.commitOid,\n        canEdit: false,\n      }\n    }\n\n    codeSymbol.setFileInfo(alephSymbol.repo ?? repo, symbolRefInfo, alephSymbol.path)\n  }\n\n  const whiteSpace = new Array(alephSymbol.leadingWhitespace).fill(' ').join('')\n  const firstLineWithWhiteSpace = whiteSpace + (alephSymbol.firstLine || '')\n  codeSymbol.setSnippet(alephSymbol.highlightedText, undefined, firstLineWithWhiteSpace, alephSymbol.leadingWhitespace)\n  return codeSymbol\n}\n\nexport function alephSymbolToCodeReference(\n  alephSymbol: AlephSymbol,\n  {refInfo, path, repo, backend}: AlephSymbolOptions,\n): CodeReference {\n  let symbolRefInfo = refInfo\n  let symbolPath = path\n\n  if (!alephSymbol.local && alephSymbol.commitOid && alephSymbol.path) {\n    symbolRefInfo = refInfo\n    symbolPath = alephSymbol.path\n\n    if (alephSymbol.commitOid !== refInfo.currentOid) {\n      symbolRefInfo = {\n        name: '',\n        listCacheKey: alephSymbol.commitOid,\n        currentOid: alephSymbol.commitOid,\n\n        // TODO: this is probably the wrong value sometimes... but we most\n        // likely won't read this field\n        canEdit: false,\n      }\n    }\n  }\n\n  const identStartSymbolIdx = alephSymbol.ident.start.character\n  const identEndSymbolIdx = alephSymbol.ident.end?.character\n  const codeReference = new CodeReference({\n    repo,\n    refInfo: symbolRefInfo,\n    path: symbolPath,\n    ident: {\n      start: {\n        line: alephSymbol.ident.start.line,\n        column: identStartSymbolIdx ? identStartSymbolIdx - alephSymbol.leadingWhitespace : 0,\n      },\n      end: {\n        line: alephSymbol.ident.end?.line || alephSymbol.ident.start.line,\n        column: identEndSymbolIdx ? identEndSymbolIdx - alephSymbol.leadingWhitespace : 0,\n      },\n    },\n    source: backend === 'search' ? SymbolSource.BLACKBIRD_SEARCH : SymbolSource.ALEPH_PRECISE,\n  })\n\n  const firstLineWithWhiteSpace =\n    new Array(alephSymbol.leadingWhitespace).fill(' ').join('') + (alephSymbol.firstLine || '')\n  codeReference.setSnippet(\n    alephSymbol.highlightedText,\n    undefined,\n    firstLineWithWhiteSpace,\n    alephSymbol.leadingWhitespace,\n  )\n  return codeReference\n}\n","export type AuthTokenResult = {\n  token: string\n  expiration: string\n}\n\nexport type SerializedAuthToken = {\n  value: string\n  expiration: string\n  ssoOrgIDs: string[]\n}\n\n/**\n * AuthToken represents an authentication token that is passed to CAPI, which is used to pull resources\n * from the monolith.\n *\n * It is capable of determining which authorization scheme to use (Bearer for SSATs or our own\n * GitHub-Bearer for user tokens).\n *\n * It also can tell if it needs refreshing, i.e. if it is expired or if the SSO orgs have changed since\n * it was minted.\n *\n * AuthToken doesn't care where the list of SSO orgs comes from.  Typically they are hydrated into a React\n * partial/component via props sent from the server, which would require a page refresh to receive the\n * current list, but they could theoretically come from other places too, like API calls...\n *\n * Finally, it can convert itself to/from ordinary JS objects that can be stored/retrieved from\n * local storage.\n */\nexport class AuthToken {\n  value: string\n  expiration: string\n  ssoOrgIDs: string[]\n\n  constructor(value: string, expiration: string, ssoOrgIDs: string[]) {\n    this.value = value\n    this.expiration = expiration\n    this.ssoOrgIDs = ssoOrgIDs\n  }\n\n  /**\n   * Returns a formatted string to be used as the value of an `Authorization` header\n   * to be \"GitHub-Bearer <encrypted token>\"\n   */\n  get authorizationHeaderValue() {\n    return `GitHub-Bearer ${this.value}`\n  }\n\n  /**\n   * Returns true if this auth token needs to be refreshed.\n   */\n  needsRefreshing(ssoOrgIds: string[]) {\n    return this.isExpired || this.ssoChanged(ssoOrgIds)\n  }\n\n  /**\n   * Returns true if this auth token is expired.\n   */\n  get isExpired() {\n    const expirationDateString = new Date(this.expiration)\n\n    const expirationDate = new Date(\n      Date.UTC(\n        expirationDateString.getUTCFullYear(),\n        expirationDateString.getUTCMonth(),\n        expirationDateString.getUTCDate(),\n        expirationDateString.getUTCHours(),\n        expirationDateString.getUTCMinutes(),\n        expirationDateString.getUTCSeconds(),\n        expirationDateString.getUTCMilliseconds(),\n      ),\n    )\n\n    const padding = 15 * 1000 // seconds\n\n    return expirationDate < new Date(Date.now() + padding)\n  }\n\n  /**\n   * Returns true if the session's SSO'd organizations have changed since the token was originally issued.\n   *\n   * Technically the set of orgs is inverted, representing the orgs that are *not* SSO'd, but functionally\n   * it will operate the same.\n   */\n  ssoChanged(ssoOrgIDs: string[]) {\n    return !(\n      this.ssoOrgIDs.every(org => ssoOrgIDs.includes(org)) && ssoOrgIDs.every(org => this.ssoOrgIDs.includes(org))\n    )\n  }\n\n  /**\n   * Build a new AuthToken from the results of a call to the token API endpoint.\n   */\n  static fromResult(result: AuthTokenResult, orgIds: string[]) {\n    return new AuthToken(result.token, result.expiration, orgIds)\n  }\n\n  /**\n   * Convert this token into a plain JS object, which can be stringified and put into localStorage.\n   */\n  serialize(): SerializedAuthToken {\n    return {\n      value: this.value,\n      expiration: this.expiration,\n      ssoOrgIDs: this.ssoOrgIDs,\n    }\n  }\n\n  /**\n   * Build a new auth token from a plain JS object, i.e. one parsed from localStorage.\n   */\n  static deserialize(serialized: SerializedAuthToken): AuthToken {\n    return new AuthToken(serialized.value, serialized.expiration, serialized.ssoOrgIDs)\n  }\n}\n","import {AuthToken, type AuthTokenResult, type SerializedAuthToken} from './auth-token'\nimport safeStorage from '@github-ui/safe-storage'\nimport {verifiedFetchJSON} from '@github-ui/verified-fetch'\n\nconst COPILOT_AUTH_TOKEN_KEY = 'COPILOT_AUTH_TOKEN'\nexport class CopilotAuthTokenProvider {\n  ssoOrgIDs: string[]\n  currentAuthTokenRequest: Promise<AuthToken> | null\n  copilotLocalStorage: {\n    getItem: (key: string, now?: number) => string | null\n    setItem: (key: string, value: string, now?: number) => void\n  }\n\n  constructor(ssoOrgIDs: string[]) {\n    this.ssoOrgIDs = ssoOrgIDs\n    this.currentAuthTokenRequest = null\n    this.copilotLocalStorage = safeStorage('localStorage', {\n      throwQuotaErrorsOnSet: false,\n      ttl: 1000 * 60 * 60 * 24,\n    })\n  }\n\n  /**\n   * Get the current auth token, either from local storage or by minting a new one from dotcom.\n   */\n  async getAuthToken(): Promise<AuthToken> {\n    const token = this.getLocalStorageAuthToken()\n\n    return token ? this.validateAuthToken(token) : this.fetchAuthToken()\n  }\n\n  setLocalStorageAuthToken(token: AuthToken) {\n    this.copilotLocalStorage.setItem(COPILOT_AUTH_TOKEN_KEY, JSON.stringify(token.serialize()))\n  }\n\n  getLocalStorageAuthToken(): AuthToken | null {\n    const value = this.copilotLocalStorage.getItem(COPILOT_AUTH_TOKEN_KEY)\n\n    return value ? AuthToken.deserialize(JSON.parse(value) as SerializedAuthToken) : null\n  }\n\n  /**\n   * Validate the given auth token.  If it's all good, return it, otherwise, go mint a new one from\n   * dotcom and return it instead.\n   */\n  private async validateAuthToken(token: AuthToken): Promise<AuthToken> {\n    return token.needsRefreshing(this.ssoOrgIDs) ? this.fetchAuthToken() : token\n  }\n\n  /**\n   * Return the current auth token request, or start a new one.\n   *\n   * The inner workings of the chat app can cause multiple requests to CAPI in quick succession.  If we\n   * do not have an auth token available in local storage, each of those requests will trigger their own\n   * token fetch, hence the storing of the current request on `this`.\n   */\n  private fetchAuthToken(): Promise<AuthToken> {\n    if (!this.currentAuthTokenRequest) {\n      this.currentAuthTokenRequest = this._fetchAuthToken()\n    }\n\n    return this.currentAuthTokenRequest\n  }\n\n  /**\n   * Start a new auth token request, parsing the result, persisting it in local storage,\n   * and clearing the current request once finished.\n   */\n  private async _fetchAuthToken(): Promise<AuthToken> {\n    const response = await verifiedFetchJSON('/github-copilot/chat/token', {method: 'POST'})\n\n    if (response.ok) {\n      const result = (await response.json()) as AuthTokenResult\n      this.currentAuthTokenRequest = null\n\n      const token = AuthToken.fromResult(result, this.ssoOrgIDs)\n\n      this.setLocalStorageAuthToken(token)\n\n      return token\n    } else {\n      this.currentAuthTokenRequest = null\n\n      throw new Error('Failed to mint new auth token')\n    }\n  }\n}\n","import {persistSubmitButtonValue} from './remote-submit'\n\ntype TextField = HTMLInputElement | HTMLTextAreaElement\ntype Button = HTMLInputElement | HTMLButtonElement\n\nfunction fire(target: HTMLElement, name: string, cancelable: boolean): boolean {\n  return target.dispatchEvent(\n    new CustomEvent(name, {\n      bubbles: true,\n      cancelable,\n    }),\n  )\n}\n\n// Submit a form while ensuring that `submit` event is also triggered.\n//\n// Calling native `form.submit()` method immediately submits the form without triggering the `submit` event.\n// As a result, code that wants to hook into form submits would never execute.\n//\n// This method first triggers the `submit` event and, if that event wasn't `preventDefault`d, submits the\n// form natively.\nexport function requestSubmit(form: HTMLFormElement, submitter?: Button) {\n  if (submitter) {\n    checkButtonValidity(form, submitter)\n    persistSubmitButtonValue(submitter)\n  }\n  if (fire(form, 'submit', true)) {\n    form.submit()\n  }\n}\n\n// Check submitter validity for form.requestSubmit compatibility.\n// See https://html.spec.whatwg.org/#dom-form-requestsubmit.\nfunction checkButtonValidity(form: HTMLFormElement, submitter: Button) {\n  if (!(form instanceof HTMLFormElement)) throw new TypeError('The specified element is not of type HTMLFormElement.')\n  if (!(submitter instanceof HTMLElement)) throw new TypeError('The specified element is not of type HTMLElement.')\n  if (submitter.type !== 'submit') throw new TypeError('The specified element is not a submit button.')\n  if (!form || form !== submitter.form) throw new Error('The specified element is not owned by the form element.')\n}\n\n// Set a form field value while ensuring that `change` event is also triggered.\n//\n// Having the `change` event fire is important for various behaviors to react, such as form validation.\nexport function changeValue(input: TextField, value: string | boolean) {\n  if (typeof value === 'boolean') {\n    if (input instanceof HTMLInputElement) {\n      input.checked = value\n    } else {\n      throw new TypeError('only checkboxes can be set to boolean value')\n    }\n  } else {\n    if (input.type === 'checkbox') {\n      throw new TypeError(\"checkbox can't be set to string value\")\n    } else {\n      input.value = value\n    }\n  }\n  fire(input, 'change', false)\n}\n\n// Fill multiple form fields by item name.\nexport function fillFormValues(form: HTMLFormElement, fields: {[key: string]: string}) {\n  for (const name in fields) {\n    const value = fields[name]\n    const element = form.elements.namedItem(name)\n\n    if (element instanceof HTMLInputElement) {\n      element.value = value!\n    } else if (element instanceof HTMLTextAreaElement) {\n      element.value = value!\n    }\n  }\n}\n\n// Test if element is a form field.\nexport function isFormField(element: Node): boolean {\n  if (!(element instanceof HTMLElement)) {\n    return false\n  }\n\n  const name = element.nodeName.toLowerCase()\n  const type = (element.getAttribute('type') || '').toLowerCase()\n  return (\n    name === 'select' ||\n    name === 'textarea' ||\n    (name === 'input' && type !== 'submit' && type !== 'reset') ||\n    element.isContentEditable\n  )\n}\n\nfunction searchParamsFromFormData(formData: FormData): URLSearchParams {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return new URLSearchParams(formData as any)\n}\n\n// Get a `?` search string for a URL for a GET form, using its `action` attribute as well as its other fields.\nexport function combineGetFormSearchParams(formAction: URL, formData: FormData): string {\n  const allSearchParams = new URLSearchParams(formAction.search)\n  const searchParamsFromInputs = searchParamsFromFormData(formData)\n  for (const [key, value] of searchParamsFromInputs) {\n    allSearchParams.append(key, value)\n  }\n  return allSearchParams.toString()\n}\n\n// Serialize form data into string.\nexport function serialize(form: HTMLFormElement): string {\n  return searchParamsFromFormData(new FormData(form)).toString()\n}\n","// Emulates submit button submission values by inserting a hidden input to the form.\n//\n// Submit events can be triggerd in the following ways:\n// - User clicks on a submit button.\n// - User press Enter when focusing on a form field; also known as \"implicit submission\".\n// - Programmatically via requestSubmit helper.\n//\n// On GitHub.com, the submission is either handled by the browser or remoteForm.\n//\n// For submissions triggered by user actions, the name and value of the clicked submit button (also known as\n// \"the submitter\") is passed along in the request, and can be programmatically retrieved with FormData.entries().\n//\n// However, this value will be lost in the following cases:\n// - 1. When the submitter button is disabled, most commonly by [data-disable-with].\n// - 2. When submitting via requestSubmit (from form.js), because the submission does not originated from a submitter.\n// - 3. When submitting with remoteForm, because FormData(form).entries() does not know about the submitter. In Safari\n// the submitter is known during the submission steps, but this behavior is not supported in any other browsers.\n//\n// @see {@link https://github.com/github/form-data-entries/pull/7}.\n//\n// For the exact workarounds, refer to ./form.js and ./remote.js.\nexport function persistSubmitButtonValue(button: HTMLButtonElement | HTMLInputElement) {\n  const form = button.closest('form')\n  if (!(form instanceof HTMLFormElement)) {\n    return\n  }\n\n  let input = findPersistedSubmitButtonValue(form)\n\n  if (button.name) {\n    const defaultValue = button.matches('input[type=submit]') ? 'Submit' : ''\n    const value = button.value || defaultValue\n    if (!input) {\n      input = document.createElement('input')\n      input.type = 'hidden'\n      input.classList.add('js-submit-button-value')\n      form.prepend(input)\n    }\n    input.name = button.name\n    input.value = value\n  } else if (input) {\n    input.remove()\n  }\n}\n\nexport function findPersistedSubmitButtonValue(form: HTMLFormElement): HTMLInputElement | null {\n  const input = form.querySelector('input.js-submit-button-value')\n  return input instanceof HTMLInputElement ? input : null\n}\n","// this file is a shim to allow importing @github/hotkey and is the only allowed import for @github/hotkey\n// eslint-disable-next-line no-restricted-imports\nexport * from '@github/hotkey'\n\n// - (?:^|,)    Starting with the beginning of the string or the comma delineating the previous item\n// - ((?:[^,]|,(?=\\+| |$))*(?:,(?=,))?)    The target capture group, consisting of:\n//   - (?:[^,]|,(?=\\+| |$))*    Any number of characters that are not commas, or are commas that are followed by a\n//     plus sign, space, or end of string (ie, the commas in `,+Control` or `Control+, g` or `Control+,`)\n//   - (?:,(?=,))?    Optionally ending with a comma followed by another comma, like the commas in `Control+,,n` or\n//     `Control+,,,`\n// - (?=,|$)    Ending with a comma or the end of the string\nconst chordOrKeyRegex = /(?:^|,)((?:[^,]|,(?=\\+| |$))*(?:,(?=,))?)/g\n\nexport function splitHotkeyString(hotkey: string) {\n  // \",\" is a valid key name, so we can't just use `String.split()`. Even with a regular expression we can't split, for\n  // example \"Control+,,,\" into [\"Control+,\", \",\"] without a lookbehind (not supported in Safari).\n\n  // Instead, we match against all valid substrings:\n  return Array.from(hotkey.matchAll(chordOrKeyRegex)).map(([, chord]) => chord!)\n}\n","import {eventToHotkeyString} from './hotkey'\n\n/** Returns false if a user has explicitly disabled character key shortcuts. */\nexport const areCharacterKeyShortcutsEnabled = () => {\n  const keyboardShortcutsPreference = document.querySelector<HTMLMetaElement>(\n    'meta[name=keyboard-shortcuts-preference]',\n  )\n  if (keyboardShortcutsPreference) {\n    return keyboardShortcutsPreference.content === 'all'\n  }\n  return true\n}\n\n/**\n * Character-key shortcuts are implemented only with lowercase characters (\"g\", \"g f\"), uppercase characters (\"Shift+A\", \"a\"),\n * symbols (\"Alt+g\"), and punctuation (\"?\", \"!\", \"/\").\n *\n * Returns true if string is NOT what we define as a character key shortcut.\n */\nexport const isNonCharacterKeyShortcut = (hotkey: string) => {\n  return /Enter|Arrow|Escape|Meta|Control|Mod|Esc/.test(hotkey) || (hotkey.includes('Alt') && hotkey.includes('Shift'))\n}\n\nconst nonEditableInputTypes = new Set([\n  'button',\n  'checkbox',\n  'color',\n  'file',\n  'hidden',\n  'image',\n  'radio',\n  'range',\n  'reset',\n  'submit',\n])\n\n/**\n * Returns true if `element` is editable - that is, if it can be focused and typed in like an input or textarea.\n */\nexport function isEditableElement(target: EventTarget | null): boolean {\n  if (!(target instanceof HTMLElement)) return false\n\n  const name = target.nodeName.toLowerCase()\n  const type = target.getAttribute('type')?.toLowerCase() ?? 'text'\n\n  const isReadonly =\n    target.ariaReadOnly === 'true' ||\n    target.getAttribute('aria-readonly') === 'true' ||\n    target.getAttribute('readonly') !== null\n\n  return (\n    (name === 'select' ||\n      name === 'textarea' ||\n      (name === 'input' && !nonEditableInputTypes.has(type)) ||\n      target.isContentEditable) &&\n    !isReadonly\n  )\n}\n\n/**\n * Returns false if a user settings has character key shortcut disabled and keyboard event corresponds to a character\n * key shortcut. Character key shortcuts are never enabled on editable form inputs.\n */\nexport const isShortcutAllowed = (event: KeyboardEvent) => {\n  const hotkey = eventToHotkeyString(event)\n\n  // Never allow character key shortcuts in inputs\n  const allowCharacterKeyShortcuts = areCharacterKeyShortcutsEnabled() && !isEditableElement(event.target)\n\n  return isNonCharacterKeyShortcut(hotkey) || allowCharacterKeyShortcuts\n}\n","import {SOFT_NAV_STATE} from './states'\n\nexport type SoftNavMechanism = 'turbo' | 'react' | 'turbo.frame'\n\nclass SoftNavEvent extends Event {\n  mechanism: SoftNavMechanism\n\n  constructor(mechanism: SoftNavMechanism, type: string) {\n    super(type)\n    this.mechanism = mechanism\n  }\n}\n\nexport class SoftNavStartEvent extends SoftNavEvent {\n  constructor(mechanism: SoftNavMechanism) {\n    super(mechanism, SOFT_NAV_STATE.START)\n  }\n}\n\nexport class SoftNavSuccessEvent extends SoftNavEvent {\n  visitCount: number\n\n  constructor(mechanism: SoftNavMechanism, visitCount: number) {\n    super(mechanism, SOFT_NAV_STATE.SUCCESS)\n    this.visitCount = visitCount\n  }\n}\n\nexport class SoftNavErrorEvent extends SoftNavEvent {\n  error: string\n\n  constructor(mechanism: SoftNavMechanism, error: string) {\n    super(mechanism, SOFT_NAV_STATE.ERROR)\n    this.error = error\n  }\n}\n\nexport class SoftNavEndEvent extends SoftNavEvent {\n  constructor(mechanism: SoftNavMechanism) {\n    super(mechanism, SOFT_NAV_STATE.END)\n  }\n}\n","import {SOFT_NAV_STATE} from './states'\nimport {\n  SoftNavEndEvent,\n  SoftNavErrorEvent,\n  type SoftNavMechanism,\n  SoftNavStartEvent,\n  SoftNavSuccessEvent,\n} from './events'\nimport {markStart, sendFailureStats, sendRenderStats} from './stats'\nimport {\n  clearSoftNav,\n  getSoftNavFailReason,\n  getSoftNavMechanism,\n  setSoftNavMechanism,\n  unsetSoftNav,\n  setSoftNavReferrer,\n  setSoftNavReactAppName,\n  inSoftNav,\n  getCurrentReactAppName,\n  DEFAULT_SOFT_NAV_ERROR_REASON,\n  setLatestMechanism,\n} from './utils'\n\ninterface SoftNavOptions {\n  skipIfGoingToReactApp?: boolean\n  allowedMechanisms?: SoftNavMechanism[]\n}\n\nlet visitCount = 0\n\nexport function initSoftNav() {\n  visitCount = 0\n  document.dispatchEvent(new Event(SOFT_NAV_STATE.INITIAL))\n\n  clearSoftNav()\n}\n\nexport function startSoftNav(mechanism: SoftNavMechanism) {\n  if (inSoftNav()) return\n\n  startProgressBar()\n  document.dispatchEvent(new SoftNavStartEvent(mechanism))\n\n  setSoftNavMechanism(mechanism)\n  setSoftNavReactAppName()\n  setSoftNavReferrer()\n  markStart()\n}\n\nexport function succeedSoftNav(options: SoftNavOptions = {}) {\n  if (!canTriggerEvent(options)) return\n\n  visitCount += 1\n\n  document.dispatchEvent(new SoftNavSuccessEvent(getSoftNavMechanism(), visitCount))\n  endSoftNav(options)\n}\n\nexport function failSoftNav(options: SoftNavOptions = {}) {\n  if (!canTriggerEvent(options)) return\n\n  visitCount = 0\n  const reason = getSoftNavFailReason() || DEFAULT_SOFT_NAV_ERROR_REASON\n  document.dispatchEvent(new SoftNavErrorEvent(getSoftNavMechanism(), reason))\n\n  endProgressBar()\n  sendFailureStats(reason)\n  clearSoftNav()\n}\n\nexport function endSoftNav(options: SoftNavOptions = {}) {\n  if (!canTriggerEvent(options)) return\n\n  const mechanism = getSoftNavMechanism()\n  endProgressBar()\n  document.dispatchEvent(new SoftNavEndEvent(mechanism))\n\n  unsetSoftNav()\n  setLatestMechanism(mechanism)\n}\n\nexport function renderedSoftNav(options: SoftNavOptions = {}) {\n  if (!canTriggerEvent(options)) return\n\n  sendRenderStats()\n  document.dispatchEvent(new Event(SOFT_NAV_STATE.RENDER))\n}\n\nexport function updateFrame() {\n  document.dispatchEvent(new Event(SOFT_NAV_STATE.FRAME_UPDATE))\n}\n\nfunction startProgressBar() {\n  document.dispatchEvent(new Event(SOFT_NAV_STATE.PROGRESS_BAR.START))\n}\n\nfunction endProgressBar() {\n  document.dispatchEvent(new Event(SOFT_NAV_STATE.PROGRESS_BAR.END))\n}\n\nfunction canTriggerEvent({skipIfGoingToReactApp, allowedMechanisms = []}: SoftNavOptions = {}) {\n  return (\n    inSoftNav() &&\n    (allowedMechanisms.length === 0 || allowedMechanisms.includes(getSoftNavMechanism())) &&\n    (!skipIfGoingToReactApp || !getCurrentReactAppName())\n  )\n}\n","export const SOFT_NAV_STATE = Object.freeze({\n  INITIAL: 'soft-nav:initial',\n  START: 'soft-nav:start',\n  SUCCESS: 'soft-nav:success',\n  ERROR: 'soft-nav:error',\n  FRAME_UPDATE: 'soft-nav:frame-update',\n  END: 'soft-nav:end',\n  RENDER: 'soft-nav:render',\n  PROGRESS_BAR: {\n    START: 'soft-nav:progress-bar:start',\n    END: 'soft-nav:progress-bar:end',\n  },\n})\n","import {sendStats} from '@github-ui/stats'\nimport {getCurrentReactAppName, getSoftNavMechanism, getSoftNavReactAppName, getSoftNavReferrer} from './utils'\nimport type {SoftNavMechanism} from './events'\n\nexport const SOFT_NAV_DURATION_MARK = 'stats:soft-nav-duration'\nexport const MECHANISM_MAPPING: Record<SoftNavMechanism | 'ui' | 'hard', PlatformBrowserSoftNavigationMechanism> = {\n  turbo: 'TURBO',\n  react: 'REACT',\n  'turbo.frame': 'FRAME',\n  ui: 'UI',\n  hard: 'HARD',\n}\nexport function markStart() {\n  // browswers only record the first ~150 resources\n  // clearing it here provides room to track additional resources loaded during the soft-nav\n  performance.clearResourceTimings()\n  performance.mark(SOFT_NAV_DURATION_MARK)\n}\n\nfunction getDurationSinceLastSoftNav() {\n  if (performance.getEntriesByName(SOFT_NAV_DURATION_MARK).length === 0) {\n    return null\n  }\n\n  performance.measure(SOFT_NAV_DURATION_MARK, SOFT_NAV_DURATION_MARK)\n  const measures = performance.getEntriesByName(SOFT_NAV_DURATION_MARK)\n  const measure = measures.pop()\n  return measure ? measure.duration : null\n}\n\nexport function sendFailureStats(turboFailureReason: string) {\n  sendStats({\n    turboFailureReason,\n    turboStartUrl: getSoftNavReferrer(),\n    turboEndUrl: window.location.href,\n  })\n}\n\nexport function sendRenderStats() {\n  const duration = getDurationSinceLastSoftNav()\n\n  if (!duration) return\n\n  const mechanism = MECHANISM_MAPPING[getSoftNavMechanism()]\n  const roundedDuration = Math.round(duration)\n\n  if (mechanism === MECHANISM_MAPPING.react)\n    document.dispatchEvent(new CustomEvent('staffbar-update', {detail: {duration: roundedDuration}}))\n\n  sendStats({\n    requestUrl: window.location.href,\n    softNavigationTiming: {\n      mechanism,\n      destination: getCurrentReactAppName() || 'rails',\n      duration: roundedDuration,\n      initiator: getSoftNavReactAppName() || 'rails',\n    },\n  })\n}\n","import {startSoftNav} from '@github-ui/soft-nav/state'\nimport {visit} from '@github/turbo'\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function softNavigate(url: string, turboOptions?: any) {\n  // visit won't fire a `turbo:click` event, so we need to manually start the soft navigation process.\n  startSoftNav('turbo')\n  visit(url, {...turboOptions})\n}\n","// TODO: Research replacing this module with a composable observable library.\n// The scope of this module simply returns a finalized subscription object.\n\n// Lightweight TC39 observable Subscription.\nexport class Subscription {\n  constructor(cleanup: () => void) {\n    this.closed = false\n    this.unsubscribe = () => {\n      cleanup()\n      this.closed = true\n    }\n  }\n\n  // A boolean value indicating whether the subscription is closed.\n  closed: boolean\n  // Cancels the subscription.\n  unsubscribe: () => void\n}\n\n// Create a Subscription from an event.\nexport function fromEvent(\n  target: EventTarget,\n  eventName: string,\n  onNext: EventListenerOrEventListenerObject,\n  options: AddEventListenerOptions = {capture: false},\n): Subscription {\n  target.addEventListener(eventName, onNext, options)\n  return new Subscription(() => {\n    target.removeEventListener(eventName, onNext, options)\n  })\n}\n\n// Combine several subscriptions into a single subscription.\n//\n// subscriptions - A list of subscriptions to combine.\n//\n// Returns a single, combined, subscription.\nexport function compose(...subscriptions: Subscription[]): Subscription {\n  return new Subscription(() => {\n    for (const subscription of subscriptions) {\n      subscription.unsubscribe()\n    }\n  })\n}\n","/**\n * A Fetch function which will automatically add the correct headers for\n * making requests to GitHub application servers as long as the associated controller methods allow it.\n * Track down the associated controller method and confirm the controller includes\n * ApplicationController::VerifiedFetchDependency as well as `allow_verified_fetch only:`\n * to the relevant controller methods.\n *\n * ## Example\n *\n *     const onClick = async () => {\n *       const resp = await verifiedFetch('/foo', {method: 'POST'})\n *       if (resp.ok) console.log('The response was', await resp.text())\ntest.\n *     }\n */\nexport function verifiedFetch(path: string, init: RequestInit = {}): Promise<Response> {\n  assertRelativePathOrSameOrigin(path)\n\n  const headers: HeadersInit = {\n    ...init.headers,\n    'GitHub-Verified-Fetch': 'true',\n    'X-Requested-With': 'XMLHttpRequest',\n  }\n\n  return fetch(path, {...init, headers})\n}\n\nexport interface JSONRequestInit extends Omit<RequestInit, 'body'> {\n  body?: unknown\n}\n\nfunction assertRelativePathOrSameOrigin(path: string) {\n  if (process.env.NODE_ENV === 'test' && !window.location.origin) return\n  const url = new URL(path, window.location.origin)\n  if (url.origin !== window.location.origin) {\n    throw new Error('Can not make cross-origin requests from verifiedFetch')\n  }\n}\n\n/**\n * A Fetch function which will automatically add the correct headers for\n * making JSON requests\n *\n * Will also `JSON.stringify` the request body if provided.\n\n * ## Example\n *\n *     const onClick = async () => {\n *       const resp = await verifiedFetchJSON('/foo', {body: {foo: 'bar'}, method: 'POST'})\n *       if (resp.ok) console.log('The response was', await resp.json())\n *     }\n */\nexport function verifiedFetchJSON(path: string, init?: JSONRequestInit): Promise<Response> {\n  const initHeaders: HeadersInit = init?.headers ?? {}\n\n  const headers: HeadersInit = {\n    ...initHeaders,\n    Accept: 'application/json',\n    'Content-Type': 'application/json',\n  }\n\n  const body = init?.body ? JSON.stringify(init.body) : undefined\n\n  return verifiedFetch(path, {...init, body, headers})\n}\n\n/**\n * A Fetch function which will automatically add the GitHub-Is-React header for\n * making JSON requests. It will in turn call verifiedFetchJSON.\n *\n * Using this in React components to fetch data enables us to track these\n * requests in Datadog in the request.dist.referrer metric.\n */\nexport function reactFetch(path: string, init: RequestInit = {}): Promise<Response> {\n  const headers: HeadersInit = {\n    ...init.headers,\n    'GitHub-Is-React': 'true',\n  }\n\n  return verifiedFetch(path, {...init, headers})\n}\n\n/**\n * A Fetch function which will automatically add the GitHub-Is-React header for\n * making JSON requests. It will in turn call verifiedFetchJSON.\n *\n * Using this in React components to fetch data enables us to track these\n * requests in Datadog in the request.dist.referrer metric.\n */\nexport function reactFetchJSON(path: string, init?: JSONRequestInit): Promise<Response> {\n  const initHeaders: HeadersInit = init?.headers ?? {}\n\n  const headers: HeadersInit = {\n    ...initHeaders,\n    'GitHub-Is-React': 'true',\n  }\n\n  return verifiedFetchJSON(path, {...init, headers})\n}\n","export default class Combobox {\n    constructor(input, list, { tabInsertsSuggestions, firstOptionSelectionMode, scrollIntoViewOptions } = {}) {\n        this.input = input;\n        this.list = list;\n        this.tabInsertsSuggestions = tabInsertsSuggestions !== null && tabInsertsSuggestions !== void 0 ? tabInsertsSuggestions : true;\n        this.firstOptionSelectionMode = firstOptionSelectionMode !== null && firstOptionSelectionMode !== void 0 ? firstOptionSelectionMode : 'none';\n        this.scrollIntoViewOptions = scrollIntoViewOptions !== null && scrollIntoViewOptions !== void 0 ? scrollIntoViewOptions : { block: 'nearest', inline: 'nearest' };\n        this.isComposing = false;\n        if (!list.id) {\n            list.id = `combobox-${Math.random().toString().slice(2, 6)}`;\n        }\n        this.ctrlBindings = !!navigator.userAgent.match(/Macintosh/);\n        this.keyboardEventHandler = event => keyboardBindings(event, this);\n        this.compositionEventHandler = event => trackComposition(event, this);\n        this.inputHandler = this.clearSelection.bind(this);\n        input.setAttribute('role', 'combobox');\n        input.setAttribute('aria-controls', list.id);\n        input.setAttribute('aria-expanded', 'false');\n        input.setAttribute('aria-autocomplete', 'list');\n        input.setAttribute('aria-haspopup', 'listbox');\n    }\n    destroy() {\n        this.clearSelection();\n        this.stop();\n        this.input.removeAttribute('role');\n        this.input.removeAttribute('aria-controls');\n        this.input.removeAttribute('aria-expanded');\n        this.input.removeAttribute('aria-autocomplete');\n        this.input.removeAttribute('aria-haspopup');\n    }\n    start() {\n        this.input.setAttribute('aria-expanded', 'true');\n        this.input.addEventListener('compositionstart', this.compositionEventHandler);\n        this.input.addEventListener('compositionend', this.compositionEventHandler);\n        this.input.addEventListener('input', this.inputHandler);\n        this.input.addEventListener('keydown', this.keyboardEventHandler);\n        this.list.addEventListener('click', commitWithElement);\n        this.resetSelection();\n    }\n    stop() {\n        this.clearSelection();\n        this.input.setAttribute('aria-expanded', 'false');\n        this.input.removeEventListener('compositionstart', this.compositionEventHandler);\n        this.input.removeEventListener('compositionend', this.compositionEventHandler);\n        this.input.removeEventListener('input', this.inputHandler);\n        this.input.removeEventListener('keydown', this.keyboardEventHandler);\n        this.list.removeEventListener('click', commitWithElement);\n    }\n    indicateDefaultOption() {\n        var _a;\n        if (this.firstOptionSelectionMode === 'active') {\n            (_a = Array.from(this.list.querySelectorAll('[role=\"option\"]:not([aria-disabled=\"true\"])'))\n                .filter(visible)[0]) === null || _a === void 0 ? void 0 : _a.setAttribute('data-combobox-option-default', 'true');\n        }\n        else if (this.firstOptionSelectionMode === 'selected') {\n            this.navigate(1);\n        }\n    }\n    navigate(indexDiff = 1) {\n        const focusEl = Array.from(this.list.querySelectorAll('[aria-selected=\"true\"]')).filter(visible)[0];\n        const els = Array.from(this.list.querySelectorAll('[role=\"option\"]')).filter(visible);\n        const focusIndex = els.indexOf(focusEl);\n        if ((focusIndex === els.length - 1 && indexDiff === 1) || (focusIndex === 0 && indexDiff === -1)) {\n            this.clearSelection();\n            this.input.focus();\n            return;\n        }\n        let indexOfItem = indexDiff === 1 ? 0 : els.length - 1;\n        if (focusEl && focusIndex >= 0) {\n            const newIndex = focusIndex + indexDiff;\n            if (newIndex >= 0 && newIndex < els.length)\n                indexOfItem = newIndex;\n        }\n        const target = els[indexOfItem];\n        if (!target)\n            return;\n        for (const el of els) {\n            el.removeAttribute('data-combobox-option-default');\n            if (target === el) {\n                this.input.setAttribute('aria-activedescendant', target.id);\n                target.setAttribute('aria-selected', 'true');\n                fireSelectEvent(target);\n                target.scrollIntoView(this.scrollIntoViewOptions);\n            }\n            else {\n                el.removeAttribute('aria-selected');\n            }\n        }\n    }\n    clearSelection() {\n        this.input.removeAttribute('aria-activedescendant');\n        for (const el of this.list.querySelectorAll('[aria-selected=\"true\"], [data-combobox-option-default=\"true\"]')) {\n            el.removeAttribute('aria-selected');\n            el.removeAttribute('data-combobox-option-default');\n        }\n    }\n    resetSelection() {\n        this.clearSelection();\n        this.indicateDefaultOption();\n    }\n}\nfunction keyboardBindings(event, combobox) {\n    if (event.shiftKey || event.metaKey || event.altKey)\n        return;\n    if (!combobox.ctrlBindings && event.ctrlKey)\n        return;\n    if (combobox.isComposing)\n        return;\n    switch (event.key) {\n        case 'Enter':\n            if (commit(combobox.input, combobox.list)) {\n                event.preventDefault();\n            }\n            break;\n        case 'Tab':\n            if (combobox.tabInsertsSuggestions && commit(combobox.input, combobox.list)) {\n                event.preventDefault();\n            }\n            break;\n        case 'Escape':\n            combobox.clearSelection();\n            break;\n        case 'ArrowDown':\n            combobox.navigate(1);\n            event.preventDefault();\n            break;\n        case 'ArrowUp':\n            combobox.navigate(-1);\n            event.preventDefault();\n            break;\n        case 'n':\n            if (combobox.ctrlBindings && event.ctrlKey) {\n                combobox.navigate(1);\n                event.preventDefault();\n            }\n            break;\n        case 'p':\n            if (combobox.ctrlBindings && event.ctrlKey) {\n                combobox.navigate(-1);\n                event.preventDefault();\n            }\n            break;\n        default:\n            if (event.ctrlKey)\n                break;\n            combobox.resetSelection();\n    }\n}\nfunction commitWithElement(event) {\n    if (!(event.target instanceof Element))\n        return;\n    const target = event.target.closest('[role=\"option\"]');\n    if (!target)\n        return;\n    if (target.getAttribute('aria-disabled') === 'true')\n        return;\n    fireCommitEvent(target, { event });\n}\nfunction commit(input, list) {\n    const target = list.querySelector('[aria-selected=\"true\"], [data-combobox-option-default=\"true\"]');\n    if (!target)\n        return false;\n    if (target.getAttribute('aria-disabled') === 'true')\n        return true;\n    target.click();\n    return true;\n}\nfunction fireCommitEvent(target, detail) {\n    target.dispatchEvent(new CustomEvent('combobox-commit', { bubbles: true, detail }));\n}\nfunction fireSelectEvent(target) {\n    target.dispatchEvent(new Event('combobox-select', { bubbles: true }));\n}\nfunction visible(el) {\n    return (!el.hidden &&\n        !(el instanceof HTMLInputElement && el.type === 'hidden') &&\n        (el.offsetWidth > 0 || el.offsetHeight > 0));\n}\nfunction trackComposition(event, combobox) {\n    combobox.isComposing = event.type === 'compositionstart';\n    const list = document.getElementById(combobox.input.getAttribute('aria-controls') || '');\n    if (!list)\n        return;\n    combobox.clearSelection();\n}\n","class Leaf {\n    constructor(trie) {\n        this.children = [];\n        this.parent = trie;\n    }\n    delete(value) {\n        const index = this.children.indexOf(value);\n        if (index === -1)\n            return false;\n        this.children = this.children.slice(0, index).concat(this.children.slice(index + 1));\n        if (this.children.length === 0) {\n            this.parent.delete(this);\n        }\n        return true;\n    }\n    add(value) {\n        this.children.push(value);\n        return this;\n    }\n}\nclass RadixTrie {\n    constructor(trie) {\n        this.parent = null;\n        this.children = {};\n        this.parent = trie || null;\n    }\n    get(edge) {\n        return this.children[edge];\n    }\n    insert(edges) {\n        let currentNode = this;\n        for (let i = 0; i < edges.length; i += 1) {\n            const edge = edges[i];\n            let nextNode = currentNode.get(edge);\n            if (i === edges.length - 1) {\n                if (nextNode instanceof RadixTrie) {\n                    currentNode.delete(nextNode);\n                    nextNode = null;\n                }\n                if (!nextNode) {\n                    nextNode = new Leaf(currentNode);\n                    currentNode.children[edge] = nextNode;\n                }\n                return nextNode;\n            }\n            else {\n                if (nextNode instanceof Leaf)\n                    nextNode = null;\n                if (!nextNode) {\n                    nextNode = new RadixTrie(currentNode);\n                    currentNode.children[edge] = nextNode;\n                }\n            }\n            currentNode = nextNode;\n        }\n        return currentNode;\n    }\n    delete(node) {\n        for (const edge in this.children) {\n            const currentNode = this.children[edge];\n            if (currentNode === node) {\n                const success = delete this.children[edge];\n                if (Object.keys(this.children).length === 0 && this.parent) {\n                    this.parent.delete(this);\n                }\n                return success;\n            }\n        }\n        return false;\n    }\n}\n\nconst macosSymbolLayerKeys = {\n    ['']: '1',\n    ['']: '2',\n    ['']: '3',\n    ['']: '4',\n    ['']: '5',\n    ['']: '6',\n    ['']: '7',\n    ['']: '8',\n    ['']: '9',\n    ['']: '0',\n    ['']: '-',\n    ['']: '=',\n    ['']: '!',\n    ['']: '@',\n    ['']: '#',\n    ['']: '$',\n    ['']: '%',\n    ['']: '^',\n    ['']: '&',\n    ['']: '*',\n    ['']: '(',\n    ['']: ')',\n    ['']: '_',\n    ['']: '+',\n    ['']: 'q',\n    ['']: 'w',\n    ['']: 'r',\n    ['']: 't',\n    ['']: 'y',\n    ['']: 'o',\n    ['']: 'p',\n    ['']: '[',\n    ['']: ']',\n    ['']: '\\\\',\n    ['']: 'Q',\n    ['']: 'W',\n    ['']: 'E',\n    ['']: 'R',\n    ['']: 'T',\n    ['']: 'Y',\n    ['']: 'U',\n    ['']: 'I',\n    ['']: 'O',\n    ['']: 'P',\n    ['']: '{',\n    ['']: '}',\n    ['']: '|',\n    ['']: 'a',\n    ['']: 's',\n    ['']: 'd',\n    ['']: 'f',\n    ['']: 'g',\n    ['']: 'h',\n    ['']: 'j',\n    ['']: 'k',\n    ['']: 'l',\n    ['']: ';',\n    ['']: \"'\",\n    ['']: 'A',\n    ['']: 'S',\n    ['']: 'D',\n    ['']: 'F',\n    ['']: 'G',\n    ['']: 'H',\n    ['']: 'J',\n    ['']: 'K',\n    ['']: 'L',\n    ['']: ':',\n    ['']: '\"',\n    ['']: 'z',\n    ['']: 'x',\n    ['']: 'c',\n    ['']: 'v',\n    ['']: 'b',\n    ['']: 'm',\n    ['']: ',',\n    ['']: '.',\n    ['']: '/',\n    ['']: 'Z',\n    ['']: 'X',\n    ['']: 'C',\n    ['']: 'V',\n    ['']: 'B',\n    ['']: 'N',\n    ['']: 'M',\n    ['']: '<',\n    ['']: '>',\n    ['']: '?'\n};\n\nconst macosUppercaseLayerKeys = {\n    ['`']: '~',\n    ['1']: '!',\n    ['2']: '@',\n    ['3']: '#',\n    ['4']: '$',\n    ['5']: '%',\n    ['6']: '^',\n    ['7']: '&',\n    ['8']: '*',\n    ['9']: '(',\n    ['0']: ')',\n    ['-']: '_',\n    ['=']: '+',\n    ['[']: '{',\n    [']']: '}',\n    ['\\\\']: '|',\n    [';']: ':',\n    [\"'\"]: '\"',\n    [',']: '<',\n    ['.']: '>',\n    ['/']: '?',\n    ['q']: 'Q',\n    ['w']: 'W',\n    ['e']: 'E',\n    ['r']: 'R',\n    ['t']: 'T',\n    ['y']: 'Y',\n    ['u']: 'U',\n    ['i']: 'I',\n    ['o']: 'O',\n    ['p']: 'P',\n    ['a']: 'A',\n    ['s']: 'S',\n    ['d']: 'D',\n    ['f']: 'F',\n    ['g']: 'G',\n    ['h']: 'H',\n    ['j']: 'J',\n    ['k']: 'K',\n    ['l']: 'L',\n    ['z']: 'Z',\n    ['x']: 'X',\n    ['c']: 'C',\n    ['v']: 'V',\n    ['b']: 'B',\n    ['n']: 'N',\n    ['m']: 'M'\n};\n\nconst syntheticKeyNames = {\n    ' ': 'Space',\n    '+': 'Plus'\n};\nfunction eventToHotkeyString(event, platform = navigator.platform) {\n    var _a, _b, _c;\n    const { ctrlKey, altKey, metaKey, shiftKey, key } = event;\n    const hotkeyString = [];\n    const modifiers = [ctrlKey, altKey, metaKey, shiftKey];\n    for (const [i, mod] of modifiers.entries()) {\n        if (mod)\n            hotkeyString.push(modifierKeyNames[i]);\n    }\n    if (!modifierKeyNames.includes(key)) {\n        const altNormalizedKey = hotkeyString.includes('Alt') && matchApplePlatform.test(platform) ? (_a = macosSymbolLayerKeys[key]) !== null && _a !== void 0 ? _a : key : key;\n        const shiftNormalizedKey = hotkeyString.includes('Shift') && matchApplePlatform.test(platform)\n            ? (_b = macosUppercaseLayerKeys[altNormalizedKey]) !== null && _b !== void 0 ? _b : altNormalizedKey\n            : altNormalizedKey;\n        const syntheticKey = (_c = syntheticKeyNames[shiftNormalizedKey]) !== null && _c !== void 0 ? _c : shiftNormalizedKey;\n        hotkeyString.push(syntheticKey);\n    }\n    return hotkeyString.join('+');\n}\nconst modifierKeyNames = ['Control', 'Alt', 'Meta', 'Shift'];\nfunction normalizeHotkey(hotkey, platform) {\n    let result;\n    result = localizeMod(hotkey, platform);\n    result = sortModifiers(result);\n    return result;\n}\nconst matchApplePlatform = /Mac|iPod|iPhone|iPad/i;\nfunction localizeMod(hotkey, platform) {\n    var _a;\n    const ssrSafeWindow = typeof window === 'undefined' ? undefined : window;\n    const safePlatform = (_a = platform !== null && platform !== void 0 ? platform : ssrSafeWindow === null || ssrSafeWindow === void 0 ? void 0 : ssrSafeWindow.navigator.platform) !== null && _a !== void 0 ? _a : '';\n    const localModifier = matchApplePlatform.test(safePlatform) ? 'Meta' : 'Control';\n    return hotkey.replace('Mod', localModifier);\n}\nfunction sortModifiers(hotkey) {\n    const key = hotkey.split('+').pop();\n    const modifiers = [];\n    for (const modifier of ['Control', 'Alt', 'Meta', 'Shift']) {\n        if (hotkey.includes(modifier)) {\n            modifiers.push(modifier);\n        }\n    }\n    if (key)\n        modifiers.push(key);\n    return modifiers.join('+');\n}\n\nconst SEQUENCE_DELIMITER = ' ';\nclass SequenceTracker {\n    constructor({ onReset } = {}) {\n        this._path = [];\n        this.timer = null;\n        this.onReset = onReset;\n    }\n    get path() {\n        return this._path;\n    }\n    get sequence() {\n        return this._path.join(SEQUENCE_DELIMITER);\n    }\n    registerKeypress(event) {\n        this._path = [...this._path, eventToHotkeyString(event)];\n        this.startTimer();\n    }\n    reset() {\n        var _a;\n        this.killTimer();\n        this._path = [];\n        (_a = this.onReset) === null || _a === void 0 ? void 0 : _a.call(this);\n    }\n    killTimer() {\n        if (this.timer != null) {\n            window.clearTimeout(this.timer);\n        }\n        this.timer = null;\n    }\n    startTimer() {\n        this.killTimer();\n        this.timer = window.setTimeout(() => this.reset(), SequenceTracker.CHORD_TIMEOUT);\n    }\n}\nSequenceTracker.CHORD_TIMEOUT = 1500;\nfunction normalizeSequence(sequence) {\n    return sequence\n        .split(SEQUENCE_DELIMITER)\n        .map(h => normalizeHotkey(h))\n        .join(SEQUENCE_DELIMITER);\n}\n\nfunction isFormField(element) {\n    if (!(element instanceof HTMLElement)) {\n        return false;\n    }\n    const name = element.nodeName.toLowerCase();\n    const type = (element.getAttribute('type') || '').toLowerCase();\n    return (name === 'select' ||\n        name === 'textarea' ||\n        (name === 'input' &&\n            type !== 'submit' &&\n            type !== 'reset' &&\n            type !== 'checkbox' &&\n            type !== 'radio' &&\n            type !== 'file') ||\n        element.isContentEditable);\n}\nfunction fireDeterminedAction(el, path) {\n    const delegateEvent = new CustomEvent('hotkey-fire', { cancelable: true, detail: { path } });\n    const cancelled = !el.dispatchEvent(delegateEvent);\n    if (cancelled)\n        return;\n    if (isFormField(el)) {\n        el.focus();\n    }\n    else {\n        el.click();\n    }\n}\nfunction expandHotkeyToEdges(hotkey) {\n    const output = [];\n    let acc = [''];\n    let commaIsSeparator = false;\n    for (let i = 0; i < hotkey.length; i++) {\n        if (commaIsSeparator && hotkey[i] === ',') {\n            output.push(acc);\n            acc = [''];\n            commaIsSeparator = false;\n            continue;\n        }\n        if (hotkey[i] === SEQUENCE_DELIMITER) {\n            acc.push('');\n            commaIsSeparator = false;\n            continue;\n        }\n        else if (hotkey[i] === '+') {\n            commaIsSeparator = false;\n        }\n        else {\n            commaIsSeparator = true;\n        }\n        acc[acc.length - 1] += hotkey[i];\n    }\n    output.push(acc);\n    return output.map(h => h.map(k => normalizeHotkey(k)).filter(k => k !== '')).filter(h => h.length > 0);\n}\n\nconst hotkeyRadixTrie = new RadixTrie();\nconst elementsLeaves = new WeakMap();\nlet currentTriePosition = hotkeyRadixTrie;\nconst sequenceTracker = new SequenceTracker({\n    onReset() {\n        currentTriePosition = hotkeyRadixTrie;\n    }\n});\nfunction keyDownHandler(event) {\n    if (event.defaultPrevented)\n        return;\n    if (!(event.target instanceof Node))\n        return;\n    if (isFormField(event.target)) {\n        const target = event.target;\n        if (!target.id)\n            return;\n        if (!target.ownerDocument.querySelector(`[data-hotkey-scope=\"${target.id}\"]`))\n            return;\n    }\n    const newTriePosition = currentTriePosition.get(eventToHotkeyString(event));\n    if (!newTriePosition) {\n        sequenceTracker.reset();\n        return;\n    }\n    sequenceTracker.registerKeypress(event);\n    currentTriePosition = newTriePosition;\n    if (newTriePosition instanceof Leaf) {\n        const target = event.target;\n        let shouldFire = false;\n        let elementToFire;\n        const formField = isFormField(target);\n        for (let i = newTriePosition.children.length - 1; i >= 0; i -= 1) {\n            elementToFire = newTriePosition.children[i];\n            const scope = elementToFire.getAttribute('data-hotkey-scope');\n            if ((!formField && !scope) || (formField && target.id === scope)) {\n                shouldFire = true;\n                break;\n            }\n        }\n        if (elementToFire && shouldFire) {\n            fireDeterminedAction(elementToFire, sequenceTracker.path);\n            event.preventDefault();\n        }\n        sequenceTracker.reset();\n    }\n}\nfunction install(element, hotkey) {\n    if (Object.keys(hotkeyRadixTrie.children).length === 0) {\n        document.addEventListener('keydown', keyDownHandler);\n    }\n    const hotkeys = expandHotkeyToEdges(hotkey || element.getAttribute('data-hotkey') || '');\n    const leaves = hotkeys.map(h => hotkeyRadixTrie.insert(h).add(element));\n    elementsLeaves.set(element, leaves);\n}\nfunction uninstall(element) {\n    const leaves = elementsLeaves.get(element);\n    if (leaves && leaves.length) {\n        for (const leaf of leaves) {\n            leaf && leaf.delete(element);\n        }\n    }\n    if (Object.keys(hotkeyRadixTrie.children).length === 0) {\n        document.removeEventListener('keydown', keyDownHandler);\n    }\n}\n\nexport { Leaf, RadixTrie, SequenceTracker, eventToHotkeyString, install, normalizeHotkey, normalizeSequence, uninstall };\n"],"names":["experimentsLocalStorageKey","experimentsDebugScoringKey","getBlackbirdExperiments","experiments","safeStorage","getItem","split","setBlackbirdExperiments","setItem","join","debugScoringInfoEnabled","enabled","setDebugScoringInfoEnabled","removeItem","isQualifier","node","qualifier","isSavedQualifier","containsQualifier","qualifierKind","hasChildren","child","children","CaretPositionKind","slashRegex","shouldRedirectInsteadOfSearch","path","isContentNode","content","value","toString","matchAll","length","startsWith","redirectURL","map","encodeURIComponent","undefined","extractTextQuery","filter","x","kind","extractRepoOrgScopes","flat","restrictToScopedOrgs","orgs","repoOrgScopes","Set","scope","includes","s","toLowerCase","size","org","has","safeLocalStorage","HistoryProvider","EventTarget","handleEvent","event","state","parsedMetadata","caretPositionKind","Text","query","suggestions","JSON","parse","trimmedQuery","trim","seen","item","suggestionCount","suggestion","historyQuery","dispatchEvent","SearchItem","icon","Octicon","Search","priority","action","url","constructor","queryBuilder","name","singularItemName","type","addEventListener","PopularLanguages","color","LanguagesProvider","Language","term","caretSelectedNode","slice","r","toUpperCase","fuzzyQuery","replace","filterSort","score","fuzzyScore","text","compare","rewriteStart","location","end","rewriteEnd","start","quotedName","newQuery","FilterItem","replaceQueryWith","moveCaretTo","manuallyDetermineFilterEligibility","document","createElement","tmpl","html","renderInto","innerHTML","ReposProviderBase","getMatchingRepositories","scopedOrgs","ast","scopes","isScopedToRepository","push","Repository","suggestedRepos","getSuggestions","input","matches","find","o","ReposFilterProvider","hasFocus","Owner","Repo","ReposSearchProvider","CustomScopeCache","set","cache","filled","get","len","clear","SavedScopeProvider","fetchSuggestions","data","customScopesUrl","response","fetch","method","mode","headers","Accept","ok","json","replaceCustomScopesCache","Saved","String","customScopesCache","endsWith","queryStart","queryEnd","trimEnd","Bookmark","PlusCircle","commandName","OwnersProvider","suggestedOwners","FixedValuesProvider","OtherQualifier","Is","parsing","isLicense","isLanguage","getPossibleQualifierValues","chooseSearchType","t","quotedValue","Circle","TeamsProvider","suggestedTeams","team","Team","ProjectsProvider","suggestedProjects","p","Project","BlackbirdProvider","result","fetchData","FetchDataEvent","suggestionsEmitted","trailingSlashPos","lastIndexOf","filename","substring","truncatePath","repoPrefix","repository_nwo","separator","encodedPath","FileCode","description","commit_sha","line_number","SymbolKind","symbol","fully_qualified_name","prefixText","fullName","prefixColor","prefixColorForSymbolKind","plColor","PrefixColor","Entity","Constant","Keyword","Variable","Path","getAttribute","urlParams","URLSearchParams","saved_searches","stringify","customScopes","failed","InputProvider","orgNode","rawQuery","isFallbackSuggestion","repo","user","parser","astNode","parseString","qualifierNodes","raw","containsScopes","unshift","getPathQualifier","pathname","m","treeRegex","exec","i","buildRegexQuery","decodeURIComponent","escaped","replaceAll","window","getQualifierType","copilotChatEnabled","InitialExplorePages","title","octicon","ExplorePages","ExploreProvider","isHomePagePath","isMarketingPagePath","some","page","addDefaultSuggestions","querySuggestions","fetchQuerySuggestions","defaultSuggestions","Promise","resolve","fetchDefaultSuggestions","DEFAULT_NL_SEARCH_QUERY","CopilotProvider","fetchIndexStatusPromise","token","fetchUrl","URL","origin","href","primerSpinner","Copilot","repoNwo","naturalLanugageSearchEnabled","id","queryCopilotSearchDebounced","abortController","AbortController","queryCopilotSearch","nlSearchToken","copilotAuthTokenProvider","getAuthToken","abort","verifiedFetchJSON","body","signal","isUpdate","CopilotError","e","Error","debounce","CopilotAuthTokenProvider","nonBreakingSpace","fromCharCode","PLACEHOLDER_SAFE_HTML","marketing_pages_search_explore_provider_enabled","isFeatureEnabled","QbsearchInputElement","HTMLElement","placeholderText","v","parseQuery","setButtonText","parseSearchInputRaw","syncRichButtonText","flattenASTForQueryBuilder","ir","highlights","getHighlights","sort","a","b","pos","output","highlight","style","TextElementStyle","Normal","className","FilterValue","isRetainScrollPosition","isLoggedIn","connectedCallback","isReactContext","customScopesUrlPath","customScopesSuggestionProvider","customElements","whenDefined","customScopesManager","initialize","customScopeManagerInitialized","eventAbortController","feedbackDialog","HTMLDialogElement","showModal","show","globalNavVisibility","detail","setGlobalNavVisibility","setGlobalBarAlwaysExpanded","globalNavAlwaysHidden","classList","add","remove","CustomEvent","appendQuery","retainScrollPosition","returnTarget","expandAndRetainScrollPosition","expand","returnFocusElement","loadParser","moveCaretToEndOfInput","saveQueryAsCustomScope","loggedInProviders","loggedOutProviders","providers","parentElement","search","retract","inputSubmit","preventDefault","openManageCustomScopesDialog","anchInfo","parseFileAnchor","hash","blobRange","line","SearchCopilotEvent","sendEvent","logPageView","placeholder","inputButton","inputButtonText","textContent","flatten","segments","el","span","replaceChildren","newText","disconnectedCallback","getSuggestionInputState","findCustomScopesNeededForSearch","selectedNode","visible","globalNav","querySelector","mediaQuery","matchMedia","hidden","alwaysExpanded","headerRedesignEnabled","globalBar","setGlobalBarModalOpen","modalOpen","searchInputContainerClicked","target","contains","updateQueryBuilderVisibility","queryBuilderContainer","darkBackdrop","trigger","scrollY","top","handleExpand","possiblyWarmCaches","scrollTo","searchSuggestionsDialog","inputFocus","inputChange","element","cachesHaveBeenWarmed","mapURLParamToSearchType","openInNewWindow","searchType","mapSearchTypeToURLParam","softNavigate","searchParams","l","getExpandedQuery","typeParam","expandedQuery","experimentsParam","open","setLocalHistory","localStorage","MAX_LOCAL_HISTORY","handleChange","parseSearchInput","parsingPromise","now","Date","lastParseTime","waitingToParse","setTimeout","parseDelay","lastParsedQuery","caretData","getCaretPositionKindFromIndex","handleSubmit","editCustomScope","newCustomScope","create","stopPropagation","dialogFocusReturn","handleDialogClose","focus","showFeedbackDialog","submitFeedback","form","FormData","close","caretPosition","bind","handleClose","customScopesFromUrl","customScopeNames","getCustomScopeNames","Array","isArray","customScopesNeededForSearch","customScopeName","customScope","attr","controller","Event","bubbles","cancelable","CodeNavigationInfo","initCodeSections","Map","lineToSectionMap","symbols","lineNumber","extent","section","startLine","endLine","index","collapsed","level","depth","tempArray","j","codeSections","initSymbols","outlineSymbol","snippet","blobLines","ident_utf16","codeSymbol","outlineSymbolToCodeSymbol","stylingDirectives","refInfo","lineIndexedSymbols","getBlobLine","getSymbolOnLine","initSymbolTree","tempParents","symbolTree","symbolB","symbolA","column","pop","setSymbolDepth","nextSymbol","symbolChildren","buildSymbolTreeChildren","currentIndex","tempSymbol","tempChildren","determineTotalNumberOfChildren","isParent","createReferences","match","reference","CodeReference","ident","isPlain","source","SymbolSource","BLOB_CONTENT","setSnippet","getReferencesToSymbol","symbolName","ranges","searchInBlobContent","symbolMatchable","getReferencesToSearch","textMatchable","getDefinitionsAndReferences","row","setLoading","defs","selectedSymbol","definitions","backend","getAlephDefinitions","loggedIn","localDefinitions","getLocalDefinitions","localDefinition","d","localDefinitionsForKindFallback","definition","localRefs","definitionLines","references","alephRefs","symbolKind","sym","enumStringVal","getAlephReferences","localReferences","crossReferences","getSymbolKind","bestRank","rank","resultDetails","definitionsUrl","codeNavigationPath","q","language","ref","codeNavContext","parseAlephBackendType","payload","flatMap","refs","alephSymbol","alephSymbolToCodeSymbol","referencesUrl","partialResponse","observedLines","isCheckedLine","reduce","results","alephSymbolToCodeReference","rawLines","fromAleph","total","currNode","lines","getMatchGenerator","next","done","columnEnd","searchInBlobIncrementally","codeRefs","matchable","startedAtResultLimit","checkedLine","searchResults","startFromLine","matchesInRawBlob","convertBlackbirdSymbolKind","enumVal","shortName","symbolKindShortName","symbolKindColor","class","struct","enum","interface","trait","module","implementation","function","call","field","CodeSymbol","setFileInfo","highlightedText","bodyText","leadingWhitespace","commitish","defaultBranch","currentOid","blobPath","owner","ownerLogin","filePath","pathKey","fullyQualifiedName","blame","params","plain","blamePath","regexp","regex","matchContent","test","MatchableType","extent_utf16","extentUtf16","identUtf16","utf16_col","BLACKBIRD_ANALYSIS","symbolStartIdx","character","symbolEndIdx","extentStartIdx","extentEndIdx","BLACKBIRD_SEARCH","ALEPH_PRECISE","local","commitOid","symbolRefInfo","listCacheKey","canEdit","firstLineWithWhiteSpace","whiteSpace","fill","firstLine","symbolPath","identStartSymbolIdx","identEndSymbolIdx","codeReference","AuthToken","authorizationHeaderValue","needsRefreshing","ssoOrgIds","isExpired","ssoChanged","expirationDateString","expiration","expirationDate","UTC","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","ssoOrgIDs","every","fromResult","orgIds","serialize","deserialize","serialized","COPILOT_AUTH_TOKEN_KEY","getLocalStorageAuthToken","validateAuthToken","fetchAuthToken","setLocalStorageAuthToken","copilotLocalStorage","currentAuthTokenRequest","_fetchAuthToken","throwQuotaErrorsOnSet","ttl","fire","requestSubmit","submitter","checkButtonValidity","HTMLFormElement","persistSubmitButtonValue","submit","changeValue","HTMLInputElement","checked","fillFormValues","fields","elements","namedItem","HTMLTextAreaElement","isFormField","nodeName","isContentEditable","searchParamsFromFormData","formData","combineGetFormSearchParams","formAction","allSearchParams","key","append","button","closest","findPersistedSubmitButtonValue","defaultValue","prepend","chordOrKeyRegex","splitHotkeyString","hotkey","from","chord","areCharacterKeyShortcutsEnabled","keyboardShortcutsPreference","isNonCharacterKeyShortcut","nonEditableInputTypes","isShortcutAllowed","eventToHotkeyString","allowCharacterKeyShortcuts","isEditableElement","isReadonly","ariaReadOnly","SoftNavEvent","mechanism","SoftNavStartEvent","SOFT_NAV_STATE","START","SoftNavSuccessEvent","visitCount","SUCCESS","SoftNavErrorEvent","error","ERROR","SoftNavEndEvent","END","initSoftNav","INITIAL","clearSoftNav","startSoftNav","inSoftNav","PROGRESS_BAR","setSoftNavMechanism","setSoftNavReactAppName","setSoftNavReferrer","markStart","succeedSoftNav","options","canTriggerEvent","getSoftNavMechanism","endSoftNav","failSoftNav","reason","getSoftNavFailReason","DEFAULT_SOFT_NAV_ERROR_REASON","endProgressBar","sendFailureStats","unsetSoftNav","setLatestMechanism","renderedSoftNav","sendRenderStats","RENDER","updateFrame","FRAME_UPDATE","skipIfGoingToReactApp","allowedMechanisms","getCurrentReactAppName","Object","freeze","SOFT_NAV_DURATION_MARK","MECHANISM_MAPPING","turbo","react","ui","hard","performance","clearResourceTimings","mark","turboFailureReason","sendStats","turboStartUrl","getSoftNavReferrer","turboEndUrl","duration","getDurationSinceLastSoftNav","getEntriesByName","measure","measures","roundedDuration","Math","round","requestUrl","softNavigationTiming","destination","initiator","getSoftNavReactAppName","turboOptions","visit","Subscription","cleanup","closed","unsubscribe","fromEvent","eventName","onNext","capture","removeEventListener","compose","subscriptions","subscription","verifiedFetch","init","assertRelativePathOrSameOrigin","reactFetch","reactFetchJSON","Combobox","list","tabInsertsSuggestions","firstOptionSelectionMode","scrollIntoViewOptions","block","inline","isComposing","random","ctrlBindings","navigator","userAgent","keyboardEventHandler","keyboardBindings","combobox","shiftKey","metaKey","altKey","ctrlKey","commit","clearSelection","navigate","resetSelection","compositionEventHandler","trackComposition","getElementById","inputHandler","setAttribute","destroy","stop","removeAttribute","commitWithElement","indicateDefaultOption","_a","querySelectorAll","indexDiff","focusEl","els","focusIndex","indexOf","indexOfItem","newIndex","fireSelectEvent","scrollIntoView","Element","fireCommitEvent","click","offsetWidth","offsetHeight","Leaf","trie","parent","delete","concat","RadixTrie","edge","insert","edges","currentNode","nextNode","success","keys","macosSymbolLayerKeys","macosUppercaseLayerKeys","syntheticKeyNames","platform","_b","_c","hotkeyString","mod","modifiers","entries","modifierKeyNames","altNormalizedKey","matchApplePlatform","shiftNormalizedKey","syntheticKey","normalizeHotkey","sortModifiers","modifier","localizeMod","ssrSafeWindow","localModifier","SequenceTracker","onReset","_path","timer","sequence","registerKeypress","startTimer","reset","killTimer","clearTimeout","CHORD_TIMEOUT","normalizeSequence","h","hotkeyRadixTrie","elementsLeaves","WeakMap","currentTriePosition","sequenceTracker","keyDownHandler","defaultPrevented","Node","ownerDocument","newTriePosition","elementToFire","shouldFire","formField","fireDeterminedAction","delegateEvent","install","leaves","hotkeys","acc","commaIsSeparator","k","uninstall","leaf"],"sourceRoot":""}