# generated by turbocassette ts/cassettes/sessions/codescanningseed_test.go
---
http_interactions:
  - request:
      method: post
      uri: http://localhost:8888/twirp/github.turboscan.Results/GetAnalysisSarif
      body:
        encoding: UTF-8
        string: |-
          {
            "alertsApiUrl": "https://api.github.com/repos/github/turboscan/code-scanning/alerts",
            "analysisId": "1",
            "repoHtmlUrl": "https://github.com/github/turboscan",
            "repositoryId": "351"
          }
      headers:
        Accept:
          - '*/*'
        Accept-Encoding:
          - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
        Content-Type:
          - application/json
    response:
      status:
        code: 200
        message: null
      headers:
        Content-Length:
          - "15061"
        Content-Type:
          - application/json
      body:
        encoding: UTF-8
        string: |-
          {
            "sarif": "{\"runs\":[{\"artifacts\":[{\"location\":{\"index\":0,\"uri\":\"generated.c\"}},{\"location\":{\"index\":1,\"uri\":\"path_query/ResponseUtil.ts\"}},{\"location\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"}},{\"location\":{\"index\":3,\"uri\":\"helloworld.c\"}},{\"location\":{\"index\":4,\"uri\":\"unreachable.py\"}},{\"location\":{\"index\":5,\"uri\":\"example.py\"}},{\"location\":{\"index\":6,\"uri\":\"multiline_alert/multiline_alert.js\"}}],\"automationDetails\":{\"id\":\".github/workflows/w1.yml:job1/\"},\"conversion\":{\"tool\":{\"driver\":{\"name\":\"GitHub Code Scanning\"}}},\"results\":[{\"correlationGuid\":\"11111111-2222-3333-4444-000000000000\",\"guid\":\"2b6151de-1a37-14d0-b170-828fa7d0af20\",\"level\":\"warning\",\"locations\":[{\"physicalLocation\":{\"artifactLocation\":{\"index\":0,\"uri\":\"generated.c\"},\"region\":{\"endColumn\":13,\"endLine\":10,\"startColumn\":8,\"startLine\":10}}}],\"message\":{\"text\":\"Comparison is always false because i \\u003c= 0.\"},\"partialFingerprints\":{\"primaryLocationLineHash\":\"206907dbab5ab5f7:1\"},\"properties\":{\"github/alertNumber\":1,\"github/alertUrl\":\"https://api.github.com/repos/github/turboscan/code-scanning/alerts/1\"},\"rule\":{\"id\":\"cpp/constant-comparison\",\"index\":1},\"ruleId\":\"cpp/constant-comparison\"},{\"codeFlows\":[{\"threadFlows\":[{\"locations\":[{\"location\":{\"message\":{\"text\":\"req.url\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":36,\"endLine\":22,\"startColumn\":29,\"startLine\":22}}}},{\"location\":{\"message\":{\"text\":\"req.url ... ') + 1)\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":72,\"endLine\":22,\"startColumn\":29,\"startLine\":22}}}},{\"location\":{\"message\":{\"text\":\"parse(r ... ) + 1))\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":73,\"endLine\":22,\"startColumn\":23,\"startLine\":22}}}},{\"location\":{\"message\":{\"text\":\"query\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":73,\"endLine\":22,\"startColumn\":15,\"startLine\":22}}}},{\"location\":{\"message\":{\"text\":\"query\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":28,\"endLine\":23,\"startColumn\":23,\"startLine\":23}}}},{\"location\":{\"message\":{\"text\":\"query.redirectTo\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":39,\"endLine\":23,\"startColumn\":23,\"startLine\":23}}}},{\"location\":{\"message\":{\"text\":\"query.r ... tring()\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":70,\"endLine\":23,\"startColumn\":23,\"startLine\":23}}}},{\"location\":{\"message\":{\"text\":\"redirectURL\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":70,\"endLine\":23,\"startColumn\":9,\"startLine\":23}}}},{\"location\":{\"message\":{\"text\":\"redirectURL\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":40,\"endLine\":30,\"startColumn\":29,\"startLine\":30}}}},{\"location\":{\"message\":{\"text\":\"url\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":1,\"uri\":\"path_query/ResponseUtil.ts\"},\"region\":{\"endColumn\":53,\"endLine\":101,\"startColumn\":50,\"startLine\":101}}}},{\"location\":{\"message\":{\"text\":\"url\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":1,\"uri\":\"path_query/ResponseUtil.ts\"},\"region\":{\"endColumn\":34,\"endLine\":104,\"startColumn\":31,\"startLine\":104}}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"message\":{\"text\":\"req.url\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":36,\"endLine\":22,\"startColumn\":29,\"startLine\":22}}}},{\"location\":{\"message\":{\"text\":\"req.url ... ') + 1)\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":72,\"endLine\":22,\"startColumn\":29,\"startLine\":22}}}},{\"location\":{\"message\":{\"text\":\"parse(r ... ) + 1))\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":73,\"endLine\":22,\"startColumn\":23,\"startLine\":22}}}},{\"location\":{\"message\":{\"text\":\"query\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":73,\"endLine\":22,\"startColumn\":15,\"startLine\":22}}}},{\"location\":{\"message\":{\"text\":\"query\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":48,\"endLine\":23,\"startColumn\":43,\"startLine\":23}}}},{\"location\":{\"message\":{\"text\":\"query.redirectTo\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":59,\"endLine\":23,\"startColumn\":43,\"startLine\":23}}}},{\"location\":{\"message\":{\"text\":\"query.r ... tring()\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":70,\"endLine\":23,\"startColumn\":43,\"startLine\":23}}}},{\"location\":{\"message\":{\"text\":\"query.r ... tring()\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":70,\"endLine\":23,\"startColumn\":23,\"startLine\":23}}}},{\"location\":{\"message\":{\"text\":\"redirectURL\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":70,\"endLine\":23,\"startColumn\":9,\"startLine\":23}}}},{\"location\":{\"message\":{\"text\":\"redirectURL\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":2,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":40,\"endLine\":30,\"startColumn\":29,\"startLine\":30}}}},{\"location\":{\"message\":{\"text\":\"url\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":1,\"uri\":\"path_query/ResponseUtil.ts\"},\"region\":{\"endColumn\":53,\"endLine\":101,\"startColumn\":50,\"startLine\":101}}}},{\"location\":{\"message\":{\"text\":\"url\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":1,\"uri\":\"path_query/ResponseUtil.ts\"},\"region\":{\"endColumn\":34,\"endLine\":104,\"startColumn\":31,\"startLine\":104}}}}]}]}],\"correlationGuid\":\"11111111-2222-3333-4444-000000000000\",\"guid\":\"84ff53e5-cb58-1607-a983-69c9b6e7ef68\",\"level\":\"warning\",\"locations\":[{\"physicalLocation\":{\"artifactLocation\":{\"index\":1,\"uri\":\"path_query/ResponseUtil.ts\"},\"region\":{\"endColumn\":34,\"endLine\":104,\"startColumn\":31,\"startLine\":104}}}],\"message\":{\"text\":\"Untrusted URL redirection due to [user-provided value](1).\"},\"partialFingerprints\":{\"primaryLocationLineHash\":\"3f545ed3a05fe18c:1\"},\"properties\":{\"github/alertNumber\":2,\"github/alertUrl\":\"https://api.github.com/repos/github/turboscan/code-scanning/alerts/2\"},\"relatedLocations\":[{\"id\":1,\"message\":{\"text\":\"user-provided value\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":0,\"uri\":\"path_query/LogoutRoute.ts\"},\"region\":{\"endColumn\":36,\"endLine\":22,\"startColumn\":29,\"startLine\":22}}}],\"rule\":{\"id\":\"js/server-side-unvalidated-url-redirection\",\"index\":2},\"ruleId\":\"js/server-side-unvalidated-url-redirection\"},{\"correlationGuid\":\"11111111-2222-3333-4444-000000000000\",\"guid\":\"c057fbe5-8b9f-1343-bad2-dcdef625c04b\",\"level\":\"warning\",\"locations\":[{\"physicalLocation\":{\"artifactLocation\":{\"index\":3,\"uri\":\"helloworld.c\"},\"region\":{\"endColumn\":13,\"endLine\":10,\"startColumn\":8,\"startLine\":10}}}],\"message\":{\"text\":\"Comparison is always false because i \\u003c= 0.\"},\"partialFingerprints\":{\"primaryLocationLineHash\":\"206907dbab5ab5f7:1\"},\"properties\":{\"github/alertNumber\":3,\"github/alertUrl\":\"https://api.github.com/repos/github/turboscan/code-scanning/alerts/3\"},\"rule\":{\"id\":\"cpp/constant-comparison\",\"index\":1},\"ruleId\":\"cpp/constant-comparison\"},{\"correlationGuid\":\"11111111-2222-3333-4444-000000000000\",\"guid\":\"fc6a59e2-8d79-1367-8c26-4a837cde7c79\",\"level\":\"warning\",\"locations\":[{\"physicalLocation\":{\"artifactLocation\":{\"index\":4,\"uri\":\"unreachable.py\"},\"region\":{\"endLine\":6,\"startColumn\":5,\"startLine\":6}}}],\"message\":{\"text\":\"Unreachable statement.\"},\"partialFingerprints\":{\"primaryLocationLineHash\":\"2ddbb6e7b44fbb08:1\"},\"properties\":{\"github/alertNumber\":4,\"github/alertUrl\":\"https://api.github.com/repos/github/turboscan/code-scanning/alerts/4\"},\"rule\":{\"id\":\"py/unreachable-statement\",\"index\":3},\"ruleId\":\"py/unreachable-statement\"},{\"correlationGuid\":\"11111111-2222-3333-4444-000000000000\",\"level\":\"warning\",\"locations\":[{\"physicalLocation\":{\"artifactLocation\":{\"index\":5,\"uri\":\"example.py\"},\"region\":{\"endColumn\":10,\"endLine\":4,\"startColumn\":1,\"startLine\":4}}}],\"message\":{\"text\":\"Import of 're' is not used.\"},\"partialFingerprints\":{\"primaryLocationLineHash\":\"49521ce3aaa41f86:1\"},\"properties\":{\"github/alertNumber\":5,\"github/alertUrl\":\"https://api.github.com/repos/github/turboscan/code-scanning/alerts/5\"},\"rule\":{\"id\":\"py/unused-import\",\"index\":4},\"ruleId\":\"py/unused-import\"},{\"correlationGuid\":\"11111111-2222-3333-4444-000000000000\",\"level\":\"warning\",\"locations\":[{\"physicalLocation\":{\"artifactLocation\":{\"index\":5,\"uri\":\"example.py\"},\"region\":{\"endColumn\":16,\"endLine\":14,\"startColumn\":1,\"startLine\":14}}}],\"message\":{\"text\":\"Import of 're' is not used.\"},\"partialFingerprints\":{\"primaryLocationLineHash\":\"49521ce3aaa41a86:1\"},\"properties\":{\"github/alertNumber\":6,\"github/alertUrl\":\"https://api.github.com/repos/github/turboscan/code-scanning/alerts/6\"},\"rule\":{\"id\":\"py/unused-import\",\"index\":4},\"ruleId\":\"py/unused-import\"},{\"correlationGuid\":\"11111111-2222-3333-4444-000000000000\",\"level\":\"warning\",\"locations\":[{\"physicalLocation\":{\"artifactLocation\":{\"index\":5,\"uri\":\"example.py\"},\"region\":{\"endColumn\":14,\"endLine\":5,\"startColumn\":1,\"startLine\":5}}}],\"message\":{\"text\":\"Import of 'foobar' is not used.\"},\"partialFingerprints\":{\"primaryLocationLineHash\":\"3a2eed3837b30b46:1\"},\"properties\":{\"github/alertNumber\":7,\"github/alertUrl\":\"https://api.github.com/repos/github/turboscan/code-scanning/alerts/7\"},\"rule\":{\"id\":\"py/unused-import\",\"index\":4},\"ruleId\":\"py/unused-import\"},{\"correlationGuid\":\"11111111-2222-3333-4444-000000000000\",\"guid\":\"d2d44d02-9418-1b5f-a09e-01f469214f3e\",\"level\":\"warning\",\"locations\":[{\"physicalLocation\":{\"artifactLocation\":{\"index\":6,\"uri\":\"multiline_alert/multiline_alert.js\"},\"region\":{\"endColumn\":9,\"endLine\":102,\"startColumn\":7,\"startLine\":99}}}],\"message\":{\"text\":\"Component state update uses [potentially inconsistent value](1).\\nComponent state update uses [potentially inconsistent value](2).\"},\"partialFingerprints\":{\"primaryLocationLineHash\":\"be595d900c6191c:1\"},\"properties\":{\"github/alertNumber\":8,\"github/alertUrl\":\"https://api.github.com/repos/github/turboscan/code-scanning/alerts/8\"},\"relatedLocations\":[{\"id\":1,\"message\":{\"text\":\"potentially inconsistent value\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":0,\"uri\":\"multiline_alert/multiline_alert.js\"},\"region\":{\"endColumn\":39,\"endLine\":100,\"startColumn\":16,\"startLine\":100}}},{\"id\":2,\"message\":{\"text\":\"potentially inconsistent value\"},\"physicalLocation\":{\"artifactLocation\":{\"index\":0,\"uri\":\"multiline_alert/multiline_alert.js\"},\"region\":{\"endColumn\":45,\"endLine\":101,\"startColumn\":22,\"startLine\":101}}}],\"rule\":{\"id\":\"com.lgtm/javascript-queries:js/react/inconsistent-state-update\",\"index\":0},\"ruleId\":\"com.lgtm/javascript-queries:js/react/inconsistent-state-update\"}],\"tool\":{\"driver\":{\"guid\":\"7c61abe3-312b-1652-9c03-78f678a96a5f\",\"name\":\"CodeQL\",\"rules\":[{\"defaultConfiguration\":{\"level\":\"warning\"},\"fullDescription\":{\"text\":\"Updating the state of a component based on the current value of 'this.state' or 'this.props' may lead to inconsistent component state.\"},\"id\":\"com.lgtm/javascript-queries:js/react/inconsistent-state-update\",\"name\":\"com.lgtm/javascript-queries:js/react/inconsistent-state-update\",\"properties\":{\"precision\":\"very-high\",\"tags\":[\"frameworks/react\",\"reliability\"]},\"shortDescription\":{\"text\":\"Potentially inconsistent state update\"}},{\"defaultConfiguration\":{\"level\":\"warning\"},\"fullDescription\":{\"text\":\"When a comparison operation, such as x \\u003c y, always returns the same result, it means that the comparison is redundant and may mask a bug because a different check was intended.\"},\"id\":\"cpp/constant-comparison\",\"name\":\"cpp/constant-comparison\",\"properties\":{\"precision\":\"high\",\"tags\":[\"maintainability\",\"readability\"]},\"shortDescription\":{\"text\":\"Comparison result is always the same\"}},{\"defaultConfiguration\":{\"level\":\"warning\"},\"fullDescription\":{\"text\":\"Server-side URL redirection based on unvalidated user input may cause redirection to malicious web sites.\"},\"id\":\"js/server-side-unvalidated-url-redirection\",\"name\":\"js/server-side-unvalidated-url-redirection\",\"properties\":{\"precision\":\"high\",\"tags\":[\"external/cwe/cwe-601\",\"security\"]},\"shortDescription\":{\"text\":\"Server-side URL redirect\"}},{\"defaultConfiguration\":{\"level\":\"warning\"},\"fullDescription\":{\"text\":\"Code is unreachable\"},\"id\":\"py/unreachable-statement\",\"name\":\"py/unreachable-statement\",\"properties\":{\"precision\":\"very-high\",\"tags\":[\"external/cwe/cwe-561\",\"maintainability\",\"useless-code\"]},\"shortDescription\":{\"text\":\"Unreachable code\"}},{\"defaultConfiguration\":{\"level\":\"warning\"},\"fullDescription\":{\"text\":\"Import is not required as it is not used\"},\"id\":\"py/unused-import\",\"name\":\"py/unused-import\",\"properties\":{\"precision\":\"very-high\",\"tags\":[\"maintainability\",\"useless-code\"]},\"shortDescription\":{\"text\":\"Unused import\"}}],\"semanticVersion\":\"2.0.1\"}},\"versionControlProvenance\":[{\"branch\":\"refs/heads/master\",\"repositoryUri\":\"https://github.com/github/turboscan\",\"revisionId\":\"b000000000000000000000000000000000000000\"}]}],\"$schema\":\"https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json\",\"version\":\"2.1.0\"}"
          }
      http_version: null
    recorded_at: Wed, 09 Aug 2023 22:44:57 GMT
recorded_with: VCR 5.1.0
