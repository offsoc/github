(function(){window.forms={checkInputRadioField:function(){var e,t,n;return n=(e=$(this)).data("value"),"string"==typeof(t=$(e.data("input-field-id")).val())&&0!==t.length?e.val(n):e.val("")},setActiveRadioItem:function(){return $(this).parent().addClass("active").siblings().removeClass("active")},setActiveCheckboxItem:function(){return $(this).parent().toggleClass("active")}},$(function(){return $(document).ready(function(){return $(".radio-item input:checked, .checkbox-item input:checked").parent().addClass("active"),$(".radio-item input").click(forms.setActiveRadioItem),$(".checkbox-item input").click(forms.setActiveCheckboxItem)})})}).call(this),function(e){"use strict";function t(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let n,r,i=0,s=-1,o=(e.match(u.zoneIndex)||[])[0];for(o&&(o=o.substring(1),e=e.replace(/%.+$/,""));(s=e.indexOf(":",s+1))>=0;)i++;if("::"===e.substr(0,2)&&i--,"::"===e.substr(-2,2)&&i--,i>t)return null;for(r=t-i,n=":";r--;)n+="0:";return":"===(e=e.replace("::",n))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){const t=e.split(":"),n=[];for(let e=0;e<t.length;e++)n.push(parseInt(t[e],16));return n}(),zoneId:o}}function n(e,t,n,r){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let i,s=0;for(;r>0;){if((i=n-r)<0&&(i=0),e[s]>>i!=t[s]>>i)return!1;r-=n,s+=1}return!0}function r(e){if(c.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(a.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function i(e,t){for(;e.length<t;)e=`0${e}`;return e}const s="(0?\\d+|0x[a-f0-9]+)",o={fourOctet:new RegExp(`^${s}\\.${s}\\.${s}\\.${s}$`,"i"),threeOctet:new RegExp(`^${s}\\.${s}\\.${s}$`,"i"),twoOctet:new RegExp(`^${s}\\.${s}$`,"i"),longValue:new RegExp(`^${s}$`,"i")},a=new RegExp("^0[0-7]+$","i"),c=new RegExp("^0x[a-f0-9]+$","i"),d="%[0-9a-z]{1,}",p="(?:[0-9a-f]+::?)+",u={zoneIndex:new RegExp(d,"i"),native:new RegExp(`^(::)?(${p})?([0-9a-f]+)?(::)?(${d})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${s}\\.${s}\\.${s}\\.${s}(${d})?)$`,"i"),transitional:new RegExp(`^((?:${p})|(?:::)(?:${p})?)${s}\\.${s}\\.${s}\\.${s}(${d})?$`,"i")},l={};l.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,n;for(t=0;t<e.length;t++)if(!(0<=(n=e[t])&&n<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],"private":[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,18,0,0]),15],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let r;if(t===undefined&&(e=(r=e)[0],t=r[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return n(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const n={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let r,i,s;for(r=3;r>=0;r-=1){if(!((i=this.octets[r])in n))return null;if(s=n[i],t&&0!==s)return null;8!==s&&(t=!0),e+=s}return 32-e},e.prototype.range=function(){return l.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return l.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),l.IPv4.broadcastAddressFromCIDR=function(e){try{const n=this.parseCIDR(e),r=n[0].toByteArray(),i=this.subnetMaskFromPrefixLength(n[1]).toByteArray(),s=[];let o=0;for(;o<4;)s.push(parseInt(r[o],10)|255^parseInt(i[o],10)),o++;return new this(s)}catch(t){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},l.IPv4.isIPv4=function(e){return null!==this.parser(e)},l.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(t){return!1}},l.IPv4.isValidFourPartDecimal=function(e){return!(!l.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},l.IPv4.networkAddressFromCIDR=function(e){let t,n,r,i,s;try{for(r=(t=this.parseCIDR(e))[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],n=0;n<4;)i.push(parseInt(r[n],10)&parseInt(s[n],10)),n++;return new this(i)}catch(o){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},l.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},l.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const n=[this.parse(t[1]),e];return Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},l.IPv4.parser=function(e){let t,n,i;if(t=e.match(o.fourOctet))return function(){const e=t.slice(1,6),i=[];for(let t=0;t<e.length;t++)n=e[t],i.push(r(n));return i}();if(t=e.match(o.longValue)){if((i=r(t[1]))>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(i>>t&255);return e}().reverse()}return(t=e.match(o.twoOctet))?function(){const e=t.slice(1,4),n=[];if((i=r(e[1]))>16777215||i<0)throw new Error("ipaddr: address outside defined range");return n.push(r(e[0])),n.push(i>>16&255),n.push(i>>8&255),n.push(255&i),n}():(t=e.match(o.threeOctet))?function(){const e=t.slice(1,5),n=[];if((i=r(e[2]))>65535||i<0)throw new Error("ipaddr: address outside defined range");return n.push(r(e[0])),n.push(r(e[1])),n.push(i>>8&255),n.push(255&i),n}():null},l.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let n=0;const r=Math.floor(e/8);for(;n<r;)t[n]=255,n++;return r<4&&(t[r]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},l.IPv6=function(){function e(e,t){let n,r;if(16===e.length)for(this.parts=[],n=0;n<=14;n+=2)this.parts.push(e[n]<<8|e[n+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(n=0;n<this.parts.length;n++)if(!(0<=(r=this.parts[n])&&r<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]],benchmarking:[new e([8193,2,0,0,0,0,0,0]),48],amt:[new e([8193,3,0,0,0,0,0,0]),32],as112v6:[new e([8193,4,274,0,0,0,0,0]),48],deprecated:[new e([8193,16,0,0,0,0,0,0]),28],orchid2:[new e([8193,32,0,0,0,0,0,0]),28]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let r;if(t===undefined&&(e=(r=e)[0],t=r[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return n(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const n={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let r,i;for(let s=7;s>=0;s-=1){if(!((r=this.parts[s])in n))return null;if(i=n[r],t&&0!==i)return null;16!==i&&(t=!0),e+=i}return 128-e},e.prototype.range=function(){return l.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],n=this.parts;for(let r=0;r<n.length;r++)e=n[r],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(i(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],n=e[1];return new l.IPv4([t>>8,255&t,n>>8,255&n])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let n,r=0,i=-1;for(;n=e.exec(t);)n[0].length>i&&(r=n.index,i=n[0].length);return i<0?t:`${t.substring(0,r)}::${t.substring(r+i)}`},e.prototype.toString=function(){return this.toRFC5952String()},e}(),l.IPv6.broadcastAddressFromCIDR=function(e){try{const n=this.parseCIDR(e),r=n[0].toByteArray(),i=this.subnetMaskFromPrefixLength(n[1]).toByteArray(),s=[];let o=0;for(;o<16;)s.push(parseInt(r[o],10)|255^parseInt(i[o],10)),o++;return new this(s)}catch(t){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${t})`)}},l.IPv6.isIPv6=function(e){return null!==this.parser(e)},l.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{const n=this.parser(e);return new this(n.parts,n.zoneId),!0}catch(t){return!1}},l.IPv6.networkAddressFromCIDR=function(e){let t,n,r,i,s;try{for(r=(t=this.parseCIDR(e))[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],n=0;n<16;)i.push(parseInt(r[n],10)&parseInt(s[n],10)),n++;return new this(i)}catch(o){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${o})`)}},l.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},l.IPv6.parseCIDR=function(e){let t,n,r;if((n=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(n[2]))>=0&&t<=128)return r=[this.parse(n[1]),t],Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},l.IPv6.parser=function(e){let n,r,i,s,o,a;if(i=e.match(u.deprecatedTransitional))return this.parser(`::ffff:${i[1]}`);if(u.native.test(e))return t(e,8);if((i=e.match(u.transitional))&&(a=i[6]||"",(n=t(i[1].slice(0,-1)+a,6)).parts)){for(o=[parseInt(i[2]),parseInt(i[3]),parseInt(i[4]),parseInt(i[5])],r=0;r<o.length;r++)if(!(0<=(s=o[r])&&s<=255))return null;return n.parts.push(o[0]<<8|o[1]),n.parts.push(o[2]<<8|o[3]),{parts:n.parts,zoneId:n.zoneId}}return null},l.IPv6.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>128)throw new Error("ipaddr: invalid IPv6 prefix length");const t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let n=0;const r=Math.floor(e/8);for(;n<r;)t[n]=255,n++;return r<16&&(t[r]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},l.fromByteArray=function(e){const t=e.length;if(4===t)return new l.IPv4(e);if(16===t)return new l.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},l.isValid=function(e){return l.IPv6.isValid(e)||l.IPv4.isValid(e)},l.parse=function(e){if(l.IPv6.isValid(e))return l.IPv6.parse(e);if(l.IPv4.isValid(e))return l.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},l.parseCIDR=function(e){try{return l.IPv6.parseCIDR(e)}catch(t){try{return l.IPv4.parseCIDR(e)}catch(n){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},l.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},l.subnetMatch=function(e,t,n){let r,i,s,o;for(i in n!==undefined&&null!==n||(n="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,i))for(!(s=t[i])[0]||s[0]instanceof Array||(s=[s]),r=0;r<s.length;r++)if(o=s[r],e.kind()===o[0].kind()&&e.match.apply(e,o))return i;return n},"undefined"!=typeof module&&module.exports?module.exports=l:e.ipaddr=l}(this),function(){$(document).ready(function(){var e,t,n,r,i,s,o,a,c,d,p;$(".page-maintenance"),$("form"),t=$(".check.maintenance"),c=$("#select_timer"),n=$("#scheduler_maintenance_mode_message_input"),r=$(".save_scheduler"),d=$("#ip-exception-list"),p=$(".check.ip-exception-list-toggle"),r.click(function(e){e.preventDefault();var t=$(".save_scheduler");t.attr("disabled",!0);var r=$(".js_save_scheduler");r.show();var i=$(".api-error");i.val("");var s,o,d,p=$("<span>",{"class":"octicon save-status-icon"}),h=$(".save_scheduler_progress");($(".save-status-icon").remove(),s=0===$("input.maintenance:checked").length?"off":"on","on"===(0===$("input.ip-exception-list-toggle:checked").length?"off":"on"))?d=$("#ip-exception-list").val().split(",").map(e=>e.trim()):d=[];return o={enabled:s,when:c.val(),ip_exception_list:d,maintenance_mode_message:n.val()},$("#status").hide(),$.ajax({url:"/setup/maintenance",type:"POST",data:o,success:function(e,n){var i;return(i=e.redirect_to)&&(document.location.href=i),t.attr("disabled",!1),r.hide(),"success"===n?p.addClass("octicon-check").addClass("success-state"):p.addClass("octicon-x").addClass("error-state"),p.appendTo(h),a(e)},error:function(e){e.responseJSON.hasOwnProperty("error")&&("invalid-ip-address"==e.responseJSON.error?u.text(l):i.html(`Failed to save changes to maintenance mode: ${e.responseJSON.error}`)),i.show(),r.hide(),t.attr("disabled",!1),p.addClass("octicon-x").addClass("error-state"),p.appendTo(h)}})}),0===$("input.maintenance:checked").length&&(c.prop("disabled",!0),n.prop("disabled",!0),p.prop("disabled",!0)),t.click(function(){0===$("input.maintenance:checked").length?($(".save-scheduler").attr("disabled",!1),c.prop("disabled",!0),n.prop("disabled",!0),n.val(""),d.val(""),p.prop("checked",!1),p.prop("disabled",!0),h()):(c.prop("disabled",!1),n.prop("disabled",!1),p.prop("disabled",!1))}),a=function(t){switch($("#status").show(),t.status){case"off":$("#maintenance_on").hide(),$("#maintenance_mode_message").hide(),$("#maintenance_scheduled").hide(),1===$("#toggle_button:checked").length&&($("#toggle_button").prop("checked",!1),$(".maintenance-wrapper").removeClass("active"));break;case"on":$("#maintenance_on").show(),null!=t.maintenance_mode_message?($("#maintenance_on #maintenance_mode_message").text("The following custom maintenance mode message is displayed to users: "+t.maintenance_mode_message),$("#maintenance_on #maintenance_mode_message").show()):$("#maintenance_on #maintenance_mode_message").hide(),$("#maintenance_scheduled").hide(),0===$("#toggle_button:checked").length&&($("#toggle_button").prop("checked",!0),$(".maintenance-wrapper").removeClass("active"));break;case"scheduled":$("#maintenance_on").hide(),null!=t.maintenance_mode_message?($("#maintenance_scheduled #maintenance_mode_message").text("with custom maintenande mode message: "+t.maintenance_mode_message),$("#maintenance_scheduled #maintenance_mode_message").show()):$("#maintenance_scheduled #maintenance_mode_message").hide(),$("#maintenance_scheduled_at").text(t.scheduled_time),$("#maintenance_scheduled").show(),c.prop("disabled",!0),0===$("#toggle_button:checked").length&&($("#toggle_button").prop("checked",!0),$(".maintenance-wrapper").removeClass("active"))}t.can_unset_maintenance?($("#maintenance_no_unset").hide(),$("#toggle_button").removeAttr("disabled"),e()):($("#maintenance_no_unset").show(),$("#toggle_button").attr("disabled",!0),o()),t.hasOwnProperty("ip_exception_list")&&null!=t.ip_exception_list?0===$("#ip_exceptionlist_toggle:checked").length&&($("#ip_exceptionlist_toggle").prop("checked",!0),$(".exception-list-wrapper").removeClass("active")):1===$("#ip_exceptionlist_toggle:checked").length&&($("#ip_exceptionlist_toggle").prop("checked",!1),$(".exception-list-wrapper").removeClass("active"))},o=function(){return setTimeout(i,3e4)},e=function(){return clearTimeout(s)},i=function(){return $.ajax({url:"/setup/maintenance/status.json",type:"GET",success:function(e){return a(e)}})};var u=$(".maintenance-form").find(".validation-error-container"),l=$("#ip-exception-list").attr("data-validation-message"),h=function(){var e=$("#ip-exception-list");e.removeClass("invalid"),e.parent("dd").nextAll("dd.error").hide(),u.empty(),$(".save-status-icon").remove()};0===$("input.ip-exception-list-toggle:checked").length?(d.prop("disabled",!0),d.val("")):d.prop("disabled",!1),p.click(function(){0===$("input.ip-exception-list-toggle:checked").length?($(".save-ip-exception-list").attr("disabled",!1),d.prop("disabled",!0),d.val(""),h()):d.prop("disabled",!1)}),window.toggleSubmit=function(){var e=0===$(".js-required:visible.invalid").length;return $(".save-ip-exception-list").attr("disabled",!e)};var f=function(e,t){var n,r,i;$(".save-status-icon").remove(),r=(n=$(this)).hasClass("js-required");for(var s=!1,o=(i=n.val()).split(","),a=0;a<o.length;a++){var c=o[a];try{ipaddr.parseCIDR(c),s=!0}catch(d){if(ipaddr.isValid(c)){s=!0;continue}s=!1;break}}return r&&""===i||!s||"function"==typeof t&&""!==i&&!t(i)?(n.addClass("invalid"),n.parent("dd").nextAll("dd.error").show(),u.html(l)):h(),toggleSubmit()};return $("#maintenance-ip-exception-list").on("keyup focusout",".js-required",f),s=o()})}.call(this);