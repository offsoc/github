{"version":3,"file":"chunk-app_assets_modules_github_gist_drag-drop_ts-xxxxxxxxxxxx.js","mappings":"yIAGA,SAASA,EAAYC,CAAgB,EAEnCC,SAASC,aAAa,CAAc,qBAAsBC,SAAS,CAACC,MAAM,CAAC,UAC3EJ,EAAMK,eAAe,GACrBL,EAAMM,cAAc,EACtB,CAEA,SAASC,EAAYP,CAAgB,EACnC,IAAMQ,EAASR,EAAMQ,MAAM,CACvBA,aAAkBC,SAChBD,EAAOL,SAAS,CAACO,QAAQ,CAAC,qBAE5BF,EAAOL,SAAS,CAACQ,GAAG,CAAC,SAG3B,CAEA,eAAeC,EAAOZ,CAAgB,EACpC,IAAMa,EAAWb,EAAMc,YAAY,CACnC,GAAKD,EAEL,IAAK,IAAME,KAAQF,EAASG,KAAK,CAC/B,GAAI,CACF,IAAMC,EAAS,MAAMC,SA+BLH,CAAU,EAC9B,OAAO,IAAII,QAAQ,SAAUC,CAAO,CAAEC,CAAM,EAC1C,IAAMC,EAAS,IAAIC,UACnBD,CAAAA,EAAOE,MAAM,CAAG,WACd,IAAMC,EAAOH,EAAOI,MAAM,CACtBD,GAAQ,CAAC,KAAKE,IAAI,CAACF,GACrBL,EAAQ,CAACL,KAAAA,EAAMU,KAAAA,CAAI,GAEnBJ,EAAO,MAAU,gBAErB,EACAC,EAAOM,UAAU,CAACb,EACpB,EACF,EA5CwCA,GAClCf,EAAMQ,MAAM,CAAEqB,aAAa,CAAC,IAAIC,YAAY,gBAAiB,CAACC,QAAS,GAAMd,OAAAA,CAAM,GACrF,CAAE,MAAOe,EAAG,CAEZ,CAEJ,CAEA,SAASC,EAAOjC,CAAgB,EAC9BY,EAAOZ,GAEPC,SAASC,aAAa,CAAc,qBAAsBC,SAAS,CAACQ,GAAG,CAAC,UACxEX,EAAMK,eAAe,GACrBL,EAAMM,cAAc,EACtB,C,OAEA4B,CAAAA,EAAAA,E,OAAAA,EAAAA,EAAQ,oBAAqB,CAC3BvB,MACEV,SAASkC,IAAI,CAACC,gBAAgB,CAAC,YAAarC,GAC5CE,SAASkC,IAAI,CAACC,gBAAgB,CAAC,YAAa7B,GAC5CN,SAASkC,IAAI,CAACC,gBAAgB,CAAC,WAAYrC,GAC3CE,SAASkC,IAAI,CAACC,gBAAgB,CAAC,OAAQH,EACzC,EACA7B,SACEH,SAASkC,IAAI,CAACE,mBAAmB,CAAC,YAAatC,GAC/CE,SAASkC,IAAI,CAACE,mBAAmB,CAAC,YAAa9B,GAC/CN,SAASkC,IAAI,CAACE,mBAAmB,CAAC,WAAYtC,GAC9CE,SAASkC,IAAI,CAACE,mBAAmB,CAAC,OAAQJ,EAC5C,CACF,E","sources":["app/assets/modules/github/gist/drag-drop.ts"],"sourcesContent":["// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n\nfunction onDragenter(event: DragEvent) {\n  /* eslint-disable-next-line github/no-d-none */\n  document.querySelector<HTMLElement>('.js-gist-dropzone')!.classList.remove('d-none')\n  event.stopPropagation()\n  event.preventDefault()\n}\n\nfunction onDragleave(event: DragEvent) {\n  const target = event.target\n  if (target instanceof Element) {\n    if (target.classList.contains('js-gist-dropzone')) {\n      /* eslint-disable-next-line github/no-d-none */\n      target.classList.add('d-none')\n    }\n  }\n}\n\nasync function doDrop(event: DragEvent) {\n  const transfer = event.dataTransfer\n  if (!transfer) return\n\n  for (const file of transfer.files) {\n    try {\n      const detail = await readTextFile(file)\n      event.target!.dispatchEvent(new CustomEvent('gist:filedrop', {bubbles: true, detail}))\n    } catch (e) {\n      // Do nothing.\n    }\n  }\n}\n\nfunction onDrop(event: DragEvent) {\n  doDrop(event)\n  /* eslint-disable-next-line github/no-d-none */\n  document.querySelector<HTMLElement>('.js-gist-dropzone')!.classList.add('d-none')\n  event.stopPropagation()\n  event.preventDefault()\n}\n\nobserve('.js-gist-dropzone', {\n  add() {\n    document.body.addEventListener('dragenter', onDragenter)\n    document.body.addEventListener('dragleave', onDragleave)\n    document.body.addEventListener('dragover', onDragenter)\n    document.body.addEventListener('drop', onDrop)\n  },\n  remove() {\n    document.body.removeEventListener('dragenter', onDragenter)\n    document.body.removeEventListener('dragleave', onDragleave)\n    document.body.removeEventListener('dragover', onDragenter)\n    document.body.removeEventListener('drop', onDrop)\n  },\n})\n\nfunction readTextFile(file: File) {\n  return new Promise(function (resolve, reject) {\n    const reader = new FileReader()\n    reader.onload = function () {\n      const data = reader.result as string\n      if (data && !/\\0/.test(data)) {\n        resolve({file, data})\n      } else {\n        reject(new Error('invalid file'))\n      }\n    }\n    reader.readAsText(file)\n  })\n}\n"],"names":["onDragenter","event","document","querySelector","classList","remove","stopPropagation","preventDefault","onDragleave","target","Element","contains","add","doDrop","transfer","dataTransfer","file","files","detail","readTextFile","Promise","resolve","reject","reader","FileReader","onload","data","result","test","readAsText","dispatchEvent","CustomEvent","bubbles","e","onDrop","observe","body","addEventListener","removeEventListener"],"sourceRoot":""}