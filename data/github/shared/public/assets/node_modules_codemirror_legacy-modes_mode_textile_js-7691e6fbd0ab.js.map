{"version":3,"file":"chunk-node_modules_codemirror_legacy-modes_mode_textile_js-xxxxxxxxxxxx.js","mappings":"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","sources":["node_modules/@codemirror/legacy-modes/mode/textile.js"],"sourcesContent":["var TOKEN_STYLES = {\n  addition: \"inserted\",\n  attributes: \"propertyName\",\n  bold: \"strong\",\n  cite: \"keyword\",\n  code: \"monospace\",\n  definitionList: \"list\",\n  deletion: \"deleted\",\n  div: \"punctuation\",\n  em: \"emphasis\",\n  footnote: \"variable\",\n  footCite: \"qualifier\",\n  header: \"heading\",\n  html: \"comment\",\n  image: \"atom\",\n  italic: \"emphasis\",\n  link: \"link\",\n  linkDefinition: \"link\",\n  list1: \"list\",\n  list2: \"list.special\",\n  list3: \"list\",\n  notextile: \"string.special\",\n  pre: \"operator\",\n  p: \"content\",\n  quote: \"bracket\",\n  span: \"quote\",\n  specialChar: \"character\",\n  strong: \"strong\",\n  sub: \"content.special\",\n  sup: \"content.special\",\n  table: \"variableName.special\",\n  tableHeading: \"operator\"\n};\n\nfunction startNewLine(stream, state) {\n  state.mode = Modes.newLayout;\n  state.tableHeading = false;\n\n  if (state.layoutType === \"definitionList\" && state.spanningLayout &&\n      stream.match(RE(\"definitionListEnd\"), false))\n    state.spanningLayout = false;\n}\n\nfunction handlePhraseModifier(stream, state, ch) {\n  if (ch === \"_\") {\n    if (stream.eat(\"_\"))\n      return togglePhraseModifier(stream, state, \"italic\", /__/, 2);\n    else\n      return togglePhraseModifier(stream, state, \"em\", /_/, 1);\n  }\n\n  if (ch === \"*\") {\n    if (stream.eat(\"*\")) {\n      return togglePhraseModifier(stream, state, \"bold\", /\\*\\*/, 2);\n    }\n    return togglePhraseModifier(stream, state, \"strong\", /\\*/, 1);\n  }\n\n  if (ch === \"[\") {\n    if (stream.match(/\\d+\\]/)) state.footCite = true;\n    return tokenStyles(state);\n  }\n\n  if (ch === \"(\") {\n    var spec = stream.match(/^(r|tm|c)\\)/);\n    if (spec)\n      return TOKEN_STYLES.specialChar\n  }\n\n  if (ch === \"<\" && stream.match(/(\\w+)[^>]+>[^<]+<\\/\\1>/))\n    return TOKEN_STYLES.html\n\n  if (ch === \"?\" && stream.eat(\"?\"))\n    return togglePhraseModifier(stream, state, \"cite\", /\\?\\?/, 2);\n\n  if (ch === \"=\" && stream.eat(\"=\"))\n    return togglePhraseModifier(stream, state, \"notextile\", /==/, 2);\n\n  if (ch === \"-\" && !stream.eat(\"-\"))\n    return togglePhraseModifier(stream, state, \"deletion\", /-/, 1);\n\n  if (ch === \"+\")\n    return togglePhraseModifier(stream, state, \"addition\", /\\+/, 1);\n\n  if (ch === \"~\")\n    return togglePhraseModifier(stream, state, \"sub\", /~/, 1);\n\n  if (ch === \"^\")\n    return togglePhraseModifier(stream, state, \"sup\", /\\^/, 1);\n\n  if (ch === \"%\")\n    return togglePhraseModifier(stream, state, \"span\", /%/, 1);\n\n  if (ch === \"@\")\n    return togglePhraseModifier(stream, state, \"code\", /@/, 1);\n\n  if (ch === \"!\") {\n    var type = togglePhraseModifier(stream, state, \"image\", /(?:\\([^\\)]+\\))?!/, 1);\n    stream.match(/^:\\S+/); // optional Url portion\n    return type;\n  }\n  return tokenStyles(state);\n}\n\nfunction togglePhraseModifier(stream, state, phraseModifier, closeRE, openSize) {\n  var charBefore = stream.pos > openSize ? stream.string.charAt(stream.pos - openSize - 1) : null;\n  var charAfter = stream.peek();\n  if (state[phraseModifier]) {\n    if ((!charAfter || /\\W/.test(charAfter)) && charBefore && /\\S/.test(charBefore)) {\n      var type = tokenStyles(state);\n      state[phraseModifier] = false;\n      return type;\n    }\n  } else if ((!charBefore || /\\W/.test(charBefore)) && charAfter && /\\S/.test(charAfter) &&\n             stream.match(new RegExp(\"^.*\\\\S\" + closeRE.source + \"(?:\\\\W|$)\"), false)) {\n    state[phraseModifier] = true;\n    state.mode = Modes.attributes;\n  }\n  return tokenStyles(state);\n};\n\nfunction tokenStyles(state) {\n  var disabled = textileDisabled(state);\n  if (disabled) return disabled;\n\n  var styles = [];\n  if (state.layoutType) styles.push(TOKEN_STYLES[state.layoutType]);\n\n  styles = styles.concat(activeStyles(\n    state, \"addition\", \"bold\", \"cite\", \"code\", \"deletion\", \"em\", \"footCite\",\n    \"image\", \"italic\", \"link\", \"span\", \"strong\", \"sub\", \"sup\", \"table\", \"tableHeading\"));\n\n  if (state.layoutType === \"header\")\n    styles.push(TOKEN_STYLES.header + \"-\" + state.header);\n\n  return styles.length ? styles.join(\" \") : null;\n}\n\nfunction textileDisabled(state) {\n  var type = state.layoutType;\n\n  switch(type) {\n  case \"notextile\":\n  case \"code\":\n  case \"pre\":\n    return TOKEN_STYLES[type];\n  default:\n    if (state.notextile)\n      return TOKEN_STYLES.notextile + (type ? (\" \" + TOKEN_STYLES[type]) : \"\");\n    return null;\n  }\n}\n\nfunction activeStyles(state) {\n  var styles = [];\n  for (var i = 1; i < arguments.length; ++i) {\n    if (state[arguments[i]])\n      styles.push(TOKEN_STYLES[arguments[i]]);\n  }\n  return styles;\n}\n\nfunction blankLine(state) {\n  var spanningLayout = state.spanningLayout, type = state.layoutType;\n\n  for (var key in state) if (state.hasOwnProperty(key))\n    delete state[key];\n\n  state.mode = Modes.newLayout;\n  if (spanningLayout) {\n    state.layoutType = type;\n    state.spanningLayout = true;\n  }\n}\n\nvar REs = {\n  cache: {},\n  single: {\n    bc: \"bc\",\n    bq: \"bq\",\n    definitionList: /- .*?:=+/,\n    definitionListEnd: /.*=:\\s*$/,\n    div: \"div\",\n    drawTable: /\\|.*\\|/,\n    foot: /fn\\d+/,\n    header: /h[1-6]/,\n    html: /\\s*<(?:\\/)?(\\w+)(?:[^>]+)?>(?:[^<]+<\\/\\1>)?/,\n    link: /[^\"]+\":\\S/,\n    linkDefinition: /\\[[^\\s\\]]+\\]\\S+/,\n    list: /(?:#+|\\*+)/,\n    notextile: \"notextile\",\n    para: \"p\",\n    pre: \"pre\",\n    table: \"table\",\n    tableCellAttributes: /[\\/\\\\]\\d+/,\n    tableHeading: /\\|_\\./,\n    tableText: /[^\"_\\*\\[\\(\\?\\+~\\^%@|-]+/,\n    text: /[^!\"_=\\*\\[\\(<\\?\\+~\\^%@-]+/\n  },\n  attributes: {\n    align: /(?:<>|<|>|=)/,\n    selector: /\\([^\\(][^\\)]+\\)/,\n    lang: /\\[[^\\[\\]]+\\]/,\n    pad: /(?:\\(+|\\)+){1,2}/,\n    css: /\\{[^\\}]+\\}/\n  },\n  createRe: function(name) {\n    switch (name) {\n    case \"drawTable\":\n      return REs.makeRe(\"^\", REs.single.drawTable, \"$\");\n    case \"html\":\n      return REs.makeRe(\"^\", REs.single.html, \"(?:\", REs.single.html, \")*\", \"$\");\n    case \"linkDefinition\":\n      return REs.makeRe(\"^\", REs.single.linkDefinition, \"$\");\n    case \"listLayout\":\n      return REs.makeRe(\"^\", REs.single.list, RE(\"allAttributes\"), \"*\\\\s+\");\n    case \"tableCellAttributes\":\n      return REs.makeRe(\"^\", REs.choiceRe(REs.single.tableCellAttributes,\n                                          RE(\"allAttributes\")), \"+\\\\.\");\n    case \"type\":\n      return REs.makeRe(\"^\", RE(\"allTypes\"));\n    case \"typeLayout\":\n      return REs.makeRe(\"^\", RE(\"allTypes\"), RE(\"allAttributes\"),\n                        \"*\\\\.\\\\.?\", \"(\\\\s+|$)\");\n    case \"attributes\":\n      return REs.makeRe(\"^\", RE(\"allAttributes\"), \"+\");\n\n    case \"allTypes\":\n      return REs.choiceRe(REs.single.div, REs.single.foot,\n                          REs.single.header, REs.single.bc, REs.single.bq,\n                          REs.single.notextile, REs.single.pre, REs.single.table,\n                          REs.single.para);\n\n    case \"allAttributes\":\n      return REs.choiceRe(REs.attributes.selector, REs.attributes.css,\n                          REs.attributes.lang, REs.attributes.align, REs.attributes.pad);\n\n    default:\n      return REs.makeRe(\"^\", REs.single[name]);\n    }\n  },\n  makeRe: function() {\n    var pattern = \"\";\n    for (var i = 0; i < arguments.length; ++i) {\n      var arg = arguments[i];\n      pattern += (typeof arg === \"string\") ? arg : arg.source;\n    }\n    return new RegExp(pattern);\n  },\n  choiceRe: function() {\n    var parts = [arguments[0]];\n    for (var i = 1; i < arguments.length; ++i) {\n      parts[i * 2 - 1] = \"|\";\n      parts[i * 2] = arguments[i];\n    }\n\n    parts.unshift(\"(?:\");\n    parts.push(\")\");\n    return REs.makeRe.apply(null, parts);\n  }\n};\n\nfunction RE(name) {\n  return (REs.cache[name] || (REs.cache[name] = REs.createRe(name)));\n}\n\nvar Modes = {\n  newLayout: function(stream, state) {\n    if (stream.match(RE(\"typeLayout\"), false)) {\n      state.spanningLayout = false;\n      return (state.mode = Modes.blockType)(stream, state);\n    }\n    var newMode;\n    if (!textileDisabled(state)) {\n      if (stream.match(RE(\"listLayout\"), false))\n        newMode = Modes.list;\n      else if (stream.match(RE(\"drawTable\"), false))\n        newMode = Modes.table;\n      else if (stream.match(RE(\"linkDefinition\"), false))\n        newMode = Modes.linkDefinition;\n      else if (stream.match(RE(\"definitionList\")))\n        newMode = Modes.definitionList;\n      else if (stream.match(RE(\"html\"), false))\n        newMode = Modes.html;\n    }\n    return (state.mode = (newMode || Modes.text))(stream, state);\n  },\n\n  blockType: function(stream, state) {\n    var match, type;\n    state.layoutType = null;\n\n    if (match = stream.match(RE(\"type\")))\n      type = match[0];\n    else\n      return (state.mode = Modes.text)(stream, state);\n\n    if (match = type.match(RE(\"header\"))) {\n      state.layoutType = \"header\";\n      state.header = parseInt(match[0][1]);\n    } else if (type.match(RE(\"bq\"))) {\n      state.layoutType = \"quote\";\n    } else if (type.match(RE(\"bc\"))) {\n      state.layoutType = \"code\";\n    } else if (type.match(RE(\"foot\"))) {\n      state.layoutType = \"footnote\";\n    } else if (type.match(RE(\"notextile\"))) {\n      state.layoutType = \"notextile\";\n    } else if (type.match(RE(\"pre\"))) {\n      state.layoutType = \"pre\";\n    } else if (type.match(RE(\"div\"))) {\n      state.layoutType = \"div\";\n    } else if (type.match(RE(\"table\"))) {\n      state.layoutType = \"table\";\n    }\n\n    state.mode = Modes.attributes;\n    return tokenStyles(state);\n  },\n\n  text: function(stream, state) {\n    if (stream.match(RE(\"text\"))) return tokenStyles(state);\n\n    var ch = stream.next();\n    if (ch === '\"')\n      return (state.mode = Modes.link)(stream, state);\n    return handlePhraseModifier(stream, state, ch);\n  },\n\n  attributes: function(stream, state) {\n    state.mode = Modes.layoutLength;\n\n    if (stream.match(RE(\"attributes\")))\n      return TOKEN_STYLES.attributes\n    else\n      return tokenStyles(state);\n  },\n\n  layoutLength: function(stream, state) {\n    if (stream.eat(\".\") && stream.eat(\".\"))\n      state.spanningLayout = true;\n\n    state.mode = Modes.text;\n    return tokenStyles(state);\n  },\n\n  list: function(stream, state) {\n    var match = stream.match(RE(\"list\"));\n    state.listDepth = match[0].length;\n    var listMod = (state.listDepth - 1) % 3;\n    if (!listMod)\n      state.layoutType = \"list1\";\n    else if (listMod === 1)\n      state.layoutType = \"list2\";\n    else\n      state.layoutType = \"list3\";\n\n    state.mode = Modes.attributes;\n    return tokenStyles(state);\n  },\n\n  link: function(stream, state) {\n    state.mode = Modes.text;\n    if (stream.match(RE(\"link\"))) {\n      stream.match(/\\S+/);\n      return TOKEN_STYLES.link\n    }\n    return tokenStyles(state);\n  },\n\n  linkDefinition: function(stream) {\n    stream.skipToEnd();\n    return TOKEN_STYLES.linkDefinition\n  },\n\n  definitionList: function(stream, state) {\n    stream.match(RE(\"definitionList\"));\n\n    state.layoutType = \"definitionList\";\n\n    if (stream.match(/\\s*$/))\n      state.spanningLayout = true;\n    else\n      state.mode = Modes.attributes;\n\n    return tokenStyles(state);\n  },\n\n  html: function(stream) {\n    stream.skipToEnd();\n    return TOKEN_STYLES.html\n  },\n\n  table: function(stream, state) {\n    state.layoutType = \"table\";\n    return (state.mode = Modes.tableCell)(stream, state);\n  },\n\n  tableCell: function(stream, state) {\n    if (stream.match(RE(\"tableHeading\")))\n      state.tableHeading = true;\n    else\n      stream.eat(\"|\");\n\n    state.mode = Modes.tableCellAttributes;\n    return tokenStyles(state);\n  },\n\n  tableCellAttributes: function(stream, state) {\n    state.mode = Modes.tableText;\n\n    if (stream.match(RE(\"tableCellAttributes\")))\n      return TOKEN_STYLES.attributes\n    else\n      return tokenStyles(state);\n  },\n\n  tableText: function(stream, state) {\n    if (stream.match(RE(\"tableText\")))\n      return tokenStyles(state);\n\n    if (stream.peek() === \"|\") { // end of cell\n      state.mode = Modes.tableCell;\n      return tokenStyles(state);\n    }\n    return handlePhraseModifier(stream, state, stream.next());\n  }\n};\n\nexport const textile = {\n  name: \"textile\",\n  startState: function() {\n    return { mode: Modes.newLayout };\n  },\n  token: function(stream, state) {\n    if (stream.sol()) startNewLine(stream, state);\n    return state.mode(stream, state);\n  },\n  blankLine: blankLine\n};\n"],"names":["TOKEN_STYLES","addition","attributes","bold","cite","code","definitionList","deletion","div","em","footnote","footCite","header","html","image","italic","link","linkDefinition","list1","list2","list3","notextile","pre","p","quote","span","specialChar","strong","sub","sup","table","tableHeading","handlePhraseModifier","stream","state","ch","eat","togglePhraseModifier","match","tokenStyles","type","phraseModifier","closeRE","openSize","charBefore","pos","string","charAt","charAfter","peek","test","source","mode","Modes","disabled","textileDisabled","styles","layoutType","push","concat","activeStyles","i","arguments","length","join","REs","cache","single","bc","bq","definitionListEnd","drawTable","foot","list","para","tableCellAttributes","tableText","text","align","selector","lang","pad","css","createRe","name","makeRe","RE","choiceRe","pattern","arg","RegExp","parts","unshift","apply","newLayout","newMode","spanningLayout","blockType","parseInt","next","layoutLength","listDepth","listMod","skipToEnd","tableCell","textile","startState","token","sol","blankLine","key","hasOwnProperty"],"sourceRoot":""}