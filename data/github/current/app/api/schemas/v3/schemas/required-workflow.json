{
  "$schema": "http://json-schema.org/draft-04/hyper-schema",
  "id": "https://schema.github.com/v3/required-workflow.json",
  "title": "Required Workflow",
  "description": "An organization's required workflow",
  "type": "object",
  "definitions": {
    "workflow_file_path": {
      "description": "Path of the workflow file which is to be made required",
      "type": "string",
      "example": ".github/workflows/test.yml"
    },
    "repository_id": {
      "description": "The ID of the repository where the workflow_file_path resides",
      "example": 42,
      "type": "integer"
    },
    "scope": {
      "description": "The target scope of the required workflow",
      "enum": [
        "all",
        "selected"
      ],
      "type": "string"
    },
    "selected_repository_ids": {
      "description": "List of repository IDs that the required workflow should be scoped to",
      "example": [
        42
      ],
      "type": "array",
      "items": {
        "type": "integer"
      }
    },
    "id": {
      "description": "Unique identifier of a required workflow",
      "example": 42,
      "type": "integer"
    },
    "name": {
      "description": "Name of the workflow present in the workflow's yaml",
      "type": "string",
      "example": "Test CI"
    },
    "ref": {
      "description": "Ref of the workflow file",
      "type": "string",
      "example": "refs/heads/main"
    },
    "state": {
      "description": "State of the required workflow",
      "enum": [
        "active",
        "invalid"
      ],
      "type": "string"
    },
    "created_at": {
      "type": [
        "string",
        "null"
      ],
      "format": "date-time",
      "example": "2011-01-26T19:01:12Z"
    },
    "updated_at": {
      "type": [
        "string",
        "null"
      ],
      "format": "date-time",
      "example": "2011-01-26T19:14:43Z"
    },
    "selected_repositories_url": {
      "type": "string",
      "format": "uri",
      "example": "https://api.github.com/organizations/org/secrets/my_secret/repositories"
    }
  },
  "links": [
    {
      "title": "Create a required workflow in an organization",
      "href": "/organizations/{organization_id}/actions/required_workflows",
      "method": "POST",
      "rel": "create-required-workflow",
      "schema": {
        "properties": {
          "workflow_file_path": {
            "$ref": "#/definitions/workflow_file_path"
          },
          "repository_id": {
            "$ref": "#/definitions/repository_id"
          },
          "scope": {
            "$ref": "#/definitions/scope"
          },
          "selected_repository_ids": {
            "$ref": "#/definitions/selected_repository_ids"
          }
        },
        "additionalProperties": false,
        "required": [
          "workflow_file_path",
          "repository_id"
        ],
        "type": "object"
      }
    },
    {
      "title": "Update a required workflow in an organization",
      "href": "/organizations/{organization_id}/actions/required_workflows/{required_workflow_id}",
      "method": "PATCH",
      "rel": "update-required-workflow",
      "schema": {
        "properties": {
          "workflow_file_path": {
            "$ref": "#/definitions/workflow_file_path"
          },
          "repository_id": {
            "$ref": "#/definitions/repository_id"
          },
          "scope": {
            "$ref": "#/definitions/scope"
          },
          "selected_repository_ids": {
            "$ref": "#/definitions/selected_repository_ids"
          }
        },
        "additionalProperties": false,
        "type": "object"
      }
    },
    {
      "title": "Delete a required workflow configured for an organization.",
      "href": "/organizations/{organization_id}/actions/required_workflows/{required_workflow_id}",
      "method": "DELETE",
      "rel": "delete-required-workflow",
      "schema": {
        "additionalProperties": false,
        "type": [
          "object",
          "null"
        ]
      }
    },
    {
      "title": "Delete a configured repository from a required workflow that is of 'select' scope",
      "href": "/organizations/{organization_id}/actions/required_workflows/{required_workflow_id}/repositories/{repository_id}",
      "method": "DELETE",
      "rel": "remove-selected-repo-from-required-workflow",
      "schema": {
        "additionalProperties": false,
        "type": [
          "object",
          "null"
        ]
      }
    },
    {
      "title": "Add a repository to a required workflow that is of 'select' scope",
      "href": "/organizations/{organization_id}/actions/required_workflows/{required_workflow_id}/repositories/{repository_id}",
      "method": "PUT",
      "rel": "add-selected-repo-to-required-workflow",
      "schema": {
        "additionalProperties": false,
        "type": [
          "object",
          "null"
        ]
      }
    },
    {
      "title": "Set selected repositories for a required workflow in an organization",
      "href": "/organizations/{organization_id}/actions/required_workflows/{required_workflow_id}/repositories",
      "method": "PUT",
      "rel": "set-selected-repos-to-required-workflow",
      "schema": {
        "properties": {
          "selected_repository_ids": {
            "$ref": "#/definitions/selected_repository_ids"
          }
        },
        "additionalProperties": false,
        "required": [
          "selected_repository_ids"
        ],
        "type": "object"
      }
    }
  ],
  "properties": {
    "id": {
      "$ref": "#/definitions/id"
    },
    "name": {
      "$ref": "#/definitions/name"
    },
    "path": {
      "$ref": "#/definitions/workflow_file_path"
    },
    "scope": {
      "$ref": "#/definitions/scope"
    },
    "ref": {
      "$ref": "#/definitions/ref"
    },
    "state": {
      "$ref": "#/definitions/state"
    },
    "created_at": {
      "$ref": "#/definitions/created_at"
    },
    "updated_at": {
      "$ref": "#/definitions/updated_at"
    },
    "selected_repositories_url": {
      "$ref": "#/definitions/selected_repositories_url"
    },
    "repository": {
      "$ref": "https://schema.github.com/v3/minimal-repository.json#"
    }
  },
  "additionalProperties": false,
  "required": [
    "id",
    "name",
    "path",
    "scope",
    "ref",
    "state",
    "created_at",
    "updated_at",
    "repository"
  ]
}
