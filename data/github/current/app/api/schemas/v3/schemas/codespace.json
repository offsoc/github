{
  "$schema": "http://json-schema.org/draft-04/hyper-schema",
  "id": "https://schema.github.com/v3/codespace.json",
  "title": "Codespace",
  "description": "Codespaces API",
  "type": "object",
  "definitions": {
    "mint_repository_token": {
      "description": "Should it mint a repository-scoped token?",
      "type": "boolean"
    },
    "repository_id": {
      "type": "integer"
    },
    "ref": {
      "type": "string"
    },
    "fork_if_needed": {
      "type": "boolean"
    },
    "pull_request": {
      "type": "object",
      "required": [
        "repository_id",
        "pull_request_number"
      ],
      "properties": {
        "repository_id": {
          "type": "integer"
        },
        "pull_request_number": {
          "type": "integer"
        }
      },
      "additionalProperties": false
    },
    "guid": {
      "type": "string"
    },
    "codespace_template": {
      "properties": {
        "ref": {
          "$ref": "#/definitions/ref"
        },
        "vscs_target": {
          "$ref": "#/definitions/vscs_target"
        },
        "location": {
          "$ref": "#/definitions/location"
        },
        "sku_name": {
          "$ref": "#/definitions/sku_name"
        },
        "sha": {
          "$ref": "#/definitions/sha"
        },
        "environment_options": {
          "$ref": "#/definitions/environment_options"
        },
        "vscs_target_url": {
          "$ref": "#/definitions/vscs_target_url"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "location",
        "ref",
        "sha"
      ]
    },
    "location": {
      "type": "string"
    },
    "sku_name": {
      "type": "string"
    },
    "sku": {
      "type": "string"
    },
    "environment_options": {
      "type": "object",
      "additionalProperties": true
    },
    "message": {
      "description": "The GPG message we should sign",
      "type": "string"
    },
    "vscs_target": {
      "description": "The VSCS environment we want to use to create the codespace",
      "type": "string"
    },
    "vscs_target_url": {
      "description": "The URL to use for VSCS API calls when the target is local for VSCS testing",
      "type": "string"
    },
    "author": {
      "description": "The author of this commit",
      "type": "string"
    },
    "codespace_token": {
      "description": "The SignedAuthToken representing the codespace",
      "type": "string"
    },
    "pool_code": {
      "type": "string"
    },
    "sha": {
      "description": "A commit sha",
      "type": "string"
    },
    "name": {
      "description": "The name of the codespace",
      "type": "string"
    },
    "state": {
      "description": "The state of the codespace",
      "type": "string"
    },
    "workflow_run_id": {
      "description": "Dynamic workflow run id",
      "type": "integer"
    },
    "configuration_id": {
      "description": "Prebuild configuration id",
      "type": "integer"
    },
    "devcontainer_path": {
      "description": "The path to the devcontainer.json file",
      "type": "string"
    },
    "storage_type": {
      "description": "The type of storage to use for the codespace",
      "type": "string"
    },
    "template_info": {
      "description": "Prebuild template info",
      "type": "object",
      "required": [
        "template_size"
      ],
      "properties": {
        "total_time_saving": {
          "type": "string"
        },
        "template_size": {
          "type": "number"
        },
        "storage_image_version": {
          "type": "string"
        },
        "container": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "schema_version": {
              "type": "string"
            },
            "image_name": {
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": true
    },
    "telemetry_level": {
      "description": "The telemetry level for the user",
      "type": "string"
    },
    "vscode_channel": {
      "description": "The vscode channel (stable, insider) the user prefers",
      "type": "string"
    }
  },
  "links": [
    {
      "title": "Update user settings",
      "method": "PATCH",
      "rel": "codespaces-user-settings-update",
      "href": "/vscs_internal/user-settings",
      "schema": {
        "properties": {
          "telemetry_level": {
            "$ref": "#/definitions/telemetry_level"
          },
          "vscode_channel": {
            "$ref": "#/definitions/vscode_channel"
          }
        },
        "additionalProperties": false,
        "type": [
          "object",
          "null"
        ]
      }
    },
    {
      "title": "Mint tokens for Codespaces",
      "method": "POST",
      "rel": "mint-repository-token",
      "href": "/vscs_internal/user/{user_id}/codespaces/{name}/token",
      "schema": {
        "properties": {
          "mint_repository_token": {
            "$ref": "#/definitions/mint_repository_token"
          }
        },
        "additionalProperties": false,
        "type": [
          "object",
          "null"
        ]
      }
    },
    {
      "title": "Codespaces Settings Update Schema",
      "method": "PATCH",
      "rel": "codespaces-settings-update",
      "href": "/user/codespaces/{name}",
      "schema": {
        "properties": {
          "sku_name": {
            "$ref": "#/definitions/sku_name"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "sku_name"
        ]
      }
    },
    {
      "title": "Codespaces Settings Update Schema",
      "method": "PATCH",
      "rel": "codespaces-settings-update",
      "href": "/vscs_internal/user/{user_id}/codespaces/{name}",
      "schema": {
        "properties": {
          "sku_name": {
            "$ref": "#/definitions/sku_name"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "sku_name"
        ]
      }
    },
    {
      "title": "Codespaces Create Schema",
      "method": "POST",
      "rel": "codespaces-create-public",
      "href": "/user/codespaces",
      "schema": {
        "properties": {
          "repository_id": {
            "$ref": "#/definitions/repository_id"
          },
          "ref": {
            "$ref": "#/definitions/ref"
          },
          "pull_request": {
            "$ref": "#/definitions/pull_request"
          },
          "location": {
            "$ref": "#/definitions/location"
          },
          "machine": {
            "$ref": "#/definitions/sku_name"
          },
          "working_directory": {
            "type": "string"
          },
          "environment_options": {
            "$ref": "#/definitions/environment_options"
          },
          "vscs_target": {
            "$ref": "#/definitions/vscs_target"
          },
          "vscs_target_url": {
            "$ref": "#/definitions/vscs_target_url"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "location"
        ]
      }
    },
    {
      "title": "Codespaces Create Schema",
      "method": "POST",
      "rel": "codespaces-create-repo",
      "href": "/repositories/{repository_id}/codespaces",
      "schema": {
        "properties": {
          "ref": {
            "$ref": "#/definitions/ref"
          },
          "location": {
            "$ref": "#/definitions/location"
          },
          "machine": {
            "$ref": "#/definitions/sku_name"
          },
          "working_directory": {
            "type": "string"
          },
          "environment_options": {
            "$ref": "#/definitions/environment_options"
          },
          "vscs_target": {
            "$ref": "#/definitions/vscs_target"
          },
          "vscs_target_url": {
            "$ref": "#/definitions/vscs_target_url"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "location"
        ]
      }
    },
    {
      "title": "Codespaces Create Schema",
      "method": "POST",
      "rel": "codespaces-create-repo-pr",
      "href": "/repositories/{repository_id}/pulls/{pull_number}/codespaces",
      "schema": {
        "properties": {
          "location": {
            "$ref": "#/definitions/location"
          },
          "machine": {
            "$ref": "#/definitions/sku_name"
          },
          "working_directory": {
            "type": "string"
          },
          "environment_options": {
            "$ref": "#/definitions/environment_options"
          },
          "vscs_target": {
            "$ref": "#/definitions/vscs_target"
          },
          "vscs_target_url": {
            "$ref": "#/definitions/vscs_target_url"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "location"
        ]
      }
    },
    {
      "title": "Codespaces Create Schema",
      "method": "POST",
      "rel": "codespaces-create",
      "href": "/vscs_internal/user/{user_id}/codespaces",
      "schema": {
        "properties": {
          "repository_id": {
            "$ref": "#/definitions/repository_id"
          },
          "ref": {
            "$ref": "#/definitions/ref"
          },
          "fork_if_needed": {
            "$ref": "#/definitions/fork_if_needed"
          },
          "pull_request": {
            "$ref": "#/definitions/pull_request"
          },
          "location": {
            "$ref": "#/definitions/location"
          },
          "sku_name": {
            "$ref": "#/definitions/sku_name"
          },
          "sku": {
            "$ref": "#/definitions/sku"
          },
          "environment_options": {
            "$ref": "#/definitions/environment_options"
          },
          "vscs_target": {
            "$ref": "#/definitions/vscs_target"
          },
          "vscs_target_url": {
            "$ref": "#/definitions/vscs_target_url"
          }
        },
        "additionalProperties": false,
        "type": "object"
      }
    },
    {
      "title": "Codespaces Prebuild Template Schema Legacy",
      "method": "POST",
      "rel": "codespaces-prebuild-template",
      "href": "/vscs_internal/codespaces/repository/{repository_id}/prebuild/templates",
      "templateRequired": [
        "repository_id"
      ],
      "schema": {
        "$ref": "#/definitions/codespace_template"
      }
    },
    {
      "title": "Codespaces Prebuild Template Schema Legacy",
      "method": "POST",
      "rel": "codespaces-prebuild-template",
      "href": "/internal/vscs/codespaces/repository/{repository_id}/prebuild/templates",
      "templateRequired": [
        "repository_id"
      ],
      "schema": {
        "$ref": "#/definitions/codespace_template"
      }
    },
    {
      "title": "Codespaces Delete Prebuild Template Schema",
      "method": "DELETE",
      "rel": "codespaces-prebuild-template-delete",
      "href": "/internal/vscs/codespaces/prebuild/templates/{guid}",
      "templateRequired": [
        "guid"
      ],
      "schema": {
        "properties": {
          "vscs_target": {
            "$ref": "#/definitions/vscs_target"
          },
          "vscs_target_url": {
            "$ref": "#/definitions/vscs_target_url"
          },
          "location": {
            "$ref": "#/definitions/location"
          },
          "environment_options": {
            "$ref": "#/definitions/environment_options"
          }
        },
        "additionalProperties": false,
        "type": "object"
      }
    },
    {
      "title": "Codespaces Prebuild Instance Schema",
      "method": "POST",
      "rel": "codespaces-prebuild-instance",
      "href": "/internal/vscs/codespaces/prebuild/instances",
      "schema": {
        "properties": {
          "pool_code": {
            "$ref": "#/definitions/pool_code"
          },
          "vscs_target": {
            "$ref": "#/definitions/vscs_target"
          },
          "vscs_target_url": {
            "$ref": "#/definitions/vscs_target_url"
          },
          "repository_id": {
            "$ref": "#/definitions/repository_id"
          },
          "location": {
            "$ref": "#/definitions/location"
          },
          "environment_options": {
            "$ref": "#/definitions/environment_options"
          },
          "template_guid": {
            "$ref": "#/definitions/guid"
          },
          "branch_name": {
            "type": "string"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "pool_code",
          "repository_id",
          "vscs_target",
          "location",
          "environment_options"
        ]
      }
    },
    {
      "title": "Codespaces Prebuild Template Schema",
      "method": "POST",
      "rel": "codespaces-prebuild-template-with-workflow",
      "href": "/codespaces_internal/prebuilds/repository/{repository_id}/templates",
      "templateRequired": [
        "repository_id"
      ],
      "schema": {
        "properties": {
          "workflow_run_id": {
            "$ref": "#/definitions/workflow_run_id"
          },
          "configuration_id": {
            "$ref": "#/definitions/configuration_id"
          },
          "vscs_target": {
            "$ref": "#/definitions/vscs_target"
          },
          "location": {
            "$ref": "#/definitions/location"
          },
          "environment_options": {
            "type": "object",
            "required": [
              "template_info"
            ],
            "properties": {
              "template_info": {
                "$ref": "#/definitions/template_info"
              },
              "devcontainer_path": {
                "$ref": "#/definitions/devcontainer_path"
              },
              "storage_type": {
                "$ref": "#/definitions/storage_type"
              }
            },
            "additionalProperties": true
          },
          "vscs_target_url": {
            "$ref": "#/definitions/vscs_target_url"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "workflow_run_id",
          "location",
          "environment_options"
        ]
      }
    },
    {
      "title": "Codespaces Prebuild Template Update Schema",
      "method": "PATCH",
      "rel": "codespaces-prebuild-template-update",
      "href": "/codespaces_internal/prebuilds/repository/{repository_id}/templates/{guid}",
      "schema": {
        "properties": {
          "state": {
            "$ref": "#/definitions/state"
          },
          "workflow_run_id": {
            "$ref": "#/definitions/workflow_run_id"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "state",
          "workflow_run_id"
        ]
      }
    },
    {
      "title": "Sign GPG messages for Codespaces",
      "method": "POST",
      "rel": "codespaces-commit-sign",
      "href": "/vscs_internal/commit/sign",
      "schema": {
        "properties": {
          "message": {
            "$ref": "#/definitions/message"
          },
          "author": {
            "$ref": "#/definitions/author"
          },
          "codespace_token": {
            "$ref": "#/definitions/codespace_token"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "message",
          "author",
          "codespace_token"
        ]
      }
    },
    {
      "title": "Codespaces Environment Webhook Schema",
      "method": "POST",
      "rel": "codespaces-environment-webhook",
      "href": "/internal/vscs/environment_webhook",
      "schema": {
        "properties": {
          "friendlyName": {
            "$ref": "#/definitions/name"
          }
        },
        "additionalProperties": true,
        "type": "object",
        "required": [
          "friendlyName"
        ]
      }
    },
    {
      "title": "Codespaces Environment Heartbeat Schema",
      "method": "POST",
      "rel": "codespaces-environment-heartbeat",
      "href": "/internal/vscs/environment_heartbeat",
      "schema": {
        "properties": {
          "friendlyName": {
            "$ref": "#/definitions/name"
          }
        },
        "additionalProperties": true,
        "type": "object",
        "required": [
          "friendlyName"
        ]
      }
    }
  ]
}
