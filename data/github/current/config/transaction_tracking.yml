test:
  active_job:
    ignore:
      # These are existing violations where a job gets enqueued inside a
      # transaction. It'd be good to eventually fix these.
      - app/controllers/registry_two/package_settings_controller.rb
      - app/helpers/organizations_helper.rb
      - app/platform/provisioning/enterprise_managed_identity_provisioner.rb
      - config/instrumentation/hydro/subscriptions/copilot_for_business_watched_events.rb
      - config/instrumentation/project_workflows.rb
      - config/instrumentation/repository_vulnerability_alert.rb
      - config/instrumentation/security_center.rb
      - config/instrumentation/stratocaster.rb
      - config/instrumentation/trade_controls.rb
      - lib/configurable/default_repository_permission.rb
      - lib/configurable/microsoft_support_plan.rb
      - packages/funding_links/app/models/configurable/repository_funding_links.rb
      - lib/configurable/support_plan.rb
      - lib/github/background_dependent_deletes.rb
      - lib/github/billing/zuora_webhook/invoiced_organization_subscription_synchronizer.rb
      - lib/github/billing/zuora_webhook/prepaid_metered_usage_refill_synchronizer.rb
      - lib/github/prioritizable/context.rb
      - lib/github/stream_processors/advisory_db/submit_advisory_processor.rb
      - lib/github/user_content.rb
      - lib/newsies/service.rb
      - lib/search.rb
      - packages/actions/app/models/actions_policy/allowlist.rb
      - packages/admin/app/models/business.rb
      - packages/admin/app/models/business/organization_membership.rb
      - packages/admin/app/models/business_user_account.rb
      - packages/app_security/app/models/ability.rb
      - packages/app_security/app/models/oauth_authorization.rb
      - packages/app_security/app/models/oauth_authorization/creator.rb
      - packages/app_security/app/models/organization/oauth_application_policy_dependency.rb
      - packages/app_security/app/models/user/oauth_dependency.rb
      - packages/apps/app/jobs/proxima_app_sync/create_app_job_helper.rb
      - packages/apps/app/jobs/proxima_app_sync/create_first_party_app_job.rb
      - packages/apps/app/jobs/proxima_app_sync/create_third_party_app_job.rb
      - packages/apps/app/models/integration_installable.rb
      - packages/apps/app/models/integration_installation/creator.rb
      - packages/apps/app/models/integration_installation/editor.rb
      - packages/apps/app/models/integration_installation/repository_editor.rb
      - packages/apps/app/models/integration_installation_request.rb
      - packages/artifacts/app/models/page/protected_domain.rb
      - packages/artifacts/app/models/repository/pages_dependency.rb
      - packages/billing/app/models/billing/bundled_license_assignment.rb
      - packages/billing/app/models/billing/enterprise_cloud_trial.rb
      - packages/billing/app/models/billing/plan_subscription.rb
      - packages/billing/app/models/billing/plan_subscription/synchronization.rb
      - packages/billing/app/models/billing/schedule_plan_change.rb
      - packages/billing/app/models/billing/shared_storage/artifact_event.rb
      - packages/billing/app/models/business/billing_dependency.rb
      - packages/billing/app/models/user/billing_dependency.rb
      - packages/billing/app/models/user/coupons_dependency.rb
      - packages/billing/app/models/user/invoice_converter.rb
      - packages/codespaces/app/commands/codespaces/handle_spammy_user.rb
      - packages/codespaces/app/models/codespaces/trusted_repository_authorization.rb
      - packages/codespaces/app/models/configurable/organization_codespaces_ownership_setting.rb
      - packages/collaboration/app/models/referrer.rb
      - packages/community_and_safety/app/models/abuse_report.rb
      - packages/community_and_safety/app/models/community_profile.rb
      - packages/community_and_safety/app/models/ignored_user.rb
      - packages/community_and_safety/app/models/repository/community_dependency.rb
      - packages/community_and_safety/app/models/stafftools/network_privilege.rb
      - packages/copilot/app/models/copilot/business_trial.rb
      - packages/copilot/initializers/copilot/subscribers.rb
      - packages/data/app/models/asset/status.rb
      - packages/data/app/models/insights/entity_instrumenter.rb
      - packages/discussions/app/models/discussion.rb
      - packages/discussions/app/models/discussion/search_adapter.rb
      - packages/enterprise/app/models/enterprise_contribution.rb
      - packages/enterprise/app/models/pre_receive_environment.rb
      - packages/external_identities/app/models/external_group_team.rb
      - packages/external_identities/app/models/external_identity.rb
      - packages/git/app/models/repository/refs_dependency.rb
      - packages/github_sponsors/app/models/billing/billing_transaction/line_item/sponsors_dependency.rb
      - packages/github_sponsors/app/models/sponsors_listing.rb
      - packages/github_sponsors/app/models/sponsors_patreon_user.rb
      - packages/github_sponsors/app/models/sponsorship.rb
      - packages/health/app/models/spam/markable_as_spammy.rb
      - packages/health/app/models/spam/spammable.rb
      - packages/health/app/models/suspension/suspension_dependency.rb
      - packages/health/app/models/user/spam_dependency.rb
      - packages/hierarchy/app/models/issue/issues_graph_dependency.rb
      - packages/hierarchy/app/models/memex_project_item/issues_graph_dependency.rb
      - packages/issues/app/jobs/issue_summarize_job.rb
      - packages/issues/app/models/issue/close_issue_reference_dependency.rb
      - packages/issues/app/models/issue/state.rb
      - packages/issues/app/models/issue_event.rb
      - packages/issues/app/models/milestone.rb
      - packages/issues/app/models/repository/issue_dependency.rb
      - packages/licensing/app/models/business/license_dependency.rb
      - packages/licensing/app/models/licensing/vss/subscription_event_processor.rb
      - packages/licensing/app/models/licensing/business_user_account/licensing_dependency.rb
      - packages/licensing/app/models/licensing/business_user_account/update_attributes/licensing_dependency.rb
      - packages/management_tools/app/models/account_screening_profile.rb
      - packages/management_tools/app/models/trade_controls/legal_notification.rb
      - packages/management_tools/app/models/user/trade_controls_dependency.rb
      - packages/notifications/app/models/notifications_content.rb
      - packages/notifications/app/models/notifyd/notify_publisher.rb
      - packages/notifications/app/models/notifications/subscribable_thread.rb
      - packages/notifications/app/models/notifications/summarizable.rb
      - packages/orgs/app/models/organization.rb
      - packages/orgs/app/models/organization/invitations_dependency.rb
      - packages/orgs/app/models/organization_invitation.rb
      - packages/orgs/app/models/team.rb
      - packages/orgs/app/models/team/destruction/destroy_operation.rb
      - packages/orgs/app/models/team_change_parent_request.rb
      - packages/orgs/app/models/team_sync/business_tenant.rb
      - packages/orgs/app/models/team_sync/tenant.rb
      - packages/planning/app/models/issue/memexes_dependency.rb
      - packages/planning/app/models/pull_request/memex_dependency.rb
      - packages/profiles/app/models/user/contributions_dependency.rb
      - packages/profiles/app/models/user/follow_dependency.rb
      - packages/pull_requests/app/models/merge_queues/command.rb
      - packages/pull_requests/app/models/pull_request.rb
      - packages/pull_requests/app/public/merge_queues.rb
      - packages/repositories/app/models/orchestration.rb
      - packages/repositories/app/models/repository/membership_dependency.rb
      - packages/repositories/app/models/repository/preferred_files.rb
      - packages/repositories/app/models/repository/search_dependency.rb
      - packages/repositories/app/models/repository_invitation.rb
      - packages/repositories/app/models/repository_push_job_trigger.rb
      - packages/security_products/app/models/dependabot_alerts/upstream_model.rb
      - packages/security_products/app/models/repository_advisory.rb
      - packages/security_products/app/models/security_product/dependabot_config_file.rb
      - packages/security_products/app/models/security_product/dependency_graph.rb
      - packages/security_products/app/models/security_product/vulnerability_alerts.rb
      - packages/security_products/app/models/vulnerability.rb
      - packages/repositories/app/models/topic.rb
      - packages/users/app/models/email_role.rb
      - packages/users/app/models/user.rb
      - packages/users/app/models/user_email.rb
      - packages/webhooks/app/models/hook/delivery_system.rb
      - packages/webhooks/app/models/hook/event.rb

  nested_across_clusters:
    ignore:
      # factory_bot creates records in ways that don't match production usage
      - factory_bot

      # These are known cases involving 3 clusters. We should be able to remove
      # them from this list once https://github.com/github/fanout/issues/1121 is
      # complete
      - lib/github/billing/zuora_webhook/
      - packages/actions/app/models/business/actions_dependency.rb
      - packages/admin/app/models/business
      - packages/app_security/app/models/ability
      - packages/lists/app/models/user_list.rb
      - packages/orgs/app/models/organization/creator.rb
      - packages/orgs/app/models/organization_invitation.rb
      - packages/orgs/app/models/team.rb
      - packages/pull_requests/app/models/merge_queue_entry.rb
      - packages/pull_requests/app/models/pull_request.rb

      # These are known cases involving 2 clusters. We should eventually fix
      # these.
      - app/api/internal/twirp/octoshift/imports/v1/import_pull_request_api_handler.rb
      - app/api/repository_branches.rb
      - app/controllers/application_controller/user_session_dependency.rb
      - app/controllers/businesses/admin_roles_controller.rb
      - app/controllers/edit_repositories_controller.rb
      - app/controllers/integrations_controller_methods.rb
      - app/controllers/issues_controller.rb
      - app/controllers/oauth_applications_controller.rb
      - app/controllers/organizations_controller.rb
      - app/controllers/releases_controller.rb
      - app/controllers/repos/advisories_controller.rb
      - app/controllers/repos/security_and_analysis/settings_controller.rb
      - app/controllers/stafftools/integrations_controller.rb
      - app/controllers/stafftools/sponsors/members/stripe_connect_accounts/payout_toggles_controller.rb
      - app/jobs/destroy_business_job.rb
      - app/jobs/destroy_enterprise_installation_job.rb
      - app/jobs/enforce_two_factor_requirement_on_business_job.rb
      - app/jobs/newsies/copy_thread_subscribers_job.rb
      - app/jobs/packages/migration/migrate_package_job.rb
      - app/jobs/purge_soft_deleted_businesses_job.rb
      - app/jobs/soft_delete_business_job.rb
      - app/jobs/trade_controls/org_high_risk_geo_job.rb
      - app/jobs/user_delete_job.rb
      - app/platform/mutations/add_enterprise_support_entitlement.rb
      - app/platform/mutations/convert_project_card_note_to_issue.rb
      - app/platform/mutations/remove_enterprise_support_entitlement.rb
      - app/platform/mutations/shared/modify_branch_protection_rule.rb
      - app/platform/mutations/update_enterprise_administrator_role.rb
      - app/platform/mutations/update_issue.rb
      - app/platform/mutations/update_pull_request.rb
      - app/platform/provisioning/enterprise_managed_identity_provisioner.rb
      - config/instrumentation/subscription_item.rb
      - lib/apps/internal/codespaces.rb
      - lib/apps/internal/copilot_chat.rb
      - lib/apps/internal/neutron.rb
      - lib/apps/internal/memex_automation.rb
      - lib/configurable/microsoft_support_plan.rb
      - lib/configurable/support_plan.rb
      - lib/github/active_record_readonly_mode.rb
      - lib/github/callback_instrumenter.rb
      - lib/github/dgit/sql.rb
      - lib/github/migration_coordinator.rb
      - lib/github/rate_limited_creation.rb
      - lib/github/stream_processors/advisory_db/submit_advisory_processor.rb
      - lib/github/stream_processors/registry_metadata/version_migration_status_processor.rb
      - packages/admin/app/models/user/legal_holds_dependency.rb
      - packages/app_security/app/models/authenticated_device.rb
      - packages/app_security/app/models/oauth_access.rb
      - packages/app_security/app/models/oauth_application.rb
      - packages/app_security/app/models/permissions/granters/role_granter.rb
      - packages/app_security/test/models/oauth_application_test.rb
      - packages/app_security/test/models/oauth_util_test.rb
      - packages/apps/app/jobs/proxima_app_sync/create_app_job_helper.rb
      - packages/apps/app/jobs/proxima_app_sync/create_first_party_app_job.rb
      - packages/apps/app/jobs/proxima_app_sync/create_third_party_app_job.rb
      - packages/apps/app/jobs/proxima_app_sync/update_app_job_helper.rb
      - packages/apps/app/jobs/proxima_app_sync/update_first_party_app_job.rb
      - packages/apps/app/jobs/proxima_app_sync/update_third_party_app_job.rb
      - packages/apps/app/models/integration/installation_service.rb
      - packages/apps/app/models/integration/permissions_editor.rb
      - packages/apps/app/models/integration_installation.rb
      - packages/apps/app/models/integration_installation/editor.rb
      - packages/apps/app/models/integration_installation/permissions_editor.rb
      - packages/apps/app/models/integration_manifest.rb
      - packages/apps/app/models/refresh_token.rb
      - packages/apps/app/models/scoped_integration_installable.rb
      - packages/apps/test/jobs/proxima_app_sync/create_app_job_helper_test.rb
      - packages/apps/test/jobs/proxima_app_sync/create_first_party_app_job_test.rb
      - packages/apps/test/jobs/proxima_app_sync/create_third_party_app_job_test.rb
      - packages/apps/test/jobs/proxima_app_sync/update_app_job_helper_test.rb
      - packages/apps/test/jobs/proxima_app_sync/update_first_party_app_job_test.rb
      - packages/apps/test/jobs/proxima_app_sync/update_third_party_app_job_test.rb
      - packages/apps/test/models/integration/installation_service_test.rb
      - packages/apps/test/models/integration/permissions_test.rb
      - packages/apps/test/models/integration_installation/permission_target_test.rb
      - packages/apps/test/models/integration_installation/permissions_editor_test.rb
      - packages/apps/test/models/integration_installation/permissions_test.rb
      - packages/apps/test/models/integration_installation/single_file_test.rb
      - packages/apps/test/models/integration_test.rb
      - packages/apps/test/models/proxima_app_request/oauth_application_attribute_resolution_delegates_test.rb
      - packages/billing/app/models/billing/create_plan_subscription.rb
      - packages/billing/app/models/billing/create_subscription_item.rb
      - packages/billing/app/models/billing/enterprise_cloud_trial.rb
      - packages/billing/app/models/billing/plan_change/per_seat_pricing_model.rb
      - packages/billing/app/models/billing/schedule_plan_change.rb
      - packages/billing/app/models/billing/stripe_connect/account.rb
      - packages/billing/app/models/billing/subscription_item_updater.rb
      - packages/billing/test/models/billing_external_email_test.rb
      - packages/branch_protections/app/models/protected_branch.rb
      - packages/collaboration/app/models/referenceable.rb
      - packages/community_and_safety/app/models/user_content_editable.rb
      - packages/data/app/models/primary_avatar.rb
      - packages/discussions/app/models/repository/discussions_dependency.rb
      - packages/discussions/test/models/discussion_category_test.rb
      - packages/discussions/test/models/discussion_edit_test.rb
      - packages/discussions/test/models/discussion_event_test.rb
      - packages/discussions/test/models/discussion_section_test.rb
      - packages/discussions/test/models/discussion_spotlight_test.rb
      - packages/enterprise/app/models/enterprise_installation.rb
      - packages/enterprise/app/models/enterprise_installation_user_accounts_upload.rb
      - packages/external_identities/app/models/user_provisioning_status.rb
      - packages/github_sponsors/app/models/invoiced_sponsorship_transfer.rb
      - packages/github_sponsors/app/models/repository/sponsors_dependency.rb
      - packages/github_sponsors/app/models/sponsors/create_sponsorship.rb
      - packages/github_sponsors/app/models/sponsors_listing.rb
      - packages/github_sponsors/app/models/sponsorship.rb
      - packages/github_sponsors/test/models/sponsors_activity_test.rb
      - packages/health/app/models/spam/markable_as_spammy.rb
      - packages/health/app/models/suspension/suspension_dependency.rb
      - packages/import_export/app/models/migration_file.rb
      - packages/import_export/test/models/importable_pull_request_test.rb
      - packages/issues/app/models/deleted_issue.rb
      - packages/issues/app/models/issue.rb
      - packages/issues/app/models/issue/assignment_dependency.rb
      - packages/issues/app/models/pinned_issue.rb
      - packages/management_tools/app/models/account_screening_profile.rb
      - packages/management_tools/app/models/feature_enrollment.rb
      - packages/management_tools/app/models/ofac_downgrade.rb
      - packages/management_tools/app/models/trade_controls/abstract_trade_screening_dependency.rb
      - packages/management_tools/app/models/trade_controls/restriction.rb
      - packages/marketplace/test/models/marketplace/listing_test.rb
      - packages/notifications/app/models/newsies/thread_subscription.rb
      - packages/notifications/app/models/rollup_summary.rb
      - packages/orgs/app/models/organization.rb
      - packages/orgs/app/models/organization/invitations_dependency.rb
      - packages/orgs/app/models/team_sync/business_tenant.rb
      - packages/orgs/app/models/team_sync/tenant.rb
      - packages/orgs/test/models/discussion_post_reply_test.rb
      - packages/planning/app/models/memex_project_item/column_dependency.rb
      - packages/planning/app/models/memex_project_item/convert_to_issue.rb
      - packages/programmatic_access/app/models/programmatic_access_with_grant_and_token/creator.rb
      - packages/programmatic_access/test/models/user_programmatic_access_test.rb
      - packages/programmatic_access/test/public/programmatic_access_test.rb
      - packages/pull_requests/app/models/merge_queues/command.rb
      - packages/pull_requests/app/models/pull_request_review_comment.rb
      - packages/pull_requests/app/models/reminder.rb
      - packages/pull_requests/app/models/repository/pull_request_dependency.rb
      - packages/releases/app/models/release_asset.rb
      - packages/repositories/app/models/create_repository_orchestration.rb
      - packages/repositories/app/models/git_repository_access.rb
      - packages/repositories/app/models/purge_repository_orchestration.rb
      - packages/repositories/app/models/repository/archived_dependency.rb
      - packages/repositories/app/models/repository/lock_dependency.rb
      - packages/repositories/app/models/repository/organizations_dependency.rb
      - packages/repositories/app/models/repository/visibility_dependency.rb
      - packages/repositories/app/models/repository_invitation.rb
      - packages/repositories/app/models/repository_orchestration.rb
      - packages/repositories/test/jobs/bulk_repos_index_job_test.rb
      - packages/repositories/test/models/repository_can_add_user_test.rb
      - packages/secret_scanning/app/models/token_scan_status.rb
      - packages/security_products/app/models/repository_advisory.rb
      - packages/security_products/app/models/security_product/vulnerability_alerts.rb
      - packages/security_products/test/models/repository_advisory_test.rb
      - packages/stars/app/models/user/stars_dependency.rb
      - packages/stars/app/private/stars/creation.rb
      - packages/substrate/app/models/configuration.rb
      - packages/substrate/app/models/global_notice.rb
      - packages/users/app/models/destroy_user_callbacks.rb
      - packages/users/app/models/user.rb
      - test/integration/api/app_test.rb
      - test/integration/api/internal/twirp/classroom/repositories/v1/repositories_api_handler/get_total_commits_test.rb
      - test/integration/api/repository_advanced_security_test.rb
      - test/integration/api/repository_secret_scanning_push_protection_test.rb
      - test/integration/api/repository_settings_secret_scanning_test.rb
      - test/integration/api/repository_settings_security_updates_test.rb
      - test/integration/hydro_request_events_test.rb
      - test/integration/integration_installations_controller/create_test.rb
      - test/integration/integration_installations_controller/update_test.rb
      - test/integration/integration_installations_controller_test.rb
      - test/integration/oauth_controller_test.rb
      - test/integration/orgs/installations_controller_test.rb
      - test/integration/settings/installations_controller_test.rb
      - test/jobs/packages/billing_storage_reconcilation_job_test.rb
      - test/lib/apps/internal/copilot_intellij_plugin_test.rb
      - test/lib/configurable/microsoft_support_plan_test.rb
      - test/lib/configurable/support_plan_test.rb
      - test/platform/mutations/prepare_import_test.rb
      - test/script/seeds/objects/check_suite_test.rb
      - test/script/seeds/objects/deployment_test.rb
      - test/script/seeds/objects/integration_install_trigger_test.rb
      - test/script/seeds/objects/integration_test.rb
      - test/script/seeds/objects/oauth_application_test.rb
      - test/script/seeds/objects/reminder_test.rb
      - test/script/seeds/runners/check_run_test.rb
      - test/script/seeds/runners/deployments_test.rb
      - test/script/seeds/runners/internal_integrations_test.rb
      - test/view_models/integration_installations/access_groupings_view_test.rb
      - test/view_models/integration_installations/permissions_update_request_view_test.rb
      - test/view_models/integrations/select_target_view_test.rb
      - test/view_models/marketplace_purchases/order_preview_view_test.rb
      - test/view_models/oauth/authorize_integration_view_test.rb
      - test/view_models/oauth/authorize_view_test.rb

  throttler:
    ignore:
      # These are existing violations that it'd be good to eventually fix
      - app/api/internal/twirp/octoshift/imports/v1/import_project_api_handler.rb
      - app/jobs/destroy_team_dependants_job.rb
      - app/jobs/enforce_two_factor_requirement_on_business_job.rb
      - app/jobs/sync_scoped_integration_installations_job.rb
      - lib/authorization/commands/clear_abilities_for_multiple_participants.rb
      - lib/configurable/default_repository_permission.rb
      - lib/github/prioritizable/context.rb
      - lib/github/transitions/20220330231603_backfill_multi_licensed_repositories.rb
      - packages/actions/app/models/actions_policy/allowlist.rb
      - packages/actions/app/models/actions_policy/required_workflow_repository.rb
      - packages/app_security/app/models/ability.rb
      - packages/app_security/app/models/ability/grant.rb
      - packages/app_security/app/models/oauth_authorization/creator.rb
      - packages/apps/app/models/integration_installation/editor.rb
      - packages/apps/app/models/integration_installation/permissions_editor.rb
      - packages/apps/app/models/integration_installation/repository_editor.rb
      - packages/branch_protections/app/models/protected_branch.rb
      - packages/codespaces/app/commands/codespaces/restore.rb
      - packages/discussions/app/models/issue_to_discussion_converter.rb
      - packages/enterprise/app/models/enterprise_installation_user_accounts_importer.rb
      - packages/issues/app/models/issue/alert_links_dependency.rb
      - packages/issues/app/models/milestone/prioritization_dependency.rb
      - packages/management_tools/app/models/experiment.rb
      - packages/orgs/app/models/team/membership.rb
      - packages/orgs/app/models/team/parent_change/recalculate_abilities_operation.rb
      - packages/orgs/app/models/team/parent_change/recalculate_subscriptions_operation.rb
      - packages/orgs/app/models/user/organizations_dependency.rb
      - packages/programmatic_access/app/models/programmatic_access_grant_request/service.rb
      - packages/security_products/app/models/repository_vulnerability_alert.rb
      - packages/stacks/app/models/stacks_policy/stacks_allowlist.rb
      - packages/users/app/models/destroy_user_callbacks.rb
      - packages/users/app/models/user.rb

      # These jobs don't necessarily throttle inside a transaction, rather
      # the job gets enqueued inside a transaction and then we run it with
      # `perform_now` in test. Jobs shouldn't be enqueued from within a
      # transaction, so if we fix that we can revisit these to see if they
      # are actually violations.
      - packages/application/app/jobs/destroy_dependent_records_job.rb
      - app/jobs/external_group_team_unlink_job.rb
      - app/jobs/github_connect_destroy_installation_contributions_job.rb
      - app/jobs/ignore_user_job.rb
      - app/jobs/newsies/copy_thread_subscribers_job.rb
      - app/jobs/newsies/delete_all_for_thread_job.rb
      - app/jobs/newsies/delete_all_for_user_and_lists_job.rb
      - app/jobs/newsies/delete_all_for_user_job.rb
      - app/jobs/newsies/deliver_notifications_job.rb
      - app/jobs/packages/append_package_codespaces_permissions_for_repository_job.rb
      - app/jobs/process_email_domain_for_reputation_data_job.rb
      - app/jobs/process_mentioned_references_job.rb
      - app/jobs/remove_oauth_user_tokens_job.rb
      - app/jobs/remove_org_admin_job.rb
      - app/jobs/remove_org_member_job.rb
      - app/jobs/restore_organization_user_job.rb
      - app/jobs/subscribe_and_notify_job.rb

  ethon:
    ignore:
      # factory_bot creates records in ways that don't match production usage
      - factory_bot

      # Authzd
      - packages/app_security/app/models/permissions/authorizer.rb

      # Spokes
      - packages/git/app/models/git/ref/collection.rb
      - packages/git/app/models/repository/refs_dependency.rb
      - packages/repositories/app/models/create_repository_orchestration.rb
      - packages/repositories/app/models/fork_repository_orchestration.rb
      - packages/repositories/app/models/pushes/changed_files_helper.rb
      - packages/repositories/app/models/pushes/commits_helper.rb
      - packages/stars/app/models/user/stars_dependency.rb
      # spokesd is now enabled for some tests, this lead few tests
      # to make spokesd calls during transactions.
      - lib/github/spokes/client/spokesd.rb
      - packages/spokes_api/app/public/spokesapi/client.rb

      # Elastomer
      - packages/management_tools/app/models/account_screening_profile.rb
      # These jobs don't necessarily make an http call in a transaction, rather
      # the job gets enqueued inside a transaction and then we run it with
      # `perform_now` in test. Jobs shouldn't be enqueued from within a
      # transaction, so if we fix that we can remove this ignore.
      - app/jobs/add_to_search_index_job.rb
      - app/jobs/log_audit_entry_job.rb
      - app/jobs/remove_from_search_index_job.rb

  excon:
    ignore:
      # factory_bot creates records in ways that don't match production usage
      - factory_bot

      # Our test helpers enqueue jobs inside transactions in awkward places
      # before the test adapter has been set up. We've got jobs enqueued inside
      # transactions covered elsewhere, so we can ignore them here.
      - lib/active_job/queue_adapters/aqueduct_adapter.rb

      # Aleph index_repository inside a transaction
      # https://github.com/github/github/blob/57f5ab5e6f588509eef37e8b75b516a9ca91369c/packages/security_products/app/models/security_product/vulnerability_alerts.rb#L90
      # https://github.com/github/github/blob/57f5ab5e6f588509eef37e8b75b516a9ca91369c/app/controllers/repos/security_and_analysis/settings_controller.rb#L158-L161
      - app/controllers/repos/security_and_analysis/settings_controller.rb
      # https://github.com/github/github/blob/57f5ab5e6f588509eef37e8b75b516a9ca91369c/lib/configurable/repository_vulnerability_alerts.rb#L131-L133
      - lib/configurable/repository_vulnerability_alerts.rb

      # gpg_verify inside a mysql1 transaction
      # https://github.com/github/github/blob/57f5ab5e6f588509eef37e8b75b516a9ca91369c/lib/platform/provisioning/base_identity_provisioner.rb#L897
      - app/platform/provisioning/base_identity_provisioner.rb
      - app/platform/provisioning/enterprise_server_identity_provisioner.rb

      # artifacts_exchange_client twirp call inside repositories_actions_checks transactions (via before_destroy callbacks)
      # https://github.com/github/github/blob/57f5ab5e6f588509eef37e8b75b516a9ca91369c/packages/actions/app/models/artifact.rb#L26
      - packages/actions/app/models/artifact.rb
      # https://github.com/github/github/blob/57f5ab5e6f588509eef37e8b75b516a9ca91369c/packages/checks/app/models/check_suite.rb#L75
      - packages/checks/app/models/check_suite.rb

      # Authnd call inside permissions transaction
      # https://github.com/github/github/blob/57f5ab5e6f588509eef37e8b75b516a9ca91369c/packages/programmatic_access/app/models/programmatic_access_grant_request/service.rb#L136-L139
      - packages/programmatic_access/app/models/programmatic_access_grant_request/service.rb

  httprb:
    ignore:
      # factory_bot creates records in ways that don't match production usage
      - factory_bot

  net-http:
    ignore:
      # These are existing violations where we make Net::HTTP requests inside
      # a transaction. It'd be good to eventually fix these.
      - lib/github/billing/zuora_paypal.rb
      - packages/billing/app/models/billing/auto_pay.rb
      - packages/billing/app/models/billing/create_customer.rb
      - packages/billing/app/models/billing/zuora/account.rb
      - packages/billing/app/models/billing/zuora/invoice.rb
      - packages/billing/app/models/billing/zuora_subscription.rb
      - packages/billing/app/models/customer.rb
      - packages/community_and_safety/app/models/retired_namespace.rb
      - packages/github_sponsors/app/models/sponsors_patreon_user.rb
      - packages/hierarchy/app/models/issue/issues_graph_dependency.rb

      # This job doesn't necessarily make an http call in a transaction, rather
      # the job gets enqueued inside a transaction and then we run it with
      # `perform_now` in test. Jobs shouldn't be enqueued from within a
      # transaction, so if we fix that we can remove this ignore.
      - app/jobs/sync_issue_to_issues_graph_job.rb
      # Toxiproxy is only used in test. We need to ignore this to avoid
      # erroring on legitimate mysql queries that pass through the proxy.
      - toxiproxy
      # These are likely legitimate violations, but we can treat sending email
      # from within a transaction as its own category.
      - action_mailer

  webmock:
    ignore:
      - app/api/internal/twirp/octoshift/imports/v1/import_commit_comment_api_handler.rb
      - app/api/pull_comments.rb
      - app/api/repository_commit_comments.rb
      - app/controllers/commit_comments_controller.rb
      - app/controllers/discussions_controller.rb
      - app/jobs/code_scanning/comment_creator.rb
      - app/platform/mutations/add_discussion_comment.rb
      - app/platform/mutations/add_pull_request_review_comment.rb
      - app/platform/mutations/add_pull_request_review_thread_reply.rb
      - app/platform/mutations/create_discussion.rb
      - app/platform/mutations/update_discussion.rb
      - app/platform/mutations/update_discussion_comment.rb
      - app/platform/mutations/update_pull_request_review_comment.rb
      - lib/github/minimize_comment.rb
      - lib/github/rate_limited_creation.rb
      - packages/collaboration/app/models/referrer.rb
      - packages/community_and_safety/test/models/user/ignore_dependency_test.rb
      - packages/discussions/app/models/discussion.rb
      - packages/discussions/app/models/discussion/locking_dependency.rb
      - packages/discussions/app/models/discussion/state_dependency.rb
      - packages/discussions/app/models/discussion_comment.rb
      - packages/discussions/app/models/discussion_comment/creator.rb
      - packages/discussions/app/models/discussion_repository_transferrer.rb
      - packages/discussions/app/models/issue_to_discussion_converter.rb
      - packages/discussions/app/models/team_post_to_discussion_converter.rb
      - packages/discussions/test/models/discussion/search_adapter_test.rb
      - packages/discussions/test/models/discussion_comment/newsies_adapter_test.rb
      - packages/discussions/test/models/discussion_comment_test.rb
      - packages/discussions/test/models/discussion_event_test.rb
      - packages/discussions/test/models/discussion_poll/builder_test.rb
      - packages/discussions/test/models/discussion_repository_transferrer_test.rb
      - packages/discussions/test/models/discussion_test.rb
      - packages/discussions/test/models/discussion_timeline/permission_preloader_test.rb
      - packages/discussions/test/models/discussion_transfer_test.rb
      - packages/discussions/test/models/discussion_vote_test.rb
      - packages/discussions/test/models/issue_to_discussion_converter_test.rb
      - packages/import_export/test/models/importable_pull_request_review_comment_test.rb
      - packages/issues/app/jobs/attach_matching_assets_job.rb
      - packages/issues/app/models/issue.rb
      - packages/issues/test/models/attachment_test.rb
      - packages/pull_requests/app/models/create_new_pull_request_review_comment_orchestration.rb
      - packages/pull_requests/app/models/create_reply_pull_request_review_comment_orchestration.rb
      - packages/pull_requests/app/models/pull_request_review/creator.rb
      - packages/pull_requests/app/models/pull_request_review_comment.rb
      - packages/pull_requests/app/models/review_thread_creator.rb
      - packages/pull_requests/app/models/review_thread_replier.rb
      - packages/pull_requests/test/models/commit_comment_edit_test.rb
      - packages/pull_requests/test/models/pull_request/comparison_test.rb
      - packages/pull_requests/test/models/pull_request/review_requests_dependency_test.rb
      - packages/pull_requests/test/models/pull_request/thread_positioner_test.rb
      - packages/pull_requests/test/models/pull_request_review_comment/async_adjusted_blob_position_test.rb
      - packages/pull_requests/test/models/pull_request_review_comment/legacy_position_data_test.rb
      - packages/pull_requests/test/models/pull_request_review_comment/suggested_change_selection_test.rb
      - packages/pull_requests/test/models/pull_request_review_comment_test.rb
      - packages/pull_requests/test/models/pull_request_review_comment_workflow_test.rb
      - packages/pull_requests/test/models/pull_request_review_test.rb
      - packages/pull_requests/test/models/pull_request_review_thread/positioning_test.rb
      - packages/pull_requests/test/models/pull_request_review_thread_test.rb
      - packages/pull_requests/test/models/reminders/comment_reply_finder_test.rb
      - packages/releases/app/models/release.rb
      - packages/security_products/test/jobs/code_scanning/hydro_emit_code_scanning_review_comment_reply_job_test.rb
      - packages/profiles/test/models/contribution/created_pull_request_review_test.rb
      - test/components/discussions/comment_component_test.rb
      - test/components/discussions/content_component_test.rb
      - test/components/discussions/issue_modal_component_test.rb
      - test/components/discussions/nested_comment_component_test.rb
      - test/components/discussions/sidebar_component_test.rb
      - test/components/discussions/vote_form_component_test.rb
      - test/components/pull_requests/review_thread_body_component_test.rb
      - test/components/pull_requests/review_thread_paged_comments_component_test.rb
      - test/helpers/news_feed_helper_test.rb
      - test/integration/api/repository_commit_comments_test.rb
      - test/integration/commit_comments_controller_test.rb
      - test/integration/commit_controller_test.rb
      - test/integration/discussions/comment_counts_controller_test.rb
      - test/integration/discussions/discussions_show_performance_test.rb
      - test/integration/discussions_controller_test.rb
      - test/integration/hooks/discussion_comments_hook_test.rb
      - test/integration/hooks/discussions_hook_test.rb
      - test/integration/profiles/achievement_unlocking_model/commit_comment_test.rb
      - test/integration/pull_request_comment_threads_test.rb
      - test/integration/pull_request_review_comments_controller_test.rb
      - test/integration/stafftools/comments_controller_test.rb
      - test/jobs/hydro_emit_code_scanning_review_resolve_job_test.rb
      - test/jobs/hydro_emit_code_scanning_review_unresolve_job_test.rb
      - test/jobs/reminders/review_submission_job_test.rb
      - test/lib/github/goomba/async/rich_issue_mention_filter_test.rb
      - test/lib/github/spam_checker_test.rb
      - test/lib/newsies/rollup_summary_test.rb
      - test/platform/mutations/unsubscribe_from_notifications_test.rb
      - test/platform/mutations/update_subscription_test.rb
      - test/platform/objects/commit_comment_test.rb
      - test/platform/objects/discussion_comment_test.rb
      - test/platform/objects/discussion_test.rb
      - test/platform/objects/pull_request_review_comment_test.rb
      - test/platform/objects/repository/private_repository_authz_test.rb
      - test/script/seeds/objects/commit_comment_test.rb
      - test/script/seeds/objects/discussion_test.rb
      - test/test_helpers/github/basic_test_case.rb
