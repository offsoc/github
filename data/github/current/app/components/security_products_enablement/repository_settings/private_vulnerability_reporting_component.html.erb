<% if available? %>
  <div <%= test_selector("private-vulnerabitlity-reporting-settings")%>>
    <div class="d-flex flex-md-row flex-column flex-md-items-center py-3 border-bottom border-top color-border-muted">
      <div class="mb-md-0 mb-2 mr-4 flex-auto col-md-10">
        <h3 class="h4">
          Private vulnerability reporting
        </h3>
        <p class="mb-0">
          Allow your community to privately report potential security vulnerabilities to maintainers and repository owners.
          <%= link_to(
            "Learn more about private vulnerability reporting",
            helpers.docs_url("code-security/privately-reporting-security-vulnerability", ghec: GitHub.enterprise?),
            target: "_blank",
            class: "Link--inTextBlock") %>.
        </p>

        <% if has_mixed_restrictions? %>
          <%= render(SecurityProductsEnablement::RepositoryCodeSecurityPolicyNotificationComponent.new(helpers.owner, mt: 2)) %>
        <% end %>
      </div>
      <div>
        <% if restricted? %>
          <div class="BtnGroup flex-auto">
            <div <%= test_selector("private-vulnerabitlity-reporting-restricted-status") %>>
              <%= render Primer::Beta::Octicon.new(:"shield-lock", color: :muted, test_selector: "shield-icon") if display_shield_icon? %>
              <% if is_currently_enabled? %>
                Enabled
              <% else %>
                Disabled
              <% end %>
            </div>
          </div>
        <% else %>
          <div class="BtnGroup flex-auto" <%= test_selector("private-vulnerabitlity-reporting-toggle-buttons") %>>
            <%= form_tag update_security_products_settings_path(helpers.owner, current_repository), method: :put do %>
              <% if is_currently_enabled? %>
                <input type="hidden" name="private_vulnerability_reporting_enabled" value="0">
                <%= render Primer::Beta::Button.new(type: :submit, scheme: :danger, "aria-label": "Disable private vulnerability reporting", px: 3) do %>
                  Disable
                <% end %>
              <% else %>
                <input type="hidden" name="private_vulnerability_reporting_enabled" value="1">
                <%= render Primer::Beta::Button.new(type: :submit, block: true, "aria-label": "Enable private vulnerability reporting", px: 3) do %>
                  Enable
                <% end %>
              <% end %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
<% end %>
