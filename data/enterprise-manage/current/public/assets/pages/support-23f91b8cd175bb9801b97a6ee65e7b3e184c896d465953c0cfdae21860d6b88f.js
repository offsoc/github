(function(){this.BackgroundJob=function(){function t(t){this.options=t,this.intervalId=null,this.onComplete=this.options.success,this.onWorking=this.options.working,this.onFailure=this.options.failure||function(){return console.log("error")},this.onError=this.options.error||function(){return console.log("error")}}return t.prototype.run=function(t){var r;return r=this,$.ajax({url:t,type:"POST",success:function(t){var n;return(n=t.redirect_to)&&(document.location.href=n),r.startPolling(t.polling_path)},error:function(t){return r.clean(),r.onError(t)}})},t.prototype.startPolling=function(t){var r,n;return r=function(){return n.check(t)},(n=this).intervalId=setInterval(r,1e3)},t.prototype.check=function(t){var r;return r=this,$.ajax({url:t,success:function(t){var n;switch((n=t.redirect_to)&&(document.location.href=n),t.status){case"complete":return r.clean(),r.onComplete(t,r);case"failed":return r.clean(),r.onFailure(t,r);case"running":if(r.onWorking)return r.onWorking(t,r)}},error:function(t){return r.clean(),r.onError(t,r)}})},t.prototype.clean=function(){if(this.intervalId)return clearInterval(this.intervalId)},t}()}).call(this),function(){$(document).ready(function(){var t,r,n,e;return e=$(".js-download-support-bundle"),t=$(".js-diagnostics-info"),n=$(".js-download-support-bundle-progress"),r=$(".js-download-diagnostics-progress"),$(document).on("click",".js-new-support-ticket",function(){return window.location="/setup/support/new_request"}),e.click(function(r){var e,o,i;return r.preventDefault(),(e=$(this)).attr("disabled",!0),t.attr("disabled",!0),i=function(){return n.hide(),e.attr("disabled",!1)},o=new BackgroundJob({success:function(){return n.hide(),e.attr("disabled",!1),t.attr("disabled",!1),window.location="/setup/github-support-bundle.tgz"},failure:i,error:i}),n.show(),o.run("/setup/support/bundle")}),t.click(function(t){var n,o,i;return t.preventDefault(),(n=$(this)).attr("disabled",!0),e.attr("disabled",!0),i=function(){return r.hide(),n.attr("disabled",!1)},o=new BackgroundJob({success:function(){return r.hide(),n.attr("disabled",!1),e.attr("disabled",!1)},failure:i,error:i}),r.show(),o.run("/setup/diagnostics")})})}.call(this);