"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_code-mirror_CodeMirror_tsx-_d4d71"],{18558:(e,r,t)=>{t.d(r,{JC:()=>o.JC,KK:()=>o.KK,SK:()=>n,Vy:()=>o.Vy,ai:()=>o.ai,oc:()=>o.oc,rd:()=>o.rd});var o=t(50515);let a=/(?:^|,)((?:[^,]|,(?=\+| |$))*(?:,(?=,))?)/g;function n(e){return Array.from(e.matchAll(a)).map(([,e])=>e)}},98164:(e,r,t)=>{t.d(r,{$$:()=>c,GI:()=>n,zw:()=>a});var o=t(18558);let a=()=>{let e=document.querySelector("meta[name=keyboard-shortcuts-preference]");return!e||"all"===e.content},n=e=>/Enter|Arrow|Escape|Meta|Control|Mod|Esc/.test(e)||e.includes("Alt")&&e.includes("Shift"),l=new Set(["button","checkbox","color","file","hidden","image","radio","range","reset","submit"]),c=e=>{let r=(0,o.Vy)(e),t=a()&&!function(e){if(!(e instanceof HTMLElement))return!1;let r=e.nodeName.toLowerCase(),t=e.getAttribute("type")?.toLowerCase()??"text",o="true"===e.ariaReadOnly||"true"===e.getAttribute("aria-readonly")||null!==e.getAttribute("readonly");return("select"===r||"textarea"===r||"input"===r&&!l.has(t)||e.isContentEditable)&&!o}(e.target);return n(r)||t}},64846:(e,r,t)=>{t.r(r),t.d(r,{default:()=>J});var o=t(9449),a=t(24774),n=t(55293),l=t(6585),c=t(5853),i=t(9299),s=t(45230),d=t(54528),u=t(15874);let m=(0,t(98164).zw)()?[]:[{key:"Alt-g",run:()=>!0,preventDefault:!0}],f=[(0,s.b6)(),(0,u.WD)(),(0,a.$K)(),(0,u.SG)(),(0,a.vX)({position:"absolute"}),(0,d.$P)({top:!0}),a.Lz.editorAttributes.of({class:"js-codemirror-editor","data-testid":"codemirror-editor"}),a.w4.of([...m,...s.pw,...d.Eo,...s.cL])];var p=t(43720);let g={"&":{background:"var(--codeMirror-bgColor, var(--color-codemirror-bg))",color:"var(--codeMirror-fgColor, var(--color-codemirror-text))",cursor:"text"},".cm-gutters":{background:"var(--codeMirror-gutters-bgColor, var(--color-codemirror-gutters-bg))",borderRightWidth:0},".cm-lineNumbers .cm-gutterElement":{color:"var(--codeMirror-lineNumber-fgColor, var(--color-codemirror-linenumber-text))",fontFamily:"var(--fontStack-monospace)",fontSize:"12px",lineHeight:"20px",padding:"0 16px 0 16px"},".cm-content":{caretColor:"var(--codeMirror-cursor-fgColor, var(--color-codemirror-cursor))",fontFamily:"var(--fontStack-monospace)",fontSize:"12px",background:"var(--codeMirror-lines-bgColor, var(--color-codemirror-lines-bg))",lineHeight:"20px",paddingTop:"8px"},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"var(--codeMirror-selection-bgColor, var(--color-codemirror-selection-bg, #d7d4f0))"},"&.cm-focused":{outline:"none"},"&.hide-help-until-focus":{"&.cm-focused .cm-panels-bottom":{display:"block"},"& .cm-panels-bottom":{display:"none"}},".cm-content ::-moz-selection":{backgroundColor:"var(--codeMirror-selection-bgColor, var(--color-codemirror-selection-bg, #d7d4f0))"},".cm-activeLine":{backgroundColor:"var(--codeMirror-activeline-bgColor, var(--color-codemirror-activeline-bg))"},".cm-line":{paddingLeft:"16px"},".cm-help-panel":{background:"var(--bgColor-muted, var(--color-canvas-subtle))",padding:"7px 10px",margin:0,fontSize:"13px",lineHeight:"16px",color:"var(--fgColor-muted, var(--color-fg-muted))",cursor:"default"},".cm-panels-bottom":{borderTop:"var(--borderWidth-thin, 1px) solid var(--borderColor-default, var(--color-border-default))",background:"none"},".js-upload-markdown-image & .cm-panels-bottom":{bottom:"30px !important"},".cm-panel.cm-search":{background:"var(--bgColor-muted, var(--color-canvas-subtle))",padding:"8px",fontSize:"16px"},".cm-panel.cm-search > button":{borderRadius:"6px",padding:"4px 8px",background:"var(--codeMirror-bgColor, var(--color-codemirror-bg))",color:"var(--button-default-fgColor-rest, var(--color-btn-text))",border:"1px solid var(--button-default-borderColor-rest, var(--color-btn-border))",textTransform:"capitalize"},".cm-panel.cm-search > label":{color:"var(--fgColor-default, var(--color-fg-default))",textTransform:"capitalize",fontSize:"12px"},".cm-panel.cm-search > input":{borderRadius:"6px",padding:"4px 8px",background:"var(--bgColor-default, var(--color-canvas-default))",color:"var(--fgColor-default, var(--color-fg-default))",border:"1px solid var(--borderColor-default, var(--color-border-default))",fontSize:"12px"},'.cm-panel.cm-search > button[name="close"]':{padding:"4px"},".cm-panels-top":{borderBottom:"var(--borderWidth-thin, 1px) solid var(--color-border-default)",background:"none"},".cm-panel.cm-search input, .cm-panel.cm-search button, .cm-panel.cm-search label":{marginRight:"8px",marginBottom:"4px",marginTop:"4px",marginLeft:0},".cm-lintRange":{cursor:"help",backgroundImage:"none !important"},".cm-placeholder":{height:"1em"},"&.custom-tooltips .cm-tooltip":{border:"none !important",backgroundColor:"transparent !important"},"&.custom-tooltips .cm-diagnostic":{padding:0,marginLeft:"0 !important",borderLeft:"none !important",whiteSpace:"unset"}},b=[{tag:[p._A.keyword],color:"var(--codeMirror-syntax-fgColor-keyword, var(--color-codemirror-syntax-keyword))"},{tag:[p._A.comment],color:"var(--codeMirror-syntax-fgColor-comment, var(--color-codemirror-syntax-comment))"},{tag:[p._A.bracket],color:"var(--codeMirror-matchingBracket-fgColor, var(--color-codemirror-matchingbracket-text))"},{tag:[p._A.string,p._A.url,p._A.regexp],color:"var(--codeMirror-syntax-fgColor-string, var(--color-codemirror-syntax-string))"},{tag:[p._A.constant(p._A.name),p._A.propertyName,p._A.attributeName],color:"var(--codeMirror-syntax-fgColor-constant, var(--color-codemirror-syntax-constant))"},{tag:[p._A.atom,p._A.number,p._A.bool],color:"var(--codeMirror-syntax-fgColor-constant, var(--color-codemirror-syntax-constant))"},{tag:[p._A.function(p._A.variableName)],color:"var(--codeMirror-syntax-fgColor-entity, var(--color-codemirror-syntax-entity))"},{tag:p._A.definition(p._A.variableName),color:"var(--codeMirror-syntax-fgColor-variable, var(--color-codemirror-syntax-variable))"},{tag:p._A.meta,color:"inherit"},{tag:p._A.heading,fontWeight:"bold",color:"inherit !important"},{tag:p._A.monospace,color:"var(--codeMirror-syntax-fgColor-comment, var(--color-codemirror-syntax-comment))"}],v=[{tag:p._A.link,textDecoration:"underline"},{tag:p._A.emphasis,fontStyle:"italic"},{tag:p._A.strong,fontWeight:"bold"},{tag:p._A.strikethrough,textDecoration:"line-through"}],h=[...b,...v],x=[...b,...v];function y(e=[]){let r=[...null!==document.querySelector('[data-color-mode="dark"]')?x:h,...e];return[a.Lz.theme(g),(0,u.y9)(u.cr.define(r),{fallback:!0})]}let k=e=>{let r=[l.$t.tabSize.of(e.indentUnit)];return e.indentWithTabs?r.push(u.Xt.of("	")):r.push(u.Xt.of(" ".repeat(e.indentUnit))),e.lineWrapping&&r.push(a.Lz.lineWrapping),r};var C=t(66465);let w=(e,r)=>{let{state:t,placeholder:o,replacementText:a}=e.detail;"uploading"===t?(0,C.w0)(r)?(0,C.tJ)(r,o):(0,C.TC)(r,a):("uploaded"===t||"failed"===t)&&(0,C.TB)(r,o,a)},M=(e,r)=>{let{left:t,top:o}=e.detail,a=r.posAtCoords({x:t,y:o});a&&r.dispatch({selection:{anchor:a,head:a}})},A=new WeakMap;function _(e,r){if((0,C.w0)(e)){let t=(0,C.Lo)(e.state);(0,C.tJ)(e,`${r}${t}${r}`)}else{let t=(0,C.BE)(e);(0,C.TC)(e,r.repeat(2)),(0,C.f9)(e,t.anchor+r.length)}return!0}function L(e,r){let t=(0,C.BE)(e),o=e.state.doc.lineAt(t.from),a=(0,C.Lo)(e.state),n=RegExp(`^${"ol"===r?"\\d+\\.":r}\\s`);if(a){let t=(a.endsWith("\n")?a.slice(0,-2):a).split("\n").map((r,t)=>{let a=o.number+t;return{text:e.state.doc.line(a).text,lineNumber:a}}),l=t.every(e=>n.test(e.text));for(let o=0;o<t.length;o++){let a=t[o];if(l){let r=a.text.match(n);r&&(0,C.YH)(e,a?.lineNumber,r[0])}else{let t=`${"ol"===r?`${o+1}.`:r} `;(0,C.Md)(e,a?.lineNumber,t)}}}else{let a=o.text.match(n);if(a)(0,C.YH)(e,o.number,a[0]);else{let a=`${"ol"===r?"1.":r} `;(0,C.Md)(e,o.number,a),o.text||(0,C.f9)(e,t.anchor+a.length)}}return!0}let E=[{key:"Mod-i",run:e=>_(e,"_"),preventDefault:!0},{key:"Mod-b",run:e=>_(e,"**"),preventDefault:!0},{key:"Mod-e",run:e=>_(e,"`"),preventDefault:!0},{key:"Mod-k",run:e=>{let r=(0,C.Lo)(e.state);if(r){let t=`[${r}](url)`;(0,C.tJ)(e,t);let o=(0,C.I6)(e,t).value.from;(0,C.td)(e,o+r.length+3,o+r.length+6)}else{let r=(0,C.BE)(e);(0,C.TC)(e,"[](url)"),(0,C.f9)(e,r.anchor+1)}return!0},preventDefault:!0},{key:"Shift-Mod-.",run:e=>L(e,">"),preventDefault:!0},{key:"Shift-Mod-7",run:e=>L(e,"ol"),preventDefault:!0},{key:"Shift-Mod-8",run:e=>L(e,"-"),preventDefault:!0},{key:"Mod-v",run:e=>(A.set(e,!1),!1)},{key:"Shift-Mod-v",run:e=>(A.set(e,!0),!1)}];function S(e){let r=a.NZ.line({attributes:{dir:"auto"}}),t=new l.vB;for(let{from:o,to:a}of e.visibleRanges)for(let n=o;n<=a;){let o=e.state.doc.lineAt(n);t.add(o.from,o.from,r),n=o.to+1}return t.finish()}let z=a.Z9.fromClass(class{update(e){(e.docChanged||e.viewportChanged)&&(this.decorations=S(e.view))}constructor(e){this.decorations=S(e)}},{decorations:e=>e.decorations}),$=[a.Lz.domEventHandlers({keydown(e){(e.metaKey||e.ctrlKey)&&"k"===e.key&&e.stopPropagation()},paste(e,r){A.get(r)||function(e,r){let t=(0,C.Lo)(e.state),o=r.clipboardData;if(t&&o){let a=o.getData("text/plain");if(!/^https?:\/\//i.test(a))return;a&&(r.preventDefault(),(0,C.tJ)(e,`[${t}](${a})`))}}(r,e),A.set(r,!1)}}),a.w4.of(E),z];var N=t(47404),T=t(5225),D=t(72646);let R=(0,T.A)(async function(){let e=new Request("/autocomplete/emojis_for_editor",{method:"GET",credentials:"same-origin",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),r=await fetch(e);if(200!==r.status)throw Error(`emoji request failed with a ${r.status}`);let t=await r.json();return Object.keys(t).map(e=>{let r=t[e];return{name:e,src:r[0],emoji:r[1]}})}),j=l.Pe.define({map:({from:e,to:r,severity:t},o)=>({from:o.mapPos(e),to:o.mapPos(r),severity:t})}),W=l.sU.define({create:()=>a.NZ.none,update(e,r){for(let t of(e=e.map(r.changes),r.effects))t.is(j)&&("error"===t.value.severity?e=e.update({add:[B.range(t.value.from,t.value.to)]}):"warning"===t.value.severity?e=e.update({add:[H.range(t.value.from,t.value.to)]}):"info"===t.value.severity&&(e=e.update({add:[O.range(t.value.from,t.value.to)]})));return e},provide:e=>a.Lz.decorations.from(e)}),B=a.NZ.mark({class:"CodeMirror-lint-mark-error"}),H=a.NZ.mark({class:"CodeMirror-lint-mark-warning"}),O=a.NZ.mark({class:"CodeMirror-lint-mark-info"}),q=(e,r)=>{let{from:t,to:o,severity:a}=e.detail,n=(0,C.TU)(r,{line:t.lineNumber,ch:t.character}),l=(0,C.TU)(r,{line:o.lineNumber,ch:o.character});r.dispatch({effects:[j.of({from:n,to:l,severity:a})]})},K={ruby:[{tag:p._A.variableName,color:"var(--codeMirror-syntax-fgColor-variable, var(--color-codemirror-syntax-variable))"}]},U=Object.keys(K);var P=t(55643);let Z={key:"Tab",run:({state:e,dispatch:r})=>e.selection.ranges.some(e=>!e.empty)?(0,s.UY)({state:e,dispatch:r}):(r(e.update(e.replaceSelection(e.facet(u.Xt)),{scrollIntoView:!0,userEvent:"input"})),!0),shift:s.Mg},I=(0,n.forwardRef)((e,r)=>{let{value:t="",extensions:s=[],keyBindings:d=[],height:u="85vh",width:m="100%",focusNextRenderRef:p,...g}=e,b=(0,n.useRef)(null),v=function({extensions:e=[],fileName:r="",onChange:t,spacing:o,isHpc:s,isReadOnly:d,enableFileUpload:u,parentRef:m,placeholder:p="Enter file contents here",ariaLabelledBy:g,value:b,width:v="",height:h="",minHeight:x="",hideHelpUntilFocus:C,onCreateEditor:A,onDestroyEditor:_}){let L=(0,n.useRef)(void 0),E=(0,n.useMemo)(()=>new l.xx,[]),S=(0,n.useMemo)(()=>new l.xx,[]),z=(0,n.useMemo)(()=>new l.xx,[]),T=(0,n.useCallback)(e=>{e.docChanged&&t(e.state.doc.toString()||"")},[t]),j=a.Lz.updateListener.of(T),B=a.Lz.theme({"&":{height:h,minHeight:x,width:v}}),H=(0,n.useMemo)(()=>[...f,j,B,(0,a.qf)(p),...k(o),[a.Lz.domEventHandlers({"secret-detected:lint":q}),W],E.of([]),S.of([]),z.of([y()]),[a.Z9.fromClass(class{constructor(e){e.scrollDOM.tabIndex=0,e.scrollDOM.setAttribute("role","region"),e.scrollDOM.setAttribute("aria-labelledby",g)}})],a.Lz.contentAttributes.of({"aria-labelledby":`${g} focus-trap-help-panel`}),a.Lz.editorAttributes.of({class:C?"hide-help-until-focus":""})],[j,B,p,o,E,S,z,g,C]);return u&&(H.push((0,a.A)()),H.push([a.Lz.domEventHandlers({"upload:editor:change":w,"upload:editor:cursor":M})])),s&&H.push(a.Lz.editorAttributes.of({"data-hpc":"true"})),d?H.push(l.$t.readOnly.of(!0)):H.push([function(e,r,t){let o=new l.xx;return[o.of(t?r:[]),a.w4.of([{key:e,run:function(e){let t=o.get(e.state)===r;return e.dispatch({effects:o.reconfigure(t?[]:r)}),!0}}])]}("Shift-Ctrl-m",a.w4.of([Z]),!0),(0,P.G)(function(){let e=document.createElement("div"),r=e=>{let r=document.createElement("kbd");return r.textContent=e,r};return e.append("Use ",r("Control + Shift + m")," to toggle the ",r("tab")," key moving focus. Alternatively, use ",r("esc")," then ",r("tab")," to move to the next interactive element on the page."),e.className="cm-help-panel",e.id="focus-trap-help-panel",e}())]),H=H.concat(e),(0,n.useEffect)(()=>{let e=m.current;if(!e)return;let r=l.$t.create({doc:b,extensions:H}),t=new a.Lz({state:r,parent:e});return A&&A(t),L.current=t,()=>{t.destroy(),_&&_(t)}},[]),(0,n.useEffect)(()=>{L.current&&(L.current.dispatch({effects:S.reconfigure([])}),L.current.dispatch({effects:l.Pe.reconfigure.of(H)}))},[S,H]),(0,n.useEffect)(()=>{if(L.current&&void 0!==b){let e=L.current.state.doc.toString()||"",r=b||"";r!==e&&L.current.dispatch({changes:{from:0,to:e.length,insert:r}})}},[b]),(0,n.useEffect)(()=>{let e=async()=>{let e=r.split(".").pop()||"",t=e?c.e.find(t=>t.extensions.includes(e)||t.filename&&t.filename.test(r)):void 0;if(t&&L.current){var o;let e=(o=t.name,U.includes(o.toLowerCase())?K[o.toLowerCase()]:null);e&&L.current.dispatch({effects:z.reconfigure(y(e))}),"Markdown"===t.name?(L.current.dispatch({effects:E.reconfigure((0,i.markdown)({base:i.markdownLanguage}))}),L.current.dispatch({effects:l.Pe.reconfigure.of([...$,...H])}),L.current.dispatch({effects:S.reconfigure([D.E,(0,N.yU)({override:[async e=>(function(e,r=[]){let t=e.matchBefore(/:\w+/);if(!t||t&&t.from===t.to&&!e.explicit)return null;let o=r.filter(e=>-1!==e.name.indexOf(t.text.replace(":",""))).map(e=>({label:e.name,apply:e.emoji||`:${e.name}:`,type:e.src}));return{from:t.from,to:t.to,options:o,filter:!1}})(e,await R())],icons:!1,addToOptions:[{render:e=>{let r=document.createElement("img");return r.className="emoji emoji-result mr-2",r.height=20,r.width=20,r.alt=`:${e.label}:`,r.src=e.type,r.setAttribute("async",""),r},position:0}]}),l.Nb.highest(a.w4.of([{key:"Tab",run:N.$w}]))])})):(L.current.dispatch({effects:S.reconfigure([])}),L.current.dispatch({effects:E.reconfigure(await t.load())}))}};L.current&&e()},[r,E,S,H,z]),L}({parentRef:b,value:t,height:u,width:m,extensions:[...s,a.w4.of(d)],...g});return(0,n.useImperativeHandle)(r,()=>({editor:b.current,view:v.current}),[b,v]),p?.current&&v&&(window.requestAnimationFrame(()=>{v.current&&!v.current.hasFocus&&v.current.focus()}),p.current=!1),(0,o.jsx)("div",{ref:b})});I.displayName="CodeMirror";let J=I}}]);
//# sourceMappingURL=ui_packages_code-mirror_CodeMirror_tsx-_d4d71-22f73daa496d.js.map