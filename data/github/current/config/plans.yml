# This file replaces plans.yml for Enterprise during the enterprise packaging
# step. The 'enterprise' plan is duplicated in config/plans.yml for test and
# development in enterprise mode.
# display_commenter_full_name.public: true is only enabled for GHES
default_features: &DEFAULT_FEATURES
  attestations.public: true
  attestations.private: false
  codeowners: true
  pages: true
  private_pages: true
  protected_branches: true
  protected_tags: true
  repos: true
  wikis: true
  insights: true
  projectsv2_charts_basic.public: true
  projectsv2_charts_basic.private: true
  repo_access_export: true
  fine_grained_permissions: true
  custom_roles: true
  draft_prs.public: true
  draft_prs.private: true
  display_commenter_full_name.private: true
  display_commenter_full_name.public: true
  display_verified_domain_emails: true
  restrict_notification_delivery: true
  audit_log_api: true
  custom_key_links: true
  reminders: false
  team_review_requests: true
  allow_codespaces: false
  insights_self_service: false
  private_secrets_and_variables: true
  merge_queue.public: false
  merge_queue.private: false
  enterprise_rulesets: false

default_limits: &DEFAULT_LIMITS
  collaborators: 999999999999
  repos.private: 999999999999
  repos.public: 999999999999
  raw_blob_access_expires_in_seconds: 604800 # 1 week
  raw_blob_access_expires_in_seconds.private: 3600 # 1 hour
  media_blob_max_size: 5368709120 # 5 GiB
  issue_pr_assignees: 10
  manual_review_requests: 15
  projectsv2_auto_add_workflows: 20

plans:
  - name    : free
    space   : 314572800
    cost    : 0
    orgs    : true
    features:
      <<: *DEFAULT_FEATURES
    org_features:
      ssh_certificates: true
      ip_allowlist: true
    limits:
      <<: *DEFAULT_LIMITS
      repos.private: 0

  # Special unlimited plan used for Enterprise installs.
  - name    : enterprise
    space   : 999999999999
    cost    : 0
    orgs    : true
    coupon  : false
    hidden  : true
    features:
      <<: *DEFAULT_FEATURES
      insights_self_service: true
      enterprise_rulesets: true
      projectsv2_insights_basic: true
    github_actions:
      included_private_minutes: 50000
    org_features:
      ssh_certificates: true
      ip_allowlist: true
    limits:
      <<: *DEFAULT_LIMITS
      repos.private: 999999999999
      manual_review_requests: 100

    # 'EMU' plan
  - name: emu_user
    cost: 0
    hidden: true
    orgs: false
    features: &FREE_FEATURES
      <<: *DEFAULT_FEATURES
      codeowners.private: true
      pages.private: false
      protected_branches.private: true
      protected_tags.private: true
      wikis.private: false
      insights.private: false
      fine_grained_permissions: true
      custom_roles: false
      reminders.private: false
      team_review_requests.private: false
      custom_key_links: true
      enterprise_rulesets: true
      projectsv2_insights_basic: true
    limits: &FREE_LIMITS
      <<: *DEFAULT_LIMITS
      raw_blob_access_expires_in_seconds.private: 60 # 1 minute
    github_actions:
      included_private_minutes: 2000
    package_registry:
      included_bandwidth_in_gigabytes: 1
    shared_storage:
      included_megabytes: 512
    codespaces:
      included_compute_minutes: 0
      included_storage_gigabyte_hours: 0
    org_limits:
      issue_pr_assignees.private: 1
      manual_review_requests.private: 1

  # 'Enterprise cloud' plan
  - name: business_plus
    hidden: true
    orgs: true
    features:
      <<: *DEFAULT_FEATURES
      attestations.private: true
      repo_access_export: true
      fine_grained_permissions: true
      custom_roles: true
      display_verified_domain_emails: true
      restrict_notification_delivery: true
      display_commenter_full_name.private: true
      display_commenter_full_name.public: false
      draft_prs.private: true
      audit_log_api: true
      custom_key_links: true
      private_pages: true
      projectsv2_charts_basic.private: true
      projectsv2_insights_basic: true
      allow_codespaces: true
      insights_self_service: true
      private_secrets_and_variables: true
      enterprise_rulesets: true
    org_features:
      ssh_certificates: true
      ip_allowlist: true
    limits:
      <<: *DEFAULT_LIMITS
      manual_review_requests: 100
      repos.private: 999999
      media_blob_max_size: 5368709120 # 5 GiB
    trial:
      github_actions:
        - included_private_minutes: 3000
          effective_at: "2021-11-01T00:00:00+00:00"
        - included_private_minutes: 2000
          effective_at: "2021-03-24T00:00:00+00:00"
    github_actions:
      included_private_minutes: 50000
    package_registry:
      included_bandwidth_in_gigabytes: 100
    shared_storage:
      included_megabytes: 51200
    codespaces:
      included_compute_minutes: 0
      included_storage_gigabyte_hours: 0
    rate_plans:
      business_plus_250:
        cost: 21
        yearly_cost: 250
        base_units: 1
        unit_cost: 21
        yearly_unit_cost: 250
        effective_at: "2000-01-01T00:00:00+00:00"
      business_plus_252:
        cost: 21
        yearly_cost: 252
        base_units: 1
        unit_cost: 21
        yearly_unit_cost: 252
        yearly_unit_cost_with_discount: 231
        yearly_discount_percentage: 8.3333333
        # Time is in UTC and converted to billing timezone in lib/github/plan.rb
        effective_at: "2019-04-24T17:00:00+00:00"
