"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_assets_modules_github_graphs_contributors-graph-element_ts"],{83836:(t,e,a)=>{a.d(e,{A:()=>r});var n=a(82562);function r(t){return Intl.NumberFormat((0,n.mf)(),{maximumFractionDigits:2,maximumSignificantDigits:4,notation:"compact"}).format(t)}},65166:(t,e,a)=>{a.r(e);var n=a(51889),r=a(39595),i=a(33260),o=a(24363),l=a(54499),s=a(21671),c=a(96020),d=a(4049),u=a(22211),g=a(79049),h=a(12898),m=a(23976),p=a(27193),f=a(83836),w=a(5225),b=a(82562),y=a(97797),v=a(8968),k=a(50183);function S(t,e,a,n){var r,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,a,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(o=(i<3?r(o):i>3?r(e,a,o):r(e,a))||o);return i>3&&o&&Object.defineProperty(e,a,o),o}let A=(0,w.A)(x);async function x(t){let e=await (0,p.Ee)(t,{headers:{accept:"application/json"}});return await e.json()}let L=class ContributorsGraphElement extends HTMLElement{async connectedCallback(){let t=this.graph,e=t.getAttribute("data-url");if(e){for(let e of t.querySelectorAll("svg.viz"))e.remove();t.classList.add("is-graph-loading"),t.classList.remove("is-graph-load-error","is-graph-empty");try{let a=await A(e);t.classList.remove("is-graph-loading"),null!=a&&a.unusable?t.classList.add("is-graph-without-usable-data"):null!=a&&0===a.length||null!=a&&null!=a.summary&&0===a.summary.total||null!=a[0]&&null!=a[0].weeks&&0===a[0].weeks.length?t.classList.add("is-graph-empty"):function(t,e){(function(t){for(let e of t)for(let t of e.weeks)t.date=new Date(1e3*t.w)})(e),1===e[0].weeks.length&&function(t){let e=new Date(t[0].weeks[0].date.getTime()-6048e5);for(let a of t)a.weeks.unshift({a:0,c:0,d:0,date:e,w:e.getTime()/1e3})}(e);let a=function(t){let e={};for(let a of t)for(let t of a.weeks){let a=e[t.w];a||(a=e[t.w]={c:0,a:0,d:0}),a.c+=t.c,a.a+=t.a,a.d+=t.d}return(0,m.jO)(e)}(e),n=function(t,e){let a=new Date;return e>a&&(e=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()))),[t,e]}(D(Number(a[0].key)),D(~~a[a.length-1].key+518400)),r=function(){let t=new URLSearchParams(window.location.search),e=t.get("from"),a=t.get("to");if(e&&a)return[new Date(e),new Date(a)]}(),i=r||n,o={data:e,totals:a,fullTimeSpan:n,selectedTimeSpan:i};M.set(t,o),$(i),F(t,o),R(t,o,r)}(t,a)}catch(e){throw t.classList.remove("is-graph-loading"),t.classList.add("is-graph-load-error"),e}}}};function U(t){let e=b.US[t.getUTCMonth()];return e?`${e.slice(0,3)} ${t.getUTCDate()}, ${t.getUTCFullYear()}`:""}function $(t){let e=U(t[0]),a=U(t[1]),n=document.querySelector(".js-date-range");n&&(n.textContent=`${e} \u{2013} ${a}`)}S([r.aC],L.prototype,"graph",void 0),L=S([r.p_],L);let T=(0,u.aL)("%Y-%m-%d");function D(t){return new Date(1e3*~~t)}function C(t,e){let a=new URL(window.location.href,window.location.origin),n=new URLSearchParams(a.search);n.set("from",T(t[0])),n.set("to",T(t[1])),n.set("type",e),a.search=n.toString(),(0,v.c8)(null,"",a.toString())}function E(){return new URLSearchParams(window.location.search).get("type")||"c"}let M=new WeakMap;function R(t,e,a){let{selectedTimeSpan:r}=e,[h,m]=r,p=document.querySelector("#contributors ol");p&&p.remove();let w=new URLSearchParams(window.location.search).get("type")||"c",b=function(t,e,a){let n=function(t,e){let[a,n]=e;return t.map(function(t){let e=Object.assign({},t);return e.weeks=e.weeks.filter(t=>t.date>=a&&t.date<=n),e})}(t,e);for(let t of n){let e=0,a=0,n=0;for(let r of t.weeks)e+=r.c,a+=r.a,n+=r.d;t.c=e,t.a=a,t.d=n}return n.sort((t,e)=>(0,l.A)(t[a],e[a]))}(e.data,r,w),y=document.createElement("ol"),v=(0,k.A)(y).attr("class","contrib-data list-style-none");for(let t of document.querySelectorAll(".contrib-person"))t.remove();let S=t=>t.author.hovercard_url,A=t=>t.author.path,x=t=>t.author.avatar,L=t=>t.author.login,U=document.querySelector(".graphs"),$="";U&&($=U.getAttribute("data-repo-url")||"");let D=document.querySelector("#graphs-contributors-person-item");(function(t,e,a,r,l){let g=new URLSearchParams(window.location.search).get("type")||"c",h=t=>t.date,m=t=>t[g],p={width:a,height:140,margin:{top:10,left:20,right:20,bottom:20},boundedHeight:0,boundedWidth:0};p.boundedHeight=p.height-p.margin.bottom-p.margin.top,p.boundedWidth=p.width-p.margin.left-p.margin.right;let w=(0,s.A)(e,t=>(0,s.A)(t.weeks,m)),b=(0,c.A)().domain([r,l]).range([0,p.width]),y=(0,d.A)().domain([0,w]).range([p.boundedHeight,0]),v=(0,i.A)().curve(o.Ay).x(t=>b(h(t))).y0(()=>p.boundedHeight).y1(t=>y(m(t))),k=(0,n.V4)(y).ticks(2).tickSize(-p.width).tickPadding(10).tickFormat(f.A),S=(0,n.l7)(b);e[0].weeks.length<5&&S.ticks(e[0].weeks.length).tickFormat((0,u.DC)("%x"));let A=t.select("span.Box").append("svg").attr("viewBox",`0 0 ${p.width+(p.margin.left+p.margin.right)} ${p.height+p.margin.top+p.margin.bottom}`).attr("class","capped-card-content").attr("preserveAspectRatio","xMinYMin meet").append("g").attr("transform",`translate(${p.margin.left},${p.margin.top})`);A.append("g").attr("class","x axis").classed("dense",S.ticks()[0]>=10).attr("transform",`translate(0, ${p.boundedHeight})`).call(S).selectAll(".tick text").attr("fill","#6a737d").style("display",(t,e)=>e%3!=0?"none":"block"),A.select(".x.dense text").attr("dx",7),A.append("g").attr("class","y axis").call(k).selectAll(".y.axis g text").attr("fill","#6a737d").attr("dx",p.width/2).style("display",(t,e)=>0===e?"none":"block").classed("midlabel",!0),A.append("path").attr("d",t=>v(t.weeks))})(v.selectAll(".contrib-person").data(b.filter(t=>t[w])).enter().append((t,e)=>{let n=new URLSearchParams;n.set("author",L(t)),a&&(n.set("since",T(a[0])),n.set("until",T(a[1])));let r=new g.i4(D,{hoverCardUrl:S(t),authorUrl:A(t),authorAvatarUrl:x(t),authorLogin:L(t),place:`#${e+1}`,contributorUrl:`${$}/commits?${n.toString()}`,contributorUrlText:`${new Intl.NumberFormat("en-US").format(t.c)} ${1===t.c?"commit":"commits"}`,linesAdded:`${new Intl.NumberFormat("en-US").format(t.a)} ++`,linesDeleted:`${new Intl.NumberFormat("en-US").format(t.d)} --`}).children[0];return(e+1)%2?r.classList.add("pr-2"):r.classList.add("pl-2"),r}),b,parseInt(t.getAttribute("data-graph-width"),10),h,m),t.appendChild(y)}function F(t,e){let{totals:a,fullTimeSpan:r,selectedTimeSpan:l}=e,[u,g]=r,m={width:t.clientWidth,height:160,margin:{top:20,left:50,right:20,bottom:50},boundedWidth:0,boundedHeight:0};m.boundedWidth=m.width-m.margin.left-m.margin.right,m.boundedHeight=m.height-m.margin.top-m.margin.bottom;let p=new URLSearchParams(window.location.search).get("type")||"c",w=t=>D(parseInt(t.key,10)),b=t=>t.value[p],y=(0,c.A)().domain([u,g]).range([0,m.boundedWidth]),v=(0,d.A)().domain([0,(0,s.A)(a,b)]).range([m.height,0]),S=(0,i.A)().curve(o.Ay).x(t=>y(w(t))).y0(()=>m.height).y1(t=>v(b(t)));(0,k.A)("#contributors-master svg").remove();let A=(0,k.A)("#contributors-master").data([a]).append("svg").attr("viewBox",`0 0 ${m.width} ${m.height+m.margin.top+m.margin.bottom}`).attr("preserveAspectRatio","xMinYMin meet").attr("class","viz").attr("data-hpc","").append("g").attr("transform",`translate(${m.margin.left},${m.margin.top})`),x=(0,n.V4)(v).ticks(4).tickSize(-m.width+m.margin.left+m.margin.right).tickPadding(10).tickFormat(f.A),L=(0,n.l7)(y);a.length<5&&L.ticks(a.length),A.append("g").attr("class","x axis").attr("transform",`translate(0, ${m.height})`).call(L).selectAll(".tick text").attr("fill","#6a737d"),A.append("g").attr("class","y axis").call(x).selectAll(".tick text").attr("fill","#6a737d"),A.append("g").append("path").attr("class","area").attr("d",S);let U=(0,h.n5)().on("start",function(){A.classed("selecting",!0)}).on("end",function(e){let a;let n=new Boolean(e.selection&&e.selection.length),r=e.selection||[];A.classed("selecting",!n);let i=r.map(y.invert);if(2===i.length){let[t,e]=i;if(!(t instanceof Date)||!(e instanceof Date))throw Error("invariant");a=[t,e]}!function(t,e){let a=M.get(t);e&&T(e[0])!==T(e[1])?a.selectedTimeSpan=e:a.selectedTimeSpan=a.fullTimeSpan,C(a.selectedTimeSpan,E()),$(a.selectedTimeSpan),R(t,a,e)}(t,a)}).extent([[0,0],[m.width-(m.margin.left+m.margin.right),m.height]]),F=A.append("g").attr("class","selection").call(U);(T(l[0])!==T(u)||T(l[1])!==T(g))&&F.call(U.move,l.map(y))}(0,y.on)("details-menu-selected",".js-contribution-menu",function(t){let e=t.detail.relatedTarget,a=document.querySelector(".js-graph"),n=M.get(a);n&&E()!==e.value&&(C(n.selectedTimeSpan,e.value),F(a,n),R(a,n))},{capture:!0})},82562:(t,e,a)=>{a.d(e,{US:()=>r,mf:()=>i,mx:()=>n});let n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],r=["January","February","March","April","May","June","July","August","September","October","November","December"],i=()=>{try{return Intl.getCanonicalLocales(window.navigator.language)[0]}catch(t){return"en-US"}}},8968:(t,e,a)=>{let n,r;a.d(e,{Gu:()=>s,c8:()=>g,g5:()=>h});var i=a(97156);let o=[],l=0;function s(){return n}function c(){try{return Math.min(Math.max(0,i.Kn?.length||0)||0,9007199254740991)}catch(t){return 0}}function d(t){n=t;let e=i.fV?.href;o[c()-1+l]={url:e,state:n},o.length=c(),i.cg?.dispatchEvent(new CustomEvent("statechange",{bubbles:!1,cancelable:!1}))}function u(){return new Date().getTime()}function g(t,e,a){l=0;let n={_id:u(),...t};i.Kn?.pushState(n,e,a),d(n)}function h(t,e,a){let r={...n,...t};i.Kn?.replaceState(r,e,a),d(r)}n=function(){let t={_id:new Date().getTime(),...i.Kn?.state};return d(t),t}(),i.cg?.addEventListener("popstate",function(t){let e=t.state;if(!e||!e._id&&!e.turbo?.restorationIdentifier)return;let a=e.turbo?.restorationIdentifier;o[c()-1+l-1]?.state?.turbo?.restorationIdentifier===a?l--:l++,d(e)},!0),i.cg?.addEventListener("turbo:visit",t=>{t instanceof CustomEvent&&(r=t.detail.action)}),i.cg?.addEventListener("turbo:load",()=>{"restore"!==r&&(l=0,h(i.Kn?.state,"",""))}),i.cg?.addEventListener("hashchange",function(){if(c()>o.length){let t={_id:u()};i.Kn?.replaceState(t,"",i.fV.href),d(t)}},!0),i.cg?.addEventListener("pageshow",()=>{o=[],l=0})}}]);
//# sourceMappingURL=app_assets_modules_github_graphs_contributors-graph-element_ts-75ca4bd17332.js.map