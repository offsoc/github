<%= tag.video(
  width: video[:size],
  loop: true,
  muted: true,
  playsinline: true,
  tabindex: 0,
  preload: "none",
  class: "discussions-monamoji-video position-absolute js-build-in-item build-in-scale-up js-viewport-aware-video looping-mktg",
  style: "top: #{video[:top]}%; left: #{video[:left]}%;",
  data: { threshold: 0 }
) do %>
  <% {
    :mov => "video/mp4; codecs=hvc1",
    :webm => "video/webm"
  }.each do |format, type| %>
    <% {
      "(min-device-pixel-ratio: 1.5), (-webkit-min-device-pixel-ratio: 1.5)" => "@2x",
      "(max-device-pixel-ratio: 1), (-webkit-max-device-pixel-ratio: 1)" => ""
    }.each do |media, suffix| %>
      <%= tag.source(
        src: image_path("modules/site/discussions/animations/#{video[:filename]}#{suffix}.#{format}"),
        type: type,
        media: media
      ) %>
    <% end %>
  <% end %>
<% end %>
