<%# erblint:counter DeprecatedComponentsCounter 1 %>
<%= render Primer::Beta::Details.new(
  classes: "dropdown",
  m: 2,
  overlay: :default,
  position: :absolute,
  pr: 1,
  reset: true,
  right: 0,
  test_selector: "achievement-share-menu",
) do |details| %>
  <% details.with_summary(color: :muted, classes: "btn-link btn-sm") do %>
    <%= primer_octicon(icon: "share-android") %>
  <% end %>

  <% details.with_body(tag: :"details-menu", classes: "dropdown-menu dropdown-menu-sw") do %><%# erblint:disable Primer::Accessibility::DetailsMenuMigration %>
    <%= render Primer::Beta::ClipboardCopy.new(
      value: share_url,
      "aria-label": COPY_SHARE_LINK_ARIA_LABEL,
    ) do %>
      <%= render Primer::ButtonComponent.new(
        classes: "dropdown-item",
        role: :menuitem,
        scheme: :link,
        test_selector: "achievement-share-copy-link",
      ) do %>
        <%= COPY_SHARE_LINK_MENU_ITEM_TEXT %>
      <% end %>
    <% end %>

    <%= render Primer::Beta::Link.new(
      classes: "dropdown-item",
      href: twitter_preview_url,
      role: :menuitem,
      target: "_blank",
      test_selector: "achievement-share-twitter-preview",
      underline: false,
    ) do %>
      <%= PREVIEW_ON_TWITTER_MENU_ITEM_TEXT %>
    <% end %>
  <% end %>
<% end %>
