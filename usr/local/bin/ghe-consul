#!/bin/bash
#/ A wrapper around consul. All key-value pairs under ghe/* are replicated.
#/
#/ EXAMPLES:
#/   `ghe-consul kv put ghe/<section>/<subsection> key` ...
#/

usage() {
  grep '^#/' <"$0" | cut -c 4-
}

case $1 in
  -h|--help)
    usage
    exit 0
    ;;
esac

[[ -z "$CONSUL_HTTP_TOKEN" ]] && {
  CONSUL_HTTP_TOKEN=$(ghe-config secrets.consul.acl-master-token)
  export CONSUL_HTTP_TOKEN
}

consul "$@"
