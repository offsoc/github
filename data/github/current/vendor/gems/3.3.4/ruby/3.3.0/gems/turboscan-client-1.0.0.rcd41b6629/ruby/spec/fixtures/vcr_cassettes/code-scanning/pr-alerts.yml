# generated by turbocassette ts/cassettes/sessions/pr_alerts_test.go
---
http_interactions:
  - request:
      method: post
      uri: http://localhost:8888/twirp/github.turboscan.Results/PullRequestAlerts
      body:
        encoding: UTF-8
        string: |-
          {
            "baseRefBytes": "cmVmcy9oZWFkcy9tYWlu",
            "fileChanges": [
              {
                "changes": [
                  {
                    "added": true,
                    "endLine": 1,
                    "startLine": 1
                  }
                ],
                "filePath": "main.js"
              }
            ],
            "headCommitOid": "199ac6daea3b6d8f2dfa0301688fd9f0071a7e69",
            "mergeCommitOid": "480d4f47447129f015cb327536c522ca683939a1",
            "repositoryId": "105",
            "tool": "Old CodeQL"
          }
      headers:
        Content-Type:
          - application/json
    response:
      status:
        code: 200
        message: null
      headers:
        Content-Length:
          - "900"
        Content-Type:
          - application/json
      body:
        encoding: UTF-8
        string: |-
          {
            "errorCount": "1",
            "fixedAlerts": [],
            "fixedCount": "0",
            "latestUploadTime": "0001-01-01T00:00:00Z",
            "missingCategories": {},
            "newAlerts": [
              {
                "location": {
                  "endColumn": 38,
                  "endLine": 1,
                  "filePath": "main.js",
                  "startColumn": 16,
                  "startLine": 1
                },
                "messageMarkdown": "",
                "messageText": "Cross-site scripting vulnerability due to [user-provided value](1).",
                "number": 1,
                "ruleSarifIdentifier": "js/xss",
                "ruleSeverity": "ERROR",
                "ruleShortDescription": "Client-side cross-site scripting",
                "securitySeverity": "NO_SECURITY_SEVERITY"
              }
            ],
            "newCategories": {
              "a": {
                "alertCount": "1"
              }
            },
            "newCount": "1",
            "noteCount": "0",
            "securityCriticalCount": "0",
            "securityHighCount": "0",
            "securityLowCount": "0",
            "securityMediumCount": "0",
            "warningCount": "0"
          }
      http_version: null
    recorded_at: Thu, 17 Aug 2023 07:03:47 GMT
  - request:
      method: post
      uri: http://localhost:8888/twirp/github.turboscan.SuggestedFixes/GenerateSuggestedFix
      body:
        encoding: UTF-8
        string: |-
          {
            "alertNumbers": [
              1
            ],
            "commitOid": "199ac6daea3b6d8f2dfa0301688fd9f0071a7e69",
            "pullRequestId": "1",
            "refNamesBytes": [
              "cmVmcy9oZWFkcy9tYXN0ZXI=",
              "cmVmcy9oZWFkcy9wcm90ZWN0ZWRfYQ=="
            ],
            "repositoryId": "351"
          }
      headers:
        Content-Type:
          - application/json
    response:
      status:
        code: 200
        message: null
      headers:
        Content-Length:
          - "21"
        Content-Type:
          - application/json
      body:
        encoding: UTF-8
        string: |-
          {
            "success": true
          }
      http_version: null
    recorded_at: Tue, 22 Aug 2023 09:30:07 GMT
recorded_with: ""
