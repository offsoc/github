"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_assets_modules_github_user-status-submit_ts"],{70868:(e,t,s)=>{var r=s(27193),u=s(17249),a=s(21232),o=s(18558),n=s(97797),l=s(78350);function i(e){return e.querySelector(".js-user-status-details").hasAttribute("open")}function c(e){let t=e.querySelector(".js-user-status-original-emoji"),s=e.querySelector(".js-user-status-custom-emoji"),r=e.querySelector(".js-user-status-no-emoji-icon");s.innerHTML=t.innerHTML,r.hidden=s.hasChildNodes()}function d(e){let t=e.querySelector(".js-user-status-suggestions"),s=e.querySelector(".js-user-status-message-field").value.trim().length>0;t.hidden=s}function j(e){i(e)?function(e){let t=e.querySelector(".js-user-status-message-field");c(e),function(e){let t=e.querySelector(".js-emoji-picker"),s=e.querySelector(".js-toggle-user-status-emoji-picker");t&&(t.reset(),t.close(),s?.setAttribute("aria-expanded","false"))}(e),t.value=t.defaultValue,(0,u.ig)(e)}(e):c(e),y(e)}function f(e,t){e.querySelector(".js-user-status-custom-emoji").innerHTML=t.innerHTML,e.querySelector(".js-user-status-no-emoji-icon").hidden=!0}function m(e,t){e.querySelector(".js-user-status-emoji-field").value=t.value}function g(e,t){if("Escape"===(0,o.Vy)(t)){let t=e.closest(".js-user-status-container");t instanceof HTMLElement&&(e.value=e.defaultValue,j(t))}}function y(e){let t=e.querySelector(".js-user-status-submit"),s=e.querySelector(".js-clear-user-status-button");if(!t||!s)return;let r=e.querySelector(".js-user-status-message-field"),a=e.querySelector(".js-user-status-emoji-field"),o=r.value.trim(),n=a.value.trim(),l=!1,i=!1;(0,u.Cw)(r)&&(l=!0),o.length<1&&n.length<1&&(l=!0,s.classList.contains("js-user-status-exists")||(i=!0)),t.disabled=l,s.disabled=i}function S(e){return e.closest(".js-user-status-container")}(0,n.on)("click",".js-toggle-user-status-edit",function(e){j(S(e.currentTarget))}),(0,n.on)("click",".js-toggle-user-status-emoji-picker",function(e){let t=S(e.currentTarget).querySelector(".js-emoji-picker"),s=e.currentTarget;t&&(e.stopPropagation(),t.hidden?(t.open(),s.setAttribute("aria-expanded","true")):(t.close(),s.setAttribute("aria-expanded","false")))},{capture:!0}),(0,n.on)("click",".js-user-status-emoji-button",function(e){let t=e.currentTarget;t instanceof HTMLButtonElement&&function(e){let t=e.closest(".js-user-status-container"),s=t.querySelector(".js-emoji-picker"),r=t.querySelector(".js-toggle-user-status-emoji-picker");m(t,e),s.querySelector(".selected-emoji")?.classList.remove("selected-emoji"),e.classList.add("selected-emoji"),f(t,e),y(t),s.close(),r?.setAttribute("aria-expanded","false"),r?.focus()}(t)}),(0,a.uE)(".js-user-status-message-field",function(e){d(S(e))}),(0,a.Ff)("keyup",".js-user-status-message-field",e=>{let t=e.target;t instanceof HTMLInputElement&&g(t,e)}),(0,a.Ff)("keyup",".js-emoji-picker-filter",e=>{let t=e.target;t instanceof HTMLInputElement&&g(t,e)}),(0,n.on)("click",".js-clear-user-status-button",function(e){let t=e.currentTarget;t instanceof HTMLButtonElement&&function(e){e.hidden=!0,e.querySelector(".js-user-status-emoji-field").value="",e.querySelector(".js-user-status-no-emoji-icon").hidden=!1,e.querySelector(".js-user-status-custom-emoji").textContent="";let t=e.querySelector(".js-user-status-message-field");t.value="",t.classList.contains("js-characters-remaining-field")&&(0,u.mY)(t);let s=e.querySelector(".selected-emoji.js-user-status-emoji-button");s&&s.classList.remove("selected-emoji"),e.querySelector(".js-user-status-limited-availability-checkbox").checked=!1,y(e),d(e);let r=e.querySelector(".js-user-status-form");(0,l.k_)(r)}(t.closest(".js-user-status-container"))}),(0,n.on)("click",".js-predefined-user-status",function(e){let t=e.currentTarget;t instanceof HTMLButtonElement&&function(e){let t=e.closest(".js-user-status-container"),s=e.querySelector(".js-predefined-user-status-emoji"),r=e.querySelector(".js-predefined-user-status-message"),a=t.querySelector(".js-user-status-message-field");a.value=(r.textContent||"").trim(),f(t,s),m(t,e),y(t),d(t),a.classList.contains("js-characters-remaining-field")&&(0,u.mY)(a),a.focus()}(t)}),(0,a.eC)(".js-user-status-message-field",function(e){let t=e.target;if(!(t instanceof HTMLElement))return;let s=t.closest(".js-user-status-container");y(s),d(s)}),(0,n.on)("change",".js-user-status-org-selection",function(e){!function(e){let t=e.closest(".js-user-status-container"),s=e.value,r=""!==s.trim(),u=t.querySelector(".js-user-status-message-field"),a="";if(r){let e=new URL(u.getAttribute("data-org-url")||"",window.location.origin),t=new URLSearchParams(e.search.slice(1));t.append("global_id",s),e.search=t.toString(),a=e.toString()}else a=u.getAttribute("data-no-org-url")||"";u.closest("text-expander").setAttribute("data-mention-url",a)}(e.currentTarget)}),(0,n.on)("change",".js-user-status-limited-availability-checkbox",function(e){let t=e.target;if(!(t instanceof HTMLInputElement))return;let s=t.closest(".js-user-status-container"),r=t.checked,u=t.getAttribute("data-default-message")||"",a=s.querySelector(".js-user-status-message-field");r&&a.value.length<1?a.value=u:r||a.value!==u||(a.value=""),y(s),d(s)});var h=s(21403);async function q(e,t){let s;let r=e.querySelector(".js-user-status-form-group");r.classList.remove("errored");try{s=await t.json(),k(e),(e.matches(".js-user-status-dialog-form")?e.querySelector("modal-dialog, dialog"):e.closest("modal-dialog, dialog")).dispatchEvent(new CustomEvent("global-user-status-dialog:submit",{bubbles:!0,detail:s.json}))}catch(e){r.classList.add("errored");return}}async function p(e,t){let s;let u=e.querySelector(".js-user-status-form-group");u.classList.remove("errored");try{s=await t.html(),k(e)}catch(e){u.classList.add("errored");return}let a=s.html.querySelector(".js-user-status-container");for(let e of document.querySelectorAll(".js-user-status-container"))if(a!==e){let t=e.closest(".js-user-status-context");if(t){let s=t.getAttribute("data-url");if(!s)throw Error("could not get url");let u=await (0,r.Ts)(document,s);e.replaceWith(u)}}}function b(e,t){if(!i(e))for(let s of e.querySelectorAll(".js-toggle-user-status-edit.Details-content--closed"))s.classList.toggle("color-fg-accent",t),s.classList.toggle("Link--primary",!t)}function v(e){e.target instanceof Element&&b(e.target.closest(".js-user-status-container"),!0)}function L(e){e.target instanceof Element&&b(e.target.closest(".js-user-status-container"),!1)}function k(e){let t=document.querySelector(".js-user-status-banner");if(t){let s=e.querySelector(".js-user-status-emoji-field")?.value,r=e.querySelector(".js-user-status-message-field")?.value,u=t.querySelector(".js-user-status-banner-message");s||r?u.textContent="Your status has been updated.":u.textContent="Your status has been cleared.",t.hidden=!1}}(0,s(13937).JW)(".js-user-status-form",async function(e,t){"html"===e.getAttribute("data-format")?await p(e,t):await q(e,t)}),(0,h.lB)(".js-toggle-user-status-edit",function(e){e.addEventListener("mouseenter",v),e.addEventListener("mouseleave",L)})}}]);
//# sourceMappingURL=app_assets_modules_github_user-status-submit_ts-464cd084b4a5.js.map