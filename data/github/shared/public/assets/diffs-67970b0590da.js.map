{"version":3,"file":"diffs-xxxxxxxxxxxx.js","mappings":"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","sources":["app/assets/modules/github/diffs/conversations-menu.ts","app/assets/modules/github/diffs/file-collapsing.ts","app/assets/modules/github/diffs/file-filter.ts","app/assets/modules/github/pulls/suggested-changes/utils.ts","app/assets/modules/github/pulls/suggested-changes.ts","app/assets/modules/github/diffs/line-comments.ts","app/assets/modules/github/diffs/progressive.ts","app/assets/modules/github/diffs/prose.ts","app/assets/modules/github/diffs/toc-summary.ts","app/assets/modules/github/pulls/code-scanning-autofix.ts","app/assets/modules/github/pulls/commits-range-selection.ts","app/assets/modules/github/pulls/compare.ts","app/assets/modules/github/pulls/composer.ts","app/assets/modules/github/pulls/diff-layout-element.ts","app/assets/modules/github/pulls/diff-view.ts","app/assets/modules/github/pulls/instrument-files.ts","app/assets/modules/github/pulls/merge.ts","app/assets/modules/github/pulls/outdated-comments.ts","app/assets/modules/github/pulls/restore-branch.ts","app/assets/modules/github/pulls/reviews.ts","app/assets/modules/github/pulls/show.ts","app/assets/modules/github/diffs/expander.ts","app/assets/modules/github/diffs/side-copy-protection.ts","app/assets/modules/github/diffs/line-highlight.ts","app/assets/modules/github/diffs/split.ts","app/assets/modules/github/diffs/toggle-file-notes.ts","app/assets/modules/github/diffs/toggle-check-annotations.ts","app/assets/modules/github/diffs/diff-file-filter-element.ts","app/assets/modules/github/input-demux-context-wrapper.ts","app/assets/modules/github/behaviors/inline-comment.ts","app/assets/modules/github/diffs/file-filter-persistence.ts","app/assets/modules/github/input-demux.ts","app/assets/modules/github/spoofed-commit-warning.ts","app/assets/modules/github/sso.ts","ui/packages/details-dialog/details-dialog.ts","ui/packages/html-safe-nonce/html-safe-nonce.ts","ui/packages/trusted-types-policies/server-x-safe-html.ts","ui/packages/fetch-utils/fetch-utils.ts"],"sourcesContent":["// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {scrollToFragmentTarget} from '../sticky-scroll-into-view'\n\n// Reload the conversations menu each time it is clicked (excluding the first click)\non(\n  'click',\n  '.js-conversation-menu-button',\n  (function () {\n    let firstClick = true\n    return async function (event: MouseEvent & {currentTarget: Element}) {\n      if (firstClick === false) {\n        const button = event.currentTarget\n        const conversationsMenu = button.closest<HTMLElement>('.select-menu')!\n        const detailsMenu = conversationsMenu.querySelector<HTMLElement>('details-menu')\n        if (!detailsMenu) return\n        detailsMenu.textContent = ''\n\n        const url = `${detailsMenu.getAttribute('src')!}?instrument=1`\n        const response = await fetch(url)\n        if (response.ok) {\n          detailsMenu.innerHTML = await response.text()\n        }\n      }\n      firstClick = false\n    }\n  })(),\n)\n\n// Close the conversations menu when a conversation is clicked\n// and ensure that the conversation is scrolled to\non('click', '.js-conversations-menu-item', function (event) {\n  const anchor = event.currentTarget as HTMLAnchorElement\n  const details = anchor.closest('.js-conversations-details')!\n  if (details.hasAttribute('open')) {\n    details.removeAttribute('open')\n  }\n  window.location.hash = anchor.hash\n  scrollToFragmentTarget(document)\n})\n\n// Flip the caret and toggle border each time resolved conversations section is clicked\non('click', '.js-resolved-conversations', async function (event) {\n  const caret = event.currentTarget.querySelector<HTMLElement>('.dropdown-caret')!\n  const selectMenuHeader = event.currentTarget.querySelector<HTMLElement>('.select-menu-header')!\n  flipCaret(caret)\n  selectMenuHeader.classList.toggle('border-bottom-0')\n})\n\nfunction flipCaret(caret: HTMLElement) {\n  if (caret.style.transform === '') {\n    caret.style.transform = 'rotate(180deg)'\n  } else {\n    caret.style.transform = ''\n  }\n}\n","import {fromEvent} from '@github-ui/subscription'\nimport hashChange from '../behaviors/hash-change'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {scrollIntoView} from '../sticky-scroll-into-view'\nimport {updateURLState} from './file-filter-persistence'\n\non('details:toggled-group', '.js-file.js-details-container', function (event) {\n  if (event.target !== event.currentTarget) return\n  toggledAllFileContents(event.detail.open)\n})\n\n// Scroll file header into view if top of file is offscreen (sticky file header).\non('details:toggled', '.js-file.js-details-container', function (event) {\n  if (event.target !== event.currentTarget) return\n  const container = event.currentTarget\n  if (container.getBoundingClientRect().top < 0) {\n    scrollIntoView(container)\n  }\n})\n\nhashChange(() => {\n  const hash = window.location.hash.slice(1)\n  if (!hash) return\n  const target = document.getElementsByName(hash)[0]\n  if (!target) return\n  const container = target.nextElementSibling\n  if (container && container.matches('.js-file.js-details-container')) {\n    container.classList.add('open')\n    container.classList.add('Details--on')\n  }\n})\n\nobserve('.js-file-header-dropdown', {\n  subscribe: el => fromEvent(el, 'toggle', toggleFileHeaderMenu),\n})\n\n// Adjusts the z-index of a file header with an open dropdown menu to ensure\n// it's always visible atop the other files. Otherwise, the open menu of a\n// collapsed file is displayed beneath the next file.\nfunction toggleFileHeaderMenu({currentTarget}: Event) {\n  const details = currentTarget as Element\n  const isOpen = details.hasAttribute('open')\n  const file = details.closest<HTMLElement>('.js-file-header')!\n  file.classList.toggle('has-open-dropdown', isOpen)\n}\n\nfunction toggledAllFileContents(open: boolean) {\n  const fileFilter = document.querySelector('.js-file-filter')\n  if (!fileFilter) {\n    return\n  }\n\n  // Toggle all file type inputs with given checked value\n  const fileTypeOptions = getFileTypeOptions()\n  for (const checkbox of fileTypeOptions) {\n    checkbox.checked = open\n  }\n\n  const deletedFilesInput = getDeletedFilesInput()\n  if (deletedFilesInput) {\n    deletedFilesInput.checked = !open\n  }\n\n  const isActive = fileFilterActive()\n\n  toggleHighlightActiveFilter(isActive)\n  toggleResetFileFiltersButton(isActive)\n  toggleAvailableOptions()\n  toggleSelectAll()\n  toggleFileTypeCounts()\n  updateURLState(\n    isActive,\n    whitespaceFilterActive(),\n    getSelectedFileTypes(),\n    codeownerFilterActive(),\n    getSelectedOwners(),\n    manifestFilterActive(),\n    deletedFilterActive(),\n    viewedFilterActive(),\n  )\n}\n\n// Get file type names that have be selected through the checkboxes\nfunction getSelectedFileTypes(): string[] {\n  const checkedFileOptions = Array.from(getFileTypeOptions()).filter(option => option.checked)\n  return checkedFileOptions.map(option => option.value)\n}\n\n// Get checkbox elements for the file types in the diff\nfunction getFileTypeOptions() {\n  return document.querySelectorAll<HTMLInputElement>('.js-diff-file-type-option')\n}\n\n// Get deleted files checkbox\nfunction getDeletedFilesInput(): HTMLInputElement | undefined {\n  const input = document.querySelector('.js-deleted-files-toggle')\n  if (input instanceof HTMLInputElement) {\n    return input\n  }\n}\n\n// Are any files being filtered?\nfunction fileFilterActive(): boolean {\n  return (\n    fileTypeFilterActive() ||\n    deletedFilterActive() ||\n    viewedFilterActive() ||\n    codeownerFilterActive() ||\n    manifestFilterActive()\n  )\n}\n\nfunction codeownerFilterActive(): boolean {\n  return getSelectedOwners().length > 0\n}\n\nfunction getSelectedOwners(): string[] {\n  const ownerOptions = document.querySelectorAll<HTMLInputElement>('.js-diff-owner-option')\n  const checkedFileOptions = Array.from(ownerOptions).filter(option => option.checked)\n  return checkedFileOptions.map(option => option.value)\n}\n\n// Are any files being filtered by type?\nfunction fileTypeFilterActive(): boolean {\n  return getSelectedFileTypes().length !== getFileTypeOptions().length\n}\n\n// Are any files being filtered by manifest status?\nfunction manifestFilterActive(): boolean {\n  const showManifestFiles = document.querySelector<HTMLInputElement>('.js-manifests-option')\n  if (showManifestFiles) {\n    return showManifestFiles.checked\n  } else {\n    return false\n  }\n}\n\n// Are any files being filtered by deleted status?\nfunction deletedFilterActive(): boolean {\n  const hideDeletedFiles = getDeletedFilesInput()\n  if (hideDeletedFiles) {\n    return !hideDeletedFiles.checked\n  } else {\n    return false\n  }\n}\n\n// Are any files being filtered by viewed status?\nfunction viewedFilterActive(): boolean {\n  const input = document.querySelector<HTMLInputElement>('.js-viewed-files-toggle')\n  if (input) {\n    return !input.checked\n  } else {\n    return false\n  }\n}\n\n// Has the whitespace \"w\" url parameter been passed\nfunction whitespaceFilterActive(): boolean {\n  const params = new URLSearchParams(window.location.search)\n  return params.has('w')\n}\n\n// Changes the file filter drop down button to show if the filter is active\nfunction toggleHighlightActiveFilter(highlight: boolean) {\n  const fileFilterButton = document.querySelector<HTMLElement>('.js-file-filter-text')!\n  fileFilterButton.classList.toggle('color-fg-accent', highlight)\n}\n\n// Shows or hides the 'Reset' CTA\nfunction toggleResetFileFiltersButton(show: boolean) {\n  const resetFileFilter = document.querySelector('.js-reset-filters')\n  const commitsCurrentlyFiltered = document.querySelector('.js-commits-filtered')\n\n  if (resetFileFilter != null && !commitsCurrentlyFiltered) {\n    ;(resetFileFilter as HTMLElement).hidden = !show\n  }\n}\n\n// Toggles text for select all file types cta\nfunction toggleSelectAll() {\n  const typefilterActive = fileTypeFilterActive()\n  const selectAllContainer = document.querySelector<HTMLElement>('.js-file-filter-select-all-container')!\n  const selectedMarkup = typefilterActive ? 'data-select-all-markup' : 'data-all-selected-markup'\n  const newMarkup = selectAllContainer.getAttribute(selectedMarkup)!\n  selectAllContainer.textContent = newMarkup\n  selectAllContainer.classList.toggle('color-fg-muted', !typefilterActive)\n  selectAllContainer.classList.toggle('color-fg-accent', typefilterActive)\n}\n\n// Toggles which filters are disabled given other filters\nfunction toggleAvailableOptions() {\n  // Disables file types that consist of only deleted files when deleted files filter is active\n  const fileTypeOptions = getFileTypeOptions()\n  const deletedFilesHidden = deletedFilterActive()\n  for (const checkbox of fileTypeOptions) {\n    if (deletedFilesHidden) {\n      const allFilesDeleted = checkbox.getAttribute('data-non-deleted-files-count') === '0'\n      checkbox.disabled = allFilesDeleted\n    } else {\n      checkbox.disabled = false\n    }\n  }\n}\n\nfunction toggleFileTypeCounts() {\n  const fileTypeCounts = document.querySelectorAll('.js-file-type-count')\n  for (const count of fileTypeCounts) {\n    const countMarkup = deletedFilterActive() ? 'data-non-deleted-file-count-markup' : 'data-all-file-count-markup'\n\n    const newMarkup = count.getAttribute(countMarkup)\n    if (newMarkup) {\n      count.textContent = newMarkup\n    }\n  }\n}\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\n// Shows blankslate if files empty\nfunction checkEmptyFilterResults() {\n  const blankSlate = document.querySelector<HTMLInputElement>('.js-file-filter-blankslate')\n  if (!blankSlate) {\n    return\n  }\n\n  const loaders = document.querySelectorAll<HTMLInputElement>('.js-diff-progressive-loader')\n  if (loaders.length > 0) {\n    blankSlate.hidden = true\n    return\n  }\n\n  const filesOnPage = document.querySelectorAll<HTMLInputElement>('.js-file')\n  if (filesOnPage.length === 0) {\n    blankSlate.hidden = true\n    return\n  }\n\n  const isNotEmpty = Array.from(filesOnPage).some(file => !file.hidden)\n  blankSlate.hidden = isNotEmpty\n}\n\n// Unhides file if hidden by filter and you click to it from jump to menu\non('click', '.js-jump-to-menu-item', function ({currentTarget}) {\n  const anchorValue = currentTarget.getAttribute('href')!.substring(1)\n  const dataAnchor = document.querySelector(`[data-anchor=\"${anchorValue}\"]`)!\n  if (dataAnchor) {\n    const file = dataAnchor.closest<HTMLElement>('.js-file.js-details-container')!\n    file.hidden = false\n  }\n  checkEmptyFilterResults()\n})\n","import {changeValue} from '@github-ui/form-utils'\n\nconst markdownPrefix = '```suggestion'\nconst markdownSuffix = '```'\nconst markdownPrefixRegex = new RegExp(`${markdownPrefix}(?:.*)\\n`, 'i')\nconst markdownSuffixRegex = new RegExp(`${markdownSuffix}(\\n|$)`)\n\nfunction lineAtIndex(input: string, index: number): string {\n  const lines = input.slice(0, index).split('\\n')\n  return input.split('\\n')[lines.length - 1]!\n}\n\nfunction leadingWhitespace(line: string): string {\n  const captureLeadingWhitespaceRegex = /^(\\s+)/\n  const match = captureLeadingWhitespaceRegex.exec(line)\n  return (match && match[0]) || ''\n}\n\nfunction formatSuggestion(input: string) {\n  let suggestedChange = `${markdownPrefix}\\n`\n  suggestedChange += `${input}\\n`\n  suggestedChange += markdownSuffix\n\n  return suggestedChange\n}\n\nfunction findNextOccurrenceOf(regex: RegExp, input: string, cursor = 0): number {\n  const str = input.substring(cursor, input.length)\n  const match = regex.exec(str)\n  if (match) {\n    return match.index + cursor\n  } else {\n    return -1\n  }\n}\n\nfunction cursorInSuggestionBlock(input: string, cursorIndex: number): boolean {\n  const ranges = []\n  let cursor = 0\n  let startIndex = -1\n  while ((startIndex = findNextOccurrenceOf(markdownPrefixRegex, input, cursor)) > -1) {\n    cursor = startIndex + markdownPrefix.length\n    const endIndex = findNextOccurrenceOf(markdownSuffixRegex, input, cursor)\n    if (endIndex === -1) {\n      // invalid diff block\n      return false\n    }\n    cursor = endIndex + markdownSuffix.length\n    ranges.push([startIndex, endIndex])\n  }\n  return ranges.some(range => {\n    return cursorIndex > range[0]! && cursorIndex < range[1]!\n  })\n}\n\nexport function insertNewSuggestionLine(textarea: HTMLTextAreaElement): boolean {\n  const cursorIndex = textarea.selectionStart\n  if (!cursorInSuggestionBlock(textarea.value, cursorIndex)) {\n    return false\n  }\n  const value = textarea.value\n  const currentLine = lineAtIndex(value, cursorIndex)\n  if (currentLine === null) {\n    return false\n  }\n  const whitespace = leadingWhitespace(currentLine)\n  const lineToInsert = `\\n${whitespace}`\n  const output = value.substr(0, cursorIndex) + lineToInsert + value.substr(cursorIndex)\n  changeValue(textarea, output)\n  const newCursorIndex = cursorIndex + lineToInsert.length\n  textarea.setSelectionRange(newCursorIndex, newCursorIndex)\n\n  return true\n}\n\nexport function insertSuggestionBlock(suggestion: string, textarea: HTMLTextAreaElement) {\n  const template = formatSuggestion(suggestion)\n  const cursorIndex = textarea.selectionStart\n  const input = textarea.value\n  const EOLIndex = findNextOccurrenceOf(/\\n/, input, cursorIndex) // -1 if last line or only line\n  const isOnlyLine = input.trim() === ''\n  const line = lineAtIndex(input, cursorIndex)\n  const isEmptyLine = line.trim() === ''\n  const markdownSuffixLength = `\\n${markdownSuffix}`.length\n\n  let newValue = input\n  let focusIndex = 0\n\n  // logic -> https://gist.github.com/mikekavouras/62980232e5f82f57cd3660870a9f50bb\n  if (isOnlyLine) {\n    newValue = template\n    focusIndex = newValue.length - markdownSuffixLength\n  } else if (EOLIndex === -1) {\n    if (isEmptyLine) {\n      newValue = input + template\n      focusIndex = newValue.length - markdownSuffixLength\n    } else {\n      newValue = [input, template].join('\\n')\n      focusIndex = newValue.length - markdownSuffixLength\n    }\n  } else if (!isEmptyLine) {\n    if (cursorInSuggestionBlock(input, cursorIndex)) {\n      const endOfBlockIndex = findNextOccurrenceOf(/```/, input, cursorIndex) + 3\n      const beforeEndOfBlock = input.substring(0, endOfBlockIndex)\n      const afterEndOfBlock = input.substring(endOfBlockIndex, input.length)\n      newValue = [beforeEndOfBlock, '\\n', template, afterEndOfBlock].join('')\n      focusIndex = newValue.length - afterEndOfBlock.length - markdownSuffixLength\n    } else {\n      const beforeEOL = input.substring(0, EOLIndex)\n      const afterEOL = input.substring(EOLIndex, input.length)\n      newValue = [beforeEOL, '\\n', template, afterEOL].join('')\n      focusIndex = newValue.length - afterEOL.length - markdownSuffixLength\n    }\n  } else {\n    const whitespace = leadingWhitespace(line)\n    const BOLIndex = cursorIndex - whitespace.length\n    const beforeBOL = input.substring(0, BOLIndex)\n    const afterEOL = input.substring(EOLIndex, input.length)\n    newValue = [beforeBOL, template, afterEOL].join('')\n    focusIndex = newValue.length - afterEOL.length - markdownSuffixLength\n  }\n\n  changeValue(textarea, newValue)\n  textarea.focus()\n  textarea.setSelectionRange(focusIndex, focusIndex)\n}\n","import {insertNewSuggestionLine, insertSuggestionBlock} from './suggested-changes/utils'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {onKey} from '@github-ui/onfocus'\nimport {reload} from '@github-ui/updatable-content'\nimport {remoteForm} from '@github/remote-form'\n\n// validation messages found in\n// app/views/comments/_suggested_changes_validation.html.erb\nconst VALIDATION_CLASSES = {\n  addToBatchEnabled: '.js-add-to-batch-enabled',\n  unchangedSuggestion: '.js-unchanged-suggestion',\n  closedOrMergedPull: '.js-closed-pull',\n  viewingSubset: '.js-viewing-subset-changes',\n  leftBlob: '.js-validation-on-left-blob',\n  rightBlob: '.js-validation-on-right-blob',\n  outdatedComment: '.js-outdated-comment',\n  resolvedThread: '.js-resolved-thread',\n  pendingReview: '.js-pending-review',\n  isMultiLine: '.js-is-multiline',\n  inMergeQueue: '.js-in-merge-queue',\n  headOidNotLoaded: '.js-head-oid-not-loaded',\n}\n\nfunction renderSuggestionBlock(el: Element) {\n  const diff = el.getAttribute('data-lines')\n  if (diff != null) {\n    const container = el.closest<HTMLElement>('.js-suggested-changes-container')!\n    const textarea = container.querySelector<HTMLTextAreaElement>('.js-comment-field')!\n    insertSuggestionBlock(diff, textarea)\n  }\n}\n\nfunction disableAllApplySuggestionButtons(template: DocumentFragment, message: string) {\n  const applyButtons = document.querySelectorAll('.js-apply-suggestion-button')\n  const disabledApplyButton = template.querySelector<HTMLElement>('.js-disabled-apply-suggestion-button')!\n  for (const button of applyButtons) {\n    const clonedDisabledApplyButton = disabledApplyButton.cloneNode(true) as Element\n\n    displayButton(clonedDisabledApplyButton, message)\n    button.closest<HTMLElement>('details')!.replaceWith(clonedDisabledApplyButton)\n  }\n}\n\nfunction disableBatchSuggestionsButtons(message: string) {\n  const menu = document.querySelector('.js-batched-suggested-changes-container')\n  if (menu) {\n    /* eslint-disable-next-line github/no-d-none */\n    menu.classList.add('d-none')\n  }\n\n  for (const el of document.querySelectorAll<HTMLInputElement>('.js-apply-single-suggestion')) {\n    /* eslint-disable-next-line github/no-d-none */\n    el.classList.remove('d-none')\n    el.disabled = true\n    el.setAttribute('aria-label', message)\n  }\n  for (const el of document.querySelectorAll<HTMLInputElement>('.js-batched-suggested-changes-add')) {\n    /* eslint-disable-next-line github/no-d-none */\n    el.classList.remove('d-none')\n    el.disabled = true\n    el.setAttribute('aria-label', message)\n  }\n  for (const el of document.querySelectorAll('.js-batched-suggested-changes-remove')) {\n    /* eslint-disable-next-line github/no-d-none */\n    el.classList.add('d-none')\n  }\n  for (const el of document.querySelectorAll('.js-focus-commit-suggestions-form-button')) {\n    /* eslint-disable-next-line github/no-d-none */\n    el.classList.add('d-none')\n  }\n  for (const el of document.querySelectorAll('.js-pending-batched-suggestion-label')) {\n    /* eslint-disable-next-line github/no-d-none */\n    el.classList.add('d-none')\n  }\n}\n\nfunction displayButton(button: Element, labelMessage: string) {\n  button.setAttribute('aria-label', labelMessage)\n  /* eslint-disable-next-line github/no-d-none */\n  button.classList.remove('d-none')\n}\n\nfunction disableSuggestionButtonWithMessage(\n  addBatchedSuggestionButton: HTMLElement | null | undefined,\n  openInEditorButton: HTMLElement | null | undefined,\n  message: string,\n) {\n  if (addBatchedSuggestionButton) {\n    addBatchedSuggestionButton.setAttribute('disabled', 'disabled')\n    addBatchedSuggestionButton.setAttribute('aria-label', message)\n  }\n\n  if (openInEditorButton) {\n    openInEditorButton.hidden = true\n  }\n}\n\nfunction validateOnPreview(message: string, blobContainer: HTMLElement) {\n  const template = document\n    .querySelector<HTMLElement>('.js-suggested-changes-inline-validation-template')!\n    .cloneNode(true) as HTMLElement\n  template.classList.remove('js-suggested-changes-inline-validation-template')\n  const span = template.querySelector<HTMLElement>('.js-suggested-changes-inline-error-message')!\n  span.textContent = message.trim()\n\n  const parentNode = blobContainer.parentNode!\n  parentNode.insertBefore(template, blobContainer.nextSibling)\n}\n\non('click', '.js-suggested-change-toolbar-item', function (e) {\n  const item = e.currentTarget\n  if (item instanceof HTMLButtonElement && item.getAttribute('aria-disabled') === 'false') {\n    renderSuggestionBlock(item)\n  }\n})\n\non('click', '.js-refresh-after-suggestion', reload)\n\nexport function validateInlineCommmentsContainer(el: Element) {\n  const isCommitsTab = document.querySelector('.js-suggested-changes-subset-files')\n\n  if (!isCommitsTab) {\n    return\n  }\n  const items = el.querySelectorAll<HTMLButtonElement>('.js-suggested-change-toolbar-item')\n  const klass = VALIDATION_CLASSES.viewingSubset\n  if (!klass) return\n\n  const message = document.querySelector<HTMLElement>(klass)!.textContent!.trim()\n  for (const item of items) {\n    item.setAttribute('aria-disabled', 'true')\n    const tooltip_id = item.getAttribute('aria-describedby')\n    if (!tooltip_id) continue\n    const tooltip = document.getElementById(tooltip_id)\n    if (!tooltip) continue\n    tooltip.textContent = message\n  }\n}\n\nobserve('.js-inline-comments-container', {\n  add(el) {\n    validateInlineCommmentsContainer(el)\n  },\n})\n\nobserve('.js-preview-body .js-apply-changes', {\n  add(el) {\n    const container = el.closest('.js-suggested-changes-container')\n\n    if (!container) {\n      return el.remove()\n    }\n\n    const validateRightBlob = document.querySelector<HTMLElement>(VALIDATION_CLASSES.rightBlob)!.textContent!\n    const validateLeftBlob = document.querySelector<HTMLElement>(VALIDATION_CLASSES.leftBlob)!.textContent!\n    const blobContainer = el.closest<HTMLElement>('.js-suggested-changes-blob')!\n\n    if (container.getAttribute('data-thread-side') !== '') {\n      // when updating an existing comment, retrieve side details from data-thread-side\n      if (container.getAttribute('data-thread-side') === 'left') {\n        validateOnPreview(validateLeftBlob, blobContainer)\n        return el.remove()\n      }\n    } else {\n      // on a new comment, we don't have a thread yet so retrieve side details from inlineCommentForm instead\n      const inlineCommentForm = el.closest<HTMLElement>('.js-inline-comment-form')!\n      const inlineCommentFormSide = inlineCommentForm.querySelector<HTMLInputElement>('input[name=\"side\"]')!\n\n      if (!inlineCommentForm || !inlineCommentFormSide) {\n        return el.remove()\n      }\n\n      if (inlineCommentForm && inlineCommentFormSide.value === 'left') {\n        validateOnPreview(validateLeftBlob, blobContainer)\n        return el.remove()\n      }\n    }\n\n    const diffContainer = el.previousElementSibling!\n    const originalLineContainer = diffContainer.querySelector('.js-blob-code-deletion')\n    const suggestedLinesContainer = diffContainer.querySelectorAll('.js-blob-code-addition')\n\n    if (!originalLineContainer || suggestedLinesContainer.length === 0) {\n      return\n    }\n\n    const originalLine = originalLineContainer.textContent\n    const suggestedLines = Array.from(suggestedLinesContainer).map(x => x.textContent)\n\n    if (originalLine === suggestedLines.join('\\n')) {\n      validateOnPreview(validateRightBlob, blobContainer)\n      return el.remove()\n    }\n\n    el.remove()\n  },\n})\n\nobserve('.js-comment-body .js-apply-changes', {\n  add(el) {\n    const container = el.closest('.js-comment')\n    if (!container) {\n      return el.remove()\n    }\n\n    // In a review thread, there is the potential for multiple suggested changes templates\n    const template = container.querySelector('.js-suggested-changes-template')\n\n    if (!(template instanceof HTMLTemplateElement)) {\n      return el.remove()\n    }\n\n    const clonedFormContainer = template.content.cloneNode(true) as DocumentFragment\n    const disabledApplyButton = clonedFormContainer.querySelector<HTMLElement>('.js-disabled-apply-suggestion-button')!\n    let addBatchedSuggestionButton\n\n    try {\n      addBatchedSuggestionButton = clonedFormContainer.querySelector<HTMLElement>('.js-batched-suggested-changes-add')!\n    } catch (err) {\n      // Rethrow non-QueryErrors if we see them\n      // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n      if (err.name !== 'QueryError') {\n        throw err\n      }\n    }\n    // In case we're a new comment dropped into the files tab via live update, enable the button\n    if (document.querySelectorAll('.js-suggested-changes-files-tab').length) {\n      const addToBatchEnabledMessage = document.querySelector<HTMLElement>(\n        VALIDATION_CLASSES.addToBatchEnabled,\n      )!.textContent\n      if (addBatchedSuggestionButton) {\n        addBatchedSuggestionButton.removeAttribute('disabled')\n        addBatchedSuggestionButton.setAttribute('aria-label', addToBatchEnabledMessage as string)\n      }\n    }\n\n    const openInEditorButton = clonedFormContainer.querySelector<HTMLElement>('.js-open-in-editor')\n\n    const pullHeaderDetails = document.querySelector<HTMLElement>('.js-pull-header-details')!\n    const pullIsOpen = pullHeaderDetails && pullHeaderDetails.getAttribute('data-pull-is-open') === 'true'\n    const threadContainer = el.closest('.js-resolvable-timeline-thread-container')\n    const commentIsPending = template.getAttribute('data-comment-pending') === 'true'\n    const inMergeQueue = template.getAttribute('data-in-merge-queue') === 'true'\n    if (threadContainer && threadContainer.getAttribute('data-resolved') === 'true') {\n      const resolvedThreadMessage = document.querySelector<HTMLElement>(VALIDATION_CLASSES.resolvedThread)!.textContent!\n      const details = clonedFormContainer.querySelector('details')\n      if (details) {\n        details.remove()\n      }\n      displayButton(disabledApplyButton, resolvedThreadMessage)\n      disableSuggestionButtonWithMessage(addBatchedSuggestionButton, openInEditorButton, resolvedThreadMessage)\n\n      return el.replaceWith(clonedFormContainer)\n    }\n\n    if (!pullIsOpen) {\n      const pullNotOpenMessage = document.querySelector<HTMLElement>(VALIDATION_CLASSES.closedOrMergedPull)!\n        .textContent!\n      displayButton(disabledApplyButton, pullNotOpenMessage)\n      disableSuggestionButtonWithMessage(addBatchedSuggestionButton, openInEditorButton, pullNotOpenMessage)\n\n      return el.replaceWith(clonedFormContainer)\n    }\n\n    if (inMergeQueue) {\n      const inMergeQueueValidationClass = document.querySelector<HTMLElement>(VALIDATION_CLASSES.inMergeQueue)\n      let inMergeQueueMessage = ''\n      if (inMergeQueueValidationClass) {\n        inMergeQueueMessage = inMergeQueueValidationClass.textContent || ''\n      }\n\n      const details = clonedFormContainer.querySelector('details')\n      if (details) {\n        details.remove()\n      }\n\n      displayButton(disabledApplyButton, inMergeQueueMessage)\n      disableSuggestionButtonWithMessage(addBatchedSuggestionButton, openInEditorButton, inMergeQueueMessage)\n\n      return el.replaceWith(clonedFormContainer)\n    }\n\n    if (commentIsPending) {\n      const pendingMessage = document.querySelector<HTMLElement>(VALIDATION_CLASSES.pendingReview)!.textContent!\n      clonedFormContainer.querySelector<HTMLElement>('details')!.remove()\n      displayButton(disabledApplyButton, pendingMessage)\n      disableSuggestionButtonWithMessage(addBatchedSuggestionButton, openInEditorButton, pendingMessage)\n\n      return el.replaceWith(clonedFormContainer)\n    }\n\n    const commitsTab = document.querySelector('.js-suggested-changes-subset-files')\n    const outdatedComment = template.getAttribute('data-outdated-comment') === 'true'\n    if (commitsTab || outdatedComment) {\n      let message\n      if (commitsTab) {\n        message = document.querySelector<HTMLElement>(VALIDATION_CLASSES.viewingSubset)!.textContent\n      } else if (outdatedComment) {\n        message = document.querySelector<HTMLElement>(VALIDATION_CLASSES.outdatedComment)!.textContent\n      }\n\n      clonedFormContainer.querySelector<HTMLElement>('details')!.remove()\n      displayButton(disabledApplyButton, message as string)\n      disableSuggestionButtonWithMessage(addBatchedSuggestionButton, openInEditorButton, message as string)\n\n      return el.replaceWith(clonedFormContainer)\n    }\n\n    const form = clonedFormContainer.querySelector<HTMLElement>('.js-single-suggested-change-form')!\n    const suggestedChangesBlob = el.closest('.js-suggested-changes-blob')\n\n    if (suggestedChangesBlob) {\n      const deletionsContainers = suggestedChangesBlob.querySelectorAll('.js-blob-code-deletion')\n      const additionsContainers = suggestedChangesBlob.querySelectorAll('.js-blob-code-addition')\n\n      if (!deletionsContainers) {\n        return\n      }\n\n      const originalLines = Array.from(deletionsContainers).map(x => x.textContent!)\n      const suggestedLines = Array.from(additionsContainers).map(x => x.textContent!)\n      const suggestedChangesSame =\n        originalLines.length === suggestedLines.length &&\n        originalLines.every((line, index) => line === suggestedLines[index])\n      if (suggestedChangesSame) {\n        const unchangedSuggestionMessage = document.querySelector<HTMLElement>(VALIDATION_CLASSES.unchangedSuggestion)!\n          .textContent!\n        clonedFormContainer.querySelector<HTMLElement>('details')!.remove()\n        displayButton(disabledApplyButton, unchangedSuggestionMessage)\n        disableSuggestionButtonWithMessage(addBatchedSuggestionButton, openInEditorButton, unchangedSuggestionMessage)\n      } else {\n        for (const line of suggestedLines) {\n          const input = document.createElement('input')\n          input.setAttribute('type', 'hidden')\n          input.setAttribute('name', 'value[]')\n          input.value = line\n          form.appendChild(input)\n        }\n      }\n    }\n\n    el.replaceWith(clonedFormContainer)\n  },\n})\n\n// Reset buttons with disabled tooltipped versions when\n// a PR gets closed or merged\nobserve('.js-pull-header-details', {\n  add(el) {\n    const pullIsOpen = el.getAttribute('data-pull-is-open') === 'true'\n    const template = document.querySelector('.js-suggested-changes-template')\n\n    if (pullIsOpen || !(template instanceof HTMLTemplateElement)) {\n      return\n    }\n\n    const templateContent = template?.content\n    const message = document.querySelector<HTMLElement>(VALIDATION_CLASSES.closedOrMergedPull)!.textContent!\n    disableAllApplySuggestionButtons(templateContent, message)\n    disableBatchSuggestionsButtons(message)\n  },\n})\n\n// Disable all apply suggestion buttons when viewing a subset of changes\nobserve('.js-suggested-changes-subset-files', {\n  add() {\n    const template = document.querySelector('.js-suggested-changes-template')\n    if (!(template instanceof HTMLTemplateElement)) {\n      return\n    }\n    const templateContent = template.content\n    const message = document.querySelector<HTMLElement>(VALIDATION_CLASSES.viewingSubset)!.textContent!\n    disableAllApplySuggestionButtons(templateContent, message)\n    disableBatchSuggestionsButtons(message)\n  },\n})\n\n// Disable all apply suggestion buttons when the head OID of the PR has not loaded. This\n// can happen when the Spokes database cluster is down.\nobserve('.js-suggested-changes-template', {\n  add(el) {\n    const headOidisLoaded = el.getAttribute('data-head-oid-is-loaded') === 'true'\n    if (!(el instanceof HTMLTemplateElement) || headOidisLoaded) {\n      return\n    }\n\n    const templateContent = el.content\n    const message = document.querySelector<HTMLElement>(VALIDATION_CLASSES.headOidNotLoaded)?.textContent || ''\n    disableAllApplySuggestionButtons(templateContent, message)\n    disableBatchSuggestionsButtons(message)\n  },\n})\n\non('click', '.js-apply-suggestion-button', async function (event) {\n  const details = event.currentTarget.parentElement\n  if (details) {\n    const titleInput = details.querySelector<HTMLElement>('.js-suggestion-commit-title')!\n    setTimeout(() => titleInput.focus(), 1)\n  }\n})\n\nonKey('keypress', '.js-comment-field', function (event: KeyboardEvent) {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable @github-ui/ui-commands/no-manual-shortcut-logic */\n  if (event.key === 'Enter') {\n    const textarea = event.target as HTMLTextAreaElement\n    if (insertNewSuggestionLine(textarea)) {\n      event.preventDefault()\n    }\n  }\n  /* eslint-enable @github-ui/ui-commands/no-manual-shortcut-logic */\n})\n\nonKey('keypress', '.js-suggestion-commit-message', function (event) {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable @github-ui/ui-commands/no-manual-shortcut-logic */\n  const textarea = event.currentTarget as HTMLTextAreaElement\n  if (event.key === 'Enter') {\n    textarea.setAttribute('rows', '3')\n  }\n  /* eslint-enable @github-ui/ui-commands/no-manual-shortcut-logic */\n})\n\nfunction updatePendingSuggestionsState(menu: HTMLElement) {\n  const container = menu.closest<HTMLElement>('.js-review-state-classes')!\n  const batchedSuggestionsCount = container.querySelectorAll('[data-pending-batched-suggestion]').length\n\n  for (const el of document.querySelectorAll('.js-pending-batched-suggested-changes-count')) {\n    el.textContent = String(batchedSuggestionsCount)\n  }\n\n  const message = document.querySelector<HTMLElement>('.js-reenable-add-to-batch')!.textContent!\n  for (const el of document.querySelectorAll('[data-batched-suggestion-reenable-sibling]')) {\n    el.removeAttribute('data-batched-suggestion-reenable-sibling')\n    el.removeAttribute('disabled')\n    el.setAttribute('aria-label', message)\n  }\n\n  if (batchedSuggestionsCount > 0) {\n    menu.hidden = false\n\n    const button = menu.querySelector<HTMLElement>('.js-batched-suggested-changes-toggle')!\n    button.classList.add('anim-pulse-in')\n    button.addEventListener('animationend', () => button.classList.remove('anim-pulse-in'), {once: true})\n\n    for (const el of document.querySelectorAll('.js-apply-single-suggestion')) {\n      /* eslint-disable-next-line github/no-d-none */\n      el.classList.add('d-none')\n    }\n    for (const el of document.querySelectorAll('.js-batched-suggested-changes-add')) {\n      const parent = el.closest<HTMLElement>('.js-suggested-change-form-container')!\n      if (\n        parent.getAttribute('data-pending-batched-suggestion') === 'true' ||\n        parent.getAttribute('data-comment-pending') === 'true' ||\n        parent.getAttribute('data-outdated-comment') === 'true'\n      ) {\n        /* eslint-disable-next-line github/no-d-none */\n        el.classList.add('d-none')\n      } else {\n        /* eslint-disable-next-line github/no-d-none */\n        el.classList.remove('d-none')\n      }\n\n      if (el.getAttribute('data-batched-suggestion-disabled-by-sibling') === 'true') {\n        el.removeAttribute('data-batched-suggestion-disabled-by-sibling')\n        el.setAttribute('disabled', 'disabled')\n        el.setAttribute('aria-label', document.querySelector<HTMLElement>('.js-one-suggestion-per-line')!.textContent!)\n      }\n    }\n    for (const el of document.querySelectorAll('.js-batched-suggested-changes-remove')) {\n      const parent = el.closest<HTMLElement>('.js-suggested-change-form-container')!\n      if (parent.getAttribute('data-pending-batched-suggestion') === 'true') {\n        /* eslint-disable-next-line github/no-d-none */\n        el.classList.remove('d-none')\n      } else {\n        /* eslint-disable-next-line github/no-d-none */\n        el.classList.add('d-none')\n      }\n    }\n    for (const el of document.querySelectorAll('.js-focus-commit-suggestions-form-button')) {\n      const parent = el.closest<HTMLElement>('.js-suggested-change-form-container')!\n      const commentIsPending = parent.getAttribute('data-comment-pending') === 'true'\n      const commentIsOutdated = parent.getAttribute('data-outdated-comment') === 'true'\n      const commentIsResolved = parent.getAttribute('data-resolved-comment') === 'true'\n\n      const grandParent = el.closest<HTMLElement>('.js-inline-comments-container')!\n      const side = grandParent.querySelector<HTMLInputElement>('input[name=\"side\"]')!\n      const commentOnDeletedLine = side.value === 'left'\n\n      if (commentIsPending || commentIsOutdated || commentIsResolved || commentOnDeletedLine) {\n        /* eslint-disable-next-line github/no-d-none */\n        el.classList.add('d-none')\n      } else {\n        /* eslint-disable-next-line github/no-d-none */\n        el.classList.remove('d-none')\n      }\n    }\n    for (const el of document.querySelectorAll('.js-pending-batched-suggestion-label')) {\n      const parent = el.closest<HTMLElement>('.js-suggested-change-form-container')!\n      if (parent.getAttribute('data-pending-batched-suggestion') === 'true') {\n        /* eslint-disable-next-line github/no-d-none */\n        el.classList.remove('d-none')\n      } else {\n        /* eslint-disable-next-line github/no-d-none */\n        el.classList.add('d-none')\n      }\n    }\n  } else {\n    menu.hidden = true\n\n    for (const el of document.querySelectorAll('.js-apply-single-suggestion')) {\n      /* eslint-disable-next-line github/no-d-none */\n      el.classList.remove('d-none')\n    }\n    for (const el of document.querySelectorAll('.js-batched-suggested-changes-add')) {\n      /* eslint-disable-next-line github/no-d-none */\n      el.classList.remove('d-none')\n    }\n    for (const el of document.querySelectorAll('.js-batched-suggested-changes-remove')) {\n      /* eslint-disable-next-line github/no-d-none */\n      el.classList.add('d-none')\n    }\n    for (const el of document.querySelectorAll('.js-focus-commit-suggestions-form-button')) {\n      /* eslint-disable-next-line github/no-d-none */\n      el.classList.add('d-none')\n    }\n    for (const el of document.querySelectorAll('.js-pending-batched-suggestion-label')) {\n      /* eslint-disable-next-line github/no-d-none */\n      el.classList.add('d-none')\n    }\n  }\n}\n\nfunction updatePendingSuggestionsHandler() {\n  const menu = document.querySelector<HTMLElement>('.js-batched-suggested-changes-container')\n  if (menu) setTimeout(() => updatePendingSuggestionsState(menu))\n}\n\non('click', '.js-batched-suggested-changes-add', function (event) {\n  const target = event.target as HTMLElement\n  const parent = target.closest<HTMLElement>('.js-suggested-change-form-container')!\n  if (\n    parent.getAttribute('data-comment-pending') === 'true' ||\n    parent.getAttribute('data-outdated-comment') === 'true' ||\n    target.getAttribute('data-batched-suggestion-disabled-by-sibling') === 'true'\n  ) {\n    return\n  }\n\n  parent.setAttribute('data-pending-batched-suggestion', 'true')\n\n  const grandParent = target.closest<HTMLElement>('.js-inline-comments-container')!\n  for (const el of grandParent.querySelectorAll('.js-batched-suggested-changes-add')) {\n    el.setAttribute('data-batched-suggestion-disabled-by-sibling', 'true')\n  }\n  target.removeAttribute('data-batched-suggestion-disabled-by-sibling')\n\n  updatePendingSuggestionsHandler()\n})\n\non('click', '.js-batched-suggested-changes-remove', function (event) {\n  const parent = event.currentTarget.closest<HTMLElement>('.js-suggested-change-form-container')!\n  parent.removeAttribute('data-pending-batched-suggestion')\n\n  const grandParent = event.currentTarget.closest<HTMLElement>('.js-inline-comments-container')!\n  for (const el of grandParent.querySelectorAll('.js-batched-suggested-changes-add')) {\n    el.setAttribute('data-batched-suggestion-reenable-sibling', 'true')\n  }\n\n  updatePendingSuggestionsHandler()\n})\n\non('click', '.js-focus-commit-suggestions-form-button', function (event) {\n  event.preventDefault()\n  window.location.href = '#clear-commit-suggestions'\n  window.location.href = '#commit-suggestions'\n})\n\non('click', '.js-dismiss-batched-suggested-changes-onboarding-notice', async function (event) {\n  const dismissUrl = event.currentTarget.getAttribute('data-url')!\n  const token = event.currentTarget.parentElement!.querySelector<HTMLInputElement>('.js-data-url-csrf')!\n  const data = new FormData()\n  data.append('notice', 'batched_suggested_changes_onboarding_prompt')\n  const response = await fetch(dismissUrl, {\n    method: 'POST',\n    mode: 'same-origin',\n    body: data,\n    headers: {\n      'Scoped-CSRF-Token': token.value,\n      'X-Requested-With': 'XMLHttpRequest',\n    },\n  })\n  if (response.ok) {\n    for (const notice of document.querySelectorAll('.js-batched-suggested-change-onboarding-notice')) {\n      notice.remove()\n    }\n  }\n})\n\ninterface Change {\n  commentId: string\n  path: string\n  suggestion: string[]\n}\n\nfunction convertFormInputs(form: HTMLFormElement, changes: Change[]) {\n  const commitTitleInput = form.querySelector<HTMLInputElement>('input[name=commit_title]')!\n  const commitMessageInput = form.querySelector<HTMLTextAreaElement>('textarea[name=commit_message]')!\n  let message = commitTitleInput.value.trim()\n  if (message === '') {\n    message = commitTitleInput.defaultValue\n  }\n  const commitMessage = commitMessageInput.value.trim()\n  if (commitMessage !== '') {\n    message = `${message}\\n\\n${commitMessage}\\n`\n  }\n  commitTitleInput.disabled = true\n  commitMessageInput.disabled = true\n\n  const messageInput = document.createElement('input')\n  messageInput.setAttribute('type', 'hidden')\n  messageInput.setAttribute('name', 'message')\n  messageInput.value = message\n  form.appendChild(messageInput)\n\n  const changesInput = document.createElement('input')\n  changesInput.setAttribute('type', 'hidden')\n  changesInput.setAttribute('name', 'changes')\n  changesInput.value = JSON.stringify(changes)\n  form.appendChild(changesInput)\n}\n\non('click', '.js-single-suggested-change-form .js-suggested-changes-submit', function (event) {\n  const submitButton = event.currentTarget\n  const form = submitButton.closest<HTMLFormElement>('.js-single-suggested-change-form')!\n\n  const lineValues = Array.from(form.querySelectorAll<HTMLInputElement>('input[name=\"value[]\"]')).map(i => i.value)\n  const changes = [\n    {\n      commentId: form.querySelector<HTMLInputElement>('input[name=comment_id]')!.value,\n      path: form.querySelector<HTMLInputElement>('input[name=path]')!.value,\n      suggestion: lineValues,\n    },\n  ]\n\n  convertFormInputs(form, changes)\n})\n\nremoteForm('.js-single-suggested-change-form', async function (form, wants) {\n  const formContainer = form.closest<HTMLElement>('.js-suggested-change-form-container')!\n  const dropdown = form.closest<HTMLElement>('details')!\n  const appliedButton = formContainer.querySelector<HTMLElement>('.js-suggestion-applied')!\n  const containerParent = form.closest<HTMLElement>('.js-suggested-changes-contents')!\n  const errorMessageContainer = containerParent.querySelector<HTMLElement>('.js-error-message-placeholder')!\n\n  try {\n    await wants.json()\n    /* eslint-disable-next-line github/no-d-none */\n    appliedButton.classList.remove('d-none')\n    const addToBatchButton = formContainer.querySelector<HTMLElement>('.js-batched-suggested-changes-add')!\n    /* eslint-disable-next-line github/no-d-none */\n    addToBatchButton.classList.add('d-none')\n\n    dropdown.remove()\n    reload()\n  } catch (error) {\n    // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n    if (error.name !== 'QueryError') {\n      // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n      const errorMessage = error.response.json && error.response.json.error\n      const errorMessageElement = errorMessageContainer.querySelector<HTMLElement>('.js-error-message')!\n\n      errorMessageContainer.hidden = false\n      errorMessageElement.textContent = errorMessage\n      formContainer.prepend(errorMessageContainer)\n\n      const buttonContainer = form.closest<HTMLElement>('.js-suggested-change-form-container')!\n      const addToBatchButton = buttonContainer.querySelector<HTMLElement>('.js-batched-suggested-changes-add')!\n      /* eslint-disable-next-line github/no-d-none */\n      addToBatchButton.classList.add('d-none')\n      dropdown.remove()\n    }\n  }\n})\n\non('click', '.js-suggestion-batch-submit', function (event) {\n  const form = event.currentTarget.closest<HTMLFormElement>('.js-batched-suggested-changes-form')!\n  const changes = []\n  for (const el of document.querySelectorAll('[data-pending-batched-suggestion]')) {\n    const changeForm = el.querySelector<HTMLFormElement>('.js-single-suggested-change-form')!\n    const lineValues = Array.from(changeForm.querySelectorAll<HTMLInputElement>('input[name=\"value[]\"]')).map(\n      i => i.value,\n    )\n    changes.push({\n      commentId: changeForm.querySelector<HTMLInputElement>('input[name=comment_id]')!.value,\n      path: changeForm.querySelector<HTMLInputElement>('input[name=path]')!.value,\n      suggestion: lineValues,\n    })\n  }\n  convertFormInputs(form, changes)\n})\n\nremoteForm('.js-batched-suggested-changes-form', async function (form, wants) {\n  try {\n    await wants.json()\n    const menu = form.closest<HTMLElement>('.js-batched-suggested-changes-container')!\n    menu.hidden = true\n    reload()\n  } catch (error) {\n    // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n    const errorMessage = error.response.json && error.response.json.error\n    const formParent = form.closest<HTMLElement>('.js-batched-suggested-changes-container')!\n    const errorMessageContainer = formParent.querySelector<HTMLElement>('.js-error-message-container')!\n    const errorMessageSpan = errorMessageContainer.querySelector<HTMLElement>('.js-error-message')!\n    errorMessageSpan.textContent = errorMessage\n    errorMessageContainer.hidden = false\n  }\n})\n\nobserve('.js-files-tab-stale', {\n  add() {\n    const menu = document.querySelector<HTMLElement>('.js-batched-suggested-changes-container')\n    if (menu) {\n      setTimeout(() => {\n        menu.hidden = true\n      })\n    }\n  },\n})\n","import {blurForm, focusForm} from '../behaviors/inline-comment'\nimport {clearSelection, getCurrentRange, isMultiLineCommentAllowed} from './linkable-line-number'\nimport {TemplateInstance} from '@github/template-parts'\nimport {changeValue} from '@github-ui/form-utils'\nimport {fetchSafeDocumentFragment} from '@github-ui/fetch-utils'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {parseHTML} from '@github-ui/parse-html'\nimport {remoteForm} from '@github/remote-form'\nimport {validateInlineCommmentsContainer} from '../pulls/suggested-changes'\n\nlet sequence = 0\n\n// \"+\" button\n//\n// Insert new row and setup a fresh comment form.\non('click', '.js-add-file-comment', function (event) {\n  const button = event.currentTarget as Element\n\n  const file = button.closest<HTMLElement>('.file')!\n  ensureInlineNotesEnabled(file)\n\n  // Find or insert a tr.inline-comments row after the current line\n  const threadRow = existingFileComment(button) || insertFileComment(button)\n\n  // Find or insert a new comment thread form\n  const thread = findOrInsertCommentThread(threadRow.querySelector('td') as Element, button)\n\n  // fill out hidden form fields\n  const form = thread.querySelector('.js-inline-comment-form')!\n  if (form instanceof HTMLFormElement) {\n    // hide suggestion button\n    const suggestionButton = form.getElementsByClassName('js-suggestion-button-placeholder')[0] as HTMLElement\n    if (suggestionButton) {\n      suggestionButton.style.display = 'none'\n    }\n\n    fillTemplateFormFields(form, button)\n  }\n  focusForm(thread)\n})\n\nfunction existingFileComment(button: Element): Element | undefined {\n  const thisHeader = button.closest<HTMLElement>('.file-header')!\n  const table = next(thisHeader, '.diff-table')\n  if (table instanceof Element) {\n    const commentsContainer = table.querySelector('.js-inline-comments-container')\n    if (commentsContainer instanceof Element) {\n      return commentsContainer\n    }\n  }\n}\n\n// \"+\" button\n//\n// Insert new row and setup a fresh comment form.\non('click', '.js-add-single-line-comment', function (event) {\n  const button = event.currentTarget as Element\n\n  const file = button.closest<HTMLElement>('.file')!\n  ensureInlineNotesEnabled(file)\n\n  // Find or insert a tr.inline-comments row after the current line\n  const threadRow = existingCommentRow(button) || insertCommentRow(button)\n\n  // Find or insert a new comment thread form\n  const thread = findOrInsertCommentThread(threadRow.querySelector('td') as Element, button)\n\n  // fill out hidden form fields\n  const form = thread.querySelector('.js-inline-comment-form')!\n  if (form instanceof HTMLFormElement) {\n    fillTemplateFormFields(form, button)\n  }\n  focusForm(thread)\n})\n\n// We have already inserted a comment row due to previous user interaction -\n// so let's be sure the form gets added to the right spot!\nfunction existingCommentRow(button: Element): Element | undefined {\n  const thisRow = button.closest<HTMLElement>('tr')!\n  const commentsContainer = next(thisRow, '.js-inline-comments-container')\n  if (commentsContainer instanceof Element) {\n    return commentsContainer\n  }\n}\n\nfunction next(el: Element, selector: string): Element | null {\n  const sibling = el.nextElementSibling\n  return sibling && sibling.matches(selector) ? sibling : null\n}\n\n// Insert a new comment form row via the hidden template\nexport function insertCommentRow(button: Element): Element {\n  const thisRow = button.closest<HTMLElement>('tr')!\n  const nextRow = renderCommentTemplate('js-inline-comments-single-container-template', button).firstElementChild!\n  thisRow.after(nextRow)\n  return nextRow\n}\n\n// Insert a new comment form for a file header via the hidden template\nfunction insertFileComment(button: Element): Element {\n  const thisHeader = button.closest<HTMLElement>('.file-header')!\n  const table = document.createElement('table')\n  table.className = 'diff-table'\n  const nextRow = renderCommentTemplate('js-inline-comments-single-container-template', button).firstElementChild!\n  table.appendChild(nextRow)\n  thisHeader.after(table)\n  return nextRow\n}\n\n// For a given comment threads container, find or insert\n// an unused comment form.\nfunction findOrInsertCommentThread(comments: Element, button: Element): Element {\n  const existingForm = Array.from(comments.querySelectorAll('.review-comment-form-container')).pop()\n  if (existingForm) {\n    return existingForm.closest('div.js-line-comments') as Element\n  } else {\n    const newThread = renderCommentTemplate('js-inline-comments-single-container-template', button).querySelector(\n      'div.js-line-comments',\n    )!\n    comments.appendChild(newThread)\n    return newThread\n  }\n}\n\non('click', '.js-add-split-line-comment', function (event) {\n  const button = event.currentTarget\n\n  const file = button.closest<HTMLElement>('.file')!\n  ensureInlineNotesEnabled(file)\n\n  const row = button.closest<HTMLElement>('tr')!\n  const className = button.getAttribute('data-type') === 'addition' ? 'js-addition' : 'js-deletion'\n\n  // Find or insert a tr.inline-comments row after the current line\n  const threadRow = inlineCommentsSplitContainerForLine(row)\n\n  // Find the left/right cell based on whether the comment is on an\n  // addition or deletion\n  const td = expandLineCommentsEmptyCells(threadRow, className, button)\n\n  // Find or insert a new comment thread form in the appropriate column\n  const thread = findOrInsertCommentThread(td, button)\n\n  // fill out hidden form fields\n  const form = thread.querySelector('.js-inline-comment-form')!\n  if (form instanceof HTMLFormElement) {\n    fillTemplateFormFields(form, button)\n  }\n\n  focusForm(thread)\n})\n\n// Handle \"Comment on this line\"\nremoteForm('.js-inline-comment-form', async function (form, wants) {\n  resetInlineCommentError(form)\n\n  let response\n  try {\n    response = await wants.json()\n  } catch (err) {\n    // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n    if (err.response) {\n      let errData\n      try {\n        // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n        errData = err.response.json\n      } catch {\n        // ignore\n      }\n      if (errData) {\n        handleInlineCommentError(form, errData)\n        return\n      }\n    }\n    throw err\n  }\n\n  const data = response.json\n\n  // Add new comment at the end of the thread.\n  const commentHtml = data['inline_comment']\n  const container = form.closest('.js-line-comments')!\n  if (commentHtml) {\n    container.querySelector<HTMLElement>('.js-comments-holder')!.append(parseHTML(document, commentHtml))\n  }\n\n  // Replace previous form with new thread and updated form in response.\n  const threadHtml = data['inline_comment_thread']\n  if (threadHtml) {\n    const fragment = parseHTML(document, threadHtml)\n    let replaced = false\n\n    if (data['replace_container']) {\n      const commentContainer = form.closest('.js-inline-comments-container')\n      const newCommentContainer = fragment.querySelector('.js-inline-comments-container')\n\n      if (commentContainer && newCommentContainer) {\n        commentContainer.replaceWith(newCommentContainer)\n        replaced = true\n      }\n    }\n\n    if (!replaced) {\n      container.replaceWith(fragment)\n      replaced = true\n    }\n  }\n\n  blurForm(form)\n})\n\nfunction resetInlineCommentError(form: HTMLFormElement) {\n  const error = form.querySelector<HTMLDivElement>('.js-comment-form-error')\n  if (error) {\n    error.hidden = true\n    error.textContent = null\n  }\n}\n\nfunction handleInlineCommentError(form: HTMLFormElement, data: {errors: string[] | string}) {\n  const error = form.querySelector<HTMLElement>('.js-comment-form-error')!\n\n  let message\n  if (data.errors) {\n    if (Array.isArray(data.errors)) {\n      message = data.errors.join(', ')\n    } else {\n      message = data.errors\n    }\n  } else {\n    // eslint-disable-next-line i18n-text/no-en\n    message = 'There was an error posting your comment.'\n  }\n\n  error.textContent = message\n\n  // This remains for backwards-compatibility with error elements that do not\n  // use the 'd-none' utility class.\n  error.style.display = 'block'\n\n  error.hidden = false\n\n  // On a formError element that uses the 'd-none' utility class, setting the\n  // style attribute directly does not work because 'd-none' is declared as\n  // !important. Instead, remove 'd-none'.\n  /* eslint-disable-next-line github/no-d-none */\n  error.classList.remove('d-none')\n}\n\n// Resume reply comment form on existing thread.\nfunction showReplyForm(id: string) {\n  const [anchor, threadReplyToId] = id.match(/^new_inline_comment_(?:discussion|diff)_(?:[\\w-]+)_(\\d+)_(\\d+)$/) || []\n  if (!anchor) return\n\n  const input = document.querySelector(`.js-inline-comment-form input[name='in_reply_to'][value='${threadReplyToId}']`)\n  if (!input) return\n\n  const form = input.closest('.js-line-comments')\n  if (form) focusForm(form)\n}\n\n// Resume new thread comment form.\nfunction showCommentForm(id: string) {\n  const [anchor, position] = id.match(/^new_inline_comment_diff_(?:[\\w-]+)_(\\d+)$/) || []\n  if (!anchor) return\n\n  const button = document.querySelector<HTMLButtonElement>(\n    `.js-add-line-comment[data-anchor='${anchor}'][data-position='${position}']`,\n  )\n  if (button) button.click()\n}\n\n// Support session resume on dynamically inserted line comment forms.\ndocument.addEventListener('session:resume', function (event: Event) {\n  const detail = (event as CustomEvent).detail\n  showReplyForm(detail.targetId)\n  showCommentForm(detail.targetId)\n})\n\n// Ensure \"Show notes\" is checked for file.\n//\n// file - .file Element\nfunction ensureInlineNotesEnabled(file: Element) {\n  const checkbox = file.querySelector('.js-toggle-file-notes')\n  if (checkbox instanceof HTMLInputElement) {\n    changeValue(checkbox, true)\n  }\n}\n\n// Anytime a inline comment is removed from the DOM, rescan for comment\n// holders that don't have any children.\nfunction cleanupInlineCommentContainers() {\n  for (const container of document.querySelectorAll('.file .js-inline-comments-container')) {\n    const comments = container.querySelectorAll('.js-comments-holder > *')\n    const hasComments = comments.length > 0\n    const isResolved = container.querySelector(\"[data-resolved='true']\") != null\n    const form = container.querySelector('.js-inline-comment-form-container')\n    const formOpen = !!form && form.classList.contains('open')\n    if (!(hasComments || isResolved) && !formOpen) {\n      container.remove()\n    }\n  }\n}\n\nobserve('.js-comment', {\n  remove: cleanupInlineCommentContainers,\n})\n\non('inlinecomment:focus', '.js-inline-comment-form-container', function (e) {\n  const suggestionContainer = (e.target as Element).querySelector('.js-suggested-changes-container')\n  if (suggestionContainer) loadSuggestionButton(suggestionContainer)\n})\n\nobserve('.js-suggested-changes-container.is-comment-editing', el => {\n  loadSuggestionButton(el)\n})\n\nfunction paramsForSuggestionButton(url: URL, form: HTMLFormElement): URLSearchParams | null {\n  const params = new URLSearchParams(url.search.slice(1))\n\n  const commentIdInput = form.elements.namedItem('in_reply_to') || form.elements.namedItem('comment_id')\n\n  const textarea = form.querySelector('textarea') as HTMLTextAreaElement\n  params.append('textarea_id', textarea.id)\n\n  if (commentIdInput instanceof HTMLInputElement && commentIdInput.value) {\n    params.append('comment_id', commentIdInput.value)\n    return params\n  }\n  const pathInput = form.elements.namedItem('path')\n  const startSideInput = form.elements.namedItem('start_side')\n  const startLineInput = form.elements.namedItem('start_line')\n  const endSideInput = form.elements.namedItem('side')\n  const endLineInput = form.elements.namedItem('line')\n  const startCommitOidInput = form.elements.namedItem('start_commit_oid')\n  const endCommitOidInput = form.elements.namedItem('end_commit_oid')\n  const baseCommitOidInput = form.elements.namedItem('base_commit_oid')\n  const subjectType = form.elements.namedItem('subject_type')\n\n  if (\n    !(pathInput instanceof HTMLInputElement) ||\n    !(startSideInput instanceof HTMLInputElement) ||\n    !(startLineInput instanceof HTMLInputElement) ||\n    !(endSideInput instanceof HTMLInputElement) ||\n    !(endLineInput instanceof HTMLInputElement) ||\n    !(startCommitOidInput instanceof HTMLInputElement) ||\n    !(endCommitOidInput instanceof HTMLInputElement) ||\n    !(baseCommitOidInput instanceof HTMLInputElement) ||\n    !(subjectType instanceof HTMLInputElement)\n  ) {\n    return null\n  }\n\n  params.append('path', pathInput.value)\n  params.append('start_side', startSideInput.value)\n  params.append('start_line', startLineInput.value)\n  params.append('end_side', endSideInput.value)\n  params.append('end_line', endLineInput.value)\n  params.append('start_commit_oid', startCommitOidInput.value)\n  params.append('end_commit_oid', endCommitOidInput.value)\n  params.append('base_commit_oid', baseCommitOidInput.value)\n  params.append('subject_type', subjectType.value)\n\n  return params\n}\n\nasync function loadSuggestionButton(container: Element) {\n  const el = container.querySelector('.js-suggestion-button-placeholder')\n  if (!el) {\n    return\n  }\n\n  const srcBase = el.getAttribute('data-src-base')\n  if (!srcBase) {\n    return\n  }\n\n  const url = new URL(srcBase, window.location.origin)\n  const form = el.closest('.js-inline-comment-form') || el.closest('.js-comment-update')\n  if (!(form instanceof HTMLFormElement)) {\n    return\n  }\n\n  const params = paramsForSuggestionButton(url, form)\n  if (!params) {\n    return\n  }\n\n  url.search = params.toString()\n\n  let button\n\n  // if the user cannot access the link (eg, 401), we bail\n  try {\n    button = await fetchSafeDocumentFragment(document, url.toString())\n  } catch {\n    return\n  }\n\n  el.textContent = ''\n  el.appendChild(button)\n}\n\ndocument.addEventListener('inlinecomment:collapse', () => {\n  cleanupInlineCommentContainers()\n})\n\n// Return existing line comments container or replace empty cells with the form\n// template.\n//\n// tr        - A HTMLTableRowElement .file-diff-line\n// className - 'js-addition' or 'js-deletion'\n//\n// Returns .js-line-comments HTMLTableCellElement.\nfunction expandLineCommentsEmptyCells(\n  threadRow: Element,\n  className: 'js-addition' | 'js-deletion',\n  button: Element,\n): Element {\n  const found = threadRow.querySelector(`.js-line-comments.${className}`)\n  if (found) {\n    return found\n  }\n  const lineComments = renderCommentTemplate('js-inline-comments-split-form-container-template', button)\n    .firstElementChild!\n  lineComments.classList.add(className)\n\n  const empty = threadRow.querySelectorAll(`.${className}`)\n  const last = empty[empty.length - 1]!\n  last.after(lineComments)\n  for (const el of empty) el.remove()\n\n  return lineComments\n}\n\n// Find or insert inline comments container for diff line.\n//\n// tr - A HTMLTableRowElement .file-diff-line\n//\n// Returns a .js-inline-comments-container HTMLTableRowElement.\nfunction inlineCommentsSplitContainerForLine(tr: Element): Element {\n  let nextRow: Element | null = next(tr, '.js-inline-comments-container')\n  if (nextRow) {\n    return nextRow\n  } else {\n    const id = 'js-inline-comments-split-container-template'\n    const template = document.getElementById(id)\n    if (!template) {\n      throw new Error(`Could not find element with id ${id}`)\n    }\n    if (!(template instanceof HTMLTemplateElement)) {\n      throw new Error(`Found element with id ${id} - but was not a Template`)\n    }\n    nextRow = new TemplateInstance(template, {}).firstElementChild!\n    tr.after(nextRow)\n    return nextRow\n  }\n}\n\nfunction applyMultiLinePreview(element: Element, lineNumber: string, side: string | undefined, isContext: boolean) {\n  element.classList.remove('color-bg-success', 'color-bg-danger')\n\n  if (isContext) {\n    element.textContent = lineNumber\n    return\n  }\n\n  if (side === 'right') {\n    element.classList.add('color-fg-success')\n    element.textContent = `+${lineNumber}`\n    return\n  }\n\n  if (side === 'left') {\n    element.classList.add('color-fg-danger')\n    element.textContent = `-${lineNumber}`\n    return\n  }\n\n  element.textContent = String(lineNumber)\n}\n\nconst sides: {[key: string]: string} = {R: 'right', L: 'left'}\n\nfunction fillMultilineFormFields(form: HTMLFormElement, button: Element) {\n  const currentRange = getCurrentRange()\n\n  if (!currentRange) {\n    return\n  }\n\n  // If the start and end are the same position it's not multi-line.\n  // We don't want to clear the selection though, so we handle this separate.\n  if (currentRange.end.is(currentRange.start)) {\n    return\n  }\n\n  if (!isMultiLineCommentAllowed(button, currentRange)) {\n    clearSelection()\n    return\n  }\n\n  // Grab the stuff we care about\n  const {\n    start: {lineNumber: startLineNumber},\n    end: {lineNumber: endLineNumber},\n  } = currentRange\n  let {\n    start: {side: startSide},\n    end: {side: endSide},\n  } = currentRange\n\n  const buttonLine = Number(button.getAttribute('data-line'))\n  const buttonSide = button.getAttribute('data-side')\n\n  if (\n    buttonLine !== endLineNumber ||\n    // Context lines always have data-side set to 'right', so skip\n    // comparing the sides if we're ending on a context line.\n    (!currentRange.end.isContext() && buttonSide !== sides[endSide])\n  ) {\n    // Deselect\n    clearSelection()\n    return\n  }\n\n  const sideValue = sides[startSide]\n\n  // These attributes get automatically converted to params in fillTemplateFormFields from line-comments.js\n\n  const startLineEl = form.elements.namedItem('start_line')\n  const startSideEl = form.elements.namedItem('start_side')\n  const endLineEl = form.elements.namedItem('line')\n  const endSideEl = form.elements.namedItem('side')\n  const previewStartSideEl = form.elements.namedItem('preview_start_side')\n  const previewSideEl = form.elements.namedItem('preview_side')\n  if (\n    startLineEl instanceof HTMLInputElement &&\n    startSideEl instanceof HTMLInputElement &&\n    endLineEl instanceof HTMLInputElement &&\n    endSideEl instanceof HTMLInputElement &&\n    previewStartSideEl instanceof HTMLInputElement &&\n    previewSideEl instanceof HTMLInputElement\n  ) {\n    startLineEl.value = String(startLineNumber)\n    startSideEl.value = sideValue!\n    startSideEl.value = previewStartSideEl.value = startSideEl.value\n    previewSideEl.value = endSideEl.value\n\n    const startLine = startLineEl.value\n    startSide = startSideEl.value\n    const endLine = endLineEl.value\n    endSide = endSideEl.value\n\n    const container = form.closest<HTMLElement>('.js-inline-comment-form-container')!\n\n    if (startLine && endLine) {\n      const multiLinePreview = container.querySelector<HTMLElement>('.js-multi-line-preview')!\n      const multiLinePreviewStart = multiLinePreview.querySelector<HTMLElement>('.js-multi-line-preview-start')!\n      const multiLinePreviewEnd = multiLinePreview.querySelector<HTMLElement>('.js-multi-line-preview-end')!\n\n      const startIsContext = currentRange.start.isContext()\n      const endIsContext = currentRange.end.isContext()\n\n      applyMultiLinePreview(multiLinePreviewStart, startLine, startSide, startIsContext)\n      applyMultiLinePreview(multiLinePreviewEnd, endLine, endSide, endIsContext)\n\n      multiLinePreview.hidden = false\n      container.classList.add('is-multiline')\n    } else {\n      container.querySelector<HTMLElement>('.js-multi-line-preview')!.hidden = true\n      container.classList.remove('is-multiline')\n    }\n\n    validateInlineCommmentsContainer(container)\n  }\n}\n\nfunction fillTemplateFormFields(form: HTMLFormElement, from: Element) {\n  const keys = ['type', 'path', 'position', 'line', 'side', 'original-line']\n\n  for (const key of keys) {\n    const field = form.elements.namedItem(key)\n    if (field instanceof HTMLInputElement) {\n      const value = from.getAttribute(`data-${key}`) || ''\n      field.value = value\n    }\n  }\n\n  const subjectType = form.elements.namedItem('subject_type')\n  if (subjectType instanceof HTMLInputElement) {\n    const value = from.getAttribute(`data-subject-type`) || ''\n    subjectType.value = value\n  }\n\n  // Update 'expanded_diff' form input field based on `from` element's 'data-expanded-diff' attribute\n  const expandedDiffField = form.getElementsByClassName('js-expanded-diff-placeholder-value')?.[0]\n  if (expandedDiffField instanceof HTMLInputElement) {\n    const value = from.getAttribute(`data-expanded-diff`) || ''\n    expandedDiffField.value = value\n  }\n\n  fillMultilineFormFields(form, from)\n}\n\n// Render template instance with given name and button data.\nfunction renderCommentTemplate(id: string, button: Element) {\n  const template = document.getElementById(id)\n  if (!template) {\n    throw new Error(`Could not find element with id ${id}`)\n  }\n  if (!(template instanceof HTMLTemplateElement)) {\n    throw new Error(`Found element with id ${id} - but was not a Template`)\n  }\n\n  return new TemplateInstance(template, {\n    anchor: button.getAttribute('data-anchor') || '',\n    position: button.getAttribute('data-position') || '',\n    subject_type: button.getAttribute('data-subject-type') || '',\n    sequence: sequence++,\n  })\n}\n","import type {IncludeFragmentElement} from '@github/include-fragment-element'\nimport {ensureExpanded} from '../behaviors/details'\nimport {findElementByFragmentName} from '../fragment-target'\nimport {loadDeferredContent} from '../behaviors/include-fragment'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {scrollIntoView} from '../sticky-scroll-into-view'\nimport {announce} from '@github-ui/aria-live'\n\nobserve('.js-diff-progressive-container', function (container) {\n  processProgressiveContainer(container)\n\n  const loader = container.querySelector('.js-diff-progressive-loader')\n  if (!loader) {\n    return\n  }\n\n  loader.addEventListener('load', function () {\n    processProgressiveContainer(container)\n  })\n})\n\nfunction loadResolvedComments(container: Element, anchor: string): void {\n  const commentContainers = container.querySelectorAll('.js-comment-container')\n\n  for (const commentContainer of commentContainers) {\n    const threadCommentIds = commentContainer.getAttribute('data-hidden-comment-ids')\n\n    if (threadCommentIds) {\n      const commentIds = threadCommentIds.split(',')\n      const anchorCommentId = anchor.match(/\\d+/g)?.[0]\n\n      if (anchorCommentId && commentIds.includes(anchorCommentId)) {\n        loadDeferredContent(commentContainer)\n        break\n      }\n    }\n  }\n}\n\nfunction processProgressiveContainer(container: Element): void {\n  const anchor = urlAnchor()\n  if (!anchor) {\n    return\n  }\n\n  scrollToAnchor(container, anchor)\n\n  const entryContainer = getEntryFromAnchor(container, anchor)\n  if (!entryContainer) {\n    return\n  }\n\n  scrollIntoView(entryContainer)\n  loadDiff(entryContainer)\n}\n\nobserve('.js-diff-load-container', function (container) {\n  const loader = container.querySelector('.js-diff-entry-loader')\n  if (!loader) {\n    return\n  }\n\n  loader.addEventListener('load', function () {\n    const fileContainer = container.closest<HTMLElement>('.js-file')!\n    fileContainer.classList.remove('hide-file-notes-toggle')\n\n    const loadDiffPathName = fileContainer.getAttribute('data-tagsearch-path')\n    announce(`loaded diff for ${loadDiffPathName}`)\n\n    const anchor = urlAnchor()\n    if (!anchor) {\n      return\n    }\n\n    scrollToAnchor(container, anchor)\n  })\n})\n\non('click', '.js-diff-load', function (event) {\n  if ((event.target as HTMLElement).classList.contains('js-ignore-this')) {\n    return\n  }\n\n  const entryContainer = event.currentTarget.closest<HTMLElement>('.js-diff-load-container')!\n  loadDiff(entryContainer)\n  entryContainer?.focus()\n  announce('Loading...')\n})\n\nfunction urlAnchor(): string {\n  return window.location.hash.slice(1)\n}\n\nfunction scrollToAnchor(container: Element, anchor: string): void {\n  let target: Element | null\n\n  // If anchor is a range, cut off the range characters\n  // E.g. 'diff-2b939de295abbeb764a2b0de8fe0e690L5-R7'\n  // to   'diff-2b939de295abbeb764a2b0de8fe0e690L5'\n  if (anchor.match(/^diff-.+[LR]\\d+-[LR]\\d+/)) {\n    target = findElementByFragmentName(container.ownerDocument, anchor.substring(0, anchor.indexOf('-', 5)))\n  } else {\n    target = findElementByFragmentName(container.ownerDocument, anchor)\n  }\n\n  if (target && container.contains(target)) {\n    ensureExpanded(target)\n    scrollIntoView(target)\n  } else {\n    loadResolvedComments(container, anchor)\n  }\n}\n\nfunction getEntryFromAnchor(container: Element, anchor: string): Element | undefined {\n  const entryContainer = getEntryFromDiffAnchor(container, anchor)\n  if (entryContainer) {\n    return entryContainer\n  }\n\n  return getEntryFromCommentAnchor(container, anchor)\n}\n\nfunction getEntryFromDiffAnchor(container: Element, anchor: string): Element | undefined {\n  const match = /^(diff-[0-9a-f]{32})(?:[L|R]\\d+)?$/.exec(anchor)\n  if (!match) {\n    return\n  }\n\n  const entryId = match[1]\n  const entryAnchor = container.querySelector(`a[name='${entryId}']`)\n  if (!entryAnchor) {\n    return\n  }\n\n  const entryContainer = entryAnchor.nextElementSibling\n  if (entryContainer && !entryContainer.querySelector('.js-diff-load-container')) {\n    return\n  }\n\n  return entryContainer!\n}\n\nfunction getEntryFromCommentAnchor(container: Element, anchor: string): Element | undefined {\n  const match = /^(?:r|commitcomment-)(\\d+)$/.exec(anchor)\n  if (!match) {\n    return\n  }\n\n  const commentId = match[1]\n  const commentDummy = container.querySelector(`#diff-with-comment-${commentId}`)\n\n  if (!commentDummy) {\n    return\n  }\n  const entryContainer = commentDummy.closest('.js-file')\n\n  return entryContainer!\n}\n\nfunction loadDiff(entryContainer: Element): Promise<string> {\n  const fragment = entryContainer.querySelector<IncludeFragmentElement>('.js-diff-entry-loader')!\n  const placeholder = entryContainer.querySelector<Element>('.js-diff-placeholder')!\n  const button = entryContainer.querySelector<HTMLButtonElement>('button.js-diff-load')!\n  const buttonText = entryContainer.querySelector<HTMLElement>('.js-button-text')!\n\n  // show loader and disable button\n  placeholder.setAttribute('fill', \"url('#animated-diff-gradient')\")\n  buttonText.textContent = button.getAttribute('data-disable-with') || ''\n  button.disabled = true\n\n  const url = new URL(fragment.getAttribute('data-fragment-url') || '', window.location.origin)\n  fragment.src = url.toString()\n\n  return fragment.data\n}\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {remoteForm} from '@github/remote-form'\nimport {replaceState} from '@github-ui/browser-history-state'\n\non('click', '.js-rendered, .js-source', function (event) {\n  const button = event.currentTarget\n  if (button.classList.contains('selected')) {\n    event.preventDefault()\n    return\n  }\n\n  updateWindowLocation(button)\n  updateSelectedButton(button)\n})\n\nremoteForm('.js-prose-diff-toggle-form', async function (form, wants) {\n  const entryContainer = form.closest<HTMLElement>('.js-details-container')!\n  const fileContent = entryContainer.querySelector<HTMLElement>('.js-file-content')!\n\n  const data = await wants.html()\n  while (fileContent.lastChild) {\n    fileContent.removeChild(fileContent.lastChild)\n  }\n  fileContent.append(data.html)\n\n  entryContainer.classList.toggle('display-rich-diff')\n})\n\nfunction updateWindowLocation(button: Element) {\n  const fileHeader = button.closest<HTMLElement>('.js-file-header')!\n  const switchToRendered = button.classList.contains('js-rendered')\n  const switchToSource = button.classList.contains('js-source')\n  const shortPath = fileHeader.getAttribute('data-short-path')!\n  const anchor = fileHeader.getAttribute('data-anchor')!\n\n  const url = new URL(window.location.href, window.location.origin)\n  const searchParams = new URLSearchParams(url.search.slice(1))\n  url.hash = anchor\n  if (switchToRendered) {\n    searchParams.set('short_path', shortPath)\n  } else if (switchToSource) {\n    searchParams.delete('short_path')\n  }\n  url.search = searchParams.toString()\n\n  replaceState(null, '', url.toString())\n}\n\nfunction updateSelectedButton(button: Element) {\n  for (const element of document.querySelectorAll('.js-rendered, .js-source')) {\n    element.classList.remove('selected')\n    element.removeAttribute('aria-current')\n  }\n\n  button.classList.add('selected')\n  button.setAttribute('aria-current', 'true')\n}\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\non('click', '.js-toc-retry', function (event) {\n  if (!(event.target instanceof Element)) return\n  const menu = event.target.closest<HTMLElement>('.select-menu')!\n  const loader = menu.querySelector<HTMLElement>('include-fragment')!\n  const src = loader.getAttribute('src')!\n  loader.setAttribute('src', '')\n  loader.setAttribute('src', src)\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {reload} from '@github-ui/updatable-content'\nimport {remoteForm} from '@github/remote-form'\n\non('click', '.js-code-scanning-apply-autofix-form .js-code-scanning-apply-autofix-submit', function (event) {\n  const submitButton = event.currentTarget\n  const form = submitButton.closest<HTMLFormElement>('.js-code-scanning-apply-autofix-form')!\n\n  const commitTitleInput = form.querySelector<HTMLInputElement>('input[name=commit_title]')!\n  const commitMessageInput = form.querySelector<HTMLTextAreaElement>('textarea[name=commit_message]')!\n  let message = commitTitleInput.value.trim()\n  if (message === '') {\n    message = commitTitleInput.defaultValue\n  }\n  const commitMessage = commitMessageInput.value.trim()\n  if (commitMessage !== '') {\n    message = `${message}\\n\\n${commitMessage}\\n`\n  }\n  commitTitleInput.disabled = true\n  commitMessageInput.disabled = true\n\n  const messageInput = document.createElement('input')\n  messageInput.setAttribute('type', 'hidden')\n  messageInput.setAttribute('name', 'message')\n  messageInput.value = message\n  form.appendChild(messageInput)\n})\n\nremoteForm('.js-code-scanning-apply-autofix-form', async function (form, wants) {\n  const dropdown = form.closest<HTMLElement>('details')!\n  const containerParent = form.closest<HTMLElement>('.js-code-scanning-apply-autofix-container')!\n  const errorMessageContainer = containerParent.querySelector<HTMLElement>('.js-error-message-placeholder')!\n\n  try {\n    await wants.json()\n\n    dropdown.remove()\n    reload()\n  } catch (error) {\n    // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n    if (error.name !== 'QueryError') {\n      // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n      const errorMessage = error.response.json && error.response.json.error\n      const errorMessageElement = errorMessageContainer.querySelector<HTMLElement>('.js-error-message')!\n\n      errorMessageContainer.hidden = false\n      errorMessageElement.textContent = errorMessage\n\n      dropdown.remove()\n    }\n  }\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {softNavigate} from '@github-ui/soft-navigate'\n\n// Adds .is-range-selected class to selected item range.\nfunction highlightSelectedRange(container: Element, startItem: Element, endItem: Element) {\n  const items = Array.from(container.querySelectorAll('[role=\"menuitem\"]'))\n  let startIndex = items.indexOf(startItem)\n  let endIndex = items.indexOf(endItem)\n\n  if (startIndex === -1) {\n    throw new Error(\"Couldn't find startIndex in container\")\n  } else if (endIndex === -1) {\n    throw new Error(\"Couldn't find endItem in container\")\n  }\n\n  // Give last selected item a bolder highlight regardless\n  // of selection direction.\n  resetHighlight(container)\n  items[endIndex]!.classList.add('is-last-in-range')\n\n  // Flip start and end if reversed\n  if (startIndex > endIndex) {\n    ;[startIndex, endIndex] = [endIndex, startIndex]\n  }\n\n  // Replace current is-range-selected with new range\n  for (const item of items.slice(startIndex, endIndex + 1)) {\n    item.classList.add('is-range-selected')\n  }\n}\n\n// Start process to monitor shift navigation ranges. Process starts when\n// menu is activated and should terminate when menu is deactivated.\nasync function observeShiftRangeHighlights(container: Element, startItem: Element) {\n  function highlightRange(event: Event) {\n    highlightSelectedRange(container, startItem, (event.target as Element).closest<HTMLElement>('[role=\"menuitem\"]')!)\n  }\n\n  // Mark current focus as start of the range and highlight up to latest\n  // focused item as it changes.\n  highlightSelectedRange(container, startItem, startItem)\n  container.addEventListener('mouseover', highlightRange)\n\n  // When shift key is released, disable range highlighting.\n  await new Promise(resolve => window.addEventListener('keyup', resolve, {once: true}))\n  container.removeEventListener('mouseover', highlightRange)\n  resetHighlight(container)\n}\n\nfunction resetHighlight(menu: Element) {\n  for (const item of menu.querySelectorAll('[role=\"menuitem\"]')) {\n    item.classList.remove('is-range-selected', 'is-last-in-range')\n  }\n}\n\nobserve('.js-diffbar-range-menu .js-diffbar-range-list', {subscribe: manageRangeHighlight})\n\nfunction manageRangeHighlight(container: Element) {\n  const menu = container.closest<HTMLElement>('details-menu')!\n  let shifted = false\n\n  function clicked(event: Event) {\n    shifted = (event as KeyboardEvent).shiftKey\n    // Cancel browser's shift-click behavior.\n    if (shifted) {\n      event.preventDefault()\n    }\n  }\n\n  function selected(event: Event) {\n    if (!shifted) return\n\n    // Cancel details-menu close.\n    event.preventDefault()\n\n    const currentItem = (event as CustomEvent).detail.relatedTarget as Element\n    if (currentItem.classList.contains('is-range-selected')) {\n      event.stopPropagation()\n      const items = container.querySelectorAll('.is-range-selected')\n      const firstItem = items[0]!\n      const lastItem = items[items.length - 1]!\n\n      const urlTemplate = container.getAttribute('data-range-url')!\n      const sha1 = firstItem.getAttribute('data-parent-commit')\n      const sha2 = lastItem.getAttribute('data-commit')!\n\n      const range = sha1 && sha2 ? `${sha1}..${sha2}` : sha2\n      const url = urlTemplate.replace('$range', range)\n\n      softNavigate(url)\n    } else {\n      event.stopImmediatePropagation()\n      observeShiftRangeHighlights(container, currentItem)\n    }\n  }\n\n  container.addEventListener('click', clicked, {capture: true})\n  menu.addEventListener('details-menu-select', selected)\n\n  return {\n    unsubscribe: () => {\n      container.removeEventListener('click', clicked, {capture: true})\n      menu.removeEventListener('details-menu-select', selected)\n    },\n  }\n}\n\non(\n  'toggle',\n  '.js-diffbar-range-menu',\n  function (event) {\n    const details = event.currentTarget\n    if (!details.hasAttribute('open')) return\n    const item = details.querySelector<HTMLElement>('.in-range')\n    if (item) item.focus()\n  },\n  {capture: true},\n)\n","import hashChange from '../behaviors/hash-change'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nimport visible from '@github-ui/visible'\n\non('click', '.js-compare-tab', function (event) {\n  for (const tab of document.querySelectorAll('.js-compare-tab.selected')) {\n    tab.classList.remove('selected')\n  }\n  event.currentTarget.classList.add('selected')\n\n  for (const content of document.querySelectorAll('#commits_bucket, #files_bucket, #commit_comments_bucket')) {\n    /* eslint-disable-next-line github/no-d-none */\n    content.classList.add('d-none')\n  }\n\n  const selectedTab = event.currentTarget as HTMLAnchorElement\n  const id = selectedTab.hash\n\n  /* eslint-disable-next-line github/no-d-none */\n  document.querySelector<HTMLElement>(id)!.classList.remove('d-none')\n  event.preventDefault()\n})\n\n// When an anchor references an element under the \"Files Changed\" tab\n// but is not visible, switch to the tab.\n//\n//   /compare/foo-branch#diff-0\n//   /compare/foo-branch#L1R1\nhashChange(function ({target}) {\n  if (!(target instanceof HTMLElement)) return\n\n  const bucket = target.closest('#commits_bucket, #files_bucket, #commit_comments_bucket')\n\n  if (bucket && bucket instanceof HTMLElement && !visible(bucket)) {\n    document.querySelector<HTMLElement>(`.js-compare-tab[href=\"#${bucket.id}\"]`)!.click()\n  }\n})\n\n// Show cross repo chooser for \"compare across forks\" link.\non('click', '.js-toggle-range-editor-cross-repo', function () {\n  document.querySelector<HTMLElement>('.js-range-editor')!.classList.toggle('is-cross-repo')\n})\n\nobserve('.js-compare-pr.open', {\n  add() {\n    document.body.classList.add('is-pr-composer-expanded')\n  },\n  remove() {\n    document.body.classList.remove('is-pr-composer-expanded')\n  },\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {remoteForm} from '@github/remote-form'\n\non('change', '.js-collab-checkbox', function ({currentTarget}) {\n  const form = (currentTarget as HTMLInputElement).form!\n\n  // Clear option group error states.\n  for (const el of form.querySelectorAll('.errored')) {\n    el.classList.remove('errored')\n  }\n\n  // Show loading indicator.\n  const option = currentTarget.closest<HTMLElement>('.js-collab-option')!\n  const indicator = option.querySelector<HTMLElement>('.js-status-indicator')!\n  indicator.classList.remove('status-indicator-success', 'status-indicator-failed')\n  indicator.classList.add('status-indicator-loading')\n})\n\nremoteForm('.js-collab-form', async function (form, wants) {\n  try {\n    await wants.text()\n  } catch (responseError) {\n    for (const el of form.querySelectorAll('.status-indicator-loading')) {\n      el.classList.remove('status-indicator-loading')\n      el.classList.add('status-indicator-failed')\n\n      // Show error message.\n      const option = el.closest<HTMLElement>('.js-collab-option')!\n      option.classList.add('errored')\n\n      const checkbox = option.querySelector<HTMLInputElement>('.js-collab-checkbox')!\n      checkbox.checked = !checkbox.checked\n    }\n\n    // Clear all success indicators.\n    for (const el of form.querySelectorAll('.status-indicator-success')) {\n      el.classList.remove('status-indicator-success')\n    }\n\n    return\n  }\n\n  // Clear option group error states.\n  for (const el of form.querySelectorAll('.errored')) {\n    el.classList.remove('errored')\n  }\n\n  // Show success indicator.\n  for (const el of form.querySelectorAll('.status-indicator-loading')) {\n    el.classList.remove('status-indicator-loading')\n    el.classList.add('status-indicator-success')\n  }\n})\n","import {attr, controller, target} from '@github/catalyst'\nimport type {FileTreeElement} from '../../../../components/pull_requests/file_tree/file-tree-element'\nimport {debounce} from '@github/mini-throttle/decorators'\n\n@controller\nexport class DiffLayoutElement extends HTMLElement {\n  static attrPrefix = ''\n  @attr sidebarHidden = false\n\n  @target layoutContainer: HTMLElement\n  @target diffToolbar: HTMLElement\n  @target tocMenu: HTMLElement\n  @target tocMenuButton: HTMLElement\n  @target mainContainer: HTMLElement\n  @target sidebarContainer: HTMLElement | undefined\n  @target fileTree: FileTreeElement | undefined\n  @target showFileTreeButton: HTMLButtonElement | undefined\n  @target fileTreePathFilter: HTMLInputElement | undefined\n  #scrollTimer: number | null = null\n  #resizeTimer: number | null = null\n  #eventAbortController: AbortController | null\n  #notificationShelfObserver: MutationObserver\n\n  connectedCallback() {\n    if (!this.sidebarContainer) return\n\n    this.#notificationShelfObserver = new MutationObserver(this.handleNotificationShelfMutation)\n    this.#notificationShelfObserver.observe(document.body, {subtree: true, childList: true})\n\n    const {signal} = (this.#eventAbortController = new AbortController())\n\n    // We're unable to use IntersectionObserver because the sidebar element never\n    // intersects with another element or the document viewport, even on scroll.\n    /* eslint-disable-next-line github/prefer-observers */\n    window.addEventListener('scroll', this.handleSidebarScroll, {signal})\n\n    // We're unable to use ResizeObserver because the document is vertically scrollable\n    // and its height never actually changes, so the ResizeObserver callback never fires\n    // on window height changes.\n    /* eslint-disable-next-line github/prefer-observers */\n    window.addEventListener('resize', () => this.handleSidebarResize(), {signal})\n    this.handleSidebarScroll()\n  }\n\n  disconnectedCallback() {\n    if (!this.sidebarContainer) return\n    this.#notificationShelfObserver.disconnect()\n    this.#eventAbortController?.abort()\n    if (this.#scrollTimer != null) cancelAnimationFrame(this.#scrollTimer)\n    if (this.#resizeTimer != null) cancelAnimationFrame(this.#resizeTimer)\n  }\n\n  toggleSidebar(event: CustomEvent): void {\n    this.layoutContainer.classList.toggle('hx_Layout--sidebar-hidden')\n    this.sidebarHidden = !this.sidebarHidden\n    if (!this.fileTree) return\n\n    const toggleButton = event.detail.toggleButton\n    if (!toggleButton) return\n\n    this.fileTree.instrumentToggleFileTree(toggleButton)\n\n    if (!this.fileTreePathFilter) return\n    if (toggleButton.id === 'show-file-tree-button') this.fileTreePathFilter.focus()\n  }\n\n  // The handler function below is a workaround that allows the \"t\" keyboard shortcut to control\n  // multiple elements on the `pr#files` page: the file tree toggle button (when visible) and the\n  // 'Jump to' menu button (when visible). Normally, we would add the hotkey listener to each of\n  // these buttons directly, but we can't in this case, because the `@github-ui/hotkey` library only\n  // supports mapping a keyboard shortcut to a single element on the page, regardless of whether\n  // that element is currently visible.\n  handleOpenFilesListHotkeyEvent(): void {\n    if (this.shouldOpenTocMenu()) {\n      this.tocMenuButton.click()\n      return\n    }\n\n    if (!this.fileTree) return\n\n    if (this.showFileTreeButton && this.sidebarHidden) {\n      this.showFileTreeButton.click()\n    } else if (this.fileTreePathFilter && !this.sidebarHidden) {\n      this.fileTreePathFilter.focus()\n    }\n  }\n\n  shouldOpenTocMenu(): boolean {\n    return !!(\n      this.tocMenu &&\n      !this.tocMenu.hasAttribute('open') &&\n      window.getComputedStyle(this.tocMenu).display !== 'none'\n    )\n  }\n\n  handleNotificationShelfMutation(mutations: MutationRecord[]): void {\n    const root = <HTMLHtmlElement>document.firstElementChild!\n    if (!root.classList.contains('js-skip-scroll-target-into-view')) return\n\n    for (const mutation of mutations) {\n      for (const addedNode of mutation.addedNodes) {\n        if (!(addedNode instanceof HTMLElement)) continue\n        if (addedNode.classList.contains('js-notification-top-shelf')) {\n          root.classList.add('has-notification-top-shelf')\n          break\n        }\n      }\n      for (const removedNode of mutation.removedNodes) {\n        if (!(removedNode instanceof HTMLElement)) continue\n        if (removedNode.classList.contains('js-notification-top-shelf')) {\n          root.classList.remove('has-notification-top-shelf')\n          break\n        }\n      }\n    }\n  }\n\n  @debounce(100)\n  handleSidebarResize(): void {\n    this.#resizeTimer = requestAnimationFrame(this.updateSidebarHeight)\n  }\n\n  handleSidebarScroll = () => {\n    this.#scrollTimer = requestAnimationFrame(this.updateSidebarHeight)\n  }\n\n  updateSidebarHeight = () => {\n    if (!this.sidebarContainer) return\n    const viewportHeight = document.documentElement.clientHeight\n    const diffToolbarRect = this.diffToolbar.getBoundingClientRect()\n    const mainRect = this.mainContainer.getBoundingClientRect()\n\n    const scrolledToEnd: boolean = viewportHeight >= mainRect.bottom\n    const toolbarStuck: boolean = diffToolbarRect.top === 0\n\n    let sidebarHeight: number\n\n    if (scrolledToEnd) {\n      sidebarHeight = mainRect.bottom - parseInt(this.sidebarContainer.style.top)\n      sidebarHeight = Math.min(mainRect.height, sidebarHeight)\n    } else if (toolbarStuck) {\n      sidebarHeight = viewportHeight - diffToolbarRect.height\n    } else {\n      // scroll at top\n      sidebarHeight = viewportHeight - this.sidebarContainer.getBoundingClientRect().top\n    }\n\n    this.sidebarContainer.style.height = `${sidebarHeight}px`\n  }\n}\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\non('click', '.js-split-diff-view', function () {\n  const unifiedDiffViewBox = document.querySelector<HTMLElement>('.js-unified-diff-view-box')!\n  const splitDiffViewBox = document.querySelector<HTMLElement>('.js-split-diff-view-box')!\n\n  const splitDiffViewOption = document.querySelector<HTMLInputElement>('.js-split-diff-view-option')!\n  const unifiedDiffViewOption = document.querySelector<HTMLInputElement>('.js-unified-diff-view-option')!\n\n  splitDiffViewBox.classList.add('color-border-accent-emphasis')\n  splitDiffViewBox.classList.remove('color-border-default')\n\n  unifiedDiffViewBox.classList.remove('color-border-accent-emphasis')\n  unifiedDiffViewBox.classList.add('color-border-default')\n\n  unifiedDiffViewOption.checked = false\n  splitDiffViewOption.checked = true\n})\n\non('click', '.js-unified-diff-view', function () {\n  const unifiedDiffViewBox = document.querySelector<HTMLElement>('.js-unified-diff-view-box')!\n  const splitDiffViewBox = document.querySelector<HTMLElement>('.js-split-diff-view-box')!\n\n  const splitDiffViewOption = document.querySelector<HTMLInputElement>('.js-split-diff-view-option')!\n  const unifiedDiffViewOption = document.querySelector<HTMLInputElement>('.js-unified-diff-view-option')!\n\n  splitDiffViewBox.classList.remove('color-border-accent-emphasis')\n  splitDiffViewBox.classList.add('color-border-default')\n\n  unifiedDiffViewBox.classList.add('color-border-accent-emphasis')\n  unifiedDiffViewBox.classList.remove('color-border-default')\n\n  unifiedDiffViewOption.checked = true\n  splitDiffViewOption.checked = false\n})\n","import {controller} from '@github/catalyst'\nimport {eventToHotkeyString} from '@github-ui/hotkey'\nimport {sendHydroEvent} from '../../github/hydro-tracking'\n\n// Track CTRL+F usage on Files changed tab\n// to determine the cost of virtualizing the list of patches\n@controller\nclass InstrumentFilesElement extends HTMLElement {\n  connectedCallback() {\n    document.addEventListener('keydown', this.instrumentCtrlF)\n  }\n\n  disconnectedCallback() {\n    document.removeEventListener('keydown', this.instrumentCtrlF)\n  }\n\n  instrumentCtrlF = (event: KeyboardEvent) => {\n    const findCommands = ['Control+f', 'Meta+f']\n    const hotkeyString = eventToHotkeyString(event)\n    if (findCommands.includes(hotkeyString)) {\n      sendHydroEvent(this)\n    }\n  }\n}\n","// Pull Request: The Merge Button\n// Toggle merge form after clicking \"Merge pull request\".\n//\n// Because the entire merge button and form are live update enabled, new updates\n// could be pushed at anytime. So when the merge confirmation form is visible,\n// mark it as \"dirty\" so it isn't swapped out via a live update when the user\n// could be typing.\n\n// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport {IncludeFragmentElement} from '@github/include-fragment-element'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\nimport {persistSubmitButtonValue} from '@github-ui/form-utils/remote-submit'\nimport {toggleDetailsTarget} from '../behaviors/details'\nimport visible from '@github-ui/visible'\n\non('details:toggled', '.js-pull-merging', function ({currentTarget}) {\n  const forms = Array.from(currentTarget.querySelectorAll<HTMLElement>('.js-merge-pull-request'))\n  const isDirty = forms.some(visible)\n  for (const form of forms) {\n    form.classList.toggle('is-dirty', isDirty)\n  }\n})\n\non('click', '.js-merge-box-try-again', async function ({currentTarget}) {\n  const formTarget = currentTarget.getAttribute('data-form-target')!\n  const targets = ['js-cleanup-branch-form', 'js-merge-branch-form', 'js-queue-branch-form', 'js-update-branch-form']\n  if (!targets.includes(formTarget)) {\n    return\n  }\n  const form = currentTarget.closest<HTMLElement>('.js-pull-merging')!.getElementsByClassName(formTarget)[0]!\n\n  fire(form, 'submit')\n})\n\n// Automatically expand the merge form when restoring a merge message draft\ndocument.addEventListener('session:resume', function (event: Event) {\n  const restoredField = document.getElementById((event as CustomEvent).detail.targetId)\n  if (restoredField) {\n    const mergeContainer = restoredField.closest('.js-merge-pull-request')\n    if (mergeContainer) {\n      const mergeDetails = mergeContainer.closest('.js-details-container')\n      if (mergeDetails) mergeDetails.classList.add('open')\n    }\n  }\n})\n\n// toggle the merge message box if the user checks admin override\non('change', '.js-admin-merge-override', function ({currentTarget}) {\n  const mergeMessageContainer = currentTarget.closest<HTMLElement>('.js-merge-message-container')!\n  const newStateValue = (currentTarget as HTMLInputElement).checked\n  const mergeBox = mergeMessageContainer.querySelector<HTMLElement>('.js-merge-box')\n  const autoMergeBox = mergeMessageContainer.querySelector<HTMLElement>('.js-auto-merge-box')\n  const mergeForm = mergeMessageContainer.querySelector<HTMLElement>('.js-merge-form')\n  const autoMergeForm = mergeMessageContainer.querySelector<HTMLElement>('.js-auto-merge-form')\n  const mergeQueueForm = mergeMessageContainer.querySelector<HTMLElement>('.js-queue-branch-form')\n  // the standard merge buttons (merge, squash, rebase)\n  // we do not want to disable the auto merge or merge queue buttons\n  // since those are always available even if requirements haven't been met\n  const mergeButtons = mergeMessageContainer.querySelectorAll<HTMLButtonElement>('.merge-box-button')\n\n  if (mergeBox) {\n    mergeBox.hidden = !newStateValue\n  }\n\n  if (autoMergeBox) {\n    autoMergeBox.hidden = newStateValue\n  }\n\n  if (mergeForm) {\n    mergeForm.hidden = !newStateValue\n  }\n  if (autoMergeForm) {\n    autoMergeForm.hidden = newStateValue\n  }\n  if (mergeQueueForm) {\n    mergeQueueForm.hidden = newStateValue\n  }\n\n  for (const button of mergeButtons) {\n    button.disabled = !newStateValue\n  }\n})\n\non('details-menu-selected', '.js-update-branch-method-menu', updateBranchUpdateMethod, {capture: true})\n\nfunction updateBranchUpdateMethod(event: Event) {\n  const item = (event as CustomEvent).detail.relatedTarget as HTMLInputElement\n  const container = item.closest<HTMLElement>('.js-merge-pr')!\n\n  container.classList.toggle('is-updating-via-merge', item.value === 'merge')\n  container.classList.toggle('is-updating-via-rebase', item.value === 'rebase')\n\n  const updateBranchType = container.querySelector<HTMLInputElement>('.js-update-branch-type')\n  if (updateBranchType) {\n    updateBranchType.value = item.value\n  }\n}\n\non('submit', '.js-update-branch-form', function ({currentTarget}) {\n  const container = currentTarget.closest<HTMLElement>('.js-merge-pr')\n\n  const updateMergeButton = container?.querySelector<HTMLButtonElement>('.btn-group-update-merge')\n  if (updateMergeButton) {\n    updateMergeButton.disabled = true\n  }\n  const updateRebaseButton = container?.querySelector<HTMLButtonElement>('.btn-group-update-rebase')\n  if (updateRebaseButton) {\n    updateRebaseButton.disabled = true\n  }\n  const updateMethod = container?.querySelector<HTMLElement>('.js-update-method-menu-button')\n  if (updateMethod) {\n    updateMethod.classList.add('disabled', 'user-select-none')\n    updateMethod.setAttribute('aria-disabled', 'true')\n  }\n  const updateMethodDropdown = container?.querySelector<HTMLElement>('.js-update-branch-method-menu')\n  if (updateMethodDropdown) {\n    updateMethodDropdown?.parentNode?.removeChild(updateMethodDropdown)\n  }\n})\n\non('details-menu-selected', '.js-merge-method-menu', updateForMergeMethod, {capture: true})\n\nfunction updateForMergeMethod(event: Event) {\n  const item = (event as CustomEvent).detail.relatedTarget as HTMLInputElement\n  const container = item.closest<HTMLElement>('.js-merge-pr')!\n  const mergeForm = container.querySelector<HTMLFormElement>('.js-merge-pull-request')!\n\n  const mergeMenuButton = container.querySelector<HTMLElement>('.js-merge-method-menu-button')!\n  const buttonClass = mergeMenuButton.getAttribute('data-merge-button-class')\n  mergeMenuButton.classList.toggle('btn-danger', item.hasAttribute('data-dangerous-action'))\n  if (buttonClass) mergeMenuButton.classList.toggle(buttonClass, !item.hasAttribute('data-dangerous-action'))\n\n  const titleInputLists = container.querySelectorAll<HTMLInputElement>('.js-merge-title')\n  const msgTextAreaLists = container.querySelectorAll<HTMLTextAreaElement>('.js-merge-message')\n\n  // Fix for https://github.com/github/pull-requests/issues/9718\n  // Currently we have two separate drop down menu for merge/auto merge options\n  const allButtons: NodeListOf<HTMLButtonElement> = document.querySelectorAll('.js-merge-method-menu button')\n  for (const button of allButtons) {\n    button.setAttribute('aria-checked', button.value === item.value ? 'true' : 'false')\n  }\n\n  for (const titleInput of titleInputLists) {\n    if (titleInput.defaultValue === titleInput.value) {\n      titleInput.defaultValue = titleInput.value = item.getAttribute('data-input-title-value')!\n    }\n  }\n  for (const msgTextArea of msgTextAreaLists) {\n    if (msgTextArea.defaultValue === msgTextArea.value) {\n      msgTextArea.defaultValue = msgTextArea.value = item.getAttribute('data-input-message-value')!\n    }\n  }\n\n  container.classList.toggle('is-merging', item.value === 'merge')\n  container.classList.toggle('is-squashing', item.value === 'squash')\n  container.classList.toggle('is-rebasing', item.value === 'rebase')\n  container.classList.toggle('is-merging-group', item.value === 'group')\n  container.classList.toggle('is-merging-solo', item.value === 'solo')\n  container.classList.toggle('is-merging-jump', item.value === 'jump')\n\n  const overrideActive =\n    (mergeForm.classList.contains('js-admin-override-merge') && item.value === 'merge') ||\n    (mergeForm.classList.contains('js-admin-override-squash') && item.value === 'squash') ||\n    (mergeForm.classList.contains('js-admin-override-rebase') && item.value === 'rebase')\n\n  const mergeTypeInput = container.querySelector<HTMLInputElement>('.js-merge-type')\n  if (mergeTypeInput) {\n    mergeTypeInput.value = item.value\n  }\n\n  const buttons = container.querySelectorAll<HTMLButtonElement>(\n    '.js-merge-pull-request .js-merge-commit-button,.js-confirm-auto-merge-button',\n  )\n  for (const button of buttons) {\n    if (item.value === button.value) {\n      button.type = 'submit'\n\n      if (button.classList.contains('js-confirm-auto-merge-button')) {\n        persistSubmitButtonValue(button)\n      }\n    } else {\n      button.type = 'button'\n    }\n  }\n\n  mergeForm.classList.toggle('color-fg-danger', overrideActive)\n\n  const liveUpdateContainer = container.closest<HTMLElement>('.js-pull-merging')!\n  const dataURL = new URL(liveUpdateContainer.getAttribute('data-url')!, window.location.origin)\n  const search = new URLSearchParams(dataURL.search)\n  search.set('merge_type', item.value)\n  dataURL.search = search.toString()\n  liveUpdateContainer.setAttribute('data-url', dataURL.toString())\n}\n\non('details:toggled', '.js-merge-pr', function (event) {\n  const container = event.currentTarget\n  const msgTextArea = container.querySelector('.js-merge-message')\n  if (msgTextArea) {\n    // Trigger size-to-fit for the merge message textarea\n    fire(msgTextArea, 'change')\n  }\n})\n\nobserve('.branch-action-item.js-details-container.open', {\n  add(container) {\n    for (const details of container.querySelectorAll('.js-merge-review-section')) {\n      details.setAttribute('open', '')\n    }\n  },\n  remove(container) {\n    for (const details of container.querySelectorAll('.js-merge-review-section')) {\n      details.removeAttribute('open')\n    }\n  },\n})\n\non(\n  'toggle',\n  '.js-details-container .js-merge-review-section',\n  function ({currentTarget: details}) {\n    const container = details.closest<HTMLElement>('.js-details-container')!\n    const sections = container.querySelectorAll('.js-merge-review-section').length\n    const open = container.querySelectorAll('.js-merge-review-section[open]').length\n    const allSectionsCollapsed = open === 0\n    const allSectionsExpanded = open === sections\n    if (allSectionsCollapsed) {\n      toggleDetailsTarget(container, {force: false})\n    } else if (allSectionsExpanded) {\n      toggleDetailsTarget(container, {force: true})\n    }\n  },\n  {capture: true},\n)\n\nobserve('poll-include-fragment[data-to-be-polled]', {\n  constructor: IncludeFragmentElement,\n  add(container) {\n    function onVisible() {\n      container.src = container.getAttribute('data-to-be-polled')!\n      container.removeAttribute('data-to-be-polled')\n    }\n\n    if (document.hidden) {\n      document.addEventListener('visibilitychange', onVisible, {once: true})\n    } else {\n      onVisible()\n    }\n  },\n})\n\non('submit', '.js-remove-from-queue-form', async (event: Event) => {\n  const form = event.currentTarget as HTMLFormElement\n  event.preventDefault()\n\n  const response = await fetch(form.action, {\n    method: form.method,\n    body: new FormData(form),\n    headers: {Accept: 'application/json'},\n  })\n\n  if (response && response.ok) {\n    // No action required on success state because the merge box live updates\n    return\n  }\n\n  // Handle error state\n  window.onbeforeunload = () => {\n    window.scrollTo({top: 0})\n  }\n  window.location.reload()\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {preservePosition} from 'scroll-anchoring'\n\n// TODO: Refactor to use data-hotkey\n/* eslint eslint-comments/no-use: off */\n/* eslint-disable @github-ui/ui-commands/no-manual-shortcut-logic */\n// We can't rely on `event.altKey` of the click event since in Firefox it\n// doesn't accurately reflect whether Alt was pressed when Space or Enter were\n// used to toggle the details element instead of a mouse.\nlet altPressed = false\ndocument.addEventListener('keydown', function (event: KeyboardEvent) {\n  if ('Alt' === event.key) altPressed = true\n})\ndocument.addEventListener('keyup', function (event: KeyboardEvent) {\n  if ('Alt' === event.key) altPressed = false\n})\n\non('click', '.js-toggle-outdated-comments', function (event) {\n  if (!((event instanceof MouseEvent && event.altKey) || altPressed) || !(event.currentTarget instanceof HTMLElement)) {\n    return\n  }\n\n  const current = event.currentTarget\n  const container = current.closest<HTMLElement>('details')!\n\n  function toggleAll() {\n    const open = container.hasAttribute('open')\n    for (const other of document.querySelectorAll('.js-toggle-outdated-comments')) {\n      if (other !== current) {\n        const otherContainer = other.closest<HTMLElement>('details')!\n        otherContainer.toggleAttribute('open', open)\n      }\n    }\n  }\n\n  setTimeout(() => {\n    preservePosition(current, toggleAll)\n  })\n})\n\n/* eslint-enable @github-ui/ui-commands/no-manual-shortcut-logic */\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n\n// Pull Request: Restore branch event link\n\n// Add \".last\" class to the last \"Restore\" button on the page.\n//\n// See .pull-request-ref-restore in pull_request.scss\nfunction syncLast() {\n  const refRestores = document.querySelectorAll('.pull-request-ref-restore')\n  for (let i = 0; i < refRestores.length; i++) {\n    refRestores[i]!.classList.toggle('last', i === refRestores.length - 1)\n  }\n}\n\nobserve('.pull-request-ref-restore', {\n  add: syncLast,\n  remove: syncLast,\n})\n\n// Some hacks to help Restore Branch visibility.\n//\n// Hoists the \"restorable\" state from the the merging partial onto the timeline\n// container for styling.\n//\n// Also see #js-pull-restorable on pull_requests/_merging.html.erb.\n//\n// PDI: It'd be nice if we could live update this state directly on the container\n// rather than having to sync it around the DOM.\nfunction syncRestorable() {\n  const restorable = document.querySelector('#js-pull-restorable') != null\n  const timeline = document.querySelector('.js-pull-discussion-timeline')\n  if (timeline) {\n    timeline.classList.toggle('is-pull-restorable', restorable)\n  }\n}\n\nobserve('#js-pull-restorable', {\n  add: syncRestorable,\n  remove: syncRestorable,\n})\n","import {remoteForm} from '@github/remote-form'\nimport {TemplateInstance} from '@github/template-parts'\nimport {scrollIntoView} from '../sticky-scroll-into-view'\nimport {showGlobalError} from '../behaviors/ajax-error'\nimport {toggleDetailsTarget} from '../behaviors/details'\n\nfunction updatePendingCommentsCount(menu: Element, pendingReviewCommentsCount: number) {\n  const container = menu.closest<HTMLElement>('.js-review-state-classes')!\n  const buttonText = document.querySelector<HTMLElement>('.js-review-changes')!\n\n  container.classList.toggle('is-review-pending', pendingReviewCommentsCount > 0)\n\n  for (const el of document.querySelectorAll('.js-pending-review-comment-count')) {\n    el.textContent = String(pendingReviewCommentsCount)\n  }\n\n  for (const el of document.querySelectorAll('.js-pending-comment-count-type')) {\n    if (el instanceof HTMLElement) {\n      el.textContent = el.getAttribute(pendingReviewCommentsCount === 1 ? 'data-singular-string' : 'data-plural-string')\n    }\n  }\n\n  if (pendingReviewCommentsCount > 0) {\n    buttonText.textContent = buttonText.getAttribute('data-pending-message') || ''\n\n    const button = menu.querySelector<HTMLElement>('.js-reviews-toggle')\n    button?.classList.add('anim-pulse-in')\n    button?.addEventListener('animationend', () => button.classList.remove('anim-pulse-in'), {once: true})\n  } else {\n    buttonText.textContent = buttonText.getAttribute('data-message') || ''\n  }\n}\n\nfunction updatePendingHandler(pendingReviewCommentsCount: number) {\n  const menu = document.querySelector('.js-reviews-container')\n  if (menu) setTimeout(() => updatePendingCommentsCount(menu, pendingReviewCommentsCount))\n}\n\nremoteForm('.js-inline-comment-form', async function (form, send) {\n  const response = await send.text()\n  updatePendingHandler(response.json.pendingReviewCommentsCount)\n})\n\nremoteForm('.js-pending-review-comment .js-comment-delete', async function (form, send) {\n  const response = await send.text()\n  updatePendingHandler(response.json.pendingReviewCommentsCount)\n})\n\n// TODO Replace with data-replace-remote-form behavior.\nremoteForm('.js-resolvable-timeline-thread-form', async function (form, send) {\n  try {\n    const response = await send.html()\n    const container = form.closest<HTMLElement>('.js-resolvable-timeline-thread-container')!\n    container.replaceWith(response.html)\n  } catch (error) {\n    showGlobalError()\n  }\n})\n\nremoteForm('.js-toggle-user-reviewed-file-form', async function (form, send) {\n  const container = form.closest<HTMLElement>('.js-details-container')!\n  const reviewedFile = !!container.querySelector('.js-reviewed-file')\n  const fileLevelComments = container.querySelector<HTMLElement>('.js-file-level-comments-table')\n  const open = container.classList.contains('open')\n  const header = container.querySelector('.js-file-header')\n  const topFile = header ? header.getBoundingClientRect().top === 60 : false\n\n  if ((!reviewedFile && open) || (reviewedFile && !open)) {\n    toggleDetailsTarget(container)\n    if (fileLevelComments) fileLevelComments.classList.toggle('hidden')\n    if (topFile) {\n      scrollIntoView(container)\n    }\n  }\n  // perceived performance for the state change\n  const button = form.querySelector<HTMLElement>('.js-reviewed-toggle')!\n  if (reviewedFile) {\n    button.classList.remove('color-bg-accent', 'color-border-accent')\n    button.classList.add('color-fg-muted', 'color-border-default')\n  } else {\n    button.classList.remove('color-fg-muted', 'color-border-default')\n    button.classList.add('color-bg-accent', 'color-border-accent')\n  }\n\n  // make sure progress bar doesn't get out of sync\n  const checkbox = button.querySelector<HTMLInputElement>('.js-reviewed-checkbox')!\n  checkbox.disabled = true\n\n  const bar = document.querySelector('progress-bar')\n  if (bar instanceof ProgressBarElement) {\n    if (reviewedFile) {\n      bar.decrement()\n    } else {\n      bar.increment()\n    }\n  }\n\n  // keep file tree in sync\n  const fileTreeItem = document.getElementById(`file-tree-item-${container.id}`)\n  if (fileTreeItem) {\n    fileTreeItem.toggleAttribute('data-file-user-viewed')\n  }\n\n  try {\n    const response = await send.html()\n    const target = form.closest('.js-replace-file-header-review')\n    if (target) {\n      target.replaceWith(response.html)\n      container.toggleAttribute('data-file-user-viewed')\n    }\n  } catch (fetchError) {\n    // eslint-disable-next-line i18n-text/no-en\n    const message = 'There was an error marking the file as viewed.'\n    const template = document.querySelector<HTMLTemplateElement>('template.js-flash-template')!\n    template.after(new TemplateInstance(template, {className: 'flash-error', message}))\n    checkbox.checked = false\n    checkbox.disabled = false\n  }\n})\n\nfunction parseRatio(bar: ProgressBarElement): string[] {\n  return bar.getAttribute('ratio')!.split('/')\n}\n\nfunction refresh(bar: ProgressBarElement) {\n  if (bar) {\n    const [parts, whole] = parseRatio(bar)\n    const percent = parseInt(parts!) / parseInt(whole!)\n    const div = bar.querySelector('.js-review-progress')\n    const span = bar.querySelector('.js-review-count')\n\n    if (div instanceof HTMLElement && span) {\n      div.style.width = `${percent * 100}%`\n      span.textContent = `${parts} / ${whole}`\n    }\n  }\n}\n\nclass ProgressBarElement extends HTMLElement {\n  static get observedAttributes() {\n    return ['ratio']\n  }\n\n  attributeChangedCallback(attrName: string) {\n    if (attrName === 'ratio') refresh(this)\n  }\n\n  connectedCallback() {\n    refresh(this)\n  }\n\n  increment() {\n    const [parts, whole] = parseRatio(this)\n    const newParts = Math.min(parseInt(parts!) + 1, parseInt(whole!))\n    this.setAttribute('ratio', `${newParts}/${whole}`)\n  }\n\n  decrement() {\n    const [parts, whole] = parseRatio(this)\n    let newParts = Math.min(parseInt(parts!) - 1, parseInt(whole!))\n    newParts = Math.max(newParts, 0)\n    this.setAttribute('ratio', `${newParts}/${whole}`)\n  }\n}\n\nif (!window.customElements.get('progress-bar')) {\n  window.ProgressBarElement = ProgressBarElement\n  window.customElements.define('progress-bar', ProgressBarElement)\n}\n\ndeclare global {\n  interface Window {\n    ProgressBarElement: typeof ProgressBarElement\n  }\n}\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\nimport {updateContent, reload} from '@github-ui/updatable-content'\nimport {SOFT_NAV_STATE} from '@github-ui/soft-nav/states'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {fetchPoll} from '@github-ui/fetch-utils'\nimport verifySsoSession from '../sso'\nimport {toggleDetailsTarget} from '../behaviors/details'\nimport {TemplateInstance} from '@github/template-parts'\nimport {remoteForm} from '@github/remote-form'\nimport {sendEvent} from '@github-ui/hydro-analytics'\nimport {ssrSafeDocument} from '@github-ui/ssr-utils'\nimport {isFeatureEnabled} from '@github-ui/feature-flags'\n\nfunction updateContentOnSoftNavigations() {\n  const elementsToUpdate = document.querySelectorAll<HTMLElement>('.js-pull-refresh-on-pjax')\n  for (const el of elementsToUpdate) {\n    updateContent(el)\n  }\n}\n\nfunction updateContentOnTurboRestore() {\n  const elementsToRefresh = document.querySelectorAll<HTMLElement>('[data-refresh-on-turbo-restored=\"true\"]')\n  for (const el of elementsToRefresh) {\n    updateContent(el)\n  }\n}\n\ndocument.addEventListener(SOFT_NAV_STATE.SUCCESS, updateContentOnSoftNavigations)\ndocument.addEventListener('turbo:restored', updateContentOnTurboRestore)\n\nfunction showFlash(message: string, detailsElement: HTMLElement): void {\n  const template = document.querySelector<HTMLTemplateElement>('template.js-flash-template')!\n  template.after(new TemplateInstance(template, {className: 'flash-error', message}))\n\n  detailsElement.removeAttribute('open')\n}\n\non('click', '.js-change-base-form-button', async function (event) {\n  event.preventDefault()\n\n  // disable button and show loading spinner\n  const button = event.currentTarget as HTMLButtonElement\n  const spinner = button.querySelector('.js-change-base-spinner') as HTMLSpanElement\n  button.disabled = true\n  spinner.style.display = 'inline'\n\n  await verifySsoSession()\n\n  const details = (event.target as HTMLElement).closest<HTMLElement>('details')!\n  try {\n    const form = button.form as HTMLFormElement\n    const response = await fetch(form.action, {\n      method: form.method,\n      body: new FormData(form),\n      headers: {\n        'X-Requested-With': 'XMLHttpRequest',\n        Accept: 'application/json',\n      },\n    })\n    const responseData = await response.json()\n\n    toggleDetailsTarget(document.querySelector('.js-pull-header-details')!, {force: false})\n    if (!response.ok) {\n      showFlash(responseData.error_message, details)\n      return\n    }\n\n    let url = null\n    if (responseData.job) {\n      url = responseData.job.url\n    } else {\n      url = responseData.orchestration.url\n    }\n    const pollingData = await (await fetchPoll(url, {headers: {accept: 'application/json'}})).json()\n    if (pollingData.orchestration) {\n      if (pollingData.orchestration.error_message) {\n        showFlash(pollingData.orchestration.error_message, details)\n      } else {\n        return reload()\n      }\n    } else if (pollingData.job.error_message) {\n      showFlash(pollingData.job.error_message, details)\n    } else {\n      return reload()\n    }\n  } catch (err) {\n    // eslint-disable-next-line i18n-text/no-en\n    showFlash('An unknown error occured.', details)\n  }\n})\n\nfunction showUpdateBranchError(message: string, form: HTMLElement, currentSha: string): void {\n  const target = form.closest('.js-pull-merging')\n  if (!target) return\n\n  target.classList.add('is-error')\n\n  const errorTextContainer = target.getElementsByClassName('merge-branch-description')[0] as HTMLElement\n  errorTextContainer.textContent = message\n\n  const expectedHeadOid = target.querySelector<HTMLInputElement>(\"input[name='expected_head_oid']\")\n  if (!expectedHeadOid) return\n  expectedHeadOid.value = currentSha\n}\n\nremoteForm('.js-update-branch-async-button', async function (form, wants) {\n  await verifySsoSession()\n  try {\n    const response = await wants.json()\n\n    const pollingData = await (\n      await fetchPoll(response.json.orchestration.url, {headers: {accept: 'application/json'}})\n    ).json()\n    if (pollingData.orchestration.error_message) {\n      showUpdateBranchError(pollingData.orchestration.error_message, form, pollingData.orchestration.current_head_sha)\n    } else {\n      // TODO(dzader): this isn't a great experience should probably make it better\n      if (form.getElementsByClassName('js-update-branch-type')[0]?.getAttribute('value') === 'rebase') {\n        return reload()\n      }\n    }\n  } catch (error) {\n    // eslint-disable-next-line i18n-text/no-en\n    showUpdateBranchError('An unknown error occured.', form, '')\n  }\n})\n\nobserve('.js-updating-pull-request-commits-count', {\n  add(el) {\n    const countText = el.textContent\n    const updateableCounts = document.querySelectorAll('.js-updateable-pull-request-commits-count')\n    for (const count of updateableCounts) {\n      count.textContent = countText\n    }\n  },\n})\n\nfunction isReactMergeBox() {\n  return !!ssrSafeDocument?.querySelector('react-partial[partial-name=\"mergebox-partial\"]')\n}\n\nif (isFeatureEnabled('BENCHMARK_MERGEBOX')) {\n  let startTime = 0\n  let markMergeBoxLoadTime = false\n  let abortController: AbortController\n  let softNav = false\n\n  // Attach handlers and prepare to mark MergeBox load whenever the show page is loaded.\n  // This covers the scenario where a user soft navs away from then back to the overview page\n  observe('.js-pull-discussion-timeline', {\n    add() {\n      markMergeBoxLoadTime = true\n      abortController?.abort()\n      abortController = new AbortController()\n\n      const stop = () => abortController.abort()\n\n      // If the user changes tab, we don't want to send the recorded metrics since it may send garbage data.\n      document.addEventListener('visibilitychange', stop, {signal: abortController.signal})\n\n      // If the stop event is triggered, we want to stop listening to DOM mutations.\n      abortController.signal.addEventListener('abort', () => {\n        markMergeBoxLoadTime = false\n      })\n    },\n  })\n\n  observe('#partial-pull-merging', {\n    add() {\n      if (!markMergeBoxLoadTime) return\n\n      const partialLoadTime = performance.now() - startTime\n      sendEvent('mergebox-loaded', {value: partialLoadTime, react: isReactMergeBox(), softNav})\n      abortController.abort()\n    },\n  })\n\n  document.addEventListener(SOFT_NAV_STATE.START, () => {\n    // keep up to date with the last soft nav start time\n    startTime = performance.now()\n    softNav = true\n  })\n}\n","// Diff Expander\n//\n// Expand Diff hunk context lines.\n//\n// Types of expanders\n//\n// * Top hunk expander: On the first hunk line. Always expands upwards.\n// * Middle hunk expander: In between hunks. Still expands upwards but has\n//     previous and next lines.\n// * Bottom expander: No hunk line. Expands downwards.\n//\n\n// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport type {IncludeFragmentElement} from '@github/include-fragment-element'\nimport {scrollIntoView as _scrollIntoView} from '../sticky-scroll-into-view'\nimport {ensureExpanded} from '../behaviors/details'\nimport {fetchSafeDocumentFragment} from '@github-ui/fetch-utils'\nimport {findElementByFragmentName} from '../fragment-target'\nimport hashChange from '../behaviors/hash-change'\nimport {matchHash} from './helpers'\nimport {parseHTML} from '@github-ui/parse-html'\nimport {preservePosition} from 'scroll-anchoring'\nimport {collapseAllInContainer, expandAllInContainer, supportsRichExpanding} from '../behaviors/render-editor'\n\nfunction loadDiff(entryContainer: Element): Promise<string> {\n  const fragment = entryContainer.querySelector<IncludeFragmentElement>('.js-diff-entry-loader')!\n  const placeholder = entryContainer.querySelector<Element>('.js-diff-placeholder')!\n  const button = entryContainer.querySelector<HTMLButtonElement>('button.js-diff-load')!\n  const buttonText = entryContainer.querySelector<HTMLElement>('.js-button-text')!\n\n  // show loader and disable button\n  placeholder.setAttribute('fill', \"url('#animated-diff-gradient')\")\n  buttonText.textContent = button.getAttribute('data-disable-with') || ''\n  button.disabled = true\n\n  const url = new URL(fragment.getAttribute('data-fragment-url') || '', window.location.origin)\n  fragment.src = url.toString()\n\n  return fragment.data\n}\n\nfunction scrollIntoView(element: Element) {\n  ensureExpanded(element)\n  _scrollIntoView(element)\n}\n\ninterface Expansion {\n  anchor: string\n  side: string\n  line: string\n  lastLine?: string\n  hashFragment: string\n  partialHashFragment: string\n}\n\nhashChange(function handleHashChange() {\n  const expansion = parseExpansion(window.location.hash)\n  if (!expansion) return\n\n  // The line exists and no range was provided, so return early.\n  if (findElementByFragmentName(document, expansion.hashFragment) && !expansion.lastLine) {\n    return\n  }\n\n  findAndActivateExpander(expansion, 0)\n})\n\nfunction parseExpansion(hash?: string): Expansion | undefined {\n  if (!hash) return\n\n  const match = matchHash(hash)\n  if (!match) return\n\n  const anchor = match[1]!\n  const side = match[2]!\n  const line = match[3]!\n  const lastLine = match[5]\n  const hashFragment = anchor + side + line\n  const partialHashFragment = anchor + side\n  return {anchor, side, line, lastLine, hashFragment, partialHashFragment}\n}\n\nasync function findAndActivateExpander(expansion: Expansion, retries: number) {\n  const {anchor, side, line, lastLine, hashFragment, partialHashFragment} = expansion\n\n  const file = findElementByFragmentName(document, anchor)\n  if (!file) return\n\n  const expanders = findExpanders(file, side, line, lastLine)\n  // The range has no expanders, so the range may be fully loaded,\n  // or it may be a progressive diff.\n  if (!expanders.length) {\n    const element = findElementByFragmentName(document, hashFragment)\n    if (element) {\n      scrollIntoView(element)\n      return\n    }\n\n    // No element was found, so let's try to load the diff.\n    const loader = file.querySelector('.js-diff-load-container')\n    if (!loader) return\n    try {\n      await loadDiff(loader)\n      const el = findElementByFragmentName(document, hashFragment)\n      if (el instanceof HTMLElement) {\n        scrollIntoView(el)\n      }\n    } catch (e) {\n      // An error occurred so scroll to the progressive diff.\n      scrollIntoView(file)\n    }\n\n    return\n  }\n\n  await activateExpanders(expanders, partialHashFragment)\n\n  const maxRetries = 1\n  const element = findElementByFragmentName(document, hashFragment)\n  const expanders2 = findExpanders(file, side, line, lastLine)\n  if (expanders2.length) {\n    // If a range was requested and there are more expanders, keep expanding.\n    findAndActivateExpander(expansion, retries)\n  } else if (element) {\n    // Otherwise we've found the element to scroll to and expanded all its elements\n    scrollIntoView(element)\n  } else if (retries < maxRetries) {\n    findAndActivateExpander(expansion, retries + 1)\n  }\n}\n\non('click', '.js-expand', function (event) {\n  event.preventDefault()\n  activateExpander(event.currentTarget as HTMLAnchorElement)\n})\n\nfunction activateExpanders(expanders: HTMLAnchorElement[], hashFragment: string): Promise<unknown> {\n  return Promise.all(expanders.map(expander => activateExpander(expander, hashFragment)))\n}\n\nasync function activateExpander(expander: HTMLAnchorElement, partialHashFragment?: string): Promise<void> {\n  let anchor\n  if (partialHashFragment) {\n    const attrName = partialHashFragment.slice(-1) === 'R' ? 'data-right-range' : 'data-left-range'\n    const range = expander.getAttribute(attrName) || ''\n    const start = parseInt(range.split('-')[0]!, 10)\n    anchor = partialHashFragment + start\n  } else {\n    anchor = expander.hash.slice(1)\n  }\n\n  const baseURL = expander.getAttribute('data-url')!\n  const url = new URL(baseURL, window.location.origin)\n  const params = new URLSearchParams(url.search.slice(1))\n  params.append('anchor', anchor)\n  url.search = params.toString()\n\n  const data = await fetchSafeDocumentFragment(document, url.toString())\n\n  const container = expander.closest<HTMLElement>('.js-file')\n  if (!container) {\n    return\n  }\n\n  const expandableLine = expander.closest<HTMLElement>('.js-expandable-line')!\n  const nextLine = next(expandableLine, '.file-diff-line')\n  if (nextLine) {\n    preservePosition(nextLine, () => {\n      expandableLine.replaceWith(data)\n    })\n  } else {\n    expandableLine.replaceWith(data)\n  }\n\n  fire(container, 'expander:expanded')\n\n  // Remove the expand-all button if there are no remaining\n  // directional expanders\n  removeExpandAllButton(container)\n}\n\nfunction next(el: Element, selector: string): HTMLElement | null {\n  const sibling = el.nextElementSibling\n  return sibling instanceof HTMLElement && sibling.matches(selector) ? sibling : null\n}\n\n// Find js-expand class that matches line number range.\n//\n// js-expand Elements are annotated with left and right ranges of line numbers\n// they can expand to.\n//\n//   <a class=\"js-expand\" data-left-range=\"8-21\" data-right-range=\"9-20\">\n//\n// Where \"8-21\" is an inclusive range.\n//\n//   findExpander(file, 'L', '20')\n//\n// container - .file Element\n// side      - 'L' or 'R' String\n// line      - Line number String\nfunction findExpanders(\n  container: Element,\n  side: string,\n  line: string,\n  lastLine: string | undefined,\n): HTMLAnchorElement[] {\n  const lineNum = parseInt(line, 10)\n  const lastLineNum = parseInt(lastLine || '', 10)\n  return Array.from(container.querySelectorAll<HTMLAnchorElement>('.js-expand')).filter(el => {\n    const attrName = side === 'R' ? 'data-right-range' : 'data-left-range'\n    const range = (el.getAttribute(attrName) || '').split('-')\n    const start = parseInt(range[0]!, 10)\n    const end = parseInt(range[1]!, 10)\n    if (start <= lineNum && lineNum <= end) {\n      return true\n    } else if (lineNum <= start && end <= lastLineNum) {\n      return true\n    } else if (start <= lastLineNum && lastLineNum <= end) {\n      return true\n    }\n    return false\n  })\n}\n\ninterface ExpanderRange {\n  left: {\n    start: string\n    end: string\n    size: string\n  }\n  right: {\n    start: string\n    end: string\n    size: string\n  }\n  position: string\n}\n\ninterface DocumentFragments {\n  content: DocumentFragment\n  position: string\n}\n\ninterface DocumentFragmentResponse {\n  content: string\n  position: string\n}\n\nfunction removeExpandAllButton(container: Element) {\n  const expandFullWrapper = container.querySelector<HTMLButtonElement>('.js-expand-full-wrapper')\n  if (!expandFullWrapper) return\n\n  const expanders = Array.from(container.querySelectorAll<HTMLAnchorElement>('.js-expand'))\n  if (expanders.length === 0) {\n    expandFullWrapper.parentElement!.removeChild(expandFullWrapper)\n  }\n}\n\nasync function fetchManySafeDocumentFragments(document: Document, url: RequestInfo): Promise<DocumentFragments[]> {\n  const response = await self.fetch(url, {\n    headers: {'Content-Type': 'application/json', Accept: 'application/json'},\n  })\n\n  if (!response.ok) {\n    throw new Error(`Request to blob_expand failed with status code ${response.status}`)\n  }\n\n  const fragments = (await response.json()) as DocumentFragmentResponse[]\n  return fragments.map(fragment => ({\n    ...fragment,\n    content: parseHTML(document, fragment.content),\n  }))\n}\n\nfunction maybeHandleRichExpanding(\n  container: Element,\n  action: typeof expandAllInContainer | typeof collapseAllInContainer,\n) {\n  if (container instanceof HTMLElement && supportsRichExpanding(container)) {\n    return action(container)\n  }\n  return false\n}\n\non('click', '.js-expand-full', async evt => {\n  evt.preventDefault()\n  const target = evt.currentTarget\n  const container = target.closest('.file')!\n  const baseURL = target.getAttribute('data-url')!\n  const ranges = getAllHunkRanges(container)\n\n  function expandUI() {\n    // Remove the button now that we've expanded the full file\n    target.setAttribute('hidden', 'true')\n\n    // Show the collapse button\n    const collapseBtn = container.querySelector('.js-collapse-diff')\n    if (collapseBtn) collapseBtn.removeAttribute('hidden')\n\n    // Ensure the file is \"open\"\n    container.classList.add('open')\n    container.classList.add('Details--on')\n  }\n\n  if (maybeHandleRichExpanding(container, expandAllInContainer)) return void expandUI()\n\n  // If there are no ranges to fetch, we shouldn't bother. In this case, the UI\n  // shouldn't have even rendered the button in the first place.\n  if (ranges.length === 0) return\n\n  const url = new URL(baseURL, window.location.origin)\n  const params = new URLSearchParams(url.search.slice(1))\n\n  for (const range of ranges) {\n    params.append('ranges[]last_left', range.left.start)\n    params.append('ranges[]left', range.left.end)\n    params.append('ranges[]left_hunk_size', range.left.size)\n    params.append('ranges[]last_right', range.right.start)\n    params.append('ranges[]right', range.right.end)\n    params.append('ranges[]right_hunk_size', range.right.size)\n\n    // Attach the position of the relevant line, to replace the\n    // right element after we've received the fragments\n    params.append('ranges[]position', range.position)\n  }\n\n  url.search = params.toString()\n\n  const fragments = await fetchManySafeDocumentFragments(document, url.toString())\n  const expanders = [...container.querySelectorAll('.js-expand')]\n\n  for (const {content, position} of fragments) {\n    // Use the index of the original expander that we're replacing\n    const index = parseInt(position, 10)\n    const expander = expanders[index]\n    if (!expander) return\n\n    const expandableLine = expander.closest<HTMLElement>('.js-expandable-line')!\n    const nextLine = next(expandableLine, '.file-diff-line')\n    if (nextLine) {\n      preservePosition(nextLine, () => {\n        expandableLine.after(content)\n      })\n    } else {\n      expandableLine.after(content)\n    }\n\n    // Hide the line in case we want to show it again after\n    expandableLine.setAttribute('hidden', 'true')\n  }\n\n  expandUI()\n})\n\non('click', '.js-collapse-diff', evt => {\n  const target = evt.currentTarget\n  const container = target.closest('.file')!\n\n  function collapseUI() {\n    // Show the expand button, hide this one\n    target.setAttribute('hidden', 'true')\n    const expandBtn = container.querySelector('.js-expand-full')\n    if (expandBtn) expandBtn.removeAttribute('hidden')\n  }\n\n  if (maybeHandleRichExpanding(container, collapseAllInContainer)) return void collapseUI()\n\n  // Remove all the expanded lines\n  const expandedLines = [...container.querySelectorAll('.blob-expanded[data-expanded-full=\"true\"]')]\n  for (const el of expandedLines) {\n    el.parentElement!.removeChild(el)\n  }\n\n  // Unhide the diff header lines that show expanders\n  const expandableLines = [...container.querySelectorAll('.js-expandable-line')]\n  for (const el of expandableLines) {\n    el.removeAttribute('hidden')\n  }\n\n  collapseUI()\n})\n\nfunction getExpanderRange(expander: HTMLAnchorElement, index: number): ExpanderRange {\n  const url = new URL(expander.getAttribute('data-url')!, window.location.origin)\n  const params = url.searchParams\n\n  return {\n    // Store the index of this expander in the list of expanders within\n    // this container. This will be used after the request is made, to\n    // know which DOM elements to replace with the new `.blob-expanded` lines\n    position: index.toString(),\n    left: {\n      start: params.get('last_left')!,\n      end: params.get('left')!,\n      size: params.get('left_hunk_size')!,\n    },\n    right: {\n      start: params.get('last_right')!,\n      end: params.get('right')!,\n      size: params.get('right_hunk_size')!,\n    },\n  }\n}\n\nfunction getAllHunkRanges(container: Element): ExpanderRange[] {\n  const expanders = Array.from(container.querySelectorAll<HTMLAnchorElement>('.js-expand'))\n  const allRanges = expanders.map((el, index) => getExpanderRange(el, index))\n\n  let skipNextRange = false\n  const ranges: ExpanderRange[] = []\n  for (let i = 0; i < allRanges.length; i++) {\n    // This range should be skipped because its the same\n    // as the previous range\n    if (skipNextRange) {\n      skipNextRange = false\n      continue\n    }\n\n    const range = allRanges[i]!\n    const nextRange = allRanges[i + 1]\n\n    // See if these two are duplicates. This will happen when two expanders\n    // are in the same containing div, and clicking either one would expand the\n    // same range.\n    skipNextRange =\n      !!nextRange &&\n      range.left.start === nextRange.left.start &&\n      range.left.end === nextRange.left.end &&\n      range.right.start === nextRange.right.start &&\n      range.right.end === nextRange.right.end\n\n    ranges.push(range)\n  }\n\n  return ranges\n}\n","export class DiffTableSideProtection {\n  selection: Selection\n  anchorNode: Node | null\n\n  constructor(selection: Selection) {\n    this.selection = selection\n    this.anchorNode = selection.anchorNode\n  }\n\n  range(): Range | null | undefined {\n    let range\n\n    if (this.selection?.rangeCount > 0) {\n      range = this.selection.getRangeAt(0)\n    }\n\n    return range\n  }\n\n  canBeSideProtected(): boolean {\n    try {\n      return !!(this.hasSelectedText() && this.confinedTable())\n    } catch (e) {\n      // noop for errors such as permission denied in gecko browsers\n      return false\n    }\n  }\n\n  isSideProtected(): boolean {\n    try {\n      return !!this.confinedTable()?.getAttribute('data-lock-side-selection')\n    } catch (e) {\n      // noop for errors such as permission denied in gecko browsers\n      return false\n    }\n  }\n\n  hasSelectedText(): boolean {\n    const range = this.range()\n    if (!range) return false\n\n    return range.toString().length > 0\n  }\n\n  clearSelectedText() {\n    this.selection.removeAllRanges()\n  }\n\n  confinedTable(): Element | null | undefined {\n    const commonAncestor = this.range()?.commonAncestorContainer?.parentElement\n\n    if (commonAncestor?.matches('.diff-table')) {\n      // selection is confined to the table itself\n      return commonAncestor\n    } else if (commonAncestor?.matches('.js-file-content')) {\n      // selection is confined to the div containing the table\n      const closestTable = commonAncestor?.querySelector('table.diff-table')\n      return closestTable\n    } else {\n      // selection is confined to an element within the table\n      const closestTable = commonAncestor?.closest('table.diff-table')\n      return closestTable\n    }\n  }\n\n  unprotectedSide(): string | null | undefined {\n    let td\n\n    if (this.anchorNode instanceof HTMLTableCellElement) {\n      td = this.anchorNode.closest('td[data-split-side]')\n    } else {\n      td = this.anchorNode?.parentElement?.closest('td[data-split-side]')\n    }\n\n    return td?.getAttribute('data-split-side') // 'left', 'right'\n  }\n\n  protectedSide(): string {\n    return this.unprotectedSide() === 'left' ? 'right' : 'left'\n  }\n\n  applySideProtection() {\n    if (this.unprotectedSide()) {\n      const table = this.confinedTable()\n      const side = this.unprotectedSide()\n\n      if (table && side) {\n        table.setAttribute('data-lock-side-selection', side)\n      }\n    }\n  }\n\n  clearSideProtection() {\n    const tables = document.querySelectorAll('table[data-lock-side-selection]')\n    for (const table of tables) {\n      // this will always be an html element based on the query selection\n      const htmlTable = table as HTMLElement\n      htmlTable.removeAttribute('data-lock-side-selection')\n    }\n  }\n\n  filteredTableRows() {\n    const outputNodes: Node[] = []\n\n    for (let i = 0; i < this.selection.rangeCount; i++) {\n      const range = this.selection.getRangeAt(i)\n      const content = range.cloneContents()\n\n      if (content.querySelectorAll('td').length) {\n        // content is a table row, so remove any protected / unwanted cells\n        const unwantedRowQuery = `td[data-split-side=${this.protectedSide()}], td.js-linkable-line-number, td.empty-cell, .inline-comments`\n        const protectedElements = content.querySelectorAll(unwantedRowQuery)\n        for (const el of protectedElements) {\n          if (el.parentNode) {\n            el.parentNode.removeChild(el)\n          }\n        }\n        outputNodes.push(...content.children)\n      } else {\n        // content is a fragment, so transform it into a table row for consistency elsewhere\n        const row = document.createElement('TR')\n        const cell = document.createElement('TD')\n        cell.append(...content.childNodes)\n        row.append(cell)\n        outputNodes.push(row)\n      }\n    }\n\n    return outputNodes\n  }\n\n  contentToString() {\n    const outputLines: string[] = []\n    const table = document.createElement('table')\n\n    // Temporarily append invisible table to the dom\n    //\n    // This is necessary because we care about the text of just visible elements\n    // and `innerText` only knows about their visibility if attached to the dom.\n    // Some browsers (like chrome) will not actually calculate the visibility of\n    // elements unless it thinks it is shown, so marking this element as hidden\n    // will not work.\n    table.classList.add('invisible')\n    table.append(...this.filteredTableRows())\n\n    // Append table to the confiedTable so that visibility of inline comments\n    // retain the user preference when copied.\n    this.confinedTable()?.append(table)\n\n    // Grab the `innerText` from the table\n    //\n    // We are purposely avoiding the use of `table.innerText` because some\n    // browsers (like chrome) return additional and unexpected line breaks.\n    // Instead, iterate over the top level elements and ask each one for it's `innerText`.\n    const children = table.children\n    for (let i = 0; i < children.length; i++) {\n      const el = children[i] as HTMLElement\n\n      /* eslint-disable-next-line github/no-innerText */\n      const text = el.innerText\n\n      if (text) {\n        if (text === '\\n') {\n          // array will eventually be separated by new lines,\n          // but avoid inadvertent double line breaks\n          outputLines.push('')\n        } else {\n          outputLines.push(text)\n        }\n      }\n    }\n\n    // Remove the temporary table from DOM\n    table.remove()\n\n    return outputLines.join('\\n')\n  }\n}\n","import {DiffTableSideProtection} from './side-copy-protection'\nimport {TemplateInstance} from '@github/template-parts'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n\n// Given a split diff column index, calculate the side on which it's on.\n//\n// Returns 0 = left, 1 = right\nfunction tableSide(index: number): number {\n  return Math.floor(index / 2)\n}\n\n// swap the \"add comment\" button placeholder with a real one on first hover\nfunction ensureCommentButton(row: HTMLElement) {\n  const placeholder = row.querySelector<HTMLElement>('.js-comment-button-placeholder')\n  if (placeholder?.parentElement) {\n    const template = document.querySelector<HTMLTemplateElement>('.js-comment-button-template')\n    if (!template) {\n      throw new Error('missing js-comment-button-template template element!')\n    }\n    // Prepare template arguments from our placeholder\n    // eslint-disable-next-line github/no-dataset\n    const templateVars = placeholder.dataset\n    if (!templateVars) {\n      throw new Error('placeholder element has no dataset')\n    }\n    // To avoid duplication, pull this from the DOM rather than a data attr\n    templateVars.originalLine = row.querySelector<HTMLElement>('.blob-code-inner')?.textContent || ''\n    const renderedButton = new TemplateInstance(template, templateVars)\n    placeholder.parentElement.replaceChild(renderedButton, placeholder)\n    if (templateVars.expandedDiff) {\n      // this attr is optional so it can't be in the template\n      const newButton = row.querySelector<HTMLElement>('.js-add-line-comment')\n      if (newButton) newButton.setAttribute('data-expanded-diff', templateVars.expandedDiff)\n    }\n  }\n}\n\n// TODO Consider js- class names for these selectors. Though that might add\n// some considerable weight to the serialized diff page.\nfunction onHover(td: Element, toggle: boolean) {\n  const row = td.parentElement\n  if (!row) return\n\n  ensureCommentButton(row)\n  updateIsHoveredClasses(row, td, toggle)\n}\n\nfunction updateIsHoveredClasses(row: HTMLElement, td: Element, toggle: boolean) {\n  const cells = row.children\n\n  let diffSide\n  if (cells.length === 4) {\n    for (let i = 0, len = cells.length; i < len; i++) {\n      const el = cells[i]\n      if (el === td) {\n        diffSide = tableSide(i)\n      }\n    }\n  }\n\n  for (let i = 0, len = cells.length; i < len; i++) {\n    const el = cells[i]!\n    if (diffSide == null || tableSide(i) === diffSide) {\n      el.classList.toggle('is-hovered', toggle)\n    }\n  }\n}\n\nobserve('.diff-table', function (container) {\n  let target: Element | null = null\n\n  function onMouseEnter() {\n    if (target) {\n      onHover(target, false)\n    }\n    target = null\n  }\n\n  function onMouseOver(event: Event) {\n    if (target) {\n      onHover(target, false)\n    }\n\n    if (event.target instanceof HTMLElement) {\n      target = event.target.closest('td.blob-code')\n      if (target) {\n        onHover(target, true)\n      }\n    }\n  }\n\n  function add() {\n    container.addEventListener('mouseenter', onMouseEnter)\n    container.addEventListener('mouseleave', onMouseEnter)\n    container.addEventListener('mouseover', onMouseOver)\n  }\n\n  function remove() {\n    container.removeEventListener('mouseenter', onMouseEnter)\n    container.removeEventListener('mouseleave', onMouseEnter)\n    container.removeEventListener('mouseover', onMouseOver)\n  }\n\n  return {add, remove}\n})\n\nfunction copySidedContent(event: ClipboardEvent) {\n  const selection = document.getSelection()\n\n  if (selection) {\n    const protector = new DiffTableSideProtection(selection)\n\n    if (protector.isSideProtected()) {\n      event.clipboardData?.setData('text/plain', protector.contentToString())\n      event.preventDefault()\n    }\n  }\n}\n\nfunction clearSidedProtection(event: MouseEvent) {\n  const selection = document.getSelection()\n  const rightButtonClicked = event.button === 2\n\n  if (selection && !rightButtonClicked) {\n    const protector = new DiffTableSideProtection(selection)\n\n    if (protector.isSideProtected()) {\n      protector.clearSelectedText()\n      protector.clearSideProtection()\n    }\n  }\n}\n\nfunction protectSidedContent() {\n  const selection = document.getSelection()\n\n  if (selection) {\n    const protector = new DiffTableSideProtection(selection)\n\n    if (protector.canBeSideProtected()) {\n      protector.applySideProtection()\n    } else {\n      protector.clearSideProtection()\n    }\n  }\n}\n\nobserve('.js-diff-container', function () {\n  function add() {\n    document.addEventListener('copy', copySidedContent)\n    document.addEventListener('mousedown', clearSidedProtection)\n    document.addEventListener('selectionchange', protectSidedContent)\n  }\n\n  function remove() {\n    document.removeEventListener('copy', copySidedContent)\n    document.removeEventListener('mousedown', clearSidedProtection)\n    document.removeEventListener('selectionchange', protectSidedContent)\n  }\n\n  return {add, remove}\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n\n// Everything here is terrible\nfunction syncBodyClass() {\n  const meta = document.querySelector('meta[name=diff-view]')\n  const diffView = meta && meta instanceof HTMLMetaElement ? meta.content : ''\n  const diffSplit = document.querySelector('.js-file-diff-split')\n\n  const enabled =\n    (diffView === 'split' && diffSplit) || document.querySelector('.wants-full-width-container') ? true : false\n  document.body.classList.toggle('full-width', enabled)\n}\n\n// resync body class\nobserve('meta[name=diff-view]', {\n  add: syncBodyClass,\n  remove: syncBodyClass,\n})\nobserve('.js-file-diff-split', {\n  add: syncBodyClass,\n  remove: syncBodyClass,\n})\nobserve('.js-compare-tab.selected', {\n  add: syncBodyClass,\n  remove: syncBodyClass,\n})\nobserve('.wants-full-width-container', {\n  add: syncBodyClass,\n  remove: syncBodyClass,\n})\n","// Diffs: [ ] Show notes\n//\n// Toggle inline comments in the files\n\nimport {changeValue} from '@github-ui/form-utils'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\non('change', '.js-toggle-file-notes', function (event) {\n  const target = event.currentTarget as HTMLInputElement\n  target.closest<HTMLElement>('.file')!.classList.toggle('show-inline-notes', target.checked)\n})\n\nfunction toggleCheckboxes(checkboxes: HTMLInputElement[]) {\n  const anyChecked = checkboxes.some(el => el.checked)\n  for (const checkbox of checkboxes) {\n    changeValue(checkbox, !anyChecked)\n  }\n}\n\n// Keyboard shortcut for toggling all inline comments\non('click', '.js-toggle-all-file-notes', function (event) {\n  const checkboxes = Array.from(document.querySelectorAll<HTMLInputElement>('.js-toggle-file-notes'))\n  toggleCheckboxes(checkboxes)\n  event.preventDefault()\n})\n\n// Keyboard shortcut for toggling all inline annotations\non('click', '.js-toggle-all-file-annotations', function (event) {\n  const checkboxes = Array.from(document.querySelectorAll<HTMLInputElement>('.js-toggle-file-check-annotations'))\n  toggleCheckboxes(checkboxes)\n  event.preventDefault()\n})\n\n// Hoist presence of any inline comment containers to the .file container\n//\n// Used to show/hide the \"Show notes\" checkbox\n//\n// CSS4 style\n//\n//   .file.has-inline-notes\n//   .file:has(.js-inline-comments-container)\n//\nobserve('.js-inline-comments-container', function (el) {\n  let remove\n  const file = el.closest('.file')\n  if (file) {\n    const add = (remove = function () {\n      const hasNotes = file.querySelector('.js-inline-comments-container') != null\n      file.classList.toggle('has-inline-notes', hasNotes)\n    })\n\n    return {\n      add,\n      remove,\n    }\n  }\n})\n","// Diffs: [ ] Show annotations\n//\n// Toggle inline annotations in files\n\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\non('change', '.js-toggle-file-check-annotations', function (event) {\n  const target = event.currentTarget as HTMLInputElement\n\n  const inlineAnnotations = target.closest<HTMLElement>('.file')!.querySelectorAll('.js-inline-annotations')\n\n  for (const inlineAnnotation of inlineAnnotations) {\n    if (!(inlineAnnotation instanceof HTMLElement)) continue\n    inlineAnnotation.hidden = !target.checked\n  }\n})\n","import {controller, target, targets} from '@github/catalyst'\nimport type {FileFilterElement} from '../../../../components/pull_requests/file_tree/file-filter-element'\nimport {debounce} from '@github/mini-throttle/decorators'\n\ninterface FilterState {\n  hideDeletedFiles: boolean\n  hideViewedFiles: boolean\n  showManifestFilesOnly: boolean\n  selectedOwners: string[]\n  showCodeownersFiles: boolean\n  selectedFileTypes: string[]\n  fileTypeFilterActive: boolean\n  filtersActive: boolean\n}\n\n@controller\nexport class DiffFileFilterElement extends HTMLElement {\n  @target blankslate: HTMLElement\n  @target resetFilters: HTMLElement | undefined\n\n  @targets diffEntries: HTMLElement[]\n  @targets progressiveLoaders: HTMLElement[]\n\n  @targets treeEntries: HTMLElement[]\n  @target treeRoot: HTMLElement | undefined\n  @target fileFilter: FileFilterElement\n\n  filterState: FilterState\n\n  connectedCallback() {\n    this.filterState = {\n      hideDeletedFiles: false,\n      hideViewedFiles: false,\n      showManifestFilesOnly: false,\n      selectedOwners: [],\n      showCodeownersFiles: false,\n      selectedFileTypes: [],\n      fileTypeFilterActive: false,\n      filtersActive: false,\n    }\n  }\n\n  applyFilter(event: CustomEvent) {\n    this.filterState = event.detail\n    this.showResetFilters()\n    this.filterFiles()\n    this.filterTreeFiles()\n    this.hideEmptyDirectories()\n    this.showBlankslateIfEmpty()\n  }\n\n  clearFilters(event: Event): void {\n    event.preventDefault()\n    this.fileFilter.clearFilters()\n  }\n\n  private filterFiles(): void {\n    for (const file of this.diffEntries) {\n      const fileDetails = file.closest<HTMLElement>('.js-file.js-details-container')!\n      fileDetails.hidden = !this.shouldShowFile(file)\n    }\n  }\n\n  private filterTreeFiles(): void {\n    for (const treeFile of this.treeEntries) {\n      const showTreeFile = this.shouldShowFile(treeFile)\n      treeFile.hidden = !showTreeFile\n      treeFile.toggleAttribute('data-skip-substring-filter', !showTreeFile)\n    }\n  }\n\n  @debounce(20)\n  hideEmptyDirectories(): void {\n    if (this.treeRoot) {\n      this.hideEmptyDirectory(this.treeRoot)\n    }\n  }\n\n  private hideEmptyDirectory(node: HTMLElement): number {\n    // Recursively traverses the nodes of the tree to hide directories with\n    // no visible children.\n    const isRoot = node.getAttribute('data-tree-entry-type') === 'root'\n    const isDirectory = node.getAttribute('data-tree-entry-type') === 'directory'\n\n    if (isRoot || isDirectory) {\n      const directChildren = node.querySelectorAll(isRoot ? ':scope > .js-tree-node' : ':scope > ul > .js-tree-node')\n\n      let visibleChildCount = 0\n\n      for (const child of directChildren) {\n        visibleChildCount = visibleChildCount + this.hideEmptyDirectory(child as HTMLElement)\n      }\n\n      if (visibleChildCount === 0) {\n        node.hidden = true\n        return 0\n      }\n      node.hidden = false\n      return 1\n    }\n\n    if (!node.hidden) {\n      return 1\n    }\n    return 0\n  }\n\n  async refilterAfterAsyncLoad() {\n    // Diffs are batched and loaded progressively. Those that finish loading after\n    // a filter has been applied don't get filtered. This function is\n    // intended to hook into the `include-fragment-replace` event emitted by\n    // the <include-fragment>, so that we ensure filters are applied.\n    // We use a promise to \"wait\" a tick to ensure the include-fragment has actually been replaced.\n    await Promise.resolve()\n    this.refilterLoadedFiles()\n    this.showBlankslateIfEmpty()\n  }\n\n  private refilterLoadedFiles(): void {\n    if (this.filterState.filtersActive) {\n      this.filterFiles()\n    }\n  }\n\n  private shouldShowFile(file: HTMLElement): boolean {\n    let show = true\n\n    // FILE EXTENSION FILTER\n    const fileExtension = file.getAttribute('data-file-type')\n    if (fileExtension) {\n      show = this.filterState.selectedFileTypes.includes(fileExtension)\n    }\n\n    // VIEWED FILE FILTER\n    if (this.filterState.hideViewedFiles && show) {\n      const viewedFile = file.hasAttribute('data-file-user-viewed')\n      if (viewedFile) {\n        show = false\n      }\n    }\n\n    // CODEOWNERS FILE FILTER\n    if (this.filterState.showCodeownersFiles && show) {\n      const fileOwners = (file.getAttribute('data-codeowners') || '').split(',')\n      show = fileOwners.filter(owner => this.filterState.selectedOwners.includes(owner)).length > 0\n    }\n\n    // DELETED FILE FILTER\n    if (this.filterState.hideDeletedFiles && show) {\n      const deletedFile = file.getAttribute('data-file-deleted') === 'true'\n      if (deletedFile) {\n        show = false\n      }\n    }\n\n    // MANIFEST FILE FILTER\n    if (this.filterState.showManifestFilesOnly && show) {\n      const manifestFile = file.hasAttribute('data-file-manifest')\n      if (!manifestFile) {\n        show = false\n      }\n    }\n    return show\n  }\n\n  private showResetFilters(): void {\n    if (this.resetFilters) {\n      this.resetFilters.hidden = !this.filterState.filtersActive\n    }\n  }\n\n  private showBlankslateIfEmpty(): void {\n    if (!this.blankslate) {\n      return\n    }\n\n    if (this.progressiveLoaders.length > 0) {\n      this.blankslate.hidden = true\n      return\n    }\n\n    if (this.diffEntries.length === 0) {\n      this.blankslate.hidden = true\n      return\n    }\n\n    const isNotEmpty = Array.from(this.diffEntries).some(file => !file.hidden)\n    this.blankslate.hidden = isNotEmpty\n  }\n}\n","import {controller} from '@github/catalyst'\nimport {dialog} from '@github-ui/details-dialog'\n\ninterface InputDemuxContext {\n  onItemSelected(event: MouseEvent): void\n}\n\ninterface ContextMap {\n  baseChange: InputDemuxContext\n}\n\nclass InputDemuxBaseChangeContext implements InputDemuxContext {\n  onItemSelected(event: MouseEvent) {\n    if (!(event.currentTarget instanceof HTMLButtonElement)) return\n    const selectedRef = event.currentTarget.querySelector<HTMLSpanElement>('.js-ref-name')!.textContent\n    const input = document.querySelector<HTMLInputElement>('.js-new-base-branch')!\n    input.value = btoa(unescape(encodeURIComponent(selectedRef || '')))\n\n    const content = document.querySelector<HTMLTemplateElement>('.js-change-base-template')!.content.cloneNode(true)\n    if (!(content instanceof DocumentFragment)) return\n    dialog({content})\n  }\n}\n\n@controller\nclass InputDemuxContextWrapperElement extends HTMLElement {\n  context: InputDemuxContext\n\n  connectedCallback() {\n    const contextType = this.getAttribute('data-context-type')\n    const contexts: ContextMap = {baseChange: new InputDemuxBaseChangeContext()}\n    this.context = contexts[contextType as keyof ContextMap]\n  }\n\n  /* eslint-disable-next-line custom-elements/no-method-prefixed-with-on */\n  onItemSelected(event: MouseEvent) {\n    this.context.onItemSelected(event)\n  }\n}\n","// Example:\n//\n//    <div class=\"js-line-comments\">\n//      <div class=\"js-inline-comment-form-container\">\n//        <button class=\"js-toggle-inline-comment-form\">\n//        <form>\n//          <texarea class=\"js-comment-field\"></textarea>\n//          <button class=\"js-hide-inline-comment-form\">Cancel</button>\n//        </form>\n//      </div>\n//    </div>\n\n// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport {hasDirtyFields} from '@github-ui/has-interactions'\nimport {onKey} from '@github-ui/onfocus'\n\n// \"Add a line note\" button\n//\n// Hide self and show form.\non('click', '.js-toggle-inline-comment-form', function (event) {\n  const comments = event.currentTarget.closest<HTMLElement>('.js-line-comments')!\n  focusForm(comments)\n})\n\n// With a line comment selected, hitting \"r\" focuses the form with the quoted\n// text.\non('quote-selection', '.js-line-comments', function (event) {\n  focusForm(event.currentTarget)\n  event.stopPropagation()\n})\n\n// Install handlers on inline note comment form focusin\nonKey('keydown', '.js-inline-comment-form-container form .js-comment-field', function (event: KeyboardEvent) {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable @github-ui/ui-commands/no-manual-shortcut-logic */\n  const field = event.target as HTMLTextAreaElement\n\n  if (field.classList.contains('js-navigation-enable')) {\n    return\n  }\n\n  if (event.key === 'Escape' && field.value.length === 0) {\n    const form = field.closest<HTMLFormElement>('form')!\n    blurForm(form)\n    event.preventDefault()\n  }\n  /* eslint-enable @github-ui/ui-commands/no-manual-shortcut-logic */\n})\n\n// \"Close form\" button\n//\n// Hide self and show \"Add a line button\" again. If theres no comments cleanup\n// the empty container.\non('click', '.js-hide-inline-comment-form', function (event) {\n  const form = event.currentTarget.closest<HTMLFormElement>('form')!\n\n  if (!hasDirtyFields(form) || confirm((event.currentTarget as Element).getAttribute('data-confirm-cancel-text')!)) {\n    blurForm(form)\n  } else {\n    // Do not reset form\n    event.preventDefault()\n  }\n})\n\n// Opens form container, ensures write tab is selected and focuses textarea.\nexport function focusForm(comments: Element) {\n  const container = comments.querySelector<HTMLElement>('.js-inline-comment-form-container')!\n  container.classList.add('open')\n  container.querySelector<HTMLElement>('.js-write-tab')?.click()\n  container.querySelector<HTMLElement>('.js-comment-field')!.focus()\n  fire(container, 'inlinecomment:focus')\n}\n\n// Reset and close comment form. Opposite of focusForm.\n// Hide multi-line-preview (range info).\n//\n// form - A .js-inline-comment-form HTMLFormElement\nexport function blurForm(form: HTMLFormElement) {\n  form.reset()\n\n  const container = form.closest<HTMLElement>('.js-inline-comment-form-container')!\n  container.classList.remove('open')\n\n  const multiLinePreview = container.querySelector<HTMLElement>('.js-multi-line-preview')\n  if (multiLinePreview) {\n    multiLinePreview.hidden = true\n  }\n\n  fire(container, 'inlinecomment:collapse')\n}\n","import {getState, replaceState} from '@github-ui/browser-history-state'\n\nexport function updateURLState(\n  fileFiltersActive: boolean,\n  whitespaceFilterActive: boolean,\n  selectedTypes: string[],\n  selectedOwnersActive: boolean,\n  selectedOwners: string[],\n  manifestsFilterActive: boolean,\n  deletedFilesHidden: boolean,\n  viewedFilesHidden: boolean,\n  // useful for testing\n  searchParamString = window.location.search,\n) {\n  const fileFilter = document.querySelector<HTMLElement>('.js-file-filter')!\n  const url = new URL(window.location.href, window.location.origin)\n  const activeSearchParams = new URLSearchParams(searchParamString)\n  const whitespaceParam = activeSearchParams.get('w')\n\n  if (!fileFiltersActive && !selectedOwnersActive) {\n    if (manifestsFilterActive) {\n      return\n    }\n\n    // keep the 'diff' and 'w' params if the file filter are not active\n    const params = new URLSearchParams()\n    const diffParam = activeSearchParams.get('diff')\n    if (diffParam) params.set('diff', diffParam)\n    if (whitespaceParam) params.set('w', whitespaceParam)\n\n    url.search = params.toString()\n    replaceState(getState(), '', url.toString())\n    return\n  }\n\n  const fileFilterForm = fileFilter.querySelector<HTMLFormElement>('.js-file-filter-form')!\n  const formData = new FormData(fileFilterForm)\n  const disabledSelectedTypes = selectedTypes.filter(type => !formData.getAll('file-filters[]').includes(type))\n  const disabledSelectedOwners = selectedOwners.filter(owner => !formData.getAll('owned-by[]').includes(owner))\n\n  // Add selected but disabled types\n  for (const disabledType of disabledSelectedTypes) {\n    formData.append('file-filters[]', disabledType)\n  }\n\n  for (const disabledOwner of disabledSelectedOwners) {\n    formData.append('owned-by[]', disabledOwner)\n  }\n\n  const params = new URLSearchParams(formData as unknown as URLSearchParams)\n\n  if (!params.has('file-filters[]') || params.toString() === '') {\n    // Filter is active, but no file types are selected\n    params.set('file-filters[]', '')\n  }\n\n  if (whitespaceFilterActive) {\n    params.set('w', whitespaceParam ?? '1')\n  }\n\n  if (manifestsFilterActive) {\n    params.set('manifests', 'true')\n  }\n\n  if (deletedFilesHidden) {\n    params.set('show-deleted-files', 'false')\n  }\n\n  if (viewedFilesHidden) {\n    params.set('show-viewed-files', 'false')\n  }\n\n  /* eslint-disable-next-line github/authenticity-token */\n  params.delete('authenticity_token')\n\n  url.search = params.toString()\n  replaceState(getState(), '', url.toString())\n}\n","import {controller, target, targets} from '@github/catalyst'\n\n// Demultiplexes InputEvents on an <input> for use with multiple\n// elements in a <tab-container>.  Also provides notifications to\n// tabpanels when they are opened.\n//\n// On input, element corresponding to the selected tab gets a `input-entered`\n// event with its `detail` property set to the current value of the input.\n// Also performs similar proxying of mouseover events from an optional\n// enclosing details element to the \"primary\" tab so it can e.g. prefetch data.\n@controller\nclass InputDemuxElement extends HTMLElement {\n  // The <input> element to be shared among our sinks\n  @target source: HTMLInputElement\n\n  // The elements we are selecting among\n  @targets sinks: HTMLElement[]\n\n  // Determines which sink is selected by its children's aria-selected\n  // attributes.  Probably a role=\"tablist\" with children of role=\"tab\"\n  @target control: HTMLElement\n\n  // Temporary store for input values while other tabs are using the <input>.\n  storedInput: string[]\n\n  connectedCallback() {\n    /* eslint-disable-next-line custom-elements/no-dom-traversal-in-connectedcallback */\n    if (this.control) this.storedInput = Array(this.control.children.length).fill('')\n    this.addEventListener('input', this.relayInput.bind(this))\n    this.addEventListener('keydown', this.relayKeydown.bind(this))\n    const details = this.closest('details')\n    if (details) {\n      details.addEventListener('toggle', () => {\n        // Move the cursor to the input after the details menu is opened.\n        // This is especially nice in combination with the 'w' shortcut!\n        if (details.open) {\n          this.source.focus()\n        }\n      })\n    }\n  }\n\n  // Invoked on keydown to emulate the existing behavior where pressing down\n  // when the input is focused should focus the first list item.\n  relayKeydown(e: KeyboardEvent) {\n    // TODO: Refactor to use data-hotkey\n    /* eslint eslint-comments/no-use: off */\n    /* eslint-disable @github-ui/ui-commands/no-manual-shortcut-logic */\n    if ((this.isControlTab(e.target) || e.target === this.source) && (e.key === 'ArrowDown' || e.key === 'Tab')) {\n      e.preventDefault()\n      e.stopPropagation()\n      this.routeCustomEvent(new CustomEvent('focus-list'))\n    } else if (e.key === 'Escape') {\n      const details = this.closest('details')\n      if (details) {\n        details.removeAttribute('open')\n      }\n    }\n    /* eslint-enable @github-ui/ui-commands/no-manual-shortcut-logic */\n  }\n\n  // Is the given EventTarget one of our control tabs?\n  isControlTab(element: EventTarget | null): boolean {\n    if (!element) return false\n    if (!this.control) return false\n    return Array.from(this.control.children).includes(element as Element)\n  }\n\n  // Invoked on input.  Decide which sink is selected and dispatch a\n  // CustomEvent that either contains input or a mouseover notification.\n  relayInput(e: Event) {\n    if (!e.target) return\n    const eventTarget = e.target as HTMLElement\n    const text = (eventTarget as HTMLInputElement).value\n    this.routeCustomEvent(new CustomEvent('input-entered', {detail: text}))\n  }\n\n  // Dispatch an event on whichever sink is currently selected.\n  routeCustomEvent(event: Event) {\n    const sink = this.sinks[this.selectedIndex]!\n    sink.dispatchEvent(event)\n  }\n\n  // The index of the selected tab.\n  get selectedIndex() {\n    if (!this.control) return 0\n    const selected = this.control.querySelector('[aria-selected=\"true\"]')\n    if (!selected) return 0\n    return Array.from(this.control.children).indexOf(selected)\n  }\n\n  // Save the input value before switching tabs.\n  storeInput() {\n    this.storedInput[this.selectedIndex] = this.source.value\n  }\n\n  // Restore a stored input value after switching tabs.\n  updateInput(e: CustomEvent) {\n    this.source.value = this.storedInput[this.selectedIndex]!\n    const placeholder = e.detail.relatedTarget.getAttribute('data-filter-placeholder')\n    this.source.placeholder = placeholder\n    this.source.setAttribute('aria-label', placeholder)\n    this.notifySelected()\n  }\n\n  // Courtesy notification to the element whose tab was just selected\n  notifySelected() {\n    const sink = this.sinks[this.selectedIndex]!\n    const event = new CustomEvent('tab-selected')\n    sink.dispatchEvent(event)\n  }\n}\n","/*\n * This module is responsible for showing the spoof commit warning banner on\n * the commit details page.\n *\n * This banner is displayed if the commit is not reachable from any named ref,\n * to warn the user that they may be looking at a commit from another fork of\n * the repo.\n *\n * We indicate that the commit is unreachable by including an element with the\n * ID `js-spoofed-commit-warning-trigger` in the page, instead of links to the\n * branches and tags that the commit belongs to.\n */\n\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n\nconst showSpoofCommitBanner = () => {\n  const banner = document.getElementById('spoof-warning') as HTMLElement\n  if (!banner) {\n    // If the banner isn't present in the DOM, there's no way we can display\n    // it. This indicates we're not on a commit detail page.\n    return\n  }\n\n  const commitTitle = document.querySelector<HTMLElement>('.commit-title')!\n  if (commitTitle) {\n    commitTitle.classList.add('pb-1')\n  }\n\n  banner.hidden = false\n  banner.removeAttribute('aria-hidden')\n}\n\nobserve('#js-spoofed-commit-warning-trigger', {\n  add: showSpoofCommitBanner,\n})\n","import {dialog} from '@github-ui/details-dialog'\nimport {fetchSafeDocumentFragment} from '@github-ui/fetch-utils'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from '@github/selector-observer'\n\nfunction waitForDialogClose(dialogEl: HTMLElement): Promise<unknown> {\n  return new Promise(resolve => {\n    dialogEl.addEventListener('dialog:remove', resolve, {once: true})\n  })\n}\n\nfunction setModalStatus(success: boolean) {\n  const modal = document.querySelector('.sso-modal')\n  if (!modal) return\n\n  modal.classList.remove('success', 'error')\n\n  if (success) modal.classList.add('success')\n  else modal.classList.add('error')\n}\n\nfunction updateExpiresAroundTag(expiresAround: string) {\n  const expiryTag = document.querySelector('meta[name=sso-expires-around]')\n  if (expiryTag) expiryTag.setAttribute('content', expiresAround)\n}\n\n// Asks the user to perform single sign-on for the current organization. SSO\n// take place in a new window so we'll need to set up a way for the other window\n// to tell us when SSO is complete and whether or not it was successful.\nasync function ssoPrompt() {\n  const link = document.querySelector<HTMLLinkElement>('link[rel=sso-modal]')!\n  const prompt = await dialog({content: fetchSafeDocumentFragment(document, link.href), dialogClass: 'sso-modal'})\n\n  let sso = null\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any, compat/compat\n  const external: any = window.external\n\n  // Expose callback method for the SSO window to invoke with its status when complete.\n  external.ssoComplete = function (data: {error: boolean; expiresAround: string}) {\n    if (data.error) {\n      sso = false\n      setModalStatus(sso)\n    } else {\n      sso = true\n      setModalStatus(sso)\n      updateExpiresAroundTag(data.expiresAround)\n      window.focus()\n    }\n\n    // Remove the external function now that it's served its purpose\n    external.ssoComplete = null\n  }\n\n  await waitForDialogClose(prompt)\n\n  if (!sso) {\n    throw new Error('sso prompt canceled')\n  }\n}\n\n// Watch for modal complete elements. This is shown as the final step of the\n// single sign-on process that happens in a separate window. Once we see this\n// we know SSO is complete and we can try to tell the original window what the\n// status is before closing the SSO window.\nobserve('.js-sso-modal-complete', function (el) {\n  if (window.opener && window.opener.external.ssoComplete) {\n    const error = el.getAttribute('data-error')\n    const expiresAround = el.getAttribute('data-expires-around')\n\n    window.opener.external.ssoComplete({\n      error,\n      expiresAround,\n    })\n    window.close()\n  } else {\n    const fallback = el.getAttribute('data-fallback-url')\n    if (fallback) window.location.href = fallback\n  }\n})\n\nfunction expiresSoon(expiresTag: Element | null): boolean {\n  if (!(expiresTag instanceof HTMLMetaElement)) return true\n\n  const expiresAround = parseInt(expiresTag.content)\n  const now = new Date().getTime() / 1000\n\n  return now > expiresAround\n}\n\n// Remotely checks the single-sign on status for the current page. If the link tags are\n// not present in the <head>, the current page is not enforced and the status is considered good.\nasync function fetchSsoStatus(): Promise<boolean> {\n  const sessionTag = document.querySelector('link[rel=sso-session]')\n  const expiryTag = document.querySelector('meta[name=sso-expires-around]')\n\n  if (!(sessionTag instanceof HTMLLinkElement)) return true // No SSO enforcement head tags. SSO not enforced.\n  if (!expiresSoon(expiryTag)) return true // Don't bother checking unless we're nearing SSO session expiry\n\n  const url = sessionTag.href\n  const response = await fetch(url, {headers: {Accept: 'application/json', 'X-Requested-With': 'XMLHttpRequest'}})\n  const result: boolean = await response.json()\n  return result\n}\n\nlet activeSsoPrompt: Promise<void> | null = null\n\nfunction clearActiveSsoPrompt() {\n  activeSsoPrompt = null\n}\n\n// Checks to see if the user has a valid single sign-on session for the current\n// page. If not and the page is enforced, it blocks the callback until the user\n// renews their SSO session.\n/* eslint-disable-next-line import/no-anonymous-default-export */\nexport default async function () {\n  const sso = await fetchSsoStatus()\n\n  if (!sso) {\n    if (!activeSsoPrompt) {\n      activeSsoPrompt = ssoPrompt()\n        /* eslint-disable-next-line github/no-then */\n        .then(clearActiveSsoPrompt)\n        /* eslint-disable-next-line github/no-then */\n        .catch(clearActiveSsoPrompt)\n    }\n\n    await activeSsoPrompt\n  }\n}\n","import {fire} from 'delegated-events'\n\ntype Options = {\n  content: DocumentFragment | Promise<DocumentFragment> | Node\n  dialogClass?: string\n  detailsClass?: string\n  labelledBy?: string | null\n  label?: string | null\n  errorMessage?: string | null\n}\n\n// Open the site-wide Details Dialog element.\nexport async function dialog(options: Options): Promise<HTMLElement> {\n  const dialogTemplate = document.querySelector<HTMLTemplateElement>('#site-details-dialog')!\n  const clonedDetails = dialogTemplate.content.cloneNode(true) as Element\n  const details = clonedDetails.querySelector<HTMLElement>('details')!\n  const detailsDialog = details.querySelector<HTMLElement>('details-dialog')!\n  const spinner = details.querySelector<HTMLElement>('.js-details-dialog-spinner')!\n  if (options.detailsClass) details.classList.add(...options.detailsClass.split(' '))\n  if (options.dialogClass) detailsDialog.classList.add(...options.dialogClass.split(' '))\n\n  if (options.label) {\n    detailsDialog.setAttribute('aria-label', options.label)\n  } else if (options.labelledBy) {\n    detailsDialog.setAttribute('aria-labelledby', options.labelledBy)\n  }\n\n  document.body.append(clonedDetails)\n  try {\n    const content = await options.content\n    spinner.remove()\n    detailsDialog.prepend(content)\n  } catch (error) {\n    spinner.remove()\n    // create a span with the error message\n    const errorSpan = document.createElement('span')\n    errorSpan.textContent = options.errorMessage || \"Couldn't load the content\"\n    errorSpan.classList.add('my-6')\n    errorSpan.classList.add('mx-4')\n    detailsDialog.prepend(errorSpan)\n  }\n\n  details.addEventListener('toggle', () => {\n    if (details.hasAttribute('open')) return\n    fire(detailsDialog, 'dialog:remove')\n    details.remove()\n  })\n\n  return detailsDialog\n}\n","//  Get document's HTML Safe nonce.\n//\n// Example:\n//\n//   <meta name=\"html-safe-nonce\" content=\"de43a1f355c711f7f705e4f971964391ac0c8e13\">\nexport function getDocumentHtmlSafeNonces(document: Document): string[] {\n  const nonces = [...document.querySelectorAll<HTMLMetaElement>('meta[name=html-safe-nonce]')].map(meta => meta.content)\n\n  if (nonces.length < 1) {\n    throw new Error('could not find html-safe-nonce on document')\n  }\n  return nonces\n}\n\ninterface Response {\n  headers: Headers\n  status: number\n}\n\nclass ResponseError extends Error {\n  response: Response\n\n  constructor(message: string, response: Response) {\n    super(`${message} for HTTP ${response.status}`)\n    this.response = response\n  }\n}\n\nexport function verifyResponseHtmlSafeNonce(nonces: string[], response: Response, allowJson = false) {\n  const contentType = response.headers.get('content-type') || ''\n  if (!allowJson && !contentType.startsWith('text/html')) {\n    throw new ResponseError(`expected response with text/html, but was ${contentType}`, response)\n  }\n\n  if (allowJson && !(contentType.startsWith('text/html') || contentType.startsWith('application/json'))) {\n    throw new ResponseError(`expected response with text/html or application/json, but was ${contentType}`, response)\n  }\n\n  const responseNonce = response.headers.get('x-html-safe')\n  if (!responseNonce) {\n    throw new ResponseError(`missing X-HTML-Safe nonce`, response)\n  } else if (!nonces.includes(responseNonce)) {\n    throw new ResponseError(`response X-HTML-Safe nonce did not match`, response)\n  }\n}\n","import {getDocumentHtmlSafeNonces, verifyResponseHtmlSafeNonce} from '@github-ui/html-safe-nonce'\nimport {ghTrustedTypes} from '@github-ui/trusted-types'\nimport {trustedTypesPolicy} from './policy'\n\nconst policyName = 'server-x-safe-html'\n\n// This is a no-op policy to be used with server-side rendered HTML.\nexport const serverXSafeHTMLPolicy = ghTrustedTypes.createPolicy(policyName, {\n  createHTML: (s: string, response: Response) => {\n    return trustedTypesPolicy.apply({\n      policy: () => {\n        verifyResponseHtmlSafeNonce(getDocumentHtmlSafeNonces(document), response)\n        return s\n      },\n      policyName,\n      fallback: s,\n      silenceErrorReporting: true,\n    })\n  },\n})\n","import {parseHTML} from '@github-ui/parse-html'\nimport {serverXSafeHTMLPolicy} from '@github-ui/trusted-types-policies/server-x-safe-html'\n\nexport async function fetchSafeDocumentFragment(\n  document: Document,\n  url: RequestInfo,\n  options?: RequestInit,\n): Promise<DocumentFragment> {\n  const request = new Request(url, options)\n  request.headers.append('X-Requested-With', 'XMLHttpRequest')\n  const response = await self.fetch(request)\n  if (response.status < 200 || response.status >= 300) {\n    throw new Error(`HTTP ${response.status}${response.statusText || ''}`)\n  }\n  const trustedHTML = serverXSafeHTMLPolicy.createHTML(await response.text(), response)\n  return parseHTML(document, trustedHTML)\n}\n\nexport function fetchPoll(\n  url: RequestInfo,\n  options?: RequestInit,\n  timeBetweenRequests = 1000,\n  acceptedStatusCodes = [200],\n  pollStatusCodes = [202],\n): Promise<Response> {\n  return (async function poll(wait: number): Promise<Response> {\n    const request = new Request(url, options)\n    request.headers.append('X-Requested-With', 'XMLHttpRequest')\n    const response = await self.fetch(request)\n\n    if (pollStatusCodes.includes(response.status)) {\n      await new Promise(resolve => setTimeout(resolve, wait))\n      return poll(wait * 1.5)\n    }\n    if (acceptedStatusCodes.includes(response.status)) {\n      return response\n    }\n    if (response.status < 200 || response.status >= 300) {\n      throw new Error(`HTTP ${response.status}${response.statusText || ''}`)\n    }\n    throw new Error(`Unexpected ${response.status} response status from poll endpoint`)\n  })(timeBetweenRequests)\n}\n\ntype RetryResult = Response | 'retry'\ntype FetchRetryOptions = {\n  // Base wait time between retries\n  // this will be multiplied with the current attempt to perform a backoff strategy\n  // Defaults to 500ms\n  wait?: number\n  // List of accepted status codes that should not be retried. Defaults to [200]\n  acceptedStatusCodes?: number[]\n  // Max number of attempts. Defaults to 3\n  max?: number\n  // Current retry attempt. Starts at 0\n  attempt?: number\n}\n\n// Execute a fetch call in a callback and retry it up to `options.max` times\n// Each retry will be delayed `options.wait` * `options.attempt`\nexport async function fetchRetry(\n  url: RequestInfo,\n  fetchOptions?: RequestInit,\n  options?: FetchRetryOptions,\n): Promise<Response> {\n  const {wait = 500, acceptedStatusCodes = [200], max = 3, attempt = 0} = options || {}\n\n  const retry: () => Promise<RetryResult> = async () => {\n    return new Promise((resolve, reject) => {\n      setTimeout(async () => {\n        try {\n          const request = new Request(url, fetchOptions)\n          request.headers.append('X-Requested-With', 'XMLHttpRequest')\n          const response = await self.fetch(request)\n          if (acceptedStatusCodes.includes(response.status) || attempt + 1 === max) {\n            return resolve(response)\n          }\n\n          // The response failed, we indicate that it must be retried\n          resolve('retry')\n        } catch (err) {\n          // Only non successful HTTP status codes are controlled by this retry mechanism\n          // Any other error is propagated\n          reject(err)\n        }\n      }, wait * attempt)\n    })\n  }\n\n  const result = await retry()\n  if (result !== 'retry') {\n    return result\n  }\n\n  return fetchRetry(url, fetchOptions, {wait, acceptedStatusCodes, max, attempt: attempt + 1})\n}\n"],"names":["on","firstClick","event","detailsMenu","conversationsMenu","currentTarget","closest","querySelector","textContent","url","getAttribute","response","fetch","ok","innerHTML","text","anchor","details","hasAttribute","removeAttribute","window","location","hash","scrollToFragmentTarget","document","caret","selectMenuHeader","style","transform","classList","toggle","toggleFileHeaderMenu","isOpen","file","getSelectedFileTypes","checkedFileOptions","from","getFileTypeOptions","filter","option","checked","map","value","querySelectorAll","getDeletedFilesInput","input","HTMLInputElement","codeownerFilterActive","getSelectedOwners","length","fileTypeFilterActive","manifestFilterActive","showManifestFiles","deletedFilterActive","hideDeletedFiles","viewedFilterActive","target","toggledAllFileContents","open","checkbox","deletedFilesInput","isActive","fileFilterButton","toggleResetFileFiltersButton","show","resetFileFilter","commitsCurrentlyFiltered","hidden","toggleAvailableOptions","fileTypeOptions","deletedFilesHidden","allFilesDeleted","disabled","toggleSelectAll","typefilterActive","selectAllContainer","newMarkup","toggleFileTypeCounts","count","countMarkup","updateURLState","params","URLSearchParams","search","has","detail","container","getBoundingClientRect","top","scrollIntoView","hashChange","slice","getElementsByName","nextElementSibling","matches","add","observe","subscribe","el","fromEvent","anchorValue","substring","dataAnchor","checkEmptyFilterResults","blankSlate","loaders","filesOnPage","isNotEmpty","Array","some","markdownPrefix","markdownPrefixRegex","markdownSuffixRegex","lineAtIndex","index","lines","split","leadingWhitespace","line","match","captureLeadingWhitespaceRegex","exec","findNextOccurrenceOf","regex","cursor","str","cursorInSuggestionBlock","cursorIndex","ranges","startIndex","endIndex","push","range","VALIDATION_CLASSES","addToBatchEnabled","unchangedSuggestion","closedOrMergedPull","viewingSubset","leftBlob","rightBlob","outdatedComment","resolvedThread","pendingReview","inMergeQueue","headOidNotLoaded","disableAllApplySuggestionButtons","template","message","applyButtons","disabledApplyButton","button","clonedDisabledApplyButton","cloneNode","displayButton","replaceWith","disableBatchSuggestionsButtons","menu","remove","setAttribute","labelMessage","disableSuggestionButtonWithMessage","addBatchedSuggestionButton","openInEditorButton","validateOnPreview","blobContainer","span","trim","parentNode","insertBefore","nextSibling","validateInlineCommmentsContainer","items","klass","item","tooltip_id","tooltip","getElementById","updatePendingSuggestionsHandler","setTimeout","updatePendingSuggestionsState","batchedSuggestionsCount","String","addEventListener","once","parent","commentIsPending","commentIsOutdated","commentIsResolved","commentOnDeletedLine","side","convertFormInputs","form","changes","commitTitleInput","commitMessageInput","defaultValue","commitMessage","messageInput","createElement","appendChild","changesInput","JSON","stringify","e","HTMLButtonElement","renderSuggestionBlock","diff","insertSuggestionBlock","suggestion","textarea","selectionStart","EOLIndex","isOnlyLine","isEmptyLine","newValue","focusIndex","join","BOLIndex","whitespace","beforeBOL","afterEOL","endOfBlockIndex","beforeEndOfBlock","afterEndOfBlock","beforeEOL","changeValue","focus","setSelectionRange","reload","validateRightBlob","validateLeftBlob","inlineCommentForm","inlineCommentFormSide","diffContainer","previousElementSibling","originalLineContainer","suggestedLinesContainer","originalLine","suggestedLines","x","HTMLTemplateElement","clonedFormContainer","content","err","name","addToBatchEnabledMessage","pullHeaderDetails","pullIsOpen","threadContainer","resolvedThreadMessage","pullNotOpenMessage","inMergeQueueValidationClass","inMergeQueueMessage","pendingMessage","commitsTab","suggestedChangesBlob","deletionsContainers","additionsContainers","originalLines","every","unchangedSuggestionMessage","templateContent","headOidisLoaded","parentElement","titleInput","onKey","key","insertNewSuggestionLine","currentLine","lineToInsert","output","substr","newCursorIndex","preventDefault","grandParent","href","dismissUrl","token","data","FormData","append","method","mode","body","headers","notice","submitButton","lineValues","i","commentId","path","remoteForm","wants","formContainer","dropdown","appliedButton","errorMessageContainer","containerParent","json","addToBatchButton","error","errorMessage","errorMessageElement","prepend","changeForm","formParent","errorMessageSpan","sequence","next","selector","sibling","findOrInsertCommentThread","comments","existingForm","pop","newThread","renderCommentTemplate","ensureInlineNotesEnabled","cleanupInlineCommentContainers","hasComments","isResolved","formOpen","contains","loadSuggestionButton","srcBase","URL","origin","HTMLFormElement","paramsForSuggestionButton","commentIdInput","elements","namedItem","id","pathInput","startSideInput","startLineInput","endSideInput","endLineInput","startCommitOidInput","endCommitOidInput","baseCommitOidInput","subjectType","toString","fetchSafeDocumentFragment","applyMultiLinePreview","element","lineNumber","isContext","thread","threadRow","existingFileComment","table","Element","commentsContainer","insertFileComment","thisHeader","className","nextRow","firstElementChild","after","suggestionButton","getElementsByClassName","display","fillTemplateFormFields","focusForm","existingCommentRow","insertCommentRow","thisRow","row","expandLineCommentsEmptyCells","found","lineComments","empty","last","inlineCommentsSplitContainerForLine","tr","TemplateInstance","resetInlineCommentError","errData","handleInlineCommentError","errors","isArray","commentHtml","parseHTML","threadHtml","fragment","replaced","commentContainer","newCommentContainer","blurForm","showReplyForm","threadReplyToId","targetId","showCommentForm","position","click","suggestionContainer","sides","R","L","field","expandedDiffField","fillMultilineFormFields","currentRange","getCurrentRange","end","is","start","isMultiLineCommentAllowed","clearSelection","startLineNumber","endLineNumber","startSide","endSide","buttonLine","Number","buttonSide","sideValue","startLineEl","startSideEl","endLineEl","endSideEl","previewStartSideEl","previewSideEl","startLine","endLine","multiLinePreview","multiLinePreviewStart","multiLinePreviewEnd","startIsContext","endIsContext","subject_type","processProgressiveContainer","urlAnchor","scrollToAnchor","entryContainer","entryId","entryAnchor","getEntryFromCommentAnchor","commentDummy","loadDiff","findElementByFragmentName","ownerDocument","indexOf","ensureExpanded","loadResolvedComments","threadCommentIds","commentIds","anchorCommentId","includes","loadDeferredContent","placeholder","buttonText","src","loader","fileContainer","loadDiffPathName","announce","updateWindowLocation","fileHeader","switchToRendered","switchToSource","shortPath","searchParams","set","delete","replaceState","updateSelectedButton","fileContent","html","lastChild","removeChild","highlightSelectedRange","startItem","endItem","resetHighlight","observeShiftRangeHighlights","highlightRange","Promise","resolve","removeEventListener","shifted","clicked","shiftKey","selected","currentItem","relatedTarget","stopPropagation","firstItem","lastItem","urlTemplate","sha1","sha2","replace","softNavigate","stopImmediatePropagation","capture","unsubscribe","tab","selectedTab","HTMLElement","bucket","visible","indicator","responseError","DiffLayoutElement","connectedCallback","sidebarContainer","notificationShelfObserver","MutationObserver","handleNotificationShelfMutation","subtree","childList","signal","eventAbortController","AbortController","handleSidebarScroll","handleSidebarResize","disconnectedCallback","disconnect","abort","scrollTimer","cancelAnimationFrame","resizeTimer","toggleSidebar","layoutContainer","sidebarHidden","fileTree","toggleButton","instrumentToggleFileTree","fileTreePathFilter","handleOpenFilesListHotkeyEvent","shouldOpenTocMenu","tocMenuButton","showFileTreeButton","tocMenu","getComputedStyle","mutations","root","mutation","addedNode","addedNodes","removedNode","removedNodes","requestAnimationFrame","updateSidebarHeight","sidebarHeight","viewportHeight","documentElement","clientHeight","diffToolbarRect","diffToolbar","mainRect","mainContainer","scrolledToEnd","bottom","toolbarStuck","parseInt","Math","min","height","attrPrefix","attr","debounce","controller","unifiedDiffViewBox","splitDiffViewBox","splitDiffViewOption","unifiedDiffViewOption","InstrumentFilesElement","instrumentCtrlF","findCommands","eventToHotkeyString","sendHydroEvent","forms","isDirty","formTarget","targets","fire","restoredField","mergeContainer","mergeDetails","mergeMessageContainer","newStateValue","mergeBox","autoMergeBox","mergeForm","autoMergeForm","mergeQueueForm","mergeButtons","updateBranchType","updateMergeButton","updateRebaseButton","updateMethod","updateMethodDropdown","mergeMenuButton","buttonClass","titleInputLists","msgTextAreaLists","msgTextArea","overrideActive","mergeTypeInput","type","persistSubmitButtonValue","liveUpdateContainer","dataURL","sections","toggleDetailsTarget","force","constructor","IncludeFragmentElement","onVisible","action","Accept","onbeforeunload","scrollTo","altPressed","syncLast","refRestores","syncRestorable","restorable","timeline","MouseEvent","altKey","current","toggleAll","other","otherContainer","toggleAttribute","preservePosition","updatePendingHandler","pendingReviewCommentsCount","updatePendingCommentsCount","parseRatio","bar","refresh","parts","whole","percent","div","width","send","showGlobalError","reviewedFile","fileLevelComments","header","topFile","ProgressBarElement","decrement","increment","fileTreeItem","fetchError","observedAttributes","attributeChangedCallback","attrName","newParts","max","customElements","get","define","showFlash","detailsElement","showUpdateBranchError","currentSha","errorTextContainer","expectedHeadOid","SOFT_NAV_STATE","SUCCESS","updateContent","spinner","verifySsoSession","responseData","error_message","job","orchestration","pollingData","fetchPoll","accept","current_head_sha","countText","isFeatureEnabled","abortController","startTime","markMergeBoxLoadTime","softNav","partialLoadTime","performance","now","sendEvent","react","ssrSafeDocument","START","_scrollIntoView","findAndActivateExpander","expansion","retries","lastLine","hashFragment","partialHashFragment","expanders","findExpanders","all","expander","activateExpander","expanders2","expandableLine","nextLine","removeExpandAllButton","expandFullWrapper","lineNum","lastLineNum","fetchManySafeDocumentFragments","self","status","fragments","maybeHandleRichExpanding","supportsRichExpanding","parseExpansion","matchHash","evt","baseURL","getAllHunkRanges","allRanges","getExpanderRange","left","size","right","skipNextRange","nextRange","expandUI","collapseBtn","expandAllInContainer","collapseUI","expandBtn","collapseAllInContainer","DiffTableSideProtection","selection","rangeCount","getRangeAt","canBeSideProtected","hasSelectedText","confinedTable","isSideProtected","clearSelectedText","removeAllRanges","commonAncestor","commonAncestorContainer","unprotectedSide","td","anchorNode","HTMLTableCellElement","protectedSide","applySideProtection","clearSideProtection","htmlTable","filteredTableRows","outputNodes","cloneContents","unwantedRowQuery","children","cell","childNodes","contentToString","outputLines","innerText","tableSide","floor","onHover","ensureCommentButton","templateVars","dataset","renderedButton","replaceChild","expandedDiff","newButton","updateIsHoveredClasses","diffSide","cells","len","copySidedContent","getSelection","protector","clipboardData","setData","clearSidedProtection","rightButtonClicked","protectSidedContent","syncBodyClass","meta","diffView","HTMLMetaElement","diffSplit","enabled","toggleCheckboxes","checkboxes","anyChecked","onMouseEnter","onMouseOver","hasNotes","inlineAnnotation","DiffFileFilterElement","filterState","hideViewedFiles","showManifestFilesOnly","selectedOwners","showCodeownersFiles","selectedFileTypes","filtersActive","applyFilter","showResetFilters","filterFiles","filterTreeFiles","hideEmptyDirectories","showBlankslateIfEmpty","clearFilters","fileFilter","diffEntries","fileDetails","shouldShowFile","treeFile","treeEntries","showTreeFile","treeRoot","hideEmptyDirectory","node","isRoot","isDirectory","directChildren","visibleChildCount","child","refilterAfterAsyncLoad","refilterLoadedFiles","fileExtension","fileOwners","owner","resetFilters","blankslate","progressiveLoaders","InputDemuxBaseChangeContext","onItemSelected","selectedRef","btoa","unescape","encodeURIComponent","DocumentFragment","dialog","InputDemuxContextWrapperElement","contextType","contexts","baseChange","context","reset","hasDirtyFields","confirm","fileFiltersActive","whitespaceFilterActive","selectedTypes","selectedOwnersActive","manifestsFilterActive","viewedFilesHidden","searchParamString","activeSearchParams","whitespaceParam","diffParam","getState","formData","disabledSelectedTypes","getAll","disabledSelectedOwners","disabledType","disabledOwner","InputDemuxElement","control","storedInput","fill","relayInput","bind","relayKeydown","source","isControlTab","routeCustomEvent","CustomEvent","sink","sinks","selectedIndex","dispatchEvent","storeInput","updateInput","notifySelected","banner","commitTitle","setModalStatus","success","modal","ssoPrompt","link","prompt","dialogClass","sso","external","ssoComplete","updateExpiresAroundTag","expiresAround","expiryTag","dialogEl","fetchSsoStatus","sessionTag","HTMLLinkElement","expiresSoon","expiresTag","Date","getTime","opener","close","fallback","activeSsoPrompt","clearActiveSsoPrompt","then","catch","options","clonedDetails","dialogTemplate","detailsDialog","detailsClass","label","labelledBy","errorSpan","ResponseError","Error","policyName","serverXSafeHTMLPolicy","ghTrustedTypes","createPolicy","createHTML","s","trustedTypesPolicy","apply","policy","verifyResponseHtmlSafeNonce","nonces","allowJson","contentType","startsWith","responseNonce","getDocumentHtmlSafeNonces","silenceErrorReporting","request","Request","statusText","trustedHTML","timeBetweenRequests","acceptedStatusCodes","pollStatusCodes","poll","wait","fetchRetry","fetchOptions","attempt","retry","reject","result"],"sourceRoot":""}