{"version":3,"file":"metered-enterprise-server-licenses-xxxxxxxxxxxx.js","mappings":"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","sources":["ui/packages/metered-enterprise-server-licenses/MeteredEnterpriseServerLicenses.tsx","ui/packages/metered-enterprise-server-licenses/utils/text.ts","ui/packages/metered-enterprise-server-licenses/components/MeteredEnterpriseServerLicense.tsx","ui/packages/metered-enterprise-server-licenses/metered-enterprise-server-licenses.ts","ui/packages/react-core/deferred-registry.ts","ui/packages/react-core/react-partial-anchor.ts","ui/packages/react-core/react-partial-registry.ts","ui/packages/react-core/ReactPartialElement.tsx","ui/packages/react-core/register-partial.ts","ui/packages/react-profiling-mode/src/index.ts","ui/packages/verified-fetch/verified-fetch.ts","ui/packages/react-core/PartialRouter.tsx","ui/packages/react-core/PartialEntry.tsx","ui/packages/react-core/ReactBaseElement.tsx"],"sourcesContent":["import {verifiedFetch} from '@github-ui/verified-fetch'\nimport {Box, Button, Flash, IconButton, Link, Octicon, Spinner, Text} from '@primer/react'\nimport {AlertIcon, CheckIcon, InfoIcon, ServerIcon, StopIcon, XIcon} from '@primer/octicons-react'\nimport type {Icon} from '@primer/octicons-react'\nimport {useState} from 'react'\n\nimport {MeteredEnterpriseServerLicense} from './components/MeteredEnterpriseServerLicense'\nimport type {ServerLicense} from './types/server-licenses'\nimport type {Business} from './types/business'\nimport {pluralize} from './utils/text'\n\nexport interface Props {\n  business: Business\n  consumedEnterpriseLicenses: number\n  isStafftools?: boolean\n  serverLicenses: ServerLicense[]\n  auditLogQueryUrl?: string\n}\n\nexport function MeteredEnterpriseServerLicenses({\n  business,\n  consumedEnterpriseLicenses,\n  isStafftools = false,\n  serverLicenses: initialServerLicenses = [],\n  auditLogQueryUrl = '',\n}: Props) {\n  const meteredServerLicensesBaseUrl = isStafftools\n    ? `/stafftools/enterprises/${business.slug}/metered_server_licenses`\n    : `/enterprises/${business.slug}/metered_server_licenses`\n\n  const activeServerLicense = initialServerLicenses?.[0]\n  // setup warning banner if there is a mismatch between the active license seat count and the current GHEC user count\n  const activeLicenseSeatCountMismatch = activeServerLicense?.seats !== consumedEnterpriseLicenses\n\n  const [serverLicenses, setServerLicenses] = useState(initialServerLicenses)\n  const [showBanner, setShowBanner] = useState<boolean>(Boolean(activeLicenseSeatCountMismatch))\n  const [bannerMessage, setBannerMessage] = useState<string>(\n    consumedEnterpriseLicenses > 0 && activeLicenseSeatCountMismatch\n      ? 'Your license usage for Enterprise Cloud has changed. Generate a new license key to update server seats.'\n      : '',\n  )\n  const [bannerVariant, setBannerVariant] = useState<'default' | 'warning' | 'danger' | 'success' | undefined>(\n    activeLicenseSeatCountMismatch ? 'warning' : undefined,\n  )\n  const [isGenerating, setIsGenerating] = useState<boolean>(false)\n\n  const showAuditLogLink = isStafftools && auditLogQueryUrl.length > 0\n\n  async function handleCreateLicense() {\n    setIsGenerating(true)\n    const response = await verifiedFetch(meteredServerLicensesBaseUrl, {method: 'POST'})\n\n    if (!response.ok) {\n      setBannerVariant('danger')\n      setBannerMessage('There was an error generating a new server license. Please try again later.')\n      setShowBanner(true)\n      setIsGenerating(false)\n      return\n    }\n\n    setBannerVariant('success')\n    setBannerMessage(\n      `New server license generated for ${pluralize(\n        consumedEnterpriseLicenses,\n        'Enterprise Cloud user',\n      )}. Upload to your server instance.`,\n    )\n    setShowBanner(true)\n\n    const serverLicense: ServerLicense = await response.json()\n    setServerLicenses([serverLicense, ...serverLicenses])\n    setIsGenerating(false)\n\n    // automatically download the generated license in a new tab (browsers will typically open/close this quickly)\n    const downloadLink = `${meteredServerLicensesBaseUrl}/${serverLicense.reference_number}`\n    window?.open(downloadLink, '_blank')?.focus()\n  }\n\n  let BannerIcon: Icon\n  switch (bannerVariant) {\n    case 'warning':\n      BannerIcon = AlertIcon\n      break\n    case 'success':\n      BannerIcon = CheckIcon\n      break\n    case 'danger':\n      BannerIcon = StopIcon\n      break\n    default:\n      BannerIcon = InfoIcon\n      break\n  }\n\n  const GeneratingLicense = () => (\n    <Box\n      className=\"Box-footer\"\n      sx={{display: 'flex', border: 0, alignItems: 'center', flexDirection: 'column', padding: '32px'}}\n      data-testid=\"generating-license\"\n    >\n      <Spinner />\n      <Text as=\"div\" sx={{paddingTop: '16px'}}>\n        Generating a new license for {pluralize(consumedEnterpriseLicenses, 'Enterprise Cloud user')}.\n      </Text>\n    </Box>\n  )\n\n  const DisplayLicenses = () => {\n    if (serverLicenses.length === 0) {\n      return (\n        <>\n          {bannerVariant === 'danger' && <Banner />}\n          <div className=\"Box-footer d-flex flex-items-center border-0\">\n            <div className=\"text-normal ml-1 pl-6\">\n              You don&apos;t have any server licenses.&nbsp;\n              {consumedEnterpriseLicenses ? (\n                <Link inline sx={{cursor: 'pointer'}} onClick={handleCreateLicense}>\n                  Generate new license\n                </Link>\n              ) : (\n                <span data-testid=\"add-cloud-users-message\">\n                  Please add users to your Enterprise Cloud account to generate a license\n                </span>\n              )}\n              .\n            </div>\n          </div>\n        </>\n      )\n    }\n\n    return (\n      <>\n        <Banner />\n        {serverLicenses.map((serverLicense, i) => (\n          <MeteredEnterpriseServerLicense\n            key={serverLicense.reference_number}\n            serverLicense={serverLicense}\n            // Only show the download link for the first license\n            showDownloadLink={i === 0}\n            meteredServerLicensesBaseUrl={meteredServerLicensesBaseUrl}\n          />\n        ))}\n      </>\n    )\n  }\n\n  const Banner = () => {\n    if (!bannerMessage || !bannerVariant || !showBanner) return null\n\n    return (\n      <Flash\n        data-testid=\"license-status-banner\"\n        variant={bannerVariant}\n        sx={{\n          display: 'flex',\n          alignItems: 'center',\n          borderRadius: '0',\n          borderTop: '0',\n          borderLeft: '0',\n          borderRight: '0',\n        }}\n      >\n        {BannerIcon && <Octicon aria-label=\"Alert icon\" icon={BannerIcon} />}\n        <span className=\"flex-1 pl-3\">{bannerMessage}</span>\n        {bannerVariant === 'warning' ? (\n          <Button\n            aria-label=\"Generate new license\"\n            onClick={() => handleCreateLicense()}\n            sx={{svg: {color: 'black', margin: 0}}}\n          >\n            Generate new license\n          </Button>\n        ) : (\n          // eslint-disable-next-line primer-react/a11y-remove-disable-tooltip\n          <IconButton\n            unsafeDisableTooltip={true}\n            variant=\"invisible\"\n            aria-label=\"Close\"\n            icon={XIcon}\n            onClick={() => setShowBanner(false)}\n            size=\"small\"\n            sx={{svg: {color: 'black', margin: 0}}}\n          />\n        )}\n      </Flash>\n    )\n  }\n\n  return (\n    <div className=\"Box mb-4 rounded-2\">\n      <div className=\"Box-header d-flex flex-row flex-items-center gap-2\">\n        <div className=\"p-2 bgColor-default border rounded-2\">\n          <Octicon icon={ServerIcon} className=\"d-block\" size={16} />\n        </div>\n        <div className=\"flex-1 d-flex flex-row flex-items-center gap-2\">\n          <h3 className=\"text-normal\">Enterprise Server licenses</h3>\n        </div>\n        {showAuditLogLink && <Link href={auditLogQueryUrl}>Audit Log</Link>}\n      </div>\n      {isGenerating ? <GeneratingLicense /> : <DisplayLicenses />}\n    </div>\n  )\n}\n\ntry{ MeteredEnterpriseServerLicenses.displayName ||= 'MeteredEnterpriseServerLicenses' } catch {}\ntry{ GeneratingLicense.displayName ||= 'GeneratingLicense' } catch {}\ntry{ DisplayLicenses.displayName ||= 'DisplayLicenses' } catch {}\ntry{ Banner.displayName ||= 'Banner' } catch {}","export function pluralize(count: number, singular: string, includeCount: boolean = true): string {\n  const text = count === 1 ? singular : `${singular}s`\n  return includeCount ? `${count} ${text}` : text\n}\n","import {Link} from '@primer/react'\n\nimport type {ServerLicense} from '../types/server-licenses'\nimport {pluralize} from '../utils/text'\n\nexport interface Props {\n  meteredServerLicensesBaseUrl: string\n  serverLicense: ServerLicense\n  showDownloadLink?: boolean\n}\n\nexport function MeteredEnterpriseServerLicense({\n  serverLicense,\n  showDownloadLink = false,\n  meteredServerLicensesBaseUrl,\n}: Props) {\n  const expiresAt = new Date(Date.parse(serverLicense.expires_at))\n\n  const downloadLink = `${meteredServerLicensesBaseUrl}/${serverLicense.reference_number}`\n\n  return (\n    <div className=\"Box-row d-flex flex-items-center color-fg-muted\">\n      <div className=\"Box-title flex-1 ml-1 pl-6\">\n        {serverLicense.reference_number}\n        <div className=\"text-small text-normal\">Valid until {expiresAt.toDateString()}</div>\n      </div>\n      <div className=\"flex-1 text-center\">\n        <b>{serverLicense.seats}</b> {pluralize(serverLicense.seats, 'seat', false)}\n      </div>\n      <div className=\"flex-1\">\n        <div className=\"d-flex flex-justify-end\">\n          {showDownloadLink && (\n            <Link href={downloadLink} className=\"Link--inTextBlock\" download>\n              Download\n            </Link>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n\ntry{ MeteredEnterpriseServerLicense.displayName ||= 'MeteredEnterpriseServerLicense' } catch {}","import {registerReactPartial} from '@github-ui/react-core/register-partial'\nimport {MeteredEnterpriseServerLicenses} from './MeteredEnterpriseServerLicenses'\n\nregisterReactPartial('metered-enterprise-server-licenses', {\n  Component: MeteredEnterpriseServerLicenses,\n})\n","export class DeferredRegistry<T> {\n  private registrationEntries: Record<\n    string,\n    {\n      promise: Promise<T>\n      resolve?: (r: T) => void\n    }\n  > = {}\n\n  public register(name: string, registration: T) {\n    const entry = this.registrationEntries[name]\n    if (entry) {\n      entry.resolve?.(registration)\n    } else {\n      this.registrationEntries[name] = {\n        promise: Promise.resolve(registration),\n      }\n    }\n  }\n\n  public getRegistration(name: string): Promise<T> {\n    this.registrationEntries[name] ||= new Deferred()\n    return this.registrationEntries[name].promise\n  }\n}\n\nclass Deferred<T> {\n  declare promise\n  declare resolve: (r: T) => void\n\n  constructor() {\n    this.promise = new Promise<T>(resolve => {\n      this.resolve = resolve\n    })\n  }\n}\n","import type {ReactPartialAnchorElement} from '@github-ui/react-partial-anchor-element'\nimport {useCallback, useEffect, useRef, useState} from 'react'\n\ninterface ReactPartialAnchor {\n  /**\n   * DO NOT USE THIS PROPERTY DIRECTLY. It is meant to be used with useExternalAnchor and useOnAnchorClick\n   */\n  __wrapperElement: ReactPartialAnchorElement\n}\n\nexport interface ReactPartialAnchorProps {\n  reactPartialAnchor?: ReactPartialAnchor\n}\n\nexport function usePartialAnchorProps(\n  anchorElement: ReactPartialAnchorElement | undefined | null,\n): ReactPartialAnchorProps {\n  useEffect(() => {\n    const anchor = anchorElement?.anchor\n\n    if (!anchor) {\n      return\n    }\n\n    if ('disabled' in anchor) {\n      anchor.disabled = false\n    }\n    anchor.classList.remove('cursor-wait')\n  }, [anchorElement])\n\n  if (!anchorElement) {\n    return {}\n  }\n\n  return {\n    reactPartialAnchor: {\n      __wrapperElement: anchorElement,\n    },\n  }\n}\n\nexport function useExternalAnchor(reactPartialAnchor: ReactPartialAnchor) {\n  const ref = useRef(reactPartialAnchor.__wrapperElement.anchor || null)\n  const [open, setOpen] = useState(false)\n\n  const onClick = useCallback(() => {\n    // toggle the open state when clicked\n    setOpen(!open)\n  }, [open, setOpen])\n\n  useEffect(() => {\n    if (!ref.current) return\n\n    ref.current.setAttribute('aria-expanded', open.toString())\n    ref.current.setAttribute('aria-haspopup', 'true')\n  }, [ref, open])\n\n  useOnAnchorClick(reactPartialAnchor, onClick)\n\n  return {\n    ref,\n    open,\n    setOpen,\n  }\n}\n\nexport function useOnAnchorClick(reactPartialAnchor: ReactPartialAnchor, onClick: (event: MouseEvent) => void) {\n  const ref = useRef(reactPartialAnchor.__wrapperElement.anchor)\n\n  useEffect(() => {\n    const element = ref.current\n    if (!element) {\n      return\n    }\n\n    element.addEventListener('click', onClick)\n    return () => element.removeEventListener('click', onClick)\n  }, [ref, onClick])\n}\n\nexport type PropsWithPartialAnchor<T> = T & Required<ReactPartialAnchorProps>\n","import {DeferredRegistry} from './deferred-registry'\n\nexport interface PartialRegistration {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  Component: React.ComponentType<any>\n}\n\nexport const partialRegistry = new DeferredRegistry<PartialRegistration>()\n\nexport function getReactPartial(appName: string) {\n  return partialRegistry.getRegistration(appName)\n}\n","import {controller} from '@github/catalyst'\nimport {getReactPartial} from './react-partial-registry'\nimport type {EmbeddedPartialData} from './embedded-data-types'\nimport {ReactBaseElement} from './ReactBaseElement'\nimport {PartialEntry} from './PartialEntry'\nimport type {ReactPartialAnchorElement} from '@github-ui/react-partial-anchor-element'\n\n// What is this silliness? Is it react or a web component?!\n// It's a web component we use to bootstrap react partials within the monolith.\n@controller\nclass ReactPartialElement extends ReactBaseElement<EmbeddedPartialData> {\n  nameAttribute = 'partial-name'\n\n  async getReactNode(embeddedData: EmbeddedPartialData) {\n    const {Component} = await getReactPartial(this.name)\n\n    // Some React Partials will be wrapped in a react-partial-anchor, which is used to conditionally render the Partial\n    const anchorElement = this.closest<ReactPartialAnchorElement>('react-partial-anchor')\n\n    return (\n      <PartialEntry\n        partialName={this.name}\n        embeddedData={embeddedData}\n        Component={Component}\n        wasServerRendered={this.hasSSRContent}\n        ssrError={this.ssrError}\n        anchorElement={anchorElement}\n      />\n    )\n  }\n}\n","import {partialRegistry, type PartialRegistration} from './react-partial-registry'\n// Import the web component to get it registered on the window\nimport './ReactPartialElement'\n\n// NOTE: if the signature of this method changes, also update the react-partial-name ESLint rule\n// /workspaces/github/ui/packages/eslint-plugin-github-monorepo/rules/react-partial-name.js\nexport function registerReactPartial(name: string, registration: PartialRegistration) {\n  partialRegistry.register(name, registration)\n}\n","import safeStorage from '@github-ui/safe-storage'\n\nconst {getItem, setItem, removeItem} = safeStorage('localStorage')\nconst REACT_PROFILING_ENABLED = 'REACT_PROFILING_ENABLED'\n\ninterface ReactProfilingModeMethods {\n  enable: () => void\n  disable: () => void\n  isEnabled: () => boolean\n}\n\nconst ReactProfilingMode: ReactProfilingModeMethods = {\n  enable: () => setItem(REACT_PROFILING_ENABLED, 'true'),\n  disable: () => removeItem(REACT_PROFILING_ENABLED),\n  isEnabled: () => !!getItem(REACT_PROFILING_ENABLED),\n}\n\nexport default ReactProfilingMode\n","/**\n * A Fetch function which will automatically add the correct headers for\n * making requests to GitHub application servers as long as the associated controller methods allow it.\n * Track down the associated controller method and confirm the controller includes\n * ApplicationController::VerifiedFetchDependency as well as `allow_verified_fetch only:`\n * to the relevant controller methods.\n *\n * ## Example\n *\n *     const onClick = async () => {\n *       const resp = await verifiedFetch('/foo', {method: 'POST'})\n *       if (resp.ok) console.log('The response was', await resp.text())\ntest.\n *     }\n */\nexport function verifiedFetch(path: string, init: RequestInit = {}): Promise<Response> {\n  assertRelativePathOrSameOrigin(path)\n\n  const headers: HeadersInit = {\n    ...init.headers,\n    'GitHub-Verified-Fetch': 'true',\n    'X-Requested-With': 'XMLHttpRequest',\n  }\n\n  return fetch(path, {...init, headers})\n}\n\nexport interface JSONRequestInit extends Omit<RequestInit, 'body'> {\n  body?: unknown\n}\n\nfunction assertRelativePathOrSameOrigin(path: string) {\n  if (process.env.NODE_ENV === 'test' && !window.location.origin) return\n  const url = new URL(path, window.location.origin)\n  if (url.origin !== window.location.origin) {\n    throw new Error('Can not make cross-origin requests from verifiedFetch')\n  }\n}\n\n/**\n * A Fetch function which will automatically add the correct headers for\n * making JSON requests\n *\n * Will also `JSON.stringify` the request body if provided.\n\n * ## Example\n *\n *     const onClick = async () => {\n *       const resp = await verifiedFetchJSON('/foo', {body: {foo: 'bar'}, method: 'POST'})\n *       if (resp.ok) console.log('The response was', await resp.json())\n *     }\n */\nexport function verifiedFetchJSON(path: string, init?: JSONRequestInit): Promise<Response> {\n  const initHeaders: HeadersInit = init?.headers ?? {}\n\n  const headers: HeadersInit = {\n    ...initHeaders,\n    Accept: 'application/json',\n    'Content-Type': 'application/json',\n  }\n\n  const body = init?.body ? JSON.stringify(init.body) : undefined\n\n  return verifiedFetch(path, {...init, body, headers})\n}\n\n/**\n * A Fetch function which will automatically add the GitHub-Is-React header for\n * making JSON requests. It will in turn call verifiedFetchJSON.\n *\n * Using this in React components to fetch data enables us to track these\n * requests in Datadog in the request.dist.referrer metric.\n */\nexport function reactFetch(path: string, init: RequestInit = {}): Promise<Response> {\n  const headers: HeadersInit = {\n    ...init.headers,\n    'GitHub-Is-React': 'true',\n  }\n\n  return verifiedFetch(path, {...init, headers})\n}\n\n/**\n * A Fetch function which will automatically add the GitHub-Is-React header for\n * making JSON requests. It will in turn call verifiedFetchJSON.\n *\n * Using this in React components to fetch data enables us to track these\n * requests in Datadog in the request.dist.referrer metric.\n */\nexport function reactFetchJSON(path: string, init?: JSONRequestInit): Promise<Response> {\n  const initHeaders: HeadersInit = init?.headers ?? {}\n\n  const headers: HeadersInit = {\n    ...initHeaders,\n    'GitHub-Is-React': 'true',\n  }\n\n  return verifiedFetchJSON(path, {...init, headers})\n}\n","import {useState} from 'react'\nimport type {BrowserHistory, MemoryHistory} from '@remix-run/router'\nimport {Router} from 'react-router-dom'\n// eslint-disable-next-line no-restricted-imports\nimport {useHydratedEffect} from '@github-ui/use-hydrated-effect'\n\ntype Props = {\n  children: React.ReactNode\n  history: BrowserHistory | MemoryHistory\n}\n\nexport function PartialRouter({children, history}: Props) {\n  const [state, setState] = useState({\n    location: history.location,\n  })\n\n  useHydratedEffect(() => history.listen(setState), [history])\n\n  return (\n    <Router location={state.location} navigator={history}>\n      {children}\n    </Router>\n  )\n}\n\ntry{ PartialRouter.displayName ||= 'PartialRouter' } catch {}","// Think of this as the entry point into the framework\nimport React from 'react'\nimport type {EmbeddedPartialData} from './embedded-data-types'\nimport {BaseProviders} from './BaseProviders'\nimport type {BrowserHistory} from '@remix-run/router'\nimport {createMemoryHistory} from '@remix-run/router'\nimport {AppContextProvider} from './AppContextProvider'\nimport {PartialRouter} from './PartialRouter'\nimport {CommonElements} from './CommonElements'\nimport {createBrowserHistory} from './create-browser-history'\nimport type {ReactPartialAnchorElement} from '@github-ui/react-partial-anchor-element'\nimport {usePartialAnchorProps} from './react-partial-anchor'\n\ninterface Props {\n  partialName: string\n  embeddedData: EmbeddedPartialData\n  Component: React.ComponentType\n  wasServerRendered: boolean\n  ssrError?: HTMLScriptElement\n  anchorElement?: ReactPartialAnchorElement | null\n}\n\nexport function PartialEntry({\n  partialName,\n  embeddedData,\n  Component,\n  wasServerRendered,\n  ssrError,\n  anchorElement,\n}: Props) {\n  // Create a ref to track the browser history:\n  const historyRef = React.useRef<BrowserHistory>()\n  const window = globalThis.window as Window | undefined\n\n  // For linking to work, we can just pass a dummy pathname here. We may consider plumbing the actual path in\n  if (!historyRef.current) {\n    historyRef.current = !window\n      ? createMemoryHistory({initialEntries: [{pathname: '/'}]})\n      : createBrowserHistory({window})\n  }\n  const history = historyRef.current\n  const partialAnchorProps = usePartialAnchorProps(anchorElement)\n\n  // Wrap the partial in an AppContextProvider and static Router so that react-core links\n  // will be functional.\n  return (\n    <BaseProviders appName={partialName} wasServerRendered={wasServerRendered}>\n      <AppContextProvider history={history} routes={[]}>\n        <PartialRouter history={history}>\n          <Component {...embeddedData.props} {...(partialAnchorProps as object)} />\n          <CommonElements ssrError={ssrError} />\n        </PartialRouter>\n      </AppContextProvider>\n    </BaseProviders>\n  )\n}\n\ntry{ PartialEntry.displayName ||= 'PartialEntry' } catch {}","import {target} from '@github/catalyst'\nimport {createRoot, hydrateRoot} from 'react-dom/client'\nimport type {createRoot as createRootType, hydrateRoot as hydrateRootType, Root} from 'react-dom/client'\nimport React from 'react'\nimport ReactProfilingMode from '@github-ui/react-profiling-mode'\nimport {EXPECTED_ERRORS} from './expected-errors'\nimport {sendStats} from '@github-ui/stats'\n\ntype ReactDOM = {\n  createRoot: typeof createRootType\n  hydrateRoot: typeof hydrateRootType\n}\n\nconst REACT_INVARIANT_ERROR_REGEX = /Minified React error #(?<invariant>\\d+)/\n\nexport abstract class ReactBaseElement<T> extends HTMLElement {\n  @target embeddedData: HTMLScriptElement | undefined\n  @target ssrError: HTMLScriptElement | undefined\n  @target reactRoot: HTMLElement | undefined\n  private root: Root | undefined\n\n  abstract nameAttribute: string\n  abstract getReactNode(embeddedData: T): Promise<React.ReactNode>\n\n  protected get name() {\n    return this.getAttribute(this.nameAttribute) as string\n  }\n\n  private get embeddedDataText() {\n    const text = this.embeddedData?.textContent\n\n    if (!text) {\n      throw new Error(`No embedded data provided for react element ${this.name}`)\n    }\n\n    return text\n  }\n\n  get hasSSRContent() {\n    return this.getAttribute('data-ssr') === 'true'\n  }\n\n  connectedCallback() {\n    this.renderReact()\n  }\n\n  disconnectedCallback() {\n    this.root?.unmount()\n    this.root = undefined\n  }\n\n  private async renderReact() {\n    if (!this.reactRoot) throw new Error('No react root provided')\n    let reactDom: ReactDOM = {\n      createRoot,\n      hydrateRoot,\n    }\n\n    // Override the react-dom import if we're in profiling mode\n    if (ReactProfilingMode.isEnabled()) {\n      reactDom = await this.getReactDomWithProfiling()\n    }\n\n    const embeddedData = JSON.parse(this.embeddedDataText) as T\n    const ssrErrorText = this.ssrError?.textContent\n    const node = await this.getReactNode(embeddedData)\n    const baseNode = <React.StrictMode>{node}</React.StrictMode>\n\n    if (ssrErrorText) {\n      this.logSSRError(ssrErrorText)\n    }\n\n    if (this.hasSSRContent) {\n      /**\n       * Styled-components automatically looks for style tags to hydrate on first page load, but will not detect them\n       * if they are added after the initial page load. This causes a hydration error because React isn't expecting\n       * a style tag within the app. To work around this, we need to manually move the style tags to the head before\n       * hydrating the app.\n       *\n       * During hydration, styled-components will create a new style tag which matches the one we moved to the head.\n       * This means that after hydration, we can safely remove the style tag we manually moved to the head.\n       */\n      const styles = this.querySelector('style[data-styled=\"true\"]')\n      if (styles) document.head.appendChild(styles)\n\n      // Hydrate the react app\n      // onRecoverableError is disabled until we have a react version with this fix in:\n      // https://github.com/facebook/react/pull/25692\n      this.root = reactDom.hydrateRoot(this.reactRoot, baseNode, {\n        onRecoverableError: error => {\n          if (!(error instanceof Error)) return\n\n          const match = REACT_INVARIANT_ERROR_REGEX.exec(error.message)\n          const invariant = String(match?.groups?.invariant)\n\n          sendStats({\n            incrementKey: 'REACT_HYDRATION_ERROR',\n            incrementTags: {\n              appName: this.name,\n              invariant,\n            },\n          })\n        },\n      })\n\n      // Remove the manually moved style tag after hydration\n      if (styles) {\n        // Wait until things are idle to remove the style tag. If we do it immediately, we can cause a flash of unstyled content.\n        requestIdleCallback(() => {\n          // styles could have already been removed by Turbo if a navigation happens quickly. Only remove it from the DOM if it's still there.\n          styles.parentElement?.removeChild(styles)\n        })\n      }\n    } else {\n      this.root = reactDom.createRoot(this.reactRoot)\n      this.root.render(baseNode)\n    }\n\n    this.classList.add('loaded')\n  }\n\n  private getReactDomWithProfiling() {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return import('react-dom/profiling') as any as Promise<ReactDOM>\n  }\n\n  private logSSRError(ssrErrorText: string) {\n    if (EXPECTED_ERRORS[ssrErrorText]) {\n      // eslint-disable-next-line no-console\n      return console.error('SSR failed with an expected error:', EXPECTED_ERRORS[ssrErrorText])\n    }\n\n    try {\n      const error = JSON.parse(ssrErrorText) as PlatformJavascriptError\n      const stacktrace = parseFailbotStacktrace(error)\n      // eslint-disable-next-line no-console\n      console.error('Error During Alloy SSR:', `${error.type}: ${error.value}\\n`, error, stacktrace)\n    } catch {\n      /**\n       * In the event we couldn't log the error, we should not break the application\n       */\n      // eslint-disable-next-line no-console\n      console.error('Error During Alloy SSR:', ssrErrorText, 'unable to parse as json')\n    }\n  }\n}\n\nfunction parseFailbotStacktrace(error: PlatformJavascriptError) {\n  if (!error.stacktrace) return ''\n  let prefix = '\\n '\n  const stack = error.stacktrace.map((frame: PlatformStackframe) => {\n    const {function: func, filename, lineno, colno} = frame\n    const line = `${prefix} at ${func} (${filename}:${lineno}:${colno})`\n    prefix = ' '\n    return line\n  })\n  return stack.join('\\n')\n}\n\ntry{ REACT_INVARIANT_ERROR_REGEX.displayName ||= 'REACT_INVARIANT_ERROR_REGEX' } catch {}"],"names":["GeneratingLicense","DisplayLicenses","Banner","pluralize","count","singular","includeCount","text","MeteredEnterpriseServerLicense","serverLicense","showDownloadLink","meteredServerLicensesBaseUrl","expiresAt","Date","parse","expires_at","downloadLink","reference_number","div","className","toDateString","b","seats","Link","href","download","displayName","MeteredEnterpriseServerLicenses","business","consumedEnterpriseLicenses","isStafftools","serverLicenses","initialServerLicenses","auditLogQueryUrl","BannerIcon","slug","activeServerLicense","activeLicenseSeatCountMismatch","setServerLicenses","useState","showBanner","setShowBanner","Boolean","bannerMessage","setBannerMessage","bannerVariant","setBannerVariant","undefined","isGenerating","setIsGenerating","showAuditLogLink","length","handleCreateLicense","response","verifiedFetch","method","ok","json","window","open","focus","AlertIcon","CheckIcon","StopIcon","InfoIcon","Flash","data-testid","variant","sx","display","alignItems","borderRadius","borderTop","borderLeft","borderRight","Octicon","aria-label","icon","span","Button","onClick","svg","color","margin","IconButton","unsafeDisableTooltip","XIcon","size","ServerIcon","h3","Box","border","flexDirection","padding","Spinner","Text","as","paddingTop","inline","cursor","map","i","registerReactPartial","Component","DeferredRegistry","register","name","registration","entry","registrationEntries","resolve","promise","Promise","getRegistration","Deferred","constructor","usePartialAnchorProps","anchorElement","useEffect","anchor","disabled","classList","remove","reactPartialAnchor","__wrapperElement","useExternalAnchor","ref","useRef","setOpen","useCallback","current","setAttribute","toString","useOnAnchorClick","element","addEventListener","removeEventListener","partialRegistry","ReactPartialElement","ReactBaseElement","getReactNode","embeddedData","appName","closest","PartialEntry","partialName","wasServerRendered","hasSSRContent","ssrError","nameAttribute","controller","getItem","setItem","removeItem","safeStorage","REACT_PROFILING_ENABLED","enable","disable","isEnabled","path","init","assertRelativePathOrSameOrigin","url","URL","location","origin","headers","fetch","verifiedFetchJSON","Accept","body","JSON","stringify","reactFetch","reactFetchJSON","PartialRouter","children","history","state","setState","useHydratedEffect","listen","Router","navigator","historyRef","React","globalThis","createBrowserHistory","createMemoryHistory","initialEntries","pathname","partialAnchorProps","BaseProviders","AppContextProvider","routes","props","CommonElements","REACT_INVARIANT_ERROR_REGEX","HTMLElement","getAttribute","embeddedDataText","textContent","connectedCallback","renderReact","disconnectedCallback","root","unmount","reactRoot","reactDom","createRoot","hydrateRoot","ReactProfilingMode","getReactDomWithProfiling","ssrErrorText","node","baseNode","logSSRError","styles","querySelector","document","head","appendChild","onRecoverableError","error","Error","match","exec","message","invariant","String","groups","sendStats","incrementKey","incrementTags","requestIdleCallback","parentElement","removeChild","render","add","EXPECTED_ERRORS","console","stacktrace","parseFailbotStacktrace","prefix","stack","function","func","filename","lineno","colno","frame","line","join","type","value","target"],"sourceRoot":""}