"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["audit-log-stafftools-async"],{6409:(t,e,s)=>{var r=s(39595);s(93707);var i=s(94147);function n(t,e,s,r){var i,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,s,r);else for(var o=t.length-1;o>=0;o--)(i=t[o])&&(a=(n<3?i(a):n>3?i(e,s,a):i(e,s))||a);return n>3&&a&&Object.defineProperty(e,s,a),a}let a=class AsyncAuditLogElement extends HTMLElement{closeWarning(){this.warning.hidden=!0}showWarning(){this.warning.hidden=!1}closeError(){this.error.hidden=!0}showError(){this.error.hidden=!1}closeResultsError(){this.resultsError.hidden=!0}showResults(t){try{this.targetFetch=new i.T,this.targetFetch.setAttribute("src",t),this.appendChild(this.targetFetch)}catch(t){this.showError();return}}async connectedCallback(){await this.startAndFetchAsyncQuery()}async startAndFetchAsyncQuery(){let t;let e=this.spinner,s=document.querySelector(".js-data-url-csrf"),r=document.querySelector(".js-download-button");function i(t){e.hidden=!t}let n=this.getAttribute("data-url"),a=await fetch(new Request(n,{method:"POST",mode:"same-origin",headers:{Accept:"application/json","Scoped-CSRF-Token":s.value,"X-Requested-With":",XMLHttpRequest"}}));if(a.ok)t=await a.json();else if(429===a.status){this.showWarning();return}else{this.showError();return}i(!0);try{await function t(e,s){return new Promise((r,i)=>{setTimeout(async()=>{let n=new Request(e);n.headers.append("X-Requested-With","XMLHttpRequest");let a=await fetch(n);200===a.status?r(a):202===a.status?r(t(e,s)):i(a)},s)})}(t.status_url,2e3)}catch(t){i(!1),this.showError();return}i(!1),this.showResults(t.results_url),r.hidden=!1}};n([r.aC],a.prototype,"spinner",void 0),n([r.aC],a.prototype,"warning",void 0),n([r.aC],a.prototype,"error",void 0),n([r.aC],a.prototype,"resultsError",void 0),a=n([r.p_],a)},94147:(t,e,s)=>{s.d(e,{T:()=>include_fragment_element_IncludeFragmentElement});var r,i,n,a,o,l,c,h,d=function(t,e,s,r){if("a"===s&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?r:"a"===s?r.call(t):r?r.value:e.get(t)},u=function(t,e,s,r,i){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,s):i?i.value=s:e.set(t,s),s};let m=new WeakMap,f=null;let include_fragment_element_IncludeFragmentElement=class include_fragment_element_IncludeFragmentElement extends HTMLElement{constructor(){super(...arguments),r.add(this),i.set(this,!1),n.set(this,new IntersectionObserver(t=>{for(let e of t)if(e.isIntersecting){let{target:t}=e;if(d(this,n,"f").unobserve(t),!(t instanceof include_fragment_element_IncludeFragmentElement))return;"lazy"===t.loading&&d(this,r,"m",a).call(this)}},{rootMargin:"0px 0px 256px 0px",threshold:.01}))}static define(t="include-fragment",e=customElements){return e.define(t,this),this}static setCSPTrustedTypesPolicy(t){f=null===t?t:Promise.resolve(t)}static get observedAttributes(){return["src","loading"]}get src(){let t=this.getAttribute("src");if(!t)return"";{let e=this.ownerDocument.createElement("a");return e.href=t,e.href}}set src(t){this.setAttribute("src",t)}get loading(){return"lazy"===this.getAttribute("loading")?"lazy":"eager"}set loading(t){this.setAttribute("loading",t)}get accept(){return this.getAttribute("accept")||""}set accept(t){this.setAttribute("accept",t)}get data(){return d(this,r,"m",l).call(this)}attributeChangedCallback(t,e){"src"===t?this.isConnected&&"eager"===this.loading&&d(this,r,"m",a).call(this):"loading"===t&&this.isConnected&&"eager"!==e&&"eager"===this.loading&&d(this,r,"m",a).call(this)}connectedCallback(){if(!this.shadowRoot){this.attachShadow({mode:"open"});let t=document.createElement("style");t.textContent=":host {display: block;}",this.shadowRoot.append(t,document.createElement("slot"))}this.src&&"eager"===this.loading&&d(this,r,"m",a).call(this),"lazy"===this.loading&&d(this,n,"f").observe(this)}request(){let t=this.src;if(!t)throw Error("missing src");return new Request(t,{method:"GET",credentials:"same-origin",headers:{Accept:this.accept||"text/html"}})}load(){return d(this,r,"m",l).call(this)}fetch(t){return fetch(t)}refetch(){m.delete(this),d(this,r,"m",a).call(this)}};i=new WeakMap,n=new WeakMap,r=new WeakSet,a=async function(){if(!d(this,i,"f")){u(this,i,!0,"f"),d(this,n,"f").unobserve(this);try{let t=await d(this,r,"m",o).call(this);if(t instanceof Error)throw t;let e=document.createElement("template");e.innerHTML=t;let s=document.importNode(e.content,!0);if(!this.dispatchEvent(new CustomEvent("include-fragment-replace",{cancelable:!0,detail:{fragment:s}}))){u(this,i,!1,"f");return}this.replaceWith(s),this.dispatchEvent(new CustomEvent("include-fragment-replaced"))}catch(t){this.classList.add("is-error")}finally{u(this,i,!1,"f")}}},o=async function(){let t=this.src,e=m.get(this);if(e&&e.src===t)return e.data;{let e;return e=t?d(this,r,"m",h).call(this):Promise.reject(Error("missing src")),m.set(this,{src:t,data:e}),e}},l=async function(){let t=await d(this,r,"m",o).call(this);if(t instanceof Error)throw t;return t.toString()},c=async function(t){for(let e of(await new Promise(t=>setTimeout(t,0)),t))this.dispatchEvent(new Event(e))},h=async function(){try{var t;await d(this,r,"m",c).call(this,["loadstart"]);let e=await this.fetch(this.request());if(200!==e.status)throw Error(`Failed to load resource: the server responded with a status of ${e.status}`);let s=e.headers.get("Content-Type");if(!((t=this.accept)&&t.split(",").find(t=>t.match(/^\s*\*\/\*/)))&&(!s||!s.includes(this.accept?this.accept:"text/html")))throw Error(`Failed to load resource: expected ${this.accept||"text/html"} but was ${s}`);let i=await e.text(),n=i;return f&&(n=(await f).createHTML(i,e)),d(this,r,"m",c).call(this,["load","loadend"]),n}catch(t){throw d(this,r,"m",c).call(this,["error","loadend"]),t}};let p="undefined"!=typeof globalThis?globalThis:window;try{p.IncludeFragmentElement=include_fragment_element_IncludeFragmentElement.define()}catch(t){if(!(p.DOMException&&t instanceof DOMException&&"NotSupportedError"===t.name)&&!(t instanceof ReferenceError))throw t}}},t=>{var e=e=>t(t.s=e);t.O(0,["vendors-node_modules_dompurify_dist_purify_js","vendors-node_modules_github_selector-observer_dist_index_esm_js","vendors-node_modules_lit-html_lit-html_js","vendors-node_modules_primer_behaviors_dist_esm_dimensions_js-node_modules_delegated-events_di-94a48b","vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_stacktrace-parser_dist_s-b430370","app_assets_modules_github_filter-input_ts","app_assets_modules_github_audit-log_audit-log-search-input_ts"],()=>e(6409)),t.O()}]);
//# sourceMappingURL=audit-log-stafftools-async-d3c65873da91.js.map