---
glob: '**/*{.html,*}[!.atom,!.text,!.js,!.svg,!.rb].erb'
inherit_gem:
  erblint-github:
    - config/accessibility.yml
  primer_view_components:
    - lib/primer/view_components/linters/accessibility.yml
linters:
  FinalNewline:
    enabled: false
  SpaceAroundErbTag:
    enabled: false
  RightTrim:
    enabled: false
  AllowedScriptType:
    enabled: true
    allowed_types:
      - 'application/ld+json'
      - 'application/json'
      - 'text/javascript'
      - 'text/html'
    allow_blank: false
    disallow_inline_scripts: false
  ClosingErbTagIndent:
    enabled: false
  SpaceIndentation:
    enabled: false
  TrailingWhitespace:
    enabled: false
  SpaceInHtmlTag:
    enabled: false
  ExtraNewline:
    enabled: false
  SelfClosingTag:
    enabled: true
  NoJavascriptTagHelper:
    enabled: false
  ErbSafety:
    enabled: false
  ButtonHasType:
    enabled: true
  BooleanAttributes:
    enabled: true
  RequiredAttribute:
    enabled: true
  DropdownDividerRole:
    enabled: true
  ProperTagNesting:
    enabled: true
  NoUnusedDisable:
    enabled: true
  DeprecatedInPrimerCounter:
    enabled: true
    ignore_files:
      - 'app/views/mailers/*'
      # the .erblint component helper is not able to parse the render components
      # passed as arguments to a parent render call, skipping until an update
      # can be made to the helper method to handle this case
      - 'app/components/branch/source_branch/branch_select_component.html.erb'
    ignore_classes:
      - container
  DeprecatedCustomCss:
    enabled: true
    ignore_files:
      - 'app/views/biztools/*'
      - 'app/views/mailers/*'
      - 'app/views/stafftools/*'
      # the .erblint component helper is not able to parse the render components
      # passed as arguments to a parent render call, skipping until an update
      # can be made to the helper method to handle this case
      - 'app/components/branch/source_branch/branch_select_component.html.erb'
  # enable this later when we are ready to start introducing count comments to files
  # https://github.com/github/github/pull/318831
  # I18nHardcodedStringCounter:
    # enabled: true
  FlexbugNumberNine:
    enabled: true
  UseSignInSignOutNotLogInLogOut:
    enabled: true
  GitHubHasCorrectCapitalization:
    enabled: true
  RequireInputAutocomplete:
    enabled: false
  NoGraphqlFragments:
    enabled: true
  NoContentForScripts:
    enabled: true
  TooltipHasRequiredAttributes:
    enabled: true
  GoogleAnalyticsDeprecation:
    enabled: true
  # Dotcom-housed a11y lint rules.
  # Any new a11y lint rules should be housed in `erblint-github` or PVC!
  A11yDetailsDialogMigration:
    enabled: true
    exclude:
      # the .erblint component helper is not able to parse the render components
      # passed as arguments to a parent render call, skipping until an update
      # can be made to the helper method to handle this case
      - 'app/components/branch/source_branch/branch_select_component.html.erb'
  A11yNoRogueRoleEqualsTooltip: # this is dotcom-specific and should not be moved.
    enabled: true
  A11yToastMigration:
    enabled: true
  A11yUnderlineLinksInTextBlock:
    enabled: true
    exclude:
      - 'app/views/mailers/*'
      - 'app/views/layouts/marketplace_mailer.html.erb'
  A11yExperimentalDialogMigration:
    enabled: false
  # web-systems linters
  DataHotkey:
    enabled: true
  # Proxima tenancy namespacing linters
  NoCurrentUserLogin:
    enabled: true
  # primer_view_components linters
  ButtonComponentMigrationCounter:
    enabled: true
  FlashMigrationCounter:
    enabled: true
  LabelComponentMigrationCounter:
    enabled: true
  ClipboardCopyComponentMigrationCounter:
    enabled: true
  SuperInComponentTemplates:
    enabled: true
  DeprecatedComponentsCounter:
    enabled: true
  DisallowActionList:
    enabled: true
    ignore_files:
      - app/components/primer/*.html.erb
      - app/components/primer/**/*.html.erb
      - app/components/pull_requests/file_tree/*.html.erb
      - app/views/site/header/_blackbird_search.html.erb
      - app/components/site/header/user_drawer_side_panel_component.html.erb
      - app/components/site/header/user_status_component.html.erb
      - app/components/code_scanning/tool_status/header_component.html.erb
      - app/components/actions/runner_filter_component.html.erb
  TestSelectorAttributes:
    enabled: true
  # We use .rubocop.yml to look at erb files also
  Rubocop:
    enabled: true
    rubocop_config:
      require:
        - './config/initializers/_github_inflections'
        - './test/rubocop/erb_parser'
        - './test/rubocop/cop/github'
      inherit_gem:
        primer_view_components: lib/rubocop/config/default.yml
      AllCops:
        DisabledByDefault: true
      Primer/DeprecatedArguments:
        Enabled: false
      Primer/DeprecatedComponents:
        Enabled: false
      GitHub/DoNotAllowLogin:
        Enabled: true
        Exclude:
          # Stafftools are exempt from this rule
          - app/components/stafftools/**/*
          - app/view_models/stafftools/**/*
          - app/views/stafftools/**/*
          - app/controllers/stafftools/**/*

          # Devtools are exempt from this rule
          - app/components/devtools/**/*
          - app/view_models/devtools/**/*
          - app/views/devtools/**/*
          - app/controllers/devtools/**/*

          # Biztools are exempt from this rule
          - app/components/biztools/**/*
          - app/view_models/biztools/**/*
          - app/views/biztools/**/*
          - app/controllers/biztools/**/*

          # Sponsors are exempt from this rule
          - app/views/sponsors/**/*

          # The GraphQL serializer returns display_login by default for the instances in these files
          - app/views/project_settings/_user.html.erb
          - app/views/project_settings/teams.html.erb
          - app/views/project_settings/index.html.erb
          - app/views/project_settings/_search_repositories_to_link.html.erb
          - app/views/project_settings/admins.html.erb
          - app/views/comments/projects/edit/_write_content.html.erb
          - app/views/comments/team_discussions/_edit_form.html.erb
          - app/views/comments/projects/_edit_form.html.erb
          - app/views/comments/projects/edit/_tabnav.html.erb
          - app/views/hovercards/dependabot_alerts/show.html.erb
          - app/views/hovercards/users/contexts/_advisory_credits.html.erb
          - app/views/orgs/people/_member.html.erb
          - app/views/orgs/team_discussions/_new_form.html.erb
          - app/views/orgs/team_discussions/_team_discussion.html.erb
          - app/views/orgs/team_discussions/index.html.erb
          - app/views/orgs/team_discussions/show.html.erb
          - app/views/projects/_fullscreen_header.html.erb
          - app/views/projects/index.html.erb
          - app/views/projects/panes/_metadata.html.erb
          - app/views/registry_two/packages/_repo_connect_empty_state.html.erb
          - app/views/users/tabs/_projects.html.erb
          - app/views/comments/team_discussions/_comment_edit_history.html.erb
          - app/views/comments/team_discussions/edit/_write_content.html.erb

          # Owned by issues-graph team: https://github.com/github/issues-graph/issues/1603
          - app/components/tracking_blocks/tasklist_block_item_component.html.erb

          # Elasticsearch: https://github.com/github/proxima/issues/1194
          - app/views/dotcom_codesearch/_hit_user.html.erb

          - lib/tasks/enterprise_actions_init.rake
          - lib/tasks/ldap.rake
          - script/create-dependabot-fixtures
          - script/create-dummy-packages
          - script/create-perf-data
          - script/create-seed-org
          - script/create-users
          - script/generate-email-optins
          - script/gh-migrator
          - script/ghe-webhook-manage
          - script/seed-repository-topics
          - script/setup-copilot
          - script/setup-copilot-for-business
          - script/setup-copilot-for-business-signup

          # The only violations in here are hidden field tags and thus not customer-facing
          - app/views/codespaces/allow_permissions.html.erb
          - app/views/codespaces/prebuild_configurations/allow_permissions.html.erb
          - app/views/codespaces/repository_codespaces/allow_permissions.html.erb

          - app/views/codeowners/_codeowners.html.erb # We can't guarantee that #{owner} is always a user; it can also be a team https://github.com/github/proxima/issues/1675
          - app/views/stacks/stacks_instance/_stacks_progress_status.html.erb # The string interpolated var #{owner} is a string https://github.com/github/github/blob/8ffe75fded67eb6fcd0000db9b3fa88fe3d758fd/app/controllers/stacks_instance_controller.rb#L155

          # Mannequin#display_login and #login are different, and #login is necessary for this form
          - app/views/settings/organization/import_export/_reattribution_form.html.erb

      GitHub/DoNotAllowOwnerLogin:
        Enabled: true
        Exclude:
          # Stafftools are exempt from this rule
          - app/components/stafftools/**/*
          - app/view_models/stafftools/**/*
          - app/views/stafftools/**/*
          - app/controllers/stafftools/**/*

          # Devtools are exempt from this rule
          - app/components/devtools/**/*
          - app/view_models/devtools/**/*
          - app/views/devtools/**/*
          - app/controllers/devtools/**/*

          # Biztools are exempt from this rule
          - app/components/biztools/**/*
          - app/view_models/biztools/**/*
          - app/views/biztools/**/*
          - app/controllers/biztools/**/*

          # Sponsors are exempt from this rule
          - app/views/sponsors/**/*
          - app/components/sponsors/**/*

          - app/components/environments/new_secret_component.html.erb # The variable name is initialized correctly with correct display_login
          - app/components/environments/new_variable_component.html.erb # The variable name is initialized correctly with correct display_login
          - app/components/environments/secret_component.html.erb # The variable name is initialized correctly with correct display_login
          - app/components/environments/variable_component.html.erb # The variable name is initialized correctly with correct display_login
          - app/components/tracking_blocks/tasklist_block_item_component.html.erb # Owned by issues-graph team: https://github.com/github/issues-graph/issues/1603
          - app/views/editor/actions/_action.html.erb # We're passing display_login already https://github.com/github/github/blob/461a75c39bb19606d655df6085cfbb5b5c170077/app/views/editor/actions/index.html.erb#L10
          - app/views/payment_method/_paypal_fields.html.erb # We're passing display_login already https://github.com/github/github/blob/461a75c39bb19606d655df6085cfbb5b5c170077/app/view_models/billing_settings/payment_method_fields_view.rb#L45
          - app/views/editor/dev_containers/_feature.html.erb # Marketplaces is not supported in Proxima https://github.com/github/proxima/issues/1025

          # Elasticsearch: https://github.com/github/proxima/issues/1194
          - app/views/marketplace/actions/_action_link_updated.html.erb
          - app/views/marketplace/stacks/_stack_link_updated.html.erb
          - app/views/marketplace_listings/_listing_updated.html.erb

      GitHub/DoNotAllowNameWithOwner:
        Enabled: true
        Exclude:
          # Stafftools are exempt from this rule
          - app/components/stafftools/**/*
          - app/view_models/stafftools/**/*
          - app/views/stafftools/**/*
          - app/controllers/stafftools/**/*

          # Devtools are exempt from this rule
          - app/components/devtools/**/*
          - app/view_models/devtools/**/*
          - app/views/devtools/**/*
          - app/controllers/devtools/**/*

          # Biztools are exempt from this rule
          - app/components/biztools/**/*
          - app/view_models/biztools/**/*
          - app/views/biztools/**/*
          - app/controllers/biztools/**/*

          - app/views/sponsors/**/* # Sponsors are exempt from this rule
          - app/components/sponsors/**/* # Sponsors are exempt from this rule

          # Elasticsearch: https://github.com/github/proxima/issues/1194
          - app/views/dotcom_codesearch/_hit_commit.html.erb
          - app/views/codesearch/_hit_discussion.html.erb
          - app/views/codesearch/_hit_issue.html.erb
          - app/views/codesearch/_hit_repo.html.erb
          - app/views/dotcom_codesearch/_hit_repo.html.erb
          - app/views/codesearch/_hit_wiki.html.erb

          - git-bin/git-analyze-pr-history
          - lib/tasks/enterprise_actions_init.rake
          - lib/tasks/metrics.rake
          - script/repo-id
          - script/create-dependabot-fixtures
          - script/dgit-create-missing-forks
          - script/generate-docs-payloads
          - script/generate-docs-payloads
          - script/ghe-webhook-manage
          - script/gh-migrator
          - script/ghe-webhook-manage
          - script/lfs-extract-usage
          - script/load-fake-health-checks
          - script/repo-id
          - script/setup-copilot
  # erblint-github custom overrides
  GitHub::Accessibility::AriaLabelIsWellFormatted:
    enabled: true
    exceptions:
      - macOS # proper noun
      - gh pr checkout <%= pull_request.number %> # command
