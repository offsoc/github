"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["email-subscription-form"],{83698:(e,t,r)=>{var i=r(72245),s=r(74848),n=r(96540),a=r(83056),o=r(73729),c=r(66889),l=r(47553);function d(e){let{checked:t,defaultChecked:r,name:i,label:a,onChange:o,value:d="1",uncheckedValue:u="0",caption:p}=e,[h,m]=(0,n.useState)(t||r?d:u);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"hidden",name:i,value:h,"data-testid":"realInput"}),(0,s.jsxs)(c.A,{children:[(0,s.jsx)(l.A,{name:"",checked:t||h===d,onChange:e=>{t?m(d):m(h===d?u:d),o&&o(e)}}),(0,s.jsx)(c.A.Label,{children:a}),(0,s.jsx)(c.A.Caption,{children:p})]})]})}try{d.displayName||(d.displayName="UncheckedValueCheckbox")}catch{}var u=r(28784);function p({paramEmail:e,paramCTID:t,paramECID:r,paramK:i,paramD:p,paramPID:h,paramTID:m,paramCMID:f,paramMK:_}){let b=(0,n.useRef)({}),[g,y]=(0,n.useState)(e),[j,x]=(0,n.useState)({CTID:t,ECID:r,K:i,D:p,PID:h,TID:m,CMID:f,MK:_}),{done:v,topics:R,error:E}=function({paramEmail:e,paramCTID:t,paramECID:r,paramK:i,paramD:s,paramPID:o,paramTID:c,paramCMID:l,paramMK:d,setCPMParams:p,setEmail:h}){let[m,f]=(0,n.useState)(!1),[_,b]=(0,n.useState)(!1),[g,y]=(0,n.useState)(!1),[j,x]=(0,n.useState)([]),v="";e&&e.length?v=(0,a.MC)(e):t&&r&&i&&(v=(0,a.iv)({CTID:t,ECID:r,K:i,D:s,PID:o,TID:c,CMID:l,MK:d})),(0,n.useEffect)(()=>{(async()=>{try{let t=await (0,u.lS)(v,{method:"GET",cache:"no-store"}),r=await t.json();r.has_error?r.new_link_required?y(!0):b(!0):(x(r.data.topics),e&&e.length?p(r.cpm_params):h(r.email)),f(!0)}catch{b(!0)}})()},[e,v,p,h]),(0,n.useEffect)(()=>{let e=document.getElementById("js-rails-loading");return m&&e&&(e.style.display="none"),()=>{e&&(e.style.display="")}},[m]);let R={done:m,topics:j};return(g||_)&&(R.error={retriable:_}),R}({paramEmail:e,paramCTID:t,paramECID:r,paramK:i,paramD:p,paramPID:h,paramTID:m,paramCMID:f,paramMK:_,setEmail:y,setCPMParams:x}),C=(0,n.useMemo)(()=>R.map(e=>e.id),[R]),S=(0,n.useCallback)(()=>{let e=document.querySelector("#js-submit");if(!e)return;let t=!0;for(let e of Object.values(b.current))if(e){let r=e.querySelector('input[type="checkbox"]');r&&!r.checked&&(t=!1)}e.disabled=t},[b]),k=(0,n.useCallback)(e=>{if(e.target.checked){for(let e of Object.values(b.current))if(e){let t=e.querySelector('input[type="checkbox"]');t&&t.checked&&t.click()}}else for(let[e,t]of Object.entries(b.current))if(t){let r=t.querySelector('input[type="checkbox"]');r&&!r.checked&&C.includes(e)&&r.click()}S()},[C,S,b]);return v?E?E.retriable?(0,s.jsxs)("div",{"data-testid":"emailSubscriptionTopicsContainer",children:[(0,s.jsx)("p",{children:"We had a problem finding your email subscriptions."}),(0,s.jsxs)("p",{children:["Please refresh the page to try again. If the issue persists,"," ",(0,s.jsx)("a",{href:(0,a.V$)(),children:"click here to request a new subscription management link"}),", or reach out to ",(0,s.jsx)("a",{href:"https://support.github.com/",children:"our support"})," for help."]})]}):(0,s.jsxs)("div",{"data-testid":"emailSubscriptionTopicsContainer",children:[(0,s.jsx)("p",{children:"We had a problem finding your email subscriptions."}),(0,s.jsxs)("p",{children:["Please ",(0,s.jsx)("a",{href:(0,a.V$)(),children:"click here to request a new subscription management link"}),". If the issue persists, reach out to ",(0,s.jsx)("a",{href:"https://support.github.com/",children:"our support"})," for help."]})]}):R.length?(0,s.jsxs)("div",{"data-testid":"emailSubscriptionTopicsContainer",children:[(0,s.jsxs)(o.A,{as:"h1",className:"Subhead-heading",children:["Subscription preferences for ",g]}),(0,s.jsx)("hr",{}),(0,s.jsx)("p",{children:"To stop receiving emails for the topics below, uncheck any topics you don't want to receive, then click Save subscription preferences"}),(0,s.jsx)("div",{children:R.map(e=>(0,s.jsx)("div",{className:"topicInputContainer",ref:t=>b.current[e.id]=t,children:(0,s.jsx)(d,{defaultChecked:!0,name:`topics[${e.id}]`,onChange:S,value:"true",uncheckedValue:"false",label:e.name,caption:e.description,className:"topicInputCheckbox"})},e.id))}),(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{type:"hidden",name:"CTID",value:j.CTID}),(0,s.jsx)("input",{type:"hidden",name:"ECID",value:j.ECID}),(0,s.jsx)("input",{type:"hidden",name:"K",value:j.K}),(0,s.jsx)("input",{type:"hidden",name:"D",value:j.D}),(0,s.jsx)("input",{type:"hidden",name:"PID",value:j.PID}),(0,s.jsx)("input",{type:"hidden",name:"TID",value:j.TID}),(0,s.jsx)("input",{type:"hidden",name:"CMID",value:j.CMID}),(0,s.jsx)("input",{type:"hidden",name:"MK",value:j.MK})]}),(0,s.jsx)("hr",{}),(0,s.jsxs)(c.A,{children:[(0,s.jsx)(l.A,{name:"unsubscribeAll",onChange:k}),(0,s.jsx)(c.A.Label,{children:"Unsubscribe from all topics"})]})]}):(0,s.jsxs)("div",{"data-testid":"emailSubscriptionTopicsContainer",children:[(0,s.jsxs)(o.A,{as:"h1",className:"Subhead-heading",children:["Subscription preferences for ",g]}),(0,s.jsx)("hr",{}),(0,s.jsx)("p",{children:"No subscriptions found"})]}):(0,s.jsx)("div",{"data-testid":"emailSubscriptionTopicsLoadingContainer"})}try{p.displayName||(p.displayName="EmailSubscriptionForm")}catch{}(0,i.k)("email-subscription-form",{Component:p})},92536:(e,t,r)=>{r.d(t,{R:()=>DeferredRegistry});let DeferredRegistry=class DeferredRegistry{register(e,t){let r=this.registrationEntries[e];r?r.resolve?.(t):this.registrationEntries[e]={promise:Promise.resolve(t)}}getRegistration(e){var t;return(t=this.registrationEntries)[e]||(t[e]=new i),this.registrationEntries[e].promise}constructor(){this.registrationEntries={}}};let i=class Deferred{constructor(){this.promise=new Promise(e=>{this.resolve=e})}}},75014:(e,t,r)=>{r.d(t,{Mm:()=>n,QJ:()=>a,w8:()=>s});var i=r(96540);function s(e){return((0,i.useEffect)(()=>{let t=e?.anchor;t&&("disabled"in t&&(t.disabled=!1),t.classList.remove("cursor-wait"))},[e]),e)?{reactPartialAnchor:{__wrapperElement:e}}:{}}function n(e){let t=(0,i.useRef)(e.__wrapperElement.anchor||null),[r,s]=(0,i.useState)(!1),n=(0,i.useCallback)(()=>{s(!r)},[r,s]);return(0,i.useEffect)(()=>{t.current&&(t.current.setAttribute("aria-expanded",r.toString()),t.current.setAttribute("aria-haspopup","true"))},[t,r]),a(e,n),{ref:t,open:r,setOpen:s}}function a(e,t){let r=(0,i.useRef)(e.__wrapperElement.anchor);(0,i.useEffect)(()=>{let e=r.current;if(e)return e.addEventListener("click",t),()=>e.removeEventListener("click",t)},[r,t])}},72245:(e,t,r)=>{r.d(t,{k:()=>l});let i=new(r(92536)).R;var s=r(74848),n=r(39595),a=r(24508),o=r(23235);let c=class ReactPartialElement extends a.H{async getReactNode(e){var t;let{Component:r}=await (t=this.name,i.getRegistration(t)),n=this.closest("react-partial-anchor");return(0,s.jsx)(o.c,{partialName:this.name,embeddedData:e,Component:r,wasServerRendered:this.hasSSRContent,ssrError:this.ssrError,anchorElement:n})}constructor(...e){super(...e),this.nameAttribute="partial-name"}};function l(e,t){i.register(e,t)}c=function(e,t,r,i){var s,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(a=(n<3?s(a):n>3?s(t,r,a):s(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a}([n.p_],c)},23581:(e,t,r)=>{r.d(t,{A:()=>o});let{getItem:i,setItem:s,removeItem:n}=(0,r(74572).A)("localStorage"),a="REACT_PROFILING_ENABLED",o={enable:()=>s(a,"true"),disable:()=>n(a),isEnabled:()=>!!i(a)}},28784:(e,t,r)=>{function i(e,t={}){!function(e){if(new URL(e,window.location.origin).origin!==window.location.origin)throw Error("Can not make cross-origin requests from verifiedFetch")}(e);let r={...t.headers,"GitHub-Verified-Fetch":"true","X-Requested-With":"XMLHttpRequest"};return fetch(e,{...t,headers:r})}function s(e,t){let r={...t?.headers??{},Accept:"application/json","Content-Type":"application/json"},s=t?.body?JSON.stringify(t.body):void 0;return i(e,{...t,body:s,headers:r})}function n(e,t={}){let r={...t.headers,"GitHub-Is-React":"true"};return i(e,{...t,headers:r})}function a(e,t){let r={...t?.headers??{},"GitHub-Is-React":"true"};return s(e,{...t,headers:r})}r.d(t,{DI:()=>i,QJ:()=>n,Sr:()=>a,lS:()=>s})},23235:(e,t,r)=>{r.d(t,{c:()=>m});var i=r(74848),s=r(96540),n=r(36165),a=r(45588),o=r(49107),c=r(47767),l=r(59840);function d({children:e,history:t}){let[r,n]=(0,s.useState)({location:t.location});return(0,l.m)(()=>t.listen(n),[t]),(0,i.jsx)(c.Ix,{location:r.location,navigator:t,children:e})}try{d.displayName||(d.displayName="PartialRouter")}catch{}var u=r(17857),p=r(51261),h=r(75014);function m({partialName:e,embeddedData:t,Component:r,wasServerRendered:c,ssrError:l,anchorElement:m}){let f=s.useRef(),_=globalThis.window;f.current||(f.current=_?(0,p.z)({window:_}):(0,a.sC)({initialEntries:[{pathname:"/"}]}));let b=f.current,g=(0,h.w8)(m);return(0,i.jsx)(n.U,{appName:e,wasServerRendered:c,children:(0,i.jsx)(o.Q,{history:b,routes:[],children:(0,i.jsxs)(d,{history:b,children:[(0,i.jsx)(r,{...t.props,...g}),(0,i.jsx)(u.h,{ssrError:l})]})})})}try{m.displayName||(m.displayName="PartialEntry")}catch{}},24508:(e,t,r)=>{r.d(t,{H:()=>ReactBaseElement});var i=r(74848),s=r(39595),n=r(5338),a=r(96540),o=r(23581),c=r(79461),l=r(51528);function d(e,t,r,i){var s,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(a=(n<3?s(a):n>3?s(t,r,a):s(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a}let u=RegExp("Minified React error #(?<invariant>\\d+)");let ReactBaseElement=class ReactBaseElement extends HTMLElement{get name(){return this.getAttribute(this.nameAttribute)}get embeddedDataText(){let e=this.embeddedData?.textContent;if(!e)throw Error(`No embedded data provided for react element ${this.name}`);return e}get hasSSRContent(){return"true"===this.getAttribute("data-ssr")}connectedCallback(){this.renderReact()}disconnectedCallback(){this.root?.unmount(),this.root=void 0}async renderReact(){if(!this.reactRoot)throw Error("No react root provided");let e={createRoot:n.H,hydrateRoot:n.c};o.A.isEnabled()&&(e=await this.getReactDomWithProfiling());let t=JSON.parse(this.embeddedDataText),r=this.ssrError?.textContent,s=await this.getReactNode(t),c=(0,i.jsx)(a.StrictMode,{children:s});if(r&&this.logSSRError(r),this.hasSSRContent){let t=this.querySelector('style[data-styled="true"]');t&&document.head.appendChild(t),this.root=e.hydrateRoot(this.reactRoot,c,{onRecoverableError:e=>{if(!(e instanceof Error))return;let t=u.exec(e.message),r=String(t?.groups?.invariant);(0,l.i)({incrementKey:"REACT_HYDRATION_ERROR",incrementTags:{appName:this.name,invariant:r}})}}),t&&requestIdleCallback(()=>{t.parentElement?.removeChild(t)})}else this.root=e.createRoot(this.reactRoot),this.root.render(c);this.classList.add("loaded")}getReactDomWithProfiling(){return r.e("react-profiling").then(r.t.bind(r,87335,19))}logSSRError(e){if(c.z[e])return console.error("SSR failed with an expected error:",c.z[e]);try{let t=JSON.parse(e),r=function(e){if(!e.stacktrace)return"";let t="\n ";return e.stacktrace.map(e=>{let{function:r,filename:i,lineno:s,colno:n}=e,a=`${t} at ${r} (${i}:${s}:${n})`;return t=" ",a}).join("\n")}(t);console.error("Error During Alloy SSR:",`${t.type}: ${t.value}
`,t,r)}catch{console.error("Error During Alloy SSR:",e,"unable to parse as json")}}};d([s.aC],ReactBaseElement.prototype,"embeddedData",void 0),d([s.aC],ReactBaseElement.prototype,"ssrError",void 0),d([s.aC],ReactBaseElement.prototype,"reactRoot",void 0);try{u.displayName||(u.displayName="REACT_INVARIANT_ERROR_REGEX")}catch{}}},e=>{var t=t=>e(e.s=t);e.O(0,["react-lib","primer-react-css","vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_primer_octicons-react_di-b40d97","vendors-node_modules_primer_react_lib-esm_Box_Box_js","vendors-node_modules_primer_react_lib-esm_Button_Button_js","vendors-node_modules_primer_react_lib-esm_TooltipV2_Tooltip_js","vendors-node_modules_primer_react_node_modules_primer_octicons-react_dist_index_esm_mjs","vendors-node_modules_primer_react_lib-esm_ActionList_index_js","vendors-node_modules_primer_react_lib-esm_Text_Text_js-node_modules_primer_react_lib-esm_Text-7845da","vendors-node_modules_primer_react_lib-esm_FormControl_FormControl_js","vendors-node_modules_primer_react_lib-esm_FeatureFlags_FeatureFlags_js-node_modules_primer_re-899ae31","ui_packages_react-core_create-browser-history_ts-ui_packages_safe-storage_safe-storage_ts-ui_-682c2c","ui_packages_paths_index_ts"],()=>t(83698)),e.O()}]);
//# sourceMappingURL=email-subscription-form-397e103a48ca.js.map