{"version":3,"file":"chunk-app_components_tracking_blocks_tracking-block-element_ts-xxxxxxxxxxxx.js","mappings":"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","sources":["node_modules/delegated-events/node_modules/selector-set/selector-set.next.js","node_modules/delegated-events/dist/index.js","app/assets/modules/github/command-palette/copy.ts","app/assets/modules/github/hydro-tracking.ts","app/components/tracking_blocks/tracking-block-api.ts","app/components/tracking_blocks/tracking-block-element.ts","app/components/tracking_blocks/tracking-block-omnibar-element.ts","ui/packages/client-env/client-env.ts","ui/packages/document-ready/document-ready.ts","ui/packages/feature-flags/feature-flags.ts","ui/packages/form-utils/form-utils.ts","ui/packages/form-utils/remote-submit.ts","ui/packages/morpheus/index.ts","ui/packages/runtime-environment/runtime-environment.ts","ui/packages/ssr-utils/ssr-globals.ts","ui/packages/ssr-utils/ssr.ts","ui/packages/stats/stats.ts","ui/packages/tasklist-block-operations/utils.ts"],"sourcesContent":["// Public: Create a new SelectorSet.\nexport default function SelectorSet() {\n  // Construct new SelectorSet if called as a function.\n  if (!(this instanceof SelectorSet)) {\n    return new SelectorSet();\n  }\n\n  // Public: Number of selectors added to the set\n  this.size = 0;\n\n  // Internal: Incrementing ID counter\n  this.uid = 0;\n\n  // Internal: Array of String selectors in the set\n  this.selectors = [];\n\n  // Internal: Map of selector ids to objects\n  this.selectorObjects = {};\n\n  // Internal: All Object index String names mapping to Index objects.\n  this.indexes = Object.create(this.indexes);\n\n  // Internal: Used Object index String names mapping to Index objects.\n  this.activeIndexes = [];\n}\n\n// Detect prefixed Element#matches function.\nvar docElem = window.document.documentElement;\nvar matches =\n  docElem.matches ||\n  docElem.webkitMatchesSelector ||\n  docElem.mozMatchesSelector ||\n  docElem.oMatchesSelector ||\n  docElem.msMatchesSelector;\n\n// Public: Check if element matches selector.\n//\n// Maybe overridden with custom Element.matches function.\n//\n// el       - An Element\n// selector - String CSS selector\n//\n// Returns true or false.\nSelectorSet.prototype.matchesSelector = function(el, selector) {\n  return matches.call(el, selector);\n};\n\n// Public: Find all elements in the context that match the selector.\n//\n// Maybe overridden with custom querySelectorAll function.\n//\n// selectors - String CSS selectors.\n// context   - Element context\n//\n// Returns non-live list of Elements.\nSelectorSet.prototype.querySelectorAll = function(selectors, context) {\n  return context.querySelectorAll(selectors);\n};\n\n// Public: Array of indexes.\n//\n// name     - Unique String name\n// selector - Function that takes a String selector and returns a String key\n//            or undefined if it can't be used by the index.\n// element  - Function that takes an Element and returns an Array of String\n//            keys that point to indexed values.\n//\nSelectorSet.prototype.indexes = [];\n\n// Index by element id\nvar idRe = /^#((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)/g;\nSelectorSet.prototype.indexes.push({\n  name: 'ID',\n  selector: function matchIdSelector(sel) {\n    var m;\n    if ((m = sel.match(idRe))) {\n      return m[0].slice(1);\n    }\n  },\n  element: function getElementId(el) {\n    if (el.id) {\n      return [el.id];\n    }\n  }\n});\n\n// Index by all of its class names\nvar classRe = /^\\.((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)/g;\nSelectorSet.prototype.indexes.push({\n  name: 'CLASS',\n  selector: function matchClassSelector(sel) {\n    var m;\n    if ((m = sel.match(classRe))) {\n      return m[0].slice(1);\n    }\n  },\n  element: function getElementClassNames(el) {\n    var className = el.className;\n    if (className) {\n      if (typeof className === 'string') {\n        return className.split(/\\s/);\n      } else if (typeof className === 'object' && 'baseVal' in className) {\n        // className is a SVGAnimatedString\n        // global SVGAnimatedString is not an exposed global in Opera 12\n        return className.baseVal.split(/\\s/);\n      }\n    }\n  }\n});\n\n// Index by tag/node name: `DIV`, `FORM`, `A`\nvar tagRe = /^((?:[\\w\\u00c0-\\uFFFF\\-]|\\\\.)+)/g;\nSelectorSet.prototype.indexes.push({\n  name: 'TAG',\n  selector: function matchTagSelector(sel) {\n    var m;\n    if ((m = sel.match(tagRe))) {\n      return m[0].toUpperCase();\n    }\n  },\n  element: function getElementTagName(el) {\n    return [el.nodeName.toUpperCase()];\n  }\n});\n\n// Default index just contains a single array of elements.\nSelectorSet.prototype.indexes['default'] = {\n  name: 'UNIVERSAL',\n  selector: function() {\n    return true;\n  },\n  element: function() {\n    return [true];\n  }\n};\n\n// Use ES Maps when supported\nvar Map;\nif (typeof window.Map === 'function') {\n  Map = window.Map;\n} else {\n  Map = (function() {\n    function Map() {\n      this.map = {};\n    }\n    Map.prototype.get = function(key) {\n      return this.map[key + ' '];\n    };\n    Map.prototype.set = function(key, value) {\n      this.map[key + ' '] = value;\n    };\n    return Map;\n  })();\n}\n\n// Regexps adopted from Sizzle\n//   https://github.com/jquery/sizzle/blob/1.7/sizzle.js\n//\nvar chunker = /((?:\\((?:\\([^()]+\\)|[^()]+)+\\)|\\[(?:\\[[^\\[\\]]*\\]|['\"][^'\"]*['\"]|[^\\[\\]'\"]+)+\\]|\\\\.|[^ >+~,(\\[\\\\]+)+|[>+~])(\\s*,\\s*)?((?:.|\\r|\\n)*)/g;\n\n// Internal: Get indexes for selector.\n//\n// selector - String CSS selector\n//\n// Returns Array of {index, key}.\nfunction parseSelectorIndexes(allIndexes, selector) {\n  allIndexes = allIndexes.slice(0).concat(allIndexes['default']);\n\n  var allIndexesLen = allIndexes.length,\n    i,\n    j,\n    m,\n    dup,\n    rest = selector,\n    key,\n    index,\n    indexes = [];\n\n  do {\n    chunker.exec('');\n    if ((m = chunker.exec(rest))) {\n      rest = m[3];\n      if (m[2] || !rest) {\n        for (i = 0; i < allIndexesLen; i++) {\n          index = allIndexes[i];\n          if ((key = index.selector(m[1]))) {\n            j = indexes.length;\n            dup = false;\n            while (j--) {\n              if (indexes[j].index === index && indexes[j].key === key) {\n                dup = true;\n                break;\n              }\n            }\n            if (!dup) {\n              indexes.push({ index: index, key: key });\n            }\n            break;\n          }\n        }\n      }\n    }\n  } while (m);\n\n  return indexes;\n}\n\n// Internal: Find first item in Array that is a prototype of `proto`.\n//\n// ary   - Array of objects\n// proto - Prototype of expected item in `ary`\n//\n// Returns object from `ary` if found. Otherwise returns undefined.\nfunction findByPrototype(ary, proto) {\n  var i, len, item;\n  for (i = 0, len = ary.length; i < len; i++) {\n    item = ary[i];\n    if (proto.isPrototypeOf(item)) {\n      return item;\n    }\n  }\n}\n\n// Public: Log when added selector falls under the default index.\n//\n// This API should not be considered stable. May change between\n// minor versions.\n//\n// obj - {selector, data} Object\n//\n//   SelectorSet.prototype.logDefaultIndexUsed = function(obj) {\n//     console.warn(obj.selector, \"could not be indexed\");\n//   };\n//\n// Returns nothing.\nSelectorSet.prototype.logDefaultIndexUsed = function() {};\n\n// Public: Add selector to set.\n//\n// selector - String CSS selector\n// data     - Optional data Object (default: undefined)\n//\n// Returns nothing.\nSelectorSet.prototype.add = function(selector, data) {\n  var obj,\n    i,\n    indexProto,\n    key,\n    index,\n    objs,\n    selectorIndexes,\n    selectorIndex,\n    indexes = this.activeIndexes,\n    selectors = this.selectors,\n    selectorObjects = this.selectorObjects;\n\n  if (typeof selector !== 'string') {\n    return;\n  }\n\n  obj = {\n    id: this.uid++,\n    selector: selector,\n    data: data\n  };\n  selectorObjects[obj.id] = obj;\n\n  selectorIndexes = parseSelectorIndexes(this.indexes, selector);\n  for (i = 0; i < selectorIndexes.length; i++) {\n    selectorIndex = selectorIndexes[i];\n    key = selectorIndex.key;\n    indexProto = selectorIndex.index;\n\n    index = findByPrototype(indexes, indexProto);\n    if (!index) {\n      index = Object.create(indexProto);\n      index.map = new Map();\n      indexes.push(index);\n    }\n\n    if (indexProto === this.indexes['default']) {\n      this.logDefaultIndexUsed(obj);\n    }\n    objs = index.map.get(key);\n    if (!objs) {\n      objs = [];\n      index.map.set(key, objs);\n    }\n    objs.push(obj);\n  }\n\n  this.size++;\n  selectors.push(selector);\n};\n\n// Public: Remove selector from set.\n//\n// selector - String CSS selector\n// data     - Optional data Object (default: undefined)\n//\n// Returns nothing.\nSelectorSet.prototype.remove = function(selector, data) {\n  if (typeof selector !== 'string') {\n    return;\n  }\n\n  var selectorIndexes,\n    selectorIndex,\n    i,\n    j,\n    k,\n    selIndex,\n    objs,\n    obj,\n    indexes = this.activeIndexes,\n    selectors = (this.selectors = []),\n    selectorObjects = this.selectorObjects,\n    removedIds = {},\n    removeAll = arguments.length === 1;\n\n  selectorIndexes = parseSelectorIndexes(this.indexes, selector);\n  for (i = 0; i < selectorIndexes.length; i++) {\n    selectorIndex = selectorIndexes[i];\n\n    j = indexes.length;\n    while (j--) {\n      selIndex = indexes[j];\n      if (selectorIndex.index.isPrototypeOf(selIndex)) {\n        objs = selIndex.map.get(selectorIndex.key);\n        if (objs) {\n          k = objs.length;\n          while (k--) {\n            obj = objs[k];\n            if (obj.selector === selector && (removeAll || obj.data === data)) {\n              objs.splice(k, 1);\n              removedIds[obj.id] = true;\n            }\n          }\n        }\n        break;\n      }\n    }\n  }\n\n  for (i in removedIds) {\n    delete selectorObjects[i];\n    this.size--;\n  }\n\n  for (i in selectorObjects) {\n    selectors.push(selectorObjects[i].selector);\n  }\n};\n\n// Sort by id property handler.\n//\n// a - Selector obj.\n// b - Selector obj.\n//\n// Returns Number.\nfunction sortById(a, b) {\n  return a.id - b.id;\n}\n\n// Public: Find all matching decendants of the context element.\n//\n// context - An Element\n//\n// Returns Array of {selector, data, elements} matches.\nSelectorSet.prototype.queryAll = function(context) {\n  if (!this.selectors.length) {\n    return [];\n  }\n\n  var matches = {},\n    results = [];\n  var els = this.querySelectorAll(this.selectors.join(', '), context);\n\n  var i, j, len, len2, el, m, match, obj;\n  for (i = 0, len = els.length; i < len; i++) {\n    el = els[i];\n    m = this.matches(el);\n    for (j = 0, len2 = m.length; j < len2; j++) {\n      obj = m[j];\n      if (!matches[obj.id]) {\n        match = {\n          id: obj.id,\n          selector: obj.selector,\n          data: obj.data,\n          elements: []\n        };\n        matches[obj.id] = match;\n        results.push(match);\n      } else {\n        match = matches[obj.id];\n      }\n      match.elements.push(el);\n    }\n  }\n\n  return results.sort(sortById);\n};\n\n// Public: Match element against all selectors in set.\n//\n// el - An Element\n//\n// Returns Array of {selector, data} matches.\nSelectorSet.prototype.matches = function(el) {\n  if (!el) {\n    return [];\n  }\n\n  var i, j, k, len, len2, len3, index, keys, objs, obj, id;\n  var indexes = this.activeIndexes,\n    matchedIds = {},\n    matches = [];\n\n  for (i = 0, len = indexes.length; i < len; i++) {\n    index = indexes[i];\n    keys = index.element(el);\n    if (keys) {\n      for (j = 0, len2 = keys.length; j < len2; j++) {\n        if ((objs = index.map.get(keys[j]))) {\n          for (k = 0, len3 = objs.length; k < len3; k++) {\n            obj = objs[k];\n            id = obj.id;\n            if (!matchedIds[id] && this.matchesSelector(el, obj.selector)) {\n              matchedIds[id] = true;\n              matches.push(obj);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  return matches.sort(sortById);\n};\n","import SelectorSet from 'selector-set';\n\nvar bubbleEvents = {};\nvar captureEvents = {};\nvar propagationStopped = new WeakMap();\nvar immediatePropagationStopped = new WeakMap();\nvar currentTargets = new WeakMap();\nvar currentTargetDesc = Object.getOwnPropertyDescriptor(Event.prototype, 'currentTarget');\n\nfunction before(subject, verb, fn) {\n  var source = subject[verb];\n\n  subject[verb] = function () {\n    fn.apply(subject, arguments);\n    return source.apply(subject, arguments);\n  };\n\n  return subject;\n}\n\nfunction matches(selectors, target, reverse) {\n  var queue = [];\n  var node = target;\n\n  do {\n    if (node.nodeType !== 1) break;\n\n    var _matches = selectors.matches(node);\n\n    if (_matches.length) {\n      var matched = {\n        node: node,\n        observers: _matches\n      };\n\n      if (reverse) {\n        queue.unshift(matched);\n      } else {\n        queue.push(matched);\n      }\n    }\n  } while (node = node.parentElement);\n\n  return queue;\n}\n\nfunction trackPropagation() {\n  propagationStopped.set(this, true);\n}\n\nfunction trackImmediate() {\n  propagationStopped.set(this, true);\n  immediatePropagationStopped.set(this, true);\n}\n\nfunction getCurrentTarget() {\n  return currentTargets.get(this) || null;\n}\n\nfunction defineCurrentTarget(event, getter) {\n  if (!currentTargetDesc) return;\n  Object.defineProperty(event, 'currentTarget', {\n    configurable: true,\n    enumerable: true,\n    get: getter || currentTargetDesc.get\n  });\n}\n\nfunction canDispatch(event) {\n  try {\n    event.eventPhase;\n    return true;\n  } catch (_) {\n    return false;\n  }\n}\n\nfunction dispatch(event) {\n  if (!canDispatch(event)) return;\n  var events = event.eventPhase === 1 ? captureEvents : bubbleEvents;\n  var selectors = events[event.type];\n  if (!selectors) return;\n  var queue = matches(selectors, event.target, event.eventPhase === 1);\n  if (!queue.length) return;\n  before(event, 'stopPropagation', trackPropagation);\n  before(event, 'stopImmediatePropagation', trackImmediate);\n  defineCurrentTarget(event, getCurrentTarget);\n\n  for (var i = 0, len1 = queue.length; i < len1; i++) {\n    if (propagationStopped.get(event)) break;\n    var matched = queue[i];\n    currentTargets.set(event, matched.node);\n\n    for (var j = 0, len2 = matched.observers.length; j < len2; j++) {\n      if (immediatePropagationStopped.get(event)) break;\n      matched.observers[j].data.call(matched.node, event);\n    }\n  }\n\n  currentTargets[\"delete\"](event);\n  defineCurrentTarget(event);\n}\n\nfunction on(name, selector, fn) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  var capture = options.capture ? true : false;\n  var events = capture ? captureEvents : bubbleEvents;\n  var selectors = events[name];\n\n  if (!selectors) {\n    selectors = new SelectorSet();\n    events[name] = selectors;\n    document.addEventListener(name, dispatch, capture);\n  }\n\n  selectors.add(selector, fn);\n}\nfunction off(name, selector, fn) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  var capture = options.capture ? true : false;\n  var events = capture ? captureEvents : bubbleEvents;\n  var selectors = events[name];\n  if (!selectors) return;\n  selectors.remove(selector, fn);\n  if (selectors.size) return;\n  delete events[name];\n  document.removeEventListener(name, dispatch, capture);\n}\nfunction fire(target, name, detail) {\n  return target.dispatchEvent(new CustomEvent(name, {\n    bubbles: true,\n    cancelable: true,\n    detail: detail\n  }));\n}\n\nexport { fire, off, on };\n","function createNode(text: string): Element {\n  const node = document.createElement('pre')\n  node.style.width = '1px'\n  node.style.height = '1px'\n  node.style.position = 'fixed'\n  node.style.top = '5px'\n  node.textContent = text\n  return node\n}\n\nfunction copyNode(node: Element): Promise<void> {\n  if ('clipboard' in navigator) {\n    return navigator.clipboard.writeText(node.textContent || '')\n  }\n\n  const selection = getSelection()\n  if (selection == null) {\n    return Promise.reject(new Error())\n  }\n\n  selection.removeAllRanges()\n\n  const range = document.createRange()\n  range.selectNodeContents(node)\n  selection.addRange(range)\n\n  document.execCommand('copy')\n  selection.removeAllRanges()\n  return Promise.resolve()\n}\n\nexport function copyText(text: string): Promise<void> {\n  if ('clipboard' in navigator) {\n    return navigator.clipboard.writeText(text)\n  }\n\n  const body = document.body\n  if (!body) {\n    return Promise.reject(new Error())\n  }\n\n  const node = createNode(text)\n  body.appendChild(node)\n  copyNode(node)\n  body.removeChild(node)\n  return Promise.resolve()\n}\n","import {sendStats} from '@github-ui/stats'\n\nexport function sendData(hydroEventPayload: string, hydroEventHmac: string, hydroClientContext: string): void {\n  const data = {\n    hydroEventPayload,\n    hydroEventHmac,\n    visitorPayload: '',\n    visitorHmac: '',\n    hydroClientContext,\n  }\n\n  const visitorPayload = document.querySelector('meta[name=visitor-payload]')\n  if (visitorPayload instanceof HTMLMetaElement) {\n    data['visitorPayload'] = visitorPayload.content\n  }\n  const visitorHmac = document.querySelector('meta[name=visitor-hmac]') || ''\n  if (visitorHmac instanceof HTMLMetaElement) {\n    data['visitorHmac'] = visitorHmac.content\n  }\n\n  sendStats(data, true)\n}\n\nexport function trackView(el: HTMLElement) {\n  const payload = el.getAttribute('data-hydro-view') || ''\n  const hmac = el.getAttribute('data-hydro-view-hmac') || ''\n  const hydroClientContext = el.getAttribute('data-hydro-client-context') || ''\n  sendData(payload, hmac, hydroClientContext)\n}\n\nexport function sendHydroEvent(el: HTMLElement) {\n  const payload = el.getAttribute('data-hydro-click-payload') || ''\n  const hmac = el.getAttribute('data-hydro-click-hmac') || ''\n  const hydroClientContext = el.getAttribute('data-hydro-client-context') || ''\n  sendData(payload, hmac, hydroClientContext)\n}\n","import {\n  performTasklistBlockOperation,\n  type AppendItemMDPayload,\n  type ConvertToIssueMDPayload,\n  type RemoveItemMDPayload,\n  type RemoveTasklistBlockMDPayload,\n  type AddTasklistBlockMDPayload,\n  type UpdateItemPositionMDPayload,\n  type UpdateItemTitleMDPayload,\n  type UpdateItemStateMDPayload,\n  type MDOperationPayload,\n  type UpdateTasklistTitlePayload,\n} from '@github-ui/tasklist-block-operations'\n// eslint-disable-next-line no-restricted-imports\nimport {off, on} from 'delegated-events'\nimport {requestSubmit} from '@github-ui/form-utils'\nimport {morpheusEnabled} from '@github-ui/morpheus'\nimport type {TrackingBlockElement} from './tracking-block-element'\n\nconst formTrackingBlockUpdateSelector = '[data-form-tracking-block-update]'\n\nexport type HierarchyCompletion = {\n  completed: number\n  total: number\n}\n\nlet lastMDAtRestPromise: Promise<unknown> = Promise.resolve()\nlet pendingMDAtRestTimer: number | undefined\n\nexport default class TrackingBlockAPIComponent {\n  #wasInitialized = false\n  #commentElement: HTMLElement\n  #contextElement?: TrackingBlockElement\n  #formElement: HTMLFormElement | null = null\n\n  get canSync() {\n    return this.#wasInitialized && (!this.#contextElement || !!this.#formElement)\n  }\n\n  constructor(commentElement: HTMLElement, contextElement?: TrackingBlockElement) {\n    this.#commentElement = commentElement\n    this.#contextElement = contextElement\n  }\n\n  init(): this {\n    if (this.#wasInitialized) return this\n\n    this.#formElement = this.#contextElement?.querySelector(formTrackingBlockUpdateSelector) ?? null\n    this.#wasInitialized = true\n\n    return this\n  }\n\n  //#region [ Tracking Block API ]\n  async appendDraftItem(payload: AppendItemMDPayload) {\n    return await this.#doMDAtRestOperation(payload)\n  }\n\n  async updateDraftItemTitleMD(payload: UpdateItemTitleMDPayload) {\n    return await this.#doMDAtRestOperation(payload)\n  }\n\n  async updateDraftItemStateMD(payload: UpdateItemStateMDPayload) {\n    return await this.#doMDAtRestOperation(payload)\n  }\n\n  async removeItemMD(payload: RemoveItemMDPayload) {\n    return await this.#doMDAtRestOperation(payload)\n  }\n\n  async removeTasklistBlock(payload: RemoveTasklistBlockMDPayload) {\n    return await this.#doMDAtRestOperation(payload)\n  }\n\n  async addTasklistBlock(payload: AddTasklistBlockMDPayload) {\n    return await this.#doMDAtRestOperation(payload)\n  }\n\n  async convertToIssueMD(payload: ConvertToIssueMDPayload) {\n    return await this.#doMDAtRestOperation(payload)\n  }\n\n  async updateTasklistTitle(payload: UpdateTasklistTitlePayload) {\n    return await this.#doMDAtRestOperation(payload)\n  }\n\n  async updateItemPositionMD(payload: UpdateItemPositionMDPayload) {\n    return await this.#doMDAtRestOperation(payload)\n  }\n\n  dispatchEvent(event: Event) {\n    // Dispatch the event on the comment element since the tracking block might have been removed from the DOM.\n    return this.#commentElement.dispatchEvent(event)\n  }\n\n  async #doMDAtRestOperation(payload: MDOperationPayload) {\n    this.disableCommentElements(true)\n\n    try {\n      return await this.#dispatchMDAtRestOperation(payload)\n    } finally {\n      this.disableCommentElements(false)\n    }\n  }\n\n  async #dispatchMDAtRestOperation(payload: MDOperationPayload) {\n    const {formId, ...args} = payload\n    let handled = false\n    const isReact = !formId\n\n    // Prevent live updates while edits are pending.\n    this.#commentElement.classList.add('is-dirty')\n    this.dispatchEvent(new CustomEvent('tracking-block:dirty-change', {bubbles: true}))\n\n    if (!isReact) {\n      const form = document.querySelector<HTMLFormElement>(`form#${formId}`)\n      const field = form?.querySelector<HTMLTextAreaElement>('.js-comment-field')\n      const body = field?.value\n\n      if (body) {\n        const newBody = await performTasklistBlockOperation(body, payload)\n        if (newBody != null) {\n          field.value = newBody\n          handled = true\n        }\n      }\n\n      if (form) {\n        const staleOperationTrackerInput = form.querySelector('input[name=\"tasklist_blocks_operation_tracker\"]')\n        const trackingArgs: {name: string; value?: string} = {name: args.operation}\n        if (args.operation === 'append_item') {\n          trackingArgs.value = args.value\n        }\n        if (!staleOperationTrackerInput) {\n          const input = document.createElement('input')\n          input.setAttribute('type', 'hidden')\n          input.setAttribute('name', 'tasklist_blocks_operation_tracker')\n          input.setAttribute('value', JSON.stringify([trackingArgs]))\n          form.appendChild(input)\n        } else {\n          const value = staleOperationTrackerInput.getAttribute('value')\n          try {\n            const parsedTrackingArgs = JSON.parse(value!)\n            parsedTrackingArgs.push(trackingArgs)\n            staleOperationTrackerInput.setAttribute('value', JSON.stringify(parsedTrackingArgs))\n          } catch (e) {\n            // do nothing\n          }\n        }\n      }\n    } else {\n      handled = await new Promise((resolve, reject) => {\n        const detail = {payload, resolve, reject}\n        const event = new CustomEvent('tracking-block:operation', {bubbles: true, detail})\n        this.dispatchEvent(event)\n      })\n    }\n\n    this.#contextElement?.handleStateChange('unsaved-changes')\n    if (!handled) return await this.queueMDAtRestRequest(formId, JSON.stringify(args))\n\n    const handler = async () => {\n      const {activeElement} = document\n      const comment = this.#commentElement\n\n      // Check if the active element is the omnibar input or the omnibar toggle button.\n      const omnibarActive = activeElement?.closest('.js-tracking-block-omnibar-container') != null\n\n      // Hold off if something is currently being dragged or is focused, not including the empty omnibar or toggle button.\n      if (\n        comment?.querySelector('.js-tasklist-dragging') ||\n        comment?.querySelector('.js-edit-metadata-popover-container:not([hidden])') ||\n        (!morpheusEnabled(comment) &&\n          (omnibarActive ? (activeElement as HTMLInputElement).value : comment?.contains(activeElement)))\n      ) {\n        pendingMDAtRestTimer = window.setTimeout(handler, 200)\n        return\n      }\n\n      await send()\n    }\n\n    const send = async () => {\n      off('click', 'a[href], .js-comment-edit-button', send)\n\n      window.clearTimeout(pendingMDAtRestTimer)\n\n      // Coalesce multiple event listeners into a single request.\n      pendingMDAtRestTimer = window.setTimeout(async () => {\n        try {\n          await this.queueMDAtRestRequest(formId)\n        } catch (error) {\n          // eslint-disable-next-line no-console\n          console.error(error)\n        } finally {\n          window.removeEventListener('beforeunload', beforeunload)\n        }\n      }, 0)\n    }\n\n    const beforeunload = (event: BeforeUnloadEvent) => {\n      if (!pendingMDAtRestTimer) return\n\n      // Send the request immediately when the user attempts to navigate away from the page.\n      send()\n\n      event.preventDefault()\n      // This message is ignored by most browsers.\n      // eslint-disable-next-line i18n-text/no-en\n      event.returnValue = 'Please wait a second while we save your changes.'\n    }\n\n    window.addEventListener('beforeunload', beforeunload, {once: true})\n\n    // Send the request immediately when the edit button is clicked.\n    // eslint-disable-next-line delegated-events/global-on\n    on('click', 'a[href], .js-comment-edit-button', send)\n\n    // Debounce requests for edits we were able to handle on the frontend.\n    window.clearTimeout(pendingMDAtRestTimer)\n    pendingMDAtRestTimer = window.setTimeout(handler, 2000)\n\n    // Disable turbo navigation while a request is pending in order for beforeunload to fire.\n    document.body.setAttribute('data-turbo', 'false')\n  }\n\n  async refreshTasklistBlocks(formId: string) {\n    // Prevent updates while refreshing.\n    this.#commentElement.classList.add('is-dirty')\n    this.dispatchEvent(new CustomEvent('tracking-block:dirty-change', {bubbles: true}))\n\n    await this.queueMDAtRestRequest(formId)\n  }\n\n  async queueMDAtRestRequest(formId: string, payload?: string) {\n    document.body.removeAttribute('data-turbo')\n    window.clearTimeout(pendingMDAtRestTimer)\n    pendingMDAtRestTimer = undefined\n\n    // Queue up the requests so we don't send them out of order.\n    const callback = () => this.#makeRequestMDAtRest(formId, payload)\n\n    // eslint-disable-next-line github/no-then\n    lastMDAtRestPromise = lastMDAtRestPromise.then(callback, callback)\n    return lastMDAtRestPromise\n  }\n\n  async #makeRequestMDAtRest(formId: string, payload?: string) {\n    if (!this.canSync) return null\n\n    this.#contextElement?.handleStateChange('saving')\n    this.#commentElement.classList.remove('is-dirty')\n\n    try {\n      // if there's no formId that indicates that we're in the memex view\n      if (!formId) {\n        // Fire a custom event for Memex to handle the tracking block update in React.\n        await new Promise<void>((resolve, reject) => {\n          const detail = {payload, resolve, reject}\n          const event = new CustomEvent('tracking-block:update', {bubbles: true, cancelable: true, detail})\n          const ignored = this.dispatchEvent(event)\n\n          // If the event was not ignored, we know that Memex handled the update and will resolve this promise.\n          if (ignored) resolve()\n        })\n      } else {\n        const form = document.querySelector(`form#${formId}`) as HTMLFormElement\n        if (!form) return null\n        // remove operation inputs from previous form calls\n        const staleOperationsInput = form.querySelectorAll('input[name=\"tasklist_blocks_operation\"]')\n        const staleOperationTrackerInputs = form.querySelectorAll('input[name=\"tasklist_blocks_operation_tracker\"]')\n        for (const element of staleOperationsInput) element.remove()\n\n        if (payload) {\n          const input = document.createElement('input')\n          input.setAttribute('type', 'hidden')\n          input.setAttribute('name', 'tasklist_blocks_operation')\n          input.setAttribute('value', payload)\n          form.appendChild(input)\n        }\n\n        // Prevent the editor from closing if the user has opened it.\n        form.setAttribute('data-submitting-tracking-block-update', payload ? 'sync' : 'async')\n\n        await new Promise<void>((resolve, reject) => {\n          const callback = (event: Event) => {\n            form.removeAttribute('data-submitting-tracking-block-update')\n\n            const {detail} = event as CustomEvent\n            if (detail.error) {\n              reject(detail.error)\n            } else {\n              resolve()\n            }\n          }\n\n          form.addEventListener('submit:complete', callback, {once: true})\n\n          try {\n            requestSubmit(form)\n            for (const element of staleOperationTrackerInputs) element.remove()\n          } catch (e) {\n            form.removeEventListener('submit:complete', callback)\n            reject(e)\n          }\n        })\n      }\n    } catch (err) {\n      this.#contextElement?.handleStateChange('failed-save')\n      throw err\n    }\n\n    // Update the dirty state for Memex after the request has completed.\n    this.dispatchEvent(new CustomEvent('tracking-block:dirty-change', {bubbles: true}))\n\n    this.#contextElement?.handleStateChange('successful-save')\n  }\n\n  disableCommentElements(disabled: boolean) {\n    this.#disableCommentButtons(disabled)\n    this.#disableTasklistItemInputs(disabled)\n    this.#disableTasklistSortables(disabled)\n  }\n\n  #disableCommentButtons(disabled: boolean) {\n    const buttons = this.#commentElement.querySelectorAll(\n      'button, details.dropdown, .js-item-avatar-stack, .js-label-assignee-container',\n    )\n\n    for (const button of buttons) {\n      button.toggleAttribute('disabled', disabled)\n    }\n  }\n\n  #disableTasklistItemInputs(disabled: boolean) {\n    const inputs = this.#commentElement.querySelectorAll<HTMLInputElement>(\n      'tracking-block-omnibar, [data-targets=\"tracking-block.inputs\"]',\n    )\n\n    for (const input of inputs) {\n      input.disabled = disabled\n    }\n  }\n\n  #disableTasklistSortables(disabled: boolean) {\n    const tasklists = this.#commentElement.querySelectorAll<TrackingBlockElement>('tracking-block')\n\n    for (const tasklist of tasklists) {\n      tasklist.sortable?.option('disabled', disabled)\n    }\n  }\n}\n","import {attr, controller, target, targets} from '@github/catalyst'\nimport Sortable, {type SortableEvent} from '@github/sortablejs'\nimport {\n  transformMarkdownToHTML,\n  type AppendItemMDPayload,\n  type ConvertToIssueMDPayload,\n  type RemoveItemMDPayload,\n  type RemoveTasklistBlockMDPayload,\n  type UpdateItemPositionMDPayload,\n  type UpdateItemTitleMDPayload,\n  type UpdateItemStateMDPayload,\n  type UpdateTasklistTitlePayload,\n} from '@github-ui/tasklist-block-operations'\n\nimport './tracking-block-omnibar-element'\nimport type TrackingBlockOmnibarElement from './tracking-block-omnibar-element'\nimport TrackingBlockAPIComponent, {type HierarchyCompletion} from './tracking-block-api'\nimport {copyText} from '../../assets/modules/github/command-palette/copy'\nimport convert from 'color-convert'\nimport {sendHydroEvent} from '../../assets/modules/github/hydro-tracking'\n\n/**\n * Custom element usage:\n * <tracking-block data-id=\"{trackingBlockId}\" [data-readonly] [data-disabled] data-query-type=\"{issues-graph queryType}\" data-response-source-type=\"{issues-graph responseSourceType}\" data-completion-completed=\"{issues-graph completionCompleted}\" data-completion-total=\"{issues-graph completionTotal}\"\">\n *  (...html content...)\n * </tracking-block>\n */\n\ntype Assignee = {\n  alt: string\n  src: string\n}\n\ntype Label = {\n  name: string\n  color: string\n}\n\nconst semanticAttributes = Object.freeze({\n  issueType: 'data-issue',\n  draftIssueType: 'data-draft-issue',\n  itemUuid: 'data-item-uuid',\n  itemId: 'data-item-id',\n  itemTitle: 'data-item-title',\n  itemState: 'data-item-state',\n  itemPosition: 'data-item-position',\n  displayNumber: 'data-display-number',\n  repositoryId: 'data-repository-id',\n  repositoryName: 'data-repository-name',\n})\n\nconst selectors = Object.freeze({\n  convertButton: '[data-tracking-block-convert-button]',\n  removeButton: '[data-tracking-block-remove-button]',\n  draftTitle: '[data-tracking-block-draft-title]',\n  issue: '[data-issue]',\n  draftIssue: '[data-draft-issue]',\n})\n\ntype SelectorNameType = keyof typeof selectors\n\nconst MAX_LABELS_DISPLAYED = 3\n\n// optimisticMetadata is outside the component to maintain state between\n// destroy/create of the tasklist block element\nlet optimisticMetadata: {\n  [key: string]: {\n    assignees?: Assignee[]\n    labels?: Label[]\n  }\n} = {}\n\n@controller\nexport class TrackingBlockElement extends HTMLElement {\n  @attr override id = ''\n  @attr readonly = false\n  @attr disabled = false\n  @attr queryType = ''\n  @attr responseSourceType = ''\n  @attr completionCompleted = 0\n  @attr completionTotal = 0\n  @attr state = ''\n  @attr precache = false\n\n  @target list: HTMLElement | null\n  @target omnibar: TrackingBlockOmnibarElement | null\n  @target omnibarToggleButton: HTMLElement | null\n  @target dropdownMenu: HTMLDetailsElement | null\n  @target titleEditMode: HTMLElement | null\n  @target titleViewMode: HTMLElement | null\n  @targets inputs: NodeListOf<HTMLInputElement>\n  @targets renderedTitles: NodeListOf<HTMLElement>\n  @targets listItems: NodeListOf<HTMLElement>\n  @target emptyItemTemplate: HTMLElement\n  @target emptyIssueTemplate: HTMLElement\n  @targets itemMenus: NodeListOf<HTMLElement>\n  @target staleBanner: HTMLElement\n  @target isSavingIcon: SVGSVGElement\n\n  static refocusOmnibarIndex: number | null = null\n\n  apiComponent: TrackingBlockAPIComponent | null = null\n  sortable: Sortable | null = null\n  // Property to lock edits to a tasklist that was created before markdown at rest and\n  // is going to be converted during the current update. The lock is necessary to allow\n  // the page to be refreshed properly with the new converted markdown at rest tasklist\n  #isLockedForConversion = false\n\n  //#region [ Public ]\n  getAsJSON() {\n    const items = []\n    for (const listItem of this.listItems) {\n      const state = listItem.getAttribute(semanticAttributes.itemState)\n      const isClosed = state === 'closed' || state === 'draftClosed' || state === 'merged'\n      const item = {\n        uuid: listItem.getAttribute(semanticAttributes.itemUuid) || '',\n        isClosed,\n        isDraft: listItem.hasAttribute(semanticAttributes.draftIssueType),\n        displayNumber: listItem.getAttribute(semanticAttributes.displayNumber) || '',\n        title: listItem.getAttribute(semanticAttributes.itemTitle) || '',\n        repositoryId: listItem.getAttribute(semanticAttributes.repositoryId) || '',\n        repositoryName: listItem.getAttribute(semanticAttributes.repositoryName) || '',\n      }\n      items.push(item)\n    }\n    return items\n  }\n  //#endregion\n\n  //#region [ Custom Element API ]\n  connectedCallback() {\n    if (!this.readonly) this.#createApiComponent()\n    this.#updateListInteractiveStatus()\n    this.#setupOmnibarListenersAndAttributes()\n    this.#setupSortableItemListeners()\n    this.#refocusOmnibarIfNecessary()\n    this.#setupKeyboardInteractions()\n\n    // Metadata\n    this.#handleOptimisticMetadataRerender()\n    this.#updateListItems()\n    this.#calculateListItemAvatarStack()\n\n    this.#attachCheckboxListeners()\n    this.#setupSaveListener()\n    this.#updateCompletion({dirty: false})\n\n    this.#tryToUpdateIfDirtyState()\n  }\n\n  // Get and reset methods for testing purposes\n  getOptimisticMetadata() {\n    return optimisticMetadata\n  }\n  resetOptimisticMetadata() {\n    optimisticMetadata = {}\n  }\n\n  /**\n   * This handles a very specific scenario that will only be used within the memex context\n   * If you're editing a tasklist block, and then before it sends the request you click to edit the markdown,\n   * the implementation takes a snapshot of the current rendered HTML to capture its current state.\n   * If the user cancels the edit, we reconstruct the HTML body from the snapshot, which will have the dirty state\n   * and will try to send a request right way. If the user saves the markdown edits, then a new html will be used to\n   * render the body, so the snapshot is ignored.\n   */\n  #tryToUpdateIfDirtyState() {\n    if (this.readonly) return\n\n    if (!this.classList.contains('is-dirty')) return\n    this.apiComponent?.queueMDAtRestRequest('')\n  }\n\n  #setupSaveListener() {\n    const {form} = this.findFormAndCommentElements()\n\n    if (!form) return\n\n    const callback = (event: Event) => {\n      const customEvent = event as CustomEvent\n      const error = customEvent.detail.error\n\n      if (error) {\n        const isStale = JSON.parse(error.response?.text)?.stale\n        if (isStale) {\n          this.staleBanner.hidden = false\n        }\n      }\n    }\n    form.addEventListener('submit:complete', callback, {once: true})\n  }\n\n  #setupKeyboardInteractions() {\n    /**\n     * List item keyboard behavior\n     * 1. Users can tab to the TLB items\n     * 2. Once in the items the user can use the up/down key arrows to navigate\n     * 3. User's can press enter to begin tabbing to secondary items.\n     * 4. Esc key returns the user to the top level list items\n     */\n    const listItems = Array.from(this.querySelectorAll<HTMLElement>('ol .TrackingBlock-item')).filter(element => {\n      return !element.classList.contains('js-template')\n    })\n\n    for (const item of listItems) {\n      const itemEventHandler = (event: KeyboardEvent) => {\n        if (event.target === null) return\n        const isActionListContent = (event.target as HTMLElement)?.classList.contains('ActionListContent')\n\n        const currentIndex = Array.from(listItems).indexOf(event.target as HTMLElement)\n        let nextIndex\n\n        /**\n         * We're not going to implement the data-/hotkeys attribute model. That doesn't seem\n         * to really fit our use case.\n         */\n\n        /* eslint eslint-comments/no-use: off */\n        /* eslint-disable @github-ui/ui-commands/no-manual-shortcut-logic */\n        switch (event.code) {\n          case 'ArrowUp':\n            if (event.target === item) {\n              event.preventDefault()\n              nextIndex = currentIndex > 0 ? currentIndex - 1 : listItems.length - 1\n              listItems[nextIndex]!.focus()\n            }\n            break\n          case 'ArrowDown':\n            if (event.target === item) {\n              event.preventDefault()\n              nextIndex = (currentIndex + 1) % listItems.length\n              listItems[nextIndex]!.focus()\n            }\n            break\n          case 'Escape':\n            // In memex, stop the Esc key from closing the side panel when the user is editing a draft title\n            // or has the draft item menu open.\n            if (isActionListContent || event.target !== item) {\n              event.stopPropagation()\n            }\n\n            // want default primer behavior when the user has keyboard focus inside the metadata menu\n            if (event.target !== item && !isActionListContent) {\n              item.focus()\n            }\n            break\n          case 'Enter':\n            if (!event.altKey) break\n            if (event.target === item && this.#isListItemDraftIssue(item)) {\n              event.preventDefault()\n              const checkBox = item.querySelector<HTMLInputElement>('[data-targets=\"tracking-block.inputs\"]')\n              checkBox!.checked = !checkBox!.checked\n              checkBox!.dispatchEvent(new Event('change'))\n            } else if (event.target === item && this.#isListItemIssue(item)) {\n              event.preventDefault()\n              window.open(item.getElementsByTagName('a')[0]?.href, '_blank')\n            }\n            break\n          case 'KeyC':\n            if (\n              event.altKey &&\n              (event.target === item || this.#isActionMenuActive(event.target)) &&\n              this.#isListItemDraftIssue(item)\n            ) {\n              event.preventDefault()\n              this.convertTaskItemMD(item)\n            }\n            break\n          case 'KeyA':\n            if (\n              event.altKey &&\n              (event.target === item || this.#isActionMenuActive(event.target)) &&\n              this.#isListItemIssue(item)\n            ) {\n              event.preventDefault()\n              this.handleEditAssignees(event)\n            }\n            break\n          case 'KeyL':\n            if (\n              event.altKey &&\n              (event.target === item || this.#isActionMenuActive(event.target)) &&\n              this.#isListItemIssue(item)\n            ) {\n              event.preventDefault()\n              this.handleEditLabels(event)\n            }\n            break\n          case 'KeyP':\n            if (\n              event.altKey &&\n              (event.target === item || this.#isActionMenuActive(event.target)) &&\n              this.#isListItemIssue(item)\n            ) {\n              event.preventDefault()\n              this.handleEditProject(event)\n            }\n            break\n          case 'KeyR':\n            if (\n              event.altKey &&\n              (event.target === item || this.#isActionMenuActive(event.target)) &&\n              this.#isListItemDraftIssue(item)\n            ) {\n              event.preventDefault()\n              this.handleRename(event, true)\n            }\n            break\n          case 'Home':\n            if (event.target === item) {\n              event.preventDefault()\n              listItems[0]!.focus()\n            }\n            break\n          case 'End':\n            if (event.target === item) {\n              event.preventDefault()\n              listItems[listItems.length - 1]!.focus()\n            }\n            break\n          case 'Tab':\n            if (event.target === item) {\n              if (event.shiftKey) {\n                if (currentIndex !== 0) {\n                  event.preventDefault()\n                  // Shift+Tab: move focus to the dropdown menu\n                  item.querySelector<HTMLElement>('[data-targets=\"tracking-block.dropdownMenu\"]')?.focus()\n                  nextIndex = currentIndex > 0 ? currentIndex - 1 : listItems.length - 1\n                  listItems[nextIndex]!.querySelector<HTMLElement>(\n                    '[data-targets=\"tracking-block.dropdownMenu\"]',\n                  )?.focus()\n                }\n              } else {\n                event.preventDefault()\n                item.querySelector<HTMLElement>('[data-targets=\"tracking-block.dropdownMenu\"]')?.focus()\n              }\n            } else {\n              if (event.shiftKey) {\n                event.preventDefault()\n                item.focus()\n              } else {\n                // only go to next item if there is one\n                const parentIndex = Array.from(listItems).indexOf(item)\n                if (parentIndex !== listItems.length - 1) {\n                  event.preventDefault()\n                  listItems[parentIndex + 1]!.focus()\n                }\n              }\n            }\n            break\n          case 'Backspace':\n            if (event.altKey && (event.target === item || this.#isActionMenuActive(event.target))) {\n              event.preventDefault()\n              this.handleRemoveItem(event)\n            }\n            break\n        }\n      }\n\n      item.removeEventListener('keydown', itemEventHandler)\n      item.addEventListener('keydown', itemEventHandler)\n    }\n\n    // The top level tasklist menu should not close the memex side panel when the user has the menu open and focus\n    // is on the contents\n    const tasklistMenuHandler = (event: KeyboardEvent) => {\n      if (event.target === null) return\n      const isActionListContent = (event.target as HTMLElement)?.classList.contains('ActionListContent')\n      switch (event.code) {\n        case 'Escape':\n          // In memex, stop the Esc key from closing the side panel when the user is inside the main tasklist menu\n          if (isActionListContent) {\n            event.stopPropagation()\n          }\n      }\n    }\n\n    const tasklistMenu = this.querySelector<HTMLElement>('.tracking-block-list-item-dropdown-menu')\n\n    tasklistMenu?.removeEventListener('keydown', tasklistMenuHandler)\n    tasklistMenu?.addEventListener('keydown', tasklistMenuHandler)\n  }\n\n  disconnectedCallback() {\n    this.#removeOmnibarListeners()\n    this.#removeSortableItemListeners()\n  }\n\n  /*\n   * Calls to transformMarkdownToHTML can cause flaky timeouts in CI. Moving those calls behind this\n   * function gives us a way to mock those calls in tests and avoid the timeouts.\n   */\n  async transformMarkdownToHTML(body: string) {\n    return await transformMarkdownToHTML(body)\n  }\n\n  /**\n   * If you're editing a tasklist block, then before it sends the request you click to edit the markdown,\n   * the implementation takes a snapshot of the current rendered HTML to capture its current state. When we do this\n   * we want to make sure that the checkboxes are in the correct state so that the UI will not flicker unexpectedly\n   * for the user when the tasklist re-renders from the HTML snapshot\n   */\n  #attachCheckboxListeners() {\n    this.addEventListener('change', e => {\n      const eventTarget = e.target ? (e.target as HTMLInputElement) : null\n      if (!eventTarget?.matches('[type=\"checkbox\"]')) return\n\n      if (eventTarget.checked) {\n        eventTarget.setAttribute('checked', 'checked')\n      } else {\n        eventTarget.removeAttribute('checked')\n      }\n    })\n  }\n\n  // Metadata editing\n  handleEditLabels(evt: Event) {\n    this.#handleEditMetadata(evt, 'labels')\n  }\n\n  handleEditAssignees(evt: Event) {\n    this.#handleEditMetadata(evt, 'assignees')\n  }\n\n  handleEditProject(evt: Event) {\n    this.#handleEditMetadata(evt, 'project')\n  }\n\n  handleMarkAsDone(evt: Event) {\n    if (evt instanceof KeyboardEvent && evt.code !== 'Enter') return\n    const listItem = this.#getTargetBySelector(evt.target as HTMLElement, 'draftIssue')\n    const checkBox = listItem?.querySelector<HTMLInputElement>('[data-targets=\"tracking-block.inputs\"]')\n    if (!listItem || !checkBox) return\n    this.#closeMenuPopover(listItem)\n    checkBox.checked = !checkBox.checked\n    checkBox.dispatchEvent(new Event('change'))\n  }\n\n  handleStateChange(state: 'unsaved-changes' | 'saving' | 'successful-save' | 'failed-save') {\n    this.state = state\n\n    this.isSavingIcon.toggleAttribute('hidden', state !== 'saving')\n    const addTasklistButton = document.querySelector('.js-add-tasklist-button')\n    addTasklistButton?.toggleAttribute('disabled', state === 'saving')\n  }\n\n  #handleEditMetadata(evt: Event, menuType: string) {\n    const listItem = this.#getTargetBySelector(evt.target as HTMLElement, 'issue')\n    const itemId = listItem?.getAttribute(semanticAttributes.itemId)\n    if (!listItem || !itemId) return\n\n    evt.preventDefault()\n    evt.stopPropagation()\n\n    this.#closeMenuPopover(listItem)\n\n    const container = listItem.querySelector<HTMLElement>(\n      `.js-edit-metadata-popover-container[data-menu-type=${menuType}]`,\n    )\n    const turboFrame = container?.querySelector<HTMLElement>('turbo-frame')\n    if (!container || !turboFrame) return\n\n    container.hidden = false\n    turboFrame.hidden = false\n\n    const openDetails = () => {\n      const details = container.querySelector('details')\n      if (!details) return\n\n      // Ensure a toggle event is fired when opening.\n      details.open = false\n      details.open = true\n\n      details.addEventListener(\n        'toggle',\n        e => {\n          if (!details.open) this.handleClosePopover(e, menuType)\n        },\n        {once: true},\n      )\n      details.addEventListener('keydown', e => {\n        const {key} = e\n        if (key === 'Escape' && !details.open) {\n          this.handleClosePopover(e, menuType)\n        }\n      })\n\n      const filterableField = details.querySelector<HTMLInputElement>('.js-filterable-field')\n      filterableField?.focus()\n    }\n\n    if (turboFrame.hasAttribute('complete')) {\n      openDetails()\n    } else {\n      // Bail forced page routing if the source turbo-frame was removed from the page.\n      // https://github.com/github/github/blob/master/ui/packages/turbo/frame.ts#L110\n      document.addEventListener(\n        'turbo:before-frame-render',\n        e => {\n          const event = e as CustomEvent\n          if (event.target === document.documentElement && event.detail.newFrame?.id === turboFrame.id) {\n            event.stopPropagation()\n          }\n        },\n        {capture: true, once: true},\n      )\n      turboFrame.addEventListener('turbo:frame-load', openDetails, {once: true})\n    }\n  }\n\n  #calculateListItemAvatarStack() {\n    for (const listItem of this.listItems) {\n      const avatarStack = listItem.querySelector<HTMLElement>('.js-item-avatar-stack')\n      const avatars = listItem.querySelectorAll('.avatar:not(.avatar-template)')\n      if (!avatarStack) continue\n\n      switch (avatars.length) {\n        case 1:\n          avatarStack.classList.remove('AvatarStack--two', 'AvatarStack--three-plus')\n          break\n        case 2:\n          avatarStack.classList.add('AvatarStack--two')\n          break\n        case 3:\n          avatarStack.classList.add('AvatarStack--three-plus')\n          break\n      }\n    }\n  }\n\n  #handleOptimisticMetadataRerender() {\n    for (const uuid in optimisticMetadata) {\n      const listItem = this.querySelector<HTMLElement>(`[data-item-uuid=\"${uuid}\"]`)\n      if (!uuid || !listItem || !optimisticMetadata[uuid]) return\n\n      const {assignees, labels} = optimisticMetadata[uuid]\n      if (assignees) this.#handleAssigneeOptimisticMetadata(listItem, assignees)\n      if (labels) this.#handleLabelsOptimisticMetadata(listItem, labels)\n    }\n  }\n\n  handleClosePopover(evt: Event, menuType?: string) {\n    const overlay = evt.target as HTMLElement | null\n    if (!overlay) return\n\n    const listItem = this.#getTargetBySelector(overlay, 'issue')\n    // There is no item uuid when rendering a tasklist precache, so we can use itemId instead\n    const listItemId =\n      listItem?.getAttribute(semanticAttributes.itemUuid) || listItem?.getAttribute(semanticAttributes.itemId)\n    const container = overlay?.closest<HTMLElement>('.js-edit-metadata-popover-container')\n    if (!container || !listItemId || !listItem) return\n\n    menuType ||= container.getAttribute('data-menu-type') || ''\n    if (!menuType) return\n\n    container.hidden = true\n\n    const details = container.querySelector('details')\n    if (!details) return\n    details.open = false\n\n    // Ensure the metadata list has loaded before optimistically updating\n    if (!details.querySelector('.select-menu-list')) return\n\n    if (!(`${listItemId}` in optimisticMetadata)) optimisticMetadata[listItemId] = {}\n\n    // Optimistically update the item\n    // Store assignee and labels changes, in alphabetical order\n    if (menuType === 'assignees') {\n      const checkedAvatars = container.querySelectorAll('input:checked')\n      const avatars = Array.from(checkedAvatars)\n        .map(input => input.closest('label') as HTMLElement | null)\n        .filter((input): input is HTMLElement => input !== null)\n        .sort((a: Element, b: Element) => {\n          const nameA = a.querySelector('.js-username')?.innerHTML\n          const nameB = b.querySelector('.js-username')?.innerHTML\n          if (!nameA || !nameB) return 0\n          if (nameA < nameB) return -1\n          if (nameA > nameB) return 1\n          return 0\n        })\n\n      const assignees = []\n      for (const avatar of avatars) {\n        const alt = avatar.querySelector('.js-username')?.innerHTML || ''\n        const src = avatar.querySelector('.js-avatar')?.getAttribute('src') || ''\n        assignees.push({alt, src})\n      }\n\n      optimisticMetadata[listItemId]![menuType] = assignees\n      this.#handleAssigneeOptimisticMetadata(listItem, assignees)\n    } else if (menuType === 'labels') {\n      const checkedInputs = container.querySelectorAll('input:checked')\n      const checkedLabels = Array.from(checkedInputs)\n        .sort((a: Element, b: Element) => {\n          const labelNameA = a.getAttribute('data-label-name')\n          const labelNameB = b.getAttribute('data-label-name')\n          if (!labelNameA || !labelNameB) return 0\n          if (labelNameA < labelNameB) return -1\n          if (labelNameA > labelNameB) return 1\n          return 0\n        })\n        .map(input => input.closest('label') as HTMLElement | null)\n        .filter((input): input is HTMLElement => input !== null)\n\n      const labels = []\n      for (const label of checkedLabels) {\n        const name = label.querySelector('.js-label-name-html')?.innerHTML || ''\n        const badge = label.querySelector('.js-label-color')\n        const color = badge?.getAttribute('label-color') || ''\n        labels.push({name, color})\n      }\n\n      optimisticMetadata[listItemId]![menuType] = labels\n      this.#handleLabelsOptimisticMetadata(listItem, labels)\n    } else if (menuType === 'project') {\n      this.#showProjectUpdateToast(container)\n    }\n  }\n\n  #showProjectUpdateToast(container: HTMLElement) {\n    const sideBarForm = container.querySelector('form')\n    if (!sideBarForm) return\n\n    const callback = (event: Event) => {\n      const {detail} = event as CustomEvent\n      const toast = this.querySelector<HTMLElement>(\n        detail?.error ? '.js-edit-metadata-error-toast' : '.js-edit-metadata-success-toast',\n      )\n      if (!toast) return\n\n      toast.addEventListener(\n        'animationend',\n        () => {\n          toast.hidden = true\n        },\n        {once: true},\n      )\n      toast.hidden = false\n    }\n\n    sideBarForm.addEventListener('submit:complete', callback, {once: true})\n  }\n\n  toggleLabelCountPopover(evt: Event) {\n    const popover = this.#getSiblingTargetBySelector(\n      evt.target as HTMLElement,\n      'issue',\n      '.js-label-count-popover-container',\n    )\n    if (!popover) return\n\n    evt.preventDefault()\n    evt.stopPropagation()\n\n    popover.hidden = !popover.hidden\n  }\n\n  hideLabelCountPopover(evt: Event) {\n    const popover = this.#getSiblingTargetBySelector(\n      evt.target as HTMLElement | null,\n      'issue',\n      '.js-label-count-popover-container',\n    )\n    if (!popover) return\n\n    evt.preventDefault()\n    evt.stopPropagation()\n\n    popover.hidden = true\n  }\n\n  #handleAssigneeOptimisticMetadata(listItem: HTMLElement, checkedAvatars: Assignee[]) {\n    const emptyIcon = listItem?.querySelector('.empty-avatar-icon')\n    const assignees = listItem?.querySelector<HTMLElement>('.js-item-avatar-stack')\n    const template = listItem?.querySelector('.avatar-template')\n    if (!emptyIcon || !assignees || !checkedAvatars || !template) return\n\n    emptyIcon.toggleAttribute('hidden', checkedAvatars.length > 0)\n\n    for (const assignee of assignees.querySelectorAll('.avatar')) {\n      if (assignee !== template) assignee.remove()\n    }\n\n    // Handle optimistic update styling\n    // remove all avatar style classes\n    assignees.classList.remove('AvatarStack--two', 'AvatarStack--three-plus')\n    switch (checkedAvatars.length) {\n      case 0:\n        assignees.hidden = true\n        break\n      case 1:\n        assignees.hidden = false\n        break\n      case 2:\n        assignees.hidden = false\n        assignees.classList.add('AvatarStack--two')\n        break\n      default:\n        assignees.hidden = false\n        assignees.classList.add('AvatarStack--three-plus')\n    }\n\n    for (const avatar of checkedAvatars) {\n      const clone = template.cloneNode(true) as HTMLElement\n      const img = clone.querySelector<HTMLImageElement>('img')\n      const {alt, src} = avatar\n      clone.classList.remove('avatar-template')\n      if (img) {\n        img.setAttribute('data-hovercard-url', `/users/${alt}/hovercard`)\n        img.alt = alt\n        img.src = src\n      }\n      template.before(clone)\n    }\n  }\n\n  #handleLabelsOptimisticMetadata(listItem: HTMLElement, checkedLabels: Label[]) {\n    const labelsGroup = listItem?.querySelector('.js-label-assignee-container')\n    const template = labelsGroup?.querySelector('.label-template')\n    const popoverTemplate = labelsGroup?.querySelector('.label-popover-template')\n    if (!listItem || !labelsGroup || !checkedLabels || !template || !popoverTemplate) return\n\n    for (const label of labelsGroup.querySelectorAll('.js-item-label:not(.label-template)')) {\n      label.remove()\n    }\n    for (const label of labelsGroup.querySelectorAll('.js-item-label-in-popover:not(.label-popover-template)')) {\n      label.remove()\n    }\n\n    for (const label of checkedLabels) {\n      // Create label in list item\n      const clone = template.cloneNode(true) as HTMLElement\n      const span = clone.querySelector<HTMLSpanElement>('span')\n      const {name, color} = label\n      if (color) this.#setColorSwatch(clone, color)\n      if (name) {\n        clone.setAttribute('data-name', name)\n        if (span) span.innerHTML = name\n      }\n      clone.classList.remove('label-template')\n\n      template.before(clone)\n\n      // Create popover label\n      const clonePopover = popoverTemplate.cloneNode(true) as HTMLElement\n      const spanPopover = clonePopover.querySelector<HTMLSpanElement>('span')\n      if (color) this.#setColorSwatch(clonePopover, color)\n      if (name) {\n        clonePopover.setAttribute('data-name', name)\n        if (spanPopover) spanPopover.innerHTML = name\n      }\n      clonePopover.classList.remove('label-popover-template')\n      popoverTemplate.before(clonePopover)\n    }\n\n    this.#handleLabelOverflow(listItem)\n  }\n\n  #setColorSwatch(element: HTMLElement, color: string) {\n    const rgb = convert.hex.rgb(color)\n    element.style.setProperty('--label-r', rgb[0].toString())\n    element.style.setProperty('--label-g', rgb[1].toString())\n    element.style.setProperty('--label-b', rgb[2].toString())\n\n    const hsl = convert.rgb.hsl(rgb)\n    element.style.setProperty('--label-h', hsl[0].toString())\n    element.style.setProperty('--label-s', hsl[1].toString())\n    element.style.setProperty('--label-l', hsl[2].toString())\n  }\n\n  handleRename(evt: Event, isHotkey: boolean) {\n    if (evt instanceof KeyboardEvent && !isHotkey && evt.code !== 'Enter') return\n    const listItem = this.#getTargetBySelector(evt.target as HTMLElement, 'draftIssue')\n\n    const targetElement = listItem?.querySelector<HTMLInputElement>('[data-tracking-block-draft-title]')\n\n    if (!listItem || !targetElement) return\n    this.#closeMenuPopover(listItem)\n    this.#showDraftTitleInput(targetElement)\n  }\n\n  handleDraftTitleClick(evt: Event) {\n    // Check if the evt.target is a link and prevent the draft title click behavior\n    if (evt.target instanceof HTMLAnchorElement) return\n\n    const targetElement = this.#getTargetBySelector(evt.target as HTMLElement | null, 'draftTitle')\n    if (!targetElement) return\n\n    this.#showDraftTitleInput(targetElement)\n  }\n\n  #showDraftTitleInput(titleElement: HTMLElement) {\n    const titleFormControl = titleElement?.querySelector<HTMLElement>('.js-title-text-field-wrapper')\n    const titleInput = titleElement.querySelector('textarea')\n    const titleMDDisplay = titleElement.querySelector<HTMLElement>('.js-draft-title')\n\n    if (!titleFormControl || !titleInput || !titleMDDisplay) return\n\n    titleFormControl.hidden = false\n    titleMDDisplay.hidden = true\n\n    const end = titleInput.value.length\n    titleInput.setSelectionRange(end, end)\n\n    // This is needed because of the default behavior of the ActionMenu focus, remove this once a fix is published\n    // to the primer library\n    setTimeout(() => {\n      titleInput.focus()\n\n      // Force the autosize to update\n      titleInput.dispatchEvent(new Event('input'))\n    }, 10)\n  }\n\n  draftTitleInputOutFocus() {\n    this.#hideAllTitleInputs()\n  }\n\n  activateOmnibar() {\n    this.#focusOmnibarInput()\n  }\n\n  #hideAllTitleInputs() {\n    const {list} = this\n    if (!list) return\n\n    for (const listItem of this.listItems) {\n      const titleFormControl = listItem.querySelector<HTMLElement>('.js-title-text-field-wrapper')\n      const titleMDDisplay = listItem.querySelector<HTMLElement>('.js-draft-title')\n\n      if (titleFormControl) {\n        titleFormControl.hidden = true\n      }\n\n      if (titleMDDisplay) {\n        titleMDDisplay.hidden = false\n      }\n    }\n  }\n\n  disableTasklistListener(event: Event) {\n    const customEvent = event as CustomEvent\n    const isDisabled = customEvent.detail\n    this.apiComponent?.disableCommentElements(isDisabled)\n  }\n\n  #setupSortableItemListeners() {\n    const {list} = this\n    if (this.sortable || !list) return\n\n    this.sortable = Sortable.create(list, {\n      group: 'tracking-block',\n      animation: 150,\n      chosenClass: 'tasklist-issue-chosen-item',\n      item: '.js-tasklist-draggable-issue',\n      handle: '.js-tasklist-drag-handle',\n      onStart: () => list.classList.add('js-tasklist-dragging'),\n      onEnd: (event: SortableEvent) => {\n        this.#handleItemMove(event)\n        list.classList.remove('js-tasklist-dragging')\n      },\n      ghostClass: 'tasklist-issue-ghost-item',\n    })\n  }\n\n  #removeSortableItemListeners() {\n    if (!this.sortable)\n      return // Workaround: the destroy method does not remove the dragend listener\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    ;(this.sortable as any)._onDrop = () => {}\n\n    this.sortable.destroy()\n    this.sortable = null\n  }\n\n  #setupOmnibarListenersAndAttributes() {\n    const omnibarInput = this.omnibar?.querySelector('input')\n    omnibarInput?.addEventListener('focus', this, true)\n    omnibarInput?.addEventListener('blur', this)\n    omnibarInput?.addEventListener('keydown', this)\n\n    // Occasionally the primer autocomplete component will set a default value of '#'\n    // this triggers a dirty field check and blocks live updates to the tracking block\n    omnibarInput?.setAttribute('data-default-value', '')\n  }\n\n  #removeOmnibarListeners() {\n    const omnibarInput = this.omnibar?.querySelector('input')\n    omnibarInput?.removeEventListener('focus', this, true)\n    omnibarInput?.removeEventListener('blur', this)\n    omnibarInput?.removeEventListener('keydown', this)\n  }\n\n  /**\n   * Check the labels associated with the list item to see if they overflow into the title or assignee elements\n   * of the list item.\n   */\n  #updateListItems() {\n    for (const listItem of this.listItems) {\n      this.#handleLabelOverflow(listItem)\n    }\n  }\n\n  #toggleLoadingSkeletons(listItem: HTMLElement, show: boolean) {\n    const labelContainer = listItem.querySelector('.js-label-assignee-container')\n    const loadingContainer = listItem.querySelector<HTMLElement>('.js-label-loading-container')\n    if (labelContainer) {\n      labelContainer.classList.toggle('hide-labels', show)\n    }\n    if (loadingContainer) {\n      loadingContainer.hidden = !show\n    }\n  }\n\n  #handleLabelOverflow(listItem: HTMLElement) {\n    const countPill = listItem.querySelector<HTMLElement>('.js-hidden-label-counter')\n    const labelsInPopover = Array.from(\n      listItem.querySelectorAll<HTMLElement>('.js-item-label-in-popover:not(.label-popover-template)'),\n    )\n    if (!countPill) return\n\n    // Always start calculating the overflow with the counter label and skeletons shown\n    this.#toggleLoadingSkeletons(listItem, true)\n    countPill.hidden = false\n\n    // Remove labels from the list item until labels are no longer overflowing\n    const overflowedLabels = this.#calculateLabelOverflow(listItem)\n    const shownLabelsInPopover = []\n    for (const label of overflowedLabels) {\n      label.hidden = true\n      const labelName = label.textContent?.trim()\n      // Display in popover\n      if (labelName) {\n        const labelIndex = labelsInPopover.findIndex(l => l.textContent?.trim() === labelName)\n        const labelInPopover = labelsInPopover[labelIndex]\n        if (labelIndex > -1 && labelInPopover) {\n          labelInPopover.hidden = false\n          shownLabelsInPopover.push(labelName)\n        }\n      }\n    }\n\n    // If there are hidden labels, add their names to the tooltip and display the hidden label count to the user\n    const hiddenCount = shownLabelsInPopover.length\n    if (hiddenCount > 0) {\n      countPill.textContent = `+${hiddenCount}`\n      countPill.setAttribute('aria-label', shownLabelsInPopover.join(', '))\n      countPill.hidden = false\n    } else {\n      countPill.hidden = true\n    }\n\n    this.#toggleLoadingSkeletons(listItem, false)\n  }\n\n  // Returns a list of label elements that are overflowing and should be hidden\n  #calculateLabelOverflow(listItem: HTMLElement): HTMLElement[] {\n    const labels = Array.from(listItem.querySelectorAll<HTMLElement>('.js-item-label:not(.label-template)'))\n    const assignees = listItem.querySelector('.js-item-avatar-stack')\n    const title = listItem.querySelector('.js-item-title')\n    const countPill = listItem.querySelector('.js-hidden-label-counter')\n    const dropdownMenu = listItem.querySelector('.js-item-dropdown')\n\n    const listItemWidth = listItem.clientWidth\n    const [titleWidth, countPillWidth, assigneesWidth, dropdownMenuWidth] = [\n      title,\n      countPill,\n      assignees,\n      dropdownMenu,\n    ].map(item => {\n      if (!item) return 0\n      const width = (item as HTMLElement).offsetWidth // width of element + padding + border\n      const marginLeft = parseInt(window.getComputedStyle(item).marginLeft, 10)\n      const marginRight = parseInt(window.getComputedStyle(item).marginRight, 10)\n      return width + marginLeft + marginRight || 0\n    })\n\n    // Calculate the width of all the other elements in the list item container and subtract it from the list item width\n    // to calculate the space available for labels\n    const containerWidth = listItemWidth - assigneesWidth! - titleWidth! - countPillWidth! - dropdownMenuWidth!\n\n    // If the total width of the labels, assignees, and count pill is greater than the width of the list item, then the list item is overflowing\n    let totalLabelOffset = 0\n    const hiddenLabels = [] as HTMLElement[]\n    // Max of 3 labels showing, but must have at least one label showing\n    for (let i = 0; i < labels.length; i++) {\n      const label = labels[i]\n      totalLabelOffset += label?.offsetWidth || 0\n\n      // Always show at least one label\n      if (i === 0) {\n        continue\n      }\n      if (label && (i >= MAX_LABELS_DISPLAYED || totalLabelOffset > containerWidth)) {\n        hiddenLabels.push(label)\n      }\n    }\n\n    return hiddenLabels\n  }\n\n  attributeChangedCallback(name: string) {\n    if (name === 'data-readonly' || name === 'data-disabled') {\n      this.#updateListInteractiveStatus()\n      return\n    }\n  }\n  //#endregion\n\n  //#region [ Events ]\n  handleEvent(event: Event) {\n    switch (event.type) {\n      case 'tracking-block-omnibar-append':\n        this.#handleOmnibarAppend(event as CustomEvent)\n        break\n      case 'tasklist-block-title-update':\n        this.#handleTasklistTitleUpdate(event as CustomEvent)\n        break\n      case 'click':\n        this.handleConvertItem(event as MouseEvent)\n        this.handleRemoveItem(event as MouseEvent)\n        break\n      case 'change': {\n        const input = event.currentTarget as HTMLInputElement\n\n        if (input.type === 'checkbox') {\n          this.updateTaskItemStateMD(event)\n        } else {\n          this.updateTaskItemTitleMD(event)\n        }\n        break\n      }\n      case 'focus':\n        this.handleOmnibarFocus()\n        break\n      case 'blur':\n        this.handleOmnibarBlur()\n        break\n      case 'keydown':\n        if (event.currentTarget === this.omnibar?.input) {\n          this.#handleOmnibarKeydown(event as KeyboardEvent)\n        } else if (Array.from(this.inputs).includes(event.currentTarget as HTMLInputElement)) {\n          this.#handleDraftKeydown(event as KeyboardEvent)\n        }\n        break\n    }\n  }\n\n  #handleOmnibarAppend(event: CustomEvent) {\n    this.appendTaskItem(event.detail)\n  }\n\n  #handleTasklistTitleUpdate(event: CustomEvent) {\n    this.updateTasklistTitle(event.detail)\n  }\n\n  handleOmnibarFocus() {\n    const omnibarInput = this.omnibar?.input\n    if (!omnibarInput || omnibarInput.value) return\n\n    // Trigger autocomplete to display the fetched results\n    omnibarInput.value = '#'\n\n    // Use to hide the # from the user just before rendering\n    queueMicrotask(() => {\n      // The defaultValue may have been inadvertently changed by the form submission.\n      omnibarInput.defaultValue = omnibarInput.value = ''\n    })\n  }\n\n  handleOmnibarBlur() {\n    // If the omnibar loses focus while there are unsaved changed, then don't automatically refocus it.\n    if (this.state === 'unsaved-changes' || this.state === 'saving') {\n      TrackingBlockElement.refocusOmnibarIndex = null\n      return\n    }\n\n    // Don't hide the omnibar if user is typing, submitting, or interacting with the autocomplete menu\n    if (this.omnibar?.disabled || this.omnibar?.input?.value || this.omnibar?.autocomplete?.open) return\n\n    this.omnibar?.toggleAttribute('hidden', true)\n    this.omnibarToggleButton?.toggleAttribute('hidden', false)\n  }\n\n  #handleOmnibarKeydown(event: KeyboardEvent) {\n    // Ignore the lint rule regarding using data-/hotkey because it's not applicable to this\n\n    if (event.key === 'Escape' && this.omnibar) {\n      event.stopPropagation()\n\n      this.omnibar.toggleAttribute('hidden', true)\n      this.omnibarToggleButton?.toggleAttribute('hidden', false)\n      this.omnibarToggleButton?.focus()\n    }\n  }\n\n  handleOmnibarToggleButtonClick() {\n    this.omnibarToggleButton?.toggleAttribute('hidden', true)\n    this.omnibar?.toggleAttribute('hidden', false)\n    this.omnibar?.focus()\n  }\n\n  #handleItemMove(event: SortableEvent) {\n    if (event.from === event.to && event.newIndex === event.oldIndex) return\n\n    this.updateItemPosition(event)\n  }\n\n  handleConvertItem(e: Event) {\n    const targetElement = this.#getTargetBySelector(e.target as HTMLElement | null, 'convertButton')\n    if (!targetElement || (targetElement as HTMLButtonElement).disabled) return\n\n    const listItem = targetElement.closest('li.TrackingBlock-item') as HTMLLIElement\n    if (!listItem) return\n\n    this.convertTaskItemMD(listItem)\n  }\n\n  #handleDraftKeydown(event: KeyboardEvent) {\n    const input = event.currentTarget as HTMLInputElement | null\n\n    // Ignore bubbled events\n    if (event.target !== input) return\n\n    if (event.key === 'Enter') {\n      // Prevent the default behavior of inserting a new line\n      event.preventDefault()\n\n      // eslint-disable-next-line github/no-blur\n      input?.blur() // Blur the input to trigger the change event\n    }\n  }\n\n  copyBlockMarkdown() {\n    const totalMarkdown = this.getAsJSON()\n      .map((item, index) => {\n        const listPrefix = `- [${item.isClosed ? 'x' : ' '}]`\n        if (item.isDraft) {\n          return `${listPrefix} ${item.title}`\n        } else {\n          return `${listPrefix} [${item.title} | ${item.repositoryName}#${item.displayNumber}](${this.listItems[\n            index\n          ]!.querySelector('a')?.href})`\n        }\n      })\n      .join('\\n')\n    copyText(totalMarkdown)\n    const buttonEl = this.querySelector('.copy-markdown-button')\n    if (buttonEl) {\n      sendHydroEvent(buttonEl as HTMLElement)\n    }\n    this.dropdownMenu?.toggleAttribute('open')\n  }\n\n  showTitleEditMode() {\n    this.dropdownMenu?.toggleAttribute('open', false)\n    this.titleEditMode?.toggleAttribute('hidden', false)\n    this.titleViewMode?.toggleAttribute('hidden', true)\n    const titleInput = this.titleEditMode?.querySelector<HTMLInputElement>('.js-tasklist-title-input')\n    titleInput?.focus()\n    titleInput?.select()\n  }\n\n  hideTitleEditMode() {\n    this.titleEditMode?.toggleAttribute('hidden', true)\n    this.titleViewMode?.toggleAttribute('hidden', false)\n  }\n\n  handleRemoveItem(e: Event) {\n    let targetElement\n    if (e instanceof MouseEvent) {\n      targetElement = this.#getTargetBySelector(e.target as HTMLElement | null, 'removeButton')\n    }\n    if (e instanceof KeyboardEvent) {\n      targetElement =\n        this.#getTargetBySelector(e.target as HTMLElement | null, 'issue') ||\n        this.#getTargetBySelector(e.target as HTMLElement | null, 'draftIssue')\n    }\n    if (!targetElement) return\n    const listItem = targetElement.closest('li.TrackingBlock-item') as HTMLLIElement\n    if (!listItem) return\n\n    const {form, comment} = this.findFormAndCommentElements()\n    const trackingBlock = targetElement.closest<HTMLDivElement>('tracking-block')!\n    const trackingBlocks = Array.from(comment.querySelectorAll('tracking-block'))\n    const blockPosition = trackingBlocks.findIndex(block => block === trackingBlock)\n    // find the ol closest to the targetElement then find the li's position inside it\n    const listItemPosition = Array.from(listItem.parentElement?.children as HTMLCollectionOf<HTMLLIElement>).findIndex(\n      item => item === listItem,\n    )\n    if (listItemPosition === -1) return // item position not found in list\n\n    const payload: RemoveItemMDPayload = {\n      operation: 'remove_item',\n      position: [blockPosition, listItemPosition],\n      formId: form?.id || '',\n    }\n\n    this.removeTaskItemMD(listItem, payload)\n  }\n\n  findFormAndCommentElements(): {form: HTMLElement | null; comment: HTMLElement} {\n    let comment = this.closest<HTMLDivElement>('.js-comment')!\n    let form = null\n\n    // The js-comment class is a dotcom convention that is used to determine whether the call\n    // is occuring in issues#show or in a react view.\n    const isReact = !comment\n    if (!isReact) {\n      form = comment.querySelector<HTMLFormElement>('.js-comment-update')!\n    } else {\n      comment = this.closest<HTMLDivElement>('.markdown-body')!\n    }\n\n    return {form, comment}\n  }\n  //#endregion\n\n  //#region [ List Actions ]\n  async updateTasklistTitle(payload: UpdateTasklistTitlePayload) {\n    if (!this.#canSync()) return\n\n    const omnibarPlaceholderText = this.omnibarToggleButton?.querySelector('.js-tracking-block-omnibar-title')\n    const currentOmnibarPlaceholder = omnibarPlaceholderText?.innerHTML\n    if (omnibarPlaceholderText && omnibarPlaceholderText.innerHTML) {\n      omnibarPlaceholderText.innerHTML = await this.transformMarkdownToHTML(payload.name)\n    }\n\n    try {\n      await this.apiComponent!.updateTasklistTitle(payload)\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error('updateTasklistTitle: Error occurred', error)\n      if (omnibarPlaceholderText && omnibarPlaceholderText.innerHTML) {\n        omnibarPlaceholderText.innerHTML = currentOmnibarPlaceholder || 'Tasks'\n      }\n    }\n  }\n\n  async appendTaskItem(payload: AppendItemMDPayload) {\n    if (!this.#canSync()) return\n\n    // Keep track of which omnibar we're refocusing after the append operation completes.\n    TrackingBlockElement.refocusOmnibarIndex = payload.position\n\n    const issueNode = /^https?:\\/\\//.test(payload.value)\n      ? this.omnibar?.querySelector(`[data-autocomplete-value='${payload.value}'] .ActionListItem-label`)\n      : null\n\n    let newItem: HTMLElement\n\n    if (issueNode) {\n      newItem = this.emptyIssueTemplate.cloneNode(true) as HTMLElement\n\n      // Make sure issues being added wrap and are styled correctly.\n      issueNode\n        .querySelector('.truncated-autocomplete-suggestion-title')\n        ?.classList.remove('truncated-autocomplete-suggestion-title')\n\n      const content = newItem.querySelector<HTMLElement>('.js-issue-template-content')\n      if (content) {\n        content.appendChild(issueNode.cloneNode(true))\n        content.setAttribute('data-hovercard-type', 'issue')\n        content.setAttribute('data-hovercard-url', `${payload.value}/hovercard`)\n      }\n    } else {\n      // Find hidden draft item template, clone it, and update its text contents for our optimistic update.\n      newItem = this.emptyItemTemplate.cloneNode(true) as HTMLElement\n\n      // newItem.classList.add('TrackingBlock-item')\n      const newTitle = newItem.querySelector('.empty-template-title span')!\n      newTitle.innerHTML = await this.transformMarkdownToHTML(payload.value)\n\n      const newTextarea = newItem.querySelector('textarea')\n      newTextarea!.defaultValue = payload.value\n    }\n\n    newItem.hidden = false\n    newItem.classList.remove('js-template')\n    newItem.removeAttribute('data-target')\n    newItem.setAttribute('data-targets', 'tracking-block.listItems')\n\n    for (const input of newItem.querySelectorAll('input, textarea')) {\n      input.setAttribute('data-targets', 'tracking-block.inputs')\n    }\n\n    this.emptyItemTemplate.before(newItem)\n\n    // Optimistically update the progress pill based on the event type\n    this.#updateCompletion({\n      dirty: true,\n      completed: this.completionCompleted,\n      total: this.completionTotal + 1,\n    })\n\n    try {\n      await this.apiComponent!.appendDraftItem(payload)\n      this.#setupKeyboardInteractions()\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(error)\n\n      this.#updateCompletion({\n        dirty: false,\n        completed: this.completionCompleted,\n        total: this.completionTotal - 1,\n      })\n    }\n\n    // If the omnibar was focused before the append operation, refocus it.\n    // setTimeout is used as a workaround for a race condition in Memex\n    setTimeout(() => this.#focusOmnibarInput(), 0)\n  }\n\n  async updateTaskItemTitleMD(event: Event) {\n    if (!this.#canSync()) return\n\n    const input = event.currentTarget as HTMLInputElement | null\n    if (!input || !input.value) return\n\n    // Ignore bubbled events\n    if (event.target !== input) return\n\n    const targetElement = event.target as HTMLElement | null\n    if (!targetElement) return\n\n    const {form, comment} = this.findFormAndCommentElements()\n    const listItem = targetElement.closest<HTMLLIElement>('li')\n    const trackingBlock = targetElement.closest('tracking-block')!\n    const trackingBlocks = Array.from(comment.querySelectorAll('tracking-block'))\n    const blockPosition = trackingBlocks.findIndex(block => block === trackingBlock)\n    // find the ol closest to the targetElement then find the li's position inside it\n    const listItemPosition = Array.from(listItem?.parentElement?.children as HTMLCollectionOf<HTMLLIElement>).findIndex(\n      item => item === listItem,\n    )\n\n    const payload: UpdateItemTitleMDPayload = {\n      operation: 'update_item_title',\n      position: [blockPosition, listItemPosition],\n      value: input.value,\n      formId: form?.id || '',\n    }\n\n    const renderedTitle = Array.from(this.renderedTitles).find(node => listItem?.contains(node))\n    const oldRenderedHTML = renderedTitle?.innerHTML\n\n    if (renderedTitle) {\n      const html = await this.transformMarkdownToHTML(input.value)\n      // eslint-disable-next-line github/unescaped-html-literal\n      renderedTitle.innerHTML = `<span class=\"wb-break-word\">${html}</span>`\n    }\n\n    try {\n      await this.apiComponent?.updateDraftItemTitleMD(payload)\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(error)\n\n      if (renderedTitle) renderedTitle.innerHTML = oldRenderedHTML || ''\n    }\n  }\n\n  async updateTaskItemStateMD(event: Event) {\n    if (!this.#canSync()) return\n\n    const input = event.currentTarget as HTMLInputElement | null\n\n    // Ignore bubbled events\n    if (event.target !== input) return\n\n    const targetElement = event.target as HTMLElement | null\n    if (!targetElement) return\n\n    const {form, comment} = this.findFormAndCommentElements()\n    const listItem = targetElement.closest<HTMLLIElement>('li')\n    const trackingBlock = targetElement.closest('tracking-block')!\n    const trackingBlocks = Array.from(comment.querySelectorAll('tracking-block'))\n    const blockPosition = trackingBlocks.findIndex(block => block === trackingBlock)\n    // find the ol closest to the targetElement then find the li's position inside it\n    const listItemPosition = Array.from(listItem?.parentElement?.children as HTMLCollectionOf<HTMLLIElement>).findIndex(\n      item => item === listItem,\n    )\n\n    if (!input || input.type !== 'checkbox') return\n\n    // Optimistically update item state\n    if (listItem) listItem.setAttribute(semanticAttributes.itemState, input.checked ? 'draftClosed' : 'draft')\n\n    // Optimistically update the progress pill based on the event type\n    this.#updateCompletion({\n      dirty: true,\n      completed: this.completionCompleted + (input.checked ? 1 : -1),\n    })\n\n    const payload: UpdateItemStateMDPayload = {\n      operation: 'update_item_state',\n      position: [blockPosition, listItemPosition],\n      closed: input.checked,\n      formId: form?.id || '',\n    }\n\n    try {\n      await this.apiComponent?.updateDraftItemStateMD(payload)\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(error)\n\n      // If the request fails, revert the optimistic update to completion\n      this.#updateCompletion({\n        dirty: false,\n        completed: this.completionCompleted + (input.checked ? -1 : 1),\n      })\n    }\n  }\n\n  async removeTasklistBlock(event: Event) {\n    if (!this.#canSync()) return\n\n    const trigger = event.target as HTMLElement | null\n    if (!trigger) return\n\n    const {form, comment} = this.findFormAndCommentElements()\n    const trackingBlock = trigger.closest('tracking-block')!\n    const trackingBlocks = Array.from(comment.querySelectorAll('tracking-block'))\n    const position = trackingBlocks.findIndex(block => block === trackingBlock)\n\n    const payload: RemoveTasklistBlockMDPayload = {\n      operation: 'remove_tasklist_block',\n      formId: form?.id || '',\n      position,\n    }\n\n    // Optimistically hide the tasklist block\n    this.hidden = true\n\n    try {\n      await this.apiComponent!.removeTasklistBlock(payload)\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(error)\n\n      // If the request fails, revert the optimistic update\n      this.hidden = false\n    }\n\n    const menu = trigger.closest<HTMLElement>('details-menu')\n    if (!menu) return\n    menu.style.display = 'none'\n  }\n\n  async updateItemPosition(event: SortableEvent) {\n    if (!this.#canSync()) return\n\n    const {oldIndex, newIndex} = event\n\n    const {form, comment} = this.findFormAndCommentElements()\n    const trackingBlocks = Array.from(comment.querySelectorAll('tracking-block'))\n    const srcTrackingBlock = event.from!.closest('tracking-block')!\n    const dstTrackingBlock = event.to!.closest('tracking-block')!\n    const srcTrackingBlockPosition = trackingBlocks.findIndex(block => block === srcTrackingBlock)\n    const dstTrackingBlockPosition = trackingBlocks.findIndex(block => block === dstTrackingBlock)\n\n    if (srcTrackingBlockPosition === -1) return\n    if (dstTrackingBlockPosition === -1) return\n    if (oldIndex == null) return\n    if (newIndex == null) return\n\n    const payload: UpdateItemPositionMDPayload = {\n      operation: 'update_item_position',\n      src: [srcTrackingBlockPosition, oldIndex],\n      dst: [dstTrackingBlockPosition, newIndex],\n      formId: form?.id || '',\n    }\n\n    try {\n      await this.apiComponent!.updateItemPositionMD(payload)\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(error)\n    }\n  }\n\n  async convertTaskItemMD(listItem: HTMLElement) {\n    if (!this.#canSync() || !this.#isListItemDraftIssue(listItem)) return\n\n    const {form, comment} = this.findFormAndCommentElements()\n    const trackingBlock = listItem.closest<HTMLDivElement>('tracking-block')!\n    const trackingBlocks = Array.from(comment.querySelectorAll('tracking-block'))\n    const blockPosition = trackingBlocks.findIndex(block => block === trackingBlock)\n    // find the ol closest to the listItem then find the li's position inside it\n    const listItemPosition = Array.from(listItem.parentElement?.children as HTMLCollectionOf<HTMLLIElement>).findIndex(\n      item => item === listItem,\n    )\n    if (listItemPosition === -1) return // item position not found in list\n\n    const payload: ConvertToIssueMDPayload = {\n      operation: 'convert_to_issue',\n      position: [blockPosition, listItemPosition],\n      formId: form?.id || '',\n    }\n\n    try {\n      await this.apiComponent!.convertToIssueMD(payload)\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(error)\n    }\n  }\n\n  async removeTaskItemMD(listItem: HTMLElement, payload: RemoveItemMDPayload) {\n    if (!this.#canSync()) return\n\n    const itemState = listItem.getAttribute(semanticAttributes.itemState)!\n    const closed = itemState === 'closed' || itemState === 'draftClosed' || itemState === 'merged'\n\n    // Optimistically hide the item\n    listItem.hidden = true\n\n    // Optimistically update the progress pill based on the state of the deleted item\n    this.#updateCompletion({\n      dirty: true,\n      completed: this.completionCompleted + (closed ? -1 : 0),\n      total: this.completionTotal - 1,\n    })\n\n    // Optimistically hide the item\n    listItem.hidden = true\n\n    try {\n      await this.apiComponent!.removeItemMD(payload)\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(error)\n\n      // If the request fails, revert the optimistic update\n      listItem.hidden = false\n      this.#updateCompletion({\n        dirty: false,\n        completed: this.completionCompleted + (closed ? 1 : 0),\n        total: this.completionTotal + 1,\n      })\n    }\n\n    // the updateCompletion method needs the list items to be current to be accurate\n    listItem.parentElement?.removeChild(listItem)\n  }\n  //#endregion\n\n  #focusOmnibarInput() {\n    if (!this.omnibar) return\n\n    this.omnibarToggleButton?.toggleAttribute('hidden', true)\n    this.omnibar.toggleAttribute('hidden', false)\n    this.omnibar.focus()\n  }\n\n  #refocusOmnibarIfNecessary() {\n    if (TrackingBlockElement.refocusOmnibarIndex == null) return\n    // TODO: The refocus prevents metadata from rendering for precache tasklist blocks for some reason\n    // Is there some way to make this work?\n    if (this.hasAttribute('data-precache')) return\n\n    const {comment} = this.findFormAndCommentElements()\n    const trackingBlocks = comment.querySelectorAll<TrackingBlockElement>('tracking-block')\n    const index = Array.from(trackingBlocks).indexOf(this)\n    if (index !== TrackingBlockElement.refocusOmnibarIndex) return\n\n    TrackingBlockElement.refocusOmnibarIndex = null\n\n    // setTimeout is used as a workaround for a race condition in Memex\n    setTimeout(() => this.#focusOmnibarInput(), 0)\n  }\n\n  lockForConversion(locked: boolean) {\n    const interactiveElements = this.querySelectorAll(\n      `input:not([name=\"_method\"]), textarea, ${selectors.convertButton}`,\n    )\n    this.disabled = locked\n    for (const [, element] of interactiveElements.entries()) {\n      locked ? element.setAttribute('disabled', 'disabled') : element.removeAttribute('disabled')\n    }\n    this.apiComponent?.disableCommentElements(locked)\n    this.#isLockedForConversion = locked\n  }\n\n  //#region [ Render ]\n  #replaceListItems(listItemsFragment: DocumentFragment | null) {\n    if (!this.list) return\n    if (!listItemsFragment) return\n\n    const replacements = listItemsFragment.querySelectorAll<HTMLElement>('li')\n    if (!replacements) return\n\n    this.list.replaceChildren(...replacements)\n  }\n  //#endregion\n\n  //#region [ Helpers ]\n  #isListItemDraftIssue(listItem: HTMLElement) {\n    return listItem.hasAttribute(semanticAttributes.draftIssueType)\n  }\n\n  #isListItemIssue(listItem: HTMLElement) {\n    return listItem.hasAttribute(semanticAttributes.issueType)\n  }\n\n  #isActionMenuActive(eventTarget: EventTarget) {\n    if (!(eventTarget instanceof HTMLElement)) return false\n    return eventTarget.getAttribute('role') === 'menuitem'\n  }\n\n  #closeMenuPopover(listItem: HTMLElement) {\n    if (document.activeElement === listItem) return\n    // Need to close the current popover while the new one is opening, otherwise there is an obvious flicker\n    // presented to the user.\n    for (const anchoredPosition of listItem.querySelectorAll<HTMLElement>('anchored-position')) {\n      anchoredPosition?.hidePopover()\n    }\n\n    const actionMenuBtn = listItem.querySelector<HTMLElement>('.tracking-block-item-menu-btn')\n    actionMenuBtn?.setAttribute('aria-expanded', 'false')\n  }\n\n  #updateCompletion(completion: Partial<HierarchyCompletion & {dirty: boolean}> | null) {\n    if (!completion) return\n\n    this.completionCompleted = completion.completed ?? this.completionCompleted\n    this.completionTotal = completion.total ?? this.completionTotal\n\n    // TODO: This is possible because the completion is inclusive of all tracking blocks in the issue.\n    const progressComponents = document.querySelectorAll('tracked-issues-progress[data-type=tasklist_block]')\n    for (const progress of progressComponents) {\n      progress.setAttribute('data-completed', String(this.completionCompleted))\n      progress.setAttribute('data-total', String(this.completionTotal))\n\n      if (completion.dirty != null) {\n        progress.classList.toggle('is-dirty', completion.dirty)\n      }\n    }\n\n    this.#updateTasklistIconState()\n  }\n\n  // Determine whether to indicate to the user whether the task list is complete or not based on\n  // each list item's state\n  #updateTasklistIconState() {\n    const trackingBlockIcon = this.querySelector<HTMLElement>('.js-tracking-block-completion-icon')\n    const trackingBlockIconWrapper = trackingBlockIcon?.parentElement\n    if (!trackingBlockIcon || !trackingBlockIconWrapper) return\n\n    let isCompleted = this.listItems.length === 0 ? false : true\n    for (const listItem of this.listItems) {\n      const state = listItem.getAttribute(semanticAttributes.itemState)\n      if (state !== 'closed' && state !== 'draftClosed' && state !== 'merged') {\n        isCompleted = false\n        break\n      }\n    }\n\n    if (isCompleted) {\n      trackingBlockIconWrapper.classList.remove('color-bg-open', 'color-fg-open')\n      trackingBlockIconWrapper.classList.add('color-bg-done', 'color-fg-done')\n\n      trackingBlockIcon.classList.remove('color-fg-open')\n      trackingBlockIcon.classList.add('color-fg-done')\n    } else {\n      trackingBlockIconWrapper.classList.remove('color-bg-done', 'color-fg-done')\n      trackingBlockIconWrapper.classList.add('color-bg-open', 'color-fg-open')\n\n      trackingBlockIcon.classList.remove('color-fg-done')\n      trackingBlockIcon.classList.add('color-fg-open')\n    }\n  }\n\n  #updateListInteractiveStatus() {\n    const isInteractive = this.#isInteractive()\n\n    for (const input of this.inputs) {\n      input.disabled = !isInteractive\n    }\n\n    for (const itemMenu of this.itemMenus) {\n      itemMenu.style.display = isInteractive ? '' : 'none'\n    }\n\n    this.#updateOmnibarInteractiveStatus()\n  }\n\n  #updateOmnibarInteractiveStatus() {\n    if (!this.omnibar) return\n\n    if (this.#isInteractive()) {\n      this.omnibar.style.display = ''\n      this.omnibar.disabled = false\n    } else if (this.readonly || !this.#canSync()) {\n      this.omnibar.style.display = 'none'\n    } else {\n      this.omnibar.disabled = true\n    }\n  }\n\n  #getSelectorByName(name: SelectorNameType) {\n    return selectors[name]\n  }\n\n  #getTargetBySelector(element: HTMLElement | null, selectorName: SelectorNameType): HTMLElement | null {\n    if (!element) return null\n\n    const selector = this.#getSelectorByName(selectorName)\n    if (element.matches(selector)) return element\n\n    return element.closest(selector)\n  }\n\n  #getSiblingTargetBySelector(\n    element: HTMLElement | null,\n    selectorName: SelectorNameType,\n    siblingSelectorName: string,\n  ): HTMLElement | null {\n    if (!element) return null\n\n    const container = this.#getTargetBySelector(element, selectorName)\n    if (!container) return null\n\n    return container.querySelector<HTMLElement>(siblingSelectorName)\n  }\n\n  #isInteractive() {\n    return !this.readonly && !this.disabled\n  }\n\n  #canSync() {\n    return this.apiComponent?.canSync ?? false\n  }\n\n  #createApiComponent() {\n    const {comment} = this.findFormAndCommentElements()\n\n    this.apiComponent = new TrackingBlockAPIComponent(comment, this).init()\n    if (!this.apiComponent.canSync) {\n      this.readonly = true\n    }\n  }\n  //#endregion\n}\n","import type AutocompleteElement from '@github/auto-complete-element'\nimport {attr, controller, target, findTarget} from '@github/catalyst'\nimport type {AppendItemMDPayload} from '@github-ui/tasklist-block-operations'\n\ntype AutocompleteEventInit = CustomEventInit & {\n  target: AutocompleteElement\n  relatedTarget: HTMLInputElement\n  previousInputValue: string\n}\n\n@controller\nexport default class TrackingBlockOmnibarElement extends HTMLElement {\n  @attr disabled = false\n  @target autocomplete: AutocompleteElement | null\n\n  get input(): HTMLInputElement | null {\n    return (findTarget(this, 'input') || this.autocomplete?.querySelector('input')) as HTMLInputElement\n  }\n\n  connectedCallback() {\n    this.#updateDisabledStatus()\n  }\n\n  adoptedCallback() {\n    this.#updateDisabledStatus()\n  }\n\n  attributeChangedCallback(name: string) {\n    if (name === 'data-disabled') {\n      this.#updateDisabledStatus()\n    }\n  }\n\n  handleAutoCompleteSelect(event: AutocompleteEventInit) {\n    const input = event.target\n    if (!input) return\n    const inputValue = input.value.trim()\n    if (!inputValue.length) return\n\n    const payload = this.#composeAppendItemMDPayload(input, inputValue)\n    this.#dispatchSubmitMDAtRest(payload)\n\n    // Restore the original input value\n    event.target.value = ''\n    event.relatedTarget.focus()\n  }\n\n  handleSubmit(event: SubmitEvent) {\n    event.preventDefault()\n    const input = event.currentTarget as HTMLFormElement\n    const inputFormData = new FormData(event.currentTarget as HTMLFormElement).get('tasklist_omnibar')\n    const inputValue = inputFormData?.toString().trim() ?? ''\n\n    if (inputValue) {\n      const payload = this.#composeAppendItemMDPayload(input, inputValue)\n      this.#dispatchSubmitMDAtRest(payload)\n    }\n\n    if (this.input) {\n      this.input.value = ''\n      this.input.focus()\n    }\n  }\n\n  override focus() {\n    if (!this.input) return\n\n    this.input.focus()\n  }\n\n  #composeAppendItemMDPayload(input: HTMLFormElement | AutocompleteElement, inputValue: string): AppendItemMDPayload {\n    let comment = input.closest<HTMLDivElement>('.js-comment')!\n    let form = null\n\n    // The js-comment class is a dotcom convention that is used to determine whether the call\n    // is occuring in issues#show or in a react view.\n    const isReact = !comment\n    if (isReact) {\n      comment = input.closest<HTMLDivElement>('.markdown-body')!\n    } else {\n      form = comment.querySelector<HTMLFormElement>('.js-comment-update')!\n    }\n\n    const trackingBlock = input.closest<HTMLDivElement>('tracking-block')!\n    const trackingBlocks = Array.from(comment.querySelectorAll('tracking-block'))\n    const position = trackingBlocks.findIndex(block => block === trackingBlock)\n\n    return {\n      operation: 'append_item',\n      position,\n      value: inputValue,\n      formId: form?.id || '',\n    }\n  }\n\n  #dispatchSubmitMDAtRest(payload: AppendItemMDPayload) {\n    this.dispatchEvent(\n      new CustomEvent('tracking-block-omnibar-append', {\n        bubbles: true,\n        detail: payload,\n      }),\n    )\n  }\n\n  #updateDisabledStatus() {\n    if (!this.input) return\n\n    this.input.disabled = this.disabled\n  }\n}\n","export interface ClientEnvironment {\n  readonly locale: string\n  readonly featureFlags: string[]\n}\n\nlet env: ClientEnvironment | undefined\n\nexport function getEnv() {\n  if (!env) {\n    throw new Error(\n      'Client env was requested before it was loaded. This likely means you are attempting to use client env at the module level in SSR, which is not supported. Please move your client env usage into a function.',\n    )\n  }\n\n  return env\n}\n\nexport function getLocale() {\n  return env?.locale ?? 'en-US'\n}\n\nfunction loadEnv() {\n  if (typeof document !== 'undefined') {\n    const envTag = document.getElementById('client-env')\n    if (envTag) {\n      try {\n        env = JSON.parse(envTag.textContent || '')\n      } catch (error) {\n        // eslint-disable-next-line no-console\n        console.error('Error parsing client-env', error)\n      }\n    }\n  }\n}\n\n// Automatically load the env on initial page load\nloadEnv()\n\n// This is a special helper method for setting the env in the SSR environment only\nexport function setClientEnvForSsr(clientEnv: ClientEnvironment | undefined) {\n  env = clientEnv\n}\n\n// This env object is used as a default for tests only and is not included in production builds\nexport const clientEnvForTests: ClientEnvironment = {\n  locale: 'en',\n  featureFlags: ['test_flag'],\n}\n\nexport function _resetForTests({loadNewEnv, forceUndefined}: {loadNewEnv: boolean; forceUndefined?: boolean}) {\n  // forget the current env\n  env = forceUndefined ? undefined : clientEnvForTests\n\n  if (loadNewEnv) {\n    // load the latest env\n    loadEnv()\n  }\n}\n","import {ssrSafeDocument, ssrSafeWindow} from '@github-ui/ssr-utils'\n\n// Check if document has passed interactive state.\n//\n// The document has finished loading and the document has been parsed but\n// sub-resources such as images, stylesheets and frames are still loading.\n// The state indicates that the DOMContentLoaded event has been fired.\nexport const ready: Promise<void> = (function () {\n  if (ssrSafeDocument?.readyState === 'interactive' || ssrSafeDocument?.readyState === 'complete') {\n    return Promise.resolve()\n  } else {\n    return new Promise<void>(resolve => {\n      ssrSafeDocument?.addEventListener('DOMContentLoaded', () => {\n        resolve()\n      })\n    })\n  }\n})()\n\n// Check if document has passed loaded state.\n//\n// The document and all sub-resources have finished loading. The state\n// indicates that the load event has been fired.\nexport const loaded: Promise<unknown> = (function () {\n  if (ssrSafeDocument?.readyState === 'complete') {\n    return Promise.resolve()\n  } else {\n    return new Promise(resolve => {\n      ssrSafeWindow?.addEventListener('load', resolve)\n    })\n  }\n})()\n","import memoize from '@github/memoize'\nimport {getEnv} from '@github-ui/client-env'\nimport {IS_SERVER} from '@github-ui/ssr-utils'\n\nfunction getEnabledFeaturesSet(): Set<string> {\n  const features = getEnv().featureFlags\n  const featuresUpperCase = features.map(feature => feature.toLowerCase())\n  return new Set<string>(featuresUpperCase)\n}\n\nconst featuresSet =\n  IS_SERVER || process.env.NODE_ENV === 'test' ? getEnabledFeaturesSet : memoize(getEnabledFeaturesSet)\n\nexport function getEnabledFeatures(): string[] {\n  return Array.from(featuresSet())\n}\n\nexport function isFeatureEnabled(name: string): boolean {\n  return featuresSet().has(name.toLowerCase())\n}\n\n//exported to allow mocking in tests\nconst featureFlag = {isFeatureEnabled}\n\nexport {featureFlag}\n","import {persistSubmitButtonValue} from './remote-submit'\n\ntype TextField = HTMLInputElement | HTMLTextAreaElement\ntype Button = HTMLInputElement | HTMLButtonElement\n\nfunction fire(target: HTMLElement, name: string, cancelable: boolean): boolean {\n  return target.dispatchEvent(\n    new CustomEvent(name, {\n      bubbles: true,\n      cancelable,\n    }),\n  )\n}\n\n// Submit a form while ensuring that `submit` event is also triggered.\n//\n// Calling native `form.submit()` method immediately submits the form without triggering the `submit` event.\n// As a result, code that wants to hook into form submits would never execute.\n//\n// This method first triggers the `submit` event and, if that event wasn't `preventDefault`d, submits the\n// form natively.\nexport function requestSubmit(form: HTMLFormElement, submitter?: Button) {\n  if (submitter) {\n    checkButtonValidity(form, submitter)\n    persistSubmitButtonValue(submitter)\n  }\n  if (fire(form, 'submit', true)) {\n    form.submit()\n  }\n}\n\n// Check submitter validity for form.requestSubmit compatibility.\n// See https://html.spec.whatwg.org/#dom-form-requestsubmit.\nfunction checkButtonValidity(form: HTMLFormElement, submitter: Button) {\n  if (!(form instanceof HTMLFormElement)) throw new TypeError('The specified element is not of type HTMLFormElement.')\n  if (!(submitter instanceof HTMLElement)) throw new TypeError('The specified element is not of type HTMLElement.')\n  if (submitter.type !== 'submit') throw new TypeError('The specified element is not a submit button.')\n  if (!form || form !== submitter.form) throw new Error('The specified element is not owned by the form element.')\n}\n\n// Set a form field value while ensuring that `change` event is also triggered.\n//\n// Having the `change` event fire is important for various behaviors to react, such as form validation.\nexport function changeValue(input: TextField, value: string | boolean) {\n  if (typeof value === 'boolean') {\n    if (input instanceof HTMLInputElement) {\n      input.checked = value\n    } else {\n      throw new TypeError('only checkboxes can be set to boolean value')\n    }\n  } else {\n    if (input.type === 'checkbox') {\n      throw new TypeError(\"checkbox can't be set to string value\")\n    } else {\n      input.value = value\n    }\n  }\n  fire(input, 'change', false)\n}\n\n// Fill multiple form fields by item name.\nexport function fillFormValues(form: HTMLFormElement, fields: {[key: string]: string}) {\n  for (const name in fields) {\n    const value = fields[name]\n    const element = form.elements.namedItem(name)\n\n    if (element instanceof HTMLInputElement) {\n      element.value = value!\n    } else if (element instanceof HTMLTextAreaElement) {\n      element.value = value!\n    }\n  }\n}\n\n// Test if element is a form field.\nexport function isFormField(element: Node): boolean {\n  if (!(element instanceof HTMLElement)) {\n    return false\n  }\n\n  const name = element.nodeName.toLowerCase()\n  const type = (element.getAttribute('type') || '').toLowerCase()\n  return (\n    name === 'select' ||\n    name === 'textarea' ||\n    (name === 'input' && type !== 'submit' && type !== 'reset') ||\n    element.isContentEditable\n  )\n}\n\nfunction searchParamsFromFormData(formData: FormData): URLSearchParams {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return new URLSearchParams(formData as any)\n}\n\n// Get a `?` search string for a URL for a GET form, using its `action` attribute as well as its other fields.\nexport function combineGetFormSearchParams(formAction: URL, formData: FormData): string {\n  const allSearchParams = new URLSearchParams(formAction.search)\n  const searchParamsFromInputs = searchParamsFromFormData(formData)\n  for (const [key, value] of searchParamsFromInputs) {\n    allSearchParams.append(key, value)\n  }\n  return allSearchParams.toString()\n}\n\n// Serialize form data into string.\nexport function serialize(form: HTMLFormElement): string {\n  return searchParamsFromFormData(new FormData(form)).toString()\n}\n","// Emulates submit button submission values by inserting a hidden input to the form.\n//\n// Submit events can be triggerd in the following ways:\n// - User clicks on a submit button.\n// - User press Enter when focusing on a form field; also known as \"implicit submission\".\n// - Programmatically via requestSubmit helper.\n//\n// On GitHub.com, the submission is either handled by the browser or remoteForm.\n//\n// For submissions triggered by user actions, the name and value of the clicked submit button (also known as\n// \"the submitter\") is passed along in the request, and can be programmatically retrieved with FormData.entries().\n//\n// However, this value will be lost in the following cases:\n// - 1. When the submitter button is disabled, most commonly by [data-disable-with].\n// - 2. When submitting via requestSubmit (from form.js), because the submission does not originated from a submitter.\n// - 3. When submitting with remoteForm, because FormData(form).entries() does not know about the submitter. In Safari\n// the submitter is known during the submission steps, but this behavior is not supported in any other browsers.\n//\n// @see {@link https://github.com/github/form-data-entries/pull/7}.\n//\n// For the exact workarounds, refer to ./form.js and ./remote.js.\nexport function persistSubmitButtonValue(button: HTMLButtonElement | HTMLInputElement) {\n  const form = button.closest('form')\n  if (!(form instanceof HTMLFormElement)) {\n    return\n  }\n\n  let input = findPersistedSubmitButtonValue(form)\n\n  if (button.name) {\n    const defaultValue = button.matches('input[type=submit]') ? 'Submit' : ''\n    const value = button.value || defaultValue\n    if (!input) {\n      input = document.createElement('input')\n      input.type = 'hidden'\n      input.classList.add('js-submit-button-value')\n      form.prepend(input)\n    }\n    input.name = button.name\n    input.value = value\n  } else if (input) {\n    input.remove()\n  }\n}\n\nexport function findPersistedSubmitButtonValue(form: HTMLFormElement): HTMLInputElement | null {\n  const input = form.querySelector('input.js-submit-button-value')\n  return input instanceof HTMLInputElement ? input : null\n}\n","import morphdom from 'morphdom'\n\nexport type MorpheusOptions = {\n  keepInputValues?: boolean\n}\n\ntype CustomElement = {\n  connectedCallback?(): void\n  disconnectedCallback?(): void\n}\n\nfunction morphdomOptions(options?: MorpheusOptions) {\n  return {\n    getNodeKey: () => {\n      // Since ids often contain uuids, we can't use them as keys.\n      return null\n    },\n    onBeforeElUpdated: (fromEl: HTMLElement, toEl: HTMLElement) => {\n      if (\n        // Workaround: Errors may occur when morphing turbo-frame attributes.\n        toEl.tagName === 'TURBO-FRAME' ||\n        // Workaround: the legacy task list code looks for these elements to be added in order to set them up from JS.\n        toEl.matches('.js-task-list-field, .contains-task-list') ||\n        toEl.getAttribute('data-morpheus-enabled') === 'false'\n      ) {\n        fromEl.replaceWith(toEl)\n        return false\n      }\n\n      // Ensure the data-catalyst attribute added by JS remains.\n      if (fromEl.hasAttribute('data-catalyst')) {\n        toEl.setAttribute('data-catalyst', fromEl.getAttribute('data-catalyst') || '')\n      }\n\n      // Check if there are other attributes we should not update.\n      if (fromEl.hasAttribute('data-morpheus-ignore')) {\n        const names = (fromEl.getAttribute('data-morpheus-ignore') || '').trim().split(/\\s+/)\n        for (const name of names) {\n          if (fromEl.hasAttribute(name)) {\n            toEl.setAttribute(name, fromEl.getAttribute(name) || '')\n          } else {\n            toEl.removeAttribute(name)\n          }\n        }\n      }\n\n      // If the option to keep input values is enabled, copy all input values from the old element to the new one.\n      if (\n        options?.keepInputValues &&\n        ((toEl instanceof HTMLInputElement && toEl.type === (fromEl as HTMLInputElement).type) ||\n          toEl instanceof HTMLTextAreaElement)\n      ) {\n        if (toEl instanceof HTMLInputElement && (toEl.type === 'checkbox' || toEl.type === 'radio')) {\n          toEl.checked = (fromEl as typeof toEl).checked\n        } else {\n          toEl.value = (fromEl as typeof toEl).value\n        }\n      }\n\n      return true\n    },\n    onBeforeElChildrenUpdated: (fromEl: HTMLElement, toEl: HTMLElement) => {\n      // Remove all comment nodes (mostly from the template engine) as they will confuse morphdom.\n      for (const node of [...fromEl.childNodes, ...toEl.childNodes]) {\n        if (node.nodeType === Node.COMMENT_NODE) {\n          node.remove()\n        }\n      }\n\n      return true\n    },\n    onElUpdated: (el: HTMLElement) => {\n      const customEl = el as CustomElement\n\n      if (customEl.connectedCallback) {\n        // Queue microtask to ensure this runs after the children have been updated as well.\n        queueMicrotask(() => {\n          customEl.disconnectedCallback?.()\n          customEl.connectedCallback?.()\n        })\n      }\n    },\n  }\n}\n\nexport function morpheusEnabled(el: Element) {\n  const ancestor = el.closest('[data-morpheus-enabled]')\n  return ancestor != null && ancestor.getAttribute('data-morpheus-enabled') !== 'false'\n}\n\nexport function morph(el: Element, newEl: Node | string, options?: MorpheusOptions) {\n  if (typeof newEl === 'string') {\n    const template = document.createElement('template')\n    template.innerHTML = newEl\n    newEl = template.content\n  }\n\n  if (!morpheusEnabled(el)) {\n    el.replaceWith(newEl)\n    return\n  }\n\n  // Workaround morphdom not correctly handling document fragments.\n  if (newEl instanceof DocumentFragment) {\n    const children = Array.from(newEl.children)\n    if (children.length) {\n      morphdom(el, children[0]!, morphdomOptions(options))\n      el.after(...children.slice(1))\n    } else {\n      el.replaceWith(newEl)\n    }\n  } else {\n    morphdom(el, newEl, morphdomOptions(options))\n  }\n}\n\nexport function morphContent(el: Element, content: string, options?: MorpheusOptions) {\n  if (!morpheusEnabled(el)) {\n    el.innerHTML = content\n    return\n  }\n\n  let leading = ''\n  let trailing = ''\n\n  // Match the leading/trailing whitespace of the existing content so text nodes are not removed.\n  if (el.firstChild?.nodeType === Node.TEXT_NODE) {\n    leading = el.firstChild.nodeValue?.match(/^\\s+/)?.[0] || ''\n  }\n  if (el.lastChild?.nodeType === Node.TEXT_NODE) {\n    trailing = el.lastChild.nodeValue?.match(/\\s+$/)?.[0] || ''\n  }\n\n  const newEl = el.cloneNode(false) as Element\n  newEl.innerHTML = `${leading}${content.trim()}${trailing}`\n\n  morphdom(el, newEl, morphdomOptions(options))\n}\n","import memoize from '@github/memoize'\nimport {ssrSafeDocument} from '@github-ui/ssr-utils'\n\nconst runtimeEnvironment = memoize(githubEnvironment)\n\n// return the github instance environment\n// if dotcom, returns 'dotcom'\n// if enterprise, returns 'enterprise'\nfunction githubEnvironment(): string {\n  return ssrSafeDocument?.head?.querySelector<HTMLMetaElement>('meta[name=\"runtime-environment\"]')?.content || ''\n}\n\nexport const isEnterprise = memoize(isEnterpriseEnvironment)\nfunction isEnterpriseEnvironment(): boolean {\n  return runtimeEnvironment() === 'enterprise'\n}\n\n// This is the \"bundler\" that built the client-side assets, e.g. \"webpack\"\nexport const bundler = typeof BUNDLER !== 'undefined' ? BUNDLER : undefined\n","// When using SSR, browser globals are not available. If you try to use them, Node.js will throw an error\ntype SSRSafeLocation = Pick<Location, 'pathname' | 'origin' | 'search' | 'hash' | 'href'>\n\n// eslint-disable-next-line ssr-friendly/no-dom-globals-in-module-scope\nexport const ssrSafeDocument = typeof document === 'undefined' ? undefined : document\n// eslint-disable-next-line ssr-friendly/no-dom-globals-in-module-scope\nexport const ssrSafeWindow = typeof window === 'undefined' ? undefined : window\n// eslint-disable-next-line ssr-friendly/no-dom-globals-in-module-scope\nexport const ssrSafeHistory = typeof history === 'undefined' ? undefined : history\n\nexport const ssrSafeLocation: SSRSafeLocation =\n  // eslint-disable-next-line ssr-friendly/no-dom-globals-in-module-scope\n  typeof location === 'undefined' ? {pathname: '', origin: '', search: '', hash: '', href: ''} : location\n\nexport function setLocation(url: string) {\n  // eslint-disable-next-line no-restricted-syntax\n  const parsedURL: SSRSafeLocation = new URL(url)\n  const {pathname, origin, search, hash} = parsedURL\n\n  Object.assign(ssrSafeLocation, {pathname, origin, search, hash})\n}\n","import {ssrSafeDocument} from './ssr-globals'\n\n/***\n * Are we rendering on the server?\n */\nexport const IS_SERVER = typeof ssrSafeDocument === 'undefined'\n\n/***\n * Are we rendering on the client?\n */\nexport const IS_BROWSER = !IS_SERVER\n\n/***\n * This helper returns `true` if:\n * - we are rendering on the server\n * - we are on the client, and the app has been hydrated from a server-render\n */\nexport function wasServerRendered() {\n  if (IS_SERVER) {\n    return true\n  }\n\n  return Boolean(ssrSafeDocument!.querySelector('react-app[data-ssr=\"true\"]'))\n}\n","import {ssrSafeDocument} from '@github-ui/ssr-utils'\nimport {loaded} from '@github-ui/document-ready'\nimport {bundler} from '@github-ui/runtime-environment'\nimport {isFeatureEnabled} from '@github-ui/feature-flags'\nimport {throttle} from '@github/mini-throttle'\n\nlet stats: PlatformBrowserStat[] = []\nconst chunkSize = 64 * 1024\n\nexport function sendStats(stat: PlatformBrowserStat, flushImmediately = false, samplingProbability = 0.5): void {\n  if (isFeatureEnabled('BROWSER_STATS_DISABLED') === true) {\n    return\n  }\n  if (samplingProbability < 0 || samplingProbability > 1) {\n    throw new RangeError('Sampling probability must be between 0 and 1')\n  }\n\n  if (stat.timestamp === undefined) stat.timestamp = new Date().getTime()\n  stat.loggedIn = isLoggedIn()\n  stat.staff = isStaff()\n  stat.bundler = bundler\n  if (Math.random() < samplingProbability) {\n    stats.push(stat)\n  }\n\n  if (flushImmediately) {\n    flushStats()\n  } else {\n    throttledScheduleSendStats()\n  }\n}\n\nlet queued: number | null = null\n\nconst throttledScheduleSendStats = throttle(async function scheduleSendStats() {\n  await loaded\n  if (queued == null) {\n    queued = window.requestIdleCallback(flushStats)\n  }\n}, 5000)\n\nfunction flushStats() {\n  queued = null\n  if (!stats.length) {\n    return\n  }\n\n  const url = ssrSafeDocument?.head?.querySelector<HTMLMetaElement>('meta[name=\"browser-stats-url\"]')?.content\n  if (!url) {\n    return\n  }\n\n  const batches = getBatches(stats)\n\n  for (const batch of batches) {\n    safeSend(url, `{\"stats\": [${batch.join(',')}] }`)\n  }\n\n  stats = []\n}\n\n// getBatches breaks up the list of stats into smaller batches\n// that are less than 64kb in size. This is to avoid hitting the\n// size limit of the beacon API.\nfunction getBatches(items: PlatformBrowserStat[]): string[][] {\n  const batches: string[][] = []\n  const itemStrings = items.map(item => JSON.stringify(item))\n\n  while (itemStrings.length > 0) {\n    batches.push(makeBatch(itemStrings))\n  }\n\n  return batches\n}\n\n// makeBatch walks the items and collects batches of items that are within\n// the 64kb limit. If an item is too big to fit in a batch, it is sent alone.\nfunction makeBatch(itemStrings: string[]): string[] {\n  const firstItem = itemStrings.shift()!\n  const batch: string[] = [firstItem]\n  let size = firstItem.length\n\n  while (itemStrings.length > 0 && size <= chunkSize) {\n    const nextItemSize = itemStrings[0]!.length\n\n    if (size + nextItemSize <= chunkSize) {\n      const itemString = itemStrings.shift()!\n      batch.push(itemString)\n      size += nextItemSize\n    } else {\n      break\n    }\n  }\n\n  return batch\n}\n\nfunction safeSend(url: string, data: string) {\n  try {\n    if (navigator.sendBeacon) {\n      navigator.sendBeacon(url, data)\n    }\n  } catch {\n    // Silently ignore errors: https://github.com/github/github/issues/178088#issuecomment-829936461\n  }\n}\n\nfunction isLoggedIn(): boolean {\n  return !!ssrSafeDocument?.head?.querySelector<HTMLMetaElement>('meta[name=\"user-login\"]')?.content\n}\n\nexport function isStaff(): boolean {\n  return !!ssrSafeDocument?.head?.querySelector<HTMLMetaElement>('meta[name=\"user-staff\"]')?.content\n}\n\n// Flush stats before users navigate away from the page\nssrSafeDocument?.addEventListener('pagehide', flushStats)\nssrSafeDocument?.addEventListener('visibilitychange', flushStats)\n","import type {AppendItemMDPayload, MDOperationPayload} from './types'\n\nexport async function performTasklistBlockOperation(body: string, args: MDOperationPayload) {\n  const {\n    appendItem,\n    removeItem,\n    removeTasklistBlock,\n    updateItemPosition,\n    updateItemState,\n    updateItemTitle,\n    updateTasklistTitle,\n  } = await import('./operations')\n\n  if (args.operation === 'append_item') {\n    // Let the backend handle URLs so that issues can be rendered correctly.\n    if (!/^\\s*(https?:|#)/.test(args.value)) {\n      return appendItem(body, args.position, args.value)\n    }\n  } else if (args.operation === 'update_item_title') {\n    return updateItemTitle(body, args.position, args.value)\n  } else if (args.operation === 'update_item_state') {\n    return updateItemState(body, args.position, args.closed)\n  } else if (args.operation === 'update_item_position') {\n    return updateItemPosition(body, args.src, args.dst)\n  } else if (args.operation === 'remove_item') {\n    return removeItem(body, args.position)\n  } else if (args.operation === 'remove_tasklist_block') {\n    return removeTasklistBlock(body, args.position)\n  } else if (args.operation === 'update_tasklist_title') {\n    return updateTasklistTitle(body, args.position, args.name)\n  }\n\n  return null\n}\n\nexport async function transformMarkdownToHTML(body: string) {\n  const {transformToHTML} = await import('./operations')\n  return transformToHTML(body)\n}\n\nexport function isAppendItemMDPayload(payload: MDOperationPayload): payload is AppendItemMDPayload {\n  return payload.operation === 'append_item'\n}\n"],"names":["SelectorSet","size","uid","selectors","selectorObjects","indexes","Object","create","activeIndexes","Map","docElem","window","document","documentElement","matches","webkitMatchesSelector","mozMatchesSelector","oMatchesSelector","msMatchesSelector","prototype","matchesSelector","el","selector","call","querySelectorAll","context","idRe","push","name","sel","m","match","slice","element","id","classRe","className","split","baseVal","tagRe","toUpperCase","nodeName","map","get","key","set","value","chunker","parseSelectorIndexes","allIndexes","i","j","dup","index","allIndexesLen","concat","length","rest","exec","sortById","a","b","logDefaultIndexUsed","add","data","obj","indexProto","objs","selectorIndexes","selectorIndex","findByPrototype","ary","proto","len","item","isPrototypeOf","remove","k","selIndex","removedIds","removeAll","arguments","splice","queryAll","len2","results","els","join","elements","sort","len3","keys","matchedIds","bubbleEvents","captureEvents","propagationStopped","WeakMap","immediatePropagationStopped","currentTargets","currentTargetDesc","getOwnPropertyDescriptor","Event","before","subject","verb","fn","source","apply","trackPropagation","trackImmediate","getCurrentTarget","defineCurrentTarget","event","getter","defineProperty","configurable","enumerable","dispatch","canDispatch","eventPhase","_","events","type","queue","target","reverse","node","nodeType","_matches","matched","observers","unshift","parentElement","len1","on","options","undefined","capture","addEventListener","off","removeEventListener","fire","detail","dispatchEvent","CustomEvent","bubbles","cancelable","copyText","text","navigator","clipboard","writeText","body","Promise","reject","createNode","createElement","style","width","height","position","top","textContent","appendChild","copyNode","selection","getSelection","removeAllRanges","range","createRange","selectNodeContents","addRange","execCommand","resolve","removeChild","sendData","hydroEventPayload","hydroEventHmac","hydroClientContext","visitorPayload","visitorHmac","querySelector","HTMLMetaElement","content","sendStats","trackView","getAttribute","sendHydroEvent","pendingMDAtRestTimer","lastMDAtRestPromise","TrackingBlockAPIComponent","canSync","wasInitialized","contextElement","formElement","init","appendDraftItem","payload","doMDAtRestOperation","updateDraftItemTitleMD","updateDraftItemStateMD","removeItemMD","removeTasklistBlock","addTasklistBlock","convertToIssueMD","updateTasklistTitle","updateItemPositionMD","commentElement","refreshTasklistBlocks","formId","classList","queueMDAtRestRequest","removeAttribute","clearTimeout","callback","makeRequestMDAtRest","then","disableCommentElements","disabled","disableCommentButtons","disableTasklistItemInputs","disableTasklistSortables","constructor","dispatchMDAtRestOperation","args","handled","isReact","form","field","newBody","performTasklistBlockOperation","staleOperationTrackerInput","trackingArgs","operation","parsedTrackingArgs","JSON","parse","setAttribute","stringify","e","input","handleStateChange","handler","activeElement","comment","omnibarActive","closest","morpheusEnabled","contains","setTimeout","send","error","console","beforeunload","preventDefault","returnValue","once","staleOperationsInput","staleOperationTrackerInputs","requestSubmit","err","button","toggleAttribute","tasklist","sortable","option","semanticAttributes","freeze","issueType","draftIssueType","itemUuid","itemId","itemTitle","itemState","itemPosition","displayNumber","repositoryId","repositoryName","convertButton","removeButton","draftTitle","issue","draftIssue","optimisticMetadata","TrackingBlockElement","HTMLElement","getAsJSON","items","listItem","listItems","state","isClosed","uuid","isDraft","hasAttribute","title","connectedCallback","readonly","createApiComponent","updateListInteractiveStatus","setupOmnibarListenersAndAttributes","setupSortableItemListeners","refocusOmnibarIfNecessary","setupKeyboardInteractions","handleOptimisticMetadataRerender","updateListItems","calculateListItemAvatarStack","attachCheckboxListeners","setupSaveListener","updateCompletion","dirty","tryToUpdateIfDirtyState","getOptimisticMetadata","resetOptimisticMetadata","disconnectedCallback","removeOmnibarListeners","removeSortableItemListeners","transformMarkdownToHTML","handleEditLabels","evt","handleEditMetadata","handleEditAssignees","handleEditProject","handleMarkAsDone","KeyboardEvent","code","getTargetBySelector","checkBox","closeMenuPopover","checked","isSavingIcon","addTasklistButton","handleClosePopover","menuType","overlay","listItemId","container","hidden","details","open","avatars","Array","from","filter","nameA","innerHTML","nameB","assignees","avatar","alt","src","handleAssigneeOptimisticMetadata","checkedLabels","labelNameA","labelNameB","labels","label","badge","color","handleLabelsOptimisticMetadata","showProjectUpdateToast","toggleLabelCountPopover","popover","getSiblingTargetBySelector","stopPropagation","hideLabelCountPopover","handleRename","isHotkey","targetElement","showDraftTitleInput","handleDraftTitleClick","HTMLAnchorElement","draftTitleInputOutFocus","hideAllTitleInputs","activateOmnibar","focusOmnibarInput","disableTasklistListener","isDisabled","customEvent","apiComponent","attributeChangedCallback","handleEvent","handleOmnibarAppend","handleTasklistTitleUpdate","handleConvertItem","handleRemoveItem","currentTarget","updateTaskItemStateMD","updateTaskItemTitleMD","handleOmnibarFocus","handleOmnibarBlur","omnibar","handleOmnibarKeydown","inputs","includes","handleDraftKeydown","omnibarInput","queueMicrotask","defaultValue","refocusOmnibarIndex","autocomplete","omnibarToggleButton","handleOmnibarToggleButtonClick","focus","convertTaskItemMD","copyBlockMarkdown","totalMarkdown","listPrefix","href","buttonEl","dropdownMenu","showTitleEditMode","titleEditMode","titleViewMode","titleInput","select","hideTitleEditMode","MouseEvent","findFormAndCommentElements","trackingBlock","blockPosition","trackingBlocks","findIndex","block","listItemPosition","children","removeTaskItemMD","omnibarPlaceholderText","currentOmnibarPlaceholder","appendTaskItem","newItem","issueNode","test","emptyIssueTemplate","cloneNode","newTitle","emptyItemTemplate","newTextarea","completed","completionCompleted","total","completionTotal","renderedTitle","renderedTitles","find","oldRenderedHTML","html","closed","trigger","menu","display","updateItemPosition","oldIndex","newIndex","srcTrackingBlock","dstTrackingBlock","to","srcTrackingBlockPosition","dstTrackingBlockPosition","dst","isListItemDraftIssue","lockForConversion","locked","interactiveElements","entries","isLockedForConversion","queryType","responseSourceType","precache","response","stale","staleBanner","itemEventHandler","nextIndex","isActionListContent","currentIndex","indexOf","altKey","isListItemIssue","getElementsByTagName","isActionMenuActive","shiftKey","parentIndex","tasklistMenuHandler","tasklistMenu","eventTarget","turboFrame","openDetails","filterableField","newFrame","avatarStack","sideBarForm","toast","checkedAvatars","emptyIcon","template","assignee","clone","img","labelsGroup","popoverTemplate","span","setColorSwatch","clonePopover","spanPopover","handleLabelOverflow","rgb","convert","setProperty","toString","hsl","titleElement","titleFormControl","titleMDDisplay","end","setSelectionRange","list","Sortable","group","animation","chosenClass","handle","onStart","onEnd","handleItemMove","ghostClass","_onDrop","destroy","show","labelContainer","loadingContainer","toggle","countPill","labelsInPopover","toggleLoadingSkeletons","overflowedLabels","calculateLabelOverflow","shownLabelsInPopover","labelName","trim","labelIndex","l","labelInPopover","hiddenCount","listItemWidth","clientWidth","titleWidth","countPillWidth","assigneesWidth","dropdownMenuWidth","offsetWidth","parseInt","getComputedStyle","marginLeft","marginRight","containerWidth","totalLabelOffset","hiddenLabels","blur","anchoredPosition","hidePopover","actionMenuBtn","completion","progress","String","updateTasklistIconState","trackingBlockIcon","trackingBlockIconWrapper","isCompleted","isInteractive","itemMenu","itemMenus","updateOmnibarInteractiveStatus","selectorName","getSelectorByName","siblingSelectorName","attr","targets","controller","TrackingBlockOmnibarElement","findTarget","updateDisabledStatus","adoptedCallback","handleAutoCompleteSelect","inputValue","composeAppendItemMDPayload","dispatchSubmitMDAtRest","relatedTarget","handleSubmit","inputFormData","FormData","env","getEnv","getLocale","locale","loadEnv","envTag","getElementById","ready","ssrSafeDocument","readyState","loaded","ssrSafeWindow","getEnabledFeaturesSet","Set","features","featureFlags","feature","toLowerCase","featuresSet","IS_SERVER","memoize","getEnabledFeatures","isFeatureEnabled","has","featureFlag","submitter","checkButtonValidity","HTMLFormElement","persistSubmitButtonValue","submit","changeValue","HTMLInputElement","fillFormValues","fields","namedItem","HTMLTextAreaElement","isFormField","isContentEditable","searchParamsFromFormData","formData","URLSearchParams","combineGetFormSearchParams","formAction","allSearchParams","search","append","serialize","findPersistedSubmitButtonValue","prepend","morphdomOptions","getNodeKey","onBeforeElUpdated","fromEl","toEl","tagName","replaceWith","keepInputValues","onBeforeElChildrenUpdated","childNodes","Node","COMMENT_NODE","onElUpdated","customEl","ancestor","morph","newEl","DocumentFragment","morphdom","after","morphContent","leading","trailing","firstChild","TEXT_NODE","nodeValue","lastChild","runtimeEnvironment","head","isEnterprise","bundler","BUNDLER","ssrSafeHistory","history","ssrSafeLocation","location","pathname","origin","hash","IS_BROWSER","wasServerRendered","Boolean","stats","stat","flushImmediately","samplingProbability","timestamp","Date","getTime","loggedIn","staff","isStaff","Math","random","flushStats","throttledScheduleSendStats","queued","throttle","requestIdleCallback","url","batch","getBatches","batches","itemStrings","makeBatch","firstItem","shift","nextItemSize","itemString","safeSend","sendBeacon","appendItem","removeItem","updateItemState","updateItemTitle","transformToHTML","isAppendItemMDPayload"],"sourceRoot":""}