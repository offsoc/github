{"version":3,"file":"chunk-app_components_behaviors_webauthn-status-element_ts-xxxxxxxxxxxx.js","mappings":"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","sources":["app/components/behaviors/webauthn-status-element.ts","ui/packages/webauthn-support-level/webauthn-support-level.ts","node_modules/@github/webauthn-json/dist/esm/webauthn-json.browser-ponyfill.js"],"sourcesContent":["import {controller, target} from '@github/catalyst'\nimport {webauthnSupportLevel, iuvpaaSupportLevel} from '@github-ui/webauthn-support-level'\n\n@controller\nexport default class WebauthnStatusElement extends HTMLElement {\n  @target supported: HTMLElement\n  @target partial: HTMLElement\n  @target unsupported: HTMLElement\n  @target fragment: HTMLElement\n\n  async connectedCallback() {\n    const webauthnSupported = await webauthnSupportLevel()\n    const iuvpaaSupported = await iuvpaaSupportLevel()\n    this.renderElement(webauthnSupported === 'supported', iuvpaaSupported === 'supported')\n  }\n\n  renderElement(webauthnSupported: boolean, iuvpaaSupported: boolean) {\n    // webauthn support\n    if (this.partial) {\n      // if webauthnSupported, hidden should be false\n      this.partial.hidden = !webauthnSupported\n    }\n\n    // similar to `partial`, if webauthn is supported, we need to set the src on the include-fragment\n    //  for it to fetch the webauthn login UX (login_fragment).\n    // This stops us from making the login_fragment call unnessesarily\n    if (this.fragment && webauthnSupported) {\n      const url = this.fragment.getAttribute('data-src')!\n      this.fragment.setAttribute('src', url)\n    }\n    // webauthn & UVPA support\n    if (this.supported) {\n      // if iuvpaaSupported, hidden should be false\n      this.supported.hidden = !iuvpaaSupported\n    }\n    // no support\n    if (this.unsupported) {\n      // if iuvpaaSupported, hidden should be true\n      this.unsupported.hidden = iuvpaaSupported\n    }\n  }\n}\n","import {supported as webauthnSupported} from '@github/webauthn-json/browser-ponyfill'\n\n// Note: the default feedback value stored in the form is 'unknown', but that\n// should not be used unless the JS fails to run.\ntype WebauthnSupportLevel = 'supported' | 'unsupported'\n\n// Calculates a string value to send to the server.\nexport function webauthnSupportLevel(): WebauthnSupportLevel {\n  return webauthnSupported() ? 'supported' : 'unsupported'\n}\n\n// Calculates a string value to send to the server.\nexport async function iuvpaaSupportLevel(): Promise<WebauthnSupportLevel> {\n  if (await window.PublicKeyCredential?.isUserVerifyingPlatformAuthenticatorAvailable()) {\n    return 'supported'\n  }\n  return 'unsupported'\n}\n","// src/webauthn-json/base64url.ts\nfunction base64urlToBuffer(baseurl64String) {\n  const padding = \"==\".slice(0, (4 - baseurl64String.length % 4) % 4);\n  const base64String = baseurl64String.replace(/-/g, \"+\").replace(/_/g, \"/\") + padding;\n  const str = atob(base64String);\n  const buffer = new ArrayBuffer(str.length);\n  const byteView = new Uint8Array(buffer);\n  for (let i = 0; i < str.length; i++) {\n    byteView[i] = str.charCodeAt(i);\n  }\n  return buffer;\n}\nfunction bufferToBase64url(buffer) {\n  const byteView = new Uint8Array(buffer);\n  let str = \"\";\n  for (const charCode of byteView) {\n    str += String.fromCharCode(charCode);\n  }\n  const base64String = btoa(str);\n  const base64urlString = base64String.replace(/\\+/g, \"-\").replace(\n    /\\//g,\n    \"_\"\n  ).replace(/=/g, \"\");\n  return base64urlString;\n}\n\n// src/webauthn-json/convert.ts\nvar copyValue = \"copy\";\nvar convertValue = \"convert\";\nfunction convert(conversionFn, schema, input) {\n  if (schema === copyValue) {\n    return input;\n  }\n  if (schema === convertValue) {\n    return conversionFn(input);\n  }\n  if (schema instanceof Array) {\n    return input.map((v) => convert(conversionFn, schema[0], v));\n  }\n  if (schema instanceof Object) {\n    const output = {};\n    for (const [key, schemaField] of Object.entries(schema)) {\n      if (schemaField.derive) {\n        const v = schemaField.derive(input);\n        if (v !== void 0) {\n          input[key] = v;\n        }\n      }\n      if (!(key in input)) {\n        if (schemaField.required) {\n          throw new Error(`Missing key: ${key}`);\n        }\n        continue;\n      }\n      if (input[key] == null) {\n        output[key] = null;\n        continue;\n      }\n      output[key] = convert(\n        conversionFn,\n        schemaField.schema,\n        input[key]\n      );\n    }\n    return output;\n  }\n}\nfunction derived(schema, derive) {\n  return {\n    required: true,\n    schema,\n    derive\n  };\n}\nfunction required(schema) {\n  return {\n    required: true,\n    schema\n  };\n}\nfunction optional(schema) {\n  return {\n    required: false,\n    schema\n  };\n}\n\n// src/webauthn-json/basic/schema.ts\nvar publicKeyCredentialDescriptorSchema = {\n  type: required(copyValue),\n  id: required(convertValue),\n  transports: optional(copyValue)\n};\nvar simplifiedExtensionsSchema = {\n  appid: optional(copyValue),\n  appidExclude: optional(copyValue),\n  credProps: optional(copyValue)\n};\nvar simplifiedClientExtensionResultsSchema = {\n  appid: optional(copyValue),\n  appidExclude: optional(copyValue),\n  credProps: optional(copyValue)\n};\nvar credentialCreationOptions = {\n  publicKey: required({\n    rp: required(copyValue),\n    user: required({\n      id: required(convertValue),\n      name: required(copyValue),\n      displayName: required(copyValue)\n    }),\n    challenge: required(convertValue),\n    pubKeyCredParams: required(copyValue),\n    timeout: optional(copyValue),\n    excludeCredentials: optional([publicKeyCredentialDescriptorSchema]),\n    authenticatorSelection: optional(copyValue),\n    attestation: optional(copyValue),\n    extensions: optional(simplifiedExtensionsSchema)\n  }),\n  signal: optional(copyValue)\n};\nvar publicKeyCredentialWithAttestation = {\n  type: required(copyValue),\n  id: required(copyValue),\n  rawId: required(convertValue),\n  authenticatorAttachment: optional(copyValue),\n  response: required({\n    clientDataJSON: required(convertValue),\n    attestationObject: required(convertValue),\n    transports: derived(\n      copyValue,\n      (response) => {\n        var _a;\n        return ((_a = response.getTransports) == null ? void 0 : _a.call(response)) || [];\n      }\n    )\n  }),\n  clientExtensionResults: derived(\n    simplifiedClientExtensionResultsSchema,\n    (pkc) => pkc.getClientExtensionResults()\n  )\n};\nvar credentialRequestOptions = {\n  mediation: optional(copyValue),\n  publicKey: required({\n    challenge: required(convertValue),\n    timeout: optional(copyValue),\n    rpId: optional(copyValue),\n    allowCredentials: optional([publicKeyCredentialDescriptorSchema]),\n    userVerification: optional(copyValue),\n    extensions: optional(simplifiedExtensionsSchema)\n  }),\n  signal: optional(copyValue)\n};\nvar publicKeyCredentialWithAssertion = {\n  type: required(copyValue),\n  id: required(copyValue),\n  rawId: required(convertValue),\n  authenticatorAttachment: optional(copyValue),\n  response: required({\n    clientDataJSON: required(convertValue),\n    authenticatorData: required(convertValue),\n    signature: required(convertValue),\n    userHandle: required(convertValue)\n  }),\n  clientExtensionResults: derived(\n    simplifiedClientExtensionResultsSchema,\n    (pkc) => pkc.getClientExtensionResults()\n  )\n};\n\n// src/webauthn-json/basic/api.ts\nfunction createRequestFromJSON(requestJSON) {\n  return convert(base64urlToBuffer, credentialCreationOptions, requestJSON);\n}\nfunction createResponseToJSON(credential) {\n  return convert(\n    bufferToBase64url,\n    publicKeyCredentialWithAttestation,\n    credential\n  );\n}\nfunction getRequestFromJSON(requestJSON) {\n  return convert(base64urlToBuffer, credentialRequestOptions, requestJSON);\n}\nfunction getResponseToJSON(credential) {\n  return convert(\n    bufferToBase64url,\n    publicKeyCredentialWithAssertion,\n    credential\n  );\n}\n\n// src/webauthn-json/basic/supported.ts\nfunction supported() {\n  return !!(navigator.credentials && navigator.credentials.create && navigator.credentials.get && window.PublicKeyCredential);\n}\n\n// src/webauthn-json/browser-ponyfill.ts\nasync function create(options) {\n  const response = await navigator.credentials.create(\n    options\n  );\n  response.toJSON = () => createResponseToJSON(response);\n  return response;\n}\nasync function get(options) {\n  const response = await navigator.credentials.get(\n    options\n  );\n  response.toJSON = () => getResponseToJSON(response);\n  return response;\n}\nexport {\n  create,\n  get,\n  createRequestFromJSON as parseCreationOptionsFromJSON,\n  getRequestFromJSON as parseRequestOptionsFromJSON,\n  supported\n};\n//# sourceMappingURL=webauthn-json.browser-ponyfill.js.map\n"],"names":["WebauthnStatusElement","HTMLElement","connectedCallback","webauthnSupported","webauthnSupportLevel","iuvpaaSupported","iuvpaaSupportLevel","renderElement","partial","hidden","fragment","url","getAttribute","setAttribute","supported","unsupported","target","controller","window","PublicKeyCredential","isUserVerifyingPlatformAuthenticatorAvailable","base64urlToBuffer","baseurl64String","padding","slice","length","str","atob","replace","buffer","ArrayBuffer","byteView","Uint8Array","i","charCodeAt","bufferToBase64url","charCode","String","fromCharCode","base64String","copyValue","convertValue","convert","conversionFn","schema","input","Array","map","v","Object","output","key","schemaField","entries","derive","required","derived","optional","publicKeyCredentialDescriptorSchema","type","id","transports","simplifiedExtensionsSchema","appid","appidExclude","credProps","simplifiedClientExtensionResultsSchema","credentialCreationOptions","publicKey","rp","user","name","displayName","challenge","pubKeyCredParams","timeout","excludeCredentials","authenticatorSelection","attestation","extensions","signal","publicKeyCredentialWithAttestation","rawId","authenticatorAttachment","response","clientDataJSON","attestationObject","_a","getTransports","call","clientExtensionResults","pkc","getClientExtensionResults","credentialRequestOptions","mediation","rpId","allowCredentials","userVerification","publicKeyCredentialWithAssertion","authenticatorData","signature","userHandle","createRequestFromJSON","requestJSON","getRequestFromJSON","navigator","credentials","create","get","options","toJSON"],"sourceRoot":""}