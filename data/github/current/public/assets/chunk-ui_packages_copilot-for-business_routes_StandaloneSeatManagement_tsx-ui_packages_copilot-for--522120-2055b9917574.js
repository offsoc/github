"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_copilot-for-business_routes_StandaloneSeatManagement_tsx-ui_packages_copilot-for--522120"],{13260:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ew});var a=s(74848),n=s(46996),i=s(82897),l=s(47553),r=s(55847),o=s(75177),c=s(33520),d=s(96540);let u=(0,d.createContext)(null);function m(){let e=(0,d.useContext)(u);if(!e)throw Error("useSeatManagementContext must be used within a SeatManagementContextProvider");return e}let h={formattedCancellationDate:e=>{if(!e.pending_cancellation_date)return"";let t=new Date(e.pending_cancellation_date);return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()).toLocaleDateString("default",{month:"short",day:"numeric",year:"numeric"})},isPendingCreation:e=>!e.id&&"pending_creation"===e.status,isPendingCancellation:e=>!!e.pending_cancellation_date,isPendingReassignment:e=>"pending_reassignment"===e.status,isPendingUnassignment:e=>"pending_unassignment"===e.status,isStable:e=>"stable"===e.status,isSelectable:e=>!h.isPendingCreation(e)&&!h.isPendingCancellation(e)&&!h.isPendingReassignment(e)&&!h.isPendingUnassignment(e),toRemotePayload:e=>({id:e.assignable.id,name:e.assignable.slug,type:e.assignable_type}),selectedAssignmentsInjector:(e,t,s,a)=>e.reduce((e,a)=>{let[n,i]=a.split("_"),l=Number(i),r=t.find(e=>e.assignable.id===l);return r?s(r,e):e},a)};var p=s(69909),g=s(86079),x=s(84006);function f({isActive:e}){(0,d.useEffect)(()=>(document.body.style.overflow=e?"hidden":"initial",()=>{document.body.style.overflow="initial"}),[e])}var y=s(13543);function b(e){let{toCancel:t}=e;return 1===t.length?(0,a.jsx)(p.A,{as:"span",sx:{fontWeight:600},children:t[0]?.name}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.A,{as:"span",sx:{fontWeight:600},children:t.length})," ","teams"]})}function j(e){let{onConfirm:t,onCancel:s,isOpen:n,error:i,toCancel:l}=e;if(f({isActive:n}),!n)return null;let r=Array.isArray(l)?l:[l],c=(0,x.td)(r.length,"team","s",!1);return(0,a.jsx)(g.l,{title:`Cancel ${c} access`,renderBody:()=>(0,a.jsxs)(o.A,{sx:{p:3},children:[i&&(0,a.jsx)(y.p,{variant:"danger",sx:{mb:2},children:i}),(0,a.jsxs)("p",{children:["Please confirm you want to remove access for ",(0,a.jsx)(b,{toCancel:r})," to Copilot Business."]}),(0,a.jsx)("p",{children:"The seats will be removed and users will lose access to Copilot Business at the end of the billing period."})]}),onClose:s,footerButtons:[{content:"Cancel",onClick:s,sx:{mr:2}},{content:`Remove ${c} access`,onClick:t,buttonType:"danger"}]})}try{b.displayName||(b.displayName="RemovalDialogText")}catch{}try{j.displayName||(j.displayName="RemoveTeamAssignmentsDialog")}catch{}var C=s(74759),S=s(39531);let A=(0,S.Z)("/enterprises/{slug}/enterprise_licensing/copilot/seat_management/download_usage"),N=(0,S.Z)("/enterprises/{slug}/enterprise_licensing/copilot");function _({owner:e,onComplete:t,onError:s}){let[a,n]=(0,d.useState)(""),[i]=(0,C.CF)(N,{slug:e})({resource:"seat_management",method:"POST"});return{createAssignment:(0,d.useCallback)(e=>{i({payload:{enterprise_team_ids:Array.isArray(e)?e.map(e=>e.id):[e.id]},onComplete:e=>{n(""),e&&t?.(e)},onError:()=>{n("Something went wrong. Please try again later."),s?.()}})},[i,t,s]),error:a}}var v=s(59857),w=s(8243),k=s(89169),R=s(17909),P=s(281),D=s(87330);function I(e){let{isVisible:t,testId:s}=e,n=(0,d.useRef)(null);return t?(0,a.jsxs)(P.W,{children:[(0,a.jsx)(P.W.Anchor,{children:(0,a.jsx)(D.K,{unsafeDisableTooltip:!0,icon:v.KebabHorizontalIcon,variant:"invisible","aria-label":"Open column options",ref:n,"data-testid":s,sx:{height:"28px",width:"28px"}})}),(0,a.jsx)(P.W.Overlay,{children:(0,a.jsx)(R.l,{selectionVariant:"single",children:e.children})})]}):null}try{I.displayName||(I.displayName="RowActionsMenu")}catch{}var T=s(4506);function B(e){let{seatAssignment:t}=e,s="";return h.isPendingCreation(t)||h.isPendingReassignment(t)?s="Pending assignment":t.pending_cancellation_date?s=`Access will be removed on ${h.formattedCancellationDate(t)}`:h.isPendingUnassignment(t)&&(s="Pending unassignment"),s||(s=(0,a.jsx)(M,{seatAssignment:t})),(0,a.jsx)(o.A,{as:"span",className:"flex-shrink-0 pr-3",sx:{textAlign:"center",color:"fg.muted",fontSize:12},children:s})}function M(e){let{seatAssignment:t}=e;return(0,a.jsx)(a.Fragment,{children:t.last_activity_at?(0,a.jsxs)(a.Fragment,{children:["Last active ",(0,a.jsx)(k.A,{date:new Date(t.last_activity_at),"data-testid":"last-usage"})]}):"No activity yet"})}function O(e){let{checked:t,handleCheck:s,seatAssignment:n,handleCancel:i,handleRestore:l,withRowActions:r=!0}=e,c=h.isPendingCreation(n)||h.isPendingReassignment(n)||h.isPendingUnassignment(n)||e.disabled,d=!t&&!h.isPendingCreation(n)&&!h.isPendingReassignment(n)&&!h.isPendingUnassignment(n)&&r,u=()=>{l(h.toRemotePayload(n))},m=e.statusInfo;return(0,a.jsxs)(o.A,{as:"li",className:"d-flex flex-items-center member-list-item border border-top-0",sx:{backgroundColor:t?"accent.subtle":"initial",boxShadow:t?"rgb(9, 105, 218) 0px 0px 0px 1px":"none",":last-child":{borderBottomRightRadius:2,borderBottomLeftRadius:2},"&:hover":{backgroundColor:t?"accent.subtle":"neutral.subtle"},px:3,py:2},children:[(0,a.jsx)(T.K,{checked:t,onChange:s,selectable:n,isDisabled:c}),(0,a.jsxs)(o.A,{sx:{display:"flex",flexGrow:1,alignItems:"center",justifyContent:"space-between"},children:[(0,a.jsx)(w.A,{seat:n,owner:e.owner,muteTitle:c}),m?(0,a.jsxs)(m,{children:[h.isStable(n)?"Access already granted":""," "]}):(0,a.jsx)(B,{seatAssignment:n}),(0,a.jsx)(I,{isVisible:d,testId:`seat-options-${n.assignable.id}`,children:h.isPendingCancellation(n)?(0,a.jsx)(R.l.Item,{"aria-checked":!1,onSelect:()=>{u()},sx:{whiteSpace:"nowrap","> span:first-child":{display:"none"}},children:"Re-assign team access"}):(0,a.jsx)(R.l.Item,{variant:"danger",onSelect:i,sx:{"> span:first-child":{display:"none"}},"aria-checked":!1,children:"Cancel team access"})})]})]})}try{B.displayName||(B.displayName="Status")}catch{}try{M.displayName||(M.displayName="LastUsage")}catch{}try{O.displayName||(O.displayName="SelectableTableRow")}catch{}let F=e=>e.includes("asc")?v.SortAscIcon:v.SortDescIcon,E={name_asc:"Name ascending",name_desc:"Name descending",use_asc:"Last used date ascending",use_desc:"Last used date descending",requested_at_asc:"Request date ascending",requested_at_desc:"Request date descending",pending_cancelled_asc:"Cancelled first",pending_cancelled_desc:"Cancelled last",member_count_asc:"Member count ascending",member_count_desc:"Member count descending"},z={name_asc:"Name ascending (A\u2026Z)",name_desc:"Name descending (Z\u2026A)",use_asc:"Last used date (Oldest first)",use_desc:"Last used date (Newest first)",requested_at_asc:"Requested date (Oldest first)",requested_at_desc:"Requested date (Newest first)",pending_cancelled_asc:"Cancelled first",pending_cancelled_desc:"Cancelled last",member_count_asc:"Member count (Least first)",member_count_desc:"Member count (Most first)"};function L(e){let{sort:t,sortDetails:s,sortOptions:n,cancellation:i}=e,[l,r]=(0,d.useState)("pending_cancelled_asc"===s);(0,d.useEffect)(()=>{i||"pending_cancelled_asc"!==s||r(!1)},[i,s]);let o=(0,d.useCallback)(e=>{r(!0),t(e)},[t]),c=(0,d.useMemo)(()=>n.map((e,t)=>{let n={};return 0===t&&(n={"&:before":{content:" ",display:"block",position:"absolute",width:"100%",top:"-7px",borderWidth:"1px 0px 0px",borderStyle:"solid",borderImage:"initial",borderColor:"var(--divider-color,transparent)"}}),(0,a.jsx)(W,{label:z[e],sort:e,sortDetails:s,doSort:o,sx:n},e)}),[o,s,n]);return(0,a.jsxs)(P.W,{children:[(0,a.jsx)(P.W.Button,{sx:{border:0,boxShadow:"none",color:"fg.muted"},leadingVisual:F(s),"data-testid":"sort-button",children:l?E[s]:"Sort"}),(0,a.jsx)(P.W.Overlay,{width:"medium","data-testid":"sort-options",children:(0,a.jsx)(R.l,{selectionVariant:"single",showDividers:!0,children:c.map(e=>e)})})]})}let W=e=>{let{label:t,sort:s,sortDetails:n,doSort:i,sx:l}=e;return(0,a.jsx)(R.l.Item,{selected:n===s,onSelect:()=>i(s),sx:l,"data-testid":`sort-option-${s}`,children:t})};try{L.displayName||(L.displayName="AssignablesSort")}catch{}try{W.displayName||(W.displayName="SortOption")}catch{}let q=(0,d.createContext)(null);function $(){let e=(0,d.useContext)(q);if(!e)throw Error("useSelectionStateContext must be used within a SelectionStateProvider");return e}var U=s(30729);function V(){return(0,a.jsxs)(o.A,{className:"Box blankslate",sx:{borderTopRightRadius:0,borderTopLeftRadius:0},children:[(0,a.jsx)(U.A,{icon:v.PersonIcon,size:24,sx:{color:"fg.subtle",mb:3}}),(0,a.jsx)("h2",{className:"blankslate-heading",children:"Nothing matched your search criteria"}),(0,a.jsx)(o.A,{sx:{alignItems:"center",display:"flex",flexDirection:"column"},children:(0,a.jsx)("p",{children:"Make sure that everything is spelt correctly or try different keywords."})})]})}try{V.displayName||(V.displayName="NoSearchResultsBlankslate")}catch{}let H=["name_asc","name_desc","member_count_asc","member_count_desc"];function G(e){let{payload:t,update:s}=m(),{seatAssignments:n,count:i,filtered_count:u,business:p}=t,g=p.slug,x=e.items??n,{withDelete:f=!0,query:y,denySelectionFilters:b=[]}=e,{selectionState:S}=$(),{checkCount:A,allChecked:w,isIndeterminate:k,checkOne:R,checkAll:P,uncheckAll:D,isChecked:I,selectedItems:T}=S,{confirmCancellation:B,rejectConfirmation:M,cancellationError:F,pendingConfirmation:E,beginCancel:z}=function(e){let{owner:t,onError:s,onComplete:a}=e,[n,i]=(0,d.useState)(!1),[l,r]=(0,d.useState)(""),[o]=(0,C.CF)(N,{slug:t})({resource:"seat_management",method:"DELETE"}),c=(0,d.useCallback)(()=>{i(!1),r("")},[]),u=(0,d.useCallback)(()=>{i(!0)},[]);return{confirmCancellation:(0,d.useCallback)(e=>{o({payload:e,onError:()=>{r("Something went wrong. Please try again later."),s?.()},onComplete:e=>{i(!1),r(""),e&&a?.(e)}})},[o,a,s]),rejectConfirmation:c,beginCancel:u,cancellationError:l,pendingConfirmation:n}}({owner:g,onComplete:e=>{s(e),D(),Z(null)}}),{createAssignment:W}=_({owner:g,onComplete:e=>{s(e),D(),Z(null)}}),q=A>0,U=x.some(h.isSelectable),G=(0,d.useCallback)(e=>()=>{R(e),Z(null)},[R]),K=(0,d.useCallback)(e=>()=>{if(!e.id)return Z(null);Z(h.toRemotePayload(e)),z()},[z]),[Q,Z]=(0,d.useState)(null),Y=(0,d.useMemo)(()=>h.selectedAssignmentsInjector(T,x,(e,t)=>{let s=h.toRemotePayload(e);return t.push(s),t},[]),[T,x]),J=(0,d.useMemo)(()=>Q?`enterprise_team_ids[]=${encodeURIComponent(Q.id)}`:Y.map(e=>`enterprise_team_ids[]=${encodeURIComponent(e.id)}`).join("&"),[Y,Q]),X=(0,d.useCallback)(t=>{e.setSortDetails(t)},[e]);return(0,a.jsxs)("div",{role:"region","aria-label":"Seats management table",children:[(0,a.jsxs)("div",{className:"mt-3 d-flex flex-items-center px-3 table-list-header table-list-header-next py-1",role:"region","aria-label":"Seat management table header",children:[(0,a.jsx)("div",{className:"select-all-dropdown flex-auto",children:(0,a.jsxs)("div",{className:"d-flex flex-items-center",children:[(0,a.jsx)("div",{className:"pr-2",children:(0,a.jsx)(l.A,{onChange:P,indeterminate:k,disabled:!U,checked:w,"data-testid":"selectAll",sx:{height:13,width:13},"aria-label":"Select all members"})}),(0,a.jsx)("div",{className:"text-bold",children:e.headerText({selectedCount:A,totalCount:i})})]})}),q&&f?(0,a.jsx)(r.Q,{size:"small",leadingVisual:v.TrashIcon,variant:"danger",onClick:z,"data-testid":"bulk-remove-button",children:"Cancel team access"}):(0,a.jsx)(L,{sort:X,sortDetails:e.sortDetails,sortOptions:H})]}),(0,a.jsx)("div",{id:"table-body",children:(0,a.jsxs)(o.A,{as:"ul","aria-label":"Teams list",className:"table-list-bordered","data-testid":"cs-seat-assignments",sx:{position:"relative"},children:[y&&0===x.length&&(0,a.jsx)(V,{}),x.map((t,s)=>(0,a.jsx)(O,{seatAssignment:t,checked:I(t),handleCheck:G(t),handleCancel:K(t),handleRestore:W,owner:g,withRowActions:e.withRowActions??!0,disabled:b.some(e=>e(t)),statusInfo:e.statusInfo},s))]})}),u>25&&(0,a.jsx)(c.A,{showPages:u>25,pageCount:Math.ceil(u/25),currentPage:e.currentPage,onPageChange:(t,s)=>{t.preventDefault(),e.paginate(s)},"data-testid":"pagination"}),(0,a.jsx)(j,{isOpen:E,onCancel:M,onConfirm:()=>B(J),error:F,toCancel:Q||Y})]})}try{G.displayName||(G.displayName="SelectableTable")}catch{}var K=s(38553);function Q({children:e}){return(0,a.jsx)(a.Fragment,{children:e})}function Z({children:e}){return(0,a.jsx)(a.Fragment,{children:e})}function Y(e){let t=d.Children.toArray(e.children).filter(e=>e.type===J.LeftAction),s=d.Children.toArray(e.children).filter(e=>e.type===J.RightAction);return(0,a.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[t,s]})}let J=Object.assign(Y,{LeftAction:Q,RightAction:Z});try{Q.displayName||(Q.displayName="LeftAction")}catch{}try{Z.displayName||(Z.displayName="RightAction")}catch{}try{Y.displayName||(Y.displayName="Actions")}catch{}try{J.displayName||(J.displayName="ActionsBar")}catch{}var X=s(44981);function ee(e){let{filter:t,filterItem:s,selected:n}=e,i=(0,d.useCallback)(()=>t(s),[s,t]);return(0,a.jsx)(R.l.Item,{onSelect:i,selected:n,children:s})}function et(e){let{placeholder:t,search:s,searchProps:n,...i}=e;!function(e){if(("filter"in e||"currentFilter"in e||"filterOptions"in e)&&!("filter"in e&&"currentFilter"in e&&"filterOptions"in e))throw Error("If any of filter, currentFilter, or filterOptions is provided, all must be provided.")}(i);let l=i.filterOptions&&{borderTopLeftRadius:0,borderBottomLeftRadius:0}||{};return(0,a.jsxs)(a.Fragment,{children:[i.filterOptions&&i.filterOptions.length>0&&(0,a.jsxs)(P.W,{children:[(0,a.jsx)(P.W.Anchor,{children:(0,a.jsx)(D.K,{unsafeDisableTooltip:!0,icon:v.FilterIcon,variant:"default","aria-label":"Open filter options",sx:{borderRight:0,borderTopRightRadius:0,borderBottomRightRadius:0}})}),(0,a.jsx)(P.W.Overlay,{width:"medium",children:(0,a.jsx)(R.l,{"data-testid":"copilot-user-search-filter",selectionVariant:"single",showDividers:!0,children:i.filterOptions.map(e=>(0,a.jsx)(ee,{filter:i.filter,filterItem:e,selected:e===i.currentFilter},e))})})]}),(0,a.jsx)(X.A,{leadingVisual:v.SearchIcon,"aria-label":t??"Search by name or email",name:"search-seats",placeholder:t??"Search by name or email","data-testid":"cfb-search-seats",block:!0,sx:{...l,...n},onChange:e=>s(e.target.value)})]})}try{ee.displayName||(ee.displayName="FilterOption")}catch{}try{et.displayName||(et.displayName="FilterableSearch")}catch{}var es=s(55266);function ea({onSearch:e,onAddTeams:t}){let{payload:s}=m(),{loading:n,makeCSVRequest:i}=(0,es.w)({slug:s.business.slug,endpoint:A});return(0,a.jsx)("section",{"aria-label":"Management actions",children:(0,a.jsxs)(J,{children:[(0,a.jsx)(J.LeftAction,{children:(0,a.jsx)(o.A,{sx:{width:"25%"},children:(0,a.jsx)(o.A,{sx:{display:"flex"},children:(0,a.jsx)(et,{placeholder:"Filter enterprise teams",search:e})})})}),(0,a.jsx)(J.RightAction,{children:(0,a.jsxs)(o.A,{sx:{display:"flex",alignItems:"center"},children:[n&&(0,a.jsx)(K.A,{sx:{marginRight:2},size:"small","aria-label":"Loading a csv report"}),(0,a.jsx)(r.Q,{className:"mr-2",leadingVisual:v.FileIcon,onClick:i,name:"get report",children:"Get report"}),(0,a.jsx)(r.Q,{variant:"primary",onClick:t,children:"Add teams"})]})})]})})}try{ea.displayName||(ea.displayName="StandaloneActionsBar")}catch{}var en=s(13761);function ei(e){return(0,a.jsx)(en.BM,{role:"region","aria-label":"No teams assigned",sx:{px:4,py:6,display:"flex",flexDirection:"column",alignItems:"center"},children:(0,a.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,a.jsx)(p.A,{as:"h2",sx:{fontSize:4,fontWeight:600},children:"No teams assigned"}),(0,a.jsx)(p.A,{as:"p",sx:{color:"fg.default",width:"75%",mt:1,textAlign:"center"},children:"No members are using Copilot Business in this enterprise. To maximize your developer velocity using AI, start assigning seats to teams."}),(0,a.jsx)(r.Q,{variant:"primary",sx:{mt:3},onClick:e.onAddTeams,children:"Start adding teams"})]})})}try{ei.displayName||(ei.displayName="StandaloneBlankslate")}catch{}var el=s(89184),er=s(97156),eo=s(86519),ec=s(52338);function ed(e){let{children:t,sx:s={},...n}=e;return(0,a.jsx)(o.A,{sx:{borderWidth:1,borderStyle:"solid",borderColor:"border.subtle",borderRadius:6,p:3,...s},...n,children:t})}let eu=e=>(0,a.jsx)(ed,{sx:{display:"flex",flexDirection:"column",flex:"1 0 0%",alignSelf:"start"},children:e.children});function em(e){return(0,a.jsxs)(o.A,{as:"section",sx:{display:"flex",width:"100%",gap:3,marginBottom:3},role:"region","aria-label":"Insights",children:[(0,a.jsxs)(eu,{children:[(0,a.jsx)(p.A,{as:"p",sx:{fontWeight:600,fontSize:14},children:"Total consumed seats"}),(0,a.jsx)(p.A,{as:"p",sx:{fontSize:4,color:"fg.default"},"data-testid":"license-pulse-text",children:e.licenses}),(0,a.jsx)(p.A,{as:"p",sx:{color:"fg.muted",fontSize:12,marginBottom:0},children:"Number of unique members with access to Copilot Business."})]}),(0,a.jsxs)(eu,{children:[(0,a.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,a.jsx)(p.A,{as:"p",sx:{fontWeight:600,fontSize:14},children:"Estimated monthly cost"}),(0,a.jsx)(eo.A,{target:"_blank",href:`${er.fV.origin}/enterprises/${e.slug}/settings/billing`,children:"Review billing details"})]}),(0,a.jsx)(p.A,{as:"p",sx:{fontSize:4,color:"fg.default"},"data-testid":"cost-pulse-text",children:`${(0,el.Gl)(e.licenses*ec._L)}`}),(0,a.jsxs)(p.A,{as:"p",sx:{color:"fg.muted",fontSize:12,marginBottom:0},"data-testid":"per-seat-pulse-text",children:["Each purchased seat is $",ec._L," USD/month."]})]})]})}try{ed.displayName||(ed.displayName="Card")}catch{}try{eu.displayName||(eu.displayName="PulseCard")}catch{}try{em.displayName||(em.displayName="PulseCheck")}catch{}var eh=s(47141),ep=s(82678),eg=s(94120);function ex(e){return(0,a.jsx)("section",{"aria-label":"New assignments estimated cost",children:(0,a.jsxs)("span",{children:[(0,a.jsxs)(p.A,{sx:{fontWeight:600,mb:0,fontSize:12},as:"p",children:[(0,x.td)(e.seatCount,"unique seat","s")," with an approximate cost of"," ",(0,el.Gl)(e.seatCost*e.seatCount)," will be added."]}),(0,a.jsxs)(p.A,{sx:{color:"fg.muted",fontSize:12},children:["You will not be charged twice for members across multiple teams."," "]})]})})}try{ex.displayName||(ex.displayName="NewAssignmentsEstimatedCost")}catch{}function ef(e){let t=function(e){let{selectables:t,total:s}=e,a=(0,d.useRef)(e.filters??[]),n=(0,d.useRef)(e.key),[i,l]=(0,d.useState)(!1),[r,o]=(0,d.useState)({}),[c,u]=(0,d.useState)(!1),[m,h]=(0,d.useState)(s??t.length),p=(0,d.useMemo)(()=>Object.values(r).filter(Boolean).length,[r]),g=(0,d.useMemo)(()=>t.filter(e=>a.current.every(t=>t(e))).length,[t]),x=(0,d.useMemo)(()=>Object.entries(r).reduce((e,[t,s])=>(s&&e.push(t),e),[]),[r]),f=(0,d.useCallback)(()=>{if(c){u(!1),o({});return}u(!0),o(e.selectables.reduce((e,t)=>(a.current.every(e=>e(t))&&(e[n.current(t)]=!0),e),{}))},[e.selectables,c]),y=(0,d.useCallback)(e=>!!r[n.current(e)],[r]),b=(0,d.useCallback)(e=>{let t={...r};t[n.current(e)]=!y(e),o(t)},[r,y]),j=(0,d.useCallback)(()=>{u(!1),o({})},[]);return(0,d.useEffect)(()=>{0===p?(l(!1),u(!1)):p===g?(l(!1),u(!0)):(l(!0),u(!1))},[m,p,g]),(0,d.useEffect)(()=>{h(s??t.length)},[t,s]),{allChecked:c,checkCount:p,isIndeterminate:i,selectables:e.selectables,selectedItems:x,total:e.total,isChecked:y,checkOne:b,checkAll:f,uncheckAll:j}}(e.selectionState),[s,n]=(0,d.useState)({}),i=(0,d.useMemo)(()=>({selectionState:t,stableRef:s,updateStableRef:n}),[t,s,n]);return(0,a.jsx)(q.Provider,{value:i,children:e.children})}try{ef.displayName||(ef.displayName="SelectionStateProvider")}catch{}function ey(e){return`${e.assignable_type}_${e.assignable.id}`}function eb(e){return(0,a.jsx)(p.A,{as:"span",className:"flex-shrink-0 pr-3",sx:{textAlign:"center",color:"fg.muted",fontSize:12},children:e.children})}try{eb.displayName||(eb.displayName="StatusText")}catch{}function ej({loading:e,listEndRef:t}){return(0,a.jsxs)(a.Fragment,{children:[e&&(0,a.jsx)(o.A,{sx:{display:"flex",justifyContent:"center",p:4},children:(0,a.jsx)(K.A,{})}),(0,a.jsx)("div",{ref:t})]})}function eC(e){return e.selectedCount?(0,a.jsxs)("span",{"data-testid":"bulk-selected",children:[(0,x.td)(e.selectedCount,"team","s")," selected"]}):(0,a.jsx)("span",{children:"0 selected"})}let eS=[h.isStable];function eA(e){let{selectionState:t}=$(),{queryState:s}=e;return(0,a.jsxs)(o.A,{as:"section",sx:{padding:3,maxHeight:360,overflowY:"auto"},children:[(0,a.jsx)(et,{search:s.handleSearch,placeholder:"Filter enterprise teams"}),(0,a.jsx)(G,{query:s.query,paginate:s.paginate,currentPage:s.currentPage,sortDetails:s.sortDetails,setSortDetails:s.updateSortDetails,items:t.selectables,headerText:eC,denySelectionFilters:eS,withDelete:!1,withRowActions:!1,statusInfo:eb}),e.children]})}function eN(e){let{isOpen:t,onClose:s}=e,{selectionState:n,stableRef:i,updateStableRef:l}=$(),{selectedItems:r,selectables:c}=n,[u,m]=(0,d.useState)(0);return((0,d.useEffect)(()=>{for(let e of r){if(i[e])continue;let t=Number(e.split("_").pop()),s=c.find(e=>e.assignable.id===t);e in i&&!s&&(i[e]=null),s&&(i[e]=s)}for(let e in i)r.includes(e)||(i[e]=null);l(i),m(Object.values(i).reduce((e,t)=>t?new Set([...e].concat(t.assignable.member_ids)):e,new Set).size)},[r,c,i,l]),f({isActive:t}),t)?(0,a.jsx)(g.l,{onClose:s,sx:{width:"768px"},"data-testid":"add-members-dialog",title:"Add enterprise teams to enable access to Copilot Business",renderBody:()=>(0,a.jsx)(a.Fragment,{children:e.children}),renderFooter:({footerButtons:e})=>{let{containerRef:t}=(0,ep.G)({bindKeys:eg.z0.ArrowHorizontal|eg.z0.Tab,focusInStrategy:"closest"});return(0,a.jsxs)(g.l.Footer,{ref:t,sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:3,flexWrap:"nowrap"},children:[(0,a.jsx)(ex,{seatCount:u,seatCost:19}),e&&(0,a.jsx)(o.A,{sx:{display:"flex",gap:2,alignItems:"center",flexShrink:0,justifySelf:"flex-end"},children:(0,a.jsx)(g.l.Buttons,{buttons:e})})]})},footerButtons:[{content:"Cancel",onClick:s},{content:"Add teams",onClick:()=>{let t=h.selectedAssignmentsInjector(r,Object.values(i),(e,t)=>{if(!e)return t;let s=h.toRemotePayload(e);return t.push(s),t},[]);e.onConfirm(t)},buttonType:"primary"}]}):null}function e_(e){let{payload:t,update:s}=m(),{business:n}=t,i=(0,eh.D)({initialSort:"name_asc"}),{data:l,loading:r}=(0,C.RB)(N,{slug:n.slug})({resource:`members/search?${i.makeQueryString()}`}),[c,u]=(0,d.useState)(l?.teams??[]),{listEndRef:p,listHeadRef:g,doReset:x}=function(e){let{loading:t,currentPage:s,totalItems:a,pageSize:n=25,onPaginate:i,shouldLoadMore:l,shouldReset:r}=e,o=(0,d.useRef)(null),c=(0,d.useRef)(null),u=(0,d.useRef)(!1),m=(0,d.useMemo)(()=>s*n>=a,[s,a,n]),h=(0,d.useCallback)(async()=>{t||m||!l||i(s+1)},[l,t,m,s,i]),p=(0,d.useCallback)(e=>{let t=e[0];t?.isIntersecting&&h()},[h]);return(0,d.useEffect)(()=>{if(!o.current)return;let e=new IntersectionObserver(p,{root:c.current});return e.observe(o.current),()=>{e.disconnect()}},[p,c,t]),(0,d.useEffect)(()=>{r&&(u.current=!0,i(1))},[i,r]),{listEndRef:o,listHeadRef:c,doReset:u}}({shouldLoadMore:!i.query,currentPage:i.currentPage,onPaginate:i.paginate,loading:r,totalItems:l?.total??0,shouldReset:i.queryHasChanged()});(0,d.useEffect)(()=>{x.current?(u(l?.teams??[]),x.current=!1):u(e=>{let t=l?.teams??[];for(let s of e)t.some(e=>e.assignable.id===s.assignable.id)||t.push(s);return t})},[x,l]);let{createAssignment:f,error:b}=_({owner:n.slug,onComplete:t=>{e.onClose(),s(t)}}),j=(0,d.useCallback)(e=>"stable"!==e.status,[]),S=(0,d.useMemo)(()=>[h.isSelectable,j],[j]);return(0,a.jsx)(ef,{selectionState:{selectables:c,total:l?.total??0,key:ey,filters:S},children:(0,a.jsx)(eN,{...e,onConfirm:f,children:(0,a.jsxs)(o.A,{ref:g,sx:{minHeight:200},children:[b&&(0,a.jsx)(y.p,{variant:"danger",children:b}),(0,a.jsx)(eA,{queryState:i,children:(0,a.jsx)(ej,{listEndRef:p,loading:r})})]})})})}try{ej.displayName||(ej.displayName="ScrollPaginator")}catch{}try{eC.displayName||(eC.displayName="SelectableTableHeader")}catch{}try{eA.displayName||(eA.displayName="DialogBody")}catch{}try{eN.displayName||(eN.displayName="AssignmentsDialog")}catch{}try{e_.displayName||(e_.displayName="AddSeatAssignmentsDialog")}catch{}function ev(e){return e.selectedCount>0?(0,a.jsxs)("span",{"data-testid":"bulk-selected",children:[(0,x.td)(e.selectedCount,"team","s")," selected"]}):(0,a.jsxs)("span",{"data-testid":"seat-management-selected-count",children:[(0,x.td)(e.totalCount,"team","s")," with access to Copilot Business"]})}function ew(){let e=(0,i.B)(),{business:{slug:t}}=e,{currentPage:s,paginate:l,query:r,handleSearch:o,sortDetails:c,updateSortDetails:m,makeQueryString:p}=(0,eh.D)({initialSort:"name_asc"}),{data:g}=(0,C.RB)(N,{slug:t})({resource:`seat_management?${p()}`,initialData:{payload:e}}),x=(0,d.useRef)(g?.payload),[f,y]=(0,d.useState)(g?.payload??e);(0,d.useEffect)(()=>{g&&x.current&&!(0,n.A)(x.current,g)&&(y(g.payload),x.current=g.payload)},[g]);let b=(0,d.useMemo)(()=>({payload:f,update:y}),[f]),j=0!==f.count,[S,A]=(0,d.useState)(!1),_=(0,d.useCallback)(()=>A(!0),[A]),v=(0,d.useCallback)(()=>A(!1),[A]);return(0,a.jsxs)(u.Provider,{value:b,children:[(0,a.jsx)(em,{slug:f.business.slug,licenses:f.total_seats}),j&&(0,a.jsx)(ea,{onSearch:o,onAddTeams:_}),!j&&(0,a.jsx)(ei,{onAddTeams:_}),j&&(0,a.jsx)(ef,{selectionState:{selectables:f.seatAssignments,total:f.count,key:ey,filters:[h.isSelectable]},children:(0,a.jsx)(G,{query:r,paginate:l,currentPage:s,sortDetails:c,setSortDetails:m,items:f.seatAssignments,headerText:ev,denySelectionFilters:[h.isPendingCancellation]})}),S&&(0,a.jsx)(e_,{isOpen:S,onClose:v})]})}try{ev.displayName||(ev.displayName="SelectableTableHeader")}catch{}try{ew.displayName||(ew.displayName="CopilotStandaloneSeatManagement")}catch{}}}]);
//# sourceMappingURL=ui_packages_copilot-for-business_routes_StandaloneSeatManagement_tsx-ui_packages_copilot-for--522120-a1fafc85f6a9.js.map