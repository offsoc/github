"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_bypass-actors_components_bypassDialog_BypassDialog_tsx"],{18536:(e,s,a)=>{var t,r;a.d(s,{n:()=>r,v:()=>t}),function(e){e[e.ALWAYS=0]="ALWAYS",e[e.PRS_ONLY=1]="PRS_ONLY"}(t||(t={})),function(e){e.NoOrgBypass="no_org_bypass",e.OrgBypassPRsOnly="org_bypass_prs_only",e.OrgBypassAny="org_bypass_any"}(r||(r={}))},73209:(e,s,a)=>{function t(e,s,a){return a.some(({actorId:a,actorType:t})=>a===e&&t===s)}function r(e,s,a){return a.find(({actorId:a,actorType:t})=>a===e&&t===s)}a.d(s,{J:()=>t,x:()=>r})},30366:(e,s,a)=>{a.d(s,{K:()=>l});var t=a(28784);let r=(e,s,a="Unexpected error")=>async r=>{let l=await (0,t.lS)(e,{body:r,method:s});if(l.ok)try{return await l.json()}catch(e){throw Error("Failed to read response")}else throw Error(a)},l=(e,s)=>r(`${e}?q=${encodeURIComponent(s)}`,"GET")()},96238:(e,s,a)=>{a.d(s,{V:()=>l,o:()=>r});var t=a(74848);let r=({actorType:e})=>"RepositoryRole"===e||"OrganizationAdmin"===e?(0,t.jsx)("span",{className:"note ml-2",children:"Role"}):"Integration"===e?(0,t.jsx)("span",{className:"note ml-2",children:"App"}):"DeployKey"===e?null:"EnterpriseTeam"===e?(0,t.jsx)("span",{className:"note ml-2",children:"Enterprise team"}):"EnterpriseOwner"===e?(0,t.jsx)("span",{className:"note ml-2",children:"Role"}):(0,t.jsx)("span",{className:"note ml-2",children:e});function l(e){switch(e){case"RepositoryRole":case"OrganizationAdmin":case"EnterpriseOwner":return"Role";case"Integration":return"App";case"DeployKey":return"";case"EnterpriseTeam":return"Enterprise team";default:return e}}},58762:(e,s,a)=>{a.d(s,{u:()=>o});var t=a(74848),r=a(22868),l=a(30729),n=a(59857);let i={Write:n.PencilIcon,Maintain:n.ToolsIcon,"Repository admin":n.EyeIcon,"Organization admin":n.EyeIcon},o=({baseUrl:e,id:s,type:a,name:o,size:c=16})=>"Team"===a?(0,t.jsx)(r.r,{alt:o,src:`${e}/t/${s}`,size:c}):"Integration"===a?(0,t.jsx)(r.r,{alt:o,src:`${e}/in/${s}`,size:c}):"RepositoryRole"===a||"OrganizationAdmin"===a?(0,t.jsx)(l.A,{icon:i[o]||n.PersonIcon,sx:{color:"fg.muted"}}):"DeployKey"===a?(0,t.jsx)(l.A,{icon:n.KeyIcon,sx:{color:"fg.muted"}}):"EnterpriseTeam"===a||"EnterpriseOwner"===a?(0,t.jsx)(l.A,{icon:n.PeopleIcon,sx:{color:"fg.muted"}}):null},30386:(e,s,a)=>{a.d(s,{p:()=>R});var t,r=a(74848),l=a(96540),n=a(86079),i=a(59572),o=a(70170),c=a(30366),d=a(18536),p=a(75177),h=a(19797),x=a(66889),g=a(47553),m=a(30631),y=a(69909),u=a(58762),f=a(96238),A=a(73209);function j({actorId:e,actorType:s,name:a,owner:t,selected:n,setSelected:i,baseAvatarUrl:o,enabledBypassActors:c}){let h=n.some(a=>a.actorId===e&&a.actorType===s);return(0,r.jsxs)(x.A,{children:[(0,r.jsx)(g.A,{"data-testid":"bypass-dialog-checkbox",value:"actorId",checked:h||(0,A.J)(e,s,c),onChange:()=>{if(h){let a=n.findIndex(a=>a?.actorId===e&&a?.actorType===s);a>-1&&i([...n.slice(0,a),...n.slice(a+1)])}else i([...n,{actorId:e,actorType:s,name:a,_enabled:!0,_dirty:!0,bypassMode:d.v.ALWAYS,owner:t}])}}),(0,r.jsx)(x.A.LeadingVisual,{children:(0,r.jsx)(u.u,{baseUrl:o,id:e,name:a,type:s})}),(0,r.jsx)(x.A.Label,{children:(0,r.jsxs)(p.A,{sx:{display:"flex",alignItems:"center",fontWeight:"normal"},children:[(0,r.jsx)(m.A,{title:a,maxWidth:250,children:(0,r.jsx)(y.A,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:a})}),(0,r.jsx)(f.o,{actorType:s}),"Team"===s?(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)(y.A,{className:"note",sx:{marginLeft:1,marginRight:1},children:"\u2022"}),(0,r.jsx)(m.A,{title:`@${a}`,maxWidth:250,children:(0,r.jsx)(y.A,{className:"note",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:`@${a}`})})]}):null,"Integration"===s&&t?(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)(y.A,{className:"note",sx:{marginLeft:1,marginRight:1},children:"\u2022"}),(0,r.jsx)(m.A,{title:t,maxWidth:250,children:(0,r.jsx)(y.A,{className:"note",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:t})})]}):null]})})]})}try{j.displayName||(j.displayName="BypassDialogRow")}catch{}function b({suggestions:e,selected:s,setSelected:a,baseAvatarUrl:t,enabledBypassActors:l}){let n=e.filter(e=>!(0,A.J)(e.actorId,e.actorType,l));return(0,r.jsx)(p.A,{sx:{height:175},children:n.length>0?(0,r.jsx)(h.A,{"aria-labelledby":"suggestionsHeading",sx:{paddingBottom:4},children:(0,r.jsx)("ul",{className:"list-style-none",children:n.map(e=>(0,r.jsx)("li",{children:(0,r.jsx)(j,{actorId:e.actorId,actorType:e.actorType,name:e.name,owner:e.owner,selected:s,setSelected:a,baseAvatarUrl:t,enabledBypassActors:l})},`${e.actorId}-${e.actorType}`))})}):(0,r.jsx)(p.A,{sx:{py:"6%"},children:(0,r.jsx)(p.A,{sx:{textAlign:"center"},children:(0,r.jsx)(i.A,{children:(0,r.jsx)(i.A.Heading,{as:"h3",children:"No suggestions"})})})})})}try{b.displayName||(b.displayName="BypassDialogBody")}catch{}var v=a(87330),w=a(44981),I=a(59857),N=a(78680);function T({onClose:e,bypassListFilter:s,setBypassListFilter:a,dialogLabelId:t,flashAlert:i,setFlashAlert:o,addReviewerSubtitle:c}){let d=(0,l.useRef)(null);return(0,l.useEffect)(()=>{d.current?.focus()},[i,d]),(0,r.jsxs)(l.Fragment,{children:[(0,r.jsxs)(p.A,{sx:{padding:3,display:"flex",flexDirection:"column"},children:[(0,r.jsx)(N.p,{flashAlert:i,setFlashAlert:o,ref:d}),(0,r.jsxs)(p.A,{sx:{display:"flex",alignItems:"center"},children:[(0,r.jsx)(n.l.Title,{id:t,sx:{fontWeight:"bold",flex:1},children:"Add bypass"}),(0,r.jsx)(v.K,{variant:"invisible","aria-label":"Close Dialog",icon:I.XIcon,onClick:e})]}),(0,r.jsx)(y.A,{sx:{fontWeight:"normal",color:"fg.subtle"},children:c}),(0,r.jsxs)(x.A,{sx:{marginTop:1},children:[(0,r.jsx)(x.A.Label,{visuallyHidden:!0,children:"Search for bypass actors"}),(0,r.jsx)(w.A,{block:!1,sx:{width:"100%",fontWeight:"normal"},leadingVisual:I.SearchIcon,placeholder:"Search",onChange:e=>a(e.target.value),value:s})]})]}),(0,r.jsx)(p.A,{className:"color-bg-subtle color-border-default",sx:{display:"flex",paddingLeft:3,paddingTop:1,paddingBottom:1,borderTopWidth:1,borderBottomWidth:1,borderLeftWidth:0,borderRightWidth:0,borderStyle:"solid"},children:(0,r.jsx)(y.A,{id:"suggestionsHeading",className:"text-small",sx:{fontWeight:"bold",color:"fg.muted"},children:"Suggestions"})})]})}try{T.displayName||(T.displayName="BypassDialogHeader")}catch{}var S=a(15820);let R=({onClose:e,baseAvatarUrl:s,enabledBypassActors:a,addBypassActor:t,initialSuggestions:g,suggestionsUrl:m,addReviewerSubtitle:u})=>{let[f,v]=(0,l.useState)(""),[R,_]=(0,l.useState)(g),[B,W]=(0,l.useState)([]),[D,O]=(0,l.useState)({message:"",variant:"default"}),C=(0,l.useCallback)((0,o.s)(async e=>{if(""===e)_(g);else try{let s=await (0,c.K)(m,e);_(s)}catch(e){O({variant:"danger",message:"Failed to fetch suggestions"})}},200),[m,_]);(0,l.useEffect)(()=>{C(f)},[f,C]);let L=[{content:"Cancel",onClick:e,buttonType:"normal"},{content:"Add selected",onClick:()=>{for(let e of B){if(a.some(({actorId:s,actorType:a})=>s===e.actorId&&a===e.actorType)){O({variant:"danger",message:"Actor is already added"});return}"Organization admin"!==e.actorId&&t(e.actorId,e.actorType,e.name,d.v.ALWAYS,e.owner)}e()},buttonType:"primary"}],E=(0,l.useRef)(null);(0,l.useEffect)(()=>{E.current?.focus()},[D,E]);let k=R.filter(e=>!(0,A.J)(e.actorId,e.actorType,a));return(0,S.u)("a11y_add_bypass_dialog")?(0,r.jsx)(n.l,{title:"Add bypass",height:"auto",width:"xlarge",footerButtons:L,onClose:e,children:(0,r.jsxs)(n.l.Body,{sx:{padding:0},children:[(0,r.jsxs)(p.A,{sx:{marginBottom:3,display:"flex",flexDirection:"column"},children:[(0,r.jsx)(N.p,{flashAlert:D,setFlashAlert:O,ref:E}),(0,r.jsxs)(x.A,{sx:{marginTop:1},children:[(0,r.jsx)(x.A.Label,{sx:{fontWeight:"normal"},children:u}),(0,r.jsx)(w.A,{block:!1,sx:{width:"100%",fontWeight:"normal"},leadingVisual:I.SearchIcon,placeholder:"Search",onChange:e=>v(e.target.value),value:f})]})]}),(0,r.jsx)(p.A,{sx:{display:"flex",marginBottom:1},children:(0,r.jsx)(y.A,{id:"suggestionsHeading",sx:{fontWeight:"semibold"},children:"Suggestions"})}),(0,r.jsx)(p.A,{sx:{height:175},children:k.length>0?(0,r.jsx)(h.A,{"aria-labelledby":"suggestionsHeading",sx:{paddingBottom:4},children:k.map(e=>(0,r.jsx)(j,{actorId:e.actorId,actorType:e.actorType,name:e.name,owner:e.owner,selected:B,setSelected:W,baseAvatarUrl:s,enabledBypassActors:a},`${e.actorId}-${e.actorType}`))}):(0,r.jsx)(i.A,{children:(0,r.jsx)(i.A.Heading,{children:"No suggestions"})})})]})}):(0,r.jsx)(n.l,{renderHeader:({dialogLabelId:s})=>(0,r.jsx)(T,{onClose:e,bypassListFilter:f,setBypassListFilter:v,dialogLabelId:s,flashAlert:D,setFlashAlert:O,addReviewerSubtitle:u}),height:"auto",width:"xlarge",footerButtons:L,onClose:e,children:(0,r.jsx)(b,{suggestions:R,selected:B,setSelected:W,baseAvatarUrl:s,enabledBypassActors:a})})};try{R.displayName||(R.displayName="BypassDialog")}catch{}try{(t=DialogHeader).displayName||(t.displayName="DialogHeader")}catch{}},78680:(e,s,a)=>{a.d(s,{f:()=>p,p:()=>g});var t=a(74848),r=a(59857),l=a(65481),n=a(87330),i=a(96540),o=a(54156),c=a(15820);function d({variant:e,onClose:s,children:a},i){return(0,t.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pl:3,pr:2,py:2,mb:4},variant:e,tabIndex:0,ref:i,children:[a,(0,t.jsx)(n.K,{unsafeDisableTooltip:!0,variant:"invisible",icon:r.XIcon,"aria-label":"Dismiss message",sx:{">svg":{m:0,color:"fg.muted"}},onClick:s,size:"small"})]})}let p=(0,i.forwardRef)(d);function h(e){e({message:"",variant:"default"})}function x({flashAlert:e,setFlashAlert:s},a){let{addToast:r}=(0,o.Y6)(),l=(0,c.u)("convert_toasts_to_flashes");if(e.message){if(l)return(0,t.jsx)(p,{variant:e.variant,onClose:()=>h(s),ref:a,children:e.message});r({type:function(e){switch(e){case"success":return"success";case"danger":return"error";default:return"info"}}(e.variant),message:e.message}),h(s)}return null}let g=(0,i.forwardRef)(x);try{d.displayName||(d.displayName="DismissibleFlashWithRef")}catch{}try{p.displayName||(p.displayName="DismissibleFlash")}catch{}try{x.displayName||(x.displayName="DismissibleFlashOrToastWithRef")}catch{}try{g.displayName||(g.displayName="DismissibleFlashOrToast")}catch{}}}]);
//# sourceMappingURL=ui_packages_bypass-actors_components_bypassDialog_BypassDialog_tsx-bc2ca09c12de.js.map