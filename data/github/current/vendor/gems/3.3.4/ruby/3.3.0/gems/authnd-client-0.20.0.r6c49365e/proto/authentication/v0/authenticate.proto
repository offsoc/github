syntax = "proto3";
package github.authentication.v0;

option go_package = "client/proto/authentication/v0";
option ruby_package = "Authnd::Proto";

import "authentication/v0/attributes.proto";
import "authentication/v0/credentials.proto";

// AuthenticateRequest captures the authentication request parameters
message AuthenticateRequest {
	// Credentials are the credentials to validate.
	Credentials credentials = 1;

	// Reserved. Was previously the `source_ip` field.
	reserved 2;
}

// AuthenticateResponse is the result of validating the AuthtenticateRequest credentials.
message AuthenticateResponse {
	// Result is a high level result of the validation attempt.
	enum Result {
		// RESULT_UNKNOWN is not returned by the Authnd service.
		// It serves as only the zero-value for the Result type.
		RESULT_UNKNOWN = 0;
		// RESULT_SUCCESS indicates the validation succeeded.
		RESULT_SUCCESS = 1;
		// RESULT_FAILED_MAINTENANCE indicates validation was not possible
		// because GitHub is in maintainenace mode.
		RESULT_FAILED_MAINTENANCE = 2;
		// RESULT_FAILED_WEAK_PASSWORD indicates the validation was not
		// attempted due to the quality of the password.
		RESULT_FAILED_WEAK_PASSWORD = 3;
		// RESULT_FAILED_SUSPENDED indicates the validation failed
		// because the user has been suspended
		RESULT_FAILED_SUSPENDED = 4;
		// RESULT_FAILED_PUBLIC_KEY_NOT_FOUND indicates the fingerprint
		// failed to match any known key
		RESULT_FAILED_PUBLIC_KEY_NOT_FOUND = 5;
		// RESULT_FAILED_USER_UNKNOWN indicates a user for the supplied
		// credential could not be found
		RESULT_FAILED_USER_UNKNOWN = 6;
		// RESULT_FAILED_USER_DISABLED indicates a user for the supplied
		// credential is disabled
		RESULT_FAILED_USER_DISABLED = 7;
		// RESULT_FAILED_USER_SPAMMY indicates a user for the supplied
		// credential is marked as spammy
		RESULT_FAILED_USER_SPAMMY = 8;
		// RESULT_FAILED_PUBLIC_KEY_MISSING indicates a public key for the
		// supplied public key does not exists
		RESULT_FAILED_PUBLIC_KEY_MISSING = 9;
		// RESULT_FAILED_PUBLIC_KEY_MISMATCH indicates the supplied public key
		// failed to match the public key.
		RESULT_FAILED_PUBLIC_KEY_MISMATCH = 10;
		// RESULT_FAILED_PASSWORD_MISMATCH indicates the supplied password did
		// not match.
		RESULT_FAILED_PASSWORD_MISMATCH = 11;
		// RESULT_FAILED_ACCESS_TOKEN_NOT_FOUND indicates the access token
		// failed to match any known token.
		RESULT_FAILED_ACCESS_TOKEN_NOT_FOUND = 12;
		// RESULT_FAILED_ACCESS_TOKEN_LAST_EIGHT_MISMATCH indicates the last eight
		// digits of the access token did not match.
		RESULT_FAILED_ACCESS_TOKEN_LAST_EIGHT_MISMATCH = 13;
		// RESULT_FAILED_PUBLIC_KEY_MALFORMED indicates the supplied public key
		// was not properly formed.
		RESULT_FAILED_PUBLIC_KEY_MALFORMED = 14;
		// RESULT_FAILED_PUBLIC_KEY_NOT_VERIFIED indicates the supplied public key
		// has not been verified or the verification date is in the future.
		RESULT_FAILED_PUBLIC_KEY_NOT_VERIFIED = 15;
		// RESULT_FAILED_PUBLIC_KEY_ALGO_NOT_SUPPORTED is deprecated and no longer returned.
		// Key algorithms are not checked during authentication.
		RESULT_FAILED_PUBLIC_KEY_ALGO_NOT_SUPPORTED = 16;
		// RESULT_FAILED_CREDENTIAL_EXPIRED indicates that the credential has expired.
		RESULT_FAILED_CREDENTIAL_EXPIRED = 17;
		// RESULT_FAILED_NOT_SUPPORTED indicates that the requested operation is not supported.
		RESULT_FAILED_NOT_SUPPORTED = 18;
		// RESULT_FAILED_CREDENTIAL_INVALID indicates the credential could not be validated.
		// This could be due to an invalid signature or a malformed token.
		RESULT_FAILED_CREDENTIAL_INVALID = 19;
		// RESULT_FAILED_SESSION_UNKNOWN indicates the credential is attached to a user session that does not exist.
		// This usually indicates a corrupt token (as expired/revoked sessions have a separate error code).
		RESULT_FAILED_SESSION_UNKNOWN = 20;
		// RESULT_FAILED_SESSION_EXPIRED indicates the credential is attached to a user session that has expired.
		RESULT_FAILED_SESSION_EXPIRED = 21;
		// RESULT_FAILED_SESSION_REVOKED indicates the credential is attached to a user session that has been revoked.
		RESULT_FAILED_SESSION_REVOKED = 22;
		// RESULT_FAILED_CREDENTIAL_REVOKED indicates the credential has been revoked.
		RESULT_FAILED_CREDENTIAL_REVOKED = 23;

		// RESULT_FAILED_GENERIC indicates the validation failed.
		// If possible a more descriptive result code should be used.
		RESULT_FAILED_GENERIC = -1;
	}

	// Result is the overall result of validating the AuthtenticateRequest.
	Result result = 1;

	// Attributes is the set of attributes that describe the access granted by the provided credential.
	// This value is empty if the Result is not RESULT_SUCCESS
	repeated Attribute attributes = 2;

	// Ticket is reserved for future use, it is currently always an empty string.
	optional string ticket = 3;
}
