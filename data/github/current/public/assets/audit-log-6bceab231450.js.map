{"version":3,"file":"audit-log-xxxxxxxxxxxx.js","mappings":"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","sources":["node_modules/@github/remote-form/dist/index.js","app/assets/modules/audit-log.ts","app/assets/modules/github/behaviors/ajax-error.ts"],"sourcesContent":["// Parse HTML text into document fragment.\nfunction parseHTML(document, html) {\n    const template = document.createElement('template');\n    // eslint-disable-next-line github/no-inner-html\n    template.innerHTML = html;\n    return document.importNode(template.content, true);\n}\nfunction serialize(form) {\n    const params = new URLSearchParams();\n    const entries = new FormData(form).entries();\n    for (const [name, value] of [...entries]) {\n        params.append(name, value.toString());\n    }\n    return params.toString();\n}\nexport class ErrorWithResponse extends Error {\n    constructor(message, response) {\n        super(message);\n        this.response = response;\n    }\n}\nfunction makeDeferred() {\n    let resolve;\n    let reject;\n    const promise = new Promise(function (_resolve, _reject) {\n        resolve = _resolve;\n        reject = _reject;\n    });\n    return [promise, resolve, reject];\n}\nlet formHandlers;\nconst afterHandlers = [];\nconst beforeHandlers = [];\nexport function afterRemote(fn) {\n    afterHandlers.push(fn);\n}\nexport function beforeRemote(fn) {\n    beforeHandlers.push(fn);\n}\nexport function remoteForm(selector, fn) {\n    if (!formHandlers) {\n        formHandlers = new Map();\n        if (typeof document !== 'undefined') {\n            document.addEventListener('submit', handleSubmit);\n        }\n    }\n    const handlers = formHandlers.get(selector) || [];\n    formHandlers.set(selector, [...handlers, fn]);\n}\nexport function remoteUninstall(selector, fn) {\n    if (formHandlers) {\n        const handlers = formHandlers.get(selector) || [];\n        formHandlers.set(selector, handlers.filter(x => x !== fn));\n    }\n}\nfunction getMatches(el) {\n    const results = [];\n    for (const selector of formHandlers.keys()) {\n        if (el.matches(selector)) {\n            const handlers = formHandlers.get(selector) || [];\n            results.push(...handlers);\n        }\n    }\n    return results;\n}\nfunction handleSubmit(event) {\n    if (!(event.target instanceof HTMLFormElement) || event.defaultPrevented) {\n        return;\n    }\n    const form = event.target;\n    const matches = getMatches(form);\n    if (matches.length === 0) {\n        return;\n    }\n    const req = buildRequest(form);\n    const [kickerPromise, ultimateResolve, ultimateReject] = makeDeferred();\n    event.preventDefault();\n    processHandlers(matches, form, req, kickerPromise).then(async (performAsyncSubmit) => {\n        if (performAsyncSubmit) {\n            for (const handler of beforeHandlers) {\n                await handler(form);\n            }\n            // TODO: ensure that these exceptions are processed by our global error handler\n            remoteSubmit(req)\n                .then(ultimateResolve, ultimateReject)\n                // eslint-disable-next-line @typescript-eslint/no-empty-function\n                .catch(() => { })\n                .then(() => {\n                for (const handler of afterHandlers) {\n                    handler(form);\n                }\n            });\n        }\n        else {\n            // No handler called the kicker function\n            form.submit();\n        }\n    }, (err) => {\n        // TODO: special \"cancel\" error object to halt processing and avoid\n        // submitting the form\n        form.submit();\n        setTimeout(() => {\n            throw err;\n        });\n    });\n}\n// Process each handler sequentially until it either completes or calls the\n// kicker function.\nasync function processHandlers(matches, form, req, kickerPromise) {\n    let kickerWasCalled = false;\n    for (const match of matches) {\n        const [kickerCalled, kickerCalledResolve] = makeDeferred();\n        const kick = () => {\n            kickerWasCalled = true;\n            kickerCalledResolve();\n            return kickerPromise;\n        };\n        const kicker = {\n            text: kick,\n            json: () => {\n                req.headers.set('Accept', 'application/json');\n                return kick();\n            },\n            html: () => {\n                req.headers.set('Accept', 'text/html');\n                return kick();\n            }\n        };\n        await Promise.race([kickerCalled, match(form, kicker, req)]);\n    }\n    return kickerWasCalled;\n}\nfunction buildRequest(form) {\n    const req = {\n        method: form.method || 'GET',\n        url: form.action,\n        headers: new Headers({ 'X-Requested-With': 'XMLHttpRequest' }),\n        body: null\n    };\n    if (req.method.toUpperCase() === 'GET') {\n        const data = serialize(form);\n        if (data) {\n            req.url += (~req.url.indexOf('?') ? '&' : '?') + data;\n        }\n    }\n    else {\n        req.body = new FormData(form);\n    }\n    return req;\n}\nasync function remoteSubmit(req) {\n    const response = await window.fetch(req.url, {\n        method: req.method,\n        body: req.body !== null ? req.body : undefined,\n        headers: req.headers,\n        credentials: 'same-origin'\n    });\n    const res = {\n        url: response.url,\n        status: response.status,\n        statusText: response.statusText,\n        headers: response.headers,\n        text: '',\n        get json() {\n            // eslint-disable-next-line @typescript-eslint/no-shadow, @typescript-eslint/no-this-alias\n            const response = this;\n            const data = JSON.parse(response.text);\n            delete response.json;\n            response.json = data;\n            return response.json;\n        },\n        get html() {\n            // eslint-disable-next-line @typescript-eslint/no-shadow, @typescript-eslint/no-this-alias\n            const response = this;\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            delete response.html;\n            response.html = parseHTML(document, response.text);\n            return response.html;\n        }\n    };\n    const body = await response.text();\n    res.text = body;\n    if (response.ok) {\n        return res;\n    }\n    else {\n        throw new ErrorWithResponse('request failed', res);\n    }\n}\n//# sourceMappingURL=index.js.map","import {controller, target} from '@github/catalyst'\nimport './github/audit-log/audit-log-search-input'\nimport {remoteForm, type Kicker} from '@github/remote-form'\nimport {showGlobalError} from './github/behaviors/ajax-error'\n\n@controller\nclass AuditLogExportFlashesElement extends HTMLElement {\n  @target row: HTMLElement\n  @target notice: HTMLElement\n  @target warning: HTMLElement\n\n  closeError() {\n    this.row.hidden = true\n    this.warning.hidden = true\n  }\n\n  closeNotice() {\n    this.row.hidden = true\n    if (this.notice) {\n      this.notice.hidden = true\n    }\n  }\n}\n\nfunction fetchPoll(url: string, pollIntervalMs: number) {\n  return new Promise((resolve, reject) => {\n    setTimeout(async () => {\n      const request = new Request(url)\n      request.headers.append('X-Requested-With', 'XMLHttpRequest')\n      const response = await fetch(request)\n      if (response.status === 200) {\n        // Resource is ready.\n        resolve(response)\n      } else if (response.status === 202) {\n        // Resource isn't ready so we're gonna retry.\n        resolve(fetchPoll(url, pollIntervalMs))\n      } else {\n        // Something unexpected happened.\n        reject(response)\n      }\n    }, pollIntervalMs) // Poll the endpoint every intervalMs\n  })\n}\n\nasync function fetchTruncateStatus(url: string) {\n  const request = new Request(url)\n  request.headers.append('X-Requested-With', 'XMLHttpRequest')\n  const resp = await fetch(request)\n  const data = await resp.json()\n  if (data.truncated) {\n    const warning = document.getElementById('truncate-warning')!\n    warning.hidden = false\n  }\n}\n\nasync function exportEvents(loadingClass: string, menuClass: string, wants: Kicker, pollIntervalMs: number) {\n  const loadingState = document.querySelector<HTMLElement>(loadingClass)!\n  const menu = document.querySelector<HTMLDetailsElement>(menuClass)!\n  const flashContainer = document.querySelector<HTMLElement>('.js-flash-row')!\n  const flashErrorMessage = document.querySelector<HTMLElement>('.js-error-flash-message')!\n  const flashNoticeMessage = document.querySelector<HTMLElement>('.js-notice-flash-message')!\n  const warning = document.getElementById('truncate-warning')!\n\n  // Show/hide loading state. Set to `true` to hide menu and show loading state.\n  function loading(toggle: boolean) {\n    menu.hidden = toggle\n    menu.open = false\n    loadingState.hidden = !toggle\n  }\n\n  loading(true)\n  if (warning != null) {\n    warning.hidden = true\n  }\n\n  let response\n  try {\n    response = await wants.json()\n  } catch (error) {\n    loading(false)\n    // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n    if (error.response.status === 429) {\n      flashContainer.hidden = false\n      flashErrorMessage.hidden = false\n      flashNoticeMessage.hidden = true\n    } else {\n      showGlobalError()\n    }\n\n    return\n  }\n\n  const data = response.json\n\n  try {\n    flashContainer.hidden = false\n    flashNoticeMessage.hidden = false\n    flashErrorMessage.hidden = true\n    await fetchPoll(data.status_url, pollIntervalMs)\n  } catch (error) {\n    loading(false)\n    showGlobalError()\n    return\n  }\n\n  if (data.verify_url) {\n    try {\n      await fetchTruncateStatus(data.verify_url)\n    } catch (error) {\n      loading(false)\n      showGlobalError()\n      return\n    }\n  }\n\n  loading(false)\n  window.location = data.export_url\n}\n\nremoteForm('.js-audit-log-export-form', async function (form, wants) {\n  await exportEvents('.js-audit-log-exporting', '.js-audit-log-export-menu', wants, 2000)\n})\n\nremoteForm('.js-audit-log-git-event-export-form', async function (form, wants) {\n  await exportEvents('.js-audit-log-git-event-exporting', '.js-audit-log-git-event-export-menu', wants, 10000)\n})\n","// Global handler for uncaught AJAX errors.\n//\n// Only enabled by default on new style `data-remote` requests.\n\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nexport function showGlobalError() {\n  const ajaxErrorMessage = document.getElementById('ajax-error-message')\n  if (ajaxErrorMessage) {\n    ajaxErrorMessage.hidden = false\n  }\n}\n\nexport function hideGlobalError() {\n  const ajaxErrorMessage = document.getElementById('ajax-error-message')\n  if (ajaxErrorMessage) {\n    ajaxErrorMessage.hidden = true\n  }\n}\n\non('deprecatedAjaxError', '[data-remote]', function (event) {\n  const detail = (event as CustomEvent).detail\n  const {error, text} = detail\n\n  if (event.currentTarget !== event.target) {\n    return\n  }\n  if (error === 'abort' || error === 'canceled') {\n    return\n  }\n\n  if (/<html/.test(text)) {\n    showGlobalError()\n    event.stopImmediatePropagation()\n  } else {\n    setTimeout(function () {\n      if (event.defaultPrevented) {\n        return\n      }\n      showGlobalError()\n    }, 0)\n  }\n})\n\n// Clear any errors when the request is tried again\non('deprecatedAjaxSend', '[data-remote]', function () {\n  hideGlobalError()\n})\n\n// \"Dismiss\" button\non('click', '.js-ajax-error-dismiss', function () {\n  hideGlobalError()\n})\n"],"names":["formHandlers","ErrorWithResponse","Error","constructor","message","response","makeDeferred","resolve","reject","Promise","_resolve","_reject","afterHandlers","beforeHandlers","afterRemote","fn","push","beforeRemote","remoteForm","selector","Map","document","addEventListener","handleSubmit","handlers","get","set","event","target","HTMLFormElement","defaultPrevented","form","matches","getMatches","el","results","keys","length","req","buildRequest","method","url","action","headers","Headers","body","toUpperCase","data","serialize","params","URLSearchParams","name","value","FormData","entries","append","toString","indexOf","kickerPromise","ultimateResolve","ultimateReject","preventDefault","processHandlers","then","performAsyncSubmit","handler","remoteSubmit","catch","submit","setTimeout","err","kickerWasCalled","match","kickerCalled","kickerCalledResolve","kick","kicker","text","json","html","race","window","fetch","undefined","credentials","res","status","statusText","JSON","parse","parseHTML","template","createElement","innerHTML","importNode","content","ok","AuditLogExportFlashesElement","HTMLElement","closeError","row","hidden","warning","closeNotice","notice","fetchTruncateStatus","request","Request","resp","truncated","getElementById","exportEvents","loadingClass","menuClass","wants","pollIntervalMs","loadingState","querySelector","menu","flashContainer","flashErrorMessage","flashNoticeMessage","loading","toggle","open","error","showGlobalError","fetchPoll","status_url","verify_url","location","export_url","controller","ajaxErrorMessage","hideGlobalError","on","detail","currentTarget","test","stopImmediatePropagation"],"sourceRoot":""}