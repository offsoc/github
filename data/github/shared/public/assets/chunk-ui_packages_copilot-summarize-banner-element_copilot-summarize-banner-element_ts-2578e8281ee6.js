"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_copilot-summarize-banner-element_copilot-summarize-banner-element_ts"],{70170:(t,e,i)=>{function a(t,e=0,{start:i=!0,middle:a=!0,once:n=!1}={}){let s,r=i,o=0,l=!1;function h(...c){if(l)return;let m=Date.now()-o;o=Date.now(),i&&a&&m>=e&&(r=!0),r?(r=!1,t.apply(this,c),n&&h.cancel()):(a&&m<e||!a)&&(clearTimeout(s),s=setTimeout(()=>{o=Date.now(),t.apply(this,c),n&&h.cancel()},a?e-m:e))}return h.cancel=()=>{clearTimeout(s),l=!0},h}function n(t,e=0,{start:i=!1,middle:n=!1,once:s=!1}={}){return a(t,e,{start:i,middle:n,once:s})}i.d(e,{n:()=>a,s:()=>n})},27756:(t,e,i)=>{let a;function n(){if(!a)throw Error("Client env was requested before it was loaded. This likely means you are attempting to use client env at the module level in SSR, which is not supported. Please move your client env usage into a function.");return a}function s(){return a?.locale??"en-US"}i.d(e,{JK:()=>s,_$:()=>n}),function(){if("undefined"!=typeof document){let t=document.getElementById("client-env");if(t)try{a=JSON.parse(t.textContent||"")}catch(t){console.error("Error parsing client-env",t)}}}()},13044:(t,e,i)=>{i.r(e),i.d(e,{CopilotSummarizeBannerElement:()=>CopilotSummarizeBannerElement});var a=i(39595),n=i(28784);let s=(0,i(74572).A)("localStorage"),r=class SummaryCache{getSummary(){return s.getItem(this._summaryKey)}getSummaryTime(){let t=s.getItem(this._summaryTimeKey);if("string"!=typeof t)return null;let e=parseInt(t,10),i=new Date;return i.setTime(e),i}getSummaryFeedbackSentiment(){return s.getItem(this._summaryFeedbackSentimentKey)||null}setSummary(t,e=new Date){s.setItem(this._summaryKey,t),this.setSummaryTime(e)}setSummaryFeedbackSentiment(t){s.setItem(this._summaryFeedbackSentimentKey,t)}clear(){s.removeItem(this._summaryKey),s.removeItem(this._summaryFeedbackSentimentKey),s.removeItem(this._summaryTimeKey)}setSummaryTime(t){let e=t.getTime();s.setItem(this._summaryTimeKey,e.toString())}constructor({contentIdentifier:t}){this._summaryKey=`${SummaryCache.keyPrefix}${t}`,this._summaryFeedbackSentimentKey=`${SummaryCache.keyPrefix}-feedback${t}`,this._summaryTimeKey=`${SummaryCache.keyPrefix}-time${t}`}};function o(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function l(t,e){!function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function h(t,e,i,a){var n,s=arguments.length,r=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,a);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(r=(s<3?n(r):s>3?n(e,i,r):n(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r}r.keyPrefix="copilot-summary";var c=new WeakSet,m=new WeakSet,u=new WeakSet,d=new WeakSet,p=new WeakSet,y=new WeakSet,f=new WeakSet,g=new WeakSet,S=new WeakSet,v=new WeakSet,b=new WeakSet,C=new WeakSet,k=new WeakSet,w=new WeakSet,B=new WeakSet,E=new WeakSet,T=new WeakSet,F=new WeakSet,I=new WeakSet,z=new WeakSet,x=new WeakSet,L=new WeakSet,_=new WeakSet,W=new WeakSet,A=new WeakSet;let CopilotSummarizeBannerElement=class CopilotSummarizeBannerElement extends HTMLElement{connectedCallback(){this.addEventListener("socket:message",this.socketEventHandler),window.addEventListener("generate-copilot-summary",this.generateSummaryHandler),this.negativeFeedbackForm&&this.negativeFeedbackForm.addEventListener("submit",this.negativeFeedbackSubmitHandler),this.summaryPath=this.summarizeButton?.getAttribute("data-path"),this.summaryPath&&(this.cache=new r({contentIdentifier:this.summaryPath})),o(this,c,D).call(this),o(this,x,te).call(this,this)}disconnectedCallback(){window.removeEventListener("generate-copilot-summary",this.generateSummaryHandler),this.negativeFeedbackForm&&this.negativeFeedbackForm.removeEventListener("submit",this.negativeFeedbackSubmitHandler),this.removeEventListener("socket:message",this.socketEventHandler)}async submitPositiveFeedback(t){let e=t.currentTarget.getAttribute("data-path");"string"==typeof e&&(await (0,n.lS)(e,{method:"POST",body:{feedback_choices:["POSITIVE"]}}),o(this,k,j).call(this,"positive"))}summarize(t){o(this,p,O).call(this)}constructor(...t){super(...t),l(this,c),l(this,m),l(this,u),l(this,d),l(this,p),l(this,y),l(this,f),l(this,g),l(this,S),l(this,v),l(this,b),l(this,C),l(this,k),l(this,w),l(this,B),l(this,E),l(this,T),l(this,F),l(this,I),l(this,z),l(this,x),l(this,L),l(this,_),l(this,W),l(this,A),this.summaryGenerated=!1,this.prompt=null,this.socketEventHandler=t=>o(this,f,R).call(this,t),this.generateSummaryHandler=t=>o(this,d,K).call(this,t),this.negativeFeedbackSubmitHandler=t=>o(this,u,P).call(this,t)}};function D(){if(!this.cache)return;let t=this.cache.getSummary();if(!t)return;this.summaryGenerated=!0,o(this,b,J).call(this,t);let e=this.cache.getSummaryFeedbackSentiment();o(this,m,X).call(this,e),o(this,x,te).call(this,this.regenerateButton);let i=this.cache.getSummaryTime();o(this,A,ts).call(this,this.summarizationTimeLabel,i),i?(o(this,I,Z).call(this,this.descriptiveText,"data-cache-hit-text"),o(this,x,te).call(this,this.summarizationTimeLabel)):o(this,L,ti).call(this,this.summarizationTimeLabel)}function X(t){t&&("positive"===t?(o(this,L,ti).call(this,this.negativeFeedbackButton),o(this,_,ta).call(this,this.positiveFeedbackButton)):(o(this,L,ti).call(this,this.positiveFeedbackButton),o(this,_,ta).call(this,this.negativeFeedbackButton)))}async function P(t){t.preventDefault();let e=this.negativeFeedbackForm?.action;if(!e)return;let i=new FormData(this.negativeFeedbackForm);await (0,n.DI)(e,{method:"POST",body:i}),o(this,k,j).call(this,"negative")}function K(t){this.prompt=t.payload.prompt,o(this,p,O).call(this)}async function O(){o(this,g,G).call(this),o(this,S,$).call(this);try{let t=await o(this,y,H).call(this);t?(o(this,b,J).call(this,t),this.summaryGenerated=!0,this.cache?.setSummary(t)):o(this,v,q).call(this)}catch{o(this,v,q).call(this)}}async function H(){if("string"!=typeof this.summaryPath)return;let t=new FormData;return this.prompt&&t.append("prompt",this.prompt),(await (0,n.DI)(this.summaryPath,{method:"POST",headers:{Accept:"text/html"},body:t})).text()}function R(t){this.summaryGenerated&&t?.detail&&(o(this,x,te).call(this,this.newUpdatesIndicator),o(this,x,te).call(this,this.regenerateButton),o(this,I,Z).call(this,this.descriptiveText,"data-new-updates-text"))}function G(){o(this,L,ti).call(this,this.newUpdatesIndicator),o(this,L,ti).call(this,this.regenerateButton)}function $(){o(this,L,ti).call(this,this.summarizeButton),o(this,B,V).call(this),o(this,I,Z).call(this,this.descriptiveText,"data-loading-text"),o(this,F,Y).call(this,this.results,""),o(this,x,te).call(this,this.skeletonText),o(this,L,ti).call(this,this.results),o(this,w,U).call(this),o(this,L,ti).call(this,this.earlyAccessLabel),o(this,L,ti).call(this,this.clipboardCopy),o(this,z,tt).call(this,this.clipboardCopy,""),o(this,L,ti).call(this,this.summarizationTimeLabel)}function q(){o(this,E,M).call(this),o(this,L,ti).call(this,this.skeletonText),o(this,I,Z).call(this,this.descriptiveText,"data-error-text"),o(this,C,N).call(this),o(this,w,U).call(this),o(this,L,ti).call(this,this.earlyAccessLabel),o(this,L,ti).call(this,this.clipboardCopy),o(this,z,tt).call(this,this.clipboardCopy,"")}function J(t){o(this,L,ti).call(this,this.summarizeButton),o(this,x,te).call(this,this.visibilityText),o(this,F,Y).call(this,this.results,t),o(this,x,te).call(this,this.results),o(this,L,ti).call(this,this.skeletonText),o(this,T,Q).call(this),o(this,I,Z).call(this,this.descriptiveText,"data-complete-text"),o(this,z,tt).call(this,this.clipboardCopy,this.results?.textContent??""),o(this,x,te).call(this,this.clipboardCopy),this.prompt||o(this,x,te).call(this,this.feedback),o(this,x,te).call(this,this.earlyAccessLabel)}function N(){o(this,I,Z).call(this,this.summarizeButton,"data-retry-text"),o(this,x,te).call(this,this.summarizeButton)}function j(t){this.negativeFeedbackDialog?.close(),o(this,m,X).call(this,t),this.cache?.setSummaryFeedbackSentiment(t)}function U(){o(this,L,ti).call(this,this.feedback),o(this,x,te).call(this,this.positiveFeedbackButton),o(this,x,te).call(this,this.negativeFeedbackButton),o(this,W,tn).call(this,this.positiveFeedbackButton),o(this,W,tn).call(this,this.negativeFeedbackButton),this.negativeFeedbackDialog?.close()}function V(){o(this,L,ti).call(this,this.copilotBadge),o(this,x,te).call(this,this.loadingCopilotBadge),o(this,L,ti).call(this,this.errorCopilotBadge)}function M(){o(this,L,ti).call(this,this.copilotBadge),o(this,L,ti).call(this,this.loadingCopilotBadge),o(this,x,te).call(this,this.errorCopilotBadge)}function Q(){o(this,L,ti).call(this,this.loadingCopilotBadge),o(this,x,te).call(this,this.copilotBadge),o(this,L,ti).call(this,this.errorCopilotBadge)}function Y(t,e){t&&(t.innerHTML=e)}function Z(t,e){if(t){let i=t.getAttribute(e);t.textContent=i}}function tt(t,e){t&&t.setAttribute("value",e)}function te(t){t&&(t.hidden=!1)}function ti(t){t&&(t.hidden=!0)}function ta(t){t&&(t.disabled=!0)}function tn(t){t&&(t.disabled=!1)}function ts(t,e){t&&(e=e??new Date,t.datetime=e.toISOString(),t.textContent=e.toLocaleString())}h([a.aC],CopilotSummarizeBannerElement.prototype,"results",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"skeletonText",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"summarizeButton",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"visibilityText",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"copilotBadge",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"loadingCopilotBadge",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"errorCopilotBadge",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"descriptiveText",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"clipboardCopy",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"feedback",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"newUpdatesIndicator",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"regenerateButton",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"positiveFeedbackButton",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"negativeFeedbackButton",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"negativeFeedbackDialog",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"negativeFeedbackForm",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"earlyAccessLabel",void 0),h([a.aC],CopilotSummarizeBannerElement.prototype,"summarizationTimeLabel",void 0),CopilotSummarizeBannerElement=h([a.p_],CopilotSummarizeBannerElement)},5728:(t,e,i)=>{i.d(e,{G:()=>n,K:()=>s});var a=i(97156);let n=a.XC?.readyState==="interactive"||a.XC?.readyState==="complete"?Promise.resolve():new Promise(t=>{a.XC?.addEventListener("DOMContentLoaded",()=>{t()})}),s=a.XC?.readyState==="complete"?Promise.resolve():new Promise(t=>{a.cg?.addEventListener("load",t)})},97564:(t,e,i)=>{i.d(e,{G7:()=>l,XY:()=>h,fQ:()=>o});var a=i(5225),n=i(27756);function s(){return new Set((0,n._$)().featureFlags.map(t=>t.toLowerCase()))}let r=i(97156).X3?s:(0,a.A)(s);function o(){return Array.from(r())}function l(t){return r().has(t.toLowerCase())}let h={isFeatureEnabled:l}},14740:(t,e,i)=>{i.d(e,{k:()=>r,v:()=>o});var a=i(5225),n=i(97156);let s=(0,a.A)(function(){return n.XC?.head?.querySelector('meta[name="runtime-environment"]')?.content||""}),r=(0,a.A)(function(){return"enterprise"===s()}),o="webpack-css-layers"},74572:(t,e,i)=>{i.d(e,{A:()=>r,D:()=>o});var a=i(97156),n=i(51528);let s=class NoOpStorage{getItem(){return null}setItem(){}removeItem(){}clear(){}key(){return null}get length(){return 0}};function r(t,e={throwQuotaErrorsOnSet:!1},i=a.cg,r=t=>t,o=t=>t){let l;try{if(!i)throw Error();l=i[t]||new s}catch{l=new s}let{throwQuotaErrorsOnSet:h}=e;function c(t){e.sendCacheStats&&(0,n.i)({incrementKey:t})}function m(t){try{if(l.removeItem(t),e.ttl){let e=`${t}:expiry`;l.removeItem(e)}}catch(t){}}return{getItem:function(t,e=new Date().getTime()){try{let i=l.getItem(t);if(!i)return null;let a=`${t}:expiry`,n=Number(l.getItem(a));if(n&&e>n)return m(t),m(a),c("SAFE_STORAGE_VALUE_EXPIRED"),null;return c("SAFE_STORAGE_VALUE_WITHIN_TTL"),r(i)}catch(t){return null}},setItem:function(t,i,a=new Date().getTime()){try{if(l.setItem(t,o(i)),e.ttl){let i=`${t}:expiry`,n=a+e.ttl;l.setItem(i,n.toString())}}catch(t){if(h&&t instanceof Error&&t.message.toLowerCase().includes("quota"))throw t}},removeItem:m,clear:l.clear,key:l.key,get length(){return l.length}}}function o(t){return r(t,{throwQuotaErrorsOnSet:!1},a.cg,JSON.parse,JSON.stringify)}},97156:(t,e,i)=>{i.d(e,{KJ:()=>a.KJ,Kn:()=>n.Kn,X3:()=>a.X3,XC:()=>n.XC,cg:()=>n.cg,fV:()=>n.fV,g5:()=>a.g5});var a=i(15572),n=i(86733)},86733:(t,e,i)=>{i.d(e,{Kn:()=>s,XC:()=>a,cg:()=>n,fV:()=>r});let a="undefined"==typeof document?void 0:document,n="undefined"==typeof window?void 0:window,s="undefined"==typeof history?void 0:history,r="undefined"==typeof location?{pathname:"",origin:"",search:"",hash:"",href:""}:location},15572:(t,e,i)=>{i.d(e,{KJ:()=>s,X3:()=>n,g5:()=>r});var a=i(86733);let n=void 0===a.XC,s=!n;function r(){return!!n||!!a.XC.querySelector('react-app[data-ssr="true"]')}},51528:(t,e,i)=>{i.d(e,{X:()=>d,i:()=>h});var a=i(97156),n=i(5728),s=i(14740),r=i(97564),o=i(70170);let l=[];function h(t,e=!1,i=.5){if(!0!==(0,r.G7)("BROWSER_STATS_DISABLED")){if(i<0||i>1)throw RangeError("Sampling probability must be between 0 and 1");void 0===t.timestamp&&(t.timestamp=new Date().getTime()),t.loggedIn=!!a.XC?.head?.querySelector('meta[name="user-login"]')?.content,t.staff=d(),t.bundler=s.v,Math.random()<i&&l.push(t),e?u():m()}}let c=null,m=(0,o.n)(async function(){await n.K,null==c&&(c=window.requestIdleCallback(u))},5e3);function u(){if(c=null,!l.length)return;let t=a.XC?.head?.querySelector('meta[name="browser-stats-url"]')?.content;if(t){for(let e of function(t){let e=[],i=t.map(t=>JSON.stringify(t));for(;i.length>0;)e.push(function(t){let e=t.shift(),i=[e],a=e.length;for(;t.length>0&&a<=65536;){let e=t[0].length;if(a+e<=65536){let n=t.shift();i.push(n),a+=e}else break}return i}(i));return e}(l))!function(t,e){try{navigator.sendBeacon&&navigator.sendBeacon(t,e)}catch{}}(t,`{"stats": [${e.join(",")}] }`);l=[]}}function d(){return!!a.XC?.head?.querySelector('meta[name="user-staff"]')?.content}a.XC?.addEventListener("pagehide",u),a.XC?.addEventListener("visibilitychange",u)},28784:(t,e,i)=>{function a(t,e={}){!function(t){if(new URL(t,window.location.origin).origin!==window.location.origin)throw Error("Can not make cross-origin requests from verifiedFetch")}(t);let i={...e.headers,"GitHub-Verified-Fetch":"true","X-Requested-With":"XMLHttpRequest"};return fetch(t,{...e,headers:i})}function n(t,e){let i={...e?.headers??{},Accept:"application/json","Content-Type":"application/json"},n=e?.body?JSON.stringify(e.body):void 0;return a(t,{...e,body:n,headers:i})}function s(t,e={}){let i={...e.headers,"GitHub-Is-React":"true"};return a(t,{...e,headers:i})}function r(t,e){let i={...e?.headers??{},"GitHub-Is-React":"true"};return n(t,{...e,headers:i})}i.d(e,{DI:()=>a,QJ:()=>s,Sr:()=>r,lS:()=>n})},5225:(t,e,i)=>{function a(...t){return JSON.stringify(t,(t,e)=>"object"==typeof e?e:String(e))}function n(t,e={}){let{hash:i=a,cache:n=new Map}=e;return function(...e){let a=i.apply(this,e);if(n.has(a))return n.get(a);let s=t.apply(this,e);return s instanceof Promise&&(s=s.catch(t=>{throw n.delete(a),t})),n.set(a,s),s}}i.d(e,{A:()=>n})}}]);
//# sourceMappingURL=ui_packages_copilot-summarize-banner-element_copilot-summarize-banner-element_ts-1eee88f6a9c1.js.map