# generated by turbocassette ts/cassettes/sessions/show_test.go
---
http_interactions:
  - request:
      method: post
      uri: http://localhost:8888/twirp/github.turboscan.Results/GetAlert
      body:
        encoding: UTF-8
        string: |-
          {
            "number": 1,
            "repositoryId": "23"
          }
      headers:
        Content-Type:
          - application/json
    response:
      status:
        code: 200
        message: null
      headers:
        Content-Length:
          - "3053"
        Content-Type:
          - application/json
      body:
        encoding: UTF-8
        string: |-
          {
            "hasCodePaths": true,
            "queryUri": "",
            "refNameBytes": "cmVmcy9oZWFkcy9tYXN0ZXI=",
            "relatedLocations": [
              {
                "createdAt": "0001-01-01T00:00:00Z",
                "id": "1",
                "location": {
                  "endColumn": 58,
                  "endLine": 5,
                  "filePath": "controllers/chat.js",
                  "startColumn": 40,
                  "startLine": 5
                },
                "message": "a user-provided value",
                "physicalAlertId": "1",
                "replacementIndex": 1,
                "updatedAt": "0001-01-01T00:00:00Z"
              }
            ],
            "result": {
              "createdAt": "0001-01-01T00:00:00Z",
              "fixedAt": null,
              "guid": "11111111-2222-3333-4444-000000000000",
              "isFixed": false,
              "messageMarkdown": "",
              "messageText": "\\[Score = 0.9441410000\\] This may be a NoSQL query depending on [a user-provided value](1) \\[Source origins: known; sink origins: predicted (scores: NotASink=0.055551, XssSink=0.000011, NosqlInjectionSink=0.944141, SqlInjectionSink=0, TaintedPathSink=0.000297)\\]",
              "mostRecentInstance": {
                "analysisKey": {
                  "analysisKey": ".github/workflows/codeql.yml:ruby",
                  "category": ".github/workflows/codeql.yml:ruby",
                  "commitOid": "ca28b007b099ad3fd9688f9ff250c0e4464728bd",
                  "environment": "{}",
                  "id": "1",
                  "tool": "CodeQL"
                },
                "classification": [],
                "commitOid": "ca28b007b099ad3fd9688f9ff250c0e4464728bd",
                "createdAt": "0001-01-01T00:00:00Z",
                "hasFileClassification": false,
                "isFixed": false,
                "isOutdated": false,
                "location": {
                  "endColumn": 66,
                  "endLine": 9,
                  "filePath": "controllers/chat.js",
                  "startColumn": 61,
                  "startLine": 9
                },
                "messageText": "\\[Score = 0.9441410000\\] This may be a NoSQL query depending on [a user-provided value](1) \\[Source origins: known; sink origins: predicted (scores: NotASink=0.055551, XssSink=0.000011, NosqlInjectionSink=0.944141, SqlInjectionSink=0, TaintedPathSink=0.000297)\\]",
                "refNameBytes": "cmVmcy9oZWFkcy9tYXN0ZXI="
              },
              "number": 1,
              "resolution": "NO_RESOLUTION",
              "resolutionNote": "",
              "resolvedAt": null,
              "resolverId": 0,
              "rule": {
                "fullDescription": "Building a database query from user-controlled sources is vulnerable to insertion of malicious code by the user.",
                "help": "",
                "helpUri": "",
                "name": "adaptive-threat-modeling/js/nosql-injection",
                "queryUri": "",
                "sarifIdentifier": "adaptive-threat-modeling/js/nosql-injection",
                "severity": "ERROR",
                "shortDescription": "NoSQL database query built from user-controlled sources (boosted)",
                "tags": [
                  "experimental",
                  "experimental/atm",
                  "security"
                ]
              },
              "ruleSeverity": "ERROR",
              "securitySeverity": "HIGH",
              "tool": {
                "alertCount": "0",
                "guid": "",
                "name": "CodeQL",
                "version": "2.7.1+202111121759plus"
              },
              "updatedAt": "0001-01-01T00:00:00Z"
            },
            "ruleHelp": "",
            "ruleTags": [
              "experimental",
              "experimental/atm",
              "security"
            ]
          }
      http_version: null
    recorded_at: Wed, 18 Jan 2023 14:11:07 GMT
  - request:
      method: post
      uri: http://localhost:8888/twirp/github.turboscan.Results/ToolNames
      body:
        encoding: UTF-8
        string: |-
          {
            "repositoryId": "20"
          }
      headers:
        Content-Type:
          - application/json
    response:
      status:
        code: 200
        message: null
      headers:
        Content-Length:
          - "17"
        Content-Type:
          - application/json
      body:
        encoding: UTF-8
        string: |-
          {
            "tools": []
          }
      http_version: null
    recorded_at: Mon, 22 Nov 2021 11:51:02 GMT
  - request:
      method: post
      uri: http://localhost:8888/twirp/github.turboscan.Results/GetCounts
      body:
        encoding: UTF-8
        string: |-
          {
            "refNamesBytes": [
              "cmVmcy9oZWFkcy9tYXN0ZXI="
            ],
            "repositoryId": "9",
            "toolName": "CodeQL"
          }
      headers:
        Content-Type:
          - application/json
    response:
      status:
        code: 200
        message: null
      headers:
        Content-Length:
          - "75"
        Content-Type:
          - application/json
      body:
        encoding: UTF-8
        string: |-
          {
            "analysisExists": false,
            "latestAnalysis": null,
            "openCount": "0"
          }
      http_version: null
    recorded_at: Thu, 09 Jun 2022 15:05:12 GMT
  - request:
      method: post
      uri: http://localhost:8888/twirp/github.turboscan.Results/GetCounts
      body:
        encoding: UTF-8
        string: |-
          {
            "refNamesBytes": [
              "cmVmcy9oZWFkcy9tYXN0ZXI="
            ],
            "repositoryId": "9",
            "toolName": "some other tool"
          }
      headers:
        Content-Type:
          - application/json
    response:
      status:
        code: 200
        message: null
      headers:
        Content-Length:
          - "75"
        Content-Type:
          - application/json
      body:
        encoding: UTF-8
        string: |-
          {
            "analysisExists": false,
            "latestAnalysis": null,
            "openCount": "0"
          }
      http_version: null
    recorded_at: Thu, 16 Jun 2022 08:39:52 GMT
  - request:
      method: post
      uri: http://localhost:8888/twirp/github.turboscan.Results/GetCounts
      body:
        encoding: UTF-8
        string: |-
          {
            "repositoryId": "30"
          }
      headers:
        Content-Type:
          - application/json
    response:
      status:
        code: 200
        message: null
      headers:
        Content-Length:
          - "75"
        Content-Type:
          - application/json
      body:
        encoding: UTF-8
        string: |-
          {
            "analysisExists": false,
            "latestAnalysis": null,
            "openCount": "0"
          }
      http_version: null
    recorded_at: Thu, 09 Jun 2022 15:05:12 GMT
  - request:
      method: post
      uri: http://localhost:8888/twirp/github.turboscan.Results/GetTimelineEvents
      body:
        encoding: UTF-8
        string: |-
          {
            "number": 3,
            "refNames": [
              "refs/heads/master"
            ],
            "refNamesBytes": [
              "cmVmcy9oZWFkcy9tYXN0ZXI="
            ],
            "repositoryId": "23"
          }
      headers:
        Content-Type:
          - application/json
    response:
      status:
        code: 200
        message: null
      headers:
        Content-Length:
          - "587"
        Content-Type:
          - application/json
      body:
        encoding: UTF-8
        string: |-
          {
            "events": [
              {
                "category": ".github/workflows/codeql.yml:ruby",
                "commitOid": "ca28b007b099ad3fd9688f9ff250c0e4464728bd",
                "environment": [],
                "filePath": "controllers/chat.js",
                "id": "3",
                "logicalAlertId": "3",
                "message": "",
                "refNameBytes": "cmVmcy9oZWFkcy9tYXN0ZXI=",
                "resolution": "NO_RESOLUTION",
                "resolutionNote": "",
                "startLine": 20,
                "timestamp": "0001-01-01T00:00:00Z",
                "toolVersion": "",
                "type": "TIMELINE_EVENT_TYPE_ALERT_CREATED",
                "userId": 0,
                "workflowRunId": "0"
              }
            ]
          }
      http_version: null
    recorded_at: Thu, 06 Oct 2022 10:08:12 GMT
  - request:
      method: post
      uri: http://localhost:8888/twirp/github.turboscan.Results/GetAlertInstances
      body:
        encoding: UTF-8
        string: |-
          {
            "alertNumber": 3,
            "branchesOnly": true,
            "limit": 100,
            "repositoryId": "23"
          }
      headers:
        Content-Type:
          - application/json
    response:
      status:
        code: 200
        message: null
      headers:
        Content-Length:
          - "1087"
        Content-Type:
          - application/json
      body:
        encoding: UTF-8
        string: |-
          {
            "instances": [
              {
                "analysisKey": {
                  "analysisKey": ".github/workflows/codeql.yml:ruby",
                  "category": ".github/workflows/codeql.yml:ruby",
                  "commitOid": "ca28b007b099ad3fd9688f9ff250c0e4464728bd",
                  "environment": "{}",
                  "id": "1",
                  "tool": "CodeQL"
                },
                "classification": [],
                "commitOid": "ca28b007b099ad3fd9688f9ff250c0e4464728bd",
                "createdAt": "0001-01-01T00:00:00Z",
                "hasFileClassification": false,
                "isFixed": false,
                "isOutdated": false,
                "location": {
                  "endColumn": 48,
                  "endLine": 20,
                  "filePath": "controllers/chat.js",
                  "startColumn": 29,
                  "startLine": 20
                },
                "messageText": "\\[Score = 0.7863790000\\] This may be a js/sql result depending on [a user-provided value](1) \\[Source origins: known; sink origins: predicted (scores: NotASink=0.110134, XssSink=0.003019, NosqlInjectionSink=0.000167, SqlInjectionSink=0.786379, TaintedPathSink=0.100301)\\]",
                "refNameBytes": "cmVmcy9oZWFkcy9tYXN0ZXI="
              }
            ],
            "totalCount": "1"
          }
      http_version: null
    recorded_at: Wed, 18 Jan 2023 14:11:07 GMT
recorded_with: VCR 5.1.0
