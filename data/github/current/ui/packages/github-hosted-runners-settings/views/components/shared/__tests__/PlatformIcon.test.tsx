import {screen} from '@testing-library/react'
import {render} from '@github-ui/react-core/test-utils'
import {PlatformOsType, platformToOsType} from '../../../../types/platform'
import {PlatformIcon} from '../PlatformIcon'

// TODO: Use snapshot testing for these when this bug is fixed: https://github.com/jestjs/jest/issues/14305

describe('PlatformIcon', () => {
  const className = 'test-class-name'

  test('renders correctly for windows ostype', () => {
    render(<PlatformIcon osType={PlatformOsType.Windows} className={className} size={10} />)

    const iconEl = screen.getByRole('img', {hidden: true})
    expect(iconEl).toHaveAttribute('height', '10')
    expect(iconEl).toHaveAttribute('width', '10')
    expect(iconEl).toHaveAttribute('viewBox', '0 0 16 16')
    expect(iconEl).toHaveAttribute('style', 'display: inline-block; user-select: none; overflow: visible;')
    expect(iconEl).toHaveAttribute('xmlns', 'http://www.w3.org/2000/svg')
    expect(iconEl).toHaveAttribute('aria-label', 'Windows icon')
    expect(iconEl.classList).toContain(className)
    expect(iconEl.innerHTML).toEqual(
      '<path data-testid="svg-icon-path" fill-rule="evenodd" d="M6.917 1.662 1.6 2.419V13.53l5.317.74V8.32l-5.314-.037v-.612l5.314-.04v-5.97Zm.742-.106v6.071l7.44-.055V.497L7.66 1.556Zm7.44 6.822-7.44-.052v6.047l7.44 1.034V8.378Z"></path>',
    )
  })

  test('renders correctly for linux ostype', () => {
    render(<PlatformIcon osType={PlatformOsType.Linux} className={className} />)

    const iconEl = screen.getByRole('img', {hidden: true})
    expect(iconEl).toHaveAttribute('height', '16')
    expect(iconEl).toHaveAttribute('width', '16')
    expect(iconEl).toHaveAttribute('viewBox', '0 0 16 16')
    expect(iconEl).toHaveAttribute('style', 'display: inline-block; user-select: none; overflow: visible;')
    expect(iconEl).toHaveAttribute('xmlns', 'http://www.w3.org/2000/svg')
    expect(iconEl).toHaveAttribute('aria-label', 'Linux icon')
    expect(iconEl.classList).toContain(className)
    expect(iconEl.innerHTML).toEqual(
      '<path data-testid="svg-icon-path" fill-rule="evenodd" d="M5.773 1.197a2.416 2.416 0 0 0-.246 1.059 17.76 17.76 0 0 0 .02 1.583c.014.24.023.383-.011.78-.026.306-.162.765-.385 1.213a6.517 6.517 0 0 1-.601.942c-.07.097-.135.185-.19.265-.088.132-.176.26-.262.385-.309.449-.599.87-.83 1.337-.167.34-.288.819-.34 1.162a4.73 4.73 0 0 0-.031.806c-.113.097-.195.23-.281.369-.073.118-.15.24-.247.347-.135.145-.391.195-.678.25l-.021.004c-.253.049-.52.147-.614.298a.578.578 0 0 0-.029.052c-.116.224-.091.537-.065.859.021.267.043.54-.014.777a3.83 3.83 0 0 1-.062.215c-.043.142-.085.278-.086.405 0 .099.022.204.09.322.075.13.24.224.475.305.214.074.49.14.812.215l.021.005.114.026.009.002c.146.035.29.07.438.099a5.8 5.8 0 0 0 .185.036l.017.003c.21.037.29.052.852.271.136.053.286.11.445.158.314.097.669.168.996.109.166-.03.323-.093.462-.202.144-.113.283-.264.382-.418a1.265 1.265 0 0 0 .12-.241.79.79 0 0 0 .033-.109c.132-.065.459-.165 1.237-.172 1.174-.012 1.955.412 1.955.412v-.01c.01.056.022.108.038.158a.845.845 0 0 0 .248.386c.07.064.153.123.25.174a1.4 1.4 0 0 0 .298.115 1.629 1.629 0 0 0 .66.033 1.23 1.23 0 0 0 .481-.172c.128-.08.232-.174.339-.27l.003-.004.002-.001c.07-.063.14-.127.219-.186a10.755 10.755 0 0 0 .292-.226l.047-.036c.101-.08.205-.162.309-.239a6.43 6.43 0 0 1 .399-.277 50.235 50.235 0 0 0 .713-.47l.024-.016.042-.028c.204-.137.452-.303.552-.512a.438.438 0 0 0 .052-.232c-.016-.241-.275-.46-.531-.677a20.204 20.204 0 0 1-.08-.068l-.014-.011c-.13-.113-.26-.224-.33-.338a1.21 1.21 0 0 1-.147-.344 5.396 5.396 0 0 1-.032-.197c-.03-.195-.054-.355-.159-.5-.126-.176-.236-.227-.43-.249a1.729 1.729 0 0 1-.083-.011c.126-.464.163-.759.14-1.148-.053-.888-.611-1.828-1.34-2.898a22.344 22.344 0 0 0-.325-.46c-.15-.207-.295-.41-.413-.595-.237-.37-.483-.8-.579-1.19-.071-.293-.101-.847-.111-1.769.035-1.413-.403-2.066-.932-2.473-.53-.407-1.307-.4-1.587-.376-.235.02-1.224.258-1.685 1.188Zm2.512 1.065c-.319-.004-.626.244-.727.577-.084.278-.08.498-.067.62.094.027.191.064.303.107a.604.604 0 0 1 .027-.523c.13-.24.389-.316.577-.171.188.145.234.455.103.694a.492.492 0 0 1-.183.193c.125.043.225.08.306.113a1.93 1.93 0 0 0 .301-.526c.095-.294.022-.817-.374-1.018a.598.598 0 0 0-.266-.066Zm-2.083.142c-.05 0-.105.01-.163.03-.251.087-.347.51-.258.893.049.21.135.411.264.536l.081-.06.063-.043c-.162-.08-.27-.326-.241-.565.03-.249.195-.395.37-.327.174.068.291.325.262.573a.592.592 0 0 1-.018.093c.052-.027.098-.048.142-.065l.031-.012a1.234 1.234 0 0 0-.013-.398c-.076-.375-.246-.655-.52-.655Zm2.642 2.329c-.06.03-.164.074-.324.197-.115.09-.33.278-.494.392a2.025 2.025 0 0 1-.34.189 1.3 1.3 0 0 1-.45.119c-.44.023-.648-.085-.847-.294-.084-.087-.148-.183-.253-.3a1.21 1.21 0 0 0-.178-.167c-.002.057-.186 1.282-.434 1.824-.247.541-.235.357-.402.923-.23.21-.484.774-.65 1.259-.173.569-.303 1.008-.314 1.646a1.686 1.686 0 0 1-.172-.557c-.086-.704.1-1.544.657-2.15.024-.025.023-.035.013-.034a.073.073 0 0 0-.036.02c-.695.62-.86 1.764-.79 2.275.052.366.147.681.341.937v.002l.01.011a1.351 1.351 0 0 0 .174.185c.113.126.255.263.544.482.532.404.904.617.977.88.098.35-.12.58-.394.723.2.2.836.608 1.997.557 1.022-.045 1.663-.432 2.21-1.099.003-.154.02-.41.028-.688.007-.265.009-.53.05-.736a.743.743 0 0 1 .043-.135.488.488 0 0 1 .419-.285c.09-.004.185-.01.276.008.016-.13.03-.257.039-.38a2.6 2.6 0 0 1 .57-.073c.383-.013.843.023 1.075.168a.812.812 0 0 0-.183-.117c-.271-.13-.643-.174-1.021-.186.1-.268.205-.654.194-.942-.029-.757-.405-1.34-.941-1.745a.11.11 0 0 0-.031-.018c-.005-.001-.002.005.016.022.62.588.828 1.257.777 1.907-.02.253-.13.54-.256.773-.06 0-.129.003-.188.004.03-.796-.127-1.463-.57-2.392-.043-.08-.245-.422-.367-.518-.094-.463-.107-.44-.296-.865-.287-.643-.391-1.386-.479-1.822Z"></path>',
    )
  })

  test('renders correctly for custom', () => {
    render(<PlatformIcon osType={PlatformOsType.Custom} className={className} />)

    const iconEl = screen.getByRole('img', {hidden: true})
    expect(iconEl).toHaveAttribute('height', '16')
    expect(iconEl).toHaveAttribute('width', '16')
    expect(iconEl).toHaveAttribute('viewBox', '0 0 16 16')
    expect(iconEl).toHaveAttribute(
      'style',
      'display: inline-block; user-select: none; vertical-align: text-bottom; overflow: visible;',
    )
    expect(iconEl.classList).toContain(className)
    expect(iconEl.innerHTML).toEqual(
      '<path d="M8 0a8.2 8.2 0 0 1 .701.031C9.444.095 9.99.645 10.16 1.29l.288 1.107c.018.066.079.158.212.224.231.114.454.243.668.386.123.082.233.09.299.071l1.103-.303c.644-.176 1.392.021 1.82.63.27.385.506.792.704 1.218.315.675.111 1.422-.364 1.891l-.814.806c-.049.048-.098.147-.088.294.016.257.016.515 0 .772-.01.147.038.246.088.294l.814.806c.475.469.679 1.216.364 1.891a7.977 7.977 0 0 1-.704 1.217c-.428.61-1.176.807-1.82.63l-1.102-.302c-.067-.019-.177-.011-.3.071a5.909 5.909 0 0 1-.668.386c-.133.066-.194.158-.211.224l-.29 1.106c-.168.646-.715 1.196-1.458 1.26a8.006 8.006 0 0 1-1.402 0c-.743-.064-1.289-.614-1.458-1.26l-.289-1.106c-.018-.066-.079-.158-.212-.224a5.738 5.738 0 0 1-.668-.386c-.123-.082-.233-.09-.299-.071l-1.103.303c-.644.176-1.392-.021-1.82-.63a8.12 8.12 0 0 1-.704-1.218c-.315-.675-.111-1.422.363-1.891l.815-.806c.05-.048.098-.147.088-.294a6.214 6.214 0 0 1 0-.772c.01-.147-.038-.246-.088-.294l-.815-.806C.635 6.045.431 5.298.746 4.623a7.92 7.92 0 0 1 .704-1.217c.428-.61 1.176-.807 1.82-.63l1.102.302c.067.019.177.011.3-.071.214-.143.437-.272.668-.386.133-.066.194-.158.211-.224l.29-1.106C6.009.645 6.556.095 7.299.03 7.53.01 7.764 0 8 0Zm-.571 1.525c-.036.003-.108.036-.137.146l-.289 1.105c-.147.561-.549.967-.998 1.189-.173.086-.34.183-.5.29-.417.278-.97.423-1.529.27l-1.103-.303c-.109-.03-.175.016-.195.045-.22.312-.412.644-.573.99-.014.031-.021.11.059.19l.815.806c.411.406.562.957.53 1.456a4.709 4.709 0 0 0 0 .582c.032.499-.119 1.05-.53 1.456l-.815.806c-.081.08-.073.159-.059.19.162.346.353.677.573.989.02.03.085.076.195.046l1.102-.303c.56-.153 1.113-.008 1.53.27.161.107.328.204.501.29.447.222.85.629.997 1.189l.289 1.105c.029.109.101.143.137.146a6.6 6.6 0 0 0 1.142 0c.036-.003.108-.036.137-.146l.289-1.105c.147-.561.549-.967.998-1.189.173-.086.34-.183.5-.29.417-.278.97-.423 1.529-.27l1.103.303c.109.029.175-.016.195-.045.22-.313.411-.644.573-.99.014-.031.021-.11-.059-.19l-.815-.806c-.411-.406-.562-.957-.53-1.456a4.709 4.709 0 0 0 0-.582c-.032-.499.119-1.05.53-1.456l.815-.806c.081-.08.073-.159.059-.19a6.464 6.464 0 0 0-.573-.989c-.02-.03-.085-.076-.195-.046l-1.102.303c-.56.153-1.113.008-1.53-.27a4.44 4.44 0 0 0-.501-.29c-.447-.222-.85-.629-.997-1.189l-.289-1.105c-.029-.11-.101-.143-.137-.146a6.6 6.6 0 0 0-1.142 0ZM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM9.5 8a1.5 1.5 0 1 0-3.001.001A1.5 1.5 0 0 0 9.5 8Z"></path>',
    )
  })

  test('renders correctly with linux-x64 platform', () => {
    render(<PlatformIcon osType={platformToOsType('linux-x64')} className={className} />)

    const iconEl = screen.getByRole('img', {hidden: true})
    expect(iconEl).toHaveAttribute('height', '16')
    expect(iconEl).toHaveAttribute('width', '16')
    expect(iconEl).toHaveAttribute('viewBox', '0 0 16 16')
    expect(iconEl).toHaveAttribute('style', 'display: inline-block; user-select: none; overflow: visible;')
    expect(iconEl).toHaveAttribute('xmlns', 'http://www.w3.org/2000/svg')
    expect(iconEl).toHaveAttribute('aria-label', 'Linux icon')
    expect(iconEl.classList).toContain(className)
    expect(iconEl.innerHTML).toEqual(
      '<path data-testid="svg-icon-path" fill-rule="evenodd" d="M5.773 1.197a2.416 2.416 0 0 0-.246 1.059 17.76 17.76 0 0 0 .02 1.583c.014.24.023.383-.011.78-.026.306-.162.765-.385 1.213a6.517 6.517 0 0 1-.601.942c-.07.097-.135.185-.19.265-.088.132-.176.26-.262.385-.309.449-.599.87-.83 1.337-.167.34-.288.819-.34 1.162a4.73 4.73 0 0 0-.031.806c-.113.097-.195.23-.281.369-.073.118-.15.24-.247.347-.135.145-.391.195-.678.25l-.021.004c-.253.049-.52.147-.614.298a.578.578 0 0 0-.029.052c-.116.224-.091.537-.065.859.021.267.043.54-.014.777a3.83 3.83 0 0 1-.062.215c-.043.142-.085.278-.086.405 0 .099.022.204.09.322.075.13.24.224.475.305.214.074.49.14.812.215l.021.005.114.026.009.002c.146.035.29.07.438.099a5.8 5.8 0 0 0 .185.036l.017.003c.21.037.29.052.852.271.136.053.286.11.445.158.314.097.669.168.996.109.166-.03.323-.093.462-.202.144-.113.283-.264.382-.418a1.265 1.265 0 0 0 .12-.241.79.79 0 0 0 .033-.109c.132-.065.459-.165 1.237-.172 1.174-.012 1.955.412 1.955.412v-.01c.01.056.022.108.038.158a.845.845 0 0 0 .248.386c.07.064.153.123.25.174a1.4 1.4 0 0 0 .298.115 1.629 1.629 0 0 0 .66.033 1.23 1.23 0 0 0 .481-.172c.128-.08.232-.174.339-.27l.003-.004.002-.001c.07-.063.14-.127.219-.186a10.755 10.755 0 0 0 .292-.226l.047-.036c.101-.08.205-.162.309-.239a6.43 6.43 0 0 1 .399-.277 50.235 50.235 0 0 0 .713-.47l.024-.016.042-.028c.204-.137.452-.303.552-.512a.438.438 0 0 0 .052-.232c-.016-.241-.275-.46-.531-.677a20.204 20.204 0 0 1-.08-.068l-.014-.011c-.13-.113-.26-.224-.33-.338a1.21 1.21 0 0 1-.147-.344 5.396 5.396 0 0 1-.032-.197c-.03-.195-.054-.355-.159-.5-.126-.176-.236-.227-.43-.249a1.729 1.729 0 0 1-.083-.011c.126-.464.163-.759.14-1.148-.053-.888-.611-1.828-1.34-2.898a22.344 22.344 0 0 0-.325-.46c-.15-.207-.295-.41-.413-.595-.237-.37-.483-.8-.579-1.19-.071-.293-.101-.847-.111-1.769.035-1.413-.403-2.066-.932-2.473-.53-.407-1.307-.4-1.587-.376-.235.02-1.224.258-1.685 1.188Zm2.512 1.065c-.319-.004-.626.244-.727.577-.084.278-.08.498-.067.62.094.027.191.064.303.107a.604.604 0 0 1 .027-.523c.13-.24.389-.316.577-.171.188.145.234.455.103.694a.492.492 0 0 1-.183.193c.125.043.225.08.306.113a1.93 1.93 0 0 0 .301-.526c.095-.294.022-.817-.374-1.018a.598.598 0 0 0-.266-.066Zm-2.083.142c-.05 0-.105.01-.163.03-.251.087-.347.51-.258.893.049.21.135.411.264.536l.081-.06.063-.043c-.162-.08-.27-.326-.241-.565.03-.249.195-.395.37-.327.174.068.291.325.262.573a.592.592 0 0 1-.018.093c.052-.027.098-.048.142-.065l.031-.012a1.234 1.234 0 0 0-.013-.398c-.076-.375-.246-.655-.52-.655Zm2.642 2.329c-.06.03-.164.074-.324.197-.115.09-.33.278-.494.392a2.025 2.025 0 0 1-.34.189 1.3 1.3 0 0 1-.45.119c-.44.023-.648-.085-.847-.294-.084-.087-.148-.183-.253-.3a1.21 1.21 0 0 0-.178-.167c-.002.057-.186 1.282-.434 1.824-.247.541-.235.357-.402.923-.23.21-.484.774-.65 1.259-.173.569-.303 1.008-.314 1.646a1.686 1.686 0 0 1-.172-.557c-.086-.704.1-1.544.657-2.15.024-.025.023-.035.013-.034a.073.073 0 0 0-.036.02c-.695.62-.86 1.764-.79 2.275.052.366.147.681.341.937v.002l.01.011a1.351 1.351 0 0 0 .174.185c.113.126.255.263.544.482.532.404.904.617.977.88.098.35-.12.58-.394.723.2.2.836.608 1.997.557 1.022-.045 1.663-.432 2.21-1.099.003-.154.02-.41.028-.688.007-.265.009-.53.05-.736a.743.743 0 0 1 .043-.135.488.488 0 0 1 .419-.285c.09-.004.185-.01.276.008.016-.13.03-.257.039-.38a2.6 2.6 0 0 1 .57-.073c.383-.013.843.023 1.075.168a.812.812 0 0 0-.183-.117c-.271-.13-.643-.174-1.021-.186.1-.268.205-.654.194-.942-.029-.757-.405-1.34-.941-1.745a.11.11 0 0 0-.031-.018c-.005-.001-.002.005.016.022.62.588.828 1.257.777 1.907-.02.253-.13.54-.256.773-.06 0-.129.003-.188.004.03-.796-.127-1.463-.57-2.392-.043-.08-.245-.422-.367-.518-.094-.463-.107-.44-.296-.865-.287-.643-.391-1.386-.479-1.822Z"></path>',
    )
  })
})
